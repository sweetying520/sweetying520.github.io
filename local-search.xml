<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ChatGPT æ³¨å†Œä½¿ç”¨æ•™ç¨‹</title>
    <link href="/2023/03/18/ChatGPT%20%E6%B3%A8%E5%86%8C%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <url>/2023/03/18/ChatGPT%20%E6%B3%A8%E5%86%8C%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/blog/gpt_1.jpeg"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>ChatGPT æ˜¯ OpenAI æ¨å‡ºçš„ä¸€æ¬¾äººå·¥æ™ºèƒ½èŠå¤©æœºå™¨äººï¼Œæ™ºèƒ½åŒ–ç¨‹åº¦éå¸¸é«˜ï¼Œåªè¦ä½ æŠŠå¿ƒä¸­çš„æ‰€æƒ³è¾“å…¥å‘Šè¯‰å®ƒï¼Œå®ƒå°±ä¼šç»™ä½ æä¾›ä¸€ä¸ªä¸“ä¸šä¸”æ»¡æ„çš„ç­”æ¡ˆï¼Œè¿™ä¹Ÿæ˜¯å®ƒèƒ½çˆ†ç«çš„ä¸»è¦åŸå› ã€‚</p><p>ä¾‹å¦‚ï¼šä½ æ‰“ç®—å†™ä¸€å°æƒ…ä¹¦å‘å¥³ç¥è¡¨ç™½ï¼Œç»“æœçº ç»“ä¸çŸ¥é“å¦‚ä½•å†™æ‰èƒ½è®¨å¥³ç¥æ¬¢å¿ƒï¼Ÿ</p><p>è¿™ç¡®å®æ˜¯ä¸€ä¸ªå¾ˆå¤´ç—›çš„é—®é¢˜ï¼Œé‚£ä¹ˆç°åœ¨ä½ å°±å¯ä»¥è¯·æ•™ ChatGPT äº†ï¼Œä½ è¾“å…¥æƒ…ä¹¦å‘Šè¯‰ ChatGPTï¼Œæ­¤æ—¶å®ƒå°±ä¼šç»™ä½ æä¾›ä¸€ä¸ªä¸“ä¸šä¸”æ»¡æ„çš„ç­”æ¡ˆï¼š</p><p><img src="/img/blog/gpt_2.jpeg"></p><p>æ‹¿ç€è¿™å°æƒ…ä¹¦ç»™åˆ°ä½ çš„å¥³ç¥ï¼Œå¥³ç¥æ„ŸåŠ¨çš„ä¸è¦ä¸è¦çš„ï¼Œç»“æœä½ ä»¬å°±åœ¨ä¸€èµ·äº†ï¼Œå“ˆå“ˆã€‚</p><p>è¿™ä¹ˆå¥½ç”¨çš„ä¸€æ¬¾è½¯ä»¶ï¼Œèµ¶ç´§è·Ÿç€æˆ‘çš„æ­¥ä¼ä¸€èµ·å­¦èµ·æ¥å§ã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æ³¨å†Œ ChatGPT æˆ‘ä»¬ä¸€èˆ¬ä¼šé‡åˆ°ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><p>1ã€å½“ä½ æ³¨å†Œ ChatGPT è´¦å·æ—¶ï¼Œæç¤ºä½ ï¼šOpenAI æœåŠ¡åœ¨å½“å‰å›½å®¶ä¸å¯ç”¨</p><p><img src="/img/blog/gpt_3.jpeg"></p><p>2ã€å½“ä½ é€‰æ‹©æ¥æ”¶çŸ­ä¿¡çš„å·ç æ—¶ï¼Œæç¤ºä½ ï¼šOpenAI æœåŠ¡åœ¨å½“å‰å›½å®¶ä¸å¯ç”¨</p><p><img src="/img/blog/gpt_4.jpeg"></p><p>å‡ºç°ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼š<strong>ChatGPT å¯¹æˆ‘å›½è¿›è¡Œäº†å°ç¦ï¼Œæ‰€ä»¥åªè¦æ¶‰åŠåˆ°æˆ‘å›½çš„ç½‘ç»œ IP æˆ–è€…æ‰‹æœºå·ç éƒ½ä¼šæç¤ºæœåŠ¡ä¸å¯ç”¨</strong></p><p>çŸ¥é“äº†é—®é¢˜å‡ºç°çš„åŸå› ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§çš„å»è§£å†³ï¼š</p><p>1ã€å°†æˆ‘å›½çš„ç½‘ç»œ IP åˆ‡æ¢åˆ°å›½å¤–çš„ç½‘ç»œ IPï¼šé€šè¿‡ç§‘å­¦ä¸Šç½‘</p><p>2ã€å°†æˆ‘å›½çš„æ‰‹æœºå·ç åˆ‡æ¢åˆ°å›½å¤–çš„æ‰‹æœºå·ç æ¥æ”¶çŸ­ä¿¡ï¼šé€šè¿‡å›½å¤–çš„çŸ­ä¿¡æ¥æ”¶å¹³å°</p><h2 id="ä¸€ã€ç§‘å­¦ä¸Šç½‘"><a href="#ä¸€ã€ç§‘å­¦ä¸Šç½‘" class="headerlink" title="ä¸€ã€ç§‘å­¦ä¸Šç½‘"></a>ä¸€ã€ç§‘å­¦ä¸Šç½‘</h2><h3 id="1-1ã€æ³¨å†Œ-V2freeï¼Œè·å–å…è´¹-v2ray-x2F-SS-ç¿»å¢™èŠ‚ç‚¹"><a href="#1-1ã€æ³¨å†Œ-V2freeï¼Œè·å–å…è´¹-v2ray-x2F-SS-ç¿»å¢™èŠ‚ç‚¹" class="headerlink" title="1.1ã€æ³¨å†Œ V2freeï¼Œè·å–å…è´¹ v2ray&#x2F;SS ç¿»å¢™èŠ‚ç‚¹"></a>1.1ã€æ³¨å†Œ V2freeï¼Œè·å–å…è´¹ v2ray&#x2F;SS ç¿»å¢™èŠ‚ç‚¹</h3><p>è¿™é‡Œæ¨èæ³¨å†Œ V2free æœºåœºè·å–å…è´¹ v2ray&#x2F;SS ç¿»å¢™èŠ‚ç‚¹ï¼Œç‚¹å‡»æ³¨å†Œé“¾æ¥ï¼š<a href="https://w1.v2free.top/auth/register?code=cd79">w1.v2free.top</a>ï¼š</p><p><img src="/img/blog/gpt_5.jpeg"></p><p>æ³¨å†Œåä¼šå‡ºç°å¦‚ä¸‹ç”»é¢ï¼š</p><p><img src="/img/blog/gpt_6.jpeg"></p><h3 id="1-2ã€ä¸‹è½½å¹¶å®‰è£…-ClashX-è½¯ä»¶"><a href="#1-2ã€ä¸‹è½½å¹¶å®‰è£…-ClashX-è½¯ä»¶" class="headerlink" title="1.2ã€ä¸‹è½½å¹¶å®‰è£… ClashX è½¯ä»¶"></a>1.2ã€ä¸‹è½½å¹¶å®‰è£… ClashX è½¯ä»¶</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://w1.v2free.top/ssr-download/ClashX.dmg">https://w1.v2free.top/ssr-download/ClashX.dmg</a></p><p>å®‰è£…åæ‰“å¼€ ClashX å³å¯</p><h3 id="1-3ã€é€šè¿‡-V2free-ä¸€é”®å¯¼å…¥é…ç½®"><a href="#1-3ã€é€šè¿‡-V2free-ä¸€é”®å¯¼å…¥é…ç½®" class="headerlink" title="1.3ã€é€šè¿‡ V2free ä¸€é”®å¯¼å…¥é…ç½®"></a>1.3ã€é€šè¿‡ V2free ä¸€é”®å¯¼å…¥é…ç½®</h3><p><img src="/img/blog/gpt_7.jpeg"></p><h3 id="1-4ã€é…ç½®-ClashX"><a href="#1-4ã€é…ç½®-ClashX" class="headerlink" title="1.4ã€é…ç½® ClashX"></a>1.4ã€é…ç½® ClashX</h3><p>ç‚¹å‡»èœå•æ ä¸­ ClashX çš„å›¾æ ‡ï¼Œå‡ºç«™æ¨¡å¼é€‰æ‹©<strong>è§„åˆ™åˆ¤æ–­</strong>ï¼Œå‹¾é€‰ä¸‹æ–¹çš„<strong>è®¾ç½®ä¸ºç³»ç»Ÿä»£ç†</strong>ï¼Œå¦å¤–æˆ‘ä»¬å¯ä»¥è¿›è¡Œ<strong>èŠ‚ç‚¹é€‰æ‹©</strong>ï¼Œé»˜è®¤ä¸º<strong>è‡ªåŠ¨é€‰æ‹©</strong></p><p><img src="/img/blog/gpt_8.jpeg"></p><p><strong>æ³¨æ„</strong>ï¼šæ³¨å†Œ ChatGPT æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æ‰‹åŠ¨é€‰æ‹©ä¸€ä¸ªå›½å¤–çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å°±èƒ½å°†æˆ‘ä»¬çš„ç½‘ç»œ IP åˆ‡æ¢åˆ°å›½å¤–</p><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬è§£å†³äº†ç¬¬ä¸€ä¸ªé—®é¢˜</p><h2 id="äºŒã€çŸ­ä¿¡éªŒè¯ç æ¥æ”¶"><a href="#äºŒã€çŸ­ä¿¡éªŒè¯ç æ¥æ”¶" class="headerlink" title="äºŒã€çŸ­ä¿¡éªŒè¯ç æ¥æ”¶"></a>äºŒã€çŸ­ä¿¡éªŒè¯ç æ¥æ”¶</h2><h3 id="2-1ã€æ‰“å¼€æ¥ç å¹³å°ï¼Œæ³¨å†Œè´¦å·"><a href="#2-1ã€æ‰“å¼€æ¥ç å¹³å°ï¼Œæ³¨å†Œè´¦å·" class="headerlink" title="2.1ã€æ‰“å¼€æ¥ç å¹³å°ï¼Œæ³¨å†Œè´¦å·"></a>2.1ã€æ‰“å¼€æ¥ç å¹³å°ï¼Œæ³¨å†Œè´¦å·</h3><p>æ‰“å¼€æ¥ç å¹³å°ï¼š<a href="https://sms-activate.org/%EF%BC%8C%E6%B3%A8%E5%86%8C%E8%B4%A6%E5%8F%B7">https://sms-activate.org/ï¼Œæ³¨å†Œè´¦å·</a></p><p><strong>æ³¨æ„</strong>ï¼š</p><blockquote><p>1ã€è¿™ä¸ªå¹³å°ä¸æ˜¯å…è´¹å¹³å°ï¼Œæ¯ä¸ªæ‰‹æœºå·ç æ¥æ”¶çŸ­ä¿¡æ—¶é•¿åªæœ‰ 20 åˆ†é’Ÿï¼Œåœ¨ 20 åˆ†é’Ÿå†…æˆ‘ä»¬åº”è¯¥å®Œæˆ ChatGPT çš„è´¦å·æ³¨å†Œï¼Œå¦åˆ™å°±æ¥æ”¶ä¸åˆ°çŸ­ä¿¡éªŒè¯ç äº†</p><p>2ã€å¹³å°æœ€ä½æ ‡å‡† 2 ç¾å…ƒï¼Œé‚£å°±åªå…… 2 ç¾å…ƒï¼Œæ”¯æŒæ”¯ä»˜å®</p></blockquote><p><img src="/img/blog/gpt_9.jpeg"></p><p>ç‚¹å‡»æ³¨å†Œä¼šå¼¹å‡ºå¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="/img/blog/gpt_10.jpeg"></p><p>é€šè¿‡é‚®ç®±æ³¨å†Œï¼ˆå¯¹é‚®ç®±æ— è¦æ±‚ï¼Œä½ å¯ä»¥æ˜¯ qqï¼Œç½‘æ˜“ç­‰é‚®ç®±ï¼‰ï¼Œè¿‡å‡ åˆ†é’Ÿé‚®ç®±ä¼šæ”¶åˆ°ä¸€ä¸ªæ¿€æ´»é“¾æ¥ï¼Œæ‰“å¼€é“¾æ¥å¦‚ä¸‹å›¾ï¼š</p><p><img src="/img/blog/gpt_11.jpeg"></p><p>ç‚¹å‡»ç¡®è®¤å°±å¯ä»¥å®Œæˆæ³¨å†Œäº†</p><h3 id="2-2ã€è¿›è¡Œå……å€¼"><a href="#2-2ã€è¿›è¡Œå……å€¼" class="headerlink" title="2.2ã€è¿›è¡Œå……å€¼"></a>2.2ã€è¿›è¡Œå……å€¼</h3><p>ç‚¹å‡»å³ä¸Šè§’ä¸‹æ‹‰çš„å›¾æ ‡é€‰æ‹©å……å€¼ï¼š</p><p><img src="/img/blog/gpt_12.jpeg"></p><p>ä¸‹æ‹‰æ‰¾åˆ°æ”¯ä»˜å®ï¼š</p><p><img src="/img/blog/gpt_13.jpeg"></p><p>å……å€¼ 2 ç¾å…ƒå³å¯ï¼š</p><p><img src="/img/blog/gpt_14.jpeg"></p><h3 id="2-3ã€é€‰æ‹©æ¥æ”¶å›½å®¶çš„æ‰‹æœºå·ç "><a href="#2-3ã€é€‰æ‹©æ¥æ”¶å›½å®¶çš„æ‰‹æœºå·ç " class="headerlink" title="2.3ã€é€‰æ‹©æ¥æ”¶å›½å®¶çš„æ‰‹æœºå·ç "></a>2.3ã€é€‰æ‹©æ¥æ”¶å›½å®¶çš„æ‰‹æœºå·ç </h3><p>åœ¨å·¦è¾¹æœç´¢ï¼šOpenAI</p><p><img src="/img/blog/gpt_15.jpeg"></p><p>ç‚¹å‡»æœç´¢åˆ°çš„ OpenAI é€‰é¡¹ï¼š</p><p><img src="/img/blog/gpt_16.jpeg"></p><p>é€‰æ‹©ä¸€ä¸ªæœ€ä¾¿å®œçš„åŠ å…¥è´­ç‰©è½¦å³å¯ï¼Œåˆ°æ­¤ä½ å°±å¯ä»¥åœ¨ 20 åˆ†é’Ÿå†…æ¥æ”¶çŸ­ä¿¡äº†ï¼š</p><p><img src="/img/blog/gpt_17.jpeg"></p><h2 id="ä¸‰ã€ChatGPT-æ³¨å†Œå®Œæ•´æµç¨‹"><a href="#ä¸‰ã€ChatGPT-æ³¨å†Œå®Œæ•´æµç¨‹" class="headerlink" title="ä¸‰ã€ChatGPT æ³¨å†Œå®Œæ•´æµç¨‹"></a>ä¸‰ã€ChatGPT æ³¨å†Œå®Œæ•´æµç¨‹</h2><p>1ï¼‰ã€è®¿é—® <a href="https://chat.openai.com/auth/login">ChatGPTå®˜ç½‘</a>ã€‚ç‚¹å‡» sign upï¼Œå¼€å§‹æ³¨å†Œï¼š</p><p><img src="/img/blog/gpt_18.jpeg"></p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä½¿ç”¨ä¸­å›½ IPï¼Œæ³¨å†Œæ—¶ä¼šæç¤ºä¸æ”¯æŒæ‰€åœ¨å›½å®¶ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨ vpn åˆ‡æ¢ä¸€ä¸ªå›½å¤–çš„ IPï¼ŒæŒ‰ç…§ä¸Šé¢æ‰€è¯´çš„æ“ä½œå³å¯</p><p>2ï¼‰ã€å¡«å†™é‚®ç®±åœ°å€å’Œå¯†ç ã€‚å¯†ç éœ€è¦è‡³å°‘ 8 ä½ã€‚è¿™é‡Œå¯ä»¥ç”¨å›½å†…çš„é‚®ç®±ï¼Œæ¯”å¦‚ qq ï¼Œç½‘æ˜“ç­‰é‚®ç®±ã€‚æ³¨å†Œåä¼šæ”¶åˆ°ä¸€å°éªŒè¯é‚®ä»¶ï¼Œç‚¹å‡»é“¾æ¥å³å¯ï¼š</p><p><img src="/img/blog/gpt_19.jpeg"></p><p>3ï¼‰ã€å¡«å†™æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç ã€‚</p><p><img src="/img/blog/gpt_20.jpeg"></p><p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œä¹Ÿä¸æ”¯æŒä¸­å›½æ‰‹æœºå·ï¼Œéœ€è¦å¡«å†™å›½å¤–æ‰‹æœºå·ç æ¥æ¥æ”¶çŸ­ä¿¡éªŒè¯ç ï¼ŒæŒ‰ç…§ä¸Šé¢æ‰€è¯´çš„æ“ä½œå³å¯ã€‚</p><p>okï¼Œè‡³æ­¤ï¼Œä½ å°±å®Œæˆäº† ChatGPT çš„æ³¨å†Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä½“éªŒä¸€ä¸‹å§ã€‚</p><p>4ï¼‰ã€ChatGPT åˆä½“éªŒ</p><p><img src="/img/blog/gpt_21.jpeg"></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€æ³¨å†Œ ChatGPT ä¼šé‡åˆ°çš„é—®é¢˜ï¼š</p><blockquote><p>1ã€æˆ‘å›½çš„ç½‘ç»œ IP æ— æ³•ä½¿ç”¨æœåŠ¡</p><p>2ã€æˆ‘å›½çš„æ‰‹æœºå·æ— æ³•ä½¿ç”¨æœåŠ¡</p></blockquote><p>åŸå› ï¼šChatGPT å¯¹æˆ‘å›½è¿›è¡Œäº†å°ç¦ï¼Œæ‰€ä»¥åªè¦æ¶‰åŠåˆ°æˆ‘å›½çš„ç½‘ç»œ IP æˆ–è€…æ‰‹æœºå·ç éƒ½ä¼šæç¤ºæœåŠ¡ä¸å¯ç”¨</p><p>2ã€å¦‚ä½•è¿›è¡Œç§‘å­¦ä¸Šç½‘ï¼šV2free + ClashXï¼š</p><blockquote><p>é€šè¿‡ç§‘å­¦ä¸Šç½‘åˆ‡æ¢ç½‘ç»œ IP åˆ°å›½å¤–</p></blockquote><p>3ã€å¦‚ä½•é€šè¿‡å›½å¤–çš„çŸ­ä¿¡å¹³å°æ¥æ”¶çŸ­ä¿¡</p><blockquote><p>é€šè¿‡å›½å¤–çŸ­ä¿¡æ¥æ”¶å¹³å°æ¥æ”¶éªŒè¯ç ï¼Œå®Œæˆ ChatGPT æ³¨å†Œ</p></blockquote><p>4ã€ChatGPT æ³¨å†Œå®Œæ•´æµç¨‹ä»¥åŠæ•ˆæœä½“éªŒ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://openai.com/blog/chatgpt">ChatGPT å®˜ç½‘</a></p><p><a href="https://github.com/bannedbook/fanqiang/wiki/%E8%8B%B9%E6%9E%9C%E7%94%B5%E8%84%91MAC%E7%BF%BB%E5%A2%99">ç§‘å­¦ä¸Šç½‘</a></p><p><a href="https://sms-activate.org/">å›½å¤–çŸ­ä¿¡æ¥æ”¶å¹³å°</a></p><p><a href="https://w1.v2free.top/user">V2free</a></p><p><a href="https://w1.v2free.top/doc/#/macOS/ClashX">ClashX</a></p><p><a href="https://www.bilibili.com/video/BV1ms4y1W7PH/?from=search&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">ChatGPT æ³¨å†Œæ•™ç¨‹ 1</a></p><p><a href="https://www.awyerwu.com/9273.html">ChatGPT æ³¨å†Œæ•™ç¨‹ 2</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong> <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>äººå·¥æ™ºèƒ½</category>
      
      <category>ChatGPT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>ChatGPT</tag>
      
      <tag>äººå·¥æ™ºèƒ½</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆä¹ï¼‰ï¼šGetX çŠ¶æ€ç®¡ç†æ ¸å¿ƒæºç åˆ†æ</title>
    <link href="/2023/02/27/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B9%9D%EF%BC%89%EF%BC%9AGetX%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <url>/2023/02/27/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B9%9D%EF%BC%89%EF%BC%9AGetX%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/blog/flutter_9_bg.jpeg"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>GetX æ˜¯ Flutter ä¸Šä¸€ä¸ªè½»é‡ä¸”å¼ºå¤§çš„çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œå®ƒä¸ä»…åŒ…å«äº†<strong>çŠ¶æ€ç®¡ç†</strong>ï¼Œè¿˜æœ‰<strong>è·¯ç”±ç®¡ç†ï¼Œä¸»é¢˜ç®¡ç†ï¼Œå›½é™…åŒ–å¤šè¯­è¨€ç®¡ç†ï¼Œç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®éªŒè¯ï¼ŒDialogï¼ŒSnackbar</strong> ç­‰åŠŸèƒ½ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œå‡å°‘äº†æˆ‘ä»¬çš„å¼€å‘æ—¶é—´ï¼Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚è¿™ä¹ˆå¥½ç”¨çš„ä¸€ä¸ªæ¡†æ¶ï¼Œè®©æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å§ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥ï¼ŒGetX æœ€æ ¸å¿ƒä¹Ÿæ˜¯æœ€å…·æœ‰ç‰¹è‰²çš„åŠŸèƒ½æ˜¯å®ƒçš„çŠ¶æ€ç®¡ç†åŠŸèƒ½ï¼Œå› æ­¤ä»Šå¤©æˆ‘ä»¬ä¸»è¦çš„ä»»åŠ¡å°±æ˜¯æŠŠ GetX çš„çŠ¶æ€ç®¡ç†åŠŸèƒ½ç»™æ•´æ˜ç™½ï¼Œåç»­æˆ‘ä¹Ÿä¼šæ‰‹æŠŠæ‰‹å¸¦é¢†å¤§å®¶å»æ‰‹æ’¸ GetX çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒæºç å®ç°ã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ä¸ºäº†è®©å¤§å®¶æ›´å¥½çš„å»ç†è§£å’Œé˜…è¯»æºç ï¼Œåœ¨æ­¤ï¼Œæˆ‘å…ˆæŠ›å‡ºå‡ ä¸ªé—®é¢˜ï¼Œå¤§å®¶å¯ä»¥å»æ€è€ƒä¸€ä¸‹ï¼Ÿ</p><p>1ã€ä½ äº†è§£ Dart ä¸­çš„å‡½æ•°ç±»å‹å—ï¼Ÿæ€ä¹ˆå®šä¹‰ï¼Ÿ</p><p>2ã€typedef å…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>3ã€extension å…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>4ã€å¦‚ä½•å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼ŸDart ä¸­çš„æ³›å‹æ–¹æ³•å’Œ Javaï¼ŒKotlin æœ‰å•¥åŒºåˆ«ï¼Ÿ</p><p>5ã€ä½ äº†è§£ Dart ä¸­çš„å‘½åæ„é€ æ–¹æ³•å’Œ factory æ„é€ æ–¹æ³•å—ï¼Ÿ</p><p>6ã€ä½ çŸ¥é“ Dart ä¸­çš„ getterï¼Œsetter æ–¹æ³•è¦æ€ä¹ˆå†™å—ï¼Ÿ</p><p>7ã€Dart ä¸­çš„ mixin æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ</p><p>å¦‚æœä½ å¿ƒé‡Œå¯¹äºä¸Šé¢çš„è¿™äº›é—®é¢˜æœ‰ç–‘é—®ğŸ¤”ï¸ï¼Œé‚£ä¹ˆå°±è·Ÿç€æˆ‘çš„æ­¥ä¼ç»§ç»­å¾€ä¸‹èµ°å§</p><h2 id="ä¸€ã€å‰ç½®çŸ¥è¯†"><a href="#ä¸€ã€å‰ç½®çŸ¥è¯†" class="headerlink" title="ä¸€ã€å‰ç½®çŸ¥è¯†"></a>ä¸€ã€å‰ç½®çŸ¥è¯†</h2><h3 id="1-1ã€Dart-ä¸­çš„å‡½æ•°ç±»å‹"><a href="#1-1ã€Dart-ä¸­çš„å‡½æ•°ç±»å‹" class="headerlink" title="1.1ã€Dart ä¸­çš„å‡½æ•°ç±»å‹"></a>1.1ã€Dart ä¸­çš„å‡½æ•°ç±»å‹</h3><p>å‡½æ•°ç±»å‹çš„å®šä¹‰ï¼šå°†ä¸€ä¸ªå‡½æ•°å½“ä½œç±»å‹çš„ç±»å‹å°±æ˜¯å‡½æ•°ç±»å‹ï¼Œå®ƒå¯ä»¥ï¼š</p><p>1ã€ä½œä¸ºä¸€ä¸ªå‡½æ•°çš„å‚æ•°æˆ–è¿”å›å€¼</p><p>2ã€èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</p><h4 id="1-1-1ã€Kotlin-ä¸­çš„å‡½æ•°ç±»å‹"><a href="#1-1-1ã€Kotlin-ä¸­çš„å‡½æ•°ç±»å‹" class="headerlink" title="1.1.1ã€Kotlin ä¸­çš„å‡½æ•°ç±»å‹"></a>1.1.1ã€Kotlin ä¸­çš„å‡½æ•°ç±»å‹</h4><p>å¯¹æ¯” Kotlin ä¸­çš„å‡½æ•°ç±»å‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//Kotlin ä¸­å‡½æ•°ç±»å‹çš„è¯­æ³•è§„åˆ™</span><br>(String,<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Unit</span><br><span class="hljs-comment">//æˆ–è€…å¦‚ä¸‹</span><br>() -&gt; <span class="hljs-built_in">Unit</span><br><br><span class="hljs-comment">//ç¤ºä¾‹ï¼š</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = func(num1,num2)<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)&#123; num1,num2 -&gt;<br>        num1 + num2<br>    &#125;<br>    <span class="hljs-keyword">val</span> numberMinus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)&#123; num1,num2 -&gt;<br>        num1 - num2<br>    &#125;<br>    println(numberPlus)<br>    println(numberMinus)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">30</span><br>-<span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><h4 id="1-1-2ã€Dart-å‡½æ•°ç±»å‹"><a href="#1-1-2ã€Dart-å‡½æ•°ç±»å‹" class="headerlink" title="1.1.2ã€Dart å‡½æ•°ç±»å‹"></a>1.1.2ã€Dart å‡½æ•°ç±»å‹</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//Dart ä¸­çš„å‡½æ•°ç±»å‹çš„è¯­æ³•è§„åˆ™</span><br><span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">String</span>,<span class="hljs-built_in">int</span>)<br><span class="hljs-comment">//æˆ–è€…å¦‚ä¸‹</span><br><span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>()<br>  <br>  <br><span class="hljs-comment">//ç¤ºä¾‹</span><br><span class="hljs-built_in">int</span> numberPlus(<span class="hljs-built_in">int</span> num1,<span class="hljs-built_in">int</span> num2,<span class="hljs-built_in">int</span> <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">int</span>) sum)&#123;<br>  <span class="hljs-keyword">return</span> sum(num1,num2);<br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-built_in">print</span>(numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, (num1, num2) =&gt; num1 + num2));<br>  <span class="hljs-built_in">print</span>(numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, (num1, num2) =&gt; num1 - num2));<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">30</span><br><span class="hljs-number">-10</span><br></code></pre></td></tr></table></figure><h3 id="1-2ã€typedef-å…³é”®å­—"><a href="#1-2ã€typedef-å…³é”®å­—" class="headerlink" title="1.2ã€typedef å…³é”®å­—"></a>1.2ã€typedef å…³é”®å­—</h3><p><strong>typedef ä½œç”¨ï¼šç»™ä»»æ„ç±»å‹è®¾ç½®ä¸€ä¸ªåˆ«åï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¼šç»™å®šä¹‰æ¯”è¾ƒé•¿çš„ç±»å‹ä½¿ç”¨ typedef ï¼Œä¾‹å¦‚ï¼šå‡½æ•°ç±»å‹</strong></p><p>å¦‚ä¸‹ä¾‹å­ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€ç»™å‡½æ•°ç±»å‹å–åˆ«å</span><br><span class="hljs-keyword">typedef</span> IntOperation = <span class="hljs-built_in">int</span> <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">int</span>);<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  IntOperation intOperation = (a,b) =&gt; a + b;<br>  <span class="hljs-built_in">print</span>(intOperation(<span class="hljs-number">4</span>,<span class="hljs-number">6</span>));<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10</span><br><br><span class="hljs-comment">//2ã€ç»™ List&lt;int&gt; å–åˆ«å</span><br><span class="hljs-keyword">typedef</span> IntList = <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt;;<br><span class="hljs-keyword">void</span> main() &#123;<br>  IntList intList = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>  <span class="hljs-built_in">print</span>(intList);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><br><span class="hljs-comment">//3ã€ç»™ Map&lt;String,dynamic&gt; å–åˆ«å</span><br><span class="hljs-keyword">typedef</span> StringDynamicMap = <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">dynamic</span>&gt;;<br><span class="hljs-keyword">void</span> main() &#123;<br>  StringDynamicMap stringDynamicMap = &#123;<br>    <span class="hljs-string">&quot;erdai&quot;</span>:<span class="hljs-string">&quot;666&quot;</span><br>  &#125;;<br>  <span class="hljs-built_in">print</span>(stringDynamicMap);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&#123;erdai: <span class="hljs-number">666</span>&#125;<br><br><span class="hljs-comment">//4ã€ç»™ List&lt;T&gt; å–åˆ«å</span><br><span class="hljs-keyword">typedef</span> MyList&lt;T&gt; = <span class="hljs-built_in">List</span>&lt;T&gt;;<br><span class="hljs-keyword">void</span> main() &#123;<br>  MyList&lt;<span class="hljs-built_in">String</span>&gt; stringList = [<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;456&quot;</span>];<br>  <span class="hljs-built_in">print</span>(stringList);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[<span class="hljs-number">123</span>, <span class="hljs-number">456</span>]<br></code></pre></td></tr></table></figure><h3 id="1-3ã€extension-å…³é”®å­—"><a href="#1-3ã€extension-å…³é”®å­—" class="headerlink" title="1.3ã€extension å…³é”®å­—"></a>1.3ã€extension å…³é”®å­—</h3><p><strong>extension ä½œç”¨ï¼šç»™ä¸€ä¸ªç±»è¿›è¡Œæ–¹æ³•æ‰©å±•</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">extension</span> StringExtension <span class="hljs-keyword">on</span> <span class="hljs-built_in">String</span>&#123;<br><br>  <span class="hljs-built_in">int</span> toInt()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>.parse(<span class="hljs-keyword">this</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$&#123;<span class="hljs-string">&quot;666&quot;</span>.toInt().runtimeType&#125;</span> ===&gt; <span class="hljs-subst">$&#123;<span class="hljs-string">&quot;666&quot;</span>.toInt()&#125;</span>&#x27;</span>);<br>&#125; <br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-built_in">int</span> ===&gt; <span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><h3 id="1-4ã€æ³›å‹æ–¹æ³•"><a href="#1-4ã€æ³›å‹æ–¹æ³•" class="headerlink" title="1.4ã€æ³›å‹æ–¹æ³•"></a>1.4ã€æ³›å‹æ–¹æ³•</h3><p>ç±»æ¯” Javaï¼ŒKotlin ä¸­çš„æ³›å‹æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//Java ä¸­çš„å†™æ³•</span><br>public &lt;T&gt; <span class="hljs-keyword">void</span> genericMethod(T param)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//Kotlin ä¸­çš„å†™æ³•</span><br>fun &lt;T&gt; genericMethod(param: T)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//Dart ä¸­çš„å†™æ³•</span><br><span class="hljs-keyword">void</span> genericMethod&lt;T&gt;(T param)&#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä¸åŒç‚¹ï¼š</strong></p><p>1ã€Java ä¸­æ–¹æ³•çš„æ³›å‹å®šä¹‰åœ¨è¿”å›å€¼çš„å‰é¢</p><p>2ã€Kotlin ä¸­çš„æ–¹æ³•æ³›å‹å®šä¹‰åœ¨æ–¹æ³•åçš„å‰é¢</p><p>3ã€Dart ä¸­çš„æ³›å‹å®šä¹‰åœ¨æ–¹æ³•åçš„åé¢</p><h3 id="1-5ã€å‘½åæ„é€ æ–¹æ³•å’Œ-factory-æ„é€ æ–¹æ³•"><a href="#1-5ã€å‘½åæ„é€ æ–¹æ³•å’Œ-factory-æ„é€ æ–¹æ³•" class="headerlink" title="1.5ã€å‘½åæ„é€ æ–¹æ³•å’Œ factory æ„é€ æ–¹æ³•"></a>1.5ã€å‘½åæ„é€ æ–¹æ³•å’Œ factory æ„é€ æ–¹æ³•</h3><p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span></span>&#123;<br>  <span class="hljs-built_in">String?</span> name;<br>  <span class="hljs-built_in">int?</span> age;<br><br>  <span class="hljs-comment">//å‘½åæ„é€ æ–¹æ³•</span><br>  Student.nameConstructor(<span class="hljs-keyword">this</span>.name,<span class="hljs-keyword">this</span>.age);<br><br>  <span class="hljs-keyword">static</span> Student? _instance;<br>  <span class="hljs-comment">//æ„é€ æ–¹æ³•ç§æœ‰åŒ–</span><br>  Student._private();<br>  <span class="hljs-comment">//factory æ„é€ æ–¹æ³•</span><br>  <span class="hljs-keyword">factory</span> Student()&#123;<br>    <span class="hljs-keyword">return</span> _instance ??= Student._private();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> student = Student.nameConstructor(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-number">18</span>);<br>  <span class="hljs-keyword">var</span> student1 = Student();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-6ã€getterï¼Œsetter"><a href="#1-6ã€getterï¼Œsetter" class="headerlink" title="1.6ã€getterï¼Œsetter"></a>1.6ã€getterï¼Œsetter</h3><p>è¯­æ³•è§„åˆ™ï¼š</p><blockquote><p>get æ–¹æ³•è¯­æ³•æ ¼å¼ï¼š<strong>è¿”å›å€¼ç±»å‹ get æ–¹æ³•å { æ–¹æ³•ä½“ }</strong></p><p>set æ–¹æ³•è¯­æ³•æ ¼å¼ï¼š<strong>set æ–¹æ³•å ( å‚æ•° ) { æ–¹æ³•ä½“ }</strong></p></blockquote><p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span></span>&#123;<br>  <span class="hljs-keyword">late</span> <span class="hljs-built_in">String</span> _name;<br>  <span class="hljs-keyword">late</span> <span class="hljs-built_in">int</span> _age;<br><br>  Dog(<span class="hljs-keyword">this</span>._name, <span class="hljs-keyword">this</span>._age);<br>  <br>  <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> name&#123;<br>    <span class="hljs-keyword">return</span> _name;<br>  &#125;<br><br>  <span class="hljs-keyword">set</span> name(<span class="hljs-built_in">String</span> name)&#123;<br>    _name = name;<br>  &#125;<br><br>  <span class="hljs-built_in">int</span> <span class="hljs-keyword">get</span> age =&gt; _age;<br><br>  <span class="hljs-keyword">set</span> age(<span class="hljs-built_in">int</span> value) &#123;<br>    _age = value;<br>  &#125;<br><br>  <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> string&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Dog&#123;_nameï¼š<span class="hljs-subst">$_name</span>ï¼Œ_ageï¼š<span class="hljs-subst">$_age</span>&#125;&#x27;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> dog = Dog(<span class="hljs-string">&quot;æ‹‰å¸ƒæ‹‰å¤š&quot;</span>,<span class="hljs-number">6</span>);<br>  <span class="hljs-built_in">print</span>(dog.string);<br>  dog.name = <span class="hljs-string">&quot;é˜¿æ‹‰æ–¯åŠ &quot;</span>;<br>  dog.age = <span class="hljs-number">7</span>;<br>  <span class="hljs-built_in">print</span>(dog.string);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Dog&#123;_nameï¼šæ‹‰å¸ƒæ‹‰å¤šï¼Œ_ageï¼š<span class="hljs-number">6</span>&#125;<br>Dog&#123;_nameï¼šé˜¿æ‹‰æ–¯åŠ ï¼Œ_ageï¼š<span class="hljs-number">7</span>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-7ã€mixin"><a href="#1-7ã€mixin" class="headerlink" title="1.7ã€mixin"></a>1.7ã€mixin</h3><p>1ï¼‰ã€Dart è¯­è¨€çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å®ç°ç±»ä¼¼å¤šç»§æ‰¿çš„æ•ˆæœå¯ä»¥ä½¿ç”¨ mixin æœºåˆ¶ï¼Œåˆå«æ··å…¥æœºåˆ¶ï¼Œä¾‹å¦‚æŠŠç±» A æ··å…¥åˆ°ç±» B ä¸­ï¼Œé‚£ä¹ˆç±» B å°±æ‹¥æœ‰äº†ç±» A çš„æˆå‘˜ï¼Œè·Ÿç»§æ‰¿çš„ç‰¹æ€§éå¸¸ç›¸ä¼¼</p><p>2ï¼‰ã€å®šä¹‰ä¸€ä¸ªå¯ä»¥è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ mixin å…³é”®å­—ä»£æ›¿ class å…³é”®å­—å³å¯</p><p>3ï¼‰ã€ç»§æ‰¿è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ with å…³é”®å­—ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä¸­é—´ç”¨ , éš”å¼€</p><p>4ï¼‰ã€è¢« mixin çš„ç±»åªèƒ½ç»§æ‰¿è‡ª Objectï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¸”ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</p><p>5ï¼‰ã€çˆ¶ç±»çº¦æŸï¼šå½“å£°æ˜ä¸€ä¸ª mixin æ—¶ï¼Œ on åé¢çš„ç±»å°±æ˜¯è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸã€‚ä¸€ä¸ªç±»è‹¥æ˜¯è¦ with è¿™ä¸ª mixinï¼Œåˆ™è¿™ä¸ªç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸ</p><p>6ï¼‰ã€å°±è¿œå‘½ä¸­åŸåˆ™ï¼šå½“ with å¤šä¸ª mixinï¼Œå¤šä¸ª mixin æ‹¥æœ‰åŒä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è°ƒç”¨æ–¹æ³•æ—¶ä¼šå‘½ä¸­æœ€åä¸€ä¸ª mixin ç±»çš„æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªå¯ä»¥è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ mixin å…³é”®å­—ä»£æ›¿ class å…³é”®å­—å³å¯</span><br><span class="hljs-comment">//2ã€ç»§æ‰¿è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ with å…³é”®å­—ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä¸­é—´ç”¨ , éš”å¼€</span><br><span class="hljs-keyword">mixin</span> A&#123;<br> Â <span class="hljs-keyword">void</span> getA()&#123;<br> Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;A&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">mixin</span> B&#123;<br> Â <span class="hljs-keyword">void</span> getB()&#123;<br> Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;B&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br> Â <span class="hljs-keyword">void</span> getC()&#123;<br> Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;C&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CC</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">C</span> <span class="hljs-title">with</span> <span class="hljs-title">A</span>,<span class="hljs-title">B</span></span>&#123;&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br> Â <span class="hljs-keyword">var</span> cc = CC();<br> Â cc.getA();<br> Â cc.getB();<br> Â cc.getC();<br> Â <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> A);<br> Â <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> B);<br> Â <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> C);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>A<br>B<br>C<br><span class="hljs-keyword">true</span><br><span class="hljs-keyword">true</span><br><span class="hljs-keyword">true</span><br> Â <br><span class="hljs-comment">//3ã€è¢« mixin çš„ç±»åªèƒ½ç»§æ‰¿è‡ª Objectï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¸”ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span> </span>&#123;&#125;<br><br><span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™ï¼Œmixin ç±»ä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œåªèƒ½ç»§æ‰¿è‡ª Object</span><br><span class="hljs-keyword">mixin</span> E <span class="hljs-keyword">extends</span> D&#123;<br> Â  <span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™ï¼Œmixin ç±»ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</span><br> Â  E();<br>&#125;<br><br><span class="hljs-comment">//4ã€çˆ¶ç±»çº¦æŸï¼šå½“å£°æ˜ä¸€ä¸ª mixin æ—¶ï¼Œ on åé¢çš„ç±»å°±æ˜¯è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸã€‚ä¸€ä¸ªç±»è‹¥æ˜¯è¦ with è¿™ä¸ª mixinï¼Œåˆ™è¿™ä¸ªç±»å¿…é¡»ç»§æ‰¿</span><br><span class="hljs-comment">//æˆ–å®ç°æˆ– with è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸ</span><br><br><span class="hljs-comment">//4.1</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">F</span></span>&#123;&#125;<br><br><span class="hljs-keyword">mixin</span> G <span class="hljs-keyword">on</span> F&#123;&#125;<br><br><span class="hljs-comment">//class I with G&#123;&#125; //ç¼–è¯‘æŠ¥é”™ï¼šclass I æ²¡æœ‰ç»§æ‰¿ mixin çš„çˆ¶ç±»çº¦æŸ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">I</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">F</span> <span class="hljs-title">with</span> <span class="hljs-title">G</span></span>&#123;&#125; <span class="hljs-comment">//ç¼–è¯‘é€šè¿‡ï¼Œclass I ç»§æ‰¿äº† mixin çš„çˆ¶ç±»çº¦æŸ</span><br><br><span class="hljs-comment">//4.2</span><br><span class="hljs-keyword">mixin</span> F1&#123;&#125;<br><br><span class="hljs-keyword">mixin</span> G1 <span class="hljs-keyword">on</span> F1&#123;&#125;<br><br><span class="hljs-comment">//class I1 with G1&#123;&#125; //ç¼–è¯‘æŠ¥é”™ï¼šclass I1 æ²¡æœ‰ with mixin çš„çˆ¶ç±»çº¦æŸ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">I1</span> <span class="hljs-title">with</span> <span class="hljs-title">F1</span>,<span class="hljs-title">G1</span></span>&#123;&#125; <span class="hljs-comment">//ç¼–è¯‘é€šè¿‡ï¼Œclass I1 with äº† mixin çš„çˆ¶ç±»çº¦æŸ</span><br><br><span class="hljs-comment">//5ã€å°±è¿œå‘½ä¸­åŸåˆ™ï¼šå½“ with å¤šä¸ª mixinï¼Œå¤šä¸ª mixin æ‹¥æœ‰åŒä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è°ƒç”¨æ–¹æ³•æ—¶ä¼šå‘½ä¸­æœ€åä¸€ä¸ª mixin ç±»çš„æ–¹æ³•</span><br><span class="hljs-keyword">mixin</span> Test1&#123;<br>  <span class="hljs-keyword">void</span> testMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test1 testMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">mixin</span> Test2&#123;<br>  <span class="hljs-keyword">void</span> testMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test2 testMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> <span class="hljs-title">with</span> <span class="hljs-title">Test1</span>,<span class="hljs-title">Test2</span></span>&#123;<br><br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> test = Test();<br>  test.testMethod();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Test2 testMethod<br></code></pre></td></tr></table></figure><p>æœ‰äº†ä¸Šé¢çš„è¿™äº›çŸ¥è¯†ï¼Œä¸€ä¼šé˜…è¯»æºç å°±èƒ¸æœ‰æˆç«¹äº†ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆçœ‹ä¸‹ GetX çš„çŠ¶æ€ç®¡ç†ä½¿ç”¨ï¼Œç„¶ååœ¨åˆ†ææºç ã€‚</p><h2 id="äºŒã€GetX-çŠ¶æ€ç®¡ç†ä½¿ç”¨"><a href="#äºŒã€GetX-çŠ¶æ€ç®¡ç†ä½¿ç”¨" class="headerlink" title="äºŒã€GetX çŠ¶æ€ç®¡ç†ä½¿ç”¨"></a>äºŒã€GetX çŠ¶æ€ç®¡ç†ä½¿ç”¨</h2><p>GetX çŠ¶æ€ç®¡ç†ä¸»è¦æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š</p><p>1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼</p><p>2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼</p><h3 id="2-1ã€GetBuilder-Controller-update-çŠ¶æ€ç®¡ç†æ¨¡å¼"><a href="#2-1ã€GetBuilder-Controller-update-çŠ¶æ€ç®¡ç†æ¨¡å¼" class="headerlink" title="2.1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼"></a>2.1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šåˆ›å»º GetxController å®ç°ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetBuilderLogic</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GetxController</span> </span>&#123;<br><br>  <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">void</span> increase()&#123;<br>    count++;<br>    update();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡µé¢</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetBuilderPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  GetBuilderPage(&#123;Key? key&#125;) : <span class="hljs-keyword">super</span>(key: key);<br>  <span class="hljs-comment">//1ã€ä¾èµ–æ³¨å…¥</span><br>  <span class="hljs-keyword">final</span> GetBuilderLogic logic = Get.put(GetBuilderLogic());<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      appBar: AppBar(<br>        title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;GetBuilderPage&#x27;</span>),<br>      ),<br>      <span class="hljs-comment">//2ã€GetBuilder ç®¡ç†æ¨¡å¼</span><br>      body: GetBuilder&lt;GetBuilderLogic&gt;(builder: (logic) &#123;<br>        <span class="hljs-keyword">return</span> Center(<br>          child: Text(<br>            <span class="hljs-string">&#x27;You tapped the FAB <span class="hljs-subst">$&#123;logic.count&#125;</span> times&#x27;</span>,<br>            style: <span class="hljs-keyword">const</span> TextStyle(fontSize: <span class="hljs-number">20</span>),<br>          ),<br>        );<br>      &#125;),<br>      floatingActionButton: FloatingActionButton(<br>        onPressed: () =&gt; logic.increase(),<br>        tooltip: <span class="hljs-string">&#x27;Increment Counter&#x27;</span>,<br>        child: <span class="hljs-keyword">const</span> Icon(Icons.add), <br>      ),<br>      floatingActionButtonLocation: FloatingActionButtonLocation.endFloat,<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/sweetying520/picgo/master/img/202309261039952.gif" alt="getbuilder.gif"></p><h3 id="2-2ã€Obx-obs-å“åº”å¼ç®¡ç†æ¨¡å¼"><a href="#2-2ã€Obx-obs-å“åº”å¼ç®¡ç†æ¨¡å¼" class="headerlink" title="2.2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼"></a>2.2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šåˆ›å»º ObxLogic</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObxLogic</span> </span>&#123;<br><br>  <span class="hljs-keyword">var</span> count = <span class="hljs-number">0.</span>obs;<br><br>  <span class="hljs-keyword">void</span> increase()&#123;<br>    count++;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡µé¢</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObxPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  ObxPage(&#123;Key? key&#125;) : <span class="hljs-keyword">super</span>(key: key);<br>  <span class="hljs-comment">//1ã€ä¾èµ–æ³¨å…¥</span><br>  <span class="hljs-keyword">final</span> ObxLogic logic = Get.put(ObxLogic());<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      appBar: AppBar(<br>        title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;ObxPage&#x27;</span>),<br>      ),<br>      <span class="hljs-comment">//2ã€Obx ç®¡ç†æ¨¡å¼</span><br>      body: Obx(() &#123;<br>        <span class="hljs-keyword">return</span> Center(<br>          child: Text(<br>            <span class="hljs-string">&#x27;You clicked the FAB <span class="hljs-subst">$&#123;logic.count&#125;</span> times&#x27;</span>,<br>            style: <span class="hljs-keyword">const</span> TextStyle(fontSize: <span class="hljs-number">20</span>),<br>          ),<br>        );<br>      &#125;),<br>      floatingActionButton: FloatingActionButton(<br>        onPressed: () =&gt; logic.increase(),<br>        tooltip: <span class="hljs-string">&#x27;Increment Counter&#x27;</span>,<br>        child: <span class="hljs-keyword">const</span> Icon(Icons.add), <span class="hljs-comment">//Change Icon</span><br>      ),<br>      floatingActionButtonLocation: FloatingActionButtonLocation<br>          .endFloat, <span class="hljs-comment">//Change for different locations</span><br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/689cd9d044d64d6da8413e9367df7ae1~tplv-k3u1fbpfcp-watermark.image" alt="obx.gif"></p><h2 id="ä¸‰ã€GetX-çŠ¶æ€ç®¡ç†æºç åˆ†æ"><a href="#ä¸‰ã€GetX-çŠ¶æ€ç®¡ç†æºç åˆ†æ" class="headerlink" title="ä¸‰ã€GetX çŠ¶æ€ç®¡ç†æºç åˆ†æ"></a>ä¸‰ã€GetX çŠ¶æ€ç®¡ç†æºç åˆ†æ</h2><p>ä¸Šé¢æ— è®ºæ˜¯ GetBuilder è¿˜æ˜¯ Obx æ¨¡å¼ï¼Œå…¶å®å°±æ˜¯å¯¹<strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>çš„ä¸€ä¸ªåº”ç”¨ã€‚</p><p>ä»”ç»†åˆ†æï¼Œä»–ä»¬éƒ½æœ‰ä¸€äº›å…±åŒç‚¹ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ª logic</p><p>GetBuilderLogic ç»§æ‰¿äº† GetxControllerï¼Œå®é™…å®ƒå°±å˜æˆäº†ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œç„¶åè°ƒç”¨ GetxController çš„ update æ–¹æ³•é€šçŸ¥è§‚å¯Ÿè€…å»æ›´æ–° UI</p><p>ObxLogic è™½æ²¡æœ‰ç»§æ‰¿ GetxControllerï¼Œä½†ç»™å˜é‡æ·»åŠ äº†<code>.obs</code>åç¼€ï¼Œä½¿å¾—å®ƒå˜æˆäº†ä¸€ä¸ªå“åº”å¼å˜é‡ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰ï¼Œå½“å®ƒæ”¹å˜çš„æ—¶å€™å°±ä¼šé€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–° UI</p><p>2ã€ä½¿ç”¨ Get.put æ–¹æ³•è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå¯¹ logic è¿›è¡Œç®¡ç†</p><p>3ã€GetBuilder ä½¿ç”¨ GetBuilder ç®¡ç†æ¨¡å¼ï¼Œå†…éƒ¨åšçš„ä¸»è¦äº‹æƒ…ï¼š</p><blockquote><p>1ã€ä» Get ä¸­å–å‡ºä¾èµ–æ³¨å…¥çš„å®ä¾‹ï¼Œå»ºç«‹è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…çš„ç»‘å®šå…³ç³»</p><p>2ã€å¯¹ StatefulWidget è¿›è¡Œäº†å°è£…ï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡ setState å»è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</p></blockquote><p>4ã€Obx ä½¿ç”¨ Obx ç®¡ç†æ¨¡å¼ï¼Œå†…éƒ¨åšçš„ä¸»è¦äº‹æƒ…ï¼š</p><blockquote><p>1ã€ä½¿ç”¨äº†ä¸€ä¸ªä¸­é—´å±‚ RxInterface å»ºç«‹è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…çš„ç»‘å®šå…³ç³»</p><p>2ã€å¯¹ StatefulWidget è¿›è¡Œäº†å°è£…ï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡ setState å»è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</p></blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ­£å¼è¿›å…¥æºç åˆ†æã€‚</p><h3 id="3-1ã€ä¾èµ–æ³¨å…¥ç®¡ç†"><a href="#3-1ã€ä¾èµ–æ³¨å…¥ç®¡ç†" class="headerlink" title="3.1ã€ä¾èµ–æ³¨å…¥ç®¡ç†"></a>3.1ã€ä¾èµ–æ³¨å…¥ç®¡ç†</h3><p>ä» Get.put ä¸ºå…¥å£è¿›è¡Œåˆ†æï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Get#put</span><br>S put&lt;S&gt;(S dependency,<br>         &#123;<span class="hljs-built_in">String?</span> tag,<br>         <span class="hljs-built_in">bool</span> permanent = <span class="hljs-keyword">false</span>,<br>         InstanceBuilderCallback&lt;S&gt;? builder&#125;) =&gt;<br>     GetInstance().put&lt;S&gt;(dependency, tag: tag, permanent: permanent);<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€è¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ã€‚åç»­æˆ‘ä»¬éœ€è¦é€šè¿‡æ³›å‹ç±»å‹ + tag å»ç”Ÿæˆå­˜å‚¨ä¾èµ–æ³¨å…¥å®ä¾‹çš„ key</p><p>2ã€å†…éƒ¨ä½¿ç”¨äº†<strong>æ¡¥æ¥æ¨¡å¼</strong>ï¼Œå°†å…·ä½“å®ç°äº¤ç»™äº† GetInstance</p><p>æ¥ç€çœ‹ GetInstanceï¼Œä»…è´´å‡ºå…³é”®ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetInstance</span> </span>&#123;<br>  <br>  <span class="hljs-comment">//å•ä¾‹</span><br>  <span class="hljs-keyword">factory</span> GetInstance() =&gt; _getInstance ??= <span class="hljs-keyword">const</span> GetInstance._();<br>  <span class="hljs-keyword">const</span> GetInstance._();<br>  <span class="hljs-keyword">static</span> GetInstance? _getInstance;<br>  <br>  <span class="hljs-comment">//å­˜å‚¨ä¾èµ–æ³¨å…¥å®ä¾‹çš„ mapï¼Œ_InstanceBuilderFactory æ˜¯ä¸€ä¸ªå·¥å‚ç±»</span><br>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, _InstanceBuilderFactory&gt; _singl = &#123;&#125;;<br><br>  <span class="hljs-comment">//å…ˆè¿›è¡Œ insert æ’å…¥ï¼Œåœ¨é€šè¿‡ find æŸ¥æ‰¾å®ä¾‹</span><br>  S put&lt;S&gt;(<br>    S dependency, &#123;<br>    <span class="hljs-built_in">String?</span> tag,<br>    <span class="hljs-built_in">bool</span> permanent = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-meta">@deprecated</span> InstanceBuilderCallback&lt;S&gt;? builder,<br>  &#125;) &#123;<br>    _insert(<br>        isSingleton: <span class="hljs-keyword">true</span>,<br>        name: tag,<br>        permanent: permanent,<br>        builder: builder ?? (() =&gt; dependency));<br>    <span class="hljs-keyword">return</span> find&lt;S&gt;(tag: tag);<br>  &#125;<br>  <br>  <span class="hljs-comment">//ç”Ÿæˆ keyï¼Œç„¶ååˆ›å»ºä¾èµ–æ³¨å…¥å®ä¾‹å·¥å‚ï¼Œåœ¨å°†å…¶æ”¾å…¥åˆ° map ä¸­</span><br>  <span class="hljs-keyword">void</span> _insert&lt;S&gt;(&#123;<br>    <span class="hljs-built_in">bool?</span> isSingleton,<br>    <span class="hljs-built_in">String?</span> name,<br>    <span class="hljs-built_in">bool</span> permanent = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">required</span> InstanceBuilderCallback&lt;S&gt; builder,<br>    <span class="hljs-built_in">bool</span> fenix = <span class="hljs-keyword">false</span>,<br>  &#125;) &#123;<br>    <span class="hljs-keyword">final</span> key = _getKey(S, name);<br>    _singl[key] = _InstanceBuilderFactory&lt;S&gt;(<br>        isSingleton,<br>        builder,<br>        permanent,<br>        <span class="hljs-keyword">false</span>,<br>        fenix,<br>        name,<br>    );<br>  &#125;<br>  <br>  <span class="hljs-comment">//ç”Ÿæˆ key çš„è§„åˆ™ï¼šå¦‚æœ tag ä¸ºç©ºï¼Œåˆ™ä¸ºä¼ å…¥çš„æ³›å‹ï¼Œå¦‚æœ tag ä¸ä¸ºç©ºï¼Œåˆ™ä¸ºä¼ å…¥çš„æ³›å‹ + tag</span><br>  <span class="hljs-built_in">String</span> _getKey(<span class="hljs-built_in">Type</span> type, <span class="hljs-built_in">String?</span> name) &#123;<br>    <span class="hljs-keyword">return</span> name == <span class="hljs-keyword">null</span> ? type.toString() : type.toString() + name;<br>  &#125;<br>  <br>  <span class="hljs-comment">//1ã€æ ¹æ®ä¼ å…¥çš„ tag å’Œæ³›å‹ç±»å‹ç”Ÿæˆ keyï¼Œå¹¶é€šè¿‡ key ä» map ä»å»å–ä¾èµ–æ³¨å…¥å®ä¾‹å·¥å‚</span><br>  <span class="hljs-comment">//2ã€å¦‚æœå­˜åœ¨åˆ™é€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼åˆ›å»ºå…·ä½“å®ä¾‹</span><br>  S find&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;) &#123;<br>    <span class="hljs-keyword">final</span> key = _getKey(S, tag);<br>    <span class="hljs-keyword">if</span> (isRegistered&lt;S&gt;(tag: tag)) &#123;<br>      <span class="hljs-keyword">final</span> dep = _singl[key];<br>      <span class="hljs-keyword">if</span> (dep == <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (tag == <span class="hljs-keyword">null</span>) &#123;<br>          <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;Class &quot;<span class="hljs-subst">$S</span>&quot; is not registered&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;Class &quot;<span class="hljs-subst">$S</span>&quot; with tag &quot;<span class="hljs-subst">$tag</span>&quot; is not registered&#x27;</span>;<br>        &#125;<br>      &#125;<br>      <span class="hljs-comment">//_initDependencies å†…éƒ¨æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨ getDependency ç”Ÿæˆå®ä¾‹</span><br>      <span class="hljs-keyword">final</span> i = _initDependencies&lt;S&gt;(name: tag);<br>      <span class="hljs-keyword">return</span> i ?? dep.getDependency() <span class="hljs-keyword">as</span> S;<br>    &#125;  <br>  &#125;<br>  <br>  <span class="hljs-comment">//map ä¸­æ˜¯å¦å­˜åœ¨è¯¥ key</span><br>  <span class="hljs-built_in">bool</span> isRegistered&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;) =&gt; _singl.containsKey(_getKey(S, tag));<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€GetInstance æ˜¯ä¸€ä¸ª<strong>å•ä¾‹ç±»</strong></p><p>2ã€put æ–¹æ³•ä¼šå…ˆè°ƒç”¨å†…éƒ¨çš„ insert æ–¹æ³•ï¼Œç„¶ååœ¨é€šè¿‡ find æŸ¥æ‰¾å®ä¾‹</p><p>3ã€insert æ–¹æ³•ä¼šæ ¹æ®ä¼ å…¥çš„<code>æ³›å‹ + tag</code>ç”Ÿæˆ keyï¼Œç„¶ååˆ›å»ºä¾èµ–æ³¨å…¥å®ä¾‹å·¥å‚ï¼Œæœ€åæ”¾å…¥åˆ° map ä¸­</p><p>4ã€key ç”Ÿæˆçš„è§„åˆ™ï¼š</p><blockquote><p>1ã€å¦‚æœä¼ å…¥çš„ tag ä¸ºç©ºï¼Œåˆ™ key ä¸ºä¼ å…¥çš„æ³›å‹</p><p>2ã€å¦‚æœ tag ä¸ä¸ºç©ºï¼Œåˆ™ key ä¸ºä¼ å…¥çš„æ³›å‹ + tag</p></blockquote><p>5ã€find æ–¹æ³•ä¼šæ ¹æ®ä¼ å…¥çš„<code>tagå’Œæ³›å‹</code>ç”Ÿæˆ keyï¼Œå¹¶é€šè¿‡ key ä» map ä¸­å»å–ä¾èµ–æ³¨å…¥å®ä¾‹å·¥å‚ï¼Œå¦‚æœèƒ½å¤Ÿå–åˆ°ï¼Œåˆ™é€šè¿‡<strong>å·¥å‚æ–¹æ³•æ¨¡å¼</strong>åˆ›å»ºå…·ä½“å®ä¾‹å¹¶è¿”å›</p><p>okï¼Œä¸Šè¿°æˆ‘ä»¬åˆ†æäº† Get.put æ–¹æ³•ï¼Œå®é™…ä¸Šè¿˜æœ‰ deleteï¼ŒlazyPut ç­‰æ–¹æ³•ï¼Œå½“æˆ‘ä»¬çš„é¡µé¢é”€æ¯æ—¶ï¼ŒGetX ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬è¿›è¡Œå®ä¾‹çš„å›æ”¶ï¼Œå…·ä½“ä»£ç å°±ä¸è´´äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹ä¸‹ã€‚</p><h3 id="3-1ã€GetBuilder-Controller-update-çŠ¶æ€ç®¡ç†æ¨¡å¼"><a href="#3-1ã€GetBuilder-Controller-update-çŠ¶æ€ç®¡ç†æ¨¡å¼" class="headerlink" title="3.1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼"></a>3.1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼</h3><p>æ¥ç€çœ‹ GetxController é‡Œé¢åšäº†å•¥ï¼Œä¸ºä»€ä¹ˆç»§æ‰¿å®ƒå°±èƒ½æˆä¸ºä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Ÿ</p><p>ä¸Šæºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetxController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DisposableInterface</span></span><br><span class="hljs-class">    <span class="hljs-title">with</span> <span class="hljs-title">ListenableMixin</span>, <span class="hljs-title">ListNotifierMixin</span> </span>&#123;<br> <br>  <span class="hljs-comment">//é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–° UIï¼šæ ¹æ®è§‚å¯Ÿè€…æ˜¯å¦è®¾ç½®äº† id æ›´æ–° ui</span><br>  <span class="hljs-comment">//å¦‚æœä¼ å…¥äº† idï¼Œåˆ™åªé€šçŸ¥è®¾ç½®äº†è¯¥ id çš„è§‚å¯Ÿè€…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…</span><br>  <span class="hljs-keyword">void</span> update([<span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">Object</span>&gt;? ids, <span class="hljs-built_in">bool</span> condition = <span class="hljs-keyword">true</span>]) &#123;<br>    <span class="hljs-keyword">if</span> (!condition) &#123;<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (ids == <span class="hljs-keyword">null</span>) &#123;<br>      refresh();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> id <span class="hljs-keyword">in</span> ids) &#123;<br>        refreshGroup(id);<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€GetxController å†…éƒ¨å°±ä¸€ä¸ª update æ–¹æ³•ï¼Œä¸»è¦é€»è¾‘ï¼š</p><blockquote><p> 1ã€é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–° UIï¼šæ ¹æ®è§‚å¯Ÿè€…æ˜¯å¦è®¾ç½®äº† id æ›´æ–° ui</p><p>  2ã€å¦‚æœä¼ å…¥äº† idï¼Œåˆ™åªé€šçŸ¥è®¾ç½®äº†è¯¥ id çš„è§‚å¯Ÿè€…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…</p></blockquote><p>2ã€update å†…éƒ¨è°ƒç”¨çš„æ˜¯ refresh ç³»åˆ—æ–¹æ³•ï¼Œè¿™æ˜¯ ListNotifierMixin ç»™å®ƒæä¾›çš„ï¼Œå®é™…å°±æ˜¯å› ä¸º with äº† ListNotifierMixin æ‰è®©å®ƒæˆä¸ºäº†ä¸€ä¸ªè¢«è§‚å¯Ÿè€…</p><p>ç»§ç»­è·Ÿè¿› ListNotifierMixin ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">mixin</span> ListNotifierMixin <span class="hljs-keyword">on</span> ListenableMixin &#123;<br><br>  <span class="hljs-comment">//æ•°ç»„ï¼Œç”¨äºå­˜æ”¾è§‚å¯Ÿè€…</span><br>  <span class="hljs-built_in">List</span>&lt;GetStateUpdate?&gt;? _updaters = &lt;GetStateUpdate?&gt;[];<br><br>  <span class="hljs-comment">//mapï¼Œç”¨äºç»‘å®šè®¾ç½®äº† id çš„è§‚å¯Ÿè€…</span><br>  HashMap&lt;<span class="hljs-built_in">Object?</span>, <span class="hljs-built_in">List</span>&lt;GetStateUpdate&gt;&gt;? _updatersGroupIds =<br>      HashMap&lt;<span class="hljs-built_in">Object?</span>, <span class="hljs-built_in">List</span>&lt;GetStateUpdate&gt;&gt;();<br><br>  <span class="hljs-comment">//å®é™…å†…éƒ¨è°ƒç”¨çš„ _notifyUpdate</span><br>  <span class="hljs-meta">@protected</span><br>  <span class="hljs-keyword">void</span> refresh() &#123;<br>    <span class="hljs-keyword">assert</span>(_debugAssertNotDisposed());<br>    _notifyUpdate();<br><br>  &#125;<br><br>  <span class="hljs-comment">//é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–°æ›´æ–° UI</span><br>  <span class="hljs-keyword">void</span> _notifyUpdate() &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> _updaters!) &#123;<br>      element!();<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//æ ¹æ® id é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–°æ›´æ–° UI</span><br>  <span class="hljs-keyword">void</span> _notifyIdUpdate(<span class="hljs-built_in">Object</span> id) &#123;<br>    <span class="hljs-keyword">if</span> (_updatersGroupIds!.containsKey(id)) &#123;<br>      <span class="hljs-keyword">final</span> listGroup = _updatersGroupIds![id]!;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> listGroup) &#123;<br>        item();<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//å®é™…å†…éƒ¨è°ƒç”¨çš„ _notifyIdUpdate</span><br>  <span class="hljs-meta">@protected</span><br>  <span class="hljs-keyword">void</span> refreshGroup(<span class="hljs-built_in">Object</span> id) &#123;<br>    <span class="hljs-keyword">assert</span>(_debugAssertNotDisposed());<br>    _notifyIdUpdate(id);<br>  &#125;<br><br>  <span class="hljs-comment">//ç§»é™¤è§‚å¯Ÿè€…</span><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> removeListener(VoidCallback listener) &#123;<br>    <span class="hljs-keyword">assert</span>(_debugAssertNotDisposed());<br>    _updaters!.remove(listener);<br>  &#125;<br><br>  <span class="hljs-comment">//æ ¹æ® id ç§»é™¤è§‚å¯Ÿè€…</span><br>  <span class="hljs-keyword">void</span> removeListenerId(<span class="hljs-built_in">Object</span> id, VoidCallback listener) &#123;<br>    <span class="hljs-keyword">assert</span>(_debugAssertNotDisposed());<br>    <span class="hljs-keyword">if</span> (_updatersGroupIds!.containsKey(id)) &#123;<br>      _updatersGroupIds![id]!.remove(listener);<br>    &#125;<br>    _updaters!.remove(listener);<br>  &#125;<br><br>  <span class="hljs-comment">//æ·»åŠ è§‚å¯Ÿè€…</span><br>  <span class="hljs-meta">@override</span><br>  Disposer addListener(GetStateUpdate listener) &#123;<br>    <span class="hljs-keyword">assert</span>(_debugAssertNotDisposed());<br>    _updaters!.add(listener);<br>    <span class="hljs-keyword">return</span> () =&gt; _updaters!.remove(listener);<br>  &#125;<br><br>  <span class="hljs-comment">//æ ¹æ® id æ·»åŠ è§‚å¯Ÿè€…</span><br>  Disposer addListenerId(<span class="hljs-built_in">Object?</span> key, GetStateUpdate listener) &#123;<br>    _updatersGroupIds![key] ??= &lt;GetStateUpdate&gt;[];<br>    _updatersGroupIds![key]!.add(listener);<br>    <span class="hljs-keyword">return</span> () =&gt; _updatersGroupIds![key]!.remove(listener);<br>  &#125;<br>  <br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸å°±æ˜¯å…¸å‹çš„è¢«è§‚å¯Ÿè€…çš„å®ç°å—ï¼Ÿ</p><p>1ã€GetStateUpdate å°±æ˜¯è§‚å¯Ÿè€…ï¼Œå®é™…å®ƒå°±æ˜¯ä¸€ä¸ªå›è°ƒï¼Œä½¿ç”¨äº† typedef è¿›è¡Œå®šä¹‰ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">typedef</span> GetStateUpdate = <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>();<br></code></pre></td></tr></table></figure><p>2ã€å†…éƒ¨å°è£…äº†æ·»åŠ ï¼Œåˆ é™¤ï¼Œé€šçŸ¥è§‚å¯Ÿè€…ç­‰ä¸€ç³»åˆ—çš„æ“ä½œï¼Œè¿˜ä¸æ‡‚è¢«è§‚å¯Ÿè€…æ¨¡å¼çš„å¯ä»¥çœ‹æˆ‘è¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7160363585028227086#heading-40">ä¼ é€é—¨</a>ã€‚</p><p>okï¼Œç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†è¢«è§‚å¯Ÿè€…ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•æ·»åŠ è§‚å¯Ÿè€…ã€‚</p><p>GetBuilder æºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetBuilder</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GetxController</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-comment">//....</span><br><br>  <span class="hljs-meta">@override</span><br>  GetBuilderState&lt;T&gt; createState() =&gt; GetBuilderState&lt;T&gt;();<br>&#125;<br><br><span class="hljs-comment">//2</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetBuilderState</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GetxController</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">GetBuilder</span>&lt;<span class="hljs-title">T</span>&gt;&gt;</span><br><span class="hljs-class">    <span class="hljs-title">with</span> <span class="hljs-title">GetStateUpdaterMixin</span> </span>&#123;<br>  <br>  <span class="hljs-comment">//ä¾èµ–æ³¨å…¥å®ä¾‹</span><br>  T? controller;<br>  <span class="hljs-built_in">Object?</span> _filter;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br><br>    <span class="hljs-comment">//æ ¹æ®æ³›å‹å’Œtagç”Ÿæˆ keyï¼Œçœ‹è¯¥ key æ˜¯å¦å­˜åœ¨ map ä¸­</span><br>    <span class="hljs-keyword">var</span> isRegistered = GetInstance().isRegistered&lt;T&gt;(tag: widget.tag);<br><br>    <span class="hljs-comment">//å­˜åœ¨åˆ™ä» map ä¸­å–å‡ºæ¥å¹¶é€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼åˆ›å»ºå®ä¾‹å¹¶èµ‹å€¼ç»™ controller</span><br>    <span class="hljs-keyword">if</span> (widget.global) &#123;<br>      <span class="hljs-keyword">if</span> (isRegistered) &#123;<br>        controller = GetInstance().find&lt;T&gt;(tag: widget.tag);<br>      &#125; <br>    &#125; <br><br>    <span class="hljs-comment">//æ·»åŠ è§‚å¯Ÿè€…</span><br>    _subscribeToController();<br>  &#125;<br><br><br>  <span class="hljs-comment">//æ ¹æ® id æ˜¯å¦ä¸º null è¿›è¡Œè§‚å¯Ÿè€…çš„æ·»åŠ </span><br>  <span class="hljs-keyword">void</span> _subscribeToController() &#123;<br>    _remove?.call();<br>    _remove = (widget.id == <span class="hljs-keyword">null</span>)<br>        ? controller?.addListener(<br>            _filter != <span class="hljs-keyword">null</span> ? _filterUpdate : getUpdate,<br>          )<br>        : controller?.addListenerId(<br>            widget.id,<br>            _filter != <span class="hljs-keyword">null</span> ? _filterUpdate : getUpdate,<br>          );<br>  &#125;<br><br>  <span class="hljs-comment">//_filterUpdate å†…éƒ¨æœ€ç»ˆä¹Ÿæ˜¯è°ƒçš„ getUpdate</span><br>  <span class="hljs-keyword">void</span> _filterUpdate() &#123;<br>    <span class="hljs-keyword">var</span> newFilter = widget.filter!(controller!);<br>    <span class="hljs-keyword">if</span> (newFilter != _filter) &#123;<br>      _filter = newFilter;<br>      getUpdate();<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//å½“é¡µé¢é”€æ¯æ—¶ï¼Œç§»é™¤ä¾èµ–æ³¨å…¥çš„å®ä¾‹</span><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> dispose() &#123;<br>    <span class="hljs-keyword">super</span>.dispose();<br>    widget.dispose?.call(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-keyword">if</span> (_isCreator! || widget.assignId) &#123;<br>      <span class="hljs-keyword">if</span> (widget.autoRemove &amp;&amp; GetInstance().isRegistered&lt;T&gt;(tag: widget.tag)) &#123;<br>        GetInstance().delete&lt;T&gt;(tag: widget.tag);<br>      &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> widget.builder(controller!);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//3</span><br><span class="hljs-keyword">mixin</span> GetStateUpdaterMixin&lt;T <span class="hljs-keyword">extends</span> StatefulWidget&gt; <span class="hljs-keyword">on</span> State&lt;T&gt; &#123;<br><br>  <span class="hljs-comment">//æœ€ç»ˆ getUpdate è¿˜æ˜¯è°ƒç”¨çš„ setState è¿›è¡ŒçŠ¶æ€æ›´æ–°</span><br>  <span class="hljs-keyword">void</span> getUpdate() &#123;<br>    <span class="hljs-keyword">if</span> (mounted) setState(() &#123;&#125;);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€GetBuilder å¯¹ StatefulWidget è¿›è¡Œäº†å°è£…ï¼Œå…·ä½“é€»è¾‘åœ¨ GetBuilderState ä¸­</p><p>2ã€GetBuilderState ä¸­ï¼š</p><blockquote><p>1ã€æ ¹æ®<code>æ³›å‹å’Œtag</code>ç”Ÿæˆ keyï¼Œç„¶åå»å–ä¾èµ–æ³¨å…¥å®ä¾‹</p><p>2ã€æ ¹æ® id æ˜¯å¦ä¸º null è¿›è¡Œè§‚å¯Ÿè€…ï¼ˆgetUpdateï¼‰çš„æ·»åŠ </p><p>3ã€å½“é¡µé¢é”€æ¯æ—¶ï¼Œç§»é™¤ä¾èµ–æ³¨å…¥çš„å®ä¾‹</p></blockquote><p>3ã€getUpdate çš„å…·ä½“å®ç°åœ¨ GetStateUpdaterMixin ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨ setState è¿›è¡Œ UI çš„æ›´æ–°</p><p>å½“æˆ‘ä»¬ç‚¹å‡» buttonï¼Œå°±ä¼šè°ƒç”¨ update æ–¹æ³•ï¼Œé€šçŸ¥è§‚å¯Ÿè€…è¿›è¡Œ UI çš„åˆ·æ–°ã€‚</p><p>okï¼Œè‡³æ­¤å°±å®Œæˆäº† GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼çš„æºç åˆ†æã€‚</p><h3 id="3-2ã€Obx-obs-å“åº”å¼ç®¡ç†æ¨¡å¼"><a href="#3-2ã€Obx-obs-å“åº”å¼ç®¡ç†æ¨¡å¼" class="headerlink" title="3.2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼"></a>3.2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼</h3><p>æˆ‘ä»¬ä»<code>0.obs </code>ä¸ºå…¥å£è¿›è¡Œåˆ†æï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">extension</span> IntExtension <span class="hljs-keyword">on</span> <span class="hljs-built_in">int</span> &#123;<br>  RxInt <span class="hljs-keyword">get</span> obs =&gt; RxInt(<span class="hljs-keyword">this</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯ int çš„ä¸€ä¸ªæ‰©å±•æ–¹æ³•ï¼Œå†…éƒ¨å®šä¹‰äº†ä¸€ä¸ª get æ–¹æ³•ï¼Œget æ–¹æ³•è°ƒç”¨äº† RxIntã€‚</p><p>è·Ÿè¿›åˆ° RxIntï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RxInt</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Rx</span>&lt;<span class="hljs-title">int</span>&gt; </span>&#123;<br>  RxInt(<span class="hljs-built_in">int</span> initial) : <span class="hljs-keyword">super</span>(initial);<br><br>  RxInt <span class="hljs-keyword">operator</span> +(<span class="hljs-built_in">int</span> other) &#123;<br>    value = value + other;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>  &#125;<br><br>  RxInt <span class="hljs-keyword">operator</span> -(<span class="hljs-built_in">int</span> other) &#123;<br>    value = value - other;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€RxInt ç»§æ‰¿äº† Rx æ³›å‹ç±»</p><p>2ã€è¿›è¡Œäº†æ“ä½œç¬¦ï¼ˆ+ï¼Œ-ï¼‰çš„é‡è½½</p><p>ç»§ç»­çœ‹ Rxï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//Rxï¼Œå…·ä½“é€»è¾‘äº¤ç»™äº† _RxImpl</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rx</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">_RxImpl</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>  Rx(T initial) : <span class="hljs-keyword">super</span>(initial);<br><br>  <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//_RxImplï¼Œå…·ä½“é€»è¾‘äº¤ç»™äº† RxNotifier å’Œ RxObjectMixin</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_RxImpl</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">RxNotifier</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">with</span> <span class="hljs-title">RxObjectMixin</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//RxNotifier å°†å…·ä½“é€»è¾‘äº¤ç»™äº† RxInterface å’Œ NotifyManagerï¼ŒRxInterface æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“å®ç°è¿˜æ˜¯åœ¨ NotifyManager ä¸­</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RxNotifier</span>&lt;<span class="hljs-title">T</span>&gt; = <span class="hljs-title">RxInterface</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">with</span> <span class="hljs-title">NotifyManager</span>&lt;<span class="hljs-title">T</span>&gt;;</span><br><span class="hljs-class"></span><br><span class="hljs-class">//<span class="hljs-title">GetStream</span>ï¼šè¢«è§‚å¯Ÿè€…çš„å…·ä½“å®ç°</span><br><span class="hljs-class"><span class="hljs-title">class</span> <span class="hljs-title">GetStream</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>  <br>  <span class="hljs-comment">//çœŸæ­£é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–° ui</span><br>  <span class="hljs-keyword">void</span> _notifyData(T data) &#123;<br>    _isBusy = <span class="hljs-keyword">true</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> item <span class="hljs-keyword">in</span> _onData!) &#123;<br>      <span class="hljs-keyword">if</span> (!item.isPaused) &#123;<br>        item._data?.call(data);<br>      &#125;<br>    &#125;<br>    _isBusy = <span class="hljs-keyword">false</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//é€šçŸ¥è§‚å¯Ÿè€…ï¼Œå†…éƒ¨ä¼šè°ƒç”¨ _notifyData</span><br>  <span class="hljs-keyword">void</span> add(T event) &#123;<br>    <span class="hljs-comment">//...</span><br>    _value = event;<br>    _notifyData(event);<br>  &#125;<br><br>  <br>  <span class="hljs-comment">//æ·»åŠ è§‚å¯Ÿè€…</span><br>  LightSubscription&lt;T&gt; listen(<span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>(T event) onData,<br>      &#123;<span class="hljs-built_in">Function?</span> onError, <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>()? onDone, <span class="hljs-built_in">bool?</span> cancelOnError&#125;) &#123;<br>    <span class="hljs-keyword">final</span> subs = LightSubscription&lt;T&gt;(<br>      removeSubscription,<br>      onPause: onPause,<br>      onResume: onResume,<br>      onCancel: onCancel,<br>    )<br>      ..onData(onData)<br>      ..onError(onError)<br>      ..onDone(onDone)<br>      ..cancelOnError = cancelOnError;<br>    addSubscription(subs);<br>    onListen?.call();<br>    <span class="hljs-keyword">return</span> subs;<br>  &#125;<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><br><span class="hljs-comment">//NotifyManagerï¼šå¯¹ RxInterface çš„å…·ä½“å®ç°</span><br><span class="hljs-keyword">mixin</span> NotifyManager&lt;T&gt; &#123;<br>  <br>  <span class="hljs-comment">//å†…éƒ¨æ‹¥æœ‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…</span><br>  GetStream&lt;T&gt; subject = GetStream&lt;T&gt;();<br><br>  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> canUpdate =&gt; _subscriptions.isNotEmpty;<br><br>  <span class="hljs-comment">//ä¼ å…¥çš„è¢«è§‚å¯Ÿè€…ä¼šæ‰§è¡Œæ·»åŠ è§‚å¯Ÿè€…çš„æ“ä½œï¼šGetStream.listenï¼Œè§‚å¯Ÿè€…ä¸­åˆä¼šè§¦å‘å†…éƒ¨çš„è¢«è§‚å¯Ÿè€…å‘é€é€šçŸ¥ç»™å®ƒæ‰€ç»‘å®šçš„è§‚å¯Ÿè€…</span><br>  <span class="hljs-comment">//è¿™é‡Œéœ€è¦æ³¨æ„ï¼šGetStream.listen æ–¹æ³•æ˜¯æ·»åŠ è§‚å¯Ÿè€…ï¼Œè€Œ GetStream.add æ˜¯é€šçŸ¥è§‚å¯Ÿè€…</span><br>  <span class="hljs-keyword">void</span> addListener(GetStream&lt;T&gt; rxGetx) &#123;<br>    <span class="hljs-keyword">if</span> (!_subscriptions.containsKey(rxGetx)) &#123;<br>      <span class="hljs-keyword">final</span> subs = rxGetx.listen((data) &#123;<br>        <span class="hljs-keyword">if</span> (!subject.isClosed) subject.add(data);<br>      &#125;);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//listen ä¸­ä¼šè°ƒç”¨å†…éƒ¨çš„è¢«è§‚å¯Ÿè€…æ·»åŠ è§‚å¯Ÿè€…</span><br>  StreamSubscription&lt;T&gt; listen(<br>    <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>(T) onData, &#123;<br>    <span class="hljs-built_in">Function?</span> onError,<br>    <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>()? onDone,<br>    <span class="hljs-built_in">bool?</span> cancelOnError,<br>  &#125;) =&gt;<br>      subject.listen(<br>        onData,<br>        onError: onError,<br>        onDone: onDone,<br>        cancelOnError: cancelOnError ?? <span class="hljs-keyword">false</span>,<br>      );<br>&#125;<br><br><span class="hljs-comment">//RxInterfaceï¼šå†…éƒ¨æœªå®ç°çš„æ–¹æ³•äº¤ç”±å…¶ä»–ç±»ï¼Œä¸»è¦å…³æ³¨ notifyChildren æ–¹æ³•</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RxInterface</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>  <span class="hljs-keyword">static</span> RxInterface? proxy;<br><br>  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> canUpdate;<br>  <span class="hljs-keyword">void</span> addListener(GetStream&lt;T&gt; rxGetx);<br>  <span class="hljs-keyword">void</span> close();<br>  StreamSubscription&lt;T&gt; listen(<span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>(T event) onData,<br>      &#123;<span class="hljs-built_in">Function?</span> onError, <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>()? onDone, <span class="hljs-built_in">bool?</span> cancelOnError&#125;);<br><br>  <span class="hljs-comment">//å®Œæˆ RxInterface.proxy çš„èµ‹å€¼ï¼Œè§†å›¾çš„æ›´æ–°ï¼Œè®©æ•´ä¸ªé€»è¾‘å½¢æˆé—­ç¯</span><br>  <span class="hljs-keyword">static</span> T notifyChildren&lt;T&gt;(RxNotifier observer, ValueGetter&lt;T&gt; builder) &#123;<br>    <span class="hljs-keyword">final</span> _observer = RxInterface.proxy;<br>    RxInterface.proxy = observer;<br>    <span class="hljs-keyword">final</span> result = builder();<br>    <span class="hljs-comment">//...</span><br>    RxInterface.proxy = _observer;<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//RxObjectMixinï¼šä¸»è¦å…³æ³¨ set å’Œ get æ–¹æ³•</span><br><span class="hljs-keyword">mixin</span> RxObjectMixin&lt;T&gt; <span class="hljs-keyword">on</span> NotifyManager&lt;T&gt; &#123;<br>  <span class="hljs-keyword">late</span> T _value;<br>  <span class="hljs-comment">//æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡é‡å»º</span><br>  <span class="hljs-built_in">bool</span> firstRebuild = <span class="hljs-keyword">true</span>;<br><br>  <span class="hljs-comment">//set æ–¹æ³•</span><br>  <span class="hljs-keyword">set</span> value(T val) &#123;<br>    <span class="hljs-comment">//å¦‚æœä¼ å…¥çš„å€¼å’Œå½“å‰å€¼ç›¸ç­‰ä¸”ä¸æ˜¯ç¬¬ä¸€æ¬¡é‡å»ºåˆ™ä¸å¤„ç†</span><br>    <span class="hljs-keyword">if</span> (_value == val &amp;&amp; !firstRebuild) <span class="hljs-keyword">return</span>;<br>    firstRebuild = <span class="hljs-keyword">false</span>;<br>    <span class="hljs-comment">//è¿›è¡Œèµ‹å€¼æ“ä½œ</span><br>    _value = val;<br>    <span class="hljs-comment">//é€šçŸ¥è§‚å¯Ÿè€…åˆ·æ–° UI</span><br>    subject.add(_value);<br>  &#125;<br>  <br>  <span class="hljs-comment">//get æ–¹æ³•</span><br>  T <span class="hljs-keyword">get</span> value &#123;<br>    <span class="hljs-comment">//è¿›è¡Œè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…å…³ç³»çš„ç»‘å®šï¼Œå…·ä½“å®ç°åœ¨ NotifyManager ä¸­</span><br>    RxInterface.proxy?.addListener(subject);<br>    <span class="hljs-keyword">return</span> _value;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹äº†ä¸Šè¿°ä»£ç ä½ å¯èƒ½ä¼šæœ‰ä¸€äº›å¤´æ™•ï¼Œç°åœ¨æˆ‘ä»¬å¥½å¥½ç†ä¸€ä¸‹æ•´ä¸ªæµç¨‹ï¼š</p><p>å½“æˆ‘ä»¬è¿›å…¥é¡µé¢è°ƒç”¨<code>0.obs</code>çš„æ—¶å€™ï¼Œæœ€ç»ˆä¼šè§¦å‘ RxObjectMixin ä¸­çš„ get æ–¹æ³•ï¼Œ RxObjectMixin ä¸­çš„ get æ–¹æ³•å†…éƒ¨ä¼šèµ°ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€RxInterface.proxy æ˜¯ RxInterface çš„ä¸€ä¸ªé™æ€ä»£ç†</span><br>RxInterface.proxy?.addListener(subject);<br><br><span class="hljs-comment">//2ã€å…·ä½“å®ç°åœ¨ NotifyManager ä¸­</span><br><span class="hljs-keyword">void</span> addListener(GetStream&lt;T&gt; rxGetx) &#123;<br>    <span class="hljs-keyword">if</span> (!_subscriptions.containsKey(rxGetx)) &#123;<br>      <span class="hljs-keyword">final</span> subs = rxGetx.listen((data) &#123;<br>        <span class="hljs-keyword">if</span> (!subject.isClosed) subject.add(data);<br>      &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç•™ä¸ªç–‘é—®ğŸ¤”ï¸ï¼š<strong>RxInterface.proxy æ˜¯åœ¨å“ªé‡Œè¢«èµ‹å€¼çš„å‘¢ï¼Ÿ</strong></p><p>è¿™é‡Œå®åˆ™æœ‰ä¸¤å±‚è¢«è§‚å¯Ÿè€…å…³ç³»çš„ç»‘å®šï¼Œä¸€å±‚æ˜¯ä¼ å…¥çš„è¢«è§‚å¯Ÿè€…ï¼Œä¸€å±‚æ˜¯ NotifyManager å†…éƒ¨æŒæœ‰çš„è¢«è§‚å¯Ÿè€…ï¼š</p><blockquote><p>1ã€ä¼ å…¥çš„è¢«è§‚å¯Ÿè€…ä¼šè¿›è¡Œæ·»åŠ è§‚å¯Ÿè€…çš„æ“ä½œ</p><p>2ã€è§‚å¯Ÿè€…å†…éƒ¨åˆä¼šè§¦å‘å†…éƒ¨æŒæœ‰çš„è¢«è§‚å¯Ÿè€…å‘é€äº‹ä»¶é€šçŸ¥å®ƒæ‰€ç»‘å®šçš„è§‚å¯Ÿè€…</p></blockquote><p>ç”»ä¸ªå›¾ç†ä¸€ç†ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04334f2ee18443b78e2670146fc4d111~tplv-k3u1fbpfcp-watermark.image?" alt="image-20230227160343616.png" width="100%" /><p>é‚£ä¹ˆå†…éƒ¨æŒæœ‰çš„è¢«è§‚å¯Ÿè€…åœ¨å“ªé‡Œè¿›è¡Œäº†è§‚å¯Ÿè€…çš„æ·»åŠ å‘¢ï¼Ÿ</p><p>æƒ³è¦çŸ¥é“ç­”æ¡ˆï¼Œå°±è¦çœ‹çœ‹ Obx çš„æºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Obx ç»§æ‰¿äº† ObxWidget</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Obx</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ObxWidget</span> </span>&#123;<br>  <span class="hljs-keyword">final</span> WidgetCallback builder;<br><br>  <span class="hljs-keyword">const</span> Obx(<span class="hljs-keyword">this</span>.builder);<br><br>  <span class="hljs-meta">@override</span><br>  Widget build() =&gt; builder();<br>&#125;<br><br><span class="hljs-comment">//2ã€Obx ç»§æ‰¿äº† StatefulWidgetï¼Œæ¥ç€çœ‹ _ObxState</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObxWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br> <br>  <br>  <span class="hljs-meta">@override</span><br>  _ObxState createState() =&gt; _ObxState();<br><br>&#125;<br><br><span class="hljs-comment">//3ã€_ObxState</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_ObxState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">ObxWidget</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//æŒæœ‰ RxNotifierï¼ŒRxNotifier çš„å…·ä½“å®ç°æ˜¯ RxInterface + NotifyManager</span><br>  <span class="hljs-keyword">final</span> _observer = RxNotifier();<br>  <span class="hljs-keyword">late</span> StreamSubscription subs;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br>    <span class="hljs-comment">//æ·»åŠ è§‚å¯Ÿè€…ï¼šlisten ä¸­ä¼šè°ƒç”¨å†…éƒ¨çš„è¢«è§‚å¯Ÿè€…æ·»åŠ è§‚å¯Ÿè€…</span><br>    subs = _observer.listen(_updateTree, cancelOnError: <span class="hljs-keyword">false</span>);<br>  &#125;<br><br>  <span class="hljs-comment">//è§‚å¯Ÿè€…å†…éƒ¨ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ï¼Œæœ€ç»ˆè¿˜æ˜¯è°ƒç”¨ setState è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</span><br>  <span class="hljs-keyword">void</span> _updateTree(_) &#123;<br>    <span class="hljs-keyword">if</span> (mounted) &#123;<br>      setState(() &#123;&#125;);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> dispose() &#123;<br>    subs.cancel();<br>    _observer.close();<br>    <span class="hljs-keyword">super</span>.dispose();<br>  &#125;<br><br>  <span class="hljs-comment">//é¡µé¢æ„å»ºçš„æ—¶å€™ï¼Œè°ƒç”¨äº† RxInterface.notifyChildrenï¼Œè¿™é‡Œé¢å¯¹ RxInterface.proxy è¿›è¡Œäº†èµ‹å€¼ï¼Œé¡µé¢çš„æ„å»º</span><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) =&gt;<br>      RxInterface.notifyChildren(_observer, widget.build);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€å®Œæˆäº† Rx å†…éƒ¨è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…çš„ç»‘å®šï¼Œè§‚å¯Ÿè€…å†…éƒ¨è¿˜æ˜¯è°ƒç”¨ setState è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</p><p>2ã€é€šè¿‡ RxInterface.notifyChildren æ–¹æ³•å®Œæˆ RxInterface.proxy çš„èµ‹å€¼</p><p>è¿™é‡Œä¹Ÿå°±å›ç­”äº†æˆ‘ä»¬ä¸Šé¢ç•™çš„ç–‘é—®ã€‚</p><p>ä½†åˆå‡ºç°äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šRxInterface.proxy æ˜¯ä¸€ä¸ªé™æ€å˜é‡ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œé‚£ GetX æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ</p><p>å…·ä½“åœ¨çœ‹ä¸€çœ¼ RxInterface.notifyChildren æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">static</span> T notifyChildren&lt;T&gt;(RxNotifier observer, ValueGetter&lt;T&gt; builder) &#123;<br>    <span class="hljs-keyword">final</span> _observer = RxInterface.proxy;<br>    RxInterface.proxy = observer;<br>    <span class="hljs-keyword">final</span> result = builder();<br>    <span class="hljs-comment">//...</span><br>    RxInterface.proxy = _observer;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€å°†ä¼ å…¥çš„ observer èµ‹å€¼ç»™ RxInterface.proxy</p><p>2ã€è¿›è¡Œé¡µé¢è§†å›¾çš„æ„å»º</p><p>3ã€å¾…é¡µé¢æ„å»ºå®Œæˆï¼Œåˆå°† RxInterface.proxy ç½®ä¸º null</p><p>ä¸Šè¿°æ“ä½œå°±é¿å…äº† RxInterface.proxy å†…å­˜æ³„æ¼ï¼Œä¹Ÿè®©æ•´ä¸ªé€»è¾‘å½¢æˆäº†é—­ç¯ã€‚</p><p>å½“æˆ‘ä»¬æ‰§è¡Œ count++ æ“ä½œæ—¶ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObxLogic</span> </span>&#123;<br><br>  <span class="hljs-keyword">var</span> count = <span class="hljs-number">0.</span>obs;<br><br>  <span class="hljs-keyword">void</span> increase()&#123;<br>    count++;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼šè°ƒç”¨ RxObjectMixin çš„ set æ–¹æ³•é€šçŸ¥è§‚å¯Ÿè€…ï¼Œè§‚å¯Ÿè€…å†…éƒ¨ä¼šæ‰§è¡Œ setState æ–¹æ³•ï¼ŒsetState ä¼šè°ƒç”¨é¡µé¢çš„ build æ–¹æ³•ï¼Œbuild ä¸­ä¼šè°ƒç”¨ RxInterface.notifyChildren ï¼Œæœ€ç»ˆå®Œæˆ UI çš„åˆ·æ–°ã€‚</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€GetX æºç åˆ†æéœ€è¦çš„ä¸€äº›å‰ç½®çŸ¥è¯†ï¼šå‡½æ•°ç±»å‹ï¼Œtypedefï¼Œextensionï¼Œæ³›å‹æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•ï¼Œgetï¼Œsetï¼Œmixin</p><p>2ã€GetX çŠ¶æ€ç®¡ç†çš„ä½¿ç”¨åŠæ•ˆæœå±•ç¤ºï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p><blockquote><p>1ã€GetBuilder + Controller.update çŠ¶æ€ç®¡ç†æ¨¡å¼</p><p>2ã€Obx + obs å“åº”å¼ç®¡ç†æ¨¡å¼</p></blockquote><p>3ã€è¿›è¡Œäº† GetX çŠ¶æ€ç®¡ç†çš„æºç åˆ†æ</p><blockquote><p>1ã€GetX çš„ä¾èµ–æ³¨å…¥ï¼Œå†…éƒ¨ä½¿ç”¨ map è¿›è¡Œç®¡ç†</p><p>2ã€GetBuilder + Controller.update æºç ï¼šä¸»è¦é€šè¿‡ Get çš„ä¾èµ–æ³¨å…¥ç®¡ç†å®Œæˆè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…çš„ç»‘å®šï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡ setState è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</p><p>3ã€Obx + obs æºç ï¼šä¸»è¦é€šè¿‡ RxInterface å®Œæˆè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…å…³ç³»çš„ç»‘å®šï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡ setState è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°</p></blockquote><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šæ‰‹æ’¸ GetX çŠ¶æ€ç®¡ç†æ ¸å¿ƒæºç å®ç°ï¼Œæ•¬è¯·æœŸå¾…å§ğŸº</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6984593635681517582#heading-7">Flutter GetX æ·±åº¦å‰–æ</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šæ²‰æµ¸å¼çŠ¶æ€æ å®Œå…¨è§£æ</title>
    <link href="/2023/01/09/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9A%E6%B2%89%E6%B5%B8%E5%BC%8F%E7%8A%B6%E6%80%81%E6%A0%8F%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <url>/2023/01/09/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9A%E6%B2%89%E6%B5%B8%E5%BC%8F%E7%8A%B6%E6%80%81%E6%A0%8F%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><h2 id="ä¸€ã€fitSystemWindows"><a href="#ä¸€ã€fitSystemWindows" class="headerlink" title="ä¸€ã€fitSystemWindows"></a>ä¸€ã€fitSystemWindows</h2><h2 id="äºŒã€çŠ¶æ€æ ç™½åº•é»‘å­—ï¼Œé»‘åº•ç™½å­—"><a href="#äºŒã€çŠ¶æ€æ ç™½åº•é»‘å­—ï¼Œé»‘åº•ç™½å­—" class="headerlink" title="äºŒã€çŠ¶æ€æ ç™½åº•é»‘å­—ï¼Œé»‘åº•ç™½å­—"></a>äºŒã€çŠ¶æ€æ ç™½åº•é»‘å­—ï¼Œé»‘åº•ç™½å­—</h2><h2 id="ä¸‰ã€å¡«å……ä¸€ä¸ªå‡çš„çŠ¶æ€æ "><a href="#ä¸‰ã€å¡«å……ä¸€ä¸ªå‡çš„çŠ¶æ€æ " class="headerlink" title="ä¸‰ã€å¡«å……ä¸€ä¸ªå‡çš„çŠ¶æ€æ "></a>ä¸‰ã€å¡«å……ä¸€ä¸ªå‡çš„çŠ¶æ€æ </h2><h2 id="å››ã€å¦ä¸€ç§å®ç°æ–¹å¼"><a href="#å››ã€å¦ä¸€ç§å®ç°æ–¹å¼" class="headerlink" title="å››ã€å¦ä¸€ç§å®ç°æ–¹å¼"></a>å››ã€å¦ä¸€ç§å®ç°æ–¹å¼</h2><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
      <tag>çŠ¶æ€æ </tag>
      
      <tag>æ²‰æµ¸å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šGooglePlay åº”ç”¨å†…è¯„ä»·ï¼Œåº”ç”¨å†…æ›´æ–°</title>
    <link href="/2023/01/06/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AGooglePlay%20%E5%BA%94%E7%94%A8%E5%86%85%E8%AF%84%E4%BB%B7%EF%BC%8C%E5%BA%94%E7%94%A8%E5%86%85%E6%9B%B4%E6%96%B0/"/>
    <url>/2023/01/06/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AGooglePlay%20%E5%BA%94%E7%94%A8%E5%86%85%E8%AF%84%E4%BB%B7%EF%BC%8C%E5%BA%94%E7%94%A8%E5%86%85%E6%9B%B4%E6%96%B0/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6bf970c4c3f9418c9586ecd7f9f4a011~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>1ã€æˆ‘ä»¬éƒ½å¸Œæœ›è‡ªå·±å¼€å‘çš„ App å¾—åˆ°è‚¯å®šï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨åº”ç”¨å†…é¢„ç½®ä¸€ä¸ªå¼¹çª—ï¼Œåœ¨åˆé€‚çš„æ—¶æœºå¼¹å‡ºï¼Œå¹¶å¼•å¯¼ç”¨æˆ·å»å•†åº—è¯„ä»·ã€‚</p><p>2ã€App å¼€å‘ä¸­ï¼Œåº”ç”¨å†…æ›´æ–°æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå›½å†…å¸¸è§çš„åšæ³•æ˜¯åœ¨ App ä¸­å®ç°ä¸‹è½½å¹¶å®‰è£…ï¼Œä½†æ˜¯å¦‚æœè¦ä¸Šæ¶ GooglePlayï¼Œè¿™ç§åšæ³•ä¼šè¿‡ä¸äº†å®¡æ ¸ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä½¿ç”¨ GooglePlay åº”ç”¨å†…è¯„ä»·å’Œåº”ç”¨å†…æ›´æ–°å®ç°ä¸Šé¢ä¸¤ä¸ªéœ€æ±‚ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š GooglePlay åº”ç”¨å†…è¯„ä»·å’Œåº”ç”¨å†…æ›´æ–°åªé€‚ç”¨äº GooglePlay ä¸Šä¸Šæ¶çš„ Appï¼Œå›½å†…çš„åº”ç”¨å•†åº—å¹¶ä¸é€‚ç”¨</p><h2 id="ä¸€ã€GooglePlay-åº”ç”¨å†…è¯„ä»·"><a href="#ä¸€ã€GooglePlay-åº”ç”¨å†…è¯„ä»·" class="headerlink" title="ä¸€ã€GooglePlay åº”ç”¨å†…è¯„ä»·"></a>ä¸€ã€GooglePlay åº”ç”¨å†…è¯„ä»·</h2><h3 id="1-1ã€è®¾å¤‡è¦æ±‚"><a href="#1-1ã€è®¾å¤‡è¦æ±‚" class="headerlink" title="1.1ã€è®¾å¤‡è¦æ±‚"></a>1.1ã€è®¾å¤‡è¦æ±‚</h3><p>1ã€éœ€ 5.0 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ Android è®¾å¤‡</p><p>2ã€ Android è®¾å¤‡å®‰è£…äº† Google Play å•†åº—</p><h3 id="1-2ã€Play-Core-åº“è¦æ±‚"><a href="#1-2ã€Play-Core-åº“è¦æ±‚" class="headerlink" title="1.2ã€Play Core åº“è¦æ±‚"></a>1.2ã€Play Core åº“è¦æ±‚</h3><p>å¦‚éœ€åœ¨ä½ çš„åº”ç”¨ä¸­é›†æˆ GooglePlay åº”ç”¨å†…è¯„ä»·ï¼Œåº“ç‰ˆæœ¬å¿…é¡»ä½¿ç”¨ 1.8.0ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>    <span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:core:1.8.0&#x27;</span><br>    <span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:core-ktx:1.8.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…æ›´é«˜ç‰ˆæœ¬çš„<a href="https://developer.android.com/guide/playcore?hl=zh-cn">Play Core åº“</a>ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>    <span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:review:2.0.1&#x27;</span><br>    <span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:review-ktx:2.0.1&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3ã€é›†æˆ-GooglePlay-åº”ç”¨å†…è¯„ä»·"><a href="#1-3ã€é›†æˆ-GooglePlay-åº”ç”¨å†…è¯„ä»·" class="headerlink" title="1.3ã€é›†æˆ GooglePlay åº”ç”¨å†…è¯„ä»·"></a>1.3ã€é›†æˆ GooglePlay åº”ç”¨å†…è¯„ä»·</h3><h4 id="1-3-1ã€æ·»åŠ -Gradle-è¿œç¨‹ä¾èµ–"><a href="#1-3-1ã€æ·»åŠ -Gradle-è¿œç¨‹ä¾èµ–" class="headerlink" title="1.3.1ã€æ·»åŠ  Gradle è¿œç¨‹ä¾èµ–"></a>1.3.1ã€æ·»åŠ  Gradle è¿œç¨‹ä¾èµ–</h4><p>åœ¨ app çš„ build.gradle ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>implementation <span class="hljs-string">&#x27;com.google.android.play:review:2.0.1&#x27;</span><br><span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>implementation <span class="hljs-string">&#x27;com.google.android.play:review-ktx:2.0.1&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="1-3-2ã€åˆå§‹åŒ–-GooglePlay-åº”ç”¨å†…è¯„ä»·"><a href="#1-3-2ã€åˆå§‹åŒ–-GooglePlay-åº”ç”¨å†…è¯„ä»·" class="headerlink" title="1.3.2ã€åˆå§‹åŒ– GooglePlay åº”ç”¨å†…è¯„ä»·"></a>1.3.2ã€åˆå§‹åŒ– GooglePlay åº”ç”¨å†…è¯„ä»·</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * åˆå§‹åŒ– GooglePlay åº”ç”¨å†…è¯„ä»·</span><br><span class="hljs-comment">  */</span><br>fun <span class="hljs-title function_">initInnerReview</span><span class="hljs-params">()</span>&#123;<br>   <span class="hljs-comment">//1ã€é€šè¿‡ ReviewManagerFactory åˆ›å»º ReviewManager å¯¹è±¡ï¼Œç”¨äºå¯åŠ¨åº”ç”¨å†…è¯„ä»·çš„æµç¨‹</span><br>   manager = ReviewManagerFactory.create(MyApplication.getInstance())<br>   <span class="hljs-comment">//2ã€è·å– ReviewInfo å¯¹è±¡ã€‚å½“æˆ‘ä»¬åˆ¤æ–­å¯ä»¥è®©ç”¨æˆ·è¿›è¡Œè¯„ä»·æ—¶ï¼Œä½¿ç”¨ ReviewManager åˆ›å»ºä¸€ä¸ªè¯·æ±‚ï¼Œ</span><br>   <span class="hljs-comment">//ç”¨äºçœŸæ­£å¯åŠ¨åº”ç”¨å†…è¯„ä»·æµç¨‹ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆç¼“å­˜å¥½ ReviewInfo å¯¹è±¡ã€‚</span><br>   <span class="hljs-type">val</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> manager?.requestReviewFlow()<br>   request?.addOnCompleteListener &#123;<br>      <span class="hljs-keyword">if</span>(it.isSuccessful)&#123;<br>          reviewInfo = it.result<br>          Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;init: get reviewInfo sucess&quot;</span>)<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>          Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;init: get reviewInfo failed&quot;</span>)<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="1-3-3ã€å¯åŠ¨-GooglePlay-åº”ç”¨å†…è¯„ä»·"><a href="#1-3-3ã€å¯åŠ¨-GooglePlay-åº”ç”¨å†…è¯„ä»·" class="headerlink" title="1.3.3ã€å¯åŠ¨ GooglePlay åº”ç”¨å†…è¯„ä»·"></a>1.3.3ã€å¯åŠ¨ GooglePlay åº”ç”¨å†…è¯„ä»·</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * å¯åŠ¨åº”ç”¨å†…è¯„ä»·</span><br><span class="hljs-comment">  *</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> activity å½“å‰ Activity</span><br><span class="hljs-comment">  */</span><br>fun <span class="hljs-title function_">innerReview</span><span class="hljs-params">(activity: Activity)</span>&#123;<br>  <span class="hljs-comment">//è°ƒç”¨ launchReviewFlow æ¥å¯åŠ¨è¯„ä»·æµç¨‹ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±äº¤ç»™ Google äº†</span><br>  reviewInfo?.apply &#123;<br>    <span class="hljs-type">val</span> <span class="hljs-variable">flow</span> <span class="hljs-operator">=</span> manager?.launchReviewFlow(activity, <span class="hljs-built_in">this</span>)<br>    flow?.addOnCompleteListener &#123;<br>        <span class="hljs-keyword">if</span>(it.isSuccessful)&#123;<br>            Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;innerReview: launchReviewFlow success&quot;</span>)<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;innerReview: launchReviewFlow failed&quot;</span>)<br>        &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="1-3-4ã€å®Œæ•´ä»£ç "><a href="#1-3-4ã€å®Œæ•´ä»£ç " class="headerlink" title="1.3.4ã€å®Œæ•´ä»£ç "></a>1.3.4ã€å®Œæ•´ä»£ç </h4><p>æˆ‘ä»¬å¯ä»¥å°† GooglePlay åº”ç”¨å†…è¯„ä»·çš„ä»£ç è¿›è¡Œå°è£…ï¼Œæ”¾åˆ°ä¸€ä¸ªå•ä¾‹é‡Œé¢ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * function: GooglePlay åº”ç”¨å†… app è¾…åŠ©ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">object</span> GooglePlayInnerAppHelper &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ReviewInfo å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">var</span> reviewInfo: ReviewInfo? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ReviewManager å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">var</span> manager: ReviewManager? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆå§‹åŒ– GooglePlay åº”ç”¨å†…è¯„ä»·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initInnerReview</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//1ã€é€šè¿‡ ReviewManagerFactory åˆ›å»º ReviewManager å¯¹è±¡ï¼Œç”¨äºå¯åŠ¨åº”ç”¨å†…è¯„ä»·çš„æµç¨‹</span><br>        manager = ReviewManagerFactory.create(MyApplication.getInstance())<br>        <span class="hljs-comment">//2ã€è·å–ReviewInfoå¯¹è±¡ã€‚å½“æˆ‘ä»¬åˆ¤æ–­å¯ä»¥è®©ç”¨æˆ·è¿›è¡Œè¯„ä»·æ—¶ï¼Œä½¿ç”¨ReviewManageråˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼Œ</span><br>        <span class="hljs-comment">//ç”¨äºçœŸæ­£å¯åŠ¨åº”ç”¨å†…è¯„ä»·æµç¨‹ã€‚è¿™é‡Œè°·æ­Œæ–‡æ¡£ä¸­å»ºè®®æå‰ä¸€ç‚¹ç¼“å­˜å¥½ ReviewInfo å¯¹è±¡ã€‚</span><br>        <span class="hljs-keyword">val</span> request = manager?.requestReviewFlow()<br>        request?.addOnCompleteListener &#123;<br>            <span class="hljs-keyword">if</span>(it.isSuccessful)&#123;<br>                reviewInfo = it.result<br>                Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;init: get reviewInfo sucess&quot;</span>)<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;init: get reviewInfo failed&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åº”ç”¨å†…è¯„ä»·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> activity å½“å‰ Activity</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">innerReview</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span>&#123;<br>        <span class="hljs-comment">//è°ƒç”¨ launchReviewFlow æ¥å¯åŠ¨è¯„ä»·æµç¨‹ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±äº¤ç»™ Google äº†</span><br>        reviewInfo?.apply &#123;<br>            <span class="hljs-keyword">val</span> flow = manager?.launchReviewFlow(activity, <span class="hljs-keyword">this</span>)<br>            flow?.addOnCompleteListener &#123;<br>                <span class="hljs-keyword">if</span>(it.isSuccessful)&#123;<br>                    Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;innerReview: launchReviewFlow success&quot;</span>)<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;innerReview: launchReviewFlow failed&quot;</span>)<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨åˆé€‚çš„æ—¶æœºï¼Œä»¥æˆ‘çš„ä¸ºä¾‹å­ï¼š</p><blockquote><p>åœ¨ Application çš„ onCreate é‡Œé¢åˆå§‹åŒ– GooglePlay åº”ç”¨å†…è¯„ä»·ï¼Œç„¶ååœ¨é¡¹ç›®çš„é¦–é¡µå¯åŠ¨ GooglePlay åº”ç”¨å†…è¯„ä»·ã€‚</p></blockquote><p>è¿›è¡Œè°ƒç”¨å³å¯ã€‚</p><h3 id="1-4ã€æµ‹è¯•"><a href="#1-4ã€æµ‹è¯•" class="headerlink" title="1.4ã€æµ‹è¯•"></a>1.4ã€æµ‹è¯•</h3><p>ä¸Šè¿°é›†æˆä»£ç æ¯”è¾ƒç®€å•ï¼Œä¸»è¦è¿˜æ˜¯æµ‹è¯•æ¯”è¾ƒéº»çƒ¦ï¼Œæµ‹è¯•çš„æ–¹å¼æœ‰å¤šç§ï¼Œè®²ä¸‹æˆ‘æ¨èçš„ä¸€ç§ï¼š</p><p>1ã€å°†ä½ çš„åº”ç”¨æ‰“åŒ…æˆ .aab æ ¼å¼çš„æ–‡ä»¶ä¸Šä¼ åˆ° GooglePlay çš„ Internal testingï¼ˆå†…æµ‹ï¼‰æ¸ é“ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bce086b60a1d476580cb95c9f3c7cbb5~tplv-k3u1fbpfcp-watermark.image" alt="image-20230106152628078.png"></p><p>ä¸Šä¼ åˆ°  Internal testing æ¸ é“çš„å¥½å¤„å°±æ˜¯åªè¦ä½ æ²¡æœ‰è¿›è¡Œè¯„ä»·ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½ä¼šè¿›è¡Œè¯„ä»·å¼¹çª—æç¤ºã€‚Productionï¼ˆç”Ÿäº§ï¼‰æ¸ é“åˆ™ä¸ä¼šã€‚</p><p>2ã€å°†ä½ çš„ GooglePlay è´¦å·åŠ å…¥åˆ°å†…æµ‹æ¸ é“ä¸­ï¼Œç„¶åä» GooglePlay å•†åº—ä¸­ä¸‹è½½åº”ç”¨ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/796d66ef44db47c3907108e6ae8422e9~tplv-k3u1fbpfcp-watermark.image?" alt="image-20230106154045505.png" width="50%" /><p>å¯ä»¥çœ‹åˆ°ï¼ŒGooglePlay å•†åº—ä¼šæç¤ºä½ æ˜¯ä¸€ä¸ªå†…æµ‹è´¦å·</p><p><strong>æ³¨æ„ï¼š</strong> è¿™é‡Œä¸èƒ½ä½¿ç”¨å—ä¿æŠ¤çš„ç”¨æˆ·è´¦å·ï¼ˆå¦‚ä¼ä¸šè´¦å·ï¼‰ï¼Œæˆ‘å½“æ—¶å°±æ˜¯ä½¿ç”¨äº†ä¼ä¸šåˆ†é…çš„ GooglePlay è´¦å·å¯¼è‡´ä¸€ç›´å¼¹ä¸å‡ºè¯„ä»·å¼¹çª—ã€‚éœ€è¦æ”¹ç”¨ Gmail è´¦å·ï¼Œåé¢ä½¿ç”¨ç§äººçš„ Gmail è´¦å·ï¼Œå°±æˆåŠŸçš„å¼¹å‡ºäº†è¯„ä»·å¼¹çª—ã€‚</p><p>3ã€ä¿è¯ä½ ä½¿ç”¨çš„ GooglePlay è´¦å·æ²¡æœ‰è¯„ä»·è¿‡è¯¥åº”ç”¨ï¼Œå¦‚æœè¯„ä»·äº†ä¹Ÿå¼¹ä¸å‡ºæ¥</p><h3 id="1-5ã€æ•ˆæœå±•ç¤º"><a href="#1-5ã€æ•ˆæœå±•ç¤º" class="headerlink" title="1.5ã€æ•ˆæœå±•ç¤º"></a>1.5ã€æ•ˆæœå±•ç¤º</h3><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/068199451d6b4f2ca78dd11d63545016~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><h2 id="äºŒã€GooglePlay-åº”ç”¨å†…æ›´æ–°"><a href="#äºŒã€GooglePlay-åº”ç”¨å†…æ›´æ–°" class="headerlink" title="äºŒã€GooglePlay åº”ç”¨å†…æ›´æ–°"></a>äºŒã€GooglePlay åº”ç”¨å†…æ›´æ–°</h2><h3 id="2-1ã€è®¾å¤‡è¦æ±‚"><a href="#2-1ã€è®¾å¤‡è¦æ±‚" class="headerlink" title="2.1ã€è®¾å¤‡è¦æ±‚"></a>2.1ã€è®¾å¤‡è¦æ±‚</h3><p>1ã€éœ€ 5.0 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ Android è®¾å¤‡</p><p>2ã€ Android è®¾å¤‡å®‰è£…äº† Google Play å•†åº—</p><h3 id="2-2ã€Play-Core-åº“è¦æ±‚"><a href="#2-2ã€Play-Core-åº“è¦æ±‚" class="headerlink" title="2.2ã€Play Core åº“è¦æ±‚"></a>2.2ã€Play Core åº“è¦æ±‚</h3><p>å¦‚éœ€åœ¨ä½ çš„åº”ç”¨ä¸­é›†æˆ GooglePlay åº”ç”¨å†…è¯„ä»·ï¼Œåº“ç‰ˆæœ¬å¿…é¡»ä½¿ç”¨ 1.8.0ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>    <span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:core:1.8.0&#x27;</span><br>    <span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:core-ktx:1.8.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…æ›´é«˜ç‰ˆæœ¬çš„<a href="https://developer.android.com/guide/playcore?hl=zh-cn">Play Core åº“</a>ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>    <span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:app-update:2.0.1&#x27;</span><br>    <span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.play:app-update-ktx:2.0.1&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3ã€é›†æˆ-GooglePlay-åº”ç”¨å†…æ›´æ–°"><a href="#2-3ã€é›†æˆ-GooglePlay-åº”ç”¨å†…æ›´æ–°" class="headerlink" title="2.3ã€é›†æˆ GooglePlay åº”ç”¨å†…æ›´æ–°"></a>2.3ã€é›†æˆ GooglePlay åº”ç”¨å†…æ›´æ–°</h3><h4 id="2-3-1ã€æ·»åŠ -Gradle-è¿œç¨‹ä¾èµ–"><a href="#2-3-1ã€æ·»åŠ -Gradle-è¿œç¨‹ä¾èµ–" class="headerlink" title="2.3.1ã€æ·»åŠ  Gradle è¿œç¨‹ä¾èµ–"></a>2.3.1ã€æ·»åŠ  Gradle è¿œç¨‹ä¾èµ–</h4><p>åœ¨ app çš„ build.gradle ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ ¸å¿ƒåº“</span><br>implementation <span class="hljs-string">&#x27;com.google.android.play:app-update:2.0.1&#x27;</span><br><span class="hljs-comment">//é¡¹ç›®ä½¿ç”¨äº† Kotlin å¯ä»¥é›†æˆ</span><br>implementation <span class="hljs-string">&#x27;com.google.android.play:app-update-ktx:2.0.1&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="2-3-2ã€å¯åŠ¨åº”ç”¨å†…æ›´æ–°"><a href="#2-3-2ã€å¯åŠ¨åº”ç”¨å†…æ›´æ–°" class="headerlink" title="2.3.2ã€å¯åŠ¨åº”ç”¨å†…æ›´æ–°"></a>2.3.2ã€å¯åŠ¨åº”ç”¨å†…æ›´æ–°</h4><p>GooglePlay åº”ç”¨å†…æ›´æ–°æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><p>1ã€ç«‹å³æ›´æ–°</p><p>2ã€çµæ´»æ›´æ–°</p><h5 id="2-3-2-1ã€ç«‹å³æ›´æ–°"><a href="#2-3-2-1ã€ç«‹å³æ›´æ–°" class="headerlink" title="2.3.2.1ã€ç«‹å³æ›´æ–°"></a>2.3.2.1ã€ç«‹å³æ›´æ–°</h5><p>ç«‹å³æ›´æ–°ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºå¼ºåˆ¶æ›´æ–°ï¼Œå®ƒä¼šæ‰“æ–­ç”¨æˆ·ä¸ app çš„äº¤äº’ï¼Œå¼¹å‡ºä¸€ä¸ªæ–°çš„é¡µé¢æç¤ºä½ å‡çº§</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * åº”ç”¨å†…å¼ºåˆ¶æ›´æ–°</span><br><span class="hljs-comment">  */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">innerAppForceUpdate</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>    <span class="hljs-keyword">val</span> appUpdateManager = AppUpdateManagerFactory.create(MyApplication.getInstance())<br>    appUpdateManager.appUpdateInfo.addOnSuccessListener &#123;<br>        <span class="hljs-keyword">if</span> (it.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE &amp;&amp; <br>           it.isUpdateTypeAllowed(AppUpdateType.IMMEDIATE)) &#123;<br>            <span class="hljs-comment">//å¯åŠ¨å¼ºåˆ¶æ›´æ–°</span><br>            appUpdateManager.startUpdateFlowForResult(it,<br>                AppUpdateType.IMMEDIATE,<br>                activity,<br>                UPDATE_REQUEST_CODE)<br>         &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2-3-2-2ã€çµæ´»æ›´æ–°"><a href="#2-3-2-2ã€çµæ´»æ›´æ–°" class="headerlink" title="2.3.2.2ã€çµæ´»æ›´æ–°"></a>2.3.2.2ã€çµæ´»æ›´æ–°</h5><p>çµæ´»æ›´æ–°ä¸ä¼šæ‰“æ–­ç”¨æˆ·ä¸ app çš„äº¤äº’ï¼Œå®ƒæ˜¯åœ¨åå°é™é»˜ä¸‹è½½æ–°ç‰ˆæœ¬ï¼Œç­‰ä¸‹åœ¨å®Œäº†åœ¨æç¤ºæ›´æ–°</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åº”ç”¨å†…çµæ´»æ›´æ–°</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">innerAppSmartUpdate</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>    <span class="hljs-keyword">val</span> appUpdateManager = AppUpdateManagerFactory.create(MyApplication.getInstance())<br>    appUpdateManager.appUpdateInfo.addOnSuccessListener &#123;<br>        <span class="hljs-keyword">if</span> (it.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE &amp;&amp; <br>            it.isUpdateTypeAllowed(AppUpdateType.FLEXIBLE)) &#123;<br>            <span class="hljs-comment">//çµæ´»æ›´æ–°</span><br>            <span class="hljs-keyword">val</span> installListener = <span class="hljs-keyword">object</span> : InstallStateUpdatedListener &#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateUpdate</span><span class="hljs-params">(installState: <span class="hljs-type">InstallState</span>)</span></span> &#123;<br>                    <span class="hljs-keyword">if</span>(installState.installStatus() == InstallStatus.DOWNLOADING)&#123;<br>                      <span class="hljs-comment">//ä¸‹è½½ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤è·å–è¿›åº¦ç»™ç”¨æˆ·è¿›è¡Œæç¤º</span><br>                      <span class="hljs-comment">//å·²ä¸‹è½½æ–‡ä»¶å­—èŠ‚å¤§å°</span><br>                <span class="hljs-keyword">val</span> bytesDownloaded = installState.bytesDownloaded()<br>                <span class="hljs-comment">//æ–‡ä»¶æ€»çš„å­—èŠ‚å¤§å°</span><br>                <span class="hljs-keyword">val</span> totalBytesToDownload = installState.totalBytesToDownload()<br>                      <span class="hljs-comment">//todo å¯¹äºæˆ·è¿›è¡Œä¸‹è½½è¿›åº¦æç¤º</span><br>                      <br>                    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (installState.installStatus() == InstallStatus.DOWNLOADED) &#123;<br>                        <span class="hljs-comment">//é€šçŸ¥ç”¨æˆ·æ›´æ–°å·²ä¸‹è½½å®Œæ¯•ï¼Œé‡å¯ä»¥å®‰è£…åº”ç”¨</span><br>                        appUpdateManager.unregisterListener(<span class="hljs-keyword">this</span>)<br>                        appUpdateManager.completeUpdate()<br>                    &#125;<br>                &#125;<br>            &#125;<br>            appUpdateManager.registerListener(installListener)<br>            appUpdateManager.startUpdateFlowForResult(it,<br>                AppUpdateType.FLEXIBLE,<br>                activity,<br>                UPDATE_REQUEST_CODE)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-3-3ã€å®Œæ•´ä»£ç "><a href="#2-3-3ã€å®Œæ•´ä»£ç " class="headerlink" title="2.3.3ã€å®Œæ•´ä»£ç "></a>2.3.3ã€å®Œæ•´ä»£ç </h4><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œå°è£…ï¼Œæ”¾åˆ°ä¸€ä¸ªå•ä¾‹é‡Œé¢ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * function: GooglePlay åº”ç”¨å†… app è¾…åŠ©ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">object</span> GooglePlayInnerAppHelper &#123;<br>    <br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> UPDATE_REQUEST_CODE: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0x001</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åº”ç”¨å†…å¼ºåˆ¶æ›´æ–°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">innerAppForceUpdate</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> appUpdateManager = AppUpdateManagerFactory.create(MyApplication.getInstance())<br>        appUpdateManager.appUpdateInfo.addOnSuccessListener &#123;<br>            <span class="hljs-keyword">if</span> (it.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE &amp;&amp; it.isUpdateTypeAllowed(<br>                    AppUpdateType.IMMEDIATE)<br>            ) &#123;<br>                <span class="hljs-comment">//å¼ºåˆ¶æ›´æ–°</span><br>                appUpdateManager.startUpdateFlowForResult(it,<br>                    AppUpdateType.IMMEDIATE,<br>                    activity,<br>                    UPDATE_REQUEST_CODE)<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åº”ç”¨å†…çµæ´»æ›´æ–°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">innerAppSmartUpdate</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> appUpdateManager = AppUpdateManagerFactory.create(MyApplication.getInstance())<br>        appUpdateManager.appUpdateInfo.addOnSuccessListener &#123;<br>            <span class="hljs-keyword">if</span> (it.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE &amp;&amp;<br>                it.isUpdateTypeAllowed(AppUpdateType.FLEXIBLE)) &#123;<br>                <span class="hljs-comment">//çµæ´»æ›´æ–°</span><br>                <span class="hljs-keyword">val</span> installListener = <span class="hljs-keyword">object</span> : InstallStateUpdatedListener &#123;<br>                    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateUpdate</span><span class="hljs-params">(installState: <span class="hljs-type">InstallState</span>)</span></span> &#123;<br>                        <span class="hljs-keyword">if</span>(installState.installStatus() == InstallStatus.DOWNLOADING)&#123;<br>                            <span class="hljs-comment">//ä¸‹è½½ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤è·å–è¿›åº¦ç»™ç”¨æˆ·è¿›è¡Œæç¤º</span><br>                            <span class="hljs-comment">//å·²ä¸‹è½½æ–‡ä»¶å­—èŠ‚å¤§å°</span><br>                            <span class="hljs-keyword">val</span> bytesDownloaded = installState.bytesDownloaded()<br>                            <span class="hljs-comment">//æ–‡ä»¶æ€»çš„å­—èŠ‚å¤§å°</span><br>                            <span class="hljs-keyword">val</span> totalBytesToDownload = installState.totalBytesToDownload()<br>                            <span class="hljs-comment">//todo å¯¹äºæˆ·è¿›è¡Œä¸‹è½½è¿›åº¦æç¤º</span><br><br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (installState.installStatus() == InstallStatus.DOWNLOADED) &#123;<br>                            <span class="hljs-comment">//é€šçŸ¥ç”¨æˆ·æ›´æ–°å·²ä¸‹è½½å®Œæ¯•ï¼Œé‡å¯ä»¥å®‰è£…åº”ç”¨</span><br>                            appUpdateManager.unregisterListener(<span class="hljs-keyword">this</span>)<br>                            appUpdateManager.completeUpdate()<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                appUpdateManager.registerListener(installListener)<br>                appUpdateManager.startUpdateFlowForResult(it,<br>                    AppUpdateType.FLEXIBLE,<br>                    activity,<br>                    UPDATE_REQUEST_CODE)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨åˆé€‚çš„æ—¶æœºï¼Œä»¥æˆ‘çš„ä¸ºä¾‹å­ï¼Œç«‹å³æ›´æ–°å’Œçµæ´»æ›´æ–°ç»“åˆä½¿ç”¨ï¼š</p><blockquote><p>æ ¹æ®åå°ä¸‹å‘é…ç½®ï¼Œåˆ¤æ–­æ˜¯ä½¿ç”¨ç«‹å³æ›´æ–°è¿˜æ˜¯çµæ´»æ›´æ–°</p></blockquote><h3 id="2-4ã€æµ‹è¯•"><a href="#2-4ã€æµ‹è¯•" class="headerlink" title="2.4ã€æµ‹è¯•"></a>2.4ã€æµ‹è¯•</h3><p>æˆ‘ä»¬éœ€è¦åšä»¥ä¸‹ä¸‰æ­¥ï¼š</p><p>1ã€æ‰“åŒ…é«˜ç‰ˆæœ¬ .aab æ ¼å¼çš„æ–‡ä»¶ä¸Šä¼ åˆ° GooglePlay çš„ Internal testingï¼ˆå†…æµ‹ï¼‰æ¸ é“ï¼Œå°† GooglePlay è´¦å·ï¼Œæ·»åŠ åˆ°å†…æµ‹æ¸ é“</p><p><strong>æ³¨æ„ï¼š</strong> æ­¤æ—¶æ— å—ä¿æŠ¤çš„ç”¨æˆ·è´¦å·è¦æ±‚ï¼Œå› æ­¤è¿™é‡Œä½ å¯ä»¥ä½¿ç”¨ä¼ä¸šè´¦å·</p><p>2ã€ç¡®ä¿ä½ ç›®å‰ä½¿ç”¨çš„è´¦å·è‡³å°‘ä» GooglePlay ä¸‹è½½è¿‡ä¸€æ¬¡åº”ç”¨ï¼Œå› ä¸ºåªæœ‰æ‹¥æœ‰åº”ç”¨çš„ç”¨æˆ·å¸å·æ‰å¯ä»¥ä½¿ç”¨åº”ç”¨å†…æ›´æ–°</p><p>3ã€è¿˜åŸåˆ°ä½ç‰ˆæœ¬ï¼Œä½¿ç”¨ AndroidStudio ç¼–è¯‘æ‰“åŒ…å³å¯</p><h3 id="2-5ã€æ•ˆæœå±•ç¤º"><a href="#2-5ã€æ•ˆæœå±•ç¤º" class="headerlink" title="2.5ã€æ•ˆæœå±•ç¤º"></a>2.5ã€æ•ˆæœå±•ç¤º</h3><h4 id="2-5-1ã€åå°ä¸‹å‘é…ç½®ç«‹å³æ›´æ–°"><a href="#2-5-1ã€åå°ä¸‹å‘é…ç½®ç«‹å³æ›´æ–°" class="headerlink" title="2.5.1ã€åå°ä¸‹å‘é…ç½®ç«‹å³æ›´æ–°"></a>2.5.1ã€åå°ä¸‹å‘é…ç½®ç«‹å³æ›´æ–°</h4><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/59d0d7c521f24c4fbef96ecad5cf0d0b~tplv-k3u1fbpfcp-watermark.image?" alt="force_update.gif" width="30%" /><p>ç«‹å³æ›´æ–°ç»™æˆ‘ä»¬æ–°å¼€äº†ä¸€ä¸ªé¡µé¢è¿›è¡Œä¸‹è½½ï¼Œç­‰å¾…ä¸‹è½½å®Œæˆä¼šè‡ªåŠ¨ç»™ä½ æ›´æ–°å¹¶é‡å¯åº”ç”¨ã€‚</p><h4 id="2-5-2ã€åå°ä¸‹å‘é…ç½®çµæ´»æ›´æ–°"><a href="#2-5-2ã€åå°ä¸‹å‘é…ç½®çµæ´»æ›´æ–°" class="headerlink" title="2.5.2ã€åå°ä¸‹å‘é…ç½®çµæ´»æ›´æ–°"></a>2.5.2ã€åå°ä¸‹å‘é…ç½®çµæ´»æ›´æ–°</h4><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b60edcf4b299437890de09ceef15f1ad~tplv-k3u1fbpfcp-watermark.image?" alt="smart_update.gif" width="30%" /><p>çµæ´»æ›´æ–°ä¼šåœ¨åå°é™é»˜ä¸‹è½½ï¼Œç­‰ä¸‹è½½å®Œæˆä¼šè‡ªåŠ¨ç»™ä½ æ›´æ–°å¹¶é‡å¯åº”ç”¨ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€GooglePlay åº”ç”¨å†…è¯„ä»·</p><p>2ã€GooglePlay åº”ç”¨å†…æ›´æ–°</p><p>ä¸¤è€…é›†æˆè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä¸»è¦å°±æ˜¯æµ‹è¯•æ•ˆæœæ¯”è¾ƒéº»çƒ¦ï¼ŒæŒ‰ç…§æˆ‘æ–‡ä¸­çš„æ­¥éª¤ï¼Œé—®é¢˜ä¸å¤§ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://developer.android.com/guide/playcore/in-app-review?hl=zh-cn">GooglePlay åº”ç”¨å†…è¯„ä»·å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://developer.android.com/guide/playcore/in-app-updates?hl=zh-cn&from_wecom=1">GooglePlay åº”ç”¨å†…æ›´æ–°å®˜æ–¹æ–‡æ¡£</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>GooglePlay</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>GooglePlay</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022 å¼€å¿ƒå¤§äºçƒ¦æ¼</title>
    <link href="/2022/12/30/2022final/"/>
    <url>/2022/12/30/2022final/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01607b4507ed45c293db7ffc25390630~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ï½</p><p><strong>è¿‡å»çš„è¿‡ä¸å»çš„ç»ˆå°†è¿‡å» æœªæ¥çš„è¿˜æ²¡æ¥çš„å³å°†åˆ°æ¥ 2022æ„Ÿæ©~</strong></p><p>2022 å¹´æ˜¯è¢«ç–«æƒ…ç¬¼ç½©çš„â¼€å¹´ï¼Œæ ¸é…¸ä»å¹´å¤´åšåˆ°äº†å¹´å°¾ï¼Œç–«æƒ…ååå¤å¤ï¼Œæ•´å¾—å¤§å®¶å¾ˆæ˜¯å¿§æ„ã€‚ä»¥å‰ä¸‰ä¸¤å¥½å‹ä¸€å¥è¯å°±èƒ½å¼ ç½—èµ·æ¥ï¼Œç°åœ¨å¤§å®¶æœ‰ä¸€ç‚¹ä¸èˆ’æœéƒ½ä¸æ•¢å‡ºå®¶é—¨ï¼Œç”Ÿæ€•åƒé‡ŒæŠ•æ¯’ç»™äº²å‹æ·»å µï¼›ä»¥å‰â¼¤è¡—ä¸Šâ»‹â½”â»¢â»°ï¼Œé€›è¡—çš„äººä¸€å¤§ç‰‡ï¼Œç°åœ¨â¼¤å®¶å‡ºæ¥â¾›çš„å°‘äº†ï¼Œæ²¡äº‹å°±å¾…åœ¨å®¶ï¼Œåº—é“ºè¯¥å…³â»”çš„å…³äº†â»”ï¼Œæˆ‘è‡ªå·±å’Œå®¶äººå› ä¸ºç–«æƒ…ä¹Ÿæ²¡æœ‰å¥½å¥½åœ¨çº¿ä¸‹ä¹°è¿‡ä¸€ä»¶è¡£æœã€‚å¥½åœ¨ä»Šå¹´å¹´åº•ç–«æƒ…æ”¾å¼€äº†ï¼Œä¸â½¤å¤šä¹…æˆ‘ä»¬â¼œå¯ä»¥å›å½’åˆ°ä»¥å‰çš„é‚£ç§çƒ­é—¹äº†ï¼Œä½†åœ¨æ­¤ä¹‹å‰â¼¤å®¶ä»éœ€è¦æ³¨æ„é˜²æŠ¤å“ˆã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f93fca91da4458e9da1086cc4a52ba7~tplv-k3u1fbpfcp-watermark.image" alt="anti-epidemic.gif"></p><h2 id="æƒ³åˆ°ï¼Œåšåˆ°ï¼Œåšä¸€ä¸ªè¡ŒåŠ¨æ´¾"><a href="#æƒ³åˆ°ï¼Œåšåˆ°ï¼Œåšä¸€ä¸ªè¡ŒåŠ¨æ´¾" class="headerlink" title="æƒ³åˆ°ï¼Œåšåˆ°ï¼Œåšä¸€ä¸ªè¡ŒåŠ¨æ´¾"></a>æƒ³åˆ°ï¼Œåšåˆ°ï¼Œåšä¸€ä¸ªè¡ŒåŠ¨æ´¾</h2><p>è¿™ä¸€å¹´ï¼Œå¯¹äºæˆ‘æ¥è¯´æ˜¯å¼€â¼¼è¿œâ¼¤äºçƒ¦æ¼å§ï¼Œå›å¿†èµ·è¿™â¼€å¹´å‘â½£çš„ç‚¹ç‚¹æ»´æ»´ï¼Œæ„Ÿå¹æ—¶é—´è¿‡å¾—å¥½å¿«å‘€ï¼š</p><p>è¿™â¼€å¹´ï¼Œæˆ‘çš„å¶åƒå‹’å¸ƒæœ—è©¹å§†æ–¯åŠ å†• NBA å†å²æ€»å¾—åˆ†ç‹ï¼ŒCongratulationï¼</p><p>è¿™â¼€å¹´ï¼Œç»ˆäºæŠŠå­©å­æ¥åˆ°èº«è¾¹äº†ï¼Œæ¯å¤©â¼¼â¾¥æœ€å¤§çš„æ¸©æš–å°±æ˜¯å›å®¶æŠ±æŠ±ä»–ä¸¾é«˜é«˜ã€‚</p><p>è¿™â¼€å¹´ï¼Œç»„ç»‡äº†â¼€æ¬¡å›¢é˜Ÿæ½®æ±•ä¸‰å¤©ä¸¤å¤œæ¸¸ï¼Œéš¾å¾—ä¸€èšçš„è½»æ¾ï¼Œåœ¨ä¸€èµ·å°±å¾ˆå¼€å¿ƒã€‚</p><p>è¿™â¼€å¹´ï¼Œå‚åŠ äº†å…¬å¸å®£ä¼ â½šæ‹æ‘„ï¼Œæ¼”æŠ€è™½ç„¶ä¸€èˆ¬ï¼Œç•™ä¸‹çš„æ¬¢ä¹å›å¿†å¼¥è¶³çè´µã€‚</p><p>è¿™â¼€å¹´ï¼ŒæŒç»­åˆ›ä½œï¼Œä¸å¿˜åˆâ¼¼ï¼Œæƒ³åˆ°ï¼Œåšåˆ°ï¼Œåšä¸€ä¸ªè¡ŒåŠ¨æ´¾ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99bc1d2cd0f94d83b84c584e91af0e38~tplv-k3u1fbpfcp-watermark.image" alt="flag.png"></p><p>æ¯å¤©èƒ½ä¿æŒ 8 â¼©æ—¶ç¡çœ æ—¶é—´ï¼›æ¯å¤©è‡³å°‘èŠ±åŠâ¼©æ—¶é˜…è¯»æŠ€æœ¯â½‚ç« ï¼› å…»æˆäº†æ¯å¤©åƒâ½”æœçš„å¥½ä¹ æƒ¯ï¼›â¼¤éƒ¨åˆ†å‘¨æœ«éƒ½æœ‰å­¦ä¹ ï¼Œâ¼€æ–¹é¢æ€»ç»“ä¸‹è¿™å‘¨â¼¯ä½œä¸­é‡åˆ°çš„é—®é¢˜é€Ÿåº¦æ‰¾åˆ°è§£å†³â½…æ¡ˆï¼Œå¦ä¸€æ–¹é¢ä¸æ–­æ”»å…‹æ–°æŠ€æœ¯æ–°è¯­è¨€ï¼›æ¯ä¸ªâ½‰æ•´ç†å­¦ä¹ çš„å†…å®¹ï¼Œè¾“å‡ºâ¼€ç¯‡æŠ€æœ¯â½‚ç« ï¼Œä»Šå¹´è¾“å‡º 21 ç¯‡â½‚ç« ï¼›æœ‰æ—¶é—´ä¼šæ•´ç†æœ‰é“äº‘ç¬”è®°ï¼Œâ¼¿å†™â¼€äº›éšç¬”æ¥è®°å½•â½£æ´»çš„ç‚¹æ»´ã€‚æ¯ä¸¤å‘¨ä¼šå’Œå®¶é‡Œäººé€šâ¼€æ¬¡ç”µè¯ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰éœ€è¦å¸®å¿™çš„åœ°æ–¹ï¼›ä»Šå¹´çš„é‡â¼¼éƒ½æ”¾åœ¨å®¶åº­å’Œå­©â¼¦èº«ä¸Šï¼Œå› ä¸ºå­©å­çš„è„¾æ°”æ¯”è¾ƒæš´èºï¼Œæˆ‘ä»¬é…åˆè€å¸ˆå’Œä¸“ä¸šçš„è‚²å„¿ä¸“å®¶åšäº†éå¸¸å¤šçš„è¯„ä¼°ï¼Œè®¨æ•™åˆ°äº†å¾ˆå¤šå®ç”¨çš„æ–¹æ³•ï¼Œæ„Ÿè°¢å­©å­è®©æˆ‘ä¸€è·¯æˆé•¿ã€‚</p><p>ç†æƒ³æ˜¯å¾ˆç¾å¥½çš„ï¼Œç°å®è¿˜æ˜¯å¾ˆéª¨æ„Ÿçš„ï¼Œå»å¹´çš„ flag ç»ˆç©¶å€’ä¸‹äº†ä¸å°‘ï¼Œä»Šå¹´æˆ‘ä¸ˆæ¯å¨˜è¿‡æ¥äº†ï¼Œ æˆ‘æ²¡æœ‰å†ä¸»åŠ¨å»åšé¥­ï¼Œå¨è‰ºå€’é€€ä¸å°‘ï¼Œç”Ÿå­˜æŠ€èƒ½åˆå°‘äº†ä¸€æ ·ï¼›ä»Šå¹´çš„é”»ç‚¼æ—¶é—´éå¸¸å°‘ï¼Œæˆ·å¤–çš„æ¬¡æ•°å±ˆæŒ‡å¯æ•°ï¼Œå¥èº«æˆ¿çš„è¿åŠ¨ä¹Ÿæ˜¯åœæ‘†ï¼Œæˆ‘æœ€çƒ­è¡·çš„åŠ¨æ„Ÿå•è½¦ä»Šå¹´ä¹Ÿæ²¡æœ‰è¸©è¿‡ä¸¤å›ï¼›ä»Šå¹´è®¡åˆ’çš„å…¨å®¶æ—…æ¸¸ç»ˆç©¶è¿˜æ˜¯æ³¡æ±¤äº†ï¼Œæ¯æ¬¡çš„è®¡åˆ’é‡Œé¢éƒ½æœ‰è€äººå’Œå°å­©ï¼Œè€ƒè™‘çš„å› ç´ éå¸¸å¤šï¼Œæœ€åå°±æ˜¯å®¶é‡Œäººå«Œéº»çƒ¦ä¸æƒ³å»ï¼Œç»ˆç©¶æ˜¯æˆ‘åšçš„ä¸å¤Ÿå¥½å§ï¼Œå¸Œæœ›ç–«æƒ…æ”¾å¼€äº†æˆ‘ä»¬ä»å‘¨è¾¹åŸå¸‚å¼€å§‹ä¸ˆé‡ç¥–å›½çš„å¤§åœ°ï¼›ä»Šå¹´å’Œæœ‹å‹ä»¬çš„èšä¼šä¹Ÿæ›´å°‘äº†ï¼Œæœ‹å‹ä»¬åœ¨è¿™ä¸€ä¸¤å¹´é‡Œå˜åŒ–å¾ˆå¤§ï¼Œå¤§å®¶éƒ½åœ¨å„è‡ªä¸ºæ›´å¥½çš„ç”Ÿæ´»å¿™ç¢Œç€ï¼Œå¸Œæœ› 2023 å¹´ï¼Œå¤§å®¶çš„å¥½äº‹æ¥è¸µè€Œè‡³ï¼Œæˆ‘ä»¬å¸¸èšèšä¸€èµ·åº†ç¥ä¸€èµ·ä¸çœ ä¸ä¼‘å—¨èµ·æ¥ï¼</p><h2 id="æˆ‘çš„åŠ›é‡ï¼Œå› ä½ è€Œèµ·"><a href="#æˆ‘çš„åŠ›é‡ï¼Œå› ä½ è€Œèµ·" class="headerlink" title="æˆ‘çš„åŠ›é‡ï¼Œå› ä½ è€Œèµ·"></a>æˆ‘çš„åŠ›é‡ï¼Œå› ä½ è€Œèµ·</h2><p>2 æœˆ 13 æ—¥ï¼ŒNBA å¸¸è§„èµ›å¼€å§‹äº†ä¸€åœºç„¦ç‚¹æˆ˜ï¼Œæ¹–äººå®¢åœºæŒ‘æˆ˜å‹‡å£«ï¼Œè©¹å§†æ–¯è¿æ¥ç”Ÿæ¶¯é‡Œç¨‹ç¢‘æ—¶åˆ»ã€‚å½“æ¯”èµ›ç¬¬ä¸‰èŠ‚è¿˜å‰© 7 åˆ† 08 ç§’æ—¶ï¼Œè©¹å§†æ–¯ä¸‰åˆ†å‘½ä¸­å¾—åˆ°æœ¬åœºç¬¬ 21 åˆ†ï¼Œç”Ÿæ¶¯å¸¸è§„èµ›+å­£åèµ›æ€»å¾—åˆ†è¾¾åˆ° 44152 åˆ†ï¼Œè£ç™»å†å²ç¬¬ä¸€ã€‚</p><table><thead><tr><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/75906eedd59c44979137f01933eee6ec~tplv-k3u1fbpfcp-zoom-1.image" alt="581672323857_.pic"></th><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3380674f60843e4a4693782b304370d~tplv-k3u1fbpfcp-zoom-1.image" alt="601672323960_.pic"></th></tr></thead></table><p>ä¸€å¼€å§‹å–œæ¬¢ James æ˜¯å› ä¸ºä»–çš„å¤©èµ‹ï¼Œä»–é‚£ç‚¸è£‚çš„æ‰£ç¯®è®©æˆ‘ç–¯ç‹‚ï¼›åé¢æ·±å…¥äº†è§£ï¼Œä»–ä¸ºç¤¾åŒºåšå¾ˆå¤šå…¬ç›Šï¼Œå¸®åŠ©èº«è¾¹çš„å°å­©ä¸Šå­¦ï¼Œç»™ä»–ä»¬æ‰“æ°”åŠ æ²¹ï¼Œè®©æˆ‘å¯¹ James çš„äººå“æ·±æ·±çš„æŠ˜æœï¼›ä»–å¯¹å¦»å­æ˜¯å¦‚æ­¤çš„æ·±æƒ…ï¼Œè¿™ä¹ˆå¤šå¹´æ¥ï¼Œæ²¡æœ‰ä»»ä½•ç»¯é—»ï¼›ä½œä¸ºä¸€ä¸ªå•äº²å®¶åº­é•¿å¤§çš„å­©å­ï¼Œä»–è‡ªå·±å°±æ˜¯ä¸€ä¸ªå¥½çˆ¶äº²ï¼Œæ•™å¯¼æœ‰æ–¹ï¼ŒæŠŠçˆ±çŒ®ç»™äº†å‡ ä¸ªå­©å­ä»¬ï¼›åŒæ—¶ James ä¹Ÿéå¸¸è‡ªå¾‹ï¼Œä»æ¥ä¸åƒåƒåœ¾é£Ÿå“ï¼Œå¾ˆæ³¨é‡èº«ä½“çš„ä¿å…»ï¼›å¾ˆå¤šäººéƒ½å¬è¯´è¿‡ James å¾ˆå°æ°”ï¼Œè‡ªå·±çš„æ‰‹æœºç”šè‡³éƒ½ä¸èˆå¾—ä½¿ç”¨æµé‡ï¼Œå´ä¼šç»™ç¤¾åŒºè¿›è¡Œå¤§é‡æèµ ï¼Œå¾ˆå¤§æ°”å¾ˆå‹å–„ï¼›ç»¼åˆå„æ–¹é¢æ¥è®²ï¼ŒJames éƒ½æ˜¯æˆ‘å­¦ä¹ çš„æ¦œæ ·ï¼Œæ˜¯æˆ‘å¿ƒä¸­æœ€æœ€ä¼˜è´¨çš„å¶åƒã€‚ç°åœ¨ 38 å²çš„ä»–ï¼Œä¾ç„¶åœ¨è”ç›Ÿå¾æˆ˜ï¼Œä¾ç„¶æ‰“å‡ºäº†é«˜æ°´å‡†ã€‚æ„¿ä½ åé¢çš„æ¯”èµ›ï¼Œèƒ½å¤Ÿåœ¨å–å¾—æˆç»©çš„åŒæ—¶ä¹Ÿè®°å¾—ä¿æŠ¤å¥½è‡ªå·±çš„èº«ä½“ï¼ŒåŠ æ²¹åŠ æ²¹ï¼Œä»¥ä½ ä¸ºè£ï¼</p><table><thead><tr><th><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d1e847a518349d2a6b4c9fec426777d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></th><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f61ff973f5dd43298fc22b29070f1f2b~tplv-k3u1fbpfcp-zoom-1.image" alt="591672323960_.pic"></th></tr></thead></table><h2 id="ä¸€ç¬‘æ³¯æ©ä»‡ï¼Œæˆ‘ä»¬çˆ¶å­ä¿©"><a href="#ä¸€ç¬‘æ³¯æ©ä»‡ï¼Œæˆ‘ä»¬çˆ¶å­ä¿©" class="headerlink" title="ä¸€ç¬‘æ³¯æ©ä»‡ï¼Œæˆ‘ä»¬çˆ¶å­ä¿©"></a>ä¸€ç¬‘æ³¯æ©ä»‡ï¼Œæˆ‘ä»¬çˆ¶å­ä¿©</h2><p>4 æœˆåº•æˆ‘ä»¬æŠŠå­©å­æ¥åˆ°äº†èº«è¾¹ï¼Œ èµ¶åœ¨5.1å·èŠ‚æ—¥æˆ‘ä»¬å…¨å®¶ä¸€èµ·å»äº†æ·±åœ³é‡ç”ŸåŠ¨ç‰©å›­ã€‚ ä¸ºä»€ä¹ˆæƒ³å»è¿™é‡Œï¼Œå› ä¸ºå­©å­çš„è¯­è¨€å‘è‚²ç›¸å¯¹æ¯”è¾ƒæ™šï¼Œä¸¤å²4ä¸ªæœˆçš„å°å®å®è®¤çŸ¥ä¸å¤ªå¤Ÿï¼Œæ¯”èµ·ä¹¦æœ¬é‡Œé¢çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬ä¸€è‡´è®¤ä¸ºå®é™…æ„Ÿå—ä¼šè®°å¿†æ›´æ·±åˆ»ï¼›æˆ‘ä»¬å¸¦å­©å­ä»æ—©ä¸Šé€›åˆ°äº†æ™šä¸Šï¼Œå…¨å®¶äººå¸¦ç€ä¸€èµ·èµ°æ²¡é‚£ä¹ˆç´¯ï¼›ä¹°äº†å¾ˆå¤šé£Ÿç‰©å–‚ç»™å¤§è±¡åƒï¼Œè¿™ä¸ªè¿‡ç¨‹è®©ä»–é€æ¸ä¿¡ä»»åŠ¨ç‰©ä»¬ã€‚</p><p>æˆ‘ä»¬æ‹äº†å¾ˆå¤šè§†é¢‘å’Œç…§ç‰‡ï¼Œ ä¸€æ–¹é¢æ˜¯åˆšæ¥åˆ°å°å®å®ï¼ŒæŠ‘åˆ¶ä¸ä½çš„å¼€å¿ƒå’Œå–œæ‚¦å……æ–¥ç€ï¼Œ è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å› ç´ ï¼Œ è¿™äº›ç´ æå°±æ˜¯ä»–æ¥ä¸‹æ¥1ä¸ªæœˆçš„æ•™å­¦ç´ æï¼Œ åœ¨æˆ‘ä»¬å¤§å®¶çš„åŠªåŠ›ä¸‹ï¼Œå°ç°ç°å°†è¿‘ä¸¤å‘¨å·²ç»å…¨éƒ¨çŸ¥é“äº†å°åŠ¨ç‰©ä»¬çš„åå­—å’Œä¹ æ€§ï¼Œè¿˜å¯ä»¥ç”¨æ™®é€šè¯è¡¨è¾¾å‡ºæ¥ï¼Œ è¿™æ˜¯ä»–å¾ˆå¤§çš„è¿›æ­¥äº†ï¼Œ åœ¨é¼“åŠ±å’Œçˆ±çš„ç¯å¢ƒä¸­ï¼Œ å°å­©å­å¾ˆé‡Šæ”¾å­¦å¾—å¾ˆå¿« ã€‚</p><p>åˆšæ¥æ—¶å€™çš„æ€¯ç”Ÿï¼Œ åœ¨å¾ˆçŸ­çš„æ—¶é—´é‡ŒåŒ–ä¸ºä¹Œæœ‰ï¼Œ å°å­©å­åœ¨è¶…å¸‚åœ¨å¹¿åœºå¼€å§‹æœ‰è‡ªå·±çš„ç¤¾äº¤åœˆå­ï¼Œ è¿™æ˜¯å¥½äº‹ï¼Œ ä½†ä¹Ÿä¸å…¨æ˜¯å¥½äº‹ã€‚å°å­©å­å’Œå¤§å­©å­å­¦åˆ°äº†å¾ˆå¤šéª‚äººçš„è¯ï¼Œè¿˜å­¦åˆ°äº†å¾ˆå¤šç²—é²çš„è¡Œä¸ºï¼Œç”šè‡³è¿˜æ‰“äººï¼Œæ¯å¤©åµç€ä¹°æ–°çš„ç©å…·ï¼Œ å»è¶…å¸‚ä¹°åƒçš„ï¼Œ ä¹°ç¤¼ç‰©ï¼Œåˆ°äº†åƒé¥­çš„æ—¶å€™ä¸åƒé¥­è°ƒçš®æ£è›‹ï¼Œ åˆ°äº†è¯¥ç¡è§‰çš„æ—¶å€™å¼‚å¸¸å…´å¥‹è¦ç©æ¸¸æˆç­‰ç­‰ï¼Œ æˆ‘ç»ˆç©¶è¿˜æ˜¯æ‰¿æ‹…äº†ä¸¥çˆ¶çš„å½¢è±¡ï¼Œ ç‹ ç‹ æ‰“è¿‡ä»–ï¼Œ æŠŠä»–é”åœ¨å°æˆ¿é—´ï¼Œ è®©ä»–æ²¡æœ‰ä»»ä½•çš„æŠ“æ‰‹ï¼Œå’Œä»–è¿›è¡Œæ·±å…¥æ²Ÿé€šã€‚ ä¸€å¼€å§‹ä»–ä¹Ÿå¾ˆä¸å¬è¯ï¼Œä¸€æ‰“ä»–ä»–å°±å¼€å§‹å¤§å“­ï¼Œ å¾ˆç€æ€¥ç„¶åä¸€ä¸‹æŠŠåƒçš„å…¨åäº†ï¼Œæˆ‘å†…å¿ƒæ…Œä½†è¿˜æ˜¯é»˜é»˜ç»™ä»–æ”¶æ‹¾å¹²å‡€è¿˜æ˜¯è¦å’Œä»–è®²é“ç†ï¼Œç»ˆäºè¶Šè®²è¶Šé€šäº†ï¼Œæ…¢æ…¢èƒ½ç›¸äº’ç†è§£äº†ï¼Œæˆ‘ä»¬ä¹Ÿè¾¾æˆäº†ä¸€è‡´ã€‚å­©å­æ¯æ¬¡ä»å¤–é¢ä¹°äº†åƒçš„ä¸œè¥¿å›æ¥ï¼Œ éƒ½ä¼šæ•²å¼€æˆ‘çš„æˆ¿é—¨ï¼Œç»™çˆ¸çˆ¸æœ€å…ˆå°å°ï¼Œ ä¹°äº†ç©å…·å›æ¥ï¼Œ ä¹Ÿæ˜¯ç¬¬ä¸€æ—¶é—´æ‰¾çˆ¸çˆ¸é™ªä»–ç©ç©ï¼Œçˆ¶å­ä»æ¥æ²¡æœ‰éš”å¤œä»‡ï¼Œ è®²é“ç†å½’è®²é“ç†ï¼Œ æˆ‘ä»¬è¿˜æ˜¯å¥½æœ‹å‹ä¸€æ ·ï¼Œ ä¸€èµ·åˆ†äº«ä¸€èµ·ç©ã€‚æˆ‘ä¹Ÿæ­£åœ¨åŠªåŠ›æˆä¸ºä¸€ä¸ªæœ‰åŠ›é‡çš„çˆ¸çˆ¸ï¼Œæˆ‘ä»¬ä¸€å—æˆé•¿å§ã€‚</p><table><thead><tr><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bb544f4f2bc24a108b6bfc2f3aa2d0ba~tplv-k3u1fbpfcp-watermark.image" alt="491672315600_.pic_hd.jpg"></th><th><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad1af95e29894432b4500044e749dfcc~tplv-k3u1fbpfcp-watermark.image" alt="501672315613_.pic_hd.jpg"></th><th><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e05f9948771140fa8f00e91ee5b6b44b~tplv-k3u1fbpfcp-watermark.image" alt="511672315621_.pic_hd.jpg"></th></tr></thead><tbody><tr><td><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4a2ecc985e84424809e45918deff73b~tplv-k3u1fbpfcp-watermark.image" alt="521672315651_.pic_hd.jpg"></td><td><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2995f1b11c3a4c87886487ee3a559e7f~tplv-k3u1fbpfcp-watermark.image" alt="531672315696_.pic_hd.jpg"></td><td><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae11e09ff83e446cac4a0e93c47d88c2~tplv-k3u1fbpfcp-watermark.image" alt="541672315844_.pic_hd.jpg"></td></tr><tr><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/25dd42370a82495689127aa147a47b13~tplv-k3u1fbpfcp-watermark.image" alt="551672315893_.pic_hd.jpg"></td><td><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89eaada491f84cecaba891229ed1b361~tplv-k3u1fbpfcp-watermark.image" alt="561672316037_.pic_hd.jpg"></td><td><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8fb1dfb9fe404b218c5b5327a63d54b6~tplv-k3u1fbpfcp-watermark.image" alt="571672316048_.pic_hd.jpg"></td></tr></tbody></table><h2 id="ä¸€ç¾¤äººçš„å¼€å¿ƒæ½®æ±•æ¸¸"><a href="#ä¸€ç¾¤äººçš„å¼€å¿ƒæ½®æ±•æ¸¸" class="headerlink" title="ä¸€ç¾¤äººçš„å¼€å¿ƒæ½®æ±•æ¸¸"></a>ä¸€ç¾¤äººçš„å¼€å¿ƒæ½®æ±•æ¸¸</h2><p>ä¹‹å‰ä»æ¥æ²¡ç»„ç»‡è¿‡è¿™ä¹ˆå¤šâ¼ˆçš„æ´»åŠ¨ï¼Œè¯´å¥å®è¯ï¼Œå½“æ—¶å‹â¼’è¿˜æŒºâ¼¤çš„ï¼Œä½†æ˜¯æ—¢ç„¶æ½ä¸‹äº†è¿™ä¸ªæ´»ï¼Œå°±ç¡¬ç€å¤´â½ªä¸Šå§ã€‚â¼€å¼€å§‹ä¹Ÿæ˜¯â½¹ä¸Šå„ç§æŸ¥æ”»ç•¥ï¼Œåâ¾¯æ…¢æ…¢çš„ä¹Ÿå°±ä¸Šé“äº†ã€‚</p><p>æˆ‘ä»¬è¿™æ¬¡æ—…â¾é€‰æ‹©çš„æ˜¯æ½®æ±•ä¸‰å¤©ä¸¤å¤œæ¸¸ï¼Œ å¾ˆæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒå’Œä¿¡ä»»ï¼šç¡®å®šå¥½å‡ºå‘çš„â½‡æœŸï¼Œæˆ‘é€‰æ‹©äº† 7.15 - 7.17ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹åˆšå¥½æ˜¯å‘¨äº”è¿ç€å‘¨æœ«ï¼Œåªéœ€è¦æŠ¥å¤‡â¼€å¤©ï¼Œå¦å¤–æŸ¥çœ‹å¤©â½“é¢„æŠ¥ï¼Œè¿™â¼å¤©éƒ½æ˜¯æ™´å¤©â¾®å¸¸é€‚åˆæ¸¸ç©ã€‚ç¡®å®šå‡ºâ¾äº¤é€šï¼Œå®‰æ’å¥½ä½å®¿é…’åº—ã€‚å½“æ—¶åšäº†ä¸¤ä¸ªå‡ºè¡Œâ½…æ¡ˆï¼Œâ½…æ¡ˆâ¼€ï¼šå…¨ç¨‹â¾ƒé©¾æ¸¸ï¼›â½…æ¡ˆâ¼†ï¼šâ¾¼é“ + æ‰“è½¦ + å½“åœ°ç§Ÿâ»‹â¾ƒé©¾æ¸¸ï¼›â½…æ¡ˆâ¼€éœ€è¦ä»æ·±åœ³å¼€è¿‡å»ï¼Œè€ƒè™‘åˆ°â¼€æ˜¯è€—æ—¶å¤ªä¹…ï¼ˆä»æ·±åœ³å¼€è¿‡å»è¦ 5 ä¸ªâ¼©æ—¶å·¦å³ï¼‰ï¼Œâ¼†æ˜¯å¼€å¤ªä¹…â»‹å®¹æ˜“ç–²åŠ³é©¾é©¶ï¼Œäºæ˜¯ pass æ‰äº†ã€‚æœ€ç»ˆæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©äº†â½…æ¡ˆâ¼†ï¼Œè¿™ç§â½…æ¡ˆâ¼¤å®¶éƒ½è½»æ¾ï¼Œç•™ç€ç²¾â¼’å½“åœ°ç§Ÿâ»‹â¾ƒé©¾ï¼Œæ¬£èµç¾æ™¯ç®€ç›´å¤ªâ¾¹äº†ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58da10199984433c85491fdcce11908e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>ç”¨ä¸€ç»„å›¾æ¥æ„Ÿå—ä¸€ä¸‹æˆ‘ä»¬çš„å¿«ä¹ï¼š</p><h3 id="æ½®å·æ‰“å¡"><a href="#æ½®å·æ‰“å¡" class="headerlink" title="æ½®å·æ‰“å¡"></a>æ½®å·æ‰“å¡</h3><table><thead><tr><th><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f37e43559b7448b283fc40ea408ef673~tplv-k3u1fbpfcp-watermark.image" alt="331672308116_.pic.jpg"></th><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/695de4e4266f40969575145f9c938f8d~tplv-k3u1fbpfcp-watermark.image" alt="341672308122_.pic.jpg"></th><th><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eae2f0345357496291b5e600ef5e3544~tplv-k3u1fbpfcp-watermark.image" alt="351672308164_.pic.jpg"></th></tr></thead><tbody><tr><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd7d3035c2c042e49b9dba7b2868727e~tplv-k3u1fbpfcp-watermark.image" alt="361672308170_.pic.jpg"></td><td><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b472ae42c954e3faf69533ce9c2fb59~tplv-k3u1fbpfcp-watermark.image" alt="371672308179_.pic.jpg"></td><td><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/872d7f79b3234b59acaa80de0d99f697~tplv-k3u1fbpfcp-watermark.image" alt="381672308181_.pic.jpg"></td></tr></tbody></table><p><strong>ç‰ŒåŠè¡—</strong></p><p>ç‰ŒåŠè¡—å¯è°“æ˜¯æ½®å·çš„ä¸€å¤§æ—…æ¸¸æ‹›ç‰Œäº†ï¼Œå¤æœ´çš„è¡—é“ï¼Œé‡æ–°æ•´ä¿®è¿‡çš„ç‰ŒåŠä¿ç•™ç€åŸæœ¬çš„é£å‘³ï¼Œèµ°è¡—ä¸²å··è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šçš„å»å¤„ç­‰å¾…ç€å‘ç°ã€‚ç‰ŒåŠè¡—é™¤äº†ç‰ŒåŠä¹‹å¤–ï¼Œé‡Œé¢æœ‰æ½®å·å¤§å½±é™¢ï¼Œç™¾è´§å¤§æ¥¼ï¼Œæ–°åä¹¦åº—çš„æ—§å€ï¼Œè®¸é©¸é©¬åºœç­‰ï¼Œè¿˜æœ‰èŒ¶é¦†å¯ä»¥å¬æˆï¼Œä¼‘æ¯ä½“éªŒæ…¢ç”Ÿæ´»ä¹Ÿæœ‰ä¸æ—¶ä¿±è¿›çš„æ—¶å…‰è½´ç­‰æ–°å¼ç½‘çº¢åº—ï¼Œè¿˜æœ‰éšè·¯å¯è§çš„æ½®å·ä¸‰å®ã€‚</p><p><strong>æ¹˜å­æ¡¥</strong></p><p>æ¥åˆ°ç‰ŒåŠè¡—å°±ä¸å¾—ä¸å»æ¹˜å­æ¡¥èµ°ä¸€èµ°äº†ï¼Œæ¹˜å­æ¡¥è¿˜æ·»åŠ äº†ç¯å…‰ç§€è¡¨æ¼”ï¼Œæ™šä¸Šè¿˜æœ‰æ¸¸èˆ¹å¯ä»¥æ¸¸è§ˆå¤œæ™¯ï¼Œæˆ‘ä»¬å»çš„æ—¶å€™ä¸‹åˆ5ç‚¹å°±å…³äº†ï¼Œè¿™ä¸ªä½“éªŒæœ‰ç‚¹ç‘•ç–µå§ã€‚</p><p><strong>ä¸­å±±è·¯</strong></p><p>æ¯åº§åŸå¸‚éƒ½æœ‰è‡ªå·±çš„ä¸­å±±è·¯ï¼Œæ½®å·çš„ä¸­å±±è·¯ä½äºæ½®å·å¤åŸåŒº, è¿™é‡ŒèŸèƒäº†ä¼—å¤šå¤åŸçš„äººæ–‡é£è²Œ, ä¸€æ¥¼æ˜¯æ½®å·å·¥è‰ºå¤§å¸ˆçš„å·¥ä½œå®¤è¿™é‡Œå±•ç¤ºæœ‰æ½®å·æœ¨é›•ï¼Œæ½®ç»£ï¼ŒèŠ±ç¯ç­‰æ‰‹å·¥è‰ºæœ¯å“ï¼ŒäºŒæ¥¼é£æ ¼ç‹¬ç‰¹ï¼Œæ—¢å¤æœ´åˆç°ä»£çš„æ–‡åŒ–é£æƒ…å®¢æ ˆï¼Œè¿˜è®¾æœ‰èŒ¶åº§å¯ä»¥ä¸ä¸‰äº”å¥½å‹å°èšã€‚</p><h3 id="å—æ¾³å²›æ‰“å¡"><a href="#å—æ¾³å²›æ‰“å¡" class="headerlink" title="å—æ¾³å²›æ‰“å¡"></a>å—æ¾³å²›æ‰“å¡</h3><p>å—æ¾³å²›ä½äºå¹¿ä¸œçœæ±•å¤´å¸‚ï¼Œä¹Ÿæ˜¯å¹¿ä¸œå”¯ä¸€çš„æµ·å²›å¿ã€‚å²›ä¸Šè¢«äººå·¥å¼€å‘çš„è¿˜æ˜¯æ¯”è¾ƒå°‘ï¼Œæ•´ä¸ªæµ·å²›ä¿ç•™ç€æ¯”è¾ƒåŸå§‹çš„é¢è²Œã€‚å»å—æ¾³å²›ä¸€èˆ¬é€‰æ‹©è½®æ¸¡ã€è‡ªé©¾æˆ–è€…å…¬äº¤è½¦ã€‚å²›ä¸Šæœ‰ç¯å²›å…¬è·¯ï¼Œè·¯è¾¹æœ‰å¾ˆå¤šå¤§å¤§å°å°çš„è§‚æ™¯å°ï¼Œå¯ä»¥éšæ—¶åœä¸‹æ¥é€›ä¸€é€›ï¼Œæ‹ä¸€æ‹ï¼Œæ¨èè‡ªé©¾æˆ–è€…åŒ…è½¦ç¯å²›æ¸¸ï¼Œä¼šæ›´åŠ ä¾¿åˆ©å’Œè‡ªç”±ã€‚</p><table><thead><tr><th><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ebb60f021bab4ec3bbba1101bb76840a~tplv-k3u1fbpfcp-watermark.image" alt="391672308540_.pic.jpg"></th><th><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/948bcfadd0fa4a3a904f247ffba61b52~tplv-k3u1fbpfcp-watermark.image" alt="401672308547_.pic.jpg"></th><th><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98bf094936fc44b195e06966432dd38f~tplv-k3u1fbpfcp-watermark.image" alt="411672308550_.pic.jpg"></th></tr></thead><tbody><tr><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4f2a3ccc28d4b67ba4c8f92085ac17a~tplv-k3u1fbpfcp-watermark.image" alt="421672308556_.pic.jpg"></td><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d7f61ef57b440948883baa353c74de1~tplv-k3u1fbpfcp-watermark.image" alt="431672308561_.pic.jpg"></td><td><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d2bda946a4c4d1ab5201203638e6a1d~tplv-k3u1fbpfcp-watermark.image" alt="441672308567_.pic.jpg"></td></tr><tr><td><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c1a755184e3454baea727bb496d7249~tplv-k3u1fbpfcp-watermark.image" alt="451672308573_.pic.jpg"></td><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f74df0e0f99a482f98b19b803e471cd7~tplv-k3u1fbpfcp-watermark.image" alt="461672308579_.pic.jpg"></td><td><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/baf9bfe42bd0480e960c3c1ea41c1c44~tplv-k3u1fbpfcp-watermark.image" alt="481672308855_.pic.jpg"></td></tr></tbody></table><p>å²›ä¸Šçš„ç¾é£Ÿå‡ ä¹éƒ½è·Ÿæµ·é²œæœ‰å…³ï¼Œé±¼ã€è™¾ã€è´å£³ç±»ã€ç´«èœç­‰ç­‰ï¼Œç§ç±»ç¹å¤šï¼Œä¸åŒçš„åšæ³•èƒ½è·å¾—ä¸åŒçš„å‘³è§‰äº«å—ã€‚åˆ°äº†å—æ¾³ä¸€å®šä¸è¦é”™è¿‡ç´«èœç‚’é¥­ï¼Œè¿™æ˜¯å½“åœ°çš„ç‰¹è‰²ï¼ŒåŸºæœ¬æ¯å®¶åº—éƒ½æœ‰ã€‚ç´«èœå…ˆç”¨æ²¹è¿‡ä¸€éï¼Œå…¥å£å¾ˆè„†ï¼Œå†é…ä»¥æµ·é²œã€è‚‰ã€è›‹ç­‰ä½æ–™ï¼Œå£æ„Ÿç»æ€ã€‚</p><p>å—æ¾³å²›ç¯å²›æœ‰ä¸‰æ¡è·¯çº¿å¯é€‰ï¼Œåˆ†åˆ«æ˜¯ç¯å²›åŒ—çº¿ã€ç¯å²›å—çº¿å’Œç¯å²›ä¸­çº¿ï¼Œæ™¯ç‚¹ä¼—å¤šï¼Œå¦‚æœæ—¶é—´å®‰æ’ä¸Šä¸æ–¹ä¾¿ï¼Œå¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½æŒ‘é€‰å‡ ä¸ªæ™¯ç‚¹æ‰“å¡ï¼Œéšå¿ƒå‡ºå‘æ‰æ˜¯æœ€èˆ’é€‚çš„ã€‚</p><p>å—æ¾³å²›ä¸Šç¾ä¸½çš„æµ·æ¹¾éšå¤„å¯è§ï¼Œåœ¨ä¼—å¤šæµ·æ¹¾ç¾æ™¯ä¸­ï¼Œæœ€ä¸ºè‘—åçš„æ˜¯é’æ¾³æ¹¾ã€‚è¿™é‡Œæµ·æµªä½å¹³ï¼Œæ²™è´¨ç»†æ´ï¼Œæµ·æ°´æ— æ±¡æŸ“ï¼Œé¢œè‰²å§‹ç»ˆå‘ˆç¢§è“è‰²ã€‚</p><p><strong>æ—…è¡Œå°è´´å£«ï¼š</strong> å»æµ·å²›æ¸¸ç©ï¼Œç´«å¤–çº¿æ ¼å¤–å¼ºçƒˆï¼Œé˜²æ™’å·¥ä½œä¸€å®šè¦åšå¥½ã€‚å‡†å¤‡ä¸€äº›å¸¸ç”¨çš„è‚ èƒƒæ€§çš„è¯ï¼Œæ¯”å¦‚ä¿æµä¸¸ï¼Œæ™•è½¦ã€æ°´åœŸä¸æœæ—¶å¯ä»¥æœç”¨ã€‚å²›ä¸Šå–å¹²è´§çš„åº—å¾ˆå¤šï¼Œæ¯å®¶åº—ç§ç±»å·®ä¸å¤šï¼Œä»·æ ¼å·®åˆ«å¾ˆå¤§ï¼Œå»ºè®®å¤§å®¶æ¯”æ¯”ä»·å§ã€‚è¿›å…¥å¤å¤©ä¹‹åï¼Œå—æ¾³å²›ä¸Šçš„é’æ¾³æ¹¾å°±éå¸¸é€‚åˆæ¸¸æ³³ï¼Œæµ·æ°´å¹³é™è€Œä¸”æ¯”è¾ƒå¹³ç¼“ã€‚æ— è®ºæ˜¯æµ·æ™¯ã€æ²™æ»©ã€ç¾é£Ÿï¼Œè¿˜æ˜¯æ·³æœ´çš„æ¸”æ‘é£æƒ…ï¼Œå—æ¾³å²›éƒ½æ˜¯ä¸ªå€¼å¾—åº¦å‡æ”¾æ¾çš„åœ°æ–¹ã€‚ä¸ç®¡æ˜¯å‡æœŸå‡ºè¡Œï¼Œä¸å¥½å‹ç»“ä¼´æ¸¸ï¼Œæˆ–è€…æ˜¯å®¶äººå‡ºè¡Œï¼Œå—æ¾³å²›éƒ½æ˜¯ä¸€ä¸ªå€¼å¾—æ¨èçš„æ”¾æ¾å¥½å»å¤„ã€‚</p><p><strong>æ€»ç»“ï¼š</strong></p><p>æ¥ä¸ªæ€»ç»“ä¸ºè¿™æ¬¡å›¢å»ºæ—…è¡Œç”»ä¸Šä¸€ä¸ªåœ†æ»¡çš„å¥å·å§ï¼š</p><p>1ã€å¤§å®¶çš„è‡ªç†èƒ½åŠ›ç®€ç›´ä¸è¦å¤ªå¼ºã€‚å¾ˆé…åˆï¼ŒåŸºæœ¬ä¸Šæˆ‘æ²¡æ“å•¥å¿ƒ</p><p>2ã€æ•´ä½“ä¸Šåƒå–ç©éƒ½å¾ˆå¼€å¿ƒã€‚æ—…é€”éš¾å…ä¼šæœ‰ä¸€äº›ç‘•ç–µï¼Œä¾‹å¦‚åœ¨å—æ¾³åšæ ¸é…¸ï¼Œåœ¨å—æ¾³åƒæ—©é¤ï¼Œåœ¨å—æ¾³åŠ èœğŸ¤£ã€‚ä½†æ˜¯å¼€å¿ƒçš„äº‹æƒ…è¿œå¤§äºçƒ¦æ¼å§ã€‚ç¬¬ä¸€å¤©æ½®å·è¡Œè¿˜æ˜¯éå¸¸ä¸é”™çš„ï¼Œæˆ‘ä»¬åƒäº†æ­£å®—çš„æ½®æ±•ç‰›è‚‰ç«é”…ï¼Œæ¸¸ç©äº†æ½®å·å¤åŸï¼Œåƒé¥±å–è¶³ï¼šå¹¿æµé—¨ï¼Œç”²ç¬¬å··ï¼Œç‰ŒåŠè¡—ï¼Œæ¹˜å­æ¡¥ï¼ˆ5ç‚¹å°±å…³äº†ï¼Œåªèƒ½åœ¨å¤–é¢çœ‹ï¼Œå·®è¯„ï¼‰ã€‚ç¬¬äºŒå¤©é…’åº—æä¾›çš„æ—©é¤ç®€ç›´ä¸è¦å¤ªå¥½ï¼Œè‡ªåŠ©é¤ï¼Œå¤§å®¶å¯ä»¥éšæ„åƒï¼Œè§è¯äº†è·³è·³è™ä¸€äººåƒäº†ä¸‰æ–¤è™¾ï¼ˆè¶…å¤§ä¸ªï¼‰ï¼Œç›´æ¥æŠŠæˆ¿è´¹éƒ½ç»™åƒå›æ¥äº†ï¼Œå“ˆå“ˆ</p><p>3ã€è¾›è‹¦å„ä½å¸æœºçš„ä»˜å‡ºï¼Œ@æœç„¶ @æŸ³ç«¹ @é˜¿è¾‰ ã€‚è¿˜å¥½è¿™æ¬¡é€‰æ‹©äº†å½“åœ°è‡ªé©¾ï¼Œä¸ç„¶æˆ‘ä¼šåæ‚”çš„ã€‚ä½ ä»¬è½¦æŠ€ç®€ç›´ä¸è¦å¤ªå¥½ï¼Œå¦¥å¦¥çš„è€å¸æœºï¼Œä¸ºå¤§å®¶çš„é¡ºç•…å‡ºè¡Œä¿é©¾æŠ¤èˆª</p><p>4ã€å……æ»¡æƒŠå–œçš„ä¸€å¤©ã€‚ç¬¬äºŒå¤©æˆ‘ä»¬åƒå®Œæ—©é¤å°±å‡ºå‘å»å—æ¾³äº†ï¼Œç¬¬ä¸€ä¸ªè®©æˆ‘æ„Ÿåˆ°æƒŠå–œçš„ä¾¿æ˜¯å—æ¾³å¤§æ¡¥ï¼Œéå¸¸çš„å£®è§‚ï¼Œåœ¨ä¸Šé¢å¼€è½¦çœŸçš„æ˜¯ä¸€ç§å¾ˆæ£’çš„ä½“éªŒã€‚ç¬¬äºŒä¸ªæƒŠå–œä¾¿æ˜¯å—æ¾³å²›çš„æ™¯è‰²ï¼Œæˆ‘ä»¬ä¼‘æ¯åˆ°ä¸‹åˆ5ç‚¹æ‰å‡ºå»æ‰“å¡ï¼Œæ¸¸äº†ä¸‰å›±å´–ç¯å¡”ï¼Œæµ·å¤©ä¹‹é—´ä¸œäºšé£æƒ…æ²™æ»©ï¼ˆè¿™ä¸ªæ²™æ»©çœŸçš„è¶…çº§æ£’ï¼‰ï¼Œé’æ¾³æ¹¾ï¼Œé’±æ¾³æ¹¾ç¯å¡”ï¼Œé•¿å±±å°¾ç¯å¡”ï¼Œæ„Ÿæ…¨èµ·çš„æ™šäº†ï¼Œé”™è¿‡äº†ä¸€äº›ç¾æ™¯ã€‚ç¬¬ä¸‰ä¸ªä¾¿æ˜¯æˆ‘ä»¬ååœ¨è½¦é‡Œçœ‹åˆ°ä¸€ä¸ªéå¸¸æ¼‚äº®çš„å°å§å§éª‘ç€ç”µç“¶è½¦ï¼Œæˆ‘ä»¬èµ°åœ¨å¥¹åé¢çœ‹ç€ä»–ï¼Œå¥¹å±…ç„¶æŒ¥æ‰‹å’Œæˆ‘ä»¬æ‰“æ‹›å‘¼ï¼šå—¨ï¼Œå†è§ï¼Œé‚£ä¸€åˆ»çœŸçš„å¾ˆç¾å¥½</p><p>5ã€ä¸ºæ·‘æ¼«åº†ç”Ÿï¼Œæ°›å›´æ‹‰æ»¡ã€‚è®©æˆ‘å°è±¡æ·±åˆ»çš„ä¸¤ä¸ªæ°›å›´ç»„ç»„é•¿ @æ¸¡é£ 0.1ç§’ä¸€å£é—·ï¼Œé€Ÿåº¦ä¸è¦å¤ªå¿« @æœç„¶ ä¸¾æ¯5è¿å¹²ï¼Œå–å®Œè¿˜è¦å˜²è®½ä¸€ç•ªåœ¨åº§çš„å„ä½å–é…’éƒ½æ˜¯åƒåœ¾ï¼Œè¿™æ³¢ä»‡æ¨ç›´æ¥æ‹‰æ»¡ğŸ˜‚</p><p>6ã€åªèƒ½ç”¨ â€œå±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘â€ æ¥å½¢å®¹ã€‚è¢«å‡ºæµ·çš„è€æ¿å‘äº†ä¸‹ï¼Œç­‰äº†æˆ‘ä»¬å¥½ä¸€ä¼šæ‰ä¸Šèˆ¹ï¼Œç»“æœåä¸Šèˆ¹åˆä¸‹èµ·äº†å¤§é›¨ï¼ŒæŠŠå¤§å®¶éƒ½æ·‹æ¹¿äº†ï¼Œå¿ƒé‡Œæœ‰ç‚¹å†…ç–šã€‚å¥½åœ¨åé¢ä¸‹äº†ä¸€ä¼šå°±åœäº†ï¼Œæˆ‘ä»¬åç€èˆ¹ï¼Œå¹ç€æµ·é£æ‹ç€ç…§ï¼Œçœ‹äº†ç”Ÿèšå…»æ®–ï¼Œä½“éªŒäº†æ”¶èŸ¹ç¬¼ï¼Œæœ€åçš„ä¸­é¤æ˜¯äº®ç‚¹ï¼Œå¤§å®¶ä¸€è‡´å¥½è¯„ï¼Œé£åè¯´è¿™æ˜¯ä»–åœ¨å¹¿ä¸œåƒè¿‡æœ€å¥½çš„ä¸€æ¬¡æµ·é²œğŸ˜‚</p><p>æ„çŠ¹æœªå°½ï¼Œå“ˆå“ˆï¼Œå°±åˆ°è¿™é‡Œå§ï¼ŒæœŸå¾…åç»­çš„å›¢å»ºæ—…è¡Œã€‚</p><h2 id="ä»¥åè°å®¶ç¼ºæ¼”å‘˜ï¼Œæ‰¾æˆ‘å‘€"><a href="#ä»¥åè°å®¶ç¼ºæ¼”å‘˜ï¼Œæ‰¾æˆ‘å‘€" class="headerlink" title="ä»¥åè°å®¶ç¼ºæ¼”å‘˜ï¼Œæ‰¾æˆ‘å‘€"></a>ä»¥åè°å®¶ç¼ºæ¼”å‘˜ï¼Œæ‰¾æˆ‘å‘€</h2><p>å½“æ—¶å…¬å¸è¯´è¦ä»æ¯ä¸ªéƒ¨â»”æ‰¾â¼€äº›â¼ˆå»æ‹è§†é¢‘ï¼Œé¢†å¯¼ç›´æ¥æ‰¾åˆ°æˆ‘å’Œå¦å¤–â¼€ä¸ªâ¼¥â½£ï¼Œå¯èƒ½å¹³æ—¶åšäº‹â½è¾ƒç§¯æå§ï¼Œäºæ˜¯å°±è¿™ä¹ˆç¡¬ç€å¤´â½ªä¸Šäº†ã€‚æœ¬æ¥è®¤ä¸ºå°±ç®€å•çš„æ‹æ‹è§†é¢‘ï¼Œåº”è¯¥æ²¡å•¥éš¾åº¦ï¼Œç»“æœå‡ºä¹äº†æ„æ–™ï¼Œä»–è¿™ç§æ‹æ‘„æ˜¯æœ‰å¯¼æ¼”ç¼–å‰§çš„ï¼Œæ•´å¾—è·Ÿæ‹æˆâ¼€æ ·ï¼Œé¡¿æ—¶å°±æ…Œäº†ï¼Œæ‹æ‘„å‰çš„â¼€ä¸ªå‘¨æœ«ç–¯ç‹‚çœ‹å‰§æœ¬ï¼Œæ¼”ç»ƒï¼Œæœ€ç»ˆæ‹æˆé‚£å¤©å°±æ˜¯è¿™ç§æ‰“æ‰®ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ce5097b33614b6fbda3d4e8f2ffcc85~tplv-k3u1fbpfcp-watermark.image" alt="WechatIMG178.jpeg"></p><p>æˆ‘æ‰®æ¼”çš„æ˜¯â¼€ä¸ªâ½†æ‰€ä¸èƒ½çš„â¼¤â½œç¨‹åºçŒ¿ï¼Œè´Ÿè´£è£…é€¼ï¼ˆé€¼è£…çš„æœ‰å¤šè¿‡ï¼Œåâ¾¯æ‰“è„¸å°±æœ‰å¤šç—›ï¼‰ï¼Œå¥½åœ¨æ‹å®Œâ¼¤å®¶çœ‹äº†åï¼Œéƒ½â¼€è‡´å¥½è¯„ï¼Œæˆ‘å°±è¿™æ ·åœ¨å…¬å¸å‡ºåœˆäº†ï¼Œå“ˆå“ˆã€‚</p><p>æƒ³çœ‹è§†é¢‘çš„å¯ä»¥ç‚¹å‡»é“¾æ¥å“¦ï¼š<a href="https://www.bilibili.com/video/BV1Lv4y167iu/?spm_id_from=333.999.0.0&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">å¤§ç‰›ä¸å°ç™½çš„æ­¦æ—å¯¹å†³</a></p><h2 id="åˆèœåˆçˆ±ç©ï¼Œè¯´çš„å°±æ˜¯æˆ‘"><a href="#åˆèœåˆçˆ±ç©ï¼Œè¯´çš„å°±æ˜¯æˆ‘" class="headerlink" title="åˆèœåˆçˆ±ç©ï¼Œè¯´çš„å°±æ˜¯æˆ‘"></a>åˆèœåˆçˆ±ç©ï¼Œè¯´çš„å°±æ˜¯æˆ‘</h2><p>ç”Ÿå‘½åœ¨äºè¿åŠ¨ï¼Œæˆ‘æ¯”è¾ƒçƒ­çˆ±è¿åŠ¨ï¼Œç¯®çƒï¼Œæ¡Œçƒï¼Œä¹’ä¹“çƒï¼Œç¾½æ¯›çƒæ˜¯åˆèœåˆçˆ±ç©ã€‚</p><p>å¤§å­¦çš„æ—¶å€™è¿˜ä¼šç»å¸¸æ’¸é“ï¼Œè¸©åŠ¨æ„Ÿå•è½¦ï¼ŒåŒ…æ‹¬åˆšå‡ºæ¥çš„å‰ä¸¤å¹´ï¼Œæˆ‘æ¯æ¢ä¸€ä¸ªåœ°ï¼Œéƒ½ä¼šå»æŠ¥ä¸€ä¸ªå¥èº«æˆ¿åŠ å¼ºèº«ä½“çš„é”»ç‚¼ã€‚è·Ÿç€éŸ³ä¹çš„æ—‹å¾‹ï¼Œæˆ‘æ„Ÿè§‰ç¬é—´èƒ½èµ·é£ï¼š</p><p>æ›¾ç»æ’¸é“çš„è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1w8411n7eP/?spm_id_from=333.999.0.0&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">ä¼ é€é—¨</a></p><p>æ›¾ç»è¸©åŠ¨æ„Ÿå•è½¦çš„è§†é¢‘ï¼š<a href="https://www.meipai.com/media/919377874">ä¼ é€é—¨</a></p><p>å›å¿†èµ·æ¥ï¼Œæ„Ÿæ…¨ä¸‡åƒå•Šï¼</p><p>ç°åœ¨ç»“å©šç”Ÿå°å­©åï¼Œå¥èº«æˆ¿åŸºæœ¬æ²¡å»è¿‡äº†ï¼Œè¿åŠ¨çš„æ—¶é—´ä¹Ÿå˜å°‘äº†ã€‚è¿™ä¸å…¬å¸åˆšå¥½ä¸¾è¡Œäº†ç¯®çƒæ¯”èµ›ï¼Œç´¢æ€§å°±å‚åŠ äº†ã€‚</p><p>è™½ç„¶æ‰“çš„å¾ˆèœï¼Œä½†æ˜¯é‡åœ¨å‚ä¸å˜› ğŸ˜‚</p><table><thead><tr><th>å®£ä¼ æµ·æŠ¥</th><th>å¯¹æˆ˜å›¾</th></tr></thead><tbody><tr><td><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac0923a563cc417f820f6f60473b4840~tplv-k3u1fbpfcp-watermark.image" alt="basket1.jpeg"></td><td><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48b530d2755848c78cb8ae1ce473201c~tplv-k3u1fbpfcp-watermark.image" alt="basket2.jpeg"></td></tr></tbody></table><h2 id="æŒç»­åˆ›ä½œï¼Œä¸å¿˜åˆâ¼¼"><a href="#æŒç»­åˆ›ä½œï¼Œä¸å¿˜åˆâ¼¼" class="headerlink" title="æŒç»­åˆ›ä½œï¼Œä¸å¿˜åˆâ¼¼"></a>æŒç»­åˆ›ä½œï¼Œä¸å¿˜åˆâ¼¼</h2><p>è¿™â¼€å¹´æˆ‘åœ¨æ˜â¾¦åˆ›ä½œäº† 21 ç¯‡â½‚ç« ï¼Œè·å¾—äº† 410 ä¸ªèµï¼Œ279 ä¸ªæ”¶è—ï¼Œå¸®åŠ©äº† 4.98w ä½å¼€å‘è€…ï¼Œæ˜â¼’å€¼å¢â»“ 4204ï¼Œè¶…è¿‡äº† 97.93% çš„åˆ›ä½œè€…ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0b9ba16519d4e97afc2d723b9e44b24~tplv-k3u1fbpfcp-watermark.image" alt="202212271555802.png"></p><p>åŒæ—¶ï¼Œä¹Ÿæ”¶è·äº†æ˜â¾¦ç»™æˆ‘å¯„é€çš„ç²¾ç¾ç¤¼ç‰©ï¼Œä¸å¿˜åˆå¿ƒï¼Œ ç ¥ç ºå‰è¡Œï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68f9e5aa2b2443719f2fabb6f440a4a6~tplv-k3u1fbpfcp-watermark.image" alt="WechatIMG184.jpeg"></p><p>è¿™ä¸€å¹´çš„â½‚ç« è¾“å‡ºæ¥äº¤å·®äº†ï¼š</p><table><thead><tr><th>åºå·</th><th>æ–‡ç« </th></tr></thead><tbody><tr><td>1</td><td><a href="https://juejin.cn/post/7175504805236834360">App é»‘ç™½åŒ–æŠ€æœ¯å®è·µä¸‹ç¯‡</a></td></tr><tr><td>2</td><td><a href="https://juejin.cn/post/7174768835927965733">App é»‘ç™½åŒ–æŠ€æœ¯å®è·µä¸Šç¯‡</a></td></tr><tr><td>3</td><td><a href="https://juejin.cn/post/7172954363940814862">Android é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šAndroid APKï¼ŒAAB èµ„æºæ··æ·†</a></td></tr><tr><td>4</td><td><a href="https://juejin.cn/post/7168086915445424136">Android é€†å‘ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šAndroid APK ä»£ç æ··æ·†</a></td></tr><tr><td>5</td><td><a href="https://juejin.cn/post/7160363585028227086">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—ï¼šJava å…­å¤§è®¾è®¡åŸåˆ™å’Œå¸¸ç”¨è®¾è®¡æ¨¡å¼</a></td></tr><tr><td>6</td><td><a href="https://juejin.cn/post/7160296095170428965">Gradle ç³»åˆ— ï¼ˆå…­ï¼‰ã€Gradle Transform + ASM + Javassist å®æˆ˜</a></td></tr><tr><td>7</td><td><a href="https://juejin.cn/post/7159841721856032804">Gradle ç³»åˆ— ï¼ˆäº”ï¼‰ã€è‡ªå®šä¹‰ Gradle Transform</a></td></tr><tr><td>8</td><td><a href="https://juejin.cn/post/7158851139088154654">Web ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šCSS ç­‘åŸºä¸Šç¯‡</a></td></tr><tr><td>9</td><td><a href="https://juejin.cn/post/7158479477717073934">Web ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šWeb å¼€å‘å·¥å…·ä»‹ç»</a></td></tr><tr><td>10</td><td><a href="https://juejin.cn/post/7158107697907236878">Android é€†å‘ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šåç¼–è¯‘ APK æŠ€æœ¯å®Œå…¨è§£æ</a></td></tr><tr><td>11</td><td><a href="https://juejin.cn/post/7157713551786934302">Web ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šHTML å¸¸ç”¨æ ‡ç­¾å’Œå±æ€§</a></td></tr><tr><td>12</td><td><a href="https://juejin.cn/post/7146117854553702414">Flutter ç³»åˆ—ï¼ˆå…«ï¼‰ï¼šFlutter ä¸ Android çš„ä½ æ¥æˆ‘å¾€</a></td></tr><tr><td>13</td><td><a href="https://juejin.cn/post/7142650961868095524">Flutter ç³»åˆ—ï¼ˆä¸ƒï¼‰ï¼šFlutter è·¯ç”±å’Œ HTTPS è¯·æ±‚å®æˆ˜</a></td></tr><tr><td>14</td><td><a href="https://juejin.cn/post/7137457377959706654">Flutter ç³»åˆ—ï¼ˆå…­ï¼‰ï¼šFlutter å¸¸ç”¨è¡¨å• Widget</a></td></tr><tr><td>15</td><td><a href="https://juejin.cn/post/7137082885571346463">Flutter ç³»åˆ—ï¼ˆäº”ï¼‰ï¼šFlutter å¸¸ç”¨æŒ‰é’® Widget</a></td></tr><tr><td>16</td><td><a href="https://juejin.cn/post/7136721313225244680">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—ï¼šRxJava æ ¸å¿ƒè§£å¯†</a></td></tr><tr><td>17</td><td><a href="https://juejin.cn/post/7135827895993237541">Flutter ç³»åˆ—ï¼ˆå››ï¼‰ï¼šFlutter å¸¸ç”¨ Widget äºŒ</a></td></tr><tr><td>18</td><td><a href="https://juejin.cn/post/7135365943282122765">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—ï¼šAndroid ä¸­ä½¿ç”¨ Protobuf</a></td></tr><tr><td>19</td><td><a href="https://juejin.cn/post/7134343543975313445">Flutter ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šFlutter ç‰¹ç‚¹åŠå¸¸ç”¨ Widget ä»‹ç»</a></td></tr><tr><td>20</td><td><a href="https://juejin.cn/post/7130647339294785549">Flutter ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šDart è¯­æ³•ç­‘åŸº</a></td></tr><tr><td>21</td><td><a href="https://juejin.cn/post/7057420846863745031">Flutter ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šè¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter åº”ç”¨</a></td></tr></tbody></table><p>å…¶å®ä¹Ÿæœ‰ç”¨å°å·å»å‚åŠ æ˜é‡‘çš„æ›´æ–‡æ´»åŠ¨ï¼Œè€Œä¸”è¾“å‡ºé¢‘ç‡å¾ˆé«˜ï¼Œä½†æ˜¯è´¨é‡ç›¸å¯¹æ¥è¯´å·®ä¸€ç‚¹ï¼Œæ‰€æœ‰çš„æ–‡ç« æˆ‘éƒ½ä¼šæ”¾åˆ°æˆ‘çš„<a href="https://sweetying520.github.io/">ä¸ªäººåšå®¢ç½‘ç«™</a>ä¸­ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹ä¸€çœ‹ã€‚</p><h2 id="ä¸€å®¶å°é˜³äººï¼Œä¸€èµ·åº·å¤å•¦"><a href="#ä¸€å®¶å°é˜³äººï¼Œä¸€èµ·åº·å¤å•¦" class="headerlink" title="ä¸€å®¶å°é˜³äººï¼Œä¸€èµ·åº·å¤å•¦"></a>ä¸€å®¶å°é˜³äººï¼Œä¸€èµ·åº·å¤å•¦</h2><p>è®°å½•â¼€ä¸‹â¾ƒâ¼°å˜é˜³åˆ°é˜³åº·çš„è¿‡ç¨‹ï¼Œå†æ—¶ 7 å¤©ï¼š12.19-12.25</p><p>ç¬¬â¼€å¤©ï¼šåˆšä»è¡¡é˜³å¼€è½¦å›æ·±åœ³ï¼Œå‘ç°å–‰å’™ç—›å—“å­ç—’ï¼Œæ™šä¸Šæ´—äº†ä¸ªæ¾¡ï¼Œå¼€å§‹ä¸å¯¹åŠ²å‘çƒ§ï¼Œåƒäº†å¸ƒæ´›èŠ¬ç¼“é‡Šèƒ¶å›Šç¡è§‰ï¼Œæ­¤æ—¶ç‰¹åˆ«æ€•å†·ï¼Œå¤šç›–ç‚¹è¢«â¼¦æ„Ÿè§‰å°±å¥½äº›äº†ã€‚</p><p>ç¬¬â¼†å¤©ï¼šæ—©ä¸Šçƒ§é€€äº†ï¼Œæ˜¨æ™šçš„è¯æ•ˆè¿˜åœ¨å‘æŒ¥ä½œâ½¤ã€‚ä¸çŸ¥é“ä¸èƒ½æ´—æ¾¡ï¼Œèˆ’èˆ’æœæœåˆæ´—äº†ä¸ªæ¾¡ï¼Œç»“æœä¸­åˆç›´æ¥çƒ§åˆ° 39.5 åº¦ï¼Œç´§æ¥ç€å¤´ç—›æ¬²è£‚ï¼Œåƒäº†ç¾æ—å¸ƒæ´›èŠ¬æ··æ‚¬æ¶²ï¼Œç¡äº†â¼€è§‰ï¼Œå‡ºäº†ä¸€èº«å¤§æ±—ï¼Œçƒ§ç»ˆäºé€€ä¸‹æ¥äº†ï¼Œå¤´è¿˜æ˜¯å¾ˆç—›å¾ˆç—›ã€‚æ™šä¸Šåˆçƒ§èµ·æ¥äº†ï¼Œåƒäº†å¸ƒæ´›èŠ¬ç¼“é‡Šèƒ¶å›Šç¡è§‰ã€‚</p><p>ç¬¬ä¸‰å¤©ï¼šçƒ§å½»åº•é€€äº†ï¼Œå¤´ç—›ç—‡çŠ¶ä¹Ÿå¼€å§‹å‡å¼±äº†ï¼Œç»“æœå’³å—½æ¥äº†ï¼Œè¿™ä¸ªæœŸé—´å–æ¢¨â½”ï¼Œæ©˜â¼¦â½”ï¼Œç½—æ±‰æœèŒ¶ï¼Œæ…¢æ…¢çš„å–ï¼Œè®©ç”œâ½”æµ¸æ¶¦ä½ çš„å–‰å’™ï¼Œå¤šå¸è’¸æ±½ï¼Œå¿«å’³å—½çš„æ—¶å€™â½¤â¼¿æ‚ä½å˜´å·´åšåå’½çš„åŠ¨ä½œï¼Œè¿™äº›åšæ³•èƒ½æœ‰æ•ˆçš„ä¿æŠ¤ä½ çš„å–‰å’™ã€‚</p><p>ç¬¬å››å¤©ï¼šå¤´ç—›æ„Ÿè§‰æ²¡æœ‰äº†ï¼Œé™¤äº†å’³å—½ï¼Œè¿˜ä¼šæµâ¿æ¶•</p><p>ç¬¬äº”å¤©ï¼šå’³å—½åŠ é‡ï¼Œæµâ¿æ¶•ï¼Œå—…è§‰å’Œå‘³è§‰æ˜æ˜¾å‡å¼±</p><p>ç¬¬å…­å¤©ï¼šè¿˜æ˜¯åœ¨æ–­æ–­ç»­ç»­åœ°å’³å—½ï¼Œæµâ¿æ¶•ä¸­</p><p>ç¬¬ä¸ƒå¤©ï¼šå’³å—½å‡å¼±ï¼Œä¸æµâ¿æ¶•äº†ï¼Œå—…è§‰å’Œå‘³è§‰æ­£åœ¨æ¢å¤ä¸­ï¼Œæ ¸é…¸é˜´æ€§ã€‚</p><p>çŸ­çŸ­ä¸€å‘¨ï¼Œä¸€å®¶äººéƒ½é˜³äº†ï¼Œè€å®¶çš„æ·±åœ³çš„éƒ½é˜³äº†ï¼Œå°ç°ç°æ˜¯ä¸ªæ— ç—‡çŠ¶çš„é˜³ï¼Œæœ¬ä»¥ä¸ºé ä»–äº†å‘¢ã€‚é˜³äº†å¯¹è€äººçš„å½±å“è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæˆ‘ä¸ˆæ¯å¨˜å’³å—½è¿˜åœ¨åŠ é‡ï¼Œå¤´ç–¼æŒç»­çš„æ—¶é—´ä¹Ÿæ¯”æˆ‘ä»¬ä¹…ã€‚å¸Œæœ›æ¥å¹´æ˜¥æš–èŠ±å¼€ï¼Œæˆ‘ä»¬ä¸€å®¶äººå¤šå»æˆ·å¤–é”»ç‚¼èº«ä½“ï¼Œä»æºå¤´ä¸Šå¼ºèº«å¥ä½“ï¼Œç¥å¤§å®¶éƒ½å¹³å®‰å¥åº·ï¼Œ ç™¾äº‹æ— å¿§ï¼</p><h2 id="ä¸‡å®¶ç¯ç«ï¼Œä¸€ç›å½’å¤„"><a href="#ä¸‡å®¶ç¯ç«ï¼Œä¸€ç›å½’å¤„" class="headerlink" title="ä¸‡å®¶ç¯ç«ï¼Œä¸€ç›å½’å¤„"></a>ä¸‡å®¶ç¯ç«ï¼Œä¸€ç›å½’å¤„</h2><p>2020 å¹´ 12 â½‰ä¹°çš„æœŸæˆ¿ï¼Œå¼€å‘å•†é€šçŸ¥ 2022 å¹´ 12 â½‰ 31 â½‡æ­£å¼æ”¶æˆ¿ï¼Œä¹°æœŸæˆ¿çœŸçš„æ˜¯â¼¼ç´¯ï¼ŒæœŸé—´ç»è¿‡äº†6ï¼Œ7æ¬¡ç»´æƒï¼ŒçœŸçš„å°±æ˜¯å’Œå¼€å‘å•†åœ¨â½ƒæ™ºâ½ƒå‹‡ï¼Œå…¶ä¸­çš„â¼¼é…¸åªæœ‰ç»å†è¿‡çš„â¼ˆæ‰çŸ¥é“ã€‚æ‰€ä»¥å»ºè®®â¼¤å®¶ä¹°æˆ¿â¼€å®šè¦ä¹°ç°æˆ¿æˆ–â¼†â¼¿æˆ¿ã€‚</p><p>å†ç»ä¸¤å¹´ï¼Œç»ˆäºåœ¨ç ä¸‰â»†æœ‰ä¸ªå±äºâ¾ƒâ¼°çš„å®¶äº†ã€‚ä¸‡å®¶ç¯ç«ç»ˆæœ‰ä¸€ç›ï¼Œåªä¸ºæˆ‘è€Œäº®ï¼Œä¸è®ºå¤šæ™šï¼Œç¯äº®ç€çš„åœ°æ–¹æ€»æœ‰äººåœ¨ç­‰æˆ‘ï¼Œä¹Ÿæ€»æœ‰ä¸€æ‰‡é—¨ä¸ºæˆ‘è€Œç•™ï¼Œå¾€åä½™ç”Ÿè¶ŠåŠªåŠ›è¶Šå¹¸è¿ï¼Œçæƒœå½“ä¸‹ï¼Œå®ˆæŠ¤å¥½é‚£ç›ä¸ºè‡ªå·±é—ªé—ªè€Œäº®çš„æ˜ç¯ï¼</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89faff2a4ff9413fa39761706d0fbea6~tplv-k3u1fbpfcp-watermark.image" alt="image-20221229193028832.png"></p><h2 id="ç¼…æ€€çˆ·çˆ·å¥¶å¥¶"><a href="#ç¼…æ€€çˆ·çˆ·å¥¶å¥¶" class="headerlink" title="ç¼…æ€€çˆ·çˆ·å¥¶å¥¶"></a>ç¼…æ€€çˆ·çˆ·å¥¶å¥¶</h2><p>çˆ·çˆ·å¥¶å¥¶åœ¨æˆ‘å°çš„æ—¶å€™å¸¦è¿‡æˆ‘ï¼Œå¯¹äºä»–ä»¬æˆ‘æœ‰ä¸€ç§å¾ˆæ·±çš„æƒ…æ„Ÿï¼Œçœ‹ç€ä»–ä»¬æ…ˆç¥¥çš„è„¸åºï¼Œå›å¿†è¿‡å¾€ï¼Œç¬é—´å“­æˆä¸€ä¸ªæ³ªäººã€‚è®°å¾—å°æ—¶å€™ï¼Œçˆ·çˆ·å¥¶å¥¶èº«ä½“éƒ½è¿˜å¥½ï¼Œçˆ·çˆ·æ¯å¤©æ—©ä¸Šä¼šå¾ˆæ—©èµ·åºŠå»åœ°é‡Œæ‘˜èœç„¶åå»è¡—ä¸Šå–ï¼Œæ¯æ¬¡å›æ¥éƒ½ä¼šç»™æˆ‘ä¹°ç‚¹å¥½åƒçš„ä¸œè¥¿ï¼Œæˆ‘æ¯æ¬¡éƒ½åƒçš„ç‰¹åˆ«å¼€å¿ƒã€‚å¥¶å¥¶åˆ™åœ¨å®¶é‡Œç…®é¥­ï¼Œåƒå®Œé¥­å°±å¸¦æˆ‘å»æ‘é‡Œé¢é€›ä¸€é€›ï¼Œç§ä¸€ç§ï¼Œéå¸¸çš„æƒ¬æ„ã€‚å°çš„æ—¶å€™å› ä¸ºè°ƒçš®æ£è›‹ï¼Œä¼šæ•´å‡ºå¾ˆå¤šç³Ÿç³•çš„äº‹æƒ…å‡ºæ¥ï¼Œä½†æ˜¯çˆ·çˆ·å¥¶å¥¶ä»æ¥éƒ½ä¸ä¼šæ‰“æˆ‘ï¼Œéª‚æˆ‘ï¼Œä»–ä»¬æ˜¯å¦‚æ­¤çš„çˆ±æˆ‘ã€‚æ—¥å­å°±è¿™æ ·ä¸€å¤©ä¸€å¤©çš„è¿‡ç€ï¼Œæˆ‘å¾ˆå¼€å¿ƒã€‚å¾…æˆ‘é•¿å¤§åï¼Œä»–ä»¬ä¹Ÿå˜è€äº†ï¼Œæ— è®ºæ˜¯ä¹‹å‰ä¸Šå¤§å­¦ï¼Œè¿˜æ˜¯ç°åœ¨å·¥ä½œäº†ï¼Œæ¯æ¬¡å›å®¶æˆ‘éƒ½ä¼šè¿«ä¸åŠå¾…çš„å»çœ‹ä»–ä»¬ï¼Œå’Œä»–ä»¬èŠå¤©ï¼Œå› ä¸ºçœŸçš„ä¸çŸ¥é“å“ªå¤©ä»–ä»¬å°±è¦ç¦»å¼€äº†ï¼Œè€Œå¦‚ä»Šï¼Œå¥¶å¥¶å»å¹´èµ°äº†ï¼Œçˆ·çˆ·æ˜¨å¤©èµ°äº†ï¼Œå¯¹äºæˆ‘æ¥è¯´ï¼Œå†…å¿ƒéå¸¸ç—›è‹¦ï¼Œæˆ‘ä¸æ„¿ä½ ä»¬ç¦»å¼€ï¼Œä½†è½¬å¿µä¸€æƒ³ï¼Œåˆ°äº†æ‚¨äºŒè€çš„é«˜é¾„ï¼Œå„¿å­™æ»¡å ‚ï¼Œèµ°äº†ä¹Ÿä¸€å®šæ²¡æœ‰ä»»ä½•ç‰µæŒ‚äº†å§ã€‚æ„¿ä½ ä»¬åœ¨å¤©å ‚æ²¡æœ‰ç—…ç—›å’Œç–¾è‹¦ï¼Œæ²¡æœ‰çƒ¦å¿§ï¼Œæ‚¨ä¸€è·¯èµ°å¥½ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40ee218def4f421cbecbaa37cefdc3af~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="2023-æˆ‘ä»¬éƒ½æ›´è¦æœ‰åŠ›é‡"><a href="#2023-æˆ‘ä»¬éƒ½æ›´è¦æœ‰åŠ›é‡" class="headerlink" title="2023 æˆ‘ä»¬éƒ½æ›´è¦æœ‰åŠ›é‡"></a>2023 æˆ‘ä»¬éƒ½æ›´è¦æœ‰åŠ›é‡</h2><p>2023 å¹´å¯ä»¥å‡ºå»åƒå–ç©ä¹äº†ï¼Œä¹Ÿè¦ä¸ºè‡ªå·±çš„æ–°å®¶ç½®åŠä¸€äº›è½¯è£…ï¼Œ å½“ç„¶è¿™ä¸€å¹´å°ç°ç°ä¹Ÿè¦å»ä¸Šæ­£å¼çš„å¹¼å„¿å›­äº†ã€‚</p><p>2023 å¹´ï¼Œflag å°±ä¸ç«‹äº†ï¼Œå¿ƒä¸­å·²ç„¶æœ‰äº†è®¡åˆ’ï¼Œçœ‹çœ‹è‡ªå·±çš„æé™åœ¨å“ªé‡Œï¼Œåªæƒ³é€šè¿‡å®é™…è¡ŒåŠ¨å»è¯æ˜ã€‚</p><p>å¾ˆå–œæ¬¢çš„ä¸€å¥è¯ï¼šä»Šå¤©çš„ä½ å¤šå­¦ä¸€æ ·æœ¬äº‹ï¼Œä»¥åçš„ä½ å°±å°‘è¯´ä¸€å¥æ±‚äººçš„è¯ã€‚</p><p>2023 æœŸå¾…æ›´å¥½çš„æˆ‘è‡ªå·±ï¼åœ¨æ–°çš„ä¸€å¹´é‡Œï¼Œè¦æœ‰çˆ±æœ‰å¸Œæœ›ï¼Œæ›´è¦æœ‰åŠ›é‡ï¼ŒæŠ¤å®¶äººä»¬å‘¨å…¨ï¼</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å¾€å¹´å¹´ç»ˆæ€»ç»“"><a href="#å¾€å¹´å¹´ç»ˆæ€»ç»“" class="headerlink" title="å¾€å¹´å¹´ç»ˆæ€»ç»“"></a>å¾€å¹´å¹´ç»ˆæ€»ç»“</h3><p>2021ï¼š<a href="https://juejin.cn/post/7047790727987724302">ã€å¹´åº¦å›é¡¾ã€‘ä¸ºè¿‡å»çš„å‡ å¹´å–å½©</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>å¹´ç»ˆæ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>App é»‘ç™½åŒ–æŠ€æœ¯å®è·µä¸‹ç¯‡</title>
    <link href="/2022/12/09/App%20%E9%BB%91%E7%99%BD%E5%8C%96%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8B%E7%AF%87/"/>
    <url>/2022/12/09/App%20%E9%BB%91%E7%99%BD%E5%8C%96%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8B%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e55fa56181124b82b4b58ff6815cf745~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨<a href="https://juejin.cn/post/7174768835927965733">App é»‘ç™½åŒ–æŠ€æœ¯å®è·µä¸Šç¯‡</a>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€App é»‘ç™½åŒ–å®ç°åŸç†ï¼šå°† Paint çš„é¥±å’Œåº¦è®¾ç½®ä¸º 0ï¼Œç„¶åè¿›è¡Œ View çš„ç»˜åˆ¶</p><p>2ã€App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå®è·µï¼š</p><blockquote><p>1ã€å¯¹é¡µé¢çš„ DecorView è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</p><p>2ã€æ›¿æ¢é¡µé¢çš„å†…å®¹æ  FramLaout ä¸ºé»‘ç™½åŒ– FrameLayout</p></blockquote><p>3ã€åˆ†æäº† App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå­˜åœ¨çš„ä¸€äº›é—®é¢˜</p><blockquote><p>1ã€æ–¹æ¡ˆä¸€ï¼šDialogï¼ŒPopupWindow é»‘ç™½åŒ–ä¸ç”Ÿæ•ˆ</p><p>2ã€æ–¹æ¡ˆäºŒï¼šDialog é»‘ç™½åŒ–ç”Ÿæ•ˆï¼ŒPopupWindow é»‘ç™½åŒ–ä¸ç”Ÿæ•ˆ</p></blockquote><p>4ã€ç»™å‡ºäº† App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå‡ºç°é—®é¢˜çš„åŸå› ä»¥åŠæ–°çš„æ€è·¯</p><p>è¿˜æ²¡æœ‰çœ‹è¿‡çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»ä¸€ä¸‹ã€‚</p><p>å›é¡¾ä¸€ä¸‹æˆ‘ä»¬è¯´çš„æ–°æ€è·¯ï¼š</p><p>App ä¸­ Window çš„æ·»åŠ æœ€ç»ˆéƒ½ä¼šèµ°åˆ° WindowManagerGlobal çš„ addView æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//WindowManagerGlobal#addView</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addView</span><span class="hljs-params">(View view, ViewGroup.LayoutParams params,</span><br><span class="hljs-params">        Display display, Window parentWindow)</span> &#123;<br>        <span class="hljs-comment">//...</span><br><span class="hljs-keyword">synchronized</span> (mLock) &#123;<br><br>        <span class="hljs-comment">// å°† view æ·»åŠ åˆ° mViewsï¼ŒmViews æ˜¯ä¸€ä¸ª ArrayList é›†åˆ</span><br>        mViews.add(view);<br>       <br><br>        <span class="hljs-comment">// æœ€åé€šè¿‡ viewRootImpl æ¥æ·»åŠ  window</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            root.setView(view, wparams, panelParentView);<br>        &#125; <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>WindowManagerGlobal æ˜¯ä¸€ä¸ªå…¨å±€å•ä¾‹ï¼Œå…¶ä¸­ mViews æ˜¯ä¸€ä¸ªé›†åˆï¼ŒApp ä¸­æ‰€æœ‰çš„ Window åœ¨æ·»åŠ çš„æ—¶å€™éƒ½ä¼šè¢«å®ƒç»™å­˜èµ·æ¥ã€‚</p><p>é‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Hook æ‹¿åˆ° mViews ä¸­æ‰€æœ‰çš„ View ç„¶åè¿›è¡Œé»‘ç™½åŒ–è®¾ç½®ï¼Œè¿™æ ·ä¸ç®¡æ˜¯ Activityï¼ŒDialogï¼ŒPopupWindow è¿˜æ˜¯å…¶ä»–ä¸€äº› Window ç»„ä»¶ï¼Œéƒ½ä¼šå˜æˆé»‘ç™½åŒ–ã€‚å…·ä½“ä¸€ç‚¹å°±æ˜¯ï¼š</p><blockquote><p>1ã€Hook WindowManagerGlobal ä¸­çš„ mViews ï¼Œå°†å…¶æ”¹æˆå¯æ„ŸçŸ¥æ•°æ®çš„ ArrayList é›†åˆ</p><p>2ã€ç›‘å¬ mViews çš„ add æ“ä½œï¼Œç„¶åå¯¹ View è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</p></blockquote><p>åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦æ˜ç™½ï¼š</p><blockquote><p>1ã€ä»€ä¹ˆæ˜¯ Hookï¼Ÿ</p><p>2ã€æ€ä¹ˆè¿›è¡Œ Hookï¼Ÿ</p></blockquote><p>æ‰èƒ½å®Œæˆä¸Šè¿°æ“ä½œ</p><h2 id="ä¸€ã€Hook-ä»‹ç»"><a href="#ä¸€ã€Hook-ä»‹ç»" class="headerlink" title="ä¸€ã€Hook ä»‹ç»"></a>ä¸€ã€Hook ä»‹ç»</h2><h3 id="1-1ã€ä»€ä¹ˆæ˜¯-Hookï¼Ÿ"><a href="#1-1ã€ä»€ä¹ˆæ˜¯-Hookï¼Ÿ" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯ Hookï¼Ÿ"></a>1.1ã€ä»€ä¹ˆæ˜¯ Hookï¼Ÿ</h3><p>ç®€å•ç†è§£ï¼š<strong>Hook å°±æ˜¯ä½¿ç”¨ä»£ç†å¯¹è±¡å¯¹åŸå§‹å¯¹è±¡è¿›è¡ŒåŠ«æŒï¼Œæ’å…¥ä¸€æ®µæˆ‘ä»¬è‡ªå·±çš„é€»è¾‘ï¼Œå®ç°å·æ¢æ¢æŸ±</strong></p><p>æ­£å¸¸è°ƒç”¨ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/339acb0bbac3470faed0fd5a1f3e49de~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221210162609850.png" width="50%" /><p>Hook è°ƒç”¨ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e2d4eb88cb6417eb8862a075fde4ed5~tplv-k3u1fbpfcp-watermark.image" alt="image-20221210162658307.png"></p><h3 id="1-2ã€æ€ä¹ˆè¿›è¡Œ-Hookï¼Ÿ"><a href="#1-2ã€æ€ä¹ˆè¿›è¡Œ-Hookï¼Ÿ" class="headerlink" title="1.2ã€æ€ä¹ˆè¿›è¡Œ Hookï¼Ÿ"></a>1.2ã€æ€ä¹ˆè¿›è¡Œ Hookï¼Ÿ</h3><p>Hook é€šå¸¸æ˜¯æœ‰å›ºå®šå¥—è·¯çš„ï¼š</p><blockquote><p>1ã€ç¡®è®¤ Hook ç‚¹ï¼ˆè¢«åŠ«æŒçš„åŸå§‹å¯¹è±¡æˆ‘ä»¬ç§°ä¹‹ä¸º Hook ç‚¹ï¼‰</p><p>2ã€å®šä¹‰ä»£ç†ç±»</p><p>3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢ Hook ç‚¹</p></blockquote><p>è¯´èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œä¸‹é¢æˆ‘å°±æ‰‹æŠŠæ‰‹å¸¦é¢†å¤§å®¶è¿›è¡Œ Hook å®è·µã€‚</p><h3 id="1-3ã€Hook-å®è·µ"><a href="#1-3ã€Hook-å®è·µ" class="headerlink" title="1.3ã€Hook å®è·µ"></a>1.3ã€Hook å®è·µ</h3><p>å¦‚ä¸‹ä¾‹å­ï¼š</p><p>MainActivity ä¸­ï¼Œæˆ‘ä»¬ç»™ btnHook è®¾ç½®äº†ç‚¹å‡»äº‹ä»¶å¹¶è¿›è¡Œäº† Log æ‰“å°ï¼Œç°åœ¨è¦æ±‚åœ¨ä¸æ”¹åŠ¨è¿™ä¸ªç‚¹å‡»äº‹ä»¶çš„æƒ…å†µä¸‹ï¼Œå¼¹å‡º Toast å¹¶æ˜¾ç¤ºï¼šerdai666ã€‚</p><p>å¦‚ä½•åšåˆ°ï¼Ÿ</p><p>æˆ‘ä»¬æ˜¯ä¸æ˜¯å°±è¦å¯¹<code>btnHook.setOnClickListener</code>çš„ç‚¹å‡»äº‹ä»¶ï¼ˆOnClickListenerï¼‰è¿›è¡Œ Hook</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span>: <span class="hljs-type">BaseActivity</span>() &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> btnHook <span class="hljs-keyword">by</span> lazy &#123;<br>        findViewById&lt;Button&gt;(R.id.btnHook)<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>        <span class="hljs-keyword">return</span> R.layout.activity_main<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> &#123;<br>        btnHook.setOnClickListener&#123;<br>            Log.d(<span class="hljs-string">&quot;MainActivity&quot;</span>, <span class="hljs-string">&quot;Hello&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§ä¸Šé¢çš„å›ºå®šå¥—è·¯ï¼š</p><h4 id="1-3-1ã€ç¡®è®¤-Hook-ç‚¹"><a href="#1-3-1ã€ç¡®è®¤-Hook-ç‚¹" class="headerlink" title="1.3.1ã€ç¡®è®¤ Hook ç‚¹"></a>1.3.1ã€ç¡®è®¤ Hook ç‚¹</h4><p>è·Ÿä¸€ä¸‹<code>btnHook.setOnClickListener</code>çš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€btnHook.setOnClickListener =&gt; View#setOnClickListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOnClickListener</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> OnClickListener l)</span> &#123;<br>    <span class="hljs-keyword">if</span> (!isClickable()) &#123;<br>        setClickable(<span class="hljs-literal">true</span>);<br>    &#125;<br>    getListenerInfo().mOnClickListener = l;<br>&#125;<br><br><span class="hljs-comment">//2ã€getListenerInfo().mOnClickListener =&gt; ListenerInfo#mOnClickListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">View</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Drawable</span>.Callback,... &#123;<br>  <span class="hljs-comment">//...</span><br>  <br>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ListenerInfo</span> &#123;<br>      <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">public</span> OnClickListener mOnClickListener;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>1ã€å½“æˆ‘ä»¬è¿›å…¥<code>btnHook.setOnClickListener</code> ï¼Œå‘ç° OnClickListener å¯¹è±¡è¢«èµ‹å€¼ç»™äº†<code>getListenerInfo().mOnClickListener</code></p><p>2ã€getListenerInfo() æ˜¯ä¸€ä¸ª ListenerInfo å¯¹è±¡ï¼ŒListenerInfo æ˜¯ View ä¸­çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå®ƒæŒæœ‰äº† OnClickListener å¯¹è±¡</p><p>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ç¡®è®¤ Hook ç‚¹ï¼š<strong>View ä¸­ ListenerInfo ä¸­çš„ OnClickListener å¯¹è±¡</strong></p><h4 id="1-3-2ã€å®šä¹‰ä»£ç†ç±»"><a href="#1-3-2ã€å®šä¹‰ä»£ç†ç±»" class="headerlink" title="1.3.2ã€å®šä¹‰ä»£ç†ç±»"></a>1.3.2ã€å®šä¹‰ä»£ç†ç±»</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyClickListener</span>(<span class="hljs-keyword">var</span> context: Context,<span class="hljs-keyword">var</span> clickListener: View.OnClickListener) <br>: View.OnClickListener &#123;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onClick</span><span class="hljs-params">(v: <span class="hljs-type">View</span>?)</span></span> &#123;<br>        Toast.makeText(context,<span class="hljs-string">&quot;erdai666&quot;</span>,Toast.LENGTH_SHORT).show()<br>        clickListener.onClick(v)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç†ç±»é€»è¾‘å¾ˆç®€å•ï¼šå°±æ˜¯åœ¨ OnClickListener çš„åŸºç¡€ä¸Šæ·»åŠ äº†æˆ‘ä»¬è‡ªå·±çš„ Toast æç¤º</p><p><strong>Tipsï¼š</strong> å¦‚æœ Hook ç‚¹æ˜¯æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JDK çš„åŠ¨æ€ä»£ç†ï¼Œå¦‚æœåŠ¨æ€ä»£ç†ä¸æ¸…æ¥šçš„å¯ä»¥çœ‹æˆ‘è¿™ç¯‡æ–‡ç« ï¼Œè¯¦ç»†ä»‹ç»äº† Java å…­å¤§è®¾è®¡åŸåˆ™å’Œ 24 ç§è®¾è®¡æ¨¡å¼ï¼š<a href="https://juejin.cn/post/7160363585028227086">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—ï¼šJava å…­å¤§è®¾è®¡åŸåˆ™å’Œå¸¸ç”¨è®¾è®¡æ¨¡å¼</a></p><h4 id="1-3-3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢-Hook-ç‚¹"><a href="#1-3-3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢-Hook-ç‚¹" class="headerlink" title="1.3.3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢ Hook ç‚¹"></a>1.3.3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢ Hook ç‚¹</h4><p>æ›¿æ¢è¿‡ç¨‹æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°åå°„ï¼Œå¦‚æœåå°„ä¸æ¸…æ¥šï¼Œå¯ä»¥çœ‹æˆ‘è¿™ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/6977679823132950536">Android APT ç³»åˆ— ï¼ˆä¸€ï¼‰ï¼šAPT ç­‘åŸºä¹‹åå°„</a></p><p>ç†ä¸€ç†æ›¿æ¢çš„æ€è·¯ï¼š</p><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯¹ View ä¸­ ListenerInfo ä¸­çš„ OnClickListener å¯¹è±¡è¿›è¡Œæ›¿æ¢ï¼Œå› æ­¤è¦é€šè¿‡åå°„æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œç»†èŠ‚æ‹†åˆ†ï¼š</p><blockquote><p>1ã€æ‹¿åˆ°å½“å‰ View å¯¹è±¡çš„ ListenerInfo å¯¹è±¡</p><p>2ã€é€šè¿‡ ListenerInfo å¯¹è±¡åœ¨æ‹¿åˆ°  OnClickListener å¯¹è±¡</p></blockquote><p>æ‹¿åˆ°  OnClickListener å¯¹è±¡åï¼Œåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œç„¶åå¯¹å½“å‰  OnClickListener å¯¹è±¡è¿›è¡Œæ›¿æ¢å³å¯</p><p>æ–°å»ºä¸€ä¸ª HookSetOnClickListenerHelper ç±»å¯¹ä¸Šé¢çš„æ€è·¯è¿›è¡Œå®è·µï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> HookSetOnClickListenerHelper &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * contextï¼šä¸Šä¸‹æ–‡</span><br><span class="hljs-comment">     * viewï¼šå½“å‰ view å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hook</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>,view: <span class="hljs-type">View</span>)</span></span>&#123;<br>        <span class="hljs-comment">//ä¸€ã€æ‹¿åˆ°å½“å‰ View å¯¹è±¡çš„ ListenerInfo å¯¹è±¡</span><br>        <span class="hljs-keyword">val</span> getListenerInfoMethod = View::<span class="hljs-keyword">class</span>.java.getDeclaredMethod(<span class="hljs-string">&quot;getListenerInfo&quot;</span>)<br>        <span class="hljs-comment">//ç ´åå°è£…ï¼Œè®©æˆ‘ä»¬èƒ½è®¿é—® private ä¿®é¥°çš„æˆå‘˜</span><br>        getListenerInfoMethod.isAccessible = <span class="hljs-literal">true</span><br>        <span class="hljs-keyword">val</span> listenerInfo = getListenerInfoMethod.invoke(view)<br><br>        <span class="hljs-comment">//äºŒã€é€šè¿‡ ListenerInfo å¯¹è±¡åœ¨æ‹¿åˆ° OnClickListener å¯¹è±¡</span><br>        <span class="hljs-comment">//android.view.View$ListenerInfo è¿™ç§æ˜¯å†…éƒ¨ç±»çš„å†™æ³•</span><br>        <span class="hljs-keyword">val</span> mOnClickListenerFiled = Class.forName(<span class="hljs-string">&quot;android.view.View\$ListenerInfo&quot;</span>).getDeclaredField(<span class="hljs-string">&quot;mOnClickListener&quot;</span>)<br>        <span class="hljs-keyword">val</span> mOnClickListener = mOnClickListenerFiled.<span class="hljs-keyword">get</span>(listenerInfo) <span class="hljs-keyword">as</span> View.OnClickListener<br><br>        <span class="hljs-comment">//ä¸‰ã€åˆ›å»ºä»£ç†å¯¹è±¡</span><br>        <span class="hljs-comment">//1ã€æ³•ä¸€</span><br>        <span class="hljs-keyword">val</span> proxyClickListener = ProxyClickListener(context,mOnClickListener)<br><br>        <span class="hljs-comment">//2ã€æ³•äºŒï¼šå› ä¸º OnClickListener æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†</span><br><span class="hljs-comment">//        val proxyClickListener = Proxy.newProxyInstance(</span><br><span class="hljs-comment">//            context.classLoader,</span><br><span class="hljs-comment">//            arrayOf(View.OnClickListener::class.java)</span><br><span class="hljs-comment">//        ) &#123; proxy, method, args -&gt;</span><br><span class="hljs-comment">//            Toast.makeText(context, &quot;erdai666&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="hljs-comment">//            method?.invoke(mOnClickListener, *args)</span><br><span class="hljs-comment">//        &#125;</span><br>        <br><br>        <span class="hljs-comment">//å››ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢åŸå§‹å¯¹è±¡</span><br>        mOnClickListenerFiled.<span class="hljs-keyword">set</span>(listenerInfo,proxyClickListener)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>okï¼Œæ¥ä¸‹æ¥ä¿®æ”¹ MainActivityï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span>: <span class="hljs-type">BaseActivity</span>() &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> btnHook <span class="hljs-keyword">by</span> lazy &#123;<br>        findViewById&lt;Button&gt;(R.id.btnHook)<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>        <span class="hljs-keyword">return</span> R.layout.activity_main<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> &#123;<br>        btnHook.setOnClickListener&#123;<br>            Log.d(<span class="hljs-string">&quot;MainActivity&quot;</span>, <span class="hljs-string">&quot;Hello&quot;</span>)<br>        &#125;<br>      <span class="hljs-comment">//Hook</span><br>        HookSetOnClickListenerHelper.hook(<span class="hljs-keyword">this</span>,btnHook)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œ Appï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c484ff858a854e899070c64db3ab9aa1~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221210182733451.png" width="30%" /><p>äº†è§£äº† Hookï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°± Hook WindowManagerGlobal ä¸­çš„ mViews å®ç° App é»‘ç™½åŒ–</p><h2 id="äºŒã€Hook-WindowManagerGlobal-ä¸­-mViews-å®ç°-App-é»‘ç™½åŒ–"><a href="#äºŒã€Hook-WindowManagerGlobal-ä¸­-mViews-å®ç°-App-é»‘ç™½åŒ–" class="headerlink" title="äºŒã€Hook WindowManagerGlobal ä¸­ mViews å®ç° App é»‘ç™½åŒ–"></a>äºŒã€Hook WindowManagerGlobal ä¸­ mViews å®ç° App é»‘ç™½åŒ–</h2><p>æˆ‘ä»¬çš„æ€è·¯å¾ˆæ˜ç¡®ï¼š</p><p>1ã€Hook WindowManagerGlobal ä¸­çš„ mViews ï¼Œå°†å…¶æ”¹æˆå¯æ„ŸçŸ¥æ•°æ®çš„ ArrayList é›†åˆ</p><p>2ã€ç›‘å¬ mViews çš„ add æ“ä½œï¼Œç„¶åå¯¹ View è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</p><p>ä»£ç å®ç°ï¼Œå†™äº†è¯¦ç»†çš„æ³¨é‡Šï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€æ–°å»º mViews å¯¹è±¡çš„ä»£ç†ç±»ï¼šå¯æ„ŸçŸ¥æ•°æ®çš„ ArrayList é›†åˆ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableArrayList</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> onListAddListener: OnListAddListener&lt;T&gt;?) :<br>    ArrayList&lt;T&gt;() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(element: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">val</span> isAdd = <span class="hljs-keyword">super</span>.add(element)<br>        onListAddListener?.add(<span class="hljs-keyword">this</span>, size - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> isAdd<br>    &#125;<br><br>    <span class="hljs-comment">//ç›‘å¬å™¨ï¼šç›‘å¬ ArrayList add æ“ä½œ</span><br>    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OnListAddListener</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(list: <span class="hljs-type">ArrayList</span>&lt;<span class="hljs-type">T</span>&gt;, index: <span class="hljs-type">Int</span>)</span></span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æ–°å»ºä¸€ä¸ª GlobalGray ç¼–å†™ Hook é€»è¾‘</span><br><span class="hljs-keyword">object</span> GlobalGray &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hook</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//ä¸€ã€è·å– WindowManagerGlobal å¯¹è±¡</span><br>        <span class="hljs-keyword">val</span> windowManagerGlobalClass = Class.forName(<span class="hljs-string">&quot;android.view.WindowManagerGlobal&quot;</span>)<br>        <span class="hljs-keyword">val</span> getInstanceStaticMethod = windowManagerGlobalClass.getDeclaredMethod(<span class="hljs-string">&quot;getInstance&quot;</span>)<br>        <span class="hljs-keyword">val</span> windowManagerGlobal = getInstanceStaticMethod.invoke(windowManagerGlobalClass)<br><br>        <span class="hljs-comment">//äºŒã€è·å– WindowManagerGlobal ä¸­çš„ mViews</span><br>        <span class="hljs-keyword">val</span> mViewsField = windowManagerGlobalClass.getDeclaredField(<span class="hljs-string">&quot;mViews&quot;</span>)<br>        mViewsField.isAccessible = <span class="hljs-literal">true</span><br>        <span class="hljs-keyword">val</span> mViews = mViewsField.<span class="hljs-keyword">get</span>(windowManagerGlobal) <span class="hljs-keyword">as</span> ArrayList&lt;View&gt;<br><br>        <span class="hljs-comment">//ä¸‰ã€åˆ›å»ºä»£ç†ç±»å¯¹è±¡</span><br>        <span class="hljs-comment">//åˆ›å»ºé¥±å’Œåº¦ä¸º 0 çš„ç”»ç¬”</span><br>        <span class="hljs-keyword">val</span> paint = Paint()<br>        <span class="hljs-keyword">val</span> cm = ColorMatrix()<br>        cm.setSaturation(<span class="hljs-number">0f</span>)<br>        paint.colorFilter = ColorMatrixColorFilter(cm)<br><br>        <span class="hljs-keyword">val</span> proxyArrayList = ObservableArrayList(<span class="hljs-keyword">object</span> : ObservableArrayList.OnListAddListener&lt;Any&gt;&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(list: <span class="hljs-type">ArrayList</span>&lt;<span class="hljs-type">Any</span>&gt;, index: <span class="hljs-type">Int</span>)</span></span> &#123;<br>                <span class="hljs-keyword">val</span> view = list[index] <span class="hljs-keyword">as</span> View<br>                view.setLayerType(View.LAYER_TYPE_HARDWARE,paint)<br>            &#125;<br>        &#125;)<br>        <span class="hljs-comment">//å°†åŸæœ‰çš„æ•°æ®æ·»åŠ åˆ°ä»£ç† ArrayList</span><br>        proxyArrayList.addAll(mViews)<br><br>        <span class="hljs-comment">//å››ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢åŸå§‹å¯¹è±¡</span><br>        mViewsField.<span class="hljs-keyword">set</span>(windowManagerGlobal,proxyArrayList)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Hook é€»è¾‘å†™å¥½äº†ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼Œåœ¨ Applicaton é‡Œé¢æ·»åŠ  Hook çš„é€»è¾‘ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span>: <span class="hljs-type">Application</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate()<br>      <span class="hljs-comment">//Hook å…¨å±€ App é»‘ç™½åŒ–</span><br>        GlobalGray.hook()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œ App ï¼Œæ•ˆæœéªŒè¯ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6553c3c2766c42c0bb2545b9f15340a7~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><h3 id="2-1ã€å…³äºè§†é¢‘"><a href="#2-1ã€å…³äºè§†é¢‘" class="headerlink" title="2.1ã€å…³äºè§†é¢‘"></a>2.1ã€å…³äºè§†é¢‘</h3><p>æˆ‘ä»¬è¿™ç§æ–¹æ¡ˆåªæ˜¯é’ˆå¯¹ WindowManagerGlobal addView è¿‡ç¨‹ä¸­çš„æ‰€æœ‰ View å®ç°é»‘ç™½åŒ–ï¼Œå¦‚æœä¸æ˜¯è¿™ä¸ªèŒƒç•´çš„åˆ™å®ç°ä¸äº†ï¼Œä¾‹å¦‚ï¼šSurfaceView</p><p>1ã€å¯¹äºæ™®é€šçš„ Viewï¼ŒAndroid ä¸­çš„çª—å£ç•Œé¢åŒ…æ‹¬å¤šä¸ª View ç»„æˆçš„ View Hierachy çš„æ ‘å½¢ç»“æ„ï¼Œåªæœ‰æœ€é¡¶å±‚çš„ DecorViewæ‰å¯¹ WMS å¯è§ï¼Œè¿™ä¸ª DecorView åœ¨ WMS ä¸­æœ‰ä¸€ä¸ªå¯¹åº”çš„ WindowStateï¼Œæ­¤æ—¶ APP è¯·æ±‚åˆ›å»º Surface æ—¶ï¼Œä¼šåœ¨SurfaceFlinger å†…éƒ¨å»ºç«‹å¯¹åº”çš„ Layerã€‚</p><p>2ã€è€Œå¯¹äº SurfaceView å®ƒè‡ªå¸¦ä¸€ä¸ªSurfaceï¼Œè¿™ä¸ª Surface åœ¨ WMS æœ‰è‡ªå·±å¯¹åº”çš„ WindowStateï¼Œåœ¨ SurfaceFlinger ä¸­æœ‰è‡ªå·±å¯¹åº”çš„ Layerã€‚</p><p>3ã€SurfaceView ä» App ç«¯çœ‹å®ƒä»ç„¶åœ¨ View hierachy ç»“æ„ä¸­ï¼Œä½†åœ¨ WMS å’Œ SurfaceFlinger ä¸­å®ƒä¸å®¿ä¸»çª—å£æ˜¯åˆ†ç¦»çš„ã€‚å› æ­¤ SurfaceView çš„ Surface çš„æ¸²æŸ“å¯ä»¥æ”¾åˆ°å•ç‹¬çº¿ç¨‹å»åšï¼Œä¸ä¼šå½±å“ä¸»çº¿ç¨‹å¯¹äº‹ä»¶çš„å“åº”ã€‚</p><p>å› æ­¤å¦‚æœä½ è§†é¢‘æ’­æ”¾ä½¿ç”¨çš„æ˜¯ SurfaceView ï¼Œåˆ™è¿™ç§æ–¹æ¡ˆå®ç°ä¸äº†é»‘ç™½åŒ–ï¼Œä½ éœ€è¦é’ˆå¯¹ SurfaceView å•ç‹¬å»å¤„ç†.</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Android é«˜çº§å¿…å¤‡ Hook ï¼Œå¹¶å¸¦é¢†å¤§å®¶æ‰‹æŠŠæ‰‹å¯¹ Hook è¿›è¡Œäº†å®è·µ</p><p>2ã€Hook æ˜¯æœ‰å›ºå®šå¥—è·¯çš„ï¼š</p><blockquote><p>1ã€ç¡®è®¤ Hook ç‚¹</p><p>2ã€å®šä¹‰ä»£ç†ç±»</p><p>3ã€ä½¿ç”¨ä»£ç†å¯¹è±¡æ›¿æ¢ Hook ç‚¹</p></blockquote><p>æŒæ¡è¿™ä¸ªå¥—è·¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆè½»æ¾çš„å»è¿›è¡Œ Hook</p><p>3ã€é€šè¿‡ Hook WindowManagerGlobal çš„ mViews å®ç° App å…¨å±€é»‘ç™½åŒ–</p><p>4ã€å¦‚æœä½ è§†é¢‘æ’­æ”¾ä½¿ç”¨çš„æ˜¯ SurfaceView ï¼Œåˆ™è¿™ç§æ–¹æ¡ˆå®ç°ä¸äº†é»‘ç™½åŒ–ï¼Œä½ éœ€è¦é’ˆå¯¹ SurfaceView å•ç‹¬å»å¤„ç†</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>App é»‘ç™½åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>App é»‘ç™½åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>App é»‘ç™½åŒ–æŠ€æœ¯å®è·µä¸Šç¯‡</title>
    <link href="/2022/12/07/App%20%E9%BB%91%E7%99%BD%E5%8C%96%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8A%E7%AF%87/"/>
    <url>/2022/12/07/App%20%E9%BB%91%E7%99%BD%E5%8C%96%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8A%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78fec5e6d1154086a883470523dce9fa~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æœ€è¿‘æ‰“å¼€å„å¤§ App ä¼šå‘ç°å®ƒä»¬éƒ½åšäº†é»‘ç™½åŒ–ï¼Œå¦‚ä¸‹æ”¯ä»˜å®çš„å¤„ç†ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81c8308c347543289ea45535b707e27f~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221207144305534.png" width="50%" /><p>å¯ä»¥çœ‹åˆ°åº”ç”¨è®¾ç½®äº†å…¨å±€ç°è‰²è°ƒï¼Œè¡¨è¾¾äº†ä¸€ç§å¯¹é€è€…çš„å“€æ‚¼ï¼Œéå¸¸çš„åº”æ™¯å’Œäººæ€§åŒ–ã€‚ä½œä¸ºç¨‹åºçŒ¿ï¼Œæˆ‘ä»¬æ¥æ¢ç´¢ä¸€ä¸‹å®ƒä»æŠ€æœ¯è§’åº¦æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p><h2 id="ä¸€ã€App-é»‘ç™½åŒ–å®ç°åŸç†"><a href="#ä¸€ã€App-é»‘ç™½åŒ–å®ç°åŸç†" class="headerlink" title="ä¸€ã€App é»‘ç™½åŒ–å®ç°åŸç†"></a>ä¸€ã€App é»‘ç™½åŒ–å®ç°åŸç†</h2><h3 id="1-1ã€ä¿®æ”¹-Canvas-çš„-Paint-å®ç°é»‘ç™½åŒ–"><a href="#1-1ã€ä¿®æ”¹-Canvas-çš„-Paint-å®ç°é»‘ç™½åŒ–" class="headerlink" title="1.1ã€ä¿®æ”¹ Canvas çš„ Paint å®ç°é»‘ç™½åŒ–"></a>1.1ã€ä¿®æ”¹ Canvas çš„ Paint å®ç°é»‘ç™½åŒ–</h3><p>é¦–å…ˆæˆ‘ä»¬åº”è¯¥çŸ¥é“ Android ä¸­èƒ½å®ç°é»‘ç™½åŒ–çš„æ‰‹æ®µï¼š</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒApp é¡µé¢ä¸Šçš„ View éƒ½æ˜¯é€šè¿‡ Canvas + Paint ç”»å‡ºæ¥çš„ã€‚Canvas å¯¹åº”ç”»å¸ƒï¼ŒPaint å¯¹åº”ç”»ç¬”ï¼Œä¸¤è€…ç»“åˆï¼Œå°±èƒ½ç”»å‡º Viewã€‚</p><p>å°±å¥½æ¯”ç”»å®¶ç”»ç”»ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cb1bd20317ff41e6b22d193c0a669ced~tplv-k3u1fbpfcp-watermark.image?" alt="ba58-ipmxpvz0314432.jpeg" width="50%" /><p>ç”»ä¸€å¹…ç”»ä»–éœ€è¦æœ‰ç”»å¸ƒå’Œç”»ç¬”ï¼Œé€šè¿‡ä¸åŒé¢œè‰²çš„ç”»ç¬”ç»“åˆï¼Œå°±ç”»å‡ºäº†ä¸€å¹…æƒŸå¦™æƒŸè‚–çš„ç”»ã€‚</p><p>åˆ°è¿™é‡Œä½ æ˜¯å¦å—åˆ°äº†ä¸€ç‚¹å¯å‘ï¼šåœ¨ Canvas ä¸Šç»˜åˆ¶ View çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¢ä¸€æ”¯è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paintï¼ˆç”»ç¬”ï¼‰ï¼Œæ˜¯å¦å°±èƒ½ç”»å‡ºé»‘ç™½åŒ–çš„ View å‘¢ï¼Ÿ</p><p>æ„Ÿè§‰å¯è¡Œï¼Œæ‰¾ä¸€ä¸‹ Paint ç›¸å…³çš„ Api ï¼Œå‘ç°å¯ä»¥å¯¹ Paint è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æ–°å»ºä¸€æ”¯ç”»ç¬”</span><br><span class="hljs-keyword">val</span> paint = Paint()<br><span class="hljs-comment">//é€šè¿‡ ColorMatrix å°†é¥±å’Œåº¦è®¾ç½®ä¸º 0</span><br><span class="hljs-keyword">val</span> cm = ColorMatrix()<br>cm.setSaturation(<span class="hljs-number">0f</span>)<br><span class="hljs-comment">//å°†ç”»ç¬”çš„è‰²å½©é¥±å’Œåº¦è®¾ç½®ä¸º 0</span><br>paint.colorFilter = ColorMatrixColorFilter(cm)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬å°±æ–°å»ºäº†ä¸€æ”¯è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paintï¼Œæ¥ä¸‹æ¥ä½¿ç”¨å®ƒå»è¿›è¡Œ View çš„ç»˜åˆ¶ï¼Œå°±èƒ½è¾¾åˆ°é»‘ç™½åŒ–çš„æ•ˆæœã€‚</p><p>æˆ‘ä»¬è¿›è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼š</p><p>1ã€è‡ªå®šä¹‰é»‘ç™½åŒ– TextView å’Œ Buttonï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€è‡ªå®šä¹‰é»‘ç™½åŒ– TextView</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GrayTextView</span>(context: Context, attrs: AttributeSet): TextView(context,attrs) &#123;<br><br>    <span class="hljs-comment">//è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paint</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> paint <span class="hljs-keyword">by</span> lazy &#123;<br>        <span class="hljs-keyword">val</span> p = Paint()<br>        <span class="hljs-keyword">val</span> cm = ColorMatrix()<br>        cm.setSaturation(<span class="hljs-number">0f</span>)<br>        p.colorFilter = ColorMatrixColorFilter(cm)<br>        p<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">draw</span><span class="hljs-params">(canvas: <span class="hljs-type">Canvas</span>?)</span></span> &#123;<br>        canvas?.saveLayer(<span class="hljs-literal">null</span>,paint, Canvas.ALL_SAVE_FLAG)<br>        <span class="hljs-keyword">super</span>.draw(canvas)<br>        canvas?.restore()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€è‡ªå®šä¹‰é»‘ç™½åŒ– button</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GrayButton</span>(context: Context, attrs: AttributeSet): Button(context,attrs) &#123;<br><br>    <span class="hljs-comment">//è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paint</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> paint <span class="hljs-keyword">by</span> lazy &#123;<br>        <span class="hljs-keyword">val</span> p = Paint()<br>        <span class="hljs-keyword">val</span> cm = ColorMatrix()<br>        cm.setSaturation(<span class="hljs-number">0f</span>)<br>        p.colorFilter = ColorMatrixColorFilter(cm)<br>        p<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">draw</span><span class="hljs-params">(canvas: <span class="hljs-type">Canvas</span>?)</span></span> &#123;<br>        canvas?.saveLayer(<span class="hljs-literal">null</span>,paint, Canvas.ALL_SAVE_FLAG)<br>        <span class="hljs-keyword">super</span>.draw(canvas)<br>        canvas?.restore()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹ activity.main.xml çš„å¸ƒå±€ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">&quot;center_horizontal&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;vertical&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:padding</span>=<span class="hljs-string">&quot;20dp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">tools:context</span>=<span class="hljs-string">&quot;.MainActivity&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;30sp&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">com.dream.appblackandwhite.blackandwhitewidget.GrayTextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;30sp&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span> /&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">com.dream.appblackandwhite.blackandwhitewidget.GrayButton</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¸ƒå±€å¾ˆç®€å•ï¼Œå°±æ˜¯å’Œæœªé»‘ç™½åŒ–çš„ TextView å’Œ Button åšå¯¹æ¯”</p><p>3ã€è¿è¡Œ app ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79fb115d036a413fbb258cea7372390b~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221207172921306.png" width="50%" /><p>è¿™æ˜¯ç¬¬ä¸€ç§å®ç°é»‘ç™½åŒ–çš„æ–¹å¼ï¼Œæ¥ä¸‹æ¥ä»‹ç»å¦å¤–ä¸€ç§ã€‚</p><h3 id="1-2ã€ç»™-View-è®¾ç½®-Paint-å®ç°é»‘ç™½åŒ–"><a href="#1-2ã€ç»™-View-è®¾ç½®-Paint-å®ç°é»‘ç™½åŒ–" class="headerlink" title="1.2ã€ç»™ View è®¾ç½® Paint å®ç°é»‘ç™½åŒ–"></a>1.2ã€ç»™ View è®¾ç½® Paint å®ç°é»‘ç™½åŒ–</h3><p>View æœ‰ä¸ªå¦‚ä¸‹ Api ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c374b8cf0bb4451c940a1b9167b9d3d3~tplv-k3u1fbpfcp-watermark.image" alt="image-20221207173755012.png"></p><p>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥å¼€å¯<a href="https://link.juejin.cn/?target=https://developer.android.com/guide/topics/graphics/hardware-accel?hl=zh-cn%23layers">ç¦»å±ç¼“å†²</a>çš„ï¼Œå…¶æ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚</p><p>ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ª Int ç±»å‹çš„å€¼ï¼Œå…¶æœ‰ä¸‰ç§æƒ…å†µï¼š</p><blockquote><p>1ã€LAYER_TYPE_NONEï¼šè§†å›¾æ­£å¸¸æ¸²æŸ“ï¼Œä¸å—å±å¹•å¤–ç¼“å†²åŒºæ”¯æŒã€‚è¿™æ˜¯é»˜è®¤è¡Œä¸ºã€‚</p><p>2ã€LAYER_TYPE_HARDWAREï¼šå¦‚æœåº”ç”¨ç»è¿‡ç¡¬ä»¶åŠ é€Ÿï¼Œè§†å›¾åœ¨ç¡¬ä»¶ä¸­æ¸²æŸ“ä¸ºç¡¬ä»¶çº¹ç†ã€‚å¦‚æœåº”ç”¨æœªç»è¿‡ç¡¬ä»¶åŠ é€Ÿï¼Œæ­¤å±‚ç±»å‹çš„è¡Œä¸ºæ–¹å¼ä¸ LAYER_TYPE_SOFTWARE ç›¸åŒã€‚</p><p>3ã€LAYER_TYPE_SOFTWAREï¼šä½¿ç”¨è½¯ä»¶æ¥æ¸²æŸ“è§†å›¾ï¼Œç»˜åˆ¶åˆ° Bitmapï¼Œå¹¶é¡ºä¾¿å…³é—­ç¡¬ä»¶åŠ é€Ÿ ã€‚</p></blockquote><p>ç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ª Paintï¼Œä¹Ÿå°±æ˜¯ç”»ç¬”ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹ç”»ç¬”åšé…ç½®ï¼Œä»è€Œè¾¾åˆ°é»‘ç™½åŒ–çš„æ•ˆæœã€‚</p><p>æœ‰äº†æ€è·¯ï¼Œæˆ‘ä»¬å…ˆåšä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼š</p><p>1ã€ä¿®æ”¹ activity.main.xml çš„å¸ƒå±€ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">&quot;center_horizontal&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">&quot;vertical&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:padding</span>=<span class="hljs-string">&quot;20dp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">tools:context</span>=<span class="hljs-string">&quot;.MainActivity&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;30sp&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/tvBlackAndWhite&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;30sp&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/btnBlackAndWhite&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span> /&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;erdai666&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å¸ƒå±€å¾ˆç®€å•ï¼Œå°±æ˜¯ç»™è¦é»‘ç™½åŒ–çš„ TextView ï¼ŒButton åŠ äº†ä¸€ä¸ª idï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨ Activity é‡Œé¢æ“ä½œ</p><p>2ã€ä¿®æ”¹ MainActivityï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span>: <span class="hljs-type">AppCompatActivity</span>() <span class="hljs-comment">/*: BaseActivity()*/</span> &#123;<br><br>    <span class="hljs-comment">//è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paint</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> paint <span class="hljs-keyword">by</span> lazy &#123;<br>        <span class="hljs-keyword">val</span> p = Paint()<br>        <span class="hljs-keyword">val</span> cm = ColorMatrix()<br>        cm.setSaturation(<span class="hljs-number">0f</span>)<br>        p.colorFilter = ColorMatrixColorFilter(cm)<br>        p<br>    &#125;<br><br>    <span class="hljs-comment">//é»‘ç™½åŒ– TextView</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> tvBlackAndWhite <span class="hljs-keyword">by</span> lazy &#123;<br>        findViewById&lt;TextView&gt;(R.id.tvBlackAndWhite)<br>    &#125;<br><br>    <span class="hljs-comment">//é»‘ç™½åŒ– Button</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> btnBlackAndWhite <span class="hljs-keyword">by</span> lazy &#123;<br>        findViewById&lt;Button&gt;(R.id.btnBlackAndWhite)<br>    &#125;<br><br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>      <span class="hljs-comment">//ç»™ View è®¾ç½®è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paint å®ç°é»‘ç™½åŒ–</span><br>        tvBlackAndWhite.setLayerType(View.LAYER_TYPE_HARDWARE,paint)<br>        btnBlackAndWhite.setLayerType(View.LAYER_TYPE_HARDWARE,paint)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€è¿è¡Œ app ï¼Œæ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39e96428328845d89f9cf2e4b9365bf4~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" width="50%" /><p>äº†è§£äº† App é»‘ç™½åŒ–çš„åŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å®ç° App çœŸæ­£çš„é»‘ç™½åŒ–</p><h2 id="äºŒã€App-é»‘ç™½åŒ–æ–¹æ¡ˆå®è·µ"><a href="#äºŒã€App-é»‘ç™½åŒ–æ–¹æ¡ˆå®è·µ" class="headerlink" title="äºŒã€App é»‘ç™½åŒ–æ–¹æ¡ˆå®è·µ"></a>äºŒã€App é»‘ç™½åŒ–æ–¹æ¡ˆå®è·µ</h2><p>ä¸Šè¿°æˆ‘ä»¬éƒ½æ˜¯å¯¹å•ä¸ª View è¿›è¡Œé»‘ç™½åŒ–å¤„ç†ï¼Œé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œè®©æ•´ä¸ªé¡µé¢éƒ½å˜æˆé»‘ç™½åŒ–çš„å‘¢ï¼Ÿ</p><p>ç­”ï¼šæœ‰çš„ï¼Œ<strong>æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å½“å‰ View æ ‘ä¸€ä¸ªåˆé€‚çš„çˆ¶ Viewï¼Œå¯¹ä»–è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®æˆ–è€…æ›¿æ¢ä¸ºè‡ªå®šä¹‰é»‘ç™½åŒ– Viewï¼Œå› ä¸ºçˆ¶ View çš„ Canvas å’Œ Paint æ˜¯å¾€ä¸‹åˆ†å‘çš„ï¼Œæ‰€ä»¥å®ƒæ‰€åŒ…å«çš„å­ View éƒ½ä¼šé»‘ç™½åŒ–å¤„ç†</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®ç° App é»‘ç™½åŒ–</p><p>ä½†æ˜¯æˆ‘æœ‰ä¸€äº›ç–‘é—®ï¼šå“ªä¸ªçˆ¶ View æ˜¯æœ€åˆé€‚çš„å‘¢ï¼Ÿå…·ä½“å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>å¸¦ç€ä¸Šé¢çš„ç–‘é—®ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f487accdff54e4bb68fa09f6206e37e~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="" width="30%" /><p>æ¯ä¸ªé¡µé¢ä¸­æœ‰ä¸€ä¸ªé¡¶çº§ View å« DecorViewï¼ŒDecorView ä¸­åŒ…å«ä¸€ä¸ªç«–ç›´æ–¹å‘çš„ LinearLayoutï¼ŒLinearLayout ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æ ‡é¢˜æ ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å†…å®¹æ ï¼Œå†…å®¹æ æ˜¯ä¸€ä¸ª FrameLayoutï¼Œæˆ‘ä»¬åœ¨ Activity ä¸­è°ƒç”¨ setContentView å°±æ˜¯å°† View æ·»åŠ åˆ°è¿™ä¸ª FrameLayout ä¸­ã€‚</p><p>äº†è§£äº†ä¸Šé¢çš„å†…å®¹ï¼Œä½ å¿ƒä¸­æ˜¯å¦æœ‰äº†å®ç°æ–¹æ¡ˆäº†å‘¢ï¼Ÿ</p><p>1ã€æ˜¯ä¸æ˜¯å¯ä»¥æ‹¿åˆ°é¡µé¢å¯¹åº”çš„ DecorView ï¼Œå¯¹å…¶è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</p><p>2ã€æ˜¯ä¸æ˜¯å¯ä»¥æŠŠå†…å®¹æ ï¼ˆFrameLayoutï¼‰æ›¿æ¢ä¸ºè‡ªå®šä¹‰çš„ FrameLayoutï¼ˆé»‘ç™½åŒ–çš„ FrameLayoutï¼‰</p><p>ä¸Šè¿°ä¸¤ç§æ–¹æ¡ˆéƒ½æ˜¯å¯è¡Œçš„</p><h3 id="2-1ã€æ–¹æ¡ˆä¸€ï¼šå¯¹-DecorView-è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®"><a href="#2-1ã€æ–¹æ¡ˆä¸€ï¼šå¯¹-DecorView-è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®" class="headerlink" title="2.1ã€æ–¹æ¡ˆä¸€ï¼šå¯¹ DecorView è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®"></a>2.1ã€æ–¹æ¡ˆä¸€ï¼šå¯¹ DecorView è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</h3><p>æƒ³è¦æ‹¿åˆ°ä¸€ä¸ªé¡µé¢çš„ DecorView æœ‰å¾ˆå¤šæ–¹å¼ï¼Œä¸»è¦ä»‹ç»ä¸¤ç§ï¼š</p><p>1ã€ç›´æ¥åœ¨ Activity ä¸­é€šè¿‡ Window è·å– DecorView</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">window.decorView.setLayerType(View.LAYER_TYPE_HARDWARE,paint)<br></code></pre></td></tr></table></figure><p><strong>Tipsï¼š</strong> å»ºè®®åˆ›å»ºä¸€ä¸ª Activity çš„åŸºç±» BaseActivityï¼Œåœ¨ BaseActivity é‡Œé¢å¤„ç†ï¼Œè¿™æ ·æ‰€æœ‰ç»§æ‰¿ BaseActivity çš„éƒ½ä¼šç”Ÿæ•ˆ</p><p>é‚£ä¸‡ä¸€æˆ‘æœ‰äº› Activity æ²¡æœ‰ç»§æ‰¿å‘¢ï¼Ÿé‚£ä½ æ¥ç€å¾€ä¸‹çœ‹ğŸ˜‚</p><p>2ã€åœ¨ Application ä¸­æ³¨å†Œ registerActivityLifecycleCallbacks å›è°ƒï¼Œå›è°ƒä¸­é€šè¿‡ activity å®ä¾‹åŒæ ·å¯ä»¥æ‹¿åˆ° DecorView</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">registerActivityLifecycleCallbacks(<span class="hljs-keyword">object</span> : ActivityLifecycleCallbacks &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>                <span class="hljs-keyword">val</span> decorView = activity.window.decorView<br>                decorView.setLayerType(View.LAYER_TYPE_HARDWARE, paint)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityStarted</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityResumed</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityPaused</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityStopped</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivitySaveInstanceState</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>, outState: <span class="hljs-type">Bundle</span>)</span></span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityDestroyed</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> &#123;<br>            &#125;<br>        &#125;)<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼æ‰€æœ‰çš„ Activity éƒ½ä¼šç”Ÿæ•ˆã€‚</p><p>çœ‹ä¸€çœ¼æ•ˆæœï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7ac491ddca174531a71656f77081ce50~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208105821732.png" width="50%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªé¡µé¢éƒ½é»‘ç™½åŒ–äº†ã€‚</p><p>å¤§å®¶å¯ä»¥æ€è€ƒä¸€ä¸‹è¿™ç§æ–¹æ¡ˆæœ‰ä»€ä¹ˆä¸è¶³ä¹‹å¤„ï¼Ÿåé¢åœ¨è®²</p><h3 id="2-2ã€æ–¹æ¡ˆäºŒï¼šæ›¿æ¢å†…å®¹æ -FrameLayout-ä¸ºé»‘ç™½åŒ–-FrameLayout"><a href="#2-2ã€æ–¹æ¡ˆäºŒï¼šæ›¿æ¢å†…å®¹æ -FrameLayout-ä¸ºé»‘ç™½åŒ–-FrameLayout" class="headerlink" title="2.2ã€æ–¹æ¡ˆäºŒï¼šæ›¿æ¢å†…å®¹æ  FrameLayout ä¸ºé»‘ç™½åŒ– FrameLayout"></a>2.2ã€æ–¹æ¡ˆäºŒï¼šæ›¿æ¢å†…å®¹æ  FrameLayout ä¸ºé»‘ç™½åŒ– FrameLayout</h3><p>æ€ä¹ˆæ›¿æ¢ï¼Ÿ</p><p>è¿™ä¸ªä½ å°±éœ€è¦å¯¹ LayoutInflater çš„ inflate è¿‡ç¨‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¦‚ä¸‹æ–¹æ³•æˆªå›¾ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ab6c980dde14b1895147617732a3c55~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208112810720.png" width="100%" /><p>å¯ä»¥çœ‹åˆ°ï¼ŒLayoutInflater åœ¨åˆ›å»º View çš„è¿‡ç¨‹ä¸­ï¼š</p><p>1ã€ä¼˜å…ˆä½¿ç”¨ mFactory2 å»åˆ›å»º View ï¼Œå¦‚æœ mFactory2 ä¸ºç©ºåˆ™ä½¿ç”¨ mFactoryï¼ŒmFactory ä¸ºç©ºæ‰ä¼šä½¿ç”¨ mPrivateFactory</p><p>2ã€Activity ä¸­ï¼Œç³»ç»Ÿç»™æˆ‘ä»¬è®¾ç½®äº† mFactory2ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c371301646be4006ab761ccd795cbf88~tplv-k3u1fbpfcp-watermark.image" alt="image-20221208115031789.png"></p><p>å®é™…æµç¨‹è·Ÿä¸‹å»æœ€ç»ˆå°±æ˜¯æƒ³åšå¦‚ä¸‹å¤„ç†ï¼š</p><p>å°†ä¸€äº›ç³»ç»Ÿçš„ View æ›¿æ¢ä¸ºï¼šandroidx.appcompat.widget ä¸‹çš„ Viewï¼Œå¦‚ï¼šTextView -&gt; AppCompatTextView ï¼ŒImageView -&gt; AppCompatImageViewã€‚</p><p>3ã€Activity å¯ä»¥å¤å†™ onCreateView æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å…¶å®ä¹Ÿæ˜¯ LayoutFactory åœ¨æ„å»º View çš„æ—¶å€™å›è°ƒå‡ºæ¥çš„ï¼Œä¸€èˆ¬å¯¹åº”å…¶å†…éƒ¨çš„ mPrivateFactoryã€‚</p><p>4ã€ç›®å‰ç³»ç»Ÿå¯¹äº FrameLayout å¹¶æ²¡æœ‰ç‰¹æ®Šå¤„ç†ï¼ŒActivity å¯ä»¥å¤å†™ onCreateView æ–¹æ³•ï¼Œç„¶åå°†å†…å®¹æ  FrameLayout æ›¿æ¢ä¸ºé»‘ç™½åŒ– FrameLayout å³å¯ã€‚</p><p>äº†è§£äº†æ›¿æ¢æ€è·¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®è·µä¸€ä¸‹ã€‚</p><p>1ã€åˆ›å»º BaseActivity ï¼Œå°†æ›¿æ¢é€»è¾‘å†™åœ¨åŸºç±»é‡Œé¢ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseActivity</span>: <span class="hljs-type">AppCompatActivity</span>() &#123;<br>  <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(getLayoutId())<br>        initView()<br>    &#125;<br><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span><br><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span><br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">        parent: <span class="hljs-type">View</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        name: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        context: <span class="hljs-type">Context</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        attrs: <span class="hljs-type">AttributeSet</span></span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>: View? &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>          <span class="hljs-comment">//tag name ä¸º FrameLayout</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;FrameLayout&quot;</span> == name) &#123;<br>                <span class="hljs-keyword">val</span> attributeCount = attrs.attributeCount<br>                <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until attributeCount) &#123;<br>                  <span class="hljs-comment">//å±æ€§åç§°</span><br>                    <span class="hljs-keyword">val</span> attributeName = attrs.getAttributeName(i)<br>                  <span class="hljs-comment">//å±æ€§å€¼</span><br>                    <span class="hljs-keyword">val</span> attributeValue = attrs.getAttributeValue(i)<br>                  <span class="hljs-comment">//å±æ€§åç§°ä¸ºï¼šid</span><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;id&quot;</span> == attributeName) &#123;<br>                      <span class="hljs-comment">//@16908290 =&gt; 16908290</span><br>                        <span class="hljs-keyword">val</span> resId = Integer.parseInt(attributeValue.substring(<span class="hljs-number">1</span>))<br>                      <span class="hljs-comment">//è·å–èµ„æºåç§°ï¼šandroid:id/content</span><br>                        <span class="hljs-keyword">val</span> idValue = resources.getResourceName(resId)<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;android:id/content&quot;</span> == idValue) &#123;<br>                          <span class="hljs-comment">//å¦‚æœæ˜¯ DecorView çš„ FrameLayoutï¼Œæ›¿æ¢ä¸º GrayFrameLayout</span><br>                            <span class="hljs-keyword">val</span> grayFrameLayout = GrayFrameLayout(context, attrs)<br>                            <span class="hljs-keyword">return</span> grayFrameLayout<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onCreateView(parent, name, context, attrs)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨çœ‹ä¸€çœ¼ GrayFrameLayoutï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GrayFrameLayout</span>(context: Context, attrs: AttributeSet): FrameLayout(context,attrs) &#123;<br><br>    <span class="hljs-comment">//è‰²å½©é¥±å’Œåº¦ä¸º 0 çš„ Paint</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> paint <span class="hljs-keyword">by</span> lazy &#123;<br>        <span class="hljs-keyword">val</span> p = Paint()<br>        <span class="hljs-keyword">val</span> cm = ColorMatrix()<br>        cm.setSaturation(<span class="hljs-number">0f</span>)<br>        p.colorFilter = ColorMatrixColorFilter(cm)<br>        p<br>    &#125;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">draw</span><span class="hljs-params">(canvas: <span class="hljs-type">Canvas</span>?)</span></span> &#123;<br>        canvas?.saveLayer(<span class="hljs-literal">null</span>,paint,Canvas.ALL_SAVE_FLAG)<br>        <span class="hljs-keyword">super</span>.draw(canvas)<br>        canvas?.restore()<br>    &#125;<br>  <br>  <span class="hljs-comment">//åˆ†å‘ç»™å­ View</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dispatchDraw</span><span class="hljs-params">(canvas: <span class="hljs-type">Canvas</span>?)</span></span> &#123;<br>        canvas?.saveLayer(<span class="hljs-literal">null</span>,paint,Canvas.ALL_SAVE_FLAG)<br>        <span class="hljs-keyword">super</span>.dispatchDraw(canvas)<br>        canvas?.restore()<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹ä¸€ä¸‹ MainActivity</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span>: <span class="hljs-type">BaseActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>        <span class="hljs-keyword">return</span> R.layout.activity_main<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æœ€åè¿è¡Œ App ï¼Œçœ‹ä¸€çœ¼æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98cd92b6c72a42f2a2ccdd1984ba2516~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208153942930.png" width="50%" /><p>çŠ¶æ€æ é¢œè‰²æ²¡å˜ï¼ŒğŸ¤”ï¼Œæ‰‹åŠ¨è®¾ç½®çŠ¶æ€æ é¢œè‰²å’Œæ ‡é¢˜æ é¢œè‰²ä¿æŒä¸€è‡´</p><p>å¸å–æ ‡é¢˜æ é¢œè‰²å€¼ï¼š#4A4A4A ï¼Œåœ¨ BaseActivity é‡Œé¢è®¾ç½®ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseActivity</span>: <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>      <span class="hljs-comment">//5.0åŠä»¥ä¸Šæ‰èƒ½è®¾ç½®çŠ¶æ€æ é¢œè‰²</span><br>        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;<br>            window.statusBarColor = Color.parseColor(<span class="hljs-string">&quot;#4A4A4A&quot;</span>)<br>        &#125;<br>        setContentView(getLayoutId())<br>        initView()<br>    &#125;<br>  <br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œ Appï¼Œåœ¨çœ‹ä¸€çœ¼æ•ˆæœï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bb20ee47ca94447c9ca81e1324ff38c3~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208154638094.png" width="50%" /><p>okï¼Œç°åœ¨æ•´ä¸ªé¡µé¢éƒ½é»‘ç™½åŒ–äº†ï¼ŒğŸºã€‚</p><h2 id="ä¸‰ã€é—®é¢˜"><a href="#ä¸‰ã€é—®é¢˜" class="headerlink" title="ä¸‰ã€é—®é¢˜"></a>ä¸‰ã€é—®é¢˜</h2><h3 id="3-1ã€æ–¹æ¡ˆä¸€é—®é¢˜"><a href="#3-1ã€æ–¹æ¡ˆä¸€é—®é¢˜" class="headerlink" title="3.1ã€æ–¹æ¡ˆä¸€é—®é¢˜"></a>3.1ã€æ–¹æ¡ˆä¸€é—®é¢˜</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æ–¹æ¡ˆä¸€å­˜åœ¨çš„ä¸è¶³ä¹‹å¤„ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ª Button æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œè®©å®ƒå¼¹å‡ºä¸€ä¸ª Dialogï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€activity_main.xmlï¼Œç»™ç¬¬ä¸€ä¸ª Button å¢åŠ ç‚¹å‡»äº‹ä»¶</span><br>&lt;Button<br>   android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>   android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>   android:onClick=<span class="hljs-string">&quot;btnClick&quot;</span><br>   android:text=<span class="hljs-string">&quot;erdai666&quot;</span><br>   android:textColor=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span> /&gt;<br><br><span class="hljs-comment">//2ã€MainActivity</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">btnClick</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> &#123;<br>    AlertDialog.Builder(<span class="hljs-keyword">this</span>)<br>        .setTitle(<span class="hljs-string">&quot;æ ‡é¢˜&quot;</span>)<br>        .setMessage(<span class="hljs-string">&quot;owejfioweofwe&quot;</span>)<br>        .setPositiveButton(<span class="hljs-string">&quot;ç¡®å®š&quot;</span>)&#123;dialog,which-&gt;<br>            dialog.dismiss()<br>         &#125;<br>         .setNegativeButton(<span class="hljs-string">&quot;å–æ¶ˆ&quot;</span>)&#123;dialog,which-&gt;<br>             dialog.dismiss()<br>         &#125;<br>         .show()<br>    &#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d20f56447bad4c4a86e7b706bdcf4a4a~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208160228303.png" width="50%" /><p>Dialog å¹¶æœªé»‘ç™½åŒ–ï¼Œä¸ºå•¥å‘¢ï¼Ÿå…ˆè®°ç€</p><h3 id="3-2ã€æ–¹æ¡ˆäºŒé—®é¢˜"><a href="#3-2ã€æ–¹æ¡ˆäºŒé—®é¢˜" class="headerlink" title="3.2ã€æ–¹æ¡ˆäºŒé—®é¢˜"></a>3.2ã€æ–¹æ¡ˆäºŒé—®é¢˜</h3><p>æŠŠä¸Šè¿°ä»£ç æ”¾åœ¨æ–¹æ¡ˆäºŒè·‘ä¸€éï¼Œä½ ä¼šå‘ç° Dialog é»‘ç™½åŒ–äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e83222ba41d240e8bab9ac4274280407~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208160958646.png" width="50%" /><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ¢æˆ PopupWindowï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€activity_main.xmlï¼Œç»™ç¬¬äºŒä¸ª Button å¢åŠ ç‚¹å‡»äº‹ä»¶</span><br>&lt;Button<br> android:id=<span class="hljs-string">&quot;@+id/btnBlackAndWhite&quot;</span><br>   android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>   android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>   android:onClick=<span class="hljs-string">&quot;btnClick1&quot;</span><br>   android:text=<span class="hljs-string">&quot;erdai666&quot;</span><br>   android:textColor=<span class="hljs-string">&quot;@android:color/holo_green_light&quot;</span> /&gt;<br><br><span class="hljs-comment">//2ã€popup_window_view.xml</span><br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;FrameLayout xmlns:android=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span><br>    android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span>&gt;<br><br>    &lt;LinearLayout<br>        android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:background=<span class="hljs-string">&quot;@color/color_E62117&quot;</span><br>        android:orientation=<span class="hljs-string">&quot;vertical&quot;</span>&gt;<br><br>        &lt;TextView<br>            android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>            android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>            android:gravity=<span class="hljs-string">&quot;center&quot;</span><br>            android:padding=<span class="hljs-string">&quot;10dp&quot;</span><br>            android:text=<span class="hljs-string">&quot;function1&quot;</span><br>            android:textColor=<span class="hljs-string">&quot;@color/white&quot;</span><br>            android:textSize=<span class="hljs-string">&quot;20sp&quot;</span> /&gt;<br><br>        &lt;View<br>            android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>            android:layout_height=<span class="hljs-string">&quot;0.5dp&quot;</span><br>            android:background=<span class="hljs-string">&quot;@color/white&quot;</span> /&gt;<br><br>        &lt;TextView<br>            android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>            android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>            android:gravity=<span class="hljs-string">&quot;center&quot;</span><br>            android:padding=<span class="hljs-string">&quot;10dp&quot;</span><br>            android:text=<span class="hljs-string">&quot;function2&quot;</span><br>            android:textColor=<span class="hljs-string">&quot;@color/white&quot;</span><br>            android:textSize=<span class="hljs-string">&quot;20sp&quot;</span> /&gt;<br><br>    &lt;/LinearLayout&gt;<br>&lt;/FrameLayout&gt;<br><br><span class="hljs-comment">//3ã€MainActivity</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">btnClick1</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> &#123;<br>  <span class="hljs-keyword">val</span> contentView = layoutInflater.inflate(R.layout.popup_window_view,<span class="hljs-literal">null</span>)<br>    <span class="hljs-keyword">val</span> popupWindow = PopupWindow(<br>        contentView,<br>        ViewGroup.LayoutParams.WRAP_CONTENT,<br>        ViewGroup.LayoutParams.WRAP_CONTENT,<br>        <span class="hljs-literal">true</span><br>    )<br>    popupWindow.isOutsideTouchable = <span class="hljs-literal">true</span><br>    popupWindow.isTouchable = <span class="hljs-literal">true</span><br>    popupWindow.setBackgroundDrawable(ColorDrawable())<br>    popupWindow.showAsDropDown(view)<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5a06188fc1be4f03a8197a6832c0c1a8~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208161454907.png" width="50%" /><p>PopupWindow æ²¡æœ‰é»‘ç™½åŒ–ã€‚</p><p>æ¢³ç†ä¸€ä¸‹æ–¹æ¡ˆä¸€å’Œæ–¹æ¡ˆäºŒçš„é—®é¢˜ï¼š</p><p><strong>1ã€æ–¹æ¡ˆä¸€ï¼šDialogï¼ŒPopupWindow éƒ½æœªé»‘ç™½åŒ–</strong></p><p><strong>2ã€æ–¹æ¡ˆäºŒï¼šDialog é»‘ç™½åŒ–ï¼ŒPopupWindow æœªé»‘ç™½åŒ–</strong></p><p>å°æœ‹å‹ï¼Œä½ æ˜¯ä¸æ˜¯æœ‰å¾ˆå¤šé—®å·ï¼Ÿä¸ºå•¥å‘¢ï¼Ÿ</p><p>æƒ³äº†è§£è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—å¯¹ Android çš„ Window æœºåˆ¶ï¼ŒDialog æºç ï¼ŒPopupWindow æºç æœ‰ä¸€å®šçš„äº†è§£ï¼Œæ¨èä¸€ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/6888688477714841608#heading-19">Androidå…¨é¢è§£æä¹‹Windowæœºåˆ¶</a> ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è®²äº†</p><p>æ–¹æ¡ˆä¸€ä¹‹æ‰€ä»¥ Dialogï¼ŒPopupWindow éƒ½æœªé»‘ç™½åŒ–ï¼Œæ˜¯å› ä¸º Activityï¼ŒDialogï¼ŒPopupWindow å®ƒä»¬æ‹¥æœ‰ä¸åŒçš„ DecorView ï¼Œä½ è®¾ç½® Activity çš„ DecorViewï¼Œå½“ç„¶ä¸ä¼šå½±å“ Dialogï¼ŒPopupWindow</p><p>æ–¹æ¡ˆäºŒä¹‹æ‰€ä»¥ Dialog é»‘ç™½åŒ–ï¼ŒPopupWindow æœªé»‘ç™½åŒ–ï¼Œæ˜¯å› ä¸º Dialog å’Œ Activity æ‹¥æœ‰ç›¸åŒçš„ View ç»“æ„ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1738bcec92ad4efc8b8b02a3a9441e69~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221208173238175.png" width="50%" /><p>Dialog åˆ›å»ºäº†æ–°çš„ PhoneWindowï¼Œä½¿ç”¨äº† PhoneWindow çš„ DecorView æ¨¡æ¿ã€‚è€Œ PopupWindow å¹¶æ²¡æœ‰ã€‚</p><p>ä¸¤ç§æ–¹æ¡ˆéƒ½ä¸è¡Œï¼Œé—®é¢˜åˆ°äº†è¿™é‡Œä¼¼ä¹æ— è§£äº†ï¼ŒçœŸçš„æ— è§£äº†å—ï¼Ÿ</p><h3 id="3-2ã€æ–°æ€è·¯"><a href="#3-2ã€æ–°æ€è·¯" class="headerlink" title="3.2ã€æ–°æ€è·¯"></a>3.2ã€æ–°æ€è·¯</h3><p>æƒ³ä¸€ä¸‹ï¼ŒActivityï¼ŒDialogï¼ŒPopupWindow æˆ–å…¶ä»–ä¸€äº› Window ç»„ä»¶å®ƒä»¬æ˜¯ä¸æ˜¯éƒ½è¦è¿›è¡Œ Window çš„æ·»åŠ ï¼Œ Window çš„æ·»åŠ æœ€ç»ˆä¼šèµ°åˆ°å¦‚ä¸‹æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//WindowManagerGlobal#addView</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addView</span><span class="hljs-params">(View view, ViewGroup.LayoutParams params,</span><br><span class="hljs-params">        Display display, Window parentWindow)</span> &#123;<br>        <span class="hljs-comment">//...</span><br><span class="hljs-keyword">synchronized</span> (mLock) &#123;<br><br>        <span class="hljs-comment">// å°† view æ·»åŠ åˆ° mViewsï¼ŒmViews æ˜¯ä¸€ä¸ª ArrayList é›†åˆ</span><br>        mViews.add(view);<br>       <br><br>        <span class="hljs-comment">// æœ€åé€šè¿‡ viewRootImpl æ¥æ·»åŠ  window</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            root.setView(view, wparams, panelParentView);<br>        &#125; <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>Tipsï¼š</strong></p><blockquote><p>Window æ˜¯ View æ ‘çš„è½½ä½“ï¼ŒView æ ‘æ˜¯ Window çš„å…·ä½“è¡¨ç°å½¢å¼ï¼ŒView æ ‘å¯ä»¥æ˜¯ä¸€ä¸ªå•ç‹¬çš„ Viewï¼Œä¹Ÿå¯ä»¥æ˜¯å¾ˆå¤š View ç»„åˆã€‚</p><p>å°±å¥½æ¯”ä¸€ä¸ªç­çº§ï¼Œç­çº§æ˜¯å­¦ç”Ÿçš„è½½ä½“ï¼Œå­¦ç”Ÿæ˜¯ç­çº§çš„å…·ä½“ä½“ç°</p></blockquote><p>WindowManagerGlobal æ˜¯ä¸€ä¸ªå…¨å±€å•ä¾‹ï¼Œå…¶ä¸­ mViews æ˜¯ä¸€ä¸ªé›†åˆï¼ŒApp ä¸­æ‰€æœ‰çš„ Window åœ¨æ·»åŠ çš„æ—¶å€™éƒ½ä¼šè¢«å®ƒç»™å­˜èµ·æ¥ã€‚</p><p>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ Hook æ‹¿åˆ° mViews ä¸­æ‰€æœ‰çš„ View ç„¶åå¯¹ä»–ä»¬è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯æ‰€æœ‰çš„é¡µé¢éƒ½å˜æˆé»‘ç™½åŒ–äº†å‘¢ï¼Ÿ</p><p>é™äºç¯‡å¹…ï¼Œæˆ‘æ‰“ç®—åœ¨å†™ä¸€ç¯‡æ–‡ç« å»å¯¹æ–°æ€è·¯è¿›è¡Œå®è·µï¼Œ</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€App é»‘ç™½åŒ–å®ç°åŸç†ï¼šå°† Paint çš„é¥±å’Œåº¦è®¾ç½®ä¸º 0ï¼Œç„¶åè¿›è¡Œ View çš„ç»˜åˆ¶</p><p>2ã€App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå®è·µï¼š</p><blockquote><p>1ã€å¯¹é¡µé¢çš„ DecorView è¿›è¡Œé»‘ç™½åŒ–è®¾ç½®</p><p>2ã€æ›¿æ¢é¡µé¢çš„å†…å®¹æ  FramLaout ä¸ºé»‘ç™½åŒ– FrameLayout</p></blockquote><p>3ã€åˆ†æäº† App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå­˜åœ¨çš„ä¸€äº›é—®é¢˜</p><blockquote><p>1ã€æ–¹æ¡ˆä¸€ï¼šDialogï¼ŒPopupWindow é»‘ç™½åŒ–ä¸ç”Ÿæ•ˆ</p><p>2ã€æ–¹æ¡ˆäºŒï¼šDialog é»‘ç™½åŒ–ç”Ÿæ•ˆï¼ŒPopupWindow é»‘ç™½åŒ–ä¸ç”Ÿæ•ˆ</p></blockquote><p>4ã€ç»™å‡ºäº† App é»‘ç™½åŒ–ä¸¤ç§æ–¹æ¡ˆå‡ºç°é—®é¢˜çš„åŸå› ä»¥åŠæ–°çš„æ€è·¯</p><p>å…³äºæ–°æ€è·¯å®è·µï¼Œé¢„çŸ¥åäº‹å¦‚ä½•ï¼Œä¸”å¬ä¸‹å›åˆ†è§£ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://blog.csdn.net/lmj623565791/article/details/105319752?spm=1001.2014.3001.5501">App é»‘ç™½åŒ–å®ç°æ¢ç´¢ï¼Œæœ‰ä¸€è¡Œä»£ç å®ç°çš„æ–¹æ¡ˆå—ï¼Ÿ</a></p><p><a href="https://juejin.cn/post/6888688477714841608#comment">Androidå…¨é¢è§£æä¹‹Windowæœºåˆ¶</a></p><p><a href="https://juejin.cn/post/6892277675012915207">Appå…¨å±€ç°åº¦åŒ–å®è·µ-GlobalGray</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>App é»‘ç™½åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>App é»‘ç™½åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android é€†å‘ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šAndroid APKï¼ŒAAB èµ„æºæ··æ·†</title>
    <link href="/2022/12/03/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AAndroid%20APK%EF%BC%8CAAB%20%E8%B5%84%E6%BA%90%E6%B7%B7%E6%B7%86/"/>
    <url>/2022/12/03/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AAndroid%20APK%EF%BC%8CAAB%20%E8%B5%84%E6%BA%90%E6%B7%B7%E6%B7%86/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdec2a9e1e244b4cb7345f9bafc0a5e2~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²äº†ï¼š</p><p>1ã€åç¼–è¯‘å·¥å…· jadx çš„å®‰è£…ä¸ä½¿ç”¨</p><blockquote><p>jadx ç›¸å½“äºæ˜¯ apktool + dex2jar + jd-gui çš„ç»“åˆä½“ï¼Œæ—¢èƒ½åç¼–è¯‘ä»£ç ä¹Ÿèƒ½åç¼–è¯‘èµ„æºï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</p></blockquote><p>2ã€æ··æ·† APK ä»£ç </p><blockquote><p>1ã€å‡†å¤‡äº†ä¸€äº›ç±»ï¼ˆè‡ªå®šä¹‰ç¼–å†™çš„ç±»ï¼Œç¬¬ä¸‰æ–¹åº“çš„ç±»ï¼‰ç”¨äºæ··æ·†åçš„æ•ˆæœéªŒè¯</p><p>2ã€åœ¨ app -&gt; build.gradle -&gt; android é—­åŒ… -&gt; release é—­åŒ…å°† minifyEnabled è®¾ä¸º true å¼€å¯ä»£ç æ··æ·†</p><p>3ã€ä½¿ç”¨ AndroidStudio å¯¼èˆªæ ä¸Š Generate Signed Bundle or APK çš„æ–¹å¼æ‰“ release åŒ…</p><p>4ã€åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­é…ç½®ç­¾åæ–‡ä»¶ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ gradle å‘½ä»¤æˆ– gradle å¯è§†åŒ–ç•Œé¢æ‰“åŒ…</p><p>5ã€é€è¡Œä»‹ç»äº†é»˜è®¤æ··æ·†è§„åˆ™æ–‡ä»¶ proguard-android-optimize.txt ä¸­çš„é…ç½®</p><p>6ã€Proguard ç–‘éš¾è¯­æ³•ä»‹ç»</p><p>7ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™ä¿ç•™ç±»ï¼ˆè‡ªå®šä¹‰ç¼–å†™çš„ç±»ï¼Œç¬¬ä¸‰æ–¹åº“çš„ç±»ï¼‰ä¸è¢«æ··æ·†</p></blockquote><p>è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7168086915445424136">Android é€†å‘ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šAndroid APK ä»£ç æ··æ·†</a> </p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ APKï¼ŒAAB èµ„æºæ··æ·†</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€ä¸‹é¢æ¼”ç¤ºå‡æ˜¯åœ¨ mac ä¸‹è¿›è¡Œ</p><p>2ã€AndroidStudio ç‰ˆæœ¬ï¼šAndroid Studio Dolphin | 2021.3.1 Patch 1</p><p>3ã€AGP ç‰ˆæœ¬ï¼š7.3.1</p><p>4ã€Gradle ç‰ˆæœ¬ï¼š7.4</p><p>Github Demo åœ°å€ï¼š<a href="https://github.com/sweetying520/codeandnotes/tree/master/Reverse/AndroidReverseDemo">https://github.com/sweetying520/codeandnotes/tree/master/Reverse/AndroidReverseDemo</a></p><h2 id="ä¸€ã€APK-èµ„æºæ··æ·†"><a href="#ä¸€ã€APK-èµ„æºæ··æ·†" class="headerlink" title="ä¸€ã€APK èµ„æºæ··æ·†"></a>ä¸€ã€APK èµ„æºæ··æ·†</h2><p>ä¸Šç¯‡æ–‡ç« æˆ‘ä»¬å¯¹ APK çš„ä»£ç è¿›è¡Œäº†æ··æ·†ï¼Œä½†æ˜¯ APK èµ„æºè¿˜æ˜¯æš´éœ²åœ¨ä»–äººé¢å‰ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e0df929225d433b94b18a6f934fd048~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203180325392.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼š<strong>èµ„æºæ–‡ä»¶å¯è¯»æ€§å¾ˆå¼ºï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„å»æ‰¾åˆ°æƒ³è¦çš„èµ„æº</strong></p><p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥å¯¹ APK çš„èµ„æºè¿›è¡Œæ··æ·†ã€‚é‚£è¦å¦‚ä½•æ··æ·†å‘¢ï¼ŸğŸ¤”ï¸</p><p>ç­”ï¼šä½¿ç”¨å¾®ä¿¡å¼€æºçš„ AndResGuard æ¡†æ¶è¿›è¡Œæ··æ·†</p><h3 id="1-1ã€AndResGuard-ä»‹ç»"><a href="#1-1ã€AndResGuard-ä»‹ç»" class="headerlink" title="1.1ã€AndResGuard ä»‹ç»"></a>1.1ã€AndResGuard ä»‹ç»</h3><p>Github åœ°å€ï¼š<a href="https://github.com/shwenzhang/AndResGuard">https://github.com/shwenzhang/AndResGuard</a></p><p>1ï¼‰ã€AndResGuard æ˜¯å¾®ä¿¡å¼€æºçš„ä¸€ä¸ªèµ„æºæ··æ·†æ¡†æ¶ï¼Œå·¥ä½œæ–¹å¼ç±»ä¼¼äºæˆ‘ä»¬å‰é¢æ‰€è®²çš„ APK ä»£ç æ··æ·†ã€‚</p><p>2ï¼‰ã€å®ƒä¼šå¯¹æˆ‘ä»¬çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œä¾‹å¦‚ï¼šactivity_main.xml &#x3D;&gt; a.xmlï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†åˆ«äººçªƒå–ä½ èµ„æºçš„éš¾åº¦ï¼Œå¦ä¸€æ–¹é¢å‡å°äº†åŒ…ä½“ç§¯</p><h3 id="1-2ã€AndResGuard-ä½¿ç”¨"><a href="#1-2ã€AndResGuard-ä½¿ç”¨" class="headerlink" title="1.2ã€AndResGuard ä½¿ç”¨"></a>1.2ã€AndResGuard ä½¿ç”¨</h3><p>1ã€åœ¨é¡¹ç›®çš„æ ¹ build.gradle æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//ä¸€ã€å¦‚æœæ˜¯ AGP 7.0 ä»¥ä¸‹ï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š</span><br>buildscript &#123;<br>    repositories &#123;<br>      <span class="hljs-comment">//æ·»åŠ ä»“åº“åœ°å€ï¼šjcenter åœ¨é˜¿é‡Œäº‘çš„é•œåƒä»“åº“</span><br>        maven &#123;<br>            url <span class="hljs-string">&#x27;https://maven.aliyun.com/repository/jcenter&#x27;</span><br>        &#125;<br>    &#125;<br><br>    dependencies &#123;<br>        <span class="hljs-comment">//æ·»åŠ  AndResGuard ä¾èµ–</span><br>        classpath <span class="hljs-string">&#x27;com.tencent.mm:AndResGuard-gradle-plugin:1.2.21&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//äºŒã€å¦‚æœæ˜¯ AGP 7.0 ä»¥ä¸Šï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š</span><br><span class="hljs-comment">//ç¬¬ä¸€æ­¥</span><br>buildscript &#123;<br>    repositories &#123;<br>      mavenCentral()<br>    &#125;<br><br>    dependencies &#123;<br>        <span class="hljs-comment">//æ·»åŠ å…¼å®¹ AGP 7.0 çš„ AndResGuard ä¾èµ–</span><br>      <span class="hljs-comment">//Githubï¼šhttps://github.com/Leon406/AndResGuard</span><br>        classpath <span class="hljs-string">&#x27;io.github.leon406:AndResGuard-gradle-plugin:1.2.22.6&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šåœ¨ gradle.properties æ·»åŠ å¦‚ä¸‹é…ç½®</span><br><span class="hljs-comment">//å…³é—­ç³»ç»Ÿè‡ªå¸¦çš„èµ„æºå‹ç¼©</span><br>android.enableResourceOptimizations=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> </p><blockquote><p>1ã€ç”±äº jcenter å½»åº•å…³æœï¼Œå®ƒé‡Œé¢æ‰€æœ‰çš„åº“éƒ½è®¿é—®ä¸äº†äº†ï¼Œå› æ­¤ä¸Šé¢æˆ‘ä»¬æ·»åŠ äº† jcenter åœ¨é˜¿é‡Œäº‘çš„é•œåƒä»“åº“</p><p>2ã€è…¾è®¯çš„ AndResGuard æœªåš AGP 7.0 å…¼å®¹ï¼Œå¦‚æœè¦åœ¨ AGP 7.0 ä¸Šä½¿ç”¨ï¼Œè¯·ä½¿ç”¨ä¸Šè¿°é…ç½®äºŒ</p></blockquote><p>2ã€åœ¨ app çš„ build.gradle ä¸­æ·»åŠ ç›¸å…³é…ç½®</p><p>å»ºè®®æ–°å»ºä¸€ä¸ª gradle è„šæœ¬æ–‡ä»¶ï¼Œç„¶ååœ¨ app çš„ build.gradle ä¸­å¼•å…¥è¯¥ gradle è„šæœ¬ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45304d4b9f544a45a5088fb3b2a7bc5f~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203114342414.png"></p><p>3ã€æ¥ç€æˆ‘ä»¬å¯¹ andresguard.gradle è¿›è¡Œé…ç½®ï¼Œé‡Œé¢å†™äº†è¯¦ç»†çš„æ³¨é‡Š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;AndResGuard&#x27;</span><br><br>andResGuard &#123;<br><br>    <span class="hljs-comment">//1ã€å¯ç”¨ç­¾åã€‚ä¸º true æ—¶ï¼Œéœ€è¦é…ç½® signConfig</span><br>    useSign = <span class="hljs-literal">true</span><br>    <span class="hljs-comment">//2ã€keepRoot ä¸º true æ—¶ï¼Œä¼š keep ä½æ‰€æœ‰èµ„æºçš„åŸå§‹è·¯å¾„ï¼Œåªæ··æ·†èµ„æºçš„åå­—</span><br>  <span class="hljs-comment">//å®é™…æµ‹è¯• keepRoot ä¸º true å’Œ false æ²¡å•¥åŒºåˆ«</span><br>    keepRoot = <span class="hljs-literal">true</span><br>    <span class="hljs-comment">//3ã€ç™½åå•ï¼ŒæŒ‡å®šä¸è¢«æ··æ·†çš„èµ„æºæ–‡ä»¶ï¼Œæ”¯æŒé€šé…ç¬¦ï¼Œã€+ã€‘ä»£è¡¨ 1 ä¸ªæˆ–å¤šä¸ªï¼Œã€?ã€‘ä»£è¡¨ 0 ä¸ªæˆ– 1 ä¸ªï¼Œã€*ã€‘ä»£è¡¨ 0 ä¸ªæˆ–å¤šä¸ª</span><br>    whiteList = [<br>           <span class="hljs-string">&quot;R.mipmap.ic_launcher&quot;</span><br>    ]<br>    <span class="hljs-comment">//4ã€é…ç½®éœ€è¦å‹ç¼©çš„æ–‡ä»¶çš„åŒ¹é…è§„åˆ™ï¼Œä¸€èˆ¬è¿™é‡Œä¸éœ€è¦åŠ¨ã€‚æ”¯æŒ ? + * é€šé…ç¬¦</span><br>    compressFilePattern = [<br>            <span class="hljs-string">&quot;*.png&quot;</span>,<br>            <span class="hljs-string">&quot;*.jpg&quot;</span>,<br>            <span class="hljs-string">&quot;*.jpeg&quot;</span>,<br>            <span class="hljs-string">&quot;*.gif&quot;</span>,<br>    ]<br><br>    <span class="hljs-comment">//5ã€é…ç½®7zipï¼Œåªéœ€è®¾ç½® artifact æˆ– pathï¼›æ”¯æŒåŒæ—¶è®¾ç½®ï¼Œä½†æ­¤æ—¶ä»¥ path çš„å€¼ä¸ºä¼˜å…ˆ</span><br>    <span class="hljs-comment">//    sevenzip &#123;</span><br>    <span class="hljs-comment">//        //artifact = &#x27;com.tencent.mm:SevenZip:1.2.21&#x27;</span><br>    <span class="hljs-comment">//        //path = &quot;/usr/local/bin/7za&quot;</span><br>    <span class="hljs-comment">//    &#125;</span><br><br>    <span class="hljs-comment">//6ã€ç”¨äº keep ä½èµ„æºè·¯å¾„çš„ mapping æ–‡ä»¶æ‰€åœ¨è·¯å¾„ä¸è¢«æ··æ·†</span><br>    <span class="hljs-comment">//mappingFile = file(&quot;./resource_mapping.txt&quot;)</span><br><br>    <span class="hljs-comment">//7ã€å¯ç”¨ 7zip å‹ç¼©ã€‚ä¸ºtrueæ—¶ï¼ŒuseSign å¿…é¡»ä¸º true</span><br>    <span class="hljs-comment">//use7zip = false</span><br><br>    <span class="hljs-comment">//8ã€è®¾ç½®è¿™ä¸ªå€¼ï¼Œä¼šæŠŠ arsc name åˆ—æ··æ·†æˆç›¸åŒçš„åå­—ï¼Œå‡å°‘ string å¸¸é‡æ± çš„å¤§å°</span><br>    <span class="hljs-comment">//fixedResName = &quot;arg&quot;</span><br><br>    <span class="hljs-comment">//9ã€ä¸º true æ—¶ä¼šåˆå¹¶æ‰€æœ‰å“ˆå¸Œå€¼ç›¸åŒçš„èµ„æºï¼Œä½†è¯·ä¸è¦è¿‡åº¦ä¾èµ–è¿™ä¸ªåŠŸèƒ½å»é™¤å»å†—ä½™èµ„æº</span><br>    <span class="hljs-comment">//mergeDuplicatedRes = true</span><br><br>    <span class="hljs-comment">//10ã€å¯é€‰ï¼ŒæŒ‡å®šç”Ÿæˆçš„apkçš„ä¿å­˜è·¯å¾„</span><br>    <span class="hljs-comment">// finalApkBackupPath = &quot;$&#123;project.rootDir&#125;/final.apk&quot;</span><br><br>    <span class="hljs-comment">//11ã€å¯é€‰: æŒ‡å®šv1ç­¾åæ—¶ç”Ÿæˆjaræ–‡ä»¶çš„æ‘˜è¦ç®—æ³•ï¼Œé»˜è®¤å€¼ä¸ºâ€œSHA-1â€</span><br>    <span class="hljs-comment">// digestalg = &quot;SHA-256&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€åŒæ­¥ä¸€ä¸‹é¡¹ç›®ï¼Œå°±å¯ä»¥è¿›è¡Œ resguard æ‰“åŒ…äº†ï¼Œæ–¹å¼æœ‰äºŒï¼š</p><p>1ï¼‰ã€ä½¿ç”¨ Gradle å¯è§†åŒ–ç•Œé¢æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡è¿›è¡Œæ‰“åŒ…ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4b07280cd244865b90f6cd201a5a054~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203192409739.png"></p><p>å¦‚æœæƒ³æ‰“ debug åŒ…ï¼Œåˆ™æ‰§è¡Œ resguardDebug ã€‚</p><p>å¦‚æœæƒ³æ‰“ release åŒ…ï¼Œåˆ™æ‰§è¡Œ resguardRelease ã€‚</p><p>2ï¼‰ã€ä½¿ç”¨ Gradle å‘½ä»¤è¿›è¡Œæ‰“åŒ…</p><p>åœ¨ Terminal æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ‰“ debug åŒ…</span><br>./gradlew resguardDebug<br><br><span class="hljs-comment">//æ‰“ release åŒ…</span><br>./gradlew resguardRelease<br></code></pre></td></tr></table></figure><p>5ã€è¿™é‡Œæˆ‘ä»¬æ‰“ release åŒ…ï¼Œç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ appçš„<code>/build/output/apk/release/AndResGuard_&#123;apk_name&#125;/</code>æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ··æ·†åçš„Apkï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79cd2ae85777427eac1a4b8bcc83e1a2~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203193101190.png"></p><p>å…¶ä¸­ï¼š</p><p>1ã€<strong>app-release_aligned_signed.apk</strong>ï¼šä¸ºè¿›è¡Œå¯¹é½æ··æ·†å¹¶ç­¾åè¿‡çš„ apk</p><p>2ã€<strong>app-release_aligned_unsigned.apk</strong>ï¼šä¸ºè¿›è¡Œå¯¹é½æ··æ·†ä½†æœªç­¾åè¿‡çš„ apk</p><p>3ã€<strong>app-release_unsigned.apk</strong>ï¼šä¸ºè¿›è¡Œæ··æ·†ä½†æœªç­¾åè¿‡çš„apk</p><p>2ï¼Œ3 ä¸¤ä¸ªåŒ…å› ä¸ºæ²¡æœ‰ç­¾åæ˜¯ä¸èƒ½è¿›è¡Œå®‰è£…çš„ï¼Œåªæœ‰ 1 èƒ½å®‰è£…</p><p>6ã€æ•ˆæœå±•ç¤º</p><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦å¯¹ 1 è¿›è¡Œåç¼–è¯‘æŸ¥çœ‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3cdcbdcb42274027891216206a02f61c~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203193839353.png"></p><p>å¯ä»¥çœ‹åˆ°èµ„æºæ–‡ä»¶æŒ‰ç…§é¢„æœŸæ•ˆæœæ··æ·†äº†ã€‚</p><p>å¦å¤–æˆ‘ä»¬é…ç½®çš„ç™½åå•èµ„æºæ²¡æœ‰è¢«æ··æ·†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77f7c94e682b4fe99359f2b493cb7757~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203194509171.png"></p><p>è‡³æ­¤ï¼ŒAndResGuard æ··æ·† APK èµ„æºå°±ä»‹ç»å®Œäº†ï¼Œå¦‚æœæœ‰ç–‘é—®ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„ demo å·¥ç¨‹ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹æ··æ·† AAB èµ„æºï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆäº†è§£ä¸€ä¸‹ AAB æ˜¯ä»€ä¹ˆï¼Ÿ</p><h2 id="äºŒã€AAB-ä»‹ç»"><a href="#äºŒã€AAB-ä»‹ç»" class="headerlink" title="äºŒã€AAB ä»‹ç»"></a>äºŒã€AAB ä»‹ç»</h2><p>ä¸Šä¼ è¿‡åº”ç”¨åˆ° GooglePlay çš„åŒå­¦è‚¯å®šçŸ¥é“ï¼Œç°åœ¨ GooglePlay å¼ºåˆ¶è¦æ±‚æˆ‘ä»¬ä¸Šä¼  .aab æ ¼å¼çš„æ–‡ä»¶ï¼Œé‚£ä½ å¿ƒä¸­æ˜¯å¦ä¼šæœ‰ä¸€äº›ç–‘é—®å‘¢ï¼Ÿ</p><p>ä»€ä¹ˆæ˜¯ AABï¼ŸAAB å’Œ APK æœ‰å•¥åŒºåˆ«ï¼Ÿ</p><h3 id="2-1ã€ä»€ä¹ˆæ˜¯-AABï¼Ÿ"><a href="#2-1ã€ä»€ä¹ˆæ˜¯-AABï¼Ÿ" class="headerlink" title="2.1ã€ä»€ä¹ˆæ˜¯ AABï¼Ÿ"></a>2.1ã€ä»€ä¹ˆæ˜¯ AABï¼Ÿ</h3><p>AAB å³ Android App Bundle ï¼Œå®ƒæ˜¯ Google æ¨å‡ºçš„ APK åŠ¨æ€æ‰“åŒ…ï¼ŒåŠ¨æ€ç»„ä»¶åŒ–çš„æŠ€æœ¯ï¼Œé€šè¿‡ä¸€ä¸ª .aab åç¼€çš„ bundle æ–‡ä»¶ç»„è£…ä¸€ä¸ªæœ€é€‚åˆä½ æ‰‹æœºæœºå‹çš„ APK æ¥ä¸ºä½ çš„è®¾å¤‡å®‰è£…</p><p>ç®€ä»‹ï¼š<a href="https://developer.android.com/guide/app-bundle">Android app bundle</a></p><p><strong>Tipsï¼š.aab æ˜¯ä¸€ç§å‹ç¼©åŒ…çš„æ ¼å¼ï¼ˆåªç”¨äºä¸Šä¼  GooglePlayï¼‰ï¼Œæœ€ç»ˆç”¨æˆ·ä¸‹è½½çš„æ—¶å€™ä¼šé€šè¿‡ç”¨æˆ·æ‰‹æœºæœºå‹é…ç½®çš„ä¸åŒï¼Œç”Ÿæˆä¸€ä¸ªæœ€é€‚åˆè¯¥é…ç½®çš„ APKï¼Œç”¨æˆ·æœ€ç»ˆå®‰è£…å’Œä¸‹è½½çš„æ˜¯ APK æ–‡ä»¶</strong></p><h3 id="2-2ã€AAB-å’Œ-APK-åŒºåˆ«ï¼Ÿ"><a href="#2-2ã€AAB-å’Œ-APK-åŒºåˆ«ï¼Ÿ" class="headerlink" title="2.2ã€AAB å’Œ APK åŒºåˆ«ï¼Ÿ"></a>2.2ã€AAB å’Œ APK åŒºåˆ«ï¼Ÿ</h3><p><code>*.aab</code> å’Œ <code>*.apk</code> æ–‡ä»¶çš„ç»“æ„å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ef765c4dee14a68b639744e7fe13e32~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>*.aab</code> å’Œ <code>*.apk</code> æ–‡ä»¶ç»“æ„æ˜æ˜¾ä¸åŒï¼Œ<code>*.aab</code> æ–‡ä»¶ä¸­çš„èµ„æºç´¢å¼•æ–‡ä»¶ä¸º <code>resources.pb</code>ï¼Œè€Œ <code>*.apk</code> æ–‡ä»¶ä¸­çš„èµ„æºç´¢å¼•æ–‡ä»¶ä¸º <code>resources.arsc</code> æ–‡ä»¶ï¼ŒäºŒè€…çš„ç»“æ„ä¸åŒï¼Œè§£æè‡ªç„¶ä¹Ÿä¸ç›¸åŒï¼Œå¹¶ä¸” <code>*.aab</code> ä¸­çš„æ–‡ä»¶åŒ…å« <code>dynamic feature</code> ç›®å½•ï¼Œæ‰€ä»¥ <code>*.aab</code> ä¸­éœ€è¦æ··æ·†æ›´å¤šçš„æ–‡ä»¶å†…å®¹ã€‚</p><h3 id="2-3ã€AAB-æ‰“åŒ…å®è·µ"><a href="#2-3ã€AAB-æ‰“åŒ…å®è·µ" class="headerlink" title="2.3ã€AAB æ‰“åŒ…å®è·µ"></a>2.3ã€AAB æ‰“åŒ…å®è·µ</h3><h4 id="2-3-1ã€ä½¿ç”¨-AndroidStudio-æ‰“-AAB-åŒ…"><a href="#2-3-1ã€ä½¿ç”¨-AndroidStudio-æ‰“-AAB-åŒ…" class="headerlink" title="2.3.1ã€ä½¿ç”¨ AndroidStudio æ‰“ AAB åŒ…"></a>2.3.1ã€ä½¿ç”¨ AndroidStudio æ‰“ AAB åŒ…</h4><p>ä¹‹å‰æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ AndroidStudio æ‰“ä¸€ä¸ª APK åŒ…ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å¦‚ä½•æ‰“ AAB åŒ…ï¼Œæµç¨‹å…¶å®å·®ä¸å¤šã€‚</p><p>1ã€é€‰æ‹© AndroidStudio å·¥å…·æ çš„ buildï¼Œç‚¹å‡» Generate Singed Bundle or Apk</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a5b4931f0dd434690566213a09b2663~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203203338084.png"></p><p>ç„¶åé€‰æ‹© Android App Bundleï¼Œç‚¹å‡» next</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe5a3157610c4efbb0beebda117125be~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203203522968.png"></p><p>2ã€é€‰æ‹©ç­¾åæ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ªï¼Œæˆ‘è¿™é‡Œå·²ç»æœ‰äº†ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9effe525137416bb33b6606709bc500~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203203733628.png"></p><p>ç‚¹å‡» next</p><p>3ã€é€‰æ‹©æ‰“ release åŒ…ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a5c616e6622649cebced015db22e2b92~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203203933035.png"></p><p>ç‚¹å‡» finish</p><p>ç»è¿‡ä¸Šé¢ 3 æ­¥ï¼Œå¦‚æœæ²¡å•¥é—®é¢˜ï¼Œæˆ‘ä»¬å°±èƒ½æˆåŠŸæ‰“ä¸€ä¸ª AAB åŒ…ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f1dcb65e42bb4fc2aa8a3f2caea8e0d5~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203204127859.png"></p><p>åœ¨ app&#x2F;release&#x2F; ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª app-release.aab æ–‡ä»¶</p><h4 id="2-3-2ã€å°†-AAB-å®‰è£…åˆ°æ‰‹æœº"><a href="#2-3-2ã€å°†-AAB-å®‰è£…åˆ°æ‰‹æœº" class="headerlink" title="2.3.2ã€å°† AAB å®‰è£…åˆ°æ‰‹æœº"></a>2.3.2ã€å°† AAB å®‰è£…åˆ°æ‰‹æœº</h4><p>AAB å·²ç»æœ‰äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æŠŠå®ƒå®‰è£…åˆ°æ‰‹æœºä¸Šã€‚</p><p>æˆ‘ä»¬çŸ¥é“ APK èƒ½ç›´æ¥å®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œä½†æ˜¯ AAB ä¸è¡Œï¼Œé‚£å¦‚æœæˆ‘å°† AAB è½¬æˆ APK ç„¶åå®‰è£…åˆ°æ‰‹æœºæ˜¯å¦å¯è¡Œå‘¢ï¼Ÿå®è·µä¸€ä¸‹ã€‚</p><p>1ã€ä¸‹è½½ bundletool å·¥å…·</p><p>è¦æƒ³å°† AAB è½¬æˆ APK ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å€ŸåŠ© Google æä¾›çš„ bundletool å·¥å…·</p><p>ä¸‹è½½é“¾æ¥ï¼š<a href="https://github.com/google/bundletool/releases">https://github.com/google/bundletool/releases</a></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df991f5799734e458bfa242fe8be8bde~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203205358585.png"></p><p>2ã€ç„¶åé€šè¿‡ <code>bundletool</code> å°† aab è½¬ä¸ºä¸€ç»„ apkï¼Œä¹Ÿå°±æ˜¯ apksï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar [ bundletool æ–‡ä»¶] build-apks --bundle [ aab æ–‡ä»¶] --output [ apks æ–‡ä»¶]<br> --ks=[ç­¾åæ–‡ä»¶]<br> --ks-pass=[pass:ç­¾åå¯†ç ]<br> --ks-key-alias=[åˆ«å]<br> --key-pass=[pass:åˆ«åå¯†ç ]<br></code></pre></td></tr></table></figure><p>ä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar bundletool-all-1.13.1.jar build-apks --bundle=app-release.aab --output=app-output.apks --ks=Certificate --ks-pass=pass:erdai666 --ks-key-alias=key0 --key-pass=pass:erdai666<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆçš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b1eab6c7fa04fd48847db3bf1e612b7~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203210544108.png"></p><p>3ã€ä½¿ç”¨ bundletool å°†ç”Ÿæˆçš„ app-output.apks å®‰è£…åˆ°æ‰‹æœºï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar [ bundletool æ–‡ä»¶] install-apks --apks=[ apks æ–‡ä»¶]<br></code></pre></td></tr></table></figure><p>ä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar bundletool-all-1.13.1.jar install-apks --apks=app-output.apks<br></code></pre></td></tr></table></figure><p>å¦‚æœæ²¡å•¥é—®é¢˜ï¼Œä½ çš„æ‰‹æœºå°†ä¼šæ”¶åˆ°ä¸€ä¸ªå®‰è£…çš„æç¤ºï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ade54f0f72d14c58ba125480b9b05dd3~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203211406390.png"></p><p>ç‚¹å‡»å®‰è£…å³å¯</p><h2 id="ä¸‰ã€AAB-èµ„æºæ··æ·†"><a href="#ä¸‰ã€AAB-èµ„æºæ··æ·†" class="headerlink" title="ä¸‰ã€AAB èµ„æºæ··æ·†"></a>ä¸‰ã€AAB èµ„æºæ··æ·†</h2><p>ä¸Šè¿° AAB èµ„æºæ˜¯æ²¡æœ‰ç»è¿‡æ··æ·†çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹–å…¥ jadx-gui å³å¯éªŒè¯è¿™ä¸€ç‚¹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d167dae22b1342a1960717a06ecc61f0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203211756626.png"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨å­—èŠ‚å¼€æºçš„ AabResGuard æ¡†æ¶å¯¹ AAB èµ„æºè¿›è¡Œæ··æ·†ã€‚</p><h3 id="3-1ã€AabResGuard-ä½¿ç”¨"><a href="#3-1ã€AabResGuard-ä½¿ç”¨" class="headerlink" title="3.1ã€AabResGuard ä½¿ç”¨"></a>3.1ã€AabResGuard ä½¿ç”¨</h3><p>Github åœ°å€ï¼š<a href="https://github.com/bytedance/AabResGuard">https://github.com/bytedance/AabResGuard</a></p><p>AabResGuard å’Œæˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„ AndResGuard åŸç†å¾ˆç±»ä¼¼ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯é’ˆå¯¹ AAB ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹ APKã€‚</p><p>å®ƒçš„ä½¿ç”¨æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ã€Gradle Plugin</p><p>2ã€å‘½ä»¤è¡Œæ”¯æŒ</p><h4 id="3-1-1ã€Gradle-Plugin"><a href="#3-1-1ã€Gradle-Plugin" class="headerlink" title="3.1.1ã€Gradle Plugin"></a>3.1.1ã€Gradle Plugin</h4><p><strong>æ³¨æ„ï¼š aabresguard-plugin åªå‘å¸ƒäº† 0.1.8 ç‰ˆæœ¬ï¼Œ0.1.8 ç‰ˆæœ¬ä¾èµ–çš„ Kotlin æ’ä»¶çš„ç‰ˆæœ¬ä¸ºï¼š1.3.61ï¼Œè€Œ AGP 7.x ç‰ˆæœ¬æ”¯æŒçš„ Kotlin æ’ä»¶ç‰ˆæœ¬ä¸ºï¼š1.5.20 æˆ–è€…æ›´é«˜ï¼Œå› æ­¤å¦‚æœä½ ä½¿ç”¨äº† AGP 7.x çš„ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨æ–¹å¼äºŒå»å¯¹ aab è¿›è¡Œèµ„æºæ··æ·†</strong></p><p>1ã€åœ¨é¡¹ç›®çš„æ ¹ build.gradle æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>    repositories &#123;<br>      mavenCentral()<br>    &#125;<br><br>    dependencies &#123;<br>        classpath <span class="hljs-string">&quot;com.bytedance.android:aabresguard-plugin:0.1.8&quot;</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>2ã€åœ¨ app çš„ build.gradle ä¸­æ·»åŠ ç›¸å…³é…ç½®</p><p>å»ºè®®æ–°å»ºä¸€ä¸ª gradle è„šæœ¬æ–‡ä»¶ï¼Œç„¶ååœ¨ app çš„ build.gradle ä¸­å¼•å…¥è¯¥ gradle è„šæœ¬ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/927458573d7b4017878a0cf5ea2bc9e8~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203215616463.png"></p><p>3ã€æ¥ç€æˆ‘ä»¬å¯¹ aabresguard.gradle è¿›è¡Œé…ç½®ï¼Œé‡Œé¢å†™äº†è¯¦ç»†çš„æ³¨é‡Š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&quot;com.bytedance.android.aabResGuard&quot;</span><br><br>aabResGuard &#123;<br>    whiteList = [ <span class="hljs-comment">// ç™½åå•è§„åˆ™</span><br>                  <span class="hljs-string">&quot;R.mipmap.ic_launcher&quot;</span><br>    ]<br>    obfuscatedBundleFileName = <span class="hljs-string">&quot;duplicated-app.aab&quot;</span> <span class="hljs-comment">// æ··æ·†åçš„æ–‡ä»¶åç§°ï¼Œå¿…é¡»ä»¥ `.aab` ç»“å°¾</span><br>    mergeDuplicatedRes = <span class="hljs-literal">true</span> <span class="hljs-comment">// æ˜¯å¦å…è®¸å»é™¤é‡å¤èµ„æº</span><br>    enableFilterFiles = <span class="hljs-literal">true</span> <span class="hljs-comment">// æ˜¯å¦å…è®¸è¿‡æ»¤æ–‡ä»¶</span><br>    filterList = [ <span class="hljs-comment">// æ–‡ä»¶è¿‡æ»¤è§„åˆ™</span><br>                   <span class="hljs-string">&quot;*/arm64-v8a/*&quot;</span>,<br>                   <span class="hljs-string">&quot;META-INF/*&quot;</span><br>    ]<br>    enableFilterStrings = <span class="hljs-literal">false</span> <span class="hljs-comment">// è¿‡æ»¤æ–‡æ¡ˆ</span><br>    <span class="hljs-comment">//mappingFile = file(&quot;mapping.txt&quot;).toPath() // ç”¨äºå¢é‡æ··æ·†çš„ mapping æ–‡ä»¶</span><br>    <span class="hljs-comment">//unusedStringPath = file(&quot;unused.txt&quot;).toPath() // è¿‡æ»¤æ–‡æ¡ˆåˆ—è¡¨è·¯å¾„ é»˜è®¤åœ¨mappingåŒç›®å½•æŸ¥æ‰¾</span><br>    <span class="hljs-comment">//languageWhiteList = [&quot;en&quot;, &quot;zh&quot;] // ä¿ç•™en,en-xx,zh,zh-xxç­‰è¯­è¨€ï¼Œå…¶ä½™å‡åˆ é™¤</span><br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€åŒæ­¥ä¸€ä¸‹é¡¹ç›®ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ··æ·†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./gradlew clean :app:bundleRelease --stacktrace <br></code></pre></td></tr></table></figure><p>5ã€é€šè¿‡æ‰§è¡Œ gradle Task è·å–æ··æ·†åçš„ bundle æ–‡ä»¶è·¯å¾„</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> aabResGuardPlugin = project.tasks.getByName(<span class="hljs-string">&quot;aabresguard$&#123;VARIANT_NAME&#125;&quot;</span>)<br>Path bundlePath = aabResGuardPlugin.getObfuscatedBundlePath()<br></code></pre></td></tr></table></figure><h3 id="3-1-2ã€å‘½ä»¤è¡Œæ”¯æŒ"><a href="#3-1-2ã€å‘½ä»¤è¡Œæ”¯æŒ" class="headerlink" title="3.1.2ã€å‘½ä»¤è¡Œæ”¯æŒ"></a>3.1.2ã€å‘½ä»¤è¡Œæ”¯æŒ</h3><p>AabResGuard æä¾›äº† jar åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤ç›´æ¥æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar [AabResGuard Jar æ–‡ä»¶] obfuscate-bundle --bundle=[æœªèµ„æºæ··æ·†çš„ aab] --output=[èµ„æºæ··æ·†åçš„ aab] --merge-duplicated-res=true --storeFile=[ç­¾åæ–‡ä»¶] --storePassword=[ç­¾åå¯†ç ] --keyAlias=[åˆ«å] --keyPassword=[åˆ«åå¯†ç ]<br></code></pre></td></tr></table></figure><p>ä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar AabResGuard-0.1.9.jar obfuscate-bundle --bundle=app-release.aab --output=obfuscated.aab --merge-duplicated-res=true --storeFile=Certificate --storePassword=erdai666 --keyAlias=key0 --keyPassword=erdai666<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢çš„æ“ä½œï¼Œaab èµ„æºæ··æ·†çš„æ•ˆæœå’Œä¹‹å‰ apk èµ„æºæ··æ·†çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œå°±ä¸å†è¿›è¡Œæ•ˆæœéªŒè¯äº†</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€ä½¿ç”¨ AndResGuard å¯¹ APK è¿›è¡Œèµ„æºæ··æ·†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><blockquote><p>è…¾è®¯æä¾›çš„ AndResGuard ä¸å…¼å®¹ AGP 7.x ï¼Œå› æ­¤å¦‚æœåœ¨ AGP 7.x ä¸­éœ€ä½¿ç”¨å…¼å®¹ AndResGuard çš„æ–¹æ¡ˆå»å¤„ç†</p></blockquote><p>2ã€ä»€ä¹ˆæ˜¯ AAB</p><blockquote><p>AAB æ˜¯ Google æ¨å‡ºçš„ä¸€ç§åŠ¨æ€æ‰“åŒ…æŠ€æœ¯ï¼Œå®ƒä¼šæ ¹æ®ç”¨æˆ·æ‰‹æœºçš„æœºå‹åŠ¨æ€ä¸‹å‘æœ€åˆé€‚çš„ APK è¿›è¡Œå®‰è£…</p></blockquote><p>3ã€AAB å’Œ APK çš„åŒºåˆ«</p><blockquote><p>1ã€AAB çš„èµ„æºç´¢å¼•æ–‡ä»¶ä¸º .pb æ ¼å¼ï¼ŒAPK çš„èµ„æºç´¢å¼•æ–‡ä»¶ä¸º .arsc æ ¼å¼</p><p>2ã€AAB ä¸­åŒ…å«äº† dynamic feture æ¨¡å—ï¼ŒAPK ä¸­æ²¡æœ‰</p></blockquote><p>4ã€é€šè¿‡ AndroidStudio æ‰“ AAB åŒ…å¹¶å®‰è£…åˆ°æ‰‹æœºä¸Š</p><p>5ã€é€šè¿‡å­—èŠ‚æä¾›çš„ AabResGuard å¯¹ AAB è¿›è¡Œèµ„æºæ··æ·†</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://github.com/shwenzhang/AndResGuard">AndResGuard</a></p><p><a href="https://github.com/Leon406/AndResGuard">AndResGuard 7.0 é€‚é…</a></p><p><a href="https://github.com/bytedance/AabResGuard">AabResGuard</a></p><p><a href="https://juejin.cn/post/6844904038618628109">å¼€æº | AabResGuard: AAB èµ„æºæ··æ·†å·¥å…·</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Android é€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android é€†å‘</tag>
      
      <tag>åç¼–è¯‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter é¡¹ç›®å¼€å‘åŠæŠ€æœ¯é€‰å‹</title>
    <link href="/2022/11/27/flutter9/"/>
    <url>/2022/11/27/flutter9/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä» 0 å¼€å‘ä¸€ä¸ª Flutter é¡¹ç›®ï¼Œè¦æƒ³åšå¥½ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤šçš„ã€‚ä¾‹å¦‚ï¼š</p><p>1ã€å¦‚ä½•æ­å»ºä¸€ä¸ªå¥½çš„å¼€å‘æ¡†æ¶è®©æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œå¯ç»´æŠ¤æ€§å¥½ï¼Œå¯æ‰©å±•æ€§é«˜ï¼Ÿ</p><p>2ã€å¦‚ä½•è¿›è¡Œ Flutter æŠ€æœ¯é€‰å‹ï¼ŒåŠ é€Ÿæˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ï¼Ÿ</p><p>3ã€å¦‚ä½•å°†é¡¹ç›®è¿›è¡Œé«˜æ•ˆçš„å›¢é˜Ÿåä½œï¼Œé¿å…å›¢é˜Ÿæˆå‘˜é—´å‡ºç°ä»£ç æäº¤å†²çªï¼Œä»£ç è¦†ç›–ç­‰é—®é¢˜ï¼Ÿ</p><p>å¸¦ç€é—®é¢˜å»æ€è€ƒï¼Œä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘åœ¨å®é™…å¼€å‘ä¸­çš„ä¸€äº›ç»éªŒå’Œå¿ƒå¾—ã€‚</p><h2 id="ä¸€ã€ç»„ä»¶åŒ–æ–¹æ¡ˆå’Œè¦ç‚¹"><a href="#ä¸€ã€ç»„ä»¶åŒ–æ–¹æ¡ˆå’Œè¦ç‚¹" class="headerlink" title="ä¸€ã€ç»„ä»¶åŒ–æ–¹æ¡ˆå’Œè¦ç‚¹"></a>ä¸€ã€ç»„ä»¶åŒ–æ–¹æ¡ˆå’Œè¦ç‚¹</h2><p>Flutter ä¸­å¦‚ä½•åšåˆ°åƒ Android ä¸€æ ·ä½¿ç”¨ç»„ä»¶åŒ–å¼€å‘å‘¢ï¼Ÿ</p><h3 id="1-1ã€Flutter-Project-Type-ä»‹ç»"><a href="#1-1ã€Flutter-Project-Type-ä»‹ç»" class="headerlink" title="1.1ã€Flutter Project Type ä»‹ç»"></a>1.1ã€Flutter Project Type ä»‹ç»</h3><p>åœ¨æˆ‘ä»¬æ–°å»ºä¸€ä¸ª Flutter é¡¹ç›®æ—¶ï¼Œå¯ä»¥é€‰æ‹© 5 ç§ç±»å‹çš„ Project Type ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a499460fd12b4f68a51bc4ff1df5692f~tplv-k3u1fbpfcp-watermark.image" alt="image-20221127174814675.png"></p><h4 id="1-1-1ã€Application"><a href="#1-1-1ã€Application" class="headerlink" title="1.1.1ã€Application"></a>1.1.1ã€Application</h4><p>è¿™ç§ç±»å‹çš„ä¸»ä½“æ˜¯ Flutterï¼Œå…¶ä¸­åŒ…å« Androidï¼ŒiOS ç­‰é¡¹ç›®ï¼Œä¸»è¦ç”¨äºçº¯ Flutter å¼€å‘ã€‚</p><h4 id="1-1-2ã€Plugin"><a href="#1-1-2ã€Plugin" class="headerlink" title="1.1.2ã€Plugin"></a>1.1.2ã€Plugin</h4><p>è¿™ç§ç±»å‹ä¸»è¦ç”¨æ¥å¼€å‘ Flutter æ’ä»¶ã€‚</p><blockquote><p>Flutter æ— æ³•å®ç°çš„åŠŸèƒ½ï¼Œä½¿ç”¨åŸç”Ÿæ¥å®ç°ï¼Œç„¶åé€šè¿‡ Flutter æ’ä»¶åœ¨ Flutter é¡¹ç›®ä¸­ä½¿ç”¨åŸç”Ÿå®ç°çš„åŠŸèƒ½</p></blockquote><h4 id="1-1-3ã€Package"><a href="#1-1-3ã€Package" class="headerlink" title="1.1.3ã€Package"></a>1.1.3ã€Package</h4><p>è¿™ç§ç±»å‹æ˜¯çº¯ Flutter æ¨¡å—ï¼Œä¸éœ€è¦åŸç”Ÿä»£ç å®ç°ï¼Œæ²¡æœ‰ Android iOS ç›®å½•ã€‚ä¸€èˆ¬ç”¨äºé€šç”¨æ¨¡å—æˆ–è€…ç‰¹å®šä¸šåŠ¡çš„æ¨¡å—åˆ’åˆ†ã€‚</p><h4 id="1-1-4ã€Module"><a href="#1-1-4ã€Module" class="headerlink" title="1.1.4ã€Module"></a>1.1.4ã€Module</h4><p>è¿™ç§ç±»å‹çš„ä¸»ä½“æ˜¯åŸç”Ÿé¡¹ç›®ï¼Œç”¨äºåœ¨ Androidï¼ŒiOS é¡¹ç›®ä¸­æ·»åŠ  Flutter æ¨¡å—ï¼Œè¿›è¡ŒåŸç”Ÿä¸ Flutter çš„æ··åˆå¼€å‘ã€‚</p><h4 id="1-1-5ã€Skeleton"><a href="#1-1-5ã€Skeleton" class="headerlink" title="1.1.5ã€Skeleton"></a>1.1.5ã€Skeleton</h4><p>ä» Flutter 2.5 å¼€å§‹æ”¯æŒè¿™ç§ç±»å‹ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºå¼€å‘æä¾›ä¸€ç§è¾ƒå¥½çš„é¡¹ç›®æ¨¡æ¿ï¼Œä¸åœ¨æ˜¯é»˜è®¤çš„ Couter appã€‚<br>æ¨¡æ¿ä¸­å¯ä»¥çœ‹åˆ°è·¯ç”±ã€èµ„æºã€å¤šè¯­è¨€ã€çŠ¶æ€ç®¡ç†ï¼Œæ–‡ä»¶å¤¹ç­‰æœ€ä½³å®è·µæ–¹æ³•</p><h3 id="1-2ã€ç»„ä»¶åŒ–é¡¹ç›®åˆ›å»º"><a href="#1-2ã€ç»„ä»¶åŒ–é¡¹ç›®åˆ›å»º" class="headerlink" title="1.2ã€ç»„ä»¶åŒ–é¡¹ç›®åˆ›å»º"></a>1.2ã€ç»„ä»¶åŒ–é¡¹ç›®åˆ›å»º</h3><p>äº†è§£äº† Project typeï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…éœ€æ±‚å»åˆ›å»ºä¸€ä¸ªç»„ä»¶åŒ–çš„ Flutter é¡¹ç›®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p><p>1ã€æˆ‘æƒ³è¿›è¡Œçº¯ Flutter é¡¹ç›®çš„ç»„ä»¶åŒ–å¼€å‘ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥é‡‡ç”¨ï¼š<strong>Application + Package çš„æ–¹å¼</strong></p><p>2ã€æ ¹æ®ä¸šåŠ¡è¿›è¡Œä¸šåŠ¡ç»„ä»¶å’ŒåŸºç¡€ç»„ä»¶çš„åˆ’åˆ†ï¼š</p><blockquote><p>ä¸šåŠ¡ç»„ä»¶ï¼šä¸ä¸šåŠ¡ç›¸å…³è”çš„ç»„ä»¶</p><p>åŸºç¡€ç»„ä»¶ï¼šä¸ä¸šåŠ¡æ— å…³çš„ç»„ä»¶</p></blockquote><p>æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼š</p><blockquote><p>pkg_baseï¼šæ”¾ä¸ä¸šåŠ¡æ— å…³çš„åŸºç¡€ç»„ä»¶</p><p>pkg_bizï¼šæ”¾ä¸ä¸šåŠ¡ç›¸å…³çš„ä¸šåŠ¡ç»„ä»¶</p></blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç†è®ºè¿›è¡Œå®è·µï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d79b7ebbc6b648829291143724c09c05~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221127185517524.png" style="zoom:50%;" /><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€æˆ‘åˆ›å»ºäº†ä¸€ä¸ª FlutterWanAndroid çš„ Application é¡¹ç›®</p><p>2ã€åˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼š</p><blockquote><p>pkg_base ä¸‹æ”¾äº†æˆ‘ä»¬æ–°å»ºçš„ä¸ä¸šåŠ¡æ— å…³çš„åŸºç¡€ Package ç»„ä»¶</p><p>pkg_biz ä¸‹æ”¾äº†æˆ‘ä»¬æ–°å»ºçš„ä¸ä¸šåŠ¡ç›¸å…³çš„ä¸šåŠ¡ Package ç»„ä»¶</p></blockquote><p>3ã€ä¸šåŠ¡ Package ç»„ä»¶æˆ‘ä»¬åˆ’åˆ†äº†ï¼šå®ç°å±‚å’Œ export å±‚ï¼ˆæ¥å£å±‚ï¼‰ï¼Œå…¶ä»–ç»„ä»¶ä¾èµ– export å±‚è¿›è¡Œé€šä¿¡è€Œä¸éœ€è¦ä¾èµ–å…·ä½“å®ç°å±‚</p><p>è¿™æ ·æˆ‘ä»¬å°±æ­å»ºå¥½äº†ä¸€ä¸ªæœ€åŸºç¡€çš„ç»„ä»¶åŒ–é¡¹ç›®</p><h3 id="1-3ã€é…ç½®ä¾èµ–"><a href="#1-3ã€é…ç½®ä¾èµ–" class="headerlink" title="1.3ã€é…ç½®ä¾èµ–"></a>1.3ã€é…ç½®ä¾èµ–</h3><h3 id="1-4ã€ç»„ä»¶åŒ–è·¯ç”±ç®¡ç†"><a href="#1-4ã€ç»„ä»¶åŒ–è·¯ç”±ç®¡ç†" class="headerlink" title="1.4ã€ç»„ä»¶åŒ–è·¯ç”±ç®¡ç†"></a>1.4ã€ç»„ä»¶åŒ–è·¯ç”±ç®¡ç†</h3><p>æ¥ä¸‹æ¥å°±æ˜¯å„ç»„ä»¶é—´çš„è·¯ç”±ç®¡ç†ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ GetXï¼Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ Getxï¼š</p><blockquote><p>GetX æ˜¯ Flutter ä¸Šä¸€ä¸ªè½»é‡ä¸”å¼ºå¤§çš„çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œå®ƒä¸ä»…åŒ…å«äº†<strong>çŠ¶æ€ç®¡ç†</strong>ï¼Œè¿˜æœ‰<strong>è·¯ç”±ç®¡ç†ï¼Œä¸»é¢˜ç®¡ç†ï¼Œå›½é™…åŒ–å¤šè¯­è¨€ç®¡ç†ï¼Œç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®éªŒè¯ï¼ŒDialogï¼ŒSnackbar</strong> ç­‰åŠŸèƒ½</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆåï¼‰ï¼šæ‰‹æ’¸ GetX çŠ¶æ€ç®¡ç†æ ¸å¿ƒæºç å®ç°</title>
    <link href="/2022/11/20/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%8D%81%EF%BC%89%EF%BC%9A%E6%89%8B%E6%92%B8%20GetX%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/11/20/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%8D%81%EF%BC%89%EF%BC%9A%E6%89%8B%E6%92%B8%20GetX%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ä¾èµ–æ³¨å…¥ç®¡ç†æ ¸å¿ƒæºç å®ç°"><a href="#ä¸€ã€ä¾èµ–æ³¨å…¥ç®¡ç†æ ¸å¿ƒæºç å®ç°" class="headerlink" title="ä¸€ã€ä¾èµ–æ³¨å…¥ç®¡ç†æ ¸å¿ƒæºç å®ç°"></a>ä¸€ã€ä¾èµ–æ³¨å…¥ç®¡ç†æ ¸å¿ƒæºç å®ç°</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mobx</span></span>&#123;<br>  <span class="hljs-keyword">static</span> S put&lt;S&gt;(S dependency,&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">return</span> MobxInstance().put&lt;S&gt;(dependency,tag: tag);<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> S find&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">return</span> MobxInstance().find&lt;S&gt;(tag: tag);<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> delete&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">return</span> MobxInstance().delete&lt;S&gt;(tag: tag);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_InstanceBuilderFactory</span>&lt;<span class="hljs-title">T</span>&gt;</span>&#123;<br><br>  T dependency;<br><br>  _InstanceBuilderFactory(<span class="hljs-keyword">this</span>.dependency);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MobxInstance</span></span>&#123;<br>  <span class="hljs-keyword">static</span> MobxInstance? instance;<br><br>  MobxInstance._();<br><br>  <span class="hljs-keyword">factory</span> MobxInstance() =&gt; instance ??= MobxInstance._();<br><br>  <span class="hljs-keyword">final</span> _single = &lt;<span class="hljs-built_in">String</span>,_InstanceBuilderFactory&gt;&#123;&#125;;<br><br>  <span class="hljs-built_in">String</span> _getKey(<span class="hljs-built_in">Type</span> type,<span class="hljs-built_in">String?</span> tag)&#123;<br>    <span class="hljs-keyword">return</span> tag == <span class="hljs-keyword">null</span> ? type.toString() : type.toString() + tag;<br>  &#125;<br><br>  S put&lt;S&gt;(S dependency,&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">final</span> newKey = _getKey(S, tag);<br>    _single.putIfAbsent(newKey, () =&gt; _InstanceBuilderFactory(dependency));<br>    <span class="hljs-keyword">return</span> find&lt;S&gt;(tag: tag);<br>  &#125;<br><br>  S find&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">final</span> newKey = _getKey(S, tag);<br>    <span class="hljs-keyword">if</span>(_single.containsKey(newKey))&#123;<br>      <span class="hljs-keyword">return</span> _single[newKey]!.dependency;<br>    &#125;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;&quot;<span class="hljs-subst">$newKey</span>&quot; not found&#x27;</span>;<br>  &#125;<br><br>  <span class="hljs-built_in">bool</span> delete&lt;S&gt;(&#123;<span class="hljs-built_in">String?</span> tag&#125;)&#123;<br>    <span class="hljs-keyword">final</span> newKey = _getKey(S, tag);<br>    <span class="hljs-keyword">if</span>(_single.containsKey(newKey))&#123;<br>      _single.remove(newKey);<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&quot;<span class="hljs-subst">$newKey</span>&quot; removed success&#x27;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&quot;<span class="hljs-subst">$newKey</span>&quot; Already removed&#x27;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€GetBuilder-Controller-update-æ ¸å¿ƒæºç å®ç°"><a href="#äºŒã€GetBuilder-Controller-update-æ ¸å¿ƒæºç å®ç°" class="headerlink" title="äºŒã€GetBuilder + Controller.update æ ¸å¿ƒæºç å®ç°"></a>äºŒã€GetBuilder + Controller.update æ ¸å¿ƒæºç å®ç°</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">typedef</span> MobXCallback = <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>();<br><span class="hljs-comment">//ç›‘å¬å™¨</span><br><span class="hljs-keyword">mixin</span> MobxNotifier&#123;<br>  <span class="hljs-keyword">final</span> _updaters = &lt;MobXCallback&gt;[];<br>  <span class="hljs-keyword">final</span> _updatersGroupIds = &lt;<span class="hljs-built_in">Object?</span>,<span class="hljs-built_in">List</span>&lt;MobXCallback&gt;&gt;&#123;&#125;;<br><br>  <span class="hljs-keyword">void</span> notifyUpdate()&#123;<br>    <span class="hljs-keyword">if</span>(_updaters.isNotEmpty)&#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> _updaters) &#123;<br>        element();<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> notifyIdUpdate(<span class="hljs-built_in">Object?</span> id)&#123;<br>    <span class="hljs-keyword">if</span>(_updatersGroupIds.isEmpty)<span class="hljs-keyword">return</span>;<br><br>    <span class="hljs-keyword">if</span>(_updatersGroupIds.containsKey(id))&#123;<br>      <span class="hljs-keyword">var</span> listGroup = _updatersGroupIds[id];<br>      listGroup?.forEach((element) &#123;<br>        element();<br>      &#125;);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> removeListener(MobXCallback callback)&#123;<br>    <span class="hljs-keyword">if</span>(_updaters.contains(callback))&#123;<br>      _updaters.remove(callback);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> removeListenerId(<span class="hljs-built_in">Object?</span> id,MobXCallback callback)&#123;<br>    <span class="hljs-keyword">if</span>(_updatersGroupIds.containsKey(id))&#123;<br>      _updatersGroupIds[id]?.remove(callback);<br>    &#125;<br>    _updaters.remove(callback);<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> addListener(MobXCallback callback)&#123;<br>    _updaters.add(callback);<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> addListenerId(<span class="hljs-built_in">Object?</span> id,MobXCallback callback)&#123;<br>    _updatersGroupIds[id] ??= &lt;MobXCallback&gt;[];<br>    _updatersGroupIds[id]?.add(callback);<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> dispose()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;notifier dispose&#x27;</span>);<br>    _updaters.clear();<br>    _updatersGroupIds.clear();<br>  &#125;<br>&#125;<br><span class="hljs-comment">//Controller åŸºç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MobxController</span> <span class="hljs-title">with</span> <span class="hljs-title">MobxNotifier</span> </span>&#123;<br>  <span class="hljs-keyword">void</span> update([<span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">Object</span>&gt;? ids]) &#123;<br>    <span class="hljs-keyword">if</span> (ids == <span class="hljs-keyword">null</span>) &#123;<br>      notifyUpdate();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> ids) &#123;<br>        notifyIdUpdate(element);<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">typedef</span> MobControllerBuilder&lt;T <span class="hljs-keyword">extends</span> MobxController&gt; = Widget <span class="hljs-built_in">Function</span>(T controller);<br><span class="hljs-comment">//MobxBuilder</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MobxBuilder</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MobxController</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-keyword">final</span> MobControllerBuilder&lt;T&gt; builder;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">Object?</span> id;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String?</span> tag;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> autoRemove;<br><br>  <span class="hljs-keyword">const</span> MobxBuilder(&#123;Key? key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.builder, <span class="hljs-keyword">this</span>.id, <span class="hljs-keyword">this</span>.tag, <span class="hljs-keyword">this</span>.autoRemove = <span class="hljs-keyword">true</span>&#125;) : <span class="hljs-keyword">super</span>(key: key);<br><br>  <span class="hljs-meta">@override</span><br>  State&lt;MobxBuilder&gt; createState() =&gt; _MobxBuilderState&lt;T&gt;();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MobxBuilderState</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MobxController</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MobxBuilder</span>&lt;<span class="hljs-title">T</span>&gt;&gt; </span>&#123;<br><br>  <span class="hljs-keyword">late</span> T controller;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br><br>    controller = MobxInstance().find&lt;T&gt;(tag: widget.tag);<br>    <span class="hljs-keyword">if</span>(widget.id == <span class="hljs-keyword">null</span>)&#123;<br>      controller.addListener(() &#123;<br>        <span class="hljs-keyword">if</span>(mounted)&#123;<br>          setState(() &#123;<br><br>          &#125;);<br>        &#125;<br>      &#125;);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      controller.addListenerId(widget.id, () &#123;<br>        <span class="hljs-keyword">if</span>(mounted)&#123;<br>          setState(() &#123;<br><br>          &#125;);<br>        &#125;<br>      &#125;);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> dispose() &#123;<br>    <span class="hljs-keyword">if</span>(widget.autoRemove)&#123;<br>      MobxInstance().delete(tag: widget.tag);<br>    &#125;<br>    controller.dispose();<br>    <span class="hljs-keyword">super</span>.dispose();<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> widget.builder(controller);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€-Obx-obs-æ ¸å¿ƒæºç å®ç°"><a href="#ä¸‰ã€-Obx-obs-æ ¸å¿ƒæºç å®ç°" class="headerlink" title="ä¸‰ã€ Obx + obs æ ¸å¿ƒæºç å®ç°"></a>ä¸‰ã€ Obx + obs æ ¸å¿ƒæºç å®ç°</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">typedef</span> MyVoidCallback = <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>();<br><span class="hljs-keyword">typedef</span> MyValueGetter&lt;T&gt; = T <span class="hljs-built_in">Function</span>();<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRxObservable</span></span>&#123;<br><br>  <span class="hljs-keyword">final</span> listeners = &lt;MyVoidCallback&gt;[];<br><br><br>  <span class="hljs-keyword">void</span> add(MyVoidCallback listener) =&gt; listeners.add(listener);<br><br>  <span class="hljs-keyword">void</span> remove(MyVoidCallback listener) =&gt; listeners.remove(listener);<br><br>  <span class="hljs-keyword">void</span> notify()&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value <span class="hljs-keyword">in</span> listeners) &#123;<br>      value();<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> dispose()&#123;<br>    listeners.clear();<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRxNotifier</span></span>&#123;<br><br>  <span class="hljs-keyword">static</span> MyRxNotifier? proxy;<br><br>  <span class="hljs-keyword">final</span> myRxObservable = MyRxObservable();<br>  <span class="hljs-keyword">final</span> map = &lt;MyRxObservable,<span class="hljs-built_in">String</span>&gt;&#123;&#125;;<br><br>  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> canUpdate =&gt; map.isNotEmpty;<br><br>  <span class="hljs-keyword">void</span> addListener(MyRxObservable observable)&#123;<br>    <span class="hljs-keyword">if</span>(!map.containsKey(observable))&#123;<br>      observable.add(() &#123;<br>        myRxObservable.notify();<br>      &#125;);<br>      map[observable] = <span class="hljs-string">&#x27;&#x27;</span>;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> T notifyChildren&lt;T&gt;(MyRxNotifier myRxNotifier,MyValueGetter&lt;T&gt; builder)&#123;<br>    <span class="hljs-keyword">final</span> _observer = MyRxNotifier.proxy;<br>    MyRxNotifier.proxy = myRxNotifier;<br>    <span class="hljs-keyword">final</span> result = builder();<br>    <span class="hljs-keyword">if</span>(!myRxNotifier.canUpdate)&#123;<br>      MyRxNotifier.proxy = _observer;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;nofityChildren error exception&#x27;</span>;<br>    &#125;<br>    MyRxNotifier.proxy = _observer;<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;<br><br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRx</span>&lt;<span class="hljs-title">T</span>&gt;</span>&#123;<br><br>  MyRxObservable myRxObservable = MyRxObservable();<br><br>  <span class="hljs-built_in">bool</span> firstRebuild = <span class="hljs-keyword">true</span>;<br><br>  T _value;<br><br>  MyRx(<span class="hljs-keyword">this</span>._value);<br><br>  <span class="hljs-keyword">set</span> value(T value)&#123;<br>    <span class="hljs-keyword">if</span>(_value == value &amp;&amp; !firstRebuild)<span class="hljs-keyword">return</span>;<br>    firstRebuild = <span class="hljs-keyword">false</span>;<br>    _value = value;<br><br>    myRxObservable.notify();<br>  &#125;<br><br>  T <span class="hljs-keyword">get</span> value&#123;<br>    MyRxNotifier.proxy?.addListener(myRxObservable);<br>    <span class="hljs-keyword">return</span> _value;<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRxInt</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MyRx</span>&lt;<span class="hljs-title">int</span>&gt;</span>&#123;<br><br>  MyRxInt(<span class="hljs-built_in">int</span> value) : <span class="hljs-keyword">super</span>(value);<br><br>  MyRxInt <span class="hljs-keyword">operator</span> +(<span class="hljs-built_in">int</span> <span class="hljs-built_in">num</span>)&#123;<br>    value = value + <span class="hljs-built_in">num</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>  &#125;<br><br>  MyRxInt <span class="hljs-keyword">operator</span> -(<span class="hljs-built_in">int</span> <span class="hljs-built_in">num</span>)&#123;<br>    value = value - <span class="hljs-built_in">num</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">extension</span> MyIntExtension <span class="hljs-keyword">on</span> <span class="hljs-built_in">int</span>&#123;<br>  MyRxInt <span class="hljs-keyword">get</span> mbx =&gt; MyRxInt(<span class="hljs-keyword">this</span>);<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mbx</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br><br>  <span class="hljs-keyword">final</span> MyValueGetter&lt;Widget&gt; builder;<br><br>  <span class="hljs-keyword">const</span> Mbx(<span class="hljs-keyword">this</span>.builder,&#123;Key? key&#125;) : <span class="hljs-keyword">super</span>(key: key);<br><br>  <span class="hljs-meta">@override</span><br>  State&lt;Mbx&gt; createState() =&gt; _MbxState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MbxState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">Mbx</span>&gt; </span>&#123;<br><br>  MyRxNotifier myRxNotifier = MyRxNotifier();<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br><br>    myRxNotifier.myRxObservable.add(() &#123;<br>      <span class="hljs-keyword">if</span>(mounted)&#123;<br>        setState(() &#123;<br><br>        &#125;);<br>      &#125;<br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MyRxNotifier.notifyChildren(myRxNotifier, widget.builder);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyEasyBindWidget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-keyword">const</span> MyEasyBindWidget(<br>      &#123;Key? key,<br>      <span class="hljs-keyword">this</span>.bind,<br>      <span class="hljs-keyword">this</span>.tag,<br>      <span class="hljs-keyword">this</span>.binds,<br>      <span class="hljs-keyword">this</span>.tags,<br>      <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child&#125;)<br>      : <span class="hljs-keyword">super</span>(key: key);<br><br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">Object?</span> bind;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String?</span> tag;<br><br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">Object</span>&gt;? binds;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">String</span>&gt;? tags;<br><br>  <span class="hljs-keyword">final</span> Widget child;<br><br>  <span class="hljs-meta">@override</span><br>  State&lt;MyEasyBindWidget&gt; createState() =&gt; _MyEasyBindWidgetState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyEasyBindWidgetState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyEasyBindWidget</span>&gt; </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> widget.child;<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> dispose() &#123;<br>    _closeController();<br>    _closeControllers();<br>    <span class="hljs-keyword">super</span>.dispose();<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> _closeController() &#123;<br>    <span class="hljs-keyword">if</span>(widget.bind == <span class="hljs-keyword">null</span>)&#123;<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">var</span> key = widget.bind.runtimeType.toString() + (widget.tag ?? <span class="hljs-string">&#x27;&#x27;</span>);<br>    MyEasy.delete(key: key);<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> _closeControllers() &#123;<br>    <span class="hljs-keyword">if</span>(widget.binds == <span class="hljs-keyword">null</span>)&#123;<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; widget.binds!.length; i++)&#123;<br>      <span class="hljs-keyword">var</span> type = widget.binds![i].runtimeType.toString();<br>      <span class="hljs-keyword">if</span>(widget.tags == <span class="hljs-keyword">null</span> || widget.tags?.isEmpty == <span class="hljs-keyword">true</span>)&#123;<br>        MyEasy.delete(key: type);<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">var</span> key = type + (widget.tags![i]);<br>        MyEasy.delete(key: key);<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€æ•ˆæœéªŒè¯"><a href="#å››ã€æ•ˆæœéªŒè¯" class="headerlink" title="å››ã€æ•ˆæœéªŒè¯"></a>å››ã€æ•ˆæœéªŒè¯</h2><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šJava å…­å¤§è®¾è®¡åŸåˆ™å’Œå¸¸ç”¨è®¾è®¡æ¨¡å¼</title>
    <link href="/2022/10/31/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AJava%20%E5%85%AD%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E5%B8%B8%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/10/31/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AJava%20%E5%85%AD%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E5%B8%B8%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/443d7f62e7b446518364d7b6a188bae8~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>è®¾è®¡æ¨¡å¼æ˜¯æˆ‘ä»¬ç¼–ç¨‹çš„åŸºç¡€ï¼ŒæŒæ¡å¥½å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œèƒ½è®©æˆ‘ä»¬å†™å‡ºå¯æ‰©å±•ï¼Œå¯ç»´æŠ¤ï¼Œå¯å¤ç”¨çš„é«˜è´¨é‡ä»£ç ã€‚</p><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ</h2><p>è®¾è®¡æ¨¡å¼æ˜¯è¢«å¹¿æ³›ä½¿ç”¨ï¼Œè½¯ä»¶å¼€å‘è€…ç¼–ç ç»éªŒçš„ä¸€ä¸ªæ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬å†™å‡ºæ¥çš„ä»£ç æ›´å®¹æ˜“è¢«åˆ«äººç†è§£ï¼Œå…·æœ‰é«˜å¯å¤ç”¨æ€§ï¼Œå¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§</p><h2 id="äºŒã€è®¾è®¡æ¨¡å¼éµå¾ªçš„å…­å¤§åŸåˆ™"><a href="#äºŒã€è®¾è®¡æ¨¡å¼éµå¾ªçš„å…­å¤§åŸåˆ™" class="headerlink" title="äºŒã€è®¾è®¡æ¨¡å¼éµå¾ªçš„å…­å¤§åŸåˆ™"></a>äºŒã€è®¾è®¡æ¨¡å¼éµå¾ªçš„å…­å¤§åŸåˆ™</h2><h3 id="2-1ã€å¼€é—­åŸåˆ™"><a href="#2-1ã€å¼€é—­åŸåˆ™" class="headerlink" title="2.1ã€å¼€é—­åŸåˆ™"></a>2.1ã€å¼€é—­åŸåˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong></p><p>å¼€é—­åŸåˆ™æ˜¯æœ€åŸºç¡€çš„ä¸€ä¸ªåŸåˆ™ï¼Œå…¶ä»– 5 ä¸ªåŸåˆ™éƒ½æ˜¯å¼€é—­åŸåˆ™çš„å…·ä½“å½¢æ€ï¼Œè€Œå¼€é—­åŸåˆ™æ‰æ˜¯çœŸæ­£çš„ç²¾ç¥é¢†è¢–</p><p>ä¸¾ä¸ªä¹¦åº—å–ä¹¦çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¹¦ç±çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IBook</span> &#123;<br><br>    <span class="hljs-comment">//åç§°</span><br>    String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">//ä»·æ ¼</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">//ä½œåˆ™</span><br>    String <span class="hljs-title function_">getAuthor</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å…·ä½“å®ç°ç±»ï¼šå°è¯´ä¹¦</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NovelBook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IBook</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> price;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String author;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">NovelBook</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> price, String author)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.price = price;<br>        <span class="hljs-built_in">this</span>.author = author;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> price;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAuthor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> author;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€ä¹¦åº—ï¼Œæ¨¡æ‹Ÿå–ä¹¦</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BookStore</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> List&lt;IBook&gt; BOOK_LIST = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NovelBook</span>(<span class="hljs-string">&quot;å¤©é¾™å…«éƒ¨&quot;</span>, <span class="hljs-number">3200</span>, <span class="hljs-string">&quot;é‡‘åº¸&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NovelBook</span>(<span class="hljs-string">&quot;å·´é»åœ£æ¯é™¢&quot;</span>, <span class="hljs-number">3300</span>, <span class="hljs-string">&quot;é›¨æœ&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NovelBook</span>(<span class="hljs-string">&quot;æ‚²æƒ¨ä¸–ç•Œ&quot;</span>, <span class="hljs-number">3400</span>, <span class="hljs-string">&quot;é›¨æœ&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NovelBook</span>(<span class="hljs-string">&quot;æ°´æµ’ä¼ &quot;</span>, <span class="hljs-number">3500</span>, <span class="hljs-string">&quot;æ–½è€åºµ&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">NumberFormat</span> <span class="hljs-variable">numberFormat</span> <span class="hljs-operator">=</span> NumberFormat.getCurrencyInstance();<br>        numberFormat.setMaximumFractionDigits(<span class="hljs-number">2</span>);<br>        System.out.println(<span class="hljs-string">&quot;ä¹¦åº—å–å‡ºçš„ä¹¦ç±å¦‚ä¸‹: &quot;</span>);<br>        <span class="hljs-keyword">for</span> (IBook book : BOOK_LIST) &#123;<br>            System.out.println(<span class="hljs-string">&quot;ä¹¦ç±åç§°ï¼š &quot;</span> + book.getName() <br>                               + <span class="hljs-string">&quot;\tä¹¦ç±ä½œè€…ï¼š &quot;</span> + book.getAuthor() <br>                               + <span class="hljs-string">&quot;\tä¹¦ç±ä»·æ ¼ï¼š &quot;</span> + numberFormat.format(book.getPrice() / <span class="hljs-number">100</span>) + <span class="hljs-string">&quot;å…ƒ&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ä¹¦åº—å–å‡ºçš„ä¹¦ç±å¦‚ä¸‹: <br>ä¹¦ç±åç§°ï¼š å¤©é¾™å…«éƒ¨ä¹¦ç±ä½œè€…ï¼š é‡‘åº¸ä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">32.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š å·´é»åœ£æ¯é™¢ä¹¦ç±ä½œè€…ï¼š é›¨æœä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">33.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š æ‚²æƒ¨ä¸–ç•Œä¹¦ç±ä½œè€…ï¼š é›¨æœä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">34.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š æ°´æµ’ä¼ ä¹¦ç±ä½œè€…ï¼š æ–½è€åºµä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">35.00</span>å…ƒ<br><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å°±å®ç°äº†ä¹¦åº—æ¨¡æ‹Ÿä¹°ä¹¦çš„æƒ…å†µï¼Œä½†æ˜¯å¦‚æœæˆ‘è¦æä¸ªæ‰“æŠ˜æ´»åŠ¨ï¼Œä¸Šé¢çš„åŠŸèƒ½æ˜¯ä¸æ”¯æŒçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹ç¨‹åºå»æ‰©å±•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç»§æ‰¿å½“å‰ä¹¦ç±çš„å®ç°ç±»ï¼Œå¯¹è·å–ä»·æ ¼çš„æ–¹æ³•è¿›è¡Œä¿®æ”¹æ‰“æŠ˜</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OffNovelBook</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">NovelBook</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OffNovelBook</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> price, String author)</span> &#123;<br>        <span class="hljs-built_in">super</span>(name, price, author);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">originPrice</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.getPrice();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">offPrice</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-comment">//å¤§äº 34 å—ï¼Œæ‰“ 8 æŠ˜ï¼Œå¦åˆ™æ‰“ 9 æŠ˜</span><br>        <span class="hljs-keyword">if</span>(originPrice &gt; <span class="hljs-number">3400</span>)&#123;<br>            offPrice = (<span class="hljs-type">int</span>) (originPrice * <span class="hljs-number">0.8</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            offPrice = (<span class="hljs-type">int</span>) (originPrice * <span class="hljs-number">0.9</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> offPrice;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BookStore</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> List&lt;IBook&gt; BOOK_LIST = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OffNovelBook</span>(<span class="hljs-string">&quot;å¤©é¾™å…«éƒ¨&quot;</span>, <span class="hljs-number">3200</span>, <span class="hljs-string">&quot;é‡‘åº¸&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OffNovelBook</span>(<span class="hljs-string">&quot;å·´é»åœ£æ¯é™¢&quot;</span>, <span class="hljs-number">3300</span>, <span class="hljs-string">&quot;é›¨æœ&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OffNovelBook</span>(<span class="hljs-string">&quot;æ‚²æƒ¨ä¸–ç•Œ&quot;</span>, <span class="hljs-number">3400</span>, <span class="hljs-string">&quot;é›¨æœ&quot;</span>));<br>        BOOK_LIST.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OffNovelBook</span>(<span class="hljs-string">&quot;æ°´æµ’ä¼ &quot;</span>, <span class="hljs-number">3500</span>, <span class="hljs-string">&quot;æ–½è€åºµ&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">NumberFormat</span> <span class="hljs-variable">numberFormat</span> <span class="hljs-operator">=</span> NumberFormat.getCurrencyInstance();<br>        numberFormat.setMaximumFractionDigits(<span class="hljs-number">2</span>);<br>        System.out.println(<span class="hljs-string">&quot;ä¹¦åº—å–å‡ºçš„ä¹¦ç±å¦‚ä¸‹: &quot;</span>);<br>        <span class="hljs-keyword">for</span> (IBook book : BOOK_LIST) &#123;<br>            System.out.println(<span class="hljs-string">&quot;ä¹¦ç±åç§°ï¼š &quot;</span> + book.getName() + <span class="hljs-string">&quot;\tä¹¦ç±ä½œè€…ï¼š &quot;</span> + book.getAuthor() + <span class="hljs-string">&quot;\tä¹¦ç±ä»·æ ¼ï¼š &quot;</span> + numberFormat.format(book.getPrice() / <span class="hljs-number">100</span>) + <span class="hljs-string">&quot;å…ƒ&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ä¹¦åº—å–å‡ºçš„ä¹¦ç±å¦‚ä¸‹: <br>ä¹¦ç±åç§°ï¼š å¤©é¾™å…«éƒ¨ä¹¦ç±ä½œè€…ï¼š é‡‘åº¸ä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">28.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š å·´é»åœ£æ¯é™¢ä¹¦ç±ä½œè€…ï¼š é›¨æœä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">29.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š æ‚²æƒ¨ä¸–ç•Œä¹¦ç±ä½œè€…ï¼š é›¨æœä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">30.00</span>å…ƒ<br>ä¹¦ç±åç§°ï¼š æ°´æµ’ä¼ ä¹¦ç±ä½œè€…ï¼š æ–½è€åºµä¹¦ç±ä»·æ ¼ï¼š ï¿¥<span class="hljs-number">28.00</span>å…ƒ<br><br></code></pre></td></tr></table></figure><h3 id="2-2ã€é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#2-2ã€é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="2.2ã€é‡Œæ°æ›¿æ¢åŸåˆ™"></a>2.2ã€é‡Œæ°æ›¿æ¢åŸåˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>ä½¿ç”¨åŸºç±»çš„åœ°æ–¹å¯ä»¥ä½¿ç”¨å­ç±»æ›¿æ¢</strong></p><p>ä»¥å£«å…µæ‹¿æªå‡»æ€æ•Œäººä¸ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¸€ä¸€ä¸ªä½¿ç”¨æªçš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AbstractGun</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">shoot</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å…·ä½“å®ç°1ï¼šæ‰‹æª</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HandGun</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AbstractGun</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shoot</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰‹æªå°„å‡»&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å…·ä½“å®ç°2ï¼šæœºæª</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MachineGun</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AbstractGun</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shoot</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æœºæªå°„å‡»&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å…·ä½“å®ç°3ï¼šæ­¥æª</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RifleGun</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AbstractGun</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shoot</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ­¥æªå°„å‡»&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®šä¹‰ä¸€ä¸ªå£«å…µ </span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Soldier</span> &#123;<br>    <span class="hljs-comment">//æŒæœ‰çš„æª</span><br>    <span class="hljs-keyword">private</span> AbstractGun gun;<br><br>    <span class="hljs-comment">//è®¾ç½®æª</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAbstractGun</span><span class="hljs-params">(AbstractGun gun)</span>&#123;<br>        <span class="hljs-built_in">this</span>.gun = gun;<br>    &#125;<br><br>    <span class="hljs-comment">//å‡»æ€æ•Œäºº</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">killEnemy</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹killæ•Œäºº&quot;</span>);<br>        <span class="hljs-built_in">this</span>.gun.shoot();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€å®¢æˆ·ç«¯æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå£«å…µçš„å®ä¾‹</span><br>        <span class="hljs-type">Soldier</span> <span class="hljs-variable">soldier</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Soldier</span>();<br>      <span class="hljs-comment">//è®¾ç½®æª åŸºç±»å­˜åœ¨çš„åœ°æ–¹å¯ä»¥ç”¨å­ç±»æ›¿æ¢å…·ä½“ä½“ç°</span><br>        soldier.setAbstractGun(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HandGun</span>());<br>      <span class="hljs-comment">//å‡»æ€æ•Œäºº</span><br>        soldier.killEnemy();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¼€å§‹killæ•Œäºº<br>æ‰‹æªå°„å‡»<br></code></pre></td></tr></table></figure><p>UMLç±»å›¾å¦‚ä¸‹:</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7aac98dc35094cb7aec882d1d622f81e~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210302200400755" style="zoom:100%;" width="100%"/><h3 id="2-3ã€ä¾èµ–å€’ç½®åŸåˆ™"><a href="#2-3ã€ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="2.3ã€ä¾èµ–å€’ç½®åŸåˆ™"></a>2.3ã€ä¾èµ–å€’ç½®åŸåˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>é¢å‘æ¥å£ç¼–ç¨‹</strong></p><p>ä¸¾ä¸ªå¸æœºå¼€è½¦çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¼€è½¦çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ICar</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼€è½¦</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¼€è½¦çš„å¸æœºæ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IDriver</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼€è½¦</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> iCar ICaræ¥å£</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">driver</span><span class="hljs-params">(ICar iCar)</span>;<br>&#125;<br><br><span class="hljs-comment">//å¼€è½¦çš„å…·ä½“å®ç°ç±»1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Benz</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ICar</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å¥”é©°è½¦&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å¼€è½¦çš„å…·ä½“å®ç°ç±»1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BWM</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ICar</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å®é©¬è½¦&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å¸æœºçš„å…·ä½“å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Driver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDriver</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">driver</span><span class="hljs-params">(ICar iCar)</span> &#123;<br>        iCar.run();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">//å®šä¹‰æ¥å£å¼•ç”¨ï¼Œå…·ä½“å®ç°åˆ™æ˜¯å¯¹åº”æ¥å£çš„å®ç°ç±»ï¼Œè¿™å°±æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ï¼Œå³å¤šæ€ï¼Œå®ç°ç±»ä¹‹é—´ä¸ç›´æ¥å‘ç”Ÿä¾èµ–å…³ç³»</span><br>        <span class="hljs-type">IDriver</span> <span class="hljs-variable">iDriver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Driver</span>();<br>        <span class="hljs-type">ICar</span> <span class="hljs-variable">benz</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Benz</span>();<br>        iDriver.driver(benz);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¼€å¥”é©°è½¦<br></code></pre></td></tr></table></figure><h3 id="2-4ã€è¿ªç±³ç‰¹æ³•åˆ™"><a href="#2-4ã€è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="2.4ã€è¿ªç±³ç‰¹æ³•åˆ™"></a>2.4ã€è¿ªç±³ç‰¹æ³•åˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>ä¸€ä¸ªå¯¹è±¡å¯¹å¦ä¸€ä¸ªå¯¹è±¡åº”è¯¥å°½å¯èƒ½å°‘çš„äº†è§£</strong></p><p>ä¾‹å¦‚ï¼šè€å¸ˆå‘½ä»¤ç­é•¿æ¸…ç‚¹å­¦ç”Ÿäººæ•°ï¼Œé‚£ä¹ˆè€å¸ˆåªæœ‰å’Œç­é•¿æœ‰äº¤æµï¼Œä¸‹è¾¾è¿™ä¸ªå‘½ä»¤ç»™ç­é•¿ï¼Œå…¶ä½™çš„äº‹æƒ…äº¤ç»™ç­é•¿åšå°±è¡Œäº†ï¼Œå…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å­¦ç”Ÿ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//ç­é•¿</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassLeader</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Student&gt; studentList;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassLeader</span><span class="hljs-params">(List&lt;Student&gt; studentList)</span> &#123;<br>        <span class="hljs-built_in">this</span>.studentList = studentList;<br>    &#125;<br><br>    <span class="hljs-comment">//æ¸…ç‚¹å­¦ç”Ÿäººæ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">countStudentList</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å­¦ç”Ÿçš„äººæ•°æ˜¯: &quot;</span> + studentList.size());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è€å¸ˆ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span> &#123;<br>    <span class="hljs-comment">//ä¸‹è¾¾å‘½ä»¤ç»™ç­é•¿</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">command</span><span class="hljs-params">(ClassLeader classLeader)</span>&#123;<br>        classLeader.countStudentList();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;Student&gt; studentList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span>; i++) &#123;<br>            studentList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>());<br>        &#125;<br>        <span class="hljs-type">ClassLeader</span> <span class="hljs-variable">classLeader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassLeader</span>(studentList);<br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>();<br>        teacher.command(classLeader);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å­¦ç”Ÿçš„äººæ•°æ˜¯: <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><h3 id="2-5ã€æ¥å£éš”ç¦»åŸåˆ™"><a href="#2-5ã€æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="2.5ã€æ¥å£éš”ç¦»åŸåˆ™"></a>2.5ã€æ¥å£éš”ç¦»åŸåˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>ä½¿ç”¨å¤šä¸ªæ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæ¥å£è¦å¥½</strong></p><p>ä¾‹å¦‚ï¼šæ¯ä¸ªäººçš„å®¡ç¾è§‚ä¸ä¸€æ ·ï¼Œå¼ ä¸‰è®¤ä¸ºé¢œå€¼é«˜å°±æ˜¯ç¾å¥³ï¼Œå³ä½¿èº«æå’Œæ°”è´¨ä¸€èˆ¬ï¼›æå››è®¤ä¸ºèº«æå¥½å°±è¡Œï¼Œä¸åœ¨ä¹é¢œå€¼å’Œæ°”è´¨ï¼›è€Œç‹äº”åˆ™è®¤ä¸ºé¢œå€¼å’Œèº«æéƒ½æ˜¯å¤–åœ¨ï¼Œåªè¦æœ‰æ°”è´¨ï¼Œé‚£å°±æ˜¯ç¾å¥³ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±è¦åˆ†å¼€çš„å»å®šä¹‰æ¥å£äº†ï¼Œä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é¢œå€¼é«˜</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IGoodLookingGirl</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">goodLooking</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//æ°”è´¨å‡ºä¼—</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IGreatTemperamentGirl</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">greatTemperament</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//èº«æå¥½</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">INiceFigureGirl</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">niceFigure</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PrettyGirl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IGoodLookingGirl</span>,IGreatTemperamentGirl,INiceFigureGirl&#123;<br><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PrettyGirl</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">goodLooking</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot;é¢œå€¼å¾ˆé«˜&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">greatTemperament</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot;æ°”è´¨å‡ºä¼—&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">niceFigure</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot;èº«æå¾ˆå¥½&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æœç´¢æŠ½è±¡ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractSearcher</span> &#123;<br><br>    <span class="hljs-keyword">protected</span> IGoodLookingGirl goodLookingGirl;<br>    <span class="hljs-keyword">protected</span> IGreatTemperamentGirl greatTemperamentGirl;<br>    <span class="hljs-keyword">protected</span> INiceFigureGirl niceFigureGirl;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AbstractSearcher</span><span class="hljs-params">(IGoodLookingGirl goodLookingGirl, IGreatTemperamentGirl greatTemperamentGirl, INiceFigureGirl niceFigureGirl)</span> &#123;<br>        <span class="hljs-built_in">this</span>.goodLookingGirl = goodLookingGirl;<br>        <span class="hljs-built_in">this</span>.greatTemperamentGirl = greatTemperamentGirl;<br>        <span class="hljs-built_in">this</span>.niceFigureGirl = niceFigureGirl;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“æœç´¢å®ç°</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Searcher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractSearcher</span> &#123;<br>    <br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Searcher</span><span class="hljs-params">(IGoodLookingGirl goodLookingGirl, IGreatTemperamentGirl greatTemperamentGirl, INiceFigureGirl niceFigureGirl)</span> &#123;<br>        <span class="hljs-built_in">super</span>(goodLookingGirl, greatTemperamentGirl, niceFigureGirl);<br> &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ç¾å¥³ä¿¡æ¯å¦‚ä¸‹: &quot;</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">super</span>.goodLookingGirl != <span class="hljs-literal">null</span>)<br>        <span class="hljs-built_in">super</span>.goodLookingGirl.goodLooking();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">super</span>.niceFigureGirl != <span class="hljs-literal">null</span>)<br>        <span class="hljs-built_in">super</span>.niceFigureGirl.niceFigure();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">super</span>.greatTemperamentGirl != <span class="hljs-literal">null</span>)<br>        <span class="hljs-built_in">super</span>.greatTemperamentGirl.greatTemperament();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-type">PrettyGirl</span> <span class="hljs-variable">prettyGirl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrettyGirl</span>(<span class="hljs-string">&quot;lily&quot;</span>);<br>      <span class="hljs-type">Searcher</span> <span class="hljs-variable">searcher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Searcher</span>(prettyGirl,prettyGirl,<span class="hljs-literal">null</span>);<br>      searcher.show();<br>   &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç¾å¥³ä¿¡æ¯å¦‚ä¸‹: <br>lilyé¢œå€¼å¾ˆé«˜<br>lilyæ°”è´¨å‡ºä¼—<br></code></pre></td></tr></table></figure><h3 id="2-6ã€å•ä¸€èŒè´£åŸåˆ™"><a href="#2-6ã€å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="2.6ã€å•ä¸€èŒè´£åŸåˆ™"></a>2.6ã€å•ä¸€èŒè´£åŸåˆ™</h3><p>ç®€å•ç†è§£ï¼š<strong>ä¸€ä¸ªç±»æˆ–æ¥å£åªè´Ÿè´£ä¸€ä»¶äº‹æƒ…</strong></p><p>ä¾‹å¦‚ï¼šä»¥æ‰“ç”µè¯ä¸ºä¾‹ï¼Œæ‰“ç”µè¯å¤§è‡´æµç¨‹åˆ†ä¸ºï¼šæ‹¨å·ï¼Œé€šè¯ï¼ŒæŒ‚æ–­ã€‚æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªæ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPhone</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‹¨å·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">dial</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŒ‚æ–­</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">hangUp</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªæ¥å£è®¾è®¡çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å…·ä½“åˆ†æä¸€ä¸‹ï¼Œæ‹¨å·å’ŒæŒ‚æ–­å±äºåè®®è¿æ¥ï¼Œé€šè¯å±äºæ•°æ®ä¼ é€ï¼Œä¸€ä¸ªæ¥å£é‡Œé¢æ‰¿æ‹…äº†ä¸¤ä¸ªèŒè´£ï¼Œè¿™æ˜¯ä¸ç¬¦åˆå•ä¸€èŒè´£çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ”¹é€ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IConnectionManage</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‹¨å·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">dial</span><span class="hljs-params">()</span>;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŒ‚æ–­</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">hangUp</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IDataTransform</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°†å…¶æ‹†åˆ†æˆä¸¤ä¸ªæ¥å£ï¼Œæ¯ä¸ªæ¥å£åªæ‰¿æ‹…ä¸€ä¸ªèŒè´£ï¼Œè¿™æ ·å°±å®Œç¾äº†</p><h2 id="ä¸‰ã€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼"><a href="#ä¸‰ã€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼" class="headerlink" title="ä¸‰ã€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼"></a>ä¸‰ã€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼</h2><h3 id="3-1ã€å·¥å‚æ¨¡å¼"><a href="#3-1ã€å·¥å‚æ¨¡å¼" class="headerlink" title="3.1ã€å·¥å‚æ¨¡å¼"></a>3.1ã€å·¥å‚æ¨¡å¼</h3><p>å·¥å‚æ¨¡å¼ä¸æ˜¯ä¸€ç§å•ç‹¬çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œæ˜¯3ç§åŠŸèƒ½ç›¸è¿‘çš„è®¾è®¡æ¨¡å¼çš„æ€»ç§°ï¼Œå¦‚ä¸‹ï¼š</p><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬ä»¥åˆ›å»ºå£ç½©ä¸ºä¾‹å­æ¥è¯´æ˜ï¼š</p><h4 id="3-1-1ã€ç®€å•å·¥å‚æ¨¡å¼"><a href="#3-1-1ã€ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="3.1.1ã€ç®€å•å·¥å‚æ¨¡å¼"></a>3.1.1ã€ç®€å•å·¥å‚æ¨¡å¼</h4><p>å®šä¹‰ï¼š<strong>ç®€å•å·¥å‚æ¨¡å¼æ‹¥æœ‰å”¯ä¸€çš„å·¥å‚ç±»ï¼Œå·¥å‚ç±»æ ¹æ®ä¼ å…¥çš„å‚æ•°ç»è¿‡ if-else æ¡ä»¶åˆ¤æ–­å†³å®šå»åˆ›å»ºå“ªä¸ªäº§å“</strong></p><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå£ç½©çš„æ¥å£ï¼Œå®ƒä¸‹é¢æœ‰é«˜ç«¯å£ç½©å’Œä½ç«¯å£ç½©ä¸¤ç§äº§å“å­ç±»ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼å»åˆ›å»ºä»–ä»¬ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå£ç½©çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IMask</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œé«˜ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯é«˜ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œä½ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ä½ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç®€å•å·¥å‚æ‹¥æœ‰å”¯ä¸€çš„å·¥å‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MaskFactory</span>&#123;<br>    <span class="hljs-keyword">public</span> IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">(String type)</span>&#123;<br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mask</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;é«˜ç«¯å£ç½©&quot;</span>.equals(type))&#123;<br>            mask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighMask</span>();<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;ä½ç«¯å£ç½©&quot;</span>.equals(type))&#123;<br>            mask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowMask</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> mask;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">MaskFactory</span> <span class="hljs-variable">maskFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MaskFactory</span>();<br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mHighMask</span> <span class="hljs-operator">=</span> maskFactory.createMask(<span class="hljs-string">&quot;é«˜ç«¯å£ç½©&quot;</span>);<br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mLowMask</span> <span class="hljs-operator">=</span> maskFactory.createMask(<span class="hljs-string">&quot;ä½ç«¯å£ç½©&quot;</span>);<br>        mHighMask.show();<br>        mLowMask.show();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯é«˜ç«¯å£ç½©<br>æˆ‘æ˜¯ä½ç«¯å£ç½©<br></code></pre></td></tr></table></figure><p><strong>ç¼ºç‚¹:</strong>  å½“æˆ‘æ–°å¢äº§å“å­ç±»åˆè¦å»æ–°å¢if-elseæ¡ä»¶åˆ¤æ–­ï¼Œä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼</p><h4 id="3-1-2ã€å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#3-1-2ã€å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="3.1.2ã€å·¥å‚æ–¹æ³•æ¨¡å¼"></a>3.1.2ã€å·¥å‚æ–¹æ³•æ¨¡å¼</h4><p>å®šä¹‰ï¼š<strong>å·¥å‚æ–¹æ³•æ¨¡å¼æ‹¥æœ‰å¤šä¸ªå·¥å‚ï¼Œåˆ©ç”¨å¤šæ€å»åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ï¼Œé¿å…äº†ç®€å•å·¥å‚æ¨¡å¼å†—ä½™çš„ if-else æ¡ä»¶åˆ¤æ–­</strong></p><p>æˆ‘ä»¬ç»™ä¸åŒçš„äº§å“å­ç±»åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå£ç½©çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IMask</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œé«˜ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯é«˜ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œä½ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ä½ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ç”Ÿäº§å£ç½©çš„å·¥å‚æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IMaskFactory</span>&#123;<br>    IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//é«˜ç«¯å£ç½©å·¥å‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighMaskFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMaskFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighMask</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä½ç«¯å£ç½©å·¥å‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowMaskFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMaskFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowMask</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">IMaskFactory</span> <span class="hljs-variable">mHighMaskFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighMaskFactory</span>();<br>        <span class="hljs-type">IMaskFactory</span> <span class="hljs-variable">mLowMaskFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowMaskFactory</span>();<br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mHighMask</span> <span class="hljs-operator">=</span> mHighMaskFactory.createMask();<br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mLowMask</span> <span class="hljs-operator">=</span> mLowMaskFactory.createMask();<br>        mHighMask.show();<br>        mLowMask.show();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯é«˜ç«¯å£ç½©<br>æˆ‘æ˜¯ä½ç«¯å£ç½©<br></code></pre></td></tr></table></figure><p><strong>ç¼ºç‚¹ï¼š</strong> å½“æˆ‘æ–°å¢çš„ä¸åŒç±»å‹çš„äº§å“ï¼Œä¾‹å¦‚é˜²æŠ¤æœï¼Œè€Œä¸”ä¹Ÿåˆ†ä¸ºé«˜ç«¯é˜²æŠ¤æœå’Œä½ç«¯é˜²æŠ¤æœï¼Œä¾æ¬¡ç±»æ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬é’ˆå¯¹è¿™äº›äº§å“å­ç±»éƒ½éœ€è¦å»åˆ›å»ºä¸€ä¸ªå·¥å‚å­ç±»ï¼Œå·¥å‚å­ç±»å°†ä¼šå˜çš„éå¸¸å¤šï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼</p><h4 id="3-1-3ã€æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#3-1-3ã€æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="3.1.3ã€æŠ½è±¡å·¥å‚æ¨¡å¼"></a>3.1.3ã€æŠ½è±¡å·¥å‚æ¨¡å¼</h4><p>å®šä¹‰ï¼š<strong>æŠ½è±¡å·¥å‚æ¨¡å¼ä¼šæŠŠä¸åŒäº§å“å­ç±»è¿›è¡Œåˆ†ç»„ï¼Œç»„å†…ä¸åŒçš„äº§å“å­ç±»å¯¹åº”åŒä¸€ä¸ªå·¥å‚å­ç±»çš„ä¸åŒåˆ›å»ºæ–¹æ³•ï¼Œè¿™æ ·å°±å‡å°‘äº†å·¥å‚å­ç±»çš„åˆ›å»º</strong></p><p>ä¾‹å¦‚æˆ‘ä»¬åˆšæ‰è¯´çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åˆæ–°å¢äº†é«˜ç«¯é˜²æŠ¤æœå’Œä½ç«¯é˜²æŠ¤æœï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ’åˆ†é«˜ç«¯äº§å“å’Œä½ç«¯äº§å“ä¸¤ä¸ªåˆ†ç»„ï¼Œé«˜ç«¯äº§å“åŒ…æ‹¬é«˜ç«¯å£ç½©å’Œé«˜ç«¯é˜²æŠ¤æœï¼Œä½ç«¯äº§å“åŒ…æ‹¬ä½ç«¯å£ç½©å’Œä½ç«¯é˜²æŠ¤æœï¼Œé’ˆå¯¹è¿™ä¸ªäº§å“åˆ†ç»„ï¼Œæˆ‘ä»¬å°±åªéœ€è¦åˆ›å»ºé«˜ç«¯å·¥å‚å’Œä½ç«¯å·¥å‚å°±okäº†ï¼Œè¿™æ ·å°±å‡å°‘äº†å·¥å‚å­ç±»çš„åˆ›å»ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå£ç½©çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IMask</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œé«˜ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯é«˜ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å£ç½©çš„å…·ä½“å®ç°ï¼Œä½ç«¯å£ç½©</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowMask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMask</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ä½ç«¯å£ç½©&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰é˜²æŠ¤æœçš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IProtectiveSuit</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//é˜²æŠ¤æœçš„å…·ä½“å®ç°ï¼Œé«˜ç«¯é˜²æŠ¤æœ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighProtectiveSuit</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IProtectiveSuit</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯é«˜ç«¯é˜²æŠ¤æœ&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//é˜²æŠ¤æœçš„å…·ä½“å®ç°ï¼Œä½ç«¯é˜²æŠ¤æœ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowProtectiveSuit</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IProtectiveSuit</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ä½ç«¯é˜²æŠ¤æœ&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰å·¥å‚æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFactory</span>&#123;<br>    IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span>;<br>    IProtectiveSuit <span class="hljs-title function_">createSuit</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//é«˜ç«¯å·¥å‚</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HighFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighMask</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IProtectiveSuit <span class="hljs-title function_">createSuit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighProtectiveSuit</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä½ç«¯å·¥å‚</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LowFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IMask <span class="hljs-title function_">createMask</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowMask</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IProtectiveSuit <span class="hljs-title function_">createSuit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowProtectiveSuit</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">IFactory</span> <span class="hljs-variable">mHighFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HighFactory</span>();<br>        <span class="hljs-type">IFactory</span> <span class="hljs-variable">mLowFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LowFactory</span>();<br><br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mHighMask</span> <span class="hljs-operator">=</span> mHighFactory.createMask();<br>        <span class="hljs-type">IProtectiveSuit</span> <span class="hljs-variable">mHighProtectiveSuit</span> <span class="hljs-operator">=</span> mHighFactory.createSuit();<br><br>        <span class="hljs-type">IMask</span> <span class="hljs-variable">mLowMask</span> <span class="hljs-operator">=</span> mLowFactory.createMask();<br>        <span class="hljs-type">IProtectiveSuit</span> <span class="hljs-variable">mLowProtectiveSuit</span> <span class="hljs-operator">=</span> mLowFactory.createSuit();<br><br>        mHighMask.show();<br>        mHighProtectiveSuit.show();<br>        mLowMask.show();<br>        mLowProtectiveSuit.show();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯é«˜ç«¯å£ç½©<br>æˆ‘æ˜¯é«˜ç«¯é˜²æŠ¤æœ<br>æˆ‘æ˜¯ä½ç«¯å£ç½©<br>æˆ‘æ˜¯ä½ç«¯é˜²æŠ¤æœ<br></code></pre></td></tr></table></figure><h4 id="3-1-4ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„å¼‚åŒ"><a href="#3-1-4ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„å¼‚åŒ" class="headerlink" title="3.1.4ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„å¼‚åŒ"></a>3.1.4ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„å¼‚åŒ</h4><p>å¼‚ï¼š</p><blockquote><p>1ã€å·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯å•ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼é’ˆå¯¹çš„æ˜¯å¤šä¸ªäº§å“çš„ç­‰çº§ç»“æ„</p><p>2ã€å·¥å‚æ–¹æ³•æ¨¡å¼æ¯ä¸ªå…·ä½“çš„å·¥å‚åªèƒ½åˆ›å»ºä¸€ç§äº§å“å¯¹è±¡ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„å…·ä½“å·¥å‚èƒ½åˆ›å»ºå¤šä¸ªäº§å“å¯¹è±¡</p></blockquote><p>åŒï¼š</p><blockquote><p>1ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„æŠ½è±¡äº§å“éƒ½æ‹¥æœ‰å¤šä¸ªå…·ä½“çš„å®ç°äº§å“</p><p>2ã€å·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼çš„æŠ½è±¡å·¥å‚ç±»éƒ½æœ‰å¤šä¸ªå…·ä½“çš„å®ç°å·¥å‚ç±»</p></blockquote><h3 id="3-2ã€ç­–ç•¥æ¨¡å¼"><a href="#3-2ã€ç­–ç•¥æ¨¡å¼" class="headerlink" title="3.2ã€ç­–ç•¥æ¨¡å¼"></a>3.2ã€ç­–ç•¥æ¨¡å¼</h3><p>å®šä¹‰ï¼š<strong>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼Œå¹¶å¯ä»¥å®ç°è‡ªç”±çš„åˆ‡æ¢</strong></p><p>ä¸¾ä¸ªå¤è£…å¤§ä¾ æ‰“æ–—çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæ”»å‡»æ‹›å¼çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IAttack</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å®šä¸€ä¸ªæŠ½è±¡çš„è§’è‰²ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Role</span>&#123;<br><br>    <span class="hljs-keyword">protected</span> String name;<br>    <span class="hljs-keyword">private</span> IAttack iAttack;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Role</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setiAttack</span><span class="hljs-params">(IAttack iAttack)</span> &#123;<br>        <span class="hljs-built_in">this</span>.iAttack = iAttack;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span>&#123;<br>        iAttack.attack();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“è§’è‰²ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRole</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Role</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyRole</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ”»å‡»æ‹›å¼çš„å…·ä½“å®ç°</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAttack</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IAttack</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;é™é¾™åå…«æŒ&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ”»å‡»æ‹›å¼çš„å…·ä½“å®ç°</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAttack2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IAttack</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¹¾å¤å¤§æŒªç§»&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StrategyClient2</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">MyRole</span> <span class="hljs-variable">myRole</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRole</span>(<span class="hljs-string">&quot;ä¹”å³°&quot;</span>);<br>        myRole.setiAttack(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyAttack</span>());<br>      <span class="hljs-comment">//å…·ä½“ä½¿ç”¨ä»€ä¹ˆæ‹›å¼æ”»å‡» ç”±å®¢æˆ·ç«¯è‡ªå·±å†³å®š</span><br>      <span class="hljs-comment">//myRole.setiAttack(new MyAttack2());</span><br>        System.out.println(myRole.name + <span class="hljs-string">&quot;: &quot;</span>);<br>        myRole.attack();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ä¹”å³°: <br>é™é¾™åå…«æŒ<br></code></pre></td></tr></table></figure><h3 id="3-3ã€çŠ¶æ€æ¨¡å¼"><a href="#3-3ã€çŠ¶æ€æ¨¡å¼" class="headerlink" title="3.3ã€çŠ¶æ€æ¨¡å¼"></a>3.3ã€çŠ¶æ€æ¨¡å¼</h3><p>å®šä¹‰ï¼š<strong>å¯¹è±¡å†…éƒ¨çŠ¶æ€çš„æ”¹å˜ä¼šæ”¹å˜å…¶è¡Œä¸º</strong></p><p>ä¸¾ä¸ªç”µè§†æœºå¼€å…³æœºçš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ç”µè§†æœºçš„çŠ¶æ€</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TvState</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">nextChannel</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">prevChannel</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnUp</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnDown</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“å®ç° å…³æœºçŠ¶æ€</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerOfferState</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TvState</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nextChannel</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prevChannel</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnUp</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnDown</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“å®ç° å¼€æœºçŠ¶æ€</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerOnState</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TvState</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nextChannel</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸‹ä¸€ä¸ªé¢‘é“&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prevChannel</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸Šä¸€ä¸ªé¢‘é“&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnUp</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è°ƒé«˜éŸ³é‡&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnDown</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è°ƒä½éŸ³é‡&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç”µæºæ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">PowerController</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//ç”µè§†é¥æ§å™¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TvController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PowerController</span>&#123;<br><br>    <span class="hljs-keyword">private</span> TvState tvState;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTvState</span><span class="hljs-params">(TvState tvState)</span> &#123;<br>        <span class="hljs-built_in">this</span>.tvState = tvState;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> &#123;<br>        setTvState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PowerOfferState</span>());<br>        System.out.println(<span class="hljs-string">&quot;å…³æœºäº†&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> &#123;<br>        setTvState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PowerOnState</span>());<br>        System.out.println(<span class="hljs-string">&quot;å¼€æœºäº†&quot;</span>);<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nextChannel</span><span class="hljs-params">()</span> &#123;<br>        tvState.nextChannel();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prevChannel</span><span class="hljs-params">()</span> &#123;<br>        tvState.prevChannel();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnUp</span><span class="hljs-params">()</span> &#123;<br>        tvState.turnUp();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnDown</span><span class="hljs-params">()</span> &#123;<br>        tvState.turnDown();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StateClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">TvController</span> <span class="hljs-variable">tvController</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TvController</span>();<br>        tvController.powerOn();<br>        tvController.nextChannel();<br>        tvController.turnUp();<br>        tvController.powerOff();<br>        tvController.turnUp();<br>        tvController.prevChannel();<br>        tvController.turnDown();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¼€æœºäº†<br>ä¸‹ä¸€ä¸ªé¢‘é“<br>è°ƒé«˜éŸ³é‡<br>å…³æœºäº†<br></code></pre></td></tr></table></figure><h3 id="3-4ã€ä»£ç†æ¨¡å¼"><a href="#3-4ã€ä»£ç†æ¨¡å¼" class="headerlink" title="3.4ã€ä»£ç†æ¨¡å¼"></a>3.4ã€ä»£ç†æ¨¡å¼</h3><p>ä»£ç†æ¨¡å¼ä¸»è¦æ˜¯ä½¿ç”¨ä»£ç†å¯¹è±¡åŠ«æŒåŸå§‹å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹åŸå§‹å¯¹è±¡çš„æ§åˆ¶</p><p>ä»£ç†æ¨¡å¼åˆ†ä¸ºï¼š</p><blockquote><p>1ã€é™æ€ä»£ç†</p><p>2ã€åŠ¨æ€ä»£ç†</p></blockquote><h4 id="3-4-1ã€é™æ€ä»£ç†"><a href="#3-4-1ã€é™æ€ä»£ç†" class="headerlink" title="3.4.1ã€é™æ€ä»£ç†"></a>3.4.1ã€é™æ€ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªä»£ç†æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITestProxy</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®ç°ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITestProxy</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•&quot;</span>);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€ä»£ç†ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITestProxy</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ITestProxy testProxy;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StaticProxy</span><span class="hljs-params">(ITestProxy testProxy)</span> &#123;<br>        <span class="hljs-built_in">this</span>.testProxy = testProxy;<br>    &#125;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;testBefore...&quot;</span>);<br>        testProxy.test();<br>        System.out.println(<span class="hljs-string">&quot;testAfter...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;loginBefore...&quot;</span>);<br>        testProxy.login();<br>        System.out.println(<span class="hljs-string">&quot;loginAfter...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        testProxy.register();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//é™æ€ä»£ç†</span><br>        <span class="hljs-type">TestProxy</span> <span class="hljs-variable">testProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestProxy</span>();<br>        <span class="hljs-type">StaticProxy</span> <span class="hljs-variable">staticProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StaticProxy</span>(testProxy);<br>        staticProxy.test();<br>        staticProxy.login();<br>        staticProxy.register();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>testBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•<br>testAfter...<br>loginBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•<br>loginAfter...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šè¿°æˆ‘ä»¬ä½¿ç”¨ä»£ç†å¯¹è±¡ StaticProxy åŠ«æŒäº†åŸå§‹å¯¹è±¡ TestProxyï¼Œå¹¶æ’å…¥äº†ä¸€äº› log æ‰“å°</p><h4 id="3-4-2ã€åŠ¨æ€ä»£ç†"><a href="#3-4-2ã€åŠ¨æ€ä»£ç†" class="headerlink" title="3.4.2ã€åŠ¨æ€ä»£ç†"></a>3.4.2ã€åŠ¨æ€ä»£ç†</h4><p>åŠ¨æ€ä»£ç†ä¸»è¦åˆ†ä¸¤ç§ï¼š</p><blockquote><p>1ã€JDK åŠ¨æ€ä»£ç†</p><p>2ã€cglib åŠ¨æ€ä»£ç†</p></blockquote><h5 id="3-4-2-1ã€JDK-åŠ¨æ€ä»£ç†"><a href="#3-4-2-1ã€JDK-åŠ¨æ€ä»£ç†" class="headerlink" title="3.4.2.1ã€JDK åŠ¨æ€ä»£ç†"></a>3.4.2.1ã€JDK åŠ¨æ€ä»£ç†</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªä»£ç†æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITestProxy</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®ç°ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITestProxy</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•&quot;</span>);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªåŠ¨æ€ä»£ç† Handler</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br><br>    <span class="hljs-keyword">final</span> Object target;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LogHandler</span><span class="hljs-params">(Object target)</span> &#123;<br>        <span class="hljs-built_in">this</span>.target = target;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;test&quot;</span>.equals(method.getName()))&#123;<br>            System.out.println(<span class="hljs-string">&quot;testBefore...&quot;</span>);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(target, args);<br>            System.out.println(<span class="hljs-string">&quot;testAfter...&quot;</span>);<br>            <span class="hljs-keyword">return</span> invoke;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;login&quot;</span>.equals(method.getName()))&#123;<br>            System.out.println(<span class="hljs-string">&quot;loginBefore...&quot;</span>);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(target, args);<br>            System.out.println(<span class="hljs-string">&quot;loginAfter...&quot;</span>);<br>            <span class="hljs-keyword">return</span> invoke;<br>        &#125;<br>        <span class="hljs-keyword">return</span> method.invoke(target,args);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//JDK åŠ¨æ€ä»£ç†</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> ITestProxy.class.getClassLoader();<br>        Class&lt;?&gt;[] interfaces = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;ITestProxy.class&#125;;<br>      <span class="hljs-comment">//åŠ¨æ€ä»£ç†å¯¹è±¡</span><br>        <span class="hljs-type">ITestProxy</span> <span class="hljs-variable">iTestProxy</span> <span class="hljs-operator">=</span> (ITestProxy) Proxy.newProxyInstance(classLoader, interfaces, <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogHandler</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TestProxy</span>()));<br>        iTestProxy.test();<br>        iTestProxy.login();<br>        iTestProxy.register();<br>    &#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>testBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•<br>testAfter...<br>loginBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•<br>loginAfter...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•<br></code></pre></td></tr></table></figure><p>åŠ¨æ€ä»£ç†ä½¿ç”¨èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå…³é”®æ–¹æ³•æ˜¯ï¼š<code>java.langlreflect</code>åŒ…ä¸‹çš„ <code>Proxy</code>çš„<code>newProxyInstance</code>æ–¹æ³•</p><p>å¦å¤–<strong>éœ€è¦æ³¨æ„</strong>ï¼š<strong>JDK åŠ¨æ€ä»£ç†ä¸­è¢«ä»£ç†å¯¹è±¡å¿…é¡»è¦å®ç°ä¸€ä¸ªæ¥å£ã€‚å¦‚æœæœ‰ä¸€ä¸ªéœ€è¦è¢«ä»£ç†çš„å¯¹è±¡æ²¡æœ‰å®ç°æ¥å£ï¼Œé‚£ä¹ˆå®ƒå°±ä»£ç†ä¸äº†</strong></p><p>å¦‚æœæˆ‘æƒ³å®ç°è¢«ä»£ç†å¯¹è±¡æ²¡æœ‰å®ç°æ¥å£çš„è¿™ç§æ–¹å¼è¦æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>ç­”ï¼šä½¿ç”¨ cglib åŠ¨æ€ä»£ç†</p><h5 id="3-4-2-2ã€cglib-åŠ¨æ€ä»£ç†"><a href="#3-4-2-2ã€cglib-åŠ¨æ€ä»£ç†" class="headerlink" title="3.4.2.2ã€cglib åŠ¨æ€ä»£ç†"></a>3.4.2.2ã€cglib åŠ¨æ€ä»£ç†</h5><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è¿›å…¥ï¼Œcglib è¿™ä¸ªåº“ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation <span class="hljs-string">&#x27;cglib:cglib:3.2.6&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¥ç€æ¥è¿›è¡Œå…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªéœ€è¦è¢«ä»£ç†å¯¹è±¡ï¼Œå¯ä»¥çœ‹åˆ° TestProxy æ²¡æœ‰å®ç°ä»»ä½•æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestProxy</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•&quot;</span>);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ cglib ä»£ç†ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CglibProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> &#123;<br><br>    <span class="hljs-comment">//è¢«ä»£ç†å¯¹è±¡</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object object;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CglibProxy</span><span class="hljs-params">(Object object)</span> &#123;<br>        <span class="hljs-built_in">this</span>.object = object;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//å·¥å…·ç±»</span><br>        <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();<br>        <span class="hljs-comment">//è®¾ç½®çˆ¶ç±»</span><br>        enhancer.setSuperclass(object.getClass());<br>        <span class="hljs-comment">//è®¾ç½®å›è°ƒå‡½æ•°</span><br>        enhancer.setCallback(<span class="hljs-built_in">this</span>);<br>        <span class="hljs-comment">//å¸¸è§ä»£ç†å¯¹è±¡å¹¶è¿”å›</span><br>        <span class="hljs-keyword">return</span> enhancer.create();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object proxyObject, Method method, Object[] args, MethodProxy proxy)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;test&quot;</span>.equals(method.getName()))&#123;<br>            System.out.println(<span class="hljs-string">&quot;testBefore...&quot;</span>);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(object, args);<br>            System.out.println(<span class="hljs-string">&quot;testAfter...&quot;</span>);<br>            <span class="hljs-keyword">return</span> invoke;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;login&quot;</span>.equals(method.getName()))&#123;<br>            System.out.println(<span class="hljs-string">&quot;loginBefore...&quot;</span>);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> method.invoke(object, args);<br>            System.out.println(<span class="hljs-string">&quot;loginAfter...&quot;</span>);<br>            <span class="hljs-keyword">return</span> invoke;<br>        &#125;<br>        <span class="hljs-keyword">return</span> method.invoke(object,args);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//cglib åŠ¨æ€ä»£ç†</span><br>        <span class="hljs-type">TestProxy</span> <span class="hljs-variable">testProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestProxy</span>();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">TestProxy</span> <span class="hljs-variable">cgLibTestProxy</span> <span class="hljs-operator">=</span> (TestProxy) <span class="hljs-keyword">new</span> <span class="hljs-title class_">CglibProxy</span>(testProxy).getProxyInstance();<br>        cgLibTestProxy.test();<br>        cgLibTestProxy.login();<br>        cgLibTestProxy.register();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>testBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† test æ–¹æ³•<br>testAfter...<br>loginBefore...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† login æ–¹æ³•<br>loginAfter...<br>è¢«ä»£ç†å¯¹è±¡æ‰§è¡Œäº† register æ–¹æ³•<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° cglib åŠ¨æ€ä»£ç†æˆ‘ä»¬ä¸»è¦ä½¿ç”¨äº† Enhancer å·¥å…·ç±»ä»¥åŠå®ç°äº† MethodInterceptor æ¥å£</p><p><strong>Tips</strong>ï¼š å¦‚æœè¢«ä»£ç†ç±»å¯¹è±¡å®ç°äº†æ¥å£å°±ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨ cglib åŠ¨æ€ä»£ç†</p><h3 id="3-5ã€å•ä¾‹æ¨¡å¼"><a href="#3-5ã€å•ä¾‹æ¨¡å¼" class="headerlink" title="3.5ã€å•ä¾‹æ¨¡å¼"></a>3.5ã€å•ä¾‹æ¨¡å¼</h3><p>å•ä¾‹æ¨¡å¼å…±æœ‰ 5 ç§å†™æ³•ï¼š</p><blockquote><p>1ã€æ‡’æ±‰å¼</p><p>2ã€é¥¿æ±‰å¼</p><p>3ã€åŒé‡æ£€æŸ¥å¼</p><p>4ã€é™æ€å†…éƒ¨ç±»å¼</p><p>5ã€æšä¸¾å¼</p></blockquote><h4 id="3-5-1ã€æ‡’æ±‰å¼"><a href="#3-5-1ã€æ‡’æ±‰å¼" class="headerlink" title="3.5.1ã€æ‡’æ±‰å¼"></a>3.5.1ã€æ‡’æ±‰å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LazySingleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LazySingleton instance;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">LazySingleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> LazySingleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(instance == <span class="hljs-literal">null</span>)&#123;<br>            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LazySingleton</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼æ¯æ¬¡è°ƒç”¨ getInstance æ–¹æ³•çš„æ—¶å€™éƒ½ä¼šè¿›è¡ŒåŒæ­¥ï¼Œé€ æˆä¸å¿…è¦çš„åŒæ­¥å¼€é”€</p><h4 id="3-5-2ã€é¥¿æ±‰å¼"><a href="#3-5-2ã€é¥¿æ±‰å¼" class="headerlink" title="3.5.2ã€é¥¿æ±‰å¼"></a>3.5.2ã€é¥¿æ±‰å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HungrySingleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">HungrySingleton</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HungrySingleton</span>();<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">HungrySingleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼ä¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹çš„åˆ›å»ºï¼Œå¦‚æœä»å§‹è‡³ç»ˆæ²¡æœ‰ä½¿ç”¨è¯¥å®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹</p><h4 id="3-5-3ã€åŒé‡æ£€æŸ¥å¼"><a href="#3-5-3ã€åŒé‡æ£€æŸ¥å¼" class="headerlink" title="3.5.3ã€åŒé‡æ£€æŸ¥å¼"></a>3.5.3ã€åŒé‡æ£€æŸ¥å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DoubleCheckSingleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> DoubleCheckSingleton instance;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">DoubleCheckSingleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  DoubleCheckSingleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(instance == <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">synchronized</span> (DoubleCheckSingleton.class)&#123;<br>                <span class="hljs-keyword">if</span>(instance == <span class="hljs-literal">null</span>)&#123;<br>                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DoubleCheckSingleton</span>();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå®Œç¾ä¸€äº›ï¼Œä½†æ˜¯åœ¨ jdk 1.5 ä¹‹å‰ï¼Œé«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DoubleCheckSingleton</span>();<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°è¿™è¡Œä»£ç å®é™…ä¸Šå¹¶ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œå®ƒæœ€ç»ˆä¼šè¢«ç¼–è¯‘æˆå¤šæ¡æŒ‡ä»¤ï¼Œä¸»è¦åšäº†ä¸‰ä»¶äº‹æƒ…ï¼š</p><blockquote><p>1ã€ç»™ instance å®ä¾‹åˆ†é…å†…å­˜</p><p>2ã€è°ƒç”¨ DoubleCheckSingleton æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å­—æ®µ</p><p>3ã€å°† instance æŒ‡å‘åˆ†é…çš„å†…å­˜ï¼ˆæ­¤æ—¶ instance å°±ä¸ä¸º null äº†ï¼‰</p></blockquote><p>åœ¨ JDK 1.5 ä¹‹å‰ï¼Œé«˜å¹¶å‘çš„æƒ…å†µä¸‹ 2ï¼Œ3 çš„é¡ºåºæ˜¯æ— æ³•ä¿è¯çš„ï¼Œå¯èƒ½ä¸ºï¼š1-2-3ï¼Œä¹Ÿå¯èƒ½ä¸ºï¼š1-3-2ã€‚åœ¨ JDK 1.5 ä¹‹åï¼Œå®˜æ–¹å…·ä½“åŒ–äº† volitile å…³é”®å­—ï¼Œä¸Šè¿° instance å¯¹è±¡æ¯æ¬¡éƒ½ä¼šä»ä¸»å†…å­˜è¯»å–ã€‚å½“ç„¶ï¼Œvolatile å…³é”®å­—æˆ–å¤šæˆ–å°‘ä¼šå½±å“æ€§èƒ½ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œè¿™ç‚¹ç‰ºç‰²ä¹Ÿæ˜¯å€¼å¾—çš„</p><p>ä¼˜ç‚¹ï¼šèµ„æºåˆ©ç”¨ç‡é«˜ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ getInstance æ–¹æ³•å•ä¾‹å¯¹è±¡æ‰ä¼šè¢«å®ä¾‹åŒ–ï¼Œæ•ˆç‡é«˜ã€‚</p><p>ç¼ºç‚¹ï¼šç¬¬ä¸€æ¬¡åŠ è½½ç¨æ…¢ï¼Œåœ¨ jdk 1.5 ä¹‹å‰å¯èƒ½ä¼šå¤±æ•ˆ</p><h4 id="3-5-4ã€é™æ€å†…éƒ¨ç±»å¼"><a href="#3-5-4ã€é™æ€å†…éƒ¨ç±»å¼" class="headerlink" title="3.5.4ã€é™æ€å†…éƒ¨ç±»å¼"></a>3.5.4ã€é™æ€å†…éƒ¨ç±»å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticInnerClassSingleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">StaticInnerClassSingleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">StaticInnerClassSingleton</span> <span class="hljs-variable">INSTANCE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StaticInnerClassSingleton</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> StaticInnerClassSingleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> Holder.INSTANCE;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è°ƒç”¨ getInstance æ–¹æ³•æ—¶æ‰ä¼šå»åŠ è½½ Holder å¹¶åˆå§‹åŒ– INSTANCEï¼Œè¿™æ ·æ—¢ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨ä¹Ÿä¿è¯äº†å®ä¾‹çš„å”¯ä¸€æ€§</p><h4 id="3-5-5ã€æšä¸¾å¼"><a href="#3-5-5ã€æšä¸¾å¼" class="headerlink" title="3.5.5ã€æšä¸¾å¼"></a>3.5.5ã€æšä¸¾å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">EnumSingleton</span> &#123;<br>    INSTANCE;<br>&#125;<br></code></pre></td></tr></table></figure><p>é»˜è®¤æšä¸¾çš„å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯å•ä¾‹ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¯è¯»æ€§ä¸é«˜</p><h3 id="3-6ã€å»ºé€ è€…æ¨¡å¼"><a href="#3-6ã€å»ºé€ è€…æ¨¡å¼" class="headerlink" title="3.6ã€å»ºé€ è€…æ¨¡å¼"></a>3.6ã€å»ºé€ è€…æ¨¡å¼</h3><p>å»ºé€ è€…æ¨¡å¼ä¸»è¦ç”¨æ¥æ„å»ºå¯¹è±¡ï¼Œå°†å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºè¿›è¡Œåˆ†ç¦»ï¼Œå®ƒæ›´åŠ æ³¨é‡å¯¹è±¡çš„æ„å»ºè¿‡ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Computer</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String cpu;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String ram;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String rom;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Computer</span><span class="hljs-params">(Builder builder)</span>&#123;<br>        cpu = builder.cpu;<br>        ram = builder.ram;<br>        rom = builder.rom;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCpu</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> cpu;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getRam</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> ram;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getRom</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> rom;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span>&#123;<br>        <span class="hljs-keyword">private</span>  String cpu;<br>        <span class="hljs-keyword">private</span>  String ram;<br>        <span class="hljs-keyword">private</span>  String rom;<br><br><br>        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">cpu</span><span class="hljs-params">(String cpu)</span> &#123;<br>            <span class="hljs-built_in">this</span>.cpu = cpu;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br><br>        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">ram</span><span class="hljs-params">(String ram)</span> &#123;<br>            <span class="hljs-built_in">this</span>.ram = ram;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br><br>        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">rom</span><span class="hljs-params">(String rom)</span> &#123;<br>            <span class="hljs-built_in">this</span>.rom = rom;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> Computer <span class="hljs-title function_">build</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Computer</span>(<span class="hljs-built_in">this</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Computer</span> <span class="hljs-variable">computer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Computer</span>.Builder()<br>                .cpu(<span class="hljs-string">&quot;è‹±ç‰¹å°”&quot;</span>)<br>                .ram(<span class="hljs-string">&quot;8G&quot;</span>)<br>                .rom(<span class="hljs-string">&quot;128G&quot;</span>)<br>                .build();<br><br>        System.out.println(computer.getCpu());<br>        System.out.println(computer.getRam());<br>        System.out.println(computer.getRom());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>è‹±ç‰¹å°”<br>8G<br>128G<br></code></pre></td></tr></table></figure><h3 id="3-7ã€åŸå‹æ¨¡å¼"><a href="#3-7ã€åŸå‹æ¨¡å¼" class="headerlink" title="3.7ã€åŸå‹æ¨¡å¼"></a>3.7ã€åŸå‹æ¨¡å¼</h3><p>åŸå‹æ¨¡å¼ä¸»è¦ç”¨äºæ„å»ºå¯¹è±¡ï¼Œé€šè¿‡æ‹·è´åŸå‹å¯¹è±¡æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œæ‹·è´æ–¹å¼ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p><blockquote><p>1ã€æµ…æ‹·è´</p><p>2ã€æ·±æ‹·è´</p></blockquote><h4 id="3-7-1ã€æµ…æ‹·è´"><a href="#3-7-1ã€æµ…æ‹·è´" class="headerlink" title="3.7.1ã€æµ…æ‹·è´"></a>3.7.1ã€æµ…æ‹·è´</h4><p>æ‹·è´ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡é‡Œé¢çš„æ˜¯åŸºæœ¬ç±»å‹ï¼Œåˆ™æ‹·è´çš„æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ã€‚å¦‚æœå¯¹è±¡é‡Œé¢æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™æ‹·è´çš„æ˜¯å¼•ç”¨ç±»å‹çš„åœ°å€ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰å¼€è¾Ÿæ–°çš„å†…å­˜ç©ºé—´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cloneable</span>&#123;<br>        <span class="hljs-keyword">public</span> String name;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name)</span> &#123;<br>            <span class="hljs-built_in">this</span>.name = name;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student&#123;&quot;</span> +<br>                    <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@NonNull</span><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> Student <span class="hljs-title function_">clone</span><span class="hljs-params">()</span>  &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> (Student) <span class="hljs-built_in">super</span>.clone();<br>            &#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//æµ…æ‹·è´</span><br>        ArrayList&lt;Student&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        stringList.add(stu);<br>        stringList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;erdai666&quot;</span>));<br>        System.out.println(stringList);<br>        <span class="hljs-comment">//æµ…æ‹·è´æ ¸å¿ƒä»£ç </span><br>        ArrayList&lt;Student&gt; newStringList = (ArrayList&lt;Student&gt;) stringList.clone();<br>        System.out.println(newStringList);<br>        <span class="hljs-comment">//æ”¹å˜ stu å†…çš„å€¼ï¼Œç»“æœä¸¤ä¸ªé›†åˆçš„å€¼éƒ½å˜äº†</span><br>        stu.name = <span class="hljs-string">&quot;erdai777&quot;</span>;<br>        System.out.println(stringList);<br>        System.out.println(newStringList);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[Student&#123;name=<span class="hljs-string">&#x27;erdai&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai777&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai777&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br></code></pre></td></tr></table></figure><h4 id="3-7-2ã€æ·±æ‹·è´"><a href="#3-7-2ã€æ·±æ‹·è´" class="headerlink" title="3.7.2ã€æ·±æ‹·è´"></a>3.7.2ã€æ·±æ‹·è´</h4><p>æ‹·è´ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡é‡Œé¢çš„æ˜¯åŸºæœ¬ç±»å‹ï¼Œåˆ™æ‹·è´çš„æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ï¼Œå¦‚æœå¯¹è±¡é‡Œé¢æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™å°†å¼•ç”¨ç±»å‹ä¹Ÿæ‹·è´ä¸€ä»½ï¼Œæ­¤æ—¶å¼€è¾Ÿäº†æ–°çš„å†…å­˜ç©ºé—´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cloneable</span>&#123;<br>        <span class="hljs-keyword">public</span> String name;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name)</span> &#123;<br>            <span class="hljs-built_in">this</span>.name = name;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student&#123;&quot;</span> +<br>                    <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@NonNull</span><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> Student <span class="hljs-title function_">clone</span><span class="hljs-params">()</span>  &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> (Student) <span class="hljs-built_in">super</span>.clone();<br>            &#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//æ·±æ‹·è´</span><br>        ArrayList&lt;Student&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        stringList.add(stu);<br>        stringList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;erdai666&quot;</span>));<br>        System.out.println(stringList);<br>      <span class="hljs-comment">//æ·±æ‹·è´æ ¸å¿ƒä»£ç </span><br>        ArrayList&lt;Student&gt; newStringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (Student student : stringList) &#123;<br>            newStringList.add(student.clone());<br>        &#125;<br>        System.out.println(newStringList);<br>        <span class="hljs-comment">//æ”¹å˜ stu å†…çš„å€¼ï¼Œåªæœ‰ StringList çš„å€¼ä¼šå˜ï¼ŒnewStringList ä¸ä¼šå˜</span><br>        stu.name = <span class="hljs-string">&quot;erdai777&quot;</span>;<br>        System.out.println(stringList);<br>        System.out.println(newStringList);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[Student&#123;name=<span class="hljs-string">&#x27;erdai&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai777&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br>[Student&#123;name=<span class="hljs-string">&#x27;erdai&#x27;</span>&#125;, Student&#123;name=<span class="hljs-string">&#x27;erdai666&#x27;</span>&#125;]<br></code></pre></td></tr></table></figure><h3 id="3-8ã€é€‚é…å™¨æ¨¡å¼"><a href="#3-8ã€é€‚é…å™¨æ¨¡å¼" class="headerlink" title="3.8ã€é€‚é…å™¨æ¨¡å¼"></a>3.8ã€é€‚é…å™¨æ¨¡å¼</h3><p>é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨äºé€‚é…å¦å¤–ä¸€ä¸ªä¸å…¼å®¹çš„å¯¹è±¡ä¸€èµ·å·¥ä½œï¼Œä¸»è¦åˆ† 3 ç§æ–¹å¼ï¼š</p><blockquote><p>1ã€ç±»é€‚é…</p><p>2ã€å¯¹è±¡é€‚é…</p><p>3ã€æ¥å£é€‚é…</p></blockquote><h4 id="3-8-1ã€ç±»é€‚é…"><a href="#3-8-1ã€ç±»é€‚é…" class="headerlink" title="3.8.1ã€ç±»é€‚é…"></a>3.8.1ã€ç±»é€‚é…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªéœ€è¦è¢«é€‚é…çš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Adaptee</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">adaptee</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è°ƒç”¨äº†è¢«é€‚é…çš„æ–¹æ³•&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªç›®æ ‡æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Target</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">request</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ç›®æ ‡æ¥å£çš„ request æ–¹æ³•ä¸­è°ƒç”¨ Adaptee çš„ adaptee æ–¹æ³•ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ</span><br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªé€‚é…å™¨çš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Adapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Adaptee</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Target</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">request</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;é€šè¿‡é€‚é…å™¨ï¼Œè¿æ¥ç›®æ ‡æ–¹æ³•&quot;</span>);<br>        <span class="hljs-built_in">super</span>.adaptee();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassClient</span> &#123;<br><br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-type">Target</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Adapter</span>();<br>        target.request();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>é€šè¿‡é€‚é…å™¨ï¼Œè¿æ¥ç›®æ ‡æ–¹æ³•<br>è°ƒç”¨äº†è¢«é€‚é…çš„æ–¹æ³•<br></code></pre></td></tr></table></figure><h4 id="3-8-2ã€å¯¹è±¡é€‚é…"><a href="#3-8-2ã€å¯¹è±¡é€‚é…" class="headerlink" title="3.8.2ã€å¯¹è±¡é€‚é…"></a>3.8.2ã€å¯¹è±¡é€‚é…</h4><p>ç”µæºé€‚é…å™¨ï¼šå°† 200V çš„ç”µè¯è½¬æ¢ä¸º 5V è¾“å‡º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªç”µå‹çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AC</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-title function_">outputAC</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ª 220V çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AC220</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AC</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">outputAC</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">220</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€é€‚é…å™¨æ¥å£ï¼ŒoutputDC5V æ–¹æ³•ç”¨äºå°†è¾“å…¥çš„ç”µå‹å˜ä¸º 5V åè¾“å‡º</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">DC5Adapter</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-title function_">outputDC5V</span><span class="hljs-params">(AC ac)</span>;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®ç°ç”µæºé€‚é…å™¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DC5Adapter</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">outputDC5V</span><span class="hljs-params">(AC ac)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">outputAC</span> <span class="hljs-operator">=</span> ac.outputAC();<br>        <span class="hljs-comment">//å˜å‹å™¨</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">adapterOutput</span> <span class="hljs-operator">=</span> outputAC / <span class="hljs-number">44</span>;<br>        System.out.println(<span class="hljs-string">&quot;æ”¶åˆ°ï¼š&quot;</span> + outputAC + <span class="hljs-string">&quot;Vçš„ç”µå‹ï¼Œé€šè¿‡é€‚é…å™¨è½¬æ¢ï¼Œè¾“å‡ºä¸ºï¼š&quot;</span> + adapterOutput + <span class="hljs-string">&quot;V&quot;</span>);<br>        <span class="hljs-keyword">return</span> adapterOutput;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">DC5Adapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PowerAdapter</span>();<br>        <span class="hljs-type">AC</span> <span class="hljs-variable">ac</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AC220</span>();<br>        adapter.outputDC5V(ac);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ”¶åˆ°ï¼š220Vçš„ç”µå‹ï¼Œé€šè¿‡é€‚é…å™¨è½¬æ¢ï¼Œè¾“å‡ºä¸ºï¼š5V<br></code></pre></td></tr></table></figure><h4 id="3-8-3ã€æ¥å£é€‚é…"><a href="#3-8-3ã€æ¥å£é€‚é…" class="headerlink" title="3.8.3ã€æ¥å£é€‚é…"></a>3.8.3ã€æ¥å£é€‚é…</h4><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°æ¥å£ä¸­å®šä¹‰äº†å¤ªå¤šçš„æ–¹æ³•ï¼Œè€Œæœ‰äº›æ–¹æ³•æˆ‘ä»¬æ˜¯ç”¨ä¸åˆ°çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡é€‚é…å™¨æ¨¡å¼é€‚é…æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITest</span>&#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªé€‚é…å™¨çš„æŠ½è±¡ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdapterWrapper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITest</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§æ‰¿é€‚é…å™¨çš„æŠ½è±¡ç±»ï¼Œç„¶åå»é€‰æ‹©éœ€è¦å®ç°çš„æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AdapterWrapper</span>&#123;<br>   <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterfaceClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Test</span> <span class="hljs-variable">test</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>        test.test();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><h3 id="3-9ã€è£…é¥°è€…æ¨¡å¼"><a href="#3-9ã€è£…é¥°è€…æ¨¡å¼" class="headerlink" title="3.9ã€è£…é¥°è€…æ¨¡å¼"></a>3.9ã€è£…é¥°è€…æ¨¡å¼</h3><p>è£…é¥°è€…æ¨¡å¼ä¸»è¦ç”¨äºè£…é¥°ä¸€ä¸ªç±»ï¼Œè¾¾åˆ°åŠŸèƒ½å¢å¼ºçš„ç›®çš„</p><p>å¦‚ä¸‹ä¾‹å­ï¼šæˆ‘æƒ³åƒä¸ªè›‹ç‚’é¥­ï¼Œä½†æ˜¯å•ç‹¬ä¸€ä¸ªè›‹ç‚’é¥­æˆ‘è§‰å¾—ä¸å¥½åƒï¼Œæˆ‘æƒ³åœ¨ä¸Šé¢åŠ ç«è…¿ï¼ŒåŠ ç‰›è‚‰ã€‚æˆ‘ä»¬ä½¿ç”¨è£…é¥°è€…æ¨¡å¼æ¥å®ç°å®ƒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Rice</span> &#123;<br>    fun <span class="hljs-title function_">cook</span><span class="hljs-params">()</span><br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­æ¥å£çš„å®ç°ç±»ï¼šè›‹ç‚’é¥­</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">EggFriedRice</span>: Rice &#123;<br><br>    override fun <span class="hljs-title function_">cook</span><span class="hljs-params">()</span> &#123;<br>        println(<span class="hljs-string">&quot;è›‹ç‚’é¥­&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­çš„æŠ½è±¡è£…é¥°ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RiceDecorate</span>(<span class="hljs-keyword">var</span> rice: Rice): Rice<br><br><span class="hljs-comment">//4ã€å¾€è›‹ç‚’é¥­ä¸­åŠ ç«è…¿</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HamFriedRiceDecorate</span>(rice: Rice): RiceDecorate(rice) &#123;<br>    override fun <span class="hljs-title function_">cook</span><span class="hljs-params">()</span> &#123;<br>        rice.cook()<br>        println(<span class="hljs-string">&quot;åŠ ç«è…¿&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€å¾€è›‹ç‚’é¥­ä¸­åŠ ç‰›è‚‰</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BeefFriedRiceDecorate</span>(rice: Rice): RiceDecorate(rice) &#123;<br><br>    override fun <span class="hljs-title function_">cook</span><span class="hljs-params">()</span> &#123;<br>        rice.cook()<br>        println(<span class="hljs-string">&quot;åŠ ç‰›è‚‰&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//6ã€æµ‹è¯•</span><br>fun <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-comment">//è›‹ç‚’é¥­</span><br>    <span class="hljs-type">val</span> <span class="hljs-variable">rice</span> <span class="hljs-operator">=</span> EggFriedRice()<br>    <span class="hljs-comment">//åŠ ç«è…¿</span><br>    <span class="hljs-type">val</span> <span class="hljs-variable">hamFriedRiceDecorate</span> <span class="hljs-operator">=</span> HamFriedRiceDecorate(rice)<br>    <span class="hljs-comment">//åŠ ç‰›è‚‰</span><br>    <span class="hljs-type">val</span> <span class="hljs-variable">beefFriedRiceDecorate</span> <span class="hljs-operator">=</span> BeefFriedRiceDecorate(hamFriedRiceDecorate)<br>    beefFriedRiceDecorate.cook()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>è›‹ç‚’é¥­<br>åŠ ç«è…¿<br>åŠ ç‰›è‚‰<br></code></pre></td></tr></table></figure><h3 id="3-10ã€å¤–è§‚æ¨¡å¼"><a href="#3-10ã€å¤–è§‚æ¨¡å¼" class="headerlink" title="3.10ã€å¤–è§‚æ¨¡å¼"></a>3.10ã€å¤–è§‚æ¨¡å¼</h3><p>å¤–è§‚æ¨¡å¼ä¸»è¦ç”¨äºç®€åŒ–ç³»ç»Ÿçš„ä½¿ç”¨ï¼Œå®ƒå¯¹å¤–æä¾›ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œå¹¶å°†å­ç³»ç»Ÿçš„åŠŸèƒ½è¿›è¡Œå°è£…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€æä¾›ä¸€äº›å­ç³»ç»Ÿçš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CPU</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startup</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;cpu startup&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdowm</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;cpu shutdowm&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RAM</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startup</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ram startup&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdowm</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ram shutdowm&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ROM</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startup</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;rom startup&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdowm</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;rom shutdowm&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å¤–è§‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Computer</span>&#123;<br>    <span class="hljs-keyword">private</span> CPU cpu;<br>    <span class="hljs-keyword">private</span> RAM ram;<br>    <span class="hljs-keyword">private</span> ROM rom;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Computer</span><span class="hljs-params">()</span>&#123;<br>        cpu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CPU</span>();<br>        ram = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RAM</span>();<br>        rom = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ROM</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startup</span><span class="hljs-params">()</span>&#123;<br>        cpu.startup();<br>        ram.startup();<br>        rom.startup();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdowm</span><span class="hljs-params">()</span>&#123;<br>        cpu.shutdowm();<br>        ram.shutdowm();<br>        rom.shutdowm();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FacadeClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Computer</span> <span class="hljs-variable">computer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Computer</span>();<br>        computer.startup();<br>        computer.shutdowm();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>cpu startup<br>ram startup<br>rom startup<br>cpu shutdowm<br>ram shutdowm<br>rom shutdowm<br></code></pre></td></tr></table></figure><p>å¤–è§‚æ¨¡å¼ä¼˜ç‚¹ï¼š</p><p>1ã€å°†å¯¹å­ç³»ç»Ÿçš„ä¾èµ–è½¬æ¢ä¸ºå¯¹å¤–è§‚ç±»çš„ä¾èµ–</p><p>2ã€å¯¹å¤–éƒ¨éšè—å­ç³»ç»Ÿçš„å…·ä½“å®ç°</p><p>3ã€å¢å¼ºäº†å®‰å…¨æ€§</p><h3 id="3-11ã€æ¡¥æ¥æ¨¡å¼"><a href="#3-11ã€æ¡¥æ¥æ¨¡å¼" class="headerlink" title="3.11ã€æ¡¥æ¥æ¨¡å¼"></a>3.11ã€æ¡¥æ¥æ¨¡å¼</h3><p>æ¡¥æ¥æ¨¡å¼ä¸»è¦ç”¨äºæŠ½è±¡ä¸å®ç°ä¹‹é—´çš„æ¡¥æ¥ï¼Œå®ç°äºŒè€…çš„è§£è€¦</p><p>ä¾‹å­ï¼šç”»åœ†å½¢å’Œé•¿æ–¹å½¢ï¼Œå¹¶ç»™ä»–ä»¬æ¶‚ä¸Šä¸åŒçš„é¢œè‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºç”»é¢œè‰²çš„æ¥å£ï¼šæ¡¥æ¥æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">DrawAPI</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">drawColor</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºå®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RedDraw</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DrawAPI</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drawColor</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;red color&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GreenDraw</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DrawAPI</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drawColor</span><span class="hljs-params">()</span>&#123;<br>        System.out.print(<span class="hljs-string">&quot;green color&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±» Shapeï¼ˆå½¢çŠ¶ï¼‰ï¼šæŒæœ‰ DrawAPI çš„ å¼•ç”¨</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span>&#123;<br>    <span class="hljs-keyword">protected</span> DrawAPI drawAPI;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">(DrawAPI drawAPI)</span>&#123;<br>        <span class="hljs-built_in">this</span>.drawAPI = drawAPI;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®ç°ç±»ï¼Œç”»å…·ä½“çš„å½¢çŠ¶ï¼Œå¹¶æ·»åŠ é¢œè‰²</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(DrawAPI drawAPI)</span> &#123;<br>        <span class="hljs-built_in">super</span>(drawAPI);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> &#123;<br>        System.out.print(<span class="hljs-string">&quot;draw Circle with &quot;</span>);<br>        drawAPI.drawColor();<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(DrawAPI drawAPI)</span> &#123;<br>        <span class="hljs-built_in">super</span>(drawAPI);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> &#123;<br>        System.out.print(<span class="hljs-string">&quot;draw Rectangle with &quot;</span>);<br>        drawAPI.drawColor();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BridgeClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">redCircle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RedDraw</span>());<br>        <span class="hljs-type">Shape</span> <span class="hljs-variable">greenRectangle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">GreenDraw</span>());<br><br>        redCircle.draw();<br>        greenRectangle.draw();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>draw Circle with red color<br>draw Rectangle with green color<br></code></pre></td></tr></table></figure><p>æ¡¥æ¥æ¨¡å¼ä¼˜ç‚¹ï¼š</p><p>1ã€æŠŠäº‹ç‰©å’Œå…¶å…·ä½“å®ç°åˆ†å¼€ï¼Œä½¿å¾—ä»–ä»¬å„è‡ªå¯ä»¥ç‹¬ç«‹çš„å˜åŒ–</p><p>2ã€æ¡¥æ¥æ¥å£ä½œä¸ºä½ ä¸€ä¸ªç»´åº¦ï¼ŒæŠ½è±¡ç±»ä½œä¸ºä¸€ä¸ªç»´åº¦ï¼Œä¸¤åˆ™å¯ä»¥éšæ„ç»„åˆ</p><h3 id="3-12ã€ç»„åˆæ¨¡å¼"><a href="#3-12ã€ç»„åˆæ¨¡å¼" class="headerlink" title="3.12ã€ç»„åˆæ¨¡å¼"></a>3.12ã€ç»„åˆæ¨¡å¼</h3><p>ç»„åˆæ¨¡å¼çš„ç‰¹ç‚¹å°±æ˜¯æŠŠä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡ï¼Œå½“ä½œä¸€ä¸ªå•ä¸€çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Component component)</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Component component)</span>&#123;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ç»„ç›¸ä¼¼çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ComponentImpl1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ComponentImpl1 operation&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ComponentImpl2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ComponentImpl2 operation&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªç»„åˆç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Combine</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Component&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (Component component : list) &#123;<br>            component.operation();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Component component)</span> &#123;<br>        list.add(component);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Component component)</span> &#123;<br>        list.remove(component);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CombineClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Component</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentImpl1</span>();<br>        <span class="hljs-type">Component</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentImpl2</span>();<br>        <span class="hljs-type">Component</span> <span class="hljs-variable">combine</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Combine</span>();<br>        combine.add(c1);<br>        combine.add(c2);<br>        combine.operation();<br>        combine.remove(c2);<br>        combine.operation();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ComponentImpl1 operation<br>ComponentImpl2 operation<br>ComponentImpl1 operation<br></code></pre></td></tr></table></figure><h3 id="3-13ã€è§‚å¯Ÿè€…æ¨¡å¼"><a href="#3-13ã€è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="3.13ã€è§‚å¯Ÿè€…æ¨¡å¼"></a>3.13ã€è§‚å¯Ÿè€…æ¨¡å¼</h3><p>è§‚å¯Ÿè€…æ¨¡å¼ä¸»è¦ç”¨äºå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜ï¼Œå…¶ä»–å¯¹è±¡èƒ½æ”¶åˆ°è¿™ç§å˜åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> &#123;<br>    fun <span class="hljs-title function_">onChange</span><span class="hljs-params">(o: Any?)</span><br>&#125;<br><br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observable</span> &#123;<br>    fun <span class="hljs-title function_">addObserver</span><span class="hljs-params">(observer: Observer?)</span><br>    fun <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(observer: Observer?)</span><br>    fun <span class="hljs-title function_">changeEvent</span><span class="hljs-params">(o: Any?)</span><br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableImpl</span> : Observable &#123;<br><br>    <span class="hljs-keyword">private</span> val observers: MutableList&lt;Observer&gt;<br><br>    init &#123;<br>        observers = LinkedList()<br>    &#125;<br><br>    override fun <span class="hljs-title function_">addObserver</span><span class="hljs-params">(observer: Observer?)</span> &#123;<br>        <span class="hljs-keyword">if</span> (observer == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">if</span> (observers.contains(observer)) <span class="hljs-keyword">return</span><br>        observers.add(observer)<br>    &#125;<br><br>    override fun <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(observer: Observer?)</span> &#123;<br>        <span class="hljs-keyword">if</span> (observer == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">if</span> (observers.contains(observer)) &#123;<br>            observers.remove(observer)<br>        &#125;<br>    &#125;<br><br>    override fun <span class="hljs-title function_">changeEvent</span><span class="hljs-params">(o: Any?)</span> &#123;<br>        <span class="hljs-keyword">for</span> (observer in observers) &#123;<br>            observer.onChange(o)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObserverImpl</span> : Observer &#123;<br><br>    override fun <span class="hljs-title function_">onChange</span><span class="hljs-params">(o: Any?)</span> &#123;<br>        println(<span class="hljs-string">&quot;$&#123;javaClass.simpleName&#125;: $o&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€æµ‹è¯•</span><br>fun <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    val observable: Observable = ObservableImpl()<br>    val observer1: Observer = ObserverImpl()<br>    val observer2: Observer = ObserverImpl()<br>    val observer3: Observer = ObserverImpl()<br>    observable.addObserver(observer1)<br>    observable.addObserver(observer2)<br>    observable.addObserver(observer3)<br>    observable.changeEvent(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>&#125;<br><br><span class="hljs-comment">//6ã€æ‰“å°ç»“æœ</span><br>ObserverImpl: erdai666<br>ObserverImpl: erdai666<br>ObserverImpl: erdai666<br></code></pre></td></tr></table></figure><h3 id="3-14ã€æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"><a href="#3-14ã€æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼" class="headerlink" title="3.14ã€æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"></a>3.14ã€æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</h3><p>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€å¥—ç®—æ³•æ¡†æ¶ï¼Œå°†ä¸€äº›æ­¥éª¤äº¤ç”±å…·ä½“çš„å­—ç±»å»å®ç°</p><p>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š</p><blockquote><p>1ã€æŠ½è±¡ç±»ï¼šå®šä¹‰äº†ä¸€å¥—ç®—æ³•æ¡†æ¶</p><p>2ã€å…·ä½“å®ç°ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€æŠ½è±¡ç±»ï¼šå®šä¹‰äº†ä¸€å¥—ç®—æ³•æ¡†æ¶</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Game</span>&#123;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startPlay</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">endPlay</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">//æ¨¡ç‰ˆæ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//åˆå§‹åŒ–æ¸¸æˆ</span><br>        init();<br>        <span class="hljs-comment">//å¼€å§‹æ¸¸æˆ</span><br>        startPlay();<br>        <span class="hljs-comment">//ç»“æŸæ¸¸æˆ</span><br>        endPlay();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LOL</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Game</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;LOL initializedï¼start play...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">startPlay</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;LOL startedï¼Œenjoy it...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">endPlay</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;LOL finished...&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplateClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Game</span> <span class="hljs-variable">game</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LOL</span>();<br>        game.play();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>LOL initializedï¼start play...<br>LOL startedï¼Œenjoy it...<br>LOL finished...<br></code></pre></td></tr></table></figure><h3 id="3-15ã€è´£ä»»é“¾æ¨¡å¼"><a href="#3-15ã€è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="3.15ã€è´£ä»»é“¾æ¨¡å¼"></a>3.15ã€è´£ä»»é“¾æ¨¡å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªè´£ä»»é“¾çš„æŠ½è±¡ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractLogger</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">INFO</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEBUG</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">ERROR</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> level;<br><br>    <span class="hljs-comment">//è´£ä»»é“¾çš„ä¸‹ä¸€ä¸ªå…ƒç´ </span><br>    <span class="hljs-keyword">protected</span> AbstractLogger nextLogger;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNextLogger</span><span class="hljs-params">(AbstractLogger nextLogger)</span>&#123;<br>        <span class="hljs-built_in">this</span>.nextLogger = nextLogger;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logMessage</span><span class="hljs-params">(<span class="hljs-type">int</span> level,String message)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.level &lt;= level)&#123;<br>            write(message);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(nextLogger != <span class="hljs-literal">null</span>)&#123;<br>            nextLogger.logMessage(level,message);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(String message)</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºå®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsoleLogger</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractLogger</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConsoleLogger</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span>&#123;<br>        <span class="hljs-built_in">this</span>.level = level;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Standard Console::Loggerï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorLogger</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractLogger</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ErrorLogger</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span>&#123;<br>        <span class="hljs-built_in">this</span>.level = level;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Error::Loggerï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileLogger</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractLogger</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileLogger</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span>&#123;<br>        <span class="hljs-built_in">this</span>.level = level;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;File::Loggerï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChainClient</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AbstractLogger <span class="hljs-title function_">getChain</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">AbstractLogger</span> <span class="hljs-variable">errorLogger</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorLogger</span>(AbstractLogger.ERROR);<br>        <span class="hljs-type">AbstractLogger</span> <span class="hljs-variable">fileLogger</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileLogger</span>(AbstractLogger.DEBUG);<br>        <span class="hljs-type">AbstractLogger</span> <span class="hljs-variable">consoleLogger</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConsoleLogger</span>(AbstractLogger.INFO);<br><br>        errorLogger.setNextLogger(fileLogger);<br>        fileLogger.setNextLogger(consoleLogger);<br>        <span class="hljs-keyword">return</span> errorLogger;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AbstractLogger</span> <span class="hljs-variable">chain</span> <span class="hljs-operator">=</span> getChain();<br><br>        chain.logMessage(AbstractLogger.INFO,<span class="hljs-string">&quot;This is an information.&quot;</span>);<br>        chain.logMessage(AbstractLogger.DEBUG,<span class="hljs-string">&quot;This is a debug level information.&quot;</span>);<br>        chain.logMessage(AbstractLogger.ERROR,<span class="hljs-string">&quot;This is an error information.&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Standard Console::Loggerï¼šThis is an information.<br>File::Loggerï¼šThis is a debug level information.<br>Standard Console::Loggerï¼šThis is a debug level information.<br>Error::Loggerï¼šThis is an error information.<br>File::Loggerï¼šThis is an error information.<br>Standard Console::Loggerï¼šThis is an error information.<br></code></pre></td></tr></table></figure><h3 id="3-16ã€è§£é‡Šå™¨æ¨¡å¼"><a href="#3-16ã€è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="3.16ã€è§£é‡Šå™¨æ¨¡å¼"></a>3.16ã€è§£é‡Šå™¨æ¨¡å¼</h3><p>è§£é‡Šå™¨æ¨¡å¼å°±æ˜¯å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨çš„è§„åˆ™å»è§£é‡Šå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªè§£é‡Šå™¨çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Expression</span>&#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(String context)</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºå®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TerminalExpression</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Expression</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String data;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TerminalExpression</span><span class="hljs-params">(String data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(String context)</span> &#123;<br>        <span class="hljs-keyword">return</span> context.contains(data);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OrExpression</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Expression</span>&#123;<br><br>    <span class="hljs-keyword">private</span> Expression expression1;<br>    <span class="hljs-keyword">private</span> Expression expression2;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrExpression</span><span class="hljs-params">(Expression expression1, Expression expression2)</span> &#123;<br>        <span class="hljs-built_in">this</span>.expression1 = expression1;<br>        <span class="hljs-built_in">this</span>.expression2 = expression2;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(String context)</span> &#123;<br>        <span class="hljs-keyword">return</span> expression1.interpret(context) || expression2.interpret(context);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndExpression</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Expression</span>&#123;<br><br>    <span class="hljs-keyword">private</span> Expression expression1;<br>    <span class="hljs-keyword">private</span> Expression expression2;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AndExpression</span><span class="hljs-params">(Expression expression1, Expression expression2)</span> &#123;<br>        <span class="hljs-built_in">this</span>.expression1 = expression1;<br>        <span class="hljs-built_in">this</span>.expression2 = expression2;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(String context)</span> &#123;<br>        <span class="hljs-keyword">return</span> expression1.interpret(context) &amp;&amp; expression2.interpret(context);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€è§„åˆ™ï¼Œæµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterpretClient</span> &#123;<br><br>    <span class="hljs-comment">//è§„åˆ™ï¼šå°æ˜å’ŒäºŒä»£éƒ½æ˜¯ç”·çš„</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Expression <span class="hljs-title function_">getMaleExpression</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">xiaoming</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(<span class="hljs-string">&quot;å°æ˜&quot;</span>);<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">erdai</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(<span class="hljs-string">&quot;äºŒä»£&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrExpression</span>(xiaoming, erdai);<br>    &#125;<br><br>    <span class="hljs-comment">//è§„åˆ™ï¼šå°çº¢æ˜¯å·²å©šçš„</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Expression <span class="hljs-title function_">getMarriedWomenExpression</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">xiaohong</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(<span class="hljs-string">&quot;å°çº¢&quot;</span>);<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">married</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(<span class="hljs-string">&quot;å·²å©š&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AndExpression</span>(xiaohong, married);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">isMale</span> <span class="hljs-operator">=</span> getMaleExpression();<br>        <span class="hljs-type">Expression</span> <span class="hljs-variable">isMarriedWomen</span> <span class="hljs-operator">=</span> getMarriedWomenExpression();<br><br>        System.out.println(<span class="hljs-string">&quot;äºŒä»£æ˜¯ç”·çš„ï¼Ÿï¼š&quot;</span> + isMale.interpret(<span class="hljs-string">&quot;äºŒä»£&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;å°çº¢æ˜¯å¦å·²ç»ç»“å©šäº†ï¼Ÿï¼š&quot;</span> + isMarriedWomen.interpret(<span class="hljs-string">&quot;å°çº¢å·²å©š&quot;</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>äºŒä»£æ˜¯ç”·çš„ï¼Ÿï¼š<span class="hljs-literal">true</span><br>å°çº¢æ˜¯å¦å·²ç»ç»“å©šäº†ï¼Ÿï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h3 id="3-17ã€ä¸­ä»‹è€…æ¨¡å¼"><a href="#3-17ã€ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="3.17ã€ä¸­ä»‹è€…æ¨¡å¼"></a>3.17ã€ä¸­ä»‹è€…æ¨¡å¼</h3><p>ä¸­ä»‹è€…æ¨¡å¼ä¸»è¦æ˜¯é€šè¿‡æä¾›ä¸€ä¸ªä¸­ä»‹ç±»æ¥é™ä½å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„é€šä¿¡å¤æ‚åº¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªç»Ÿä¸€è¡Œä¸ºçš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Mediator</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">showMessage</span><span class="hljs-params">(String message)</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºå®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Mediator</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showMessage</span><span class="hljs-params">(String message)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Userï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€åˆ›å»ºä¸­ä»‹ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatRoom</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Mediator</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showMessage</span><span class="hljs-params">(String message)</span> &#123;<br>        (<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>()).showMessage(message);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediatorClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Mediator</span> <span class="hljs-variable">room</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatRoom</span>();<br>        room.showMessage(<span class="hljs-string">&quot;Hiï¼Œerdai&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Userï¼šHiï¼Œerdai<br></code></pre></td></tr></table></figure><h3 id="3-18ã€è¿­ä»£å™¨æ¨¡å¼"><a href="#3-18ã€è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="3.18ã€è¿­ä»£å™¨æ¨¡å¼"></a>3.18ã€è¿­ä»£å™¨æ¨¡å¼</h3><p>è¿­ä»£å™¨æ¨¡å¼ä¸»è¦ç”¨äºé¡ºåºè®¿é—®é›†åˆå¯¹è±¡çš„å…ƒç´ ï¼Œè€Œä¸éœ€è¦çŸ¥é“å…¶åº•å±‚è¡¨ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºæ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;<br>    Object <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Container</span>&#123;<br>    Iterator <span class="hljs-title function_">getIterator</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºå®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NameRepository</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Container</span>&#123;<br>    String[] names = &#123;<span class="hljs-string">&quot;å°æ˜&quot;</span>,<span class="hljs-string">&quot;å°çº¢&quot;</span>,<span class="hljs-string">&quot;äºŒä»£&quot;</span>&#125;;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator <span class="hljs-title function_">getIterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NameIterator</span>();<br>    &#125;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NameIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&#123;<br><br>        <span class="hljs-type">int</span> index;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> index &lt; names.length;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">if</span>(hasNext())&#123;<br>                <span class="hljs-keyword">return</span> names[index++];<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IteratorClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">NameRepository</span> <span class="hljs-variable">nameRepository</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NameRepository</span>();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Iterator</span> <span class="hljs-variable">iterator</span> <span class="hljs-operator">=</span> nameRepository.getIterator();<br>        <span class="hljs-keyword">while</span> (iterator.hasNext())&#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> (String) iterator.next();<br>            System.out.println(name);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å°æ˜<br>å°çº¢<br>äºŒä»£<br></code></pre></td></tr></table></figure><h3 id="3-19ã€äº«å…ƒæ¨¡å¼"><a href="#3-19ã€äº«å…ƒæ¨¡å¼" class="headerlink" title="3.19ã€äº«å…ƒæ¨¡å¼"></a>3.19ã€äº«å…ƒæ¨¡å¼</h3><p>äº«å…ƒæ¨¡å¼ä¸»è¦ç”¨äºå‡å°‘åˆ›å»ºå¯¹è±¡çš„æ•°é‡ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜æ€§èƒ½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªå­¦ç”Ÿç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€äº«å…ƒå·¥å‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">StudentFactory</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;Object,Object&gt; stuMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Student <span class="hljs-title function_">getStudent</span><span class="hljs-params">(String key)</span>&#123;<br>        <span class="hljs-keyword">if</span>(stuMap.containsKey(key))&#123;<br>            <span class="hljs-keyword">return</span> (Student) stuMap.get(key);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();<br>            stuMap.put(key, stu);<br>            <span class="hljs-keyword">return</span> stu;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EnjoyClient</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] keys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;äºŒä»£&quot;</span>,<span class="hljs-string">&quot;å°æ˜&quot;</span>,<span class="hljs-string">&quot;å°çº¢&quot;</span>,<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;äºŒä»£&quot;</span>,<span class="hljs-string">&quot;å°çº¢&quot;</span>&#125;;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">for</span> (String key : keys) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Student</span> <span class="hljs-variable">student</span> <span class="hljs-operator">=</span> StudentFactory.getStudent(key);<br>            student.setName(key);<br>            System.out.println(student.getName() + <span class="hljs-string">&quot; HashCodeï¼š&quot;</span>+ student.hashCode());<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>äºŒä»£ HashCodeï¼š<span class="hljs-number">93122545</span><br>å°æ˜ HashCodeï¼š<span class="hljs-number">2083562754</span><br>å°çº¢ HashCodeï¼š<span class="hljs-number">1239731077</span><br>å¼ ä¸‰ HashCodeï¼š<span class="hljs-number">557041912</span><br>æå›› HashCodeï¼š<span class="hljs-number">1134712904</span><br>äºŒä»£ HashCodeï¼š<span class="hljs-number">93122545</span><br>å°çº¢ HashCodeï¼š<span class="hljs-number">1239731077</span><br></code></pre></td></tr></table></figure><h3 id="3-20ã€è®¿é—®è€…æ¨¡å¼"><a href="#3-20ã€è®¿é—®è€…æ¨¡å¼" class="headerlink" title="3.20ã€è®¿é—®è€…æ¨¡å¼"></a>3.20ã€è®¿é—®è€…æ¨¡å¼</h3><p>è®¿é—®è€…æ¨¡å¼ä¸»è¦å°±æ˜¯é€šè¿‡è®¿é—®è€…ç±»å»è®¿é—®å¯¹è±¡å…ƒç´ å¹¶è¿›è¡Œç›¸å…³æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºå¾…è®¿é—®çš„å…ƒç´ å¯¹è±¡æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span>;<br>    String <span class="hljs-title function_">getSubject</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-comment">//2ã€åˆ›å»ºè®¿é—®è€…æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Visitor</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">visit</span><span class="hljs-params">(Subject sub)</span>;<br>&#125;<br><br><span class="hljs-comment">//3ã€åˆ›å»ºå„è‡ªçš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MySubject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span> &#123;<br>        visitor.visit(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getSubject</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;love&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyVisitor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Visitor</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visit</span><span class="hljs-params">(Subject sub)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;visit the subjectï¼š&quot;</span> + sub.getSubject());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VisitorClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Subject</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MySubject</span>();<br>        <span class="hljs-type">Visitor</span> <span class="hljs-variable">visitor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyVisitor</span>();<br>        subject.accept(visitor);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>visit the subjectï¼šlove<br></code></pre></td></tr></table></figure><h3 id="3-21ã€å‘½ä»¤æ¨¡å¼"><a href="#3-21ã€å‘½ä»¤æ¨¡å¼" class="headerlink" title="3.21ã€å‘½ä»¤æ¨¡å¼"></a>3.21ã€å‘½ä»¤æ¨¡å¼</h3><p>å‘½ä»¤æ¨¡å¼ç”¨äºç»™ä¸åŒçš„å¯¹è±¡ä¸‹è¾¾ä¸åŒçš„å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªå‘½ä»¤æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Order</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€åˆ›å»ºä¸€ä¸ªè¯·æ±‚ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stock</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ABC&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">quantity</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buy</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;buyï¼Œnameï¼š&quot;</span> + name + <span class="hljs-string">&quot; quantityï¼š&quot;</span> + quantity);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sell</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;sellï¼Œnameï¼š&quot;</span> + name + <span class="hljs-string">&quot; quantityï¼š&quot;</span> + quantity);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å¸¸è§å‘½ä»¤çš„å®ç°ç±»ï¼Œå®ç°ä¸åŒçš„å‘½ä»¤</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BuyStock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Order</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Stock stock;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BuyStock</span><span class="hljs-params">(Stock stock)</span> &#123;<br>        <span class="hljs-built_in">this</span>.stock = stock;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">()</span> &#123;<br>        stock.buy();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SellStock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Order</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Stock stock;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SellStock</span><span class="hljs-params">(Stock stock)</span> &#123;<br>        <span class="hljs-built_in">this</span>.stock = stock;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">()</span> &#123;<br>        stock.sell();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€åˆ›å»ºå‘½ä»¤çš„è°ƒç”¨ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Broker</span>&#123;<br><br>    <span class="hljs-keyword">private</span> List&lt;Order&gt; orderList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">takeOrder</span><span class="hljs-params">(Order order)</span>&#123;<br>        orderList.add(order);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">placeOrders</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">for</span> (Order order : orderList) &#123;<br>            order.execute();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderClient</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Stock</span> <span class="hljs-variable">stock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stock</span>();<br><br>        <span class="hljs-type">BuyStock</span> <span class="hljs-variable">buyStock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BuyStock</span>(stock);<br>        <span class="hljs-type">SellStock</span> <span class="hljs-variable">sellStock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SellStock</span>(stock);<br><br>        <span class="hljs-type">Broker</span> <span class="hljs-variable">broker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Broker</span>();<br>        broker.takeOrder(buyStock);<br>        broker.takeOrder(sellStock);<br><br>        broker.placeOrders();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>buyï¼Œnameï¼šABC quantityï¼š<span class="hljs-number">10</span><br>sellï¼Œnameï¼šABC quantityï¼š<span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><h3 id="3-22ã€å¤‡å¿˜å½•æ¨¡å¼"><a href="#3-22ã€å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="3.22ã€å¤‡å¿˜å½•æ¨¡å¼"></a>3.22ã€å¤‡å¿˜å½•æ¨¡å¼</h3><p>å¤‡å¿˜å½•æ¨¡å¼ä¸»è¦ç”¨äºä¿å­˜å¯¹è±¡çš„æŸä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿åœ¨é€‚å½“çš„æ—¶å€™æ¢å¤å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Memento</span>&#123;<br>    <span class="hljs-keyword">public</span> String value;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Memento</span><span class="hljs-params">(String value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.value = value;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//2ã€åˆ›å»ºä¸€ä¸ªåŸå§‹ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Original</span>&#123;<br>    <span class="hljs-keyword">public</span> String value;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Original</span><span class="hljs-params">(String value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.value = value;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Memento <span class="hljs-title function_">createMemento</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Memento</span>(value);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">restoreMemento</span><span class="hljs-params">(Memento memento)</span>&#123;<br>        <span class="hljs-built_in">this</span>.value = memento.value;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€åˆ›å»ºä¸€ä¸ªå­˜å‚¨å¤‡å¿˜å½•çš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Storage</span>&#123;<br>    <span class="hljs-keyword">public</span> Memento memento;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Storage</span><span class="hljs-params">(Memento memento)</span> &#123;<br>        <span class="hljs-built_in">this</span>.memento = memento;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MementoClient</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//åˆ›å»ºåŸå§‹ç±»</span><br>        <span class="hljs-type">Original</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Original</span>(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>        <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå­˜å‚¨ç±»å­˜å‚¨å¤‡å¿˜å½•</span><br>        <span class="hljs-type">Storage</span> <span class="hljs-variable">storage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Storage</span>(original.createMemento());<br><br>        <span class="hljs-comment">//ä¿®æ”¹åŸå§‹ç±»çš„çŠ¶æ€</span><br>        original.value = <span class="hljs-string">&quot;erdai&quot;</span>;<br><br>        <span class="hljs-comment">//å›å¤åŸåˆå§‹ç±»çš„çŠ¶æ€</span><br>        original.restoreMemento(storage.memento);<br>        System.out.println(original.value);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Java å…­å¤§è®¾è®¡åŸåˆ™ï¼Œå¹¶éƒ½è¿›è¡Œäº†ä¸¾ä¾‹è¯´æ˜ï¼š</p><blockquote><p>1ã€å¼€é—­åŸåˆ™</p><p>2ã€é‡Œæ°æ›¿æ¢åŸåˆ™</p><p>3ã€ä¾èµ–å€’ç½®åŸåˆ™</p><p>4ã€è¿ªç±³ç‰¹æ³•åˆ™</p><p>5ã€æ¥å£éš”ç¦»åŸåˆ™</p><p>6ã€å•ä¸€æŒ‡è´£åŸåˆ™</p></blockquote><p>å…¶ä¸­ï¼Œå¼€é—­åŸåˆ™æ˜¯æœ€åŸºç¡€çš„åŸåˆ™ï¼Œå…¶ä»–åŸåˆ™éƒ½æ˜¯å¼€é—­åŸåˆ™çš„å…·ä½“å½¢æ€</p><p>2ã€24 ç§è®¾è®¡æ¨¡å¼ï¼Œå¹¶è¿›è¡Œäº†ä¸¾ä¾‹è¯´æ˜</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/065309c960f2498e926b3f59d275f7cb~tplv-k3u1fbpfcp-watermark.image?" alt="yuque_mind.jpeg" style="zoom:50%;" /><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android é€†å‘ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šAndroid APK ä»£ç æ··æ·†</title>
    <link href="/2022/10/30/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AAndroid%20%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/10/30/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AAndroid%20%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69c11cc1dd28438fa71cc271ea2c4911~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²äº†ï¼š</p><blockquote><p>1ã€ä½¿ç”¨ apktool åç¼–è¯‘ app ä¸­çš„èµ„æº</p><p>2ã€ä½¿ç”¨ dex2jar + jd-gui åç¼–è¯‘ app ä¸­çš„ä»£ç </p><p>3ã€åŸºäºä¸€ä¸ª app æ‰“é€ ä¸€ä¸ªæ–°çš„ appï¼Œä¸»è¦é€šè¿‡ apktool åç¼–è¯‘åï¼Œä¿®æ”¹èµ„æºï¼Œç„¶åè¿›è¡Œé‡æ–°æ‰“åŒ…ï¼Œç­¾åï¼Œå¯¹é½ï¼Œæœ€åå®‰è£…å±•ç¤ºäº†é¢„æœŸçš„æ•ˆæœã€‚å½“ç„¶è¿™é‡Œä½ æœ‰èƒ½åŠ›çœ‹æ‡‚ <code>.smali</code>æ ¼å¼çš„ä»£ç ï¼Œé‚£ä¹ˆä½ å¯ä»¥åšçš„äº‹æƒ…å°±æ›´åŠ å¤š</p></blockquote><p>è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7158107697907236878">Android é€†å‘ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šåç¼–è¯‘ APK æŠ€æœ¯å®Œå…¨è§£æ</a> </p><p>ä½ èƒ½æ”»å‡»æˆ‘çš„ appï¼Œé‚£æˆ‘è‚¯å®šæœ‰é˜²å®ˆçš„ç­–ç•¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ Android ä¸­çš„æ··æ·†æŠ€æœ¯</p><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢æ¼”ç¤ºå‡æ˜¯åœ¨ mac ä¸‹è¿›è¡Œ</p><p>Github Demo åœ°å€ï¼š<a href="https://github.com/sweetying520/codeandnotes/tree/master/Reverse/AndroidReverseDemo">https://github.com/sweetying520/codeandnotes/tree/master/Reverse/AndroidReverseDemo</a></p><h2 id="ä¸€ã€jadx-ä»‹ç»"><a href="#ä¸€ã€jadx-ä»‹ç»" class="headerlink" title="ä¸€ã€jadx ä»‹ç»"></a>ä¸€ã€jadx ä»‹ç»</h2><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æƒ³ä»‹ç»å¦å¤–ä¸€æ¬¾åç¼–è¯‘å·¥å…·ï¼šjadxï¼Œå®ƒç›¸å½“äºæ˜¯ apktool + dex2jar + jd-gui çš„ç»“åˆä½“ï¼Œæ—¢èƒ½åç¼–è¯‘ä»£ç ä¹Ÿèƒ½åç¼–è¯‘èµ„æºï¼Œå…³é”®ä½¿ç”¨èµ·æ¥è¿˜ç‰¹åˆ«ç®€å•ï¼Œä½ åªéœ€è¦å°†æ–‡ä»¶æ‹–è¿›æ¥å³å¯ï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</p><p>Github åœ°å€ï¼š<a href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a></p><h3 id="1-1ã€jadx-ç‰¹ç‚¹"><a href="#1-1ã€jadx-ç‰¹ç‚¹" class="headerlink" title="1.1ã€jadx ç‰¹ç‚¹"></a>1.1ã€jadx ç‰¹ç‚¹</h3><p>1ã€èƒ½å°† APKï¼ŒAARï¼ŒJARï¼ŒDEXï¼ŒAABï¼ŒZIP ç­‰æ–‡ä»¶ä¸­çš„ä»£ç åç¼–è¯‘ä¸º Java ç±»</p><p>2ã€èƒ½åç¼–è¯‘ APKï¼ŒAARï¼ŒAABï¼ŒZIP ä¸­çš„èµ„æº</p><h3 id="1-2ã€jadx-å®‰è£…"><a href="#1-2ã€jadx-å®‰è£…" class="headerlink" title="1.2ã€jadx å®‰è£…"></a>1.2ã€jadx å®‰è£…</h3><p>1ã€å®‰è£… jadxï¼Œæ¨èä½¿ç”¨ brew å»å®‰è£…ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">brew install jadx<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ brew å®‰è£…çš„å¥½å¤„å°±æ˜¯ mac ä¼šç»™ä½ è‡ªåŠ¨é…ç½®å¥½ç¯å¢ƒå˜é‡ï¼Œä½ åªéœ€è¦ä¸“æ³¨è½¯ä»¶çš„ä½¿ç”¨å³å¯ï¼Œç­‰å¾…å®‰è£…å®Œæˆåœ¨éªŒè¯ä¸€ä¸‹</p><p>2ã€jadx éªŒè¯</p><p>åœ¨ Terminal è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">jadx --version<br></code></pre></td></tr></table></figure><p>å¦‚æœæ‰“å°å‡ºäº†ç‰ˆæœ¬å·å°±è¯æ˜å®‰è£…æˆåŠŸäº†ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8831a8a770834ae98472734f8f1969c1~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221120114904120.png" width="100%" /><h3 id="1-3ã€jadx-ä½¿ç”¨"><a href="#1-3ã€jadx-ä½¿ç”¨" class="headerlink" title="1.3ã€jadx ä½¿ç”¨"></a>1.3ã€jadx ä½¿ç”¨</h3><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ jadx æä¾›çš„å¯è§†åŒ–ç•Œé¢è¿›è¡Œæ“ä½œ</p><p>1ã€åœ¨ Terminal è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">jadx-gui<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å°±ä¼šæ‰“å¼€ jadx çš„å¯è§†åŒ–ç•Œé¢äº†ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4df163ef7494b80885ba67ae8d8a599~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221120115550128.png" width="100%" /><p>2ã€å°†ä½ éœ€è¦åç¼–è¯‘çš„æ–‡ä»¶æ‹–å…¥å³å¯æŸ¥çœ‹åç¼–è¯‘çš„ä»£ç å’Œèµ„æºäº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3fd5fe17d996473db829353c8219072b~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120120509515.png"></p><h2 id="äºŒã€æ··æ·†-APK-ä»£ç "><a href="#äºŒã€æ··æ·†-APK-ä»£ç " class="headerlink" title="äºŒã€æ··æ·† APK ä»£ç "></a>äºŒã€æ··æ·† APK ä»£ç </h2><h3 id="2-1ã€å‡†å¤‡å·¥ä½œ"><a href="#2-1ã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="2.1ã€å‡†å¤‡å·¥ä½œ"></a>2.1ã€å‡†å¤‡å·¥ä½œ</h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œ</p><p>1ã€æ·»åŠ ä¸€äº›ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€æ–°å»º Utils.java æ–‡ä»¶ï¼Œåˆ›å»º Utils ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Utils</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodNormal</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">logMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;this is normal method&quot;</span>;<br>        logMessage = logMessage.toLowerCase();<br>        System.out.println(logMessage);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodUnused</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">logMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;this is unused method&quot;</span>;<br>        logMessage = logMessage.toLowerCase();<br>        System.out.println(logMessage);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æ–°å»º NativeUtils.java æ–‡ä»¶ï¼Œåˆ›å»º NativeUtils ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NativeUtils</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodNative</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodNotNative</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">logMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;this is not native method&quot;</span>;<br>        logMessage = logMessage.toLowerCase();<br>        System.out.println(logMessage);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æ–°å»º MyFragment.java æ–‡ä»¶ï¼Œåˆ›å»º MyFragment ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFragment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">toastTips</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;toast in MyFragment&quot;</span>;<br><br>    <span class="hljs-meta">@Nullable</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> LayoutInflater inflater, <span class="hljs-meta">@Nullable</span> ViewGroup container, <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-type">View</span> <span class="hljs-variable">rootView</span> <span class="hljs-operator">=</span> inflater.inflate(R.layout.fragment_layout,container,<span class="hljs-literal">false</span>);<br>        methodWithGlobalVariable();<br>        methodWithLocalVariable();<br>        <span class="hljs-keyword">return</span> rootView;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodWithGlobalVariable</span><span class="hljs-params">()</span> &#123;<br>        Toast.makeText(getActivity(), toastTips, Toast.LENGTH_SHORT).show();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodWithLocalVariable</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">logMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;log in MyFragment&quot;</span>;<br>        logMessage = logMessage.toLowerCase();<br>        System.out.println(logMessage);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ¥ç€åœ¨ MainActivity ä¸­è¿›è¡Œå¼•ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">toastTips</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;toast in MainActivity&quot;</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        getSupportFragmentManager().beginTransaction().add(R.id.flFragmentContainer,<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyFragment</span>()).commit();<br>        <span class="hljs-comment">//1ã€Utils ä¸‹çš„æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-type">Utils</span> <span class="hljs-variable">utils</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Utils</span>();<br>        utils.methodNormal();<br>        <span class="hljs-comment">//2ã€NativeUtils ä¸‹çš„æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            NativeUtils.methodNative();<br>            NativeUtils.methodNotNative();<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-comment">//3ã€ç¬¬ä¸‰æ–¹åº“ä¸‹å·¥å…·ç±»çš„æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> StringUtils.getLength(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>        System.out.println(result);<br>        <span class="hljs-comment">//4ã€MainActivity ä¸‹çš„ methodWithGlobalVariable æ–¹æ³•è°ƒç”¨</span><br>        methodWithGlobalVariable();<br>        <span class="hljs-comment">//5ã€MainActivity ä¸‹çš„ methodWithLocalVariable æ–¹æ³•è°ƒç”¨</span><br>        methodWithLocalVariable();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodWithGlobalVariable</span><span class="hljs-params">()</span> &#123;<br>        Toast.makeText(<span class="hljs-built_in">this</span>, toastTips, Toast.LENGTH_SHORT).show();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodWithLocalVariable</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">logMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;log in MainActivity&quot;</span>;<br>        logMessage = logMessage.toLowerCase();<br>        System.out.println(logMessage);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¥½çš„ï¼Œåˆ°è¿™é‡Œå‡†å¤‡å·¥ä½œå·²ç»åŸºæœ¬å®Œæˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ APK ä¸­çš„ä»£ç è¿›è¡Œæ··æ·†</p><h3 id="2-2ã€å¼€å¯æ··æ·†æ‰“-APK-åŒ…"><a href="#2-2ã€å¼€å¯æ··æ·†æ‰“-APK-åŒ…" class="headerlink" title="2.2ã€å¼€å¯æ··æ·†æ‰“ APK åŒ…"></a>2.2ã€å¼€å¯æ··æ·†æ‰“ APK åŒ…</h3><p>1ã€åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­çš„ android é—­åŒ…ä¸‹ çš„ release é—­åŒ…ä¸­å¼€å¯ä»£ç æ··æ·†ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    buildTypes &#123;<br>        release &#123;<br>            <span class="hljs-comment">//å¼€å¯ä»£ç æ··æ·†</span><br>            minifyEnabled <span class="hljs-literal">true</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æˆ‘ä»¬ä»…æ˜¯æŠŠ minifyEnabled æ”¹ä¸º true å³å¼€å¯äº†ä»£ç æ··æ·†ï¼Œéå¸¸çš„ç®€å•</p><p><strong>å¦å¤–éœ€è¦æ³¨æ„</strong>ï¼š è¿™é‡Œæ˜¯åœ¨ release é—­åŒ…å†…è¿›è¡Œé…ç½®çš„ï¼Œå› æ­¤åªæœ‰æ‰“å‡ºæ­£å¼ç‰ˆçš„ APK æ‰ä¼šè¿›è¡Œæ··æ·†ï¼Œdebug ç‰ˆçš„ APK æ˜¯ä¸ä¼šæ··æ·†çš„ã€‚å½“ç„¶è¿™ä¹Ÿæ˜¯éå¸¸åˆç†çš„ï¼Œå› ä¸º debug ç‰ˆçš„ APK æ–‡ä»¶æˆ‘ä»¬åªä¼šç”¨æ¥å†…éƒ¨æµ‹è¯•ï¼Œä¸ç”¨æ‹…å¿ƒè¢«äººç ´è§£ã€‚</p><p>2ã€æ¥ä¸‹æ¥æ‰“ä¸€ä¸ªæ­£å¼çš„ APK åŒ…</p><blockquote><p> 1ã€åœ¨ Android Studio å¯¼èˆªæ ä¸­ç‚¹å‡» Build -&gt; Generate Signed Bundle or APKï¼Œé€‰æ‹© APK</p><p> 2ã€ç„¶åé€‰æ‹©ç­¾åæ–‡ä»¶å¹¶è¾“å…¥å¯†ç ï¼Œå¦‚æœæ²¡æœ‰ç­¾åæ–‡ä»¶å°±åˆ›å»ºä¸€ä¸ª</p><p> 3ã€ç‚¹å‡» next é€‰æ‹©æ‰“ release åŒ…ï¼Œæœ€ç»ˆç‚¹å‡» Finish å®Œæˆæ‰“åŒ…</p><p> 4ã€ç”Ÿæˆçš„ APK ä¼šè‡ªåŠ¨å­˜æ”¾åœ¨ app&#x2F;release&#x2F; ç›®å½•ä¸‹</p></blockquote><p><strong>Tips</strong>ï¼š æˆ‘ä»¬å¯ä»¥åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­æ·»åŠ ç­¾åæ–‡ä»¶é…ç½®ï¼Œåç»­å°±å¯ä»¥ç›´æ¥é€šè¿‡ <code>./gradlew assembleRelease</code> å‘½ä»¤æˆ–è€… AndroidStudio å³ä¾§çš„ Gradle å¯è§†åŒ–ç•Œé¢å»æ“ä½œï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    <span class="hljs-comment">//1ã€å£°æ˜ç­¾åæ–‡ä»¶</span><br>    signingConfigs&#123;<br>        release&#123;<br>            storeFile file(<span class="hljs-string">&#x27;../Certificate&#x27;</span>)<br>            storePassword <span class="hljs-string">&#x27;erdai666&#x27;</span><br>            keyAlias <span class="hljs-string">&#x27;key0&#x27;</span><br>            keyPassword <span class="hljs-string">&#x27;erdai666&#x27;</span><br>        &#125;<br>    &#125;<br><br>    buildTypes &#123;<br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">true</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>            <span class="hljs-comment">//2ã€é…ç½®ç­¾åæ–‡ä»¶</span><br>            signingConfig signingConfigs.release<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>éœ€è¦æ³¨æ„</strong>ï¼š</p><p>1ã€ä½¿ç”¨ AndroidStudio å¯¼èˆªæ  Generate Signed Bundle or APK æ–¹å¼ç”Ÿæˆçš„ APK åœ¨ï¼šapp&#x2F;release&#x2F; ç›®å½•ä¸‹</p><p>2ã€ä½¿ç”¨ <code>./gradlew assembleRelease</code> å‘½ä»¤æˆ–è€… AndroidStudio å³ä¾§çš„ Gradle å¯è§†åŒ–ç•Œç”Ÿæˆçš„ APK åœ¨ï¼šapp&#x2F;build&#x2F;outputs&#x2F;apk&#x2F; ç›®å½•ä¸‹</p><p>3ã€æ¥ç€ä½¿ç”¨ jadx æ‰“å¼€å½“å‰ APKï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4daa87636c443a7b303d7c420d92a9a~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221120155231247.png" width="50%" /><p>å¾ˆæ˜æ˜¾æˆ‘ä»¬ä»£ç æ··æ·†çš„åŠŸèƒ½å·²ç»ç”Ÿæ•ˆäº†ã€‚</p><h3 id="2-3ã€æ··æ·†æ–‡ä»¶ä»‹ç»"><a href="#2-3ã€æ··æ·†æ–‡ä»¶ä»‹ç»" class="headerlink" title="2.3ã€æ··æ·†æ–‡ä»¶ä»‹ç»"></a>2.3ã€æ··æ·†æ–‡ä»¶ä»‹ç»</h3><p>ä¸‹é¢æˆ‘ä»¬å°è¯•æ¥é˜…è¯»ä¸€ä¸‹æ··æ·†åä¹‹å‰å‡†å¤‡çš„é‚£äº›ç±»ï¼š</p><p><strong>MainActivity</strong>ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16c051e4dff4455594ed988b047da110~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120155602155.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€MyFragment è¢«æ··æ·†äº†</p><p>2ã€Utils ä¸‹çš„æ–¹æ³•è°ƒç”¨ï¼šç›´æ¥æ˜¯æŠŠæ–¹æ³•é‡Œé¢çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p>3ã€NativeUtils ä¸‹çš„æ–¹æ³•è°ƒç”¨ï¼š1ã€Native æ–¹æ³•è¿˜æ˜¯æ­£å¸¸çš„è°ƒç”¨ 2ã€é Native æ–¹æ³•åˆ™æ˜¯æŠŠæ–¹æ³•é‡Œé¢çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p>4ã€ç¬¬ä¸‰æ–¹åº“ä¸‹å·¥å…·ç±»çš„æ–¹æ³•è°ƒç”¨ï¼šç›´æ¥æ˜¯å°†æ–¹æ³•çš„ç»“æœå¡«å……åˆ°äº†è°ƒç”¨å¤„</p><p>5ã€MainActivity ä¸­çš„æˆå‘˜æ–¹æ³•ï¼šç›´æ¥æ˜¯æŠŠæˆå‘˜æ–¹æ³•é‡Œé¢çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p>6ã€MainActivity ç±»åæ˜¯æ²¡æœ‰æ··æ·†çš„ï¼ŒonCreate æ–¹æ³•ä¹Ÿæ²¡æœ‰è¢«æ··æ·†ï¼Œä½†å®šä¹‰çš„æˆå‘˜å˜é‡ï¼Œå±€éƒ¨å˜é‡è¢«æ··æ·†äº†</p><p><strong>Utils</strong>ï¼š</p><p>Utils ç±»ç›´æ¥æ²¡æœ‰äº†</p><p><strong>NativeUtils</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da03c226d69248e6a7ac1c21d8ab5dd0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120161144262.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€NativeUtils ç±»åæ²¡æœ‰è¢«æ··æ·†ï¼Œå…¶ä¸­å£°æ˜æˆ native çš„æ–¹æ³•ä¹Ÿæ²¡æœ‰è¢«æ··æ·†</p><p>2ã€é Native æ–¹æ³•ç›´æ¥æ²¡æœ‰äº†ï¼Œæ–¹æ³•çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p><strong>MyFragment</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7f414c7031f4e0f91f9b2d2fdc777c0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120161641862.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€æ‰€æœ‰çš„æ–¹æ³•åï¼Œæˆå‘˜å˜é‡ï¼Œå±€éƒ¨å˜é‡éƒ½è¢«æ··æ·†äº†</p><p>2ã€MyFragment ä¸­çš„æˆå‘˜æ–¹æ³•ï¼šç›´æ¥æ˜¯æŠŠæˆå‘˜æ–¹æ³•é‡Œé¢çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p>æ¥ä¸‹æ¥åœ¨<strong>åˆ†æä¸€ä¸‹ä¸Šé¢çš„æ··æ·†ç»“æœ</strong>ï¼š</p><blockquote><p>1ã€Utils ç›´æ¥æ²¡æœ‰äº†ï¼Œå› ä¸ºå®ƒè¢«è°ƒç”¨çš„æ–¹æ³•å†…å®¹ç›´æ¥æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„ã€‚å¦å¤–ä¸€ä¸ªæ–¹æ³•æ²¡æœ‰è¢«è°ƒç”¨ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯å¤šä½™çš„ä»£ç ï¼Œåœ¨æ‰“åŒ…çš„æ—¶å€™å°±ç»™ç§»é™¤æ‰äº†ï¼Œä¸ä»…ä»…æ˜¯æ–¹æ³•ï¼Œæ²¡æœ‰è°ƒç”¨çš„èµ„æºåŒæ ·ä¼šè¢«ç§»é™¤ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å¯ä»¥å‡å°‘ APK çš„ä½“ç§¯</p><p>2ã€NativeUtils ç±»åæ²¡æœ‰è¢«æ··æ·†ï¼Œè¿™æ˜¯ç”±äºå®ƒæœ‰ä¸€ä¸ªå£°æ˜æˆ native çš„æ–¹æ³•ã€‚åªè¦ä¸€ä¸ªç±»ä¸­æœ‰å­˜åœ¨ native æ–¹æ³•ï¼Œå®ƒçš„ç±»åå°±ä¸ä¼šè¢«æ··æ·†ï¼Œnative æ–¹æ³•çš„æ–¹æ³•åä¹Ÿä¸ä¼šè¢«æ··æ·†ï¼Œå› ä¸º C æˆ– C++ ä»£ç è¦é€šè¿‡<code>åŒ…å+ç±»å+æ–¹æ³•åæ¥</code>è¿›è¡Œäº¤äº’ã€‚ ä½†æ˜¯ç±»ä¸­åˆ«çš„ä»£ç è¿˜æ˜¯ä¼šè¢«æ··æ·†ï¼Œå®ƒçš„é Native æ–¹æ³•ç›´æ¥æ²¡æœ‰äº†ï¼Œå› ä¸ºæ–¹æ³•é‡Œé¢çš„å†…å®¹æ‹·è´åˆ°äº†æ–¹æ³•çš„è°ƒç”¨å¤„</p><p>3ã€MyFragment æ˜¯æ··æ·†çš„æ¯”è¾ƒå½»åº•çš„ï¼ŒåŸºæœ¬æ²¡æœ‰ä»»ä½•ä¿ç•™ï¼Œè¿ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹Ÿè¢«æ··æ·†äº†ï¼ŒFragment æ€ä¹ˆè¯´ä¹Ÿç®—æ˜¯ä¸€ä¸ªç³»ç»Ÿç»„ä»¶å§ï¼Œæçš„ä¸€ç‚¹é¢å­éƒ½æ²¡æœ‰ğŸ˜‚</p><p>4ã€MainActivity çš„ä¿ç•™ç¨‹åº¦å°±æ¯” MyFragment å¥½å¤šäº†ï¼Œè‡³å°‘åƒç±»åï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•éƒ½æ²¡æœ‰è¢«æ··æ·†ï¼Œè¿™æ˜¯å› ä¸ºï¼š<strong>å‡¡æ˜¯éœ€è¦åœ¨ AndroidManifest.xml ä¸­æ³¨å†Œçš„æ‰€æœ‰ç±»çš„ç±»åä»¥åŠä»çˆ¶ç±»é‡å†™çš„æ–¹æ³•åéƒ½ä¸ä¼šè¢«æ··æ·†ã€‚</strong>  å› æ­¤ï¼Œé™¤äº† Activity ä¹‹å¤–ï¼Œè¿™ä»½è§„åˆ™åŒæ ·é€‚ç”¨äºï¼šServiceï¼ŒBroadcastReceiver å’Œ ContentProvider</p><p>5ã€å¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“ä¹Ÿè¢«æ··æ·†äº†ï¼Œä¸Šè¿°å¯ä»¥çœ‹åˆ°ç›´æ¥æ˜¯æŠŠæ–¹æ³•è°ƒç”¨çš„ç»“æœç»™å¡«å……äº†è¿›æ¥</p></blockquote><h3 id="2-4ã€é»˜è®¤æ··æ·†è§„åˆ™ä»‹ç»"><a href="#2-4ã€é»˜è®¤æ··æ·†è§„åˆ™ä»‹ç»" class="headerlink" title="2.4ã€é»˜è®¤æ··æ·†è§„åˆ™ä»‹ç»"></a>2.4ã€é»˜è®¤æ··æ·†è§„åˆ™ä»‹ç»</h3><p>é‚£ä¹ˆè¿™äº›æ··æ·†è§„åˆ™æ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„å‘¢ï¼Ÿå…¶å®å°±æ˜¯åˆšæ‰åœ¨ build.gradle çš„ release é—­åŒ…ä¸‹é…ç½®çš„ proguard-android-optimize.txt æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å­˜æ”¾äº<code>Android SDK/tools/proguard/</code>ç›®å½•ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9ca083fd88548ffb04ade1b3aab721d~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120165304203.png"></p><p>çœ‹ä¸€çœ¼å®ƒçš„å…·ä½“å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs xml"># This is a configuration file for ProGuard.<br># http://proguard.sourceforge.net/index.html#manual/usage.html<br>#<br># This file is no longer maintained and is not used by new (2.2+) versions of the<br># Android plugin for Gradle. Instead, the Android plugin for Gradle generates the<br># default rules at build time and stores them in the build directory.<br><br># Optimizations: If you don&#x27;t want to optimize, use the<br># proguard-android.txt configuration file instead of this one, which<br># turns off the optimization flags.  Adding optimization introduces<br># certain risks, since for example not all optimizations performed by<br># ProGuard works on all versions of Dalvik.  The following flags turn<br># off various optimizations known to have issues, but the list may not<br># be complete or up to date. (The &quot;arithmetic&quot; optimization can be<br># used if you are only targeting Android 2.0 or later.)  Make sure you<br># test thoroughly if you go this route.<br>-optimizations !code/simplification/arithmetic,!code/simplification/cast,!field/*,!class/merging/*<br>-optimizationpasses 5<br>-allowaccessmodification<br>-dontpreverify<br><br># The remainder of this file is identical to the non-optimized version<br># of the Proguard configuration file (except that the other file has<br># flags to turn off optimization).<br><br>-dontusemixedcaseclassnames<br>-dontskipnonpubliclibraryclasses<br>-verbose<br><br>-keepattributes *Annotation*<br>-keep public class com.google.vending.licensing.ILicensingService<br>-keep public class com.android.vending.licensing.ILicensingService<br><br># For native methods, see http://proguard.sourceforge.net/manual/examples.html#native<br>-keepclasseswithmembernames class * &#123;<br>    native <span class="hljs-tag">&lt;<span class="hljs-name">methods</span>&gt;</span>;<br>&#125;<br><br># keep setters in Views so that animations can still work.<br># see http://proguard.sourceforge.net/manual/examples.html#beans<br>-keepclassmembers public class * extends android.view.View &#123;<br>   void set*(***);<br>   *** get*();<br>&#125;<br><br># We want to keep methods in Activity that could be used in the XML attribute onClick<br>-keepclassmembers class * extends android.app.Activity &#123;<br>   public void *(android.view.View);<br>&#125;<br><br># For enumeration classes, see http://proguard.sourceforge.net/manual/examples.html#enumerations<br>-keepclassmembers enum * &#123;<br>    public static **[] values();<br>    public static ** valueOf(java.lang.String);<br>&#125;<br><br>-keepclassmembers class * implements android.os.Parcelable &#123;<br>  public static final android.os.Parcelable$Creator CREATOR;<br>&#125;<br><br>-keepclassmembers class **.R$* &#123;<br>    public static <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>;<br>&#125;<br><br># The support library contains references to newer platform versions.<br># Don&#x27;t warn about those in case this app is linking against an older<br># platform version.  We know about them, and they are safe.<br>-dontwarn android.support.**<br><br># Understand the @Keep support annotation.<br>-keep class android.support.annotation.Keep<br><br>-keep @android.support.annotation.Keep class * &#123;*;&#125;<br><br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">methods</span>&gt;</span>;<br>&#125;<br><br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>;<br>&#125;<br><br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(...);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯é»˜è®¤çš„æ··æ·†é…ç½®æ–‡ä»¶äº†ï¼Œæˆ‘ä»¬æ¥é€è¡Œè§£é‡Šä¸€ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs xml"># å¯åŠ¨ä¼˜åŒ–ç›¸å…³çš„ä¸€äº›é…ç½®<br># æŒ‡å®šæ›´ç²¾ç»†çº§åˆ«çš„ä¼˜åŒ–<br>-optimizations !code/simplification/arithmetic,!code/simplification/cast,!field/*,!class/merging/*<br># è¡¨ç¤ºå¯¹ä»£ç ä¼˜åŒ–çš„æ¬¡æ•°ï¼Œä¸€èˆ¬ä¸º 5<br>-optimizationpasses 5<br># å…è®¸æ”¹å˜ä½œç”¨åŸŸ<br>-allowaccessmodification<br># å…³é—­é¢„éªŒè¯<br>-dontpreverify<br><br># è¡¨ç¤ºæ··æ·†æ—¶ä¸ä½¿ç”¨å¤§å°å†™æ··åˆç±»å<br>-dontusemixedcaseclassnames<br><br># è¡¨ç¤ºä¸è·³è¿‡ library ä¸­çš„é public ç±»<br>-dontskipnonpubliclibraryclasses<br><br># è¡¨ç¤ºæ‰“å°æ··æ·†çš„è¯¦ç»†ä¿¡æ¯<br>-verbose<br><br>#è¡¨ç¤ºå¯¹æ³¨è§£ä¸­çš„å‚æ•°è¿›è¡Œä¿ç•™<br>-keepattributes *Annotation*<br><br># è¡¨ç¤ºä¸æ··æ·†å¦‚ä¸‹å£°æ˜çš„ä¸¤ä¸ªç±»ï¼Œè¿™ä¸¤ä¸ªç±»åŸºæœ¬ä¸Šä¹Ÿç”¨ä¸ä¸Šï¼Œæ˜¯æ¥å…¥ Google åŸç”Ÿçš„ä¸€äº›æœåŠ¡æ—¶ä½¿ç”¨çš„<br>-keep public class com.google.vending.licensing.ILicensingService<br>-keep public class com.android.vending.licensing.ILicensingService<br><br># è¡¨ç¤ºä¸æ··æ·†ä»»ä½•åŒ…å« native æ–¹æ³•çš„ç±»åä»¥åŠ native æ–¹æ³•åï¼Œè¿™ä¸ªå’Œåˆšæ‰éªŒè¯çš„ç»“æœæ˜¯ä¸€è‡´çš„<br>-keepclasseswithmembernames class * &#123;<br>    native <span class="hljs-tag">&lt;<span class="hljs-name">methods</span>&gt;</span>;<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·† View ä¸­çš„ setXXX() å’Œ getXXX() æ–¹æ³•ï¼Œå› ä¸ºå±æ€§åŠ¨ç”»éœ€è¦æœ‰ç›¸åº”çš„ setter å’Œ getter æ–¹æ³•å®ç°<br>-keepclassmembers public class * extends android.view.View &#123;<br>   void set*(***);<br>   *** get*();<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·† Activity ä¸­å‚æ•°æ˜¯ View çš„æ–¹æ³•ï¼Œå› ä¸ºæœ‰è¿™ä¹ˆä¸€ç§ç”¨æ³•ï¼Œåœ¨ XML ä¸­é…ç½® android:onClick=&quot;btnClick&quot; å±æ€§ï¼Œæ··æ·†å°±æ‰¾<br># ä¸åˆ°äº†<br>-keepclassmembers class * extends android.app.Activity &#123;<br>   public void *(android.view.View);<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·†æšä¸¾çš„ values() å’Œ valueOf() æ–¹æ³•<br>-keepclassmembers enum * &#123;<br>    public static **[] values();<br>    public static ** valueOf(java.lang.String);<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·† Parcelable å®ç°ç±»ä¸­çš„ CREATOR å­—æ®µï¼Œæ¯«æ— ç–‘é—®ï¼ŒCREATOR å­—æ®µæ˜¯ç»å¯¹ä¸èƒ½æ”¹å˜çš„ï¼ŒåŒ…æ‹¬å¤§å°å†™éƒ½ä¸èƒ½å˜ï¼Œä¸ç„¶æ•´ä¸ª<br># Parcelable å·¥ä½œæœºåˆ¶éƒ½ä¼šå¤±æ•ˆ<br>-keepclassmembers class * implements android.os.Parcelable &#123;<br>  public static final android.os.Parcelable$Creator CREATOR;<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·† R æ–‡ä»¶ä¸­çš„æ‰€æœ‰é™æ€å­—æ®µï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ R æ–‡ä»¶æ˜¯é€šè¿‡å­—æ®µæ¥è®°å½•æ¯ä¸ªèµ„æº id ï¼Œå­—æ®µåå¦‚æœè¢«æ··æ·†ï¼Œid å°±æ‰¾ä¸åˆ°äº†<br>-keepclassmembers class **.R$* &#123;<br>    public static <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>;<br>&#125;<br>      <br># è¡¨ç¤ºå¯¹ android.support åŒ…ä¸‹çš„ä»£ç ä¸è­¦å‘Šï¼Œå› ä¸º support åŒ…ä¸­çš„æ‰€æœ‰ä»£ç éƒ½åœ¨å…¼å®¹æ€§ä¸Šåšäº†è¶³å¤Ÿçš„åˆ¤æ–­ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒä»£ç ä¼šå‡ºé—®é¢˜<br># æ‰€ä»¥ç›´æ¥å¿½ç•¥è­¦å‘Šå°±å¯ä»¥äº†<br>-dontwarn android.support.**<br>      <br># è¡¨ç¤ºä¸æ··æ·† android.support.annotation.Keep è¿™ä¸ªæ³¨è§£ç±»çš„æ‰€æœ‰ä¸œè¥¿<br>-keep class android.support.annotation.Keep<br>      <br># è¡¨ç¤ºä¸æ··æ·†ä½¿ç”¨äº† class android.support.Keep æ³¨è§£çš„ç±»çš„æ‰€æœ‰ä¸œè¥¿<br>-keep @android.support.annotation.Keep class * &#123;*;&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·†ç±»åå’Œç±»ä¸­ä½¿ç”¨äº† class android.support.Keep æ³¨è§£çš„æ–¹æ³•<br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">methods</span>&gt;</span>;<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·†ç±»åå’Œç±»ä¸­ä½¿ç”¨äº† class android.support.Keep æ³¨è§£çš„å±æ€§<br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>;<br>&#125;<br>      <br># è¡¨ç¤ºä¸æ··æ·†ç±»åå’Œç±»ä¸­ä½¿ç”¨äº† class android.support.Keep æ³¨è§£çš„æ„é€ æ–¹æ³•<br>-keepclasseswithmembers class * &#123;<br>    @android.support.annotation.Keep <span class="hljs-tag">&lt;<span class="hljs-name">init</span>&gt;</span>(...);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-4-1ã€proguard-android-optimize-txt-å’Œ-proguard-android-txt-åŒºåˆ«"><a href="#2-4-1ã€proguard-android-optimize-txt-å’Œ-proguard-android-txt-åŒºåˆ«" class="headerlink" title="2.4.1ã€proguard-android-optimize.txt å’Œ proguard-android.txt åŒºåˆ«"></a>2.4.1ã€proguard-android-optimize.txt å’Œ proguard-android.txt åŒºåˆ«</h4><p>ä¹‹å‰ä¸€äº› AGP è€ç‰ˆæœ¬ï¼Œæˆ‘ä»¬æ–°å»ºå·¥ç¨‹é»˜è®¤ä½¿ç”¨çš„æ˜¯ï¼šproguard-android.txtï¼Œé‚£ä¹ˆå®ƒå’Œ proguard-android-optimize.txt æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿ</p><p>ä»å­—é¢çš„ç»´åº¦çœ‹ï¼Œå°±å¤šäº†ä¸€ä¸ª optimizeï¼ˆä¼˜åŒ–ï¼‰è¿™ä¸ªå•è¯ï¼Œå®é™…å°±æ˜¯å¤šäº†ä¼˜åŒ–è¿™ä¸€éƒ¨åˆ†ï¼Œproguard-android-optimize.txt ç›¸å¯¹äº proguard-android.txt å¼€å¯äº†ä¼˜åŒ–ç›¸å…³çš„é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"># proguard-android-optimize.txt æ–°å¢äº†ä»¥ä¸‹ä¼˜åŒ–è§„åˆ™<br>-optimizations !code/simplification/arithmetic,!code/simplification/cast,!field/*,!class/merging/*<br>-optimizationpasses 5<br>-allowaccessmodification<br>-dontpreverify<br><br># proguard-android-optimize.txt åˆ é™¤äº†å…³é—­ä¼˜åŒ–æŒ‡ä»¤çš„é…ç½®<br># -dontoptimize<br></code></pre></td></tr></table></figure><p>å¥½äº†ï¼Œä¸Šè¿°å°±æ˜¯ proguard-android-optimize.txt æ–‡ä»¶ä¸­æ‰€æœ‰çš„é»˜è®¤é…ç½®ï¼Œè€Œæˆ‘ä»¬æ··æ·†ä»£ç ä¹Ÿæ˜¯æŒ‰ç…§è¿™äº›é…ç½®çš„è§„åˆ™æ¥è¿›è¡Œæ··æ·†çš„ã€‚ç»è¿‡ä¸Šé¢çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹è¿™äº›é…ç½®çš„å†…å®¹åŸºæœ¬éƒ½èƒ½ç†è§£äº†ã€‚ä¸è¿‡ Proguard è¯­æ³•ä¸­è¿˜çœŸæœ‰å‡ å¤„éå¸¸éš¾ç†è§£çš„åœ°æ–¹ï¼Œä¸‹é¢å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹è¿™äº›éš¾æ‡‚çš„è¯­æ³•éƒ¨åˆ†</p><h3 id="2-5ã€Proguard-ç–‘éš¾è¯­æ³•ä»‹ç»"><a href="#2-5ã€Proguard-ç–‘éš¾è¯­æ³•ä»‹ç»" class="headerlink" title="2.5ã€Proguard ç–‘éš¾è¯­æ³•ä»‹ç»"></a>2.5ã€Proguard ç–‘éš¾è¯­æ³•ä»‹ç»</h3><p>Proguard ä¸­ä¸€å…±æœ‰ä¸‰ç»„å…­ä¸ª keep å…³é”®å­—ï¼Œå¾ˆå¤šäººæä¸æ¸…æ¥šä»–ä»¬çš„åŒºåˆ«ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªè¡¨æ ¼ç›´è§‚çš„æ¥çœ‹ä¸€ä¸‹ï¼š</p><table><thead><tr><th>å…³é”®å­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>keep</td><td>ä¿ç•™ç±»å’Œç±»ä¸­çš„æˆå‘˜ä¸è¢«æ··æ·†æˆ–ç§»é™¤</td></tr><tr><td>keepnames</td><td>åœ¨ keep çš„åŸºç¡€ä¸Šï¼Œå¦‚æœæˆå‘˜æ²¡æœ‰è¢«å¼•ç”¨ï¼Œåˆ™ä¼šè¢«ç§»é™¤</td></tr><tr><td>keepclassmembers</td><td>ä¿ç•™ç±»æˆå‘˜ä¸è¢«æ··æ·†æˆ–ç§»é™¤</td></tr><tr><td>keepclassmembernames</td><td>åœ¨ keepclassmembers åŸºç¡€ä¸Šï¼Œå¦‚æœæˆå‘˜æ²¡æœ‰è¢«å¼•ç”¨ï¼Œåˆ™ä¼šè¢«ç§»é™¤</td></tr><tr><td>keepclasseswithmembers</td><td>ä¿ç•™ç±»å’Œç±»ä¸­çš„æˆå‘˜ä¸è¢«æ··æ·†æˆ–ç§»é™¤ï¼Œå‰ææ˜¯ç±»ä¸­çš„æˆå‘˜å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™è¿˜æ˜¯ä¼šè¢«æ··æ·†</td></tr><tr><td>keepclasseswithmembernames</td><td>åœ¨ keepclasseswithmembers åŸºç¡€ä¸Šï¼Œå¦‚æœæˆå‘˜æ²¡æœ‰è¢«å¼•ç”¨ï¼Œåˆ™ä¼šè¢«ç§»é™¤</td></tr></tbody></table><p>é™¤æ­¤ä¹‹å¤–ï¼ŒProguard çš„é€šé…ç¬¦ä¹Ÿæ¯”è¾ƒè®©äººéš¾æ‡‚ï¼Œproguard-android-optimize.txt ä¸­å°±ä½¿ç”¨åˆ°äº†å¾ˆå¤šé€šé…ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼š</p><table><thead><tr><th>é€šé…ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>&lt;field&gt;</code></td><td>åŒ¹é…ç±»ä¸­æ‰€æœ‰çš„å­—æ®µ</td></tr><tr><td><code>&lt;method&gt;</code></td><td>åŒ¹é…ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•</td></tr><tr><td><code>&lt;init&gt;</code></td><td>åŒ¹é…ç±»ä¸­æ‰€æœ‰çš„æ„é€ æ–¹æ³•</td></tr><tr><td><code>*</code></td><td>åŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼Œä½†ä¸åŒ…å«åˆ†éš”ç¬¦<code>.</code>ï¼Œä¾‹å¦‚æˆ‘ä»¬å®Œæˆç±»åæ˜¯ï¼šcom.dream.androidreversedemo.MainActivityï¼Œä½¿ç”¨ com.* æˆ–è€… com.dream.* æ˜¯æ— æ³•åŒ¹é…çš„ï¼Œå› ä¸º * æ— æ³•åŒ¹é…æŠ¥åä¸­çš„åˆ†éš”ç¬¦ï¼Œæ­£ç¡®çš„åŒ¹é…æ–¹å¼æ˜¯<code>com.dream.*.*</code>æˆ–è€…<code>com.dream.androidreversedemo.*</code></td></tr><tr><td><code>**</code></td><td>åŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼ŒåŒ…å«åˆ†éš”ç¬¦<code>.</code>ï¼Œä¸Šé¢åŒ¹é…è§„åˆ™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>com.**</code>æˆ–è€…<code>com.dream.**</code>æ¥è¿›è¡ŒåŒ¹é…</td></tr><tr><td><code>***</code></td><td>åŒ¹é…ä»»æ„å‚æ•°ç±»å‹ã€‚ä¾‹å¦‚<code>void set*(***)</code>å°±èƒ½åŒ¹é…ä¼ å…¥ä»»æ„çš„å‚æ•°ç±»å‹ï¼Œ<code>***get(*)</code>å°±èƒ½åŒ¹é…ä»»æ„è¿”å›å€¼çš„ç±»å‹</td></tr><tr><td><code>...</code></td><td>åŒ¹é…ä»»æ„é•¿åº¦çš„ä»»æ„ç±»å‹å‚æ•°ï¼Œä¾‹å¦‚<code>void test(...)</code>å°±èƒ½åŒ¹é…<code>void test(String str)</code>æˆ–è€…<code>void test(int a,double b)</code>è¿™äº›æ–¹æ³•</td></tr></tbody></table><p>okï¼Œå­¦ä¹ äº†ç–‘éš¾è¯­æ³•ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸€é“ç»ƒä¹ é¢˜ğŸ¤”ï¼šä¿ç•™å®ç°äº† com.dream.test.BaseJsonData æ¥å£çš„ç±»çš„æ‰€æœ‰ä¿¡æ¯ä¸è¢«æ··æ·†ï¼Ÿ</p><p>ä¸€ä¸ªæ¸…æ™°çš„æ€è·¯å¾ˆé‡è¦ï¼Œä»”ç»†åˆ†æä¸€ä¸‹ï¼š</p><p>1ã€é¦–å…ˆæˆ‘ä»¬è¦ä¿è¯  com.dream.test.BaseJsonData æ¥å£ä¸è¢«æ··æ·†</p><p>2ã€ç„¶åä¿è¯å®ç° com.dream.test.BaseJsonData æ¥å£çš„ç±»ä¸è¢«æ··æ·†</p><p>3ã€æœ€åå°±æ˜¯åŒ¹é…ç±»ä¸­æ‰€æœ‰çš„æˆå‘˜ä¸è¢«æ··æ·†ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ *</p><p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"># ä¿è¯  com.dream.test.BaseJsonData æ¥å£ä¸è¢«æ··æ·†<br>-keep class com.dream.test.BaseJsonData<br># ä¿è¯å®ç° com.dream.test.BaseJsonData æ¥å£çš„ç±»ä¸è¢«æ··æ·†<br># åŒ¹é…ç±»ä¸­æ‰€æœ‰çš„æˆå‘˜ä¸è¢«æ··æ·†ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ *<br>-keep class * implements com.dream.test.BaseJsonData&#123;<br>    *;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-6ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™"><a href="#2-6ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™" class="headerlink" title="2.6ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™"></a>2.6ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™</h3><p>å›åˆ°é¡¹ç›®ä¸­ï¼Œåˆšæ‰æ‰“å‡ºçš„ APK è™½ç„¶å·²ç»æˆåŠŸæ··æ·†äº†ï¼Œä½†æ˜¯æ··æ·†çš„è§„åˆ™æ˜¯æŒ‰ç…§ proguard-android-optimize.txt ä¸­é»˜è®¤çš„è§„åˆ™æ¥çš„ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ proguard-android-optimize.txt ä¸­çš„è§„åˆ™ï¼Œä½†æ˜¯è¿™æ ·åšä¼šå¯¹æœ¬æœºä¸Šæ‰€æœ‰é¡¹ç›®çš„æ··æ·†è§„åˆ™éƒ½ç”Ÿæ•ˆï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„åŠæ³•åªé’ˆå¯¹å½“å‰é¡¹ç›®åšæ··æ·†è§„åˆ™ä¿®æ”¹å‘¢ï¼Ÿ</p><p>ç­”ï¼šå¯¹ proguard-rules.pro æ–‡ä»¶è¿›è¡Œè‡ªå®šä¹‰æ··æ·†è§„åˆ™ç¼–å†™</p><p>å¯ä»¥çœ‹åˆ° android é—­åŒ…ä¸‹ release é—­åŒ…çš„é…ç½®ï¼Œå®é™…ä¸Šé…ç½®äº†ä¸¤ä¸ªæ··æ·†æ–‡ä»¶ï¼Œä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬å‰é¢ä»‹ç»çš„é»˜è®¤æ··æ·†è§„åˆ™ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯è‡ªå®šä¹‰æ··æ·†è§„åˆ™ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>  <br>    buildTypes &#123;<br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">true</span><br>            <span class="hljs-comment">//proguard-android-optimize.txtï¼šé»˜è®¤æ··æ·†è§„åˆ™ proguard-rules.proï¼šè‡ªå®šä¹‰æ··æ·†è§„åˆ™</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>proguard-rules.pro æ–‡ä»¶ä½äº app ç›®å½•ä¸‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä½¿ç”¨åˆšæ‰å­¦ä¹ çš„ Proguard ç›¸å…³çŸ¥è¯†å¯¹æ··æ·†è§„åˆ™åšä¿®æ”¹å§</p><p>è¿™é‡Œå…ˆåˆ—å‡ºæˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡ï¼š</p><blockquote><p>1ã€å¯¹ MyFragment ç±»è¿›è¡Œå®Œå…¨ä¿ç•™ï¼Œä¸æ··æ·†å…¶ä»»ä½•ä¿¡æ¯</p><p>2ã€å¯¹ MainActivity ç±»è¿›è¡Œå®Œå…¨ä¿ç•™ï¼Œä¸æ··æ·†å…¶ä»»ä½•ä¿¡æ¯</p><p>3ã€å¯¹ Utils ä¸­çš„æ–¹æ³•è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«æ··æ·†æˆ–ç§»é™¤</p><p>4ã€å¯¹ NativeUtils ä¸­çš„é Native æ–¹æ³•è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«æ··æ·†æˆ–ç§»é™¤</p><p>5ã€å¯¹ç¬¬ä¸‰æ–¹åº“è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«æ··æ·†æˆ–ç§»é™¤</p></blockquote><p>å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs xml"># å¯¹ MyFragment ç±»è¿›è¡Œå®Œå…¨ä¿ç•™ï¼Œä¸æ··æ·†å…¶ä»»ä½•ä¿¡æ¯<br>-keep class com.dream.androidreversedemo.MyFragment&#123;<br>    *;<br>&#125;<br><br># å¯¹ MainActivity ç±»è¿›è¡Œå®Œå…¨ä¿ç•™ï¼Œä¸æ··æ·†å…¶ä»»ä½•ä¿¡æ¯<br>-keep class com.dream.androidreversedemo.MainActivity&#123;<br>    *;<br>&#125;<br><br># å¯¹ Utils ä¸­çš„æ–¹æ³•è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«æ··æ·†æˆ–ç§»é™¤<br>-keep class com.dream.androidreversedemo.Utils&#123;<br>    *;<br>&#125;<br><br># å¯¹ NativeUtils ä¸­çš„é Native æ–¹æ³•è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«ç§»é™¤<br>-keepclassmembers class com.dream.androidreversedemo.NativeUtils&#123;<br>    public static void methodNotNative();<br>&#125;<br><br># å¯¹ç¬¬ä¸‰æ–¹åº“è¿›è¡Œä¿ç•™ï¼Œé˜²æ­¢å…¶è¢«æ··æ·†æˆ–ç§»é™¤<br>-keep class com.dream.androidutils.*&#123;<br>    *;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–å†™å¥½äº†è‡ªå®šä¹‰è§„åˆ™ï¼Œç°åœ¨æˆ‘ä»¬é‡æ–°æ‰“ä¸€ä¸ªæ­£å¼ç‰ˆçš„ APK æ–‡ä»¶ï¼Œç„¶ååœ¨åç¼–è¯‘çœ‹æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7a87902aa31488d9d01e1fc9eeaa552~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221120195728116.png" width="50%" /><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç±»å’Œå¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“ä¸­æ‰€æœ‰çš„çš„ä»£ç éƒ½è¢«ä¿ç•™äº†ä¸‹æ¥ï¼Œä¸ç®¡æ˜¯åŒ…åï¼Œç±»åéƒ½æ²¡æœ‰è¢«æ··æ·†</p><p>æ¥ç€çœ‹ä¸€ä¸‹å…·ä½“çš„ç±»ï¼š</p><p><strong>MainActivity</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4fb1c093c5794a58a63bd24788e2ee7c~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120200151678.png"></p><p><strong>Utils</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab38bf1f159b4da88ef917cbc6086bd9~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120200226987.png"></p><p><strong>NativeUtils</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/55307b4e2dd945a6ac308e8466845557~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120200312209.png"></p><p><strong>MyFragment</strong>ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99172c118699411eabb91fdc4d1fd9ce~tplv-k3u1fbpfcp-watermark.image" alt="image-20221120200408565.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„è¿™äº›ç±»åŸºæœ¬ä¸ŠæŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚ä¿ç•™äº†ä¸‹æ¥</p><p>okï¼Œç»è¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹ Proguard çš„ç”¨æ³•æœ‰ç›¸å½“ä¸é”™çš„ç†è§£äº†ï¼Œé‚£ä¹ˆæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚å»ç¼–å†™æ··æ·†é…ç½®ç›¸ä¿¡ä¹Ÿä¸æ˜¯ä»€ä¹ˆéš¾äº‹äº†å§ï¼Ÿ</p><p>å…³äºæ··æ·† APK ä»£ç å°±è®²è¿™ä¹ˆå¤šï¼Œå¦‚æœä½ è¿˜æƒ³äº†è§£æ›´å¤šå…³äº Proguard çš„ç”¨æ³•ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/6844903457380384782">https://juejin.cn/post/6844903457380384782</a></p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†ï¼š</p><p>1ã€åç¼–è¯‘å·¥å…· jadx çš„å®‰è£…ä¸ä½¿ç”¨</p><blockquote><p>jadx ç›¸å½“äºæ˜¯ apktool + dex2jar + jd-gui çš„ç»“åˆä½“ï¼Œæ—¢èƒ½åç¼–è¯‘ä»£ç ä¹Ÿèƒ½åç¼–è¯‘èµ„æºï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</p></blockquote><p>2ã€æ··æ·† APK ä»£ç </p><blockquote><p>1ã€å‡†å¤‡äº†ä¸€äº›ç±»ï¼ˆè‡ªå®šä¹‰ç¼–å†™çš„ç±»ï¼Œç¬¬ä¸‰æ–¹åº“çš„ç±»ï¼‰ç”¨äºæ··æ·†åçš„æ•ˆæœéªŒè¯</p><p>2ã€åœ¨ app -&gt; build.gradle -&gt; android é—­åŒ… -&gt; release é—­åŒ…å°† minifyEnabled è®¾ä¸º true å¼€å¯ä»£ç æ··æ·†</p><p>3ã€ä½¿ç”¨ AndroidStudio å¯¼èˆªæ ä¸Š Generate Signed Bundle or APK çš„æ–¹å¼æ‰“ release åŒ…</p><p>4ã€åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­é…ç½®ç­¾åæ–‡ä»¶ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ gradle å‘½ä»¤æˆ– gradle å¯è§†åŒ–ç•Œé¢æ‰“åŒ…</p><p>5ã€é€è¡Œä»‹ç»äº†é»˜è®¤æ··æ·†è§„åˆ™æ–‡ä»¶ proguard-android-optimize.txt ä¸­çš„é…ç½®</p><p>6ã€Proguard ç–‘éš¾è¯­æ³•ä»‹ç»</p><p>7ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™ä¿ç•™ç±»ï¼ˆè‡ªå®šä¹‰ç¼–å†™çš„ç±»ï¼Œç¬¬ä¸‰æ–¹åº“çš„ç±»ï¼‰ä¸è¢«æ··æ·†</p></blockquote><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://blog.csdn.net/guolin_blog/article/details/50451259?spm=1001.2014.3001.5501">Androidå®‰å…¨æ”»é˜²æˆ˜ï¼Œåç¼–è¯‘ä¸æ··æ·†æŠ€æœ¯å®Œå…¨è§£æï¼ˆä¸‹ï¼‰</a></p><p><a href="https://juejin.cn/post/6844903457380384782">æ·±å…¥å­¦ä¹ ProGuardä¹‹ï¼šProGuardç®€ä»‹ä¸androidçš„åº”ç”¨</a></p><p><a href="https://github.com/skylot/jadx">jadx github</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Android é€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android é€†å‘</tag>
      
      <tag>åç¼–è¯‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆå…­ï¼‰ã€Gradle Transform + ASM + Javassist å®æˆ˜</title>
    <link href="/2022/10/29/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%85%AD%EF%BC%89%E3%80%81Gradle%20Transform%20+%20ASM%20+%20Javassist%20%E5%AE%9E%E6%88%98/"/>
    <url>/2022/10/29/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%85%AD%EF%BC%89%E3%80%81Gradle%20Transform%20+%20ASM%20+%20Javassist%20%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/51a02cee6298479d923bc32aa75d897a~tplv-k3u1fbpfcp-watermark.image"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>å…³äº Gradle å­¦ä¹ ï¼Œæˆ‘æ‰€ç†è§£çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e010cee57604e179607243e027608d4~tplv-k3u1fbpfcp-zoom-1.image" alt="Gradle_learning" width="100%" /><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ï¼š</p><blockquote><p>1ã€ä»€ä¹ˆæ˜¯ Gradle Transformï¼Ÿ</p><p>2ã€è‡ªå®šä¹‰ Gradle Transform æµç¨‹</p><p>3ã€Gradle Transform æ•°æ®æµç¨‹ä»¥åŠæ ¸å¿ƒ Api åˆ†æ</p><p>4ã€Gradle Gransform çš„å¢é‡ä¸å¹¶å‘å¹¶å°è£…äº†ä¸€å¥—è‡ªå®šä¹‰æ¨¡ç‰ˆï¼Œç®€åŒ–æˆ‘ä»¬è‡ªå®šä¹‰ Gradle Transform çš„ä½¿ç”¨</p></blockquote><p>è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7159841721856032804">Gradle ç³»åˆ— ï¼ˆäº”ï¼‰ã€è‡ªå®šä¹‰ Gradle Transform</a>ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç» Gradle Transform + ASM + Javassist çš„å®æˆ˜åº”ç”¨</p><h1 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h1><p>ä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬åœ¨å‰è¨€ä¸­ç•™äº†å‡ ä¸ªé—®é¢˜ï¼š</p><p>1ã€ä¸ºäº†å¯¹ app æ€§èƒ½åšä¸€ä¸ªå…¨é¢çš„è¯„ä¼°ï¼Œæˆ‘ä»¬éœ€è¦åš UIï¼Œå†…å­˜ï¼Œç½‘ç»œç­‰æ–¹é¢çš„æ€§èƒ½ç›‘æ§ï¼Œå¦‚ä½•åš?</p><p>2ã€å‘ç°æŸä¸ªç¬¬ä¸‰æ–¹åº“æœ‰ bug ï¼Œç”¨èµ·æ¥ä¸çˆ½ï¼Œä½†åˆä¸æƒ³æ‹¿å®ƒçš„æºç ä¿®æ”¹åœ¨é‡æ–°ç¼–è¯‘ï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Ÿ</p><p>3ã€æˆ‘æƒ³åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹ï¼Œç»Ÿè®¡æŸä¸ªæ–¹æ³•çš„è€—æ—¶ï¼Œå¯¹æŸä¸ªæ–¹æ³•åšåŸ‹ç‚¹ï¼Œæ€ä¹ˆåšï¼Ÿ</p><p>1 æ˜¯éœ€è¦é€šè¿‡ Gradle Transform å»åšä¸€ä¸ª APM æ¡†æ¶ï¼Œè¿™ä¸ªå†™èµ·æ¥ç¯‡å¹…ä¼šè¿‡é•¿ï¼Œåç»­ä¸“é—¨å¼€æ–‡ç« å»è®²ã€‚</p><p>æˆ‘ä»¬ä¸»è¦è§£å†³ 2ï¼Œ3 è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œåœ¨æ­¤ä¹‹å‰å…ˆç®€å•å­¦ä¹ ç‚¹ ASM å’Œ Javassist çš„çŸ¥è¯†</p><h1 id="ä¸€ã€ASM-ç­‘åŸº"><a href="#ä¸€ã€ASM-ç­‘åŸº" class="headerlink" title="ä¸€ã€ASM ç­‘åŸº"></a>ä¸€ã€ASM ç­‘åŸº</h1><h2 id="1-1ã€ASM-ä»‹ç»"><a href="#1-1ã€ASM-ä»‹ç»" class="headerlink" title="1.1ã€ASM ä»‹ç»"></a>1.1ã€ASM ä»‹ç»</h2><p>ASM æ˜¯ä¸€ä¸ª Java å­—èŠ‚ç æ“ä½œæ¡†æ¶ã€‚å®ƒèƒ½è¢«ç”¨æ¥åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç æˆ–è€…å¯¹ç°æœ‰çš„ç±»è¿›è¡Œå¢å¼ºã€‚ASM å¯ä»¥ç›´æ¥ç”ŸæˆäºŒè¿›åˆ¶ class æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨ç±»è¢«åŠ è½½å…¥ Java è™šæ‹Ÿæœºä¹‹å‰åŠ¨æ€æ”¹å˜ç±»è¡Œä¸ºã€‚æ¯”å¦‚æ–¹æ³•æ‰§è¡Œå‰åæ’å…¥ä»£ç ï¼Œæ·»åŠ æˆå‘˜å˜é‡ï¼Œä¿®æ”¹çˆ¶ç±»ï¼Œæ·»åŠ æ¥å£ç­‰ç­‰</p><h2 id="1-2ã€ASM-Api"><a href="#1-2ã€ASM-Api" class="headerlink" title="1.2ã€ASM Api"></a>1.2ã€ASM Api</h2><p>é¦–å…ˆå…ˆå¼•å…¥ ASM ç›¸å…³çš„ Gradle è¿œç¨‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//asm</span><br>implementation <span class="hljs-string">&#x27;org.ow2.asm:asm:9.2&#x27;</span><br>implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-util:9.2&#x27;</span><br>implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-commons:9.2&#x27;</span><br></code></pre></td></tr></table></figure><p>ASM çš„ Api æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š</p><blockquote><p>1ã€Tree Api ï¼šæ ‘å½¢æ¨¡å¼</p><p>2ã€Visitor Api ï¼šè®¿é—®è€…æ¨¡å¼</p></blockquote><p>Tree Api ä¼šå°† class æ–‡ä»¶çš„ç»“æ„è¯»å–åˆ°å†…å­˜ï¼Œæ„å»ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œåœ¨å¤„ç† Methodï¼ŒField ç­‰å…ƒç´ æ—¶ï¼Œä¼šåˆ°æ ‘å½¢ç»“æ„ä¸­å®šä½åˆ°æŸä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œç„¶åæŠŠæ“ä½œåœ¨å†™å…¥ class æ–‡ä»¶ï¼Œæœ€ç»ˆè¾¾åˆ°ä¿®æ”¹å­—èŠ‚ç çš„ç›®çš„ã€‚ä¸€èˆ¬æ¯”è¾ƒé€‚åˆå¤„ç†å¤æ‚çš„åœºæ™¯</p><h3 id="1-2-1ã€Visitor-Apiï¼šè®¿é—®è€…æ¨¡å¼"><a href="#1-2-1ã€Visitor-Apiï¼šè®¿é—®è€…æ¨¡å¼" class="headerlink" title="1.2.1ã€Visitor Apiï¼šè®¿é—®è€…æ¨¡å¼"></a>1.2.1ã€Visitor Apiï¼šè®¿é—®è€…æ¨¡å¼</h3><p>Visitor Api åˆ™æ˜¯é€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œåˆ†ç¦»<strong>è¯» class</strong> å’Œ<strong>å†™ class</strong> çš„é€»è¾‘ï¼Œä¸€èˆ¬é€šè¿‡ ClassReader è¯»å– class ï¼Œç„¶å ClassReader é€šè¿‡ ClassVisitor æŠ½è±¡ç±»ï¼ˆClassWriter æ˜¯å®ƒçš„å…·ä½“å®ç°ç±»ï¼‰ï¼Œå°† class çš„æ¯ä¸ªç»†èŠ‚æŒ‰é¡ºåºä¼ é€’ç»™ ClassVisitorï¼ˆClassVisitor ä¸­æœ‰è®¸å¤š visitXXX æ–¹æ³•ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒ ClassReader å¸¦ç€ ClassVisitor æ¸¸è§ˆäº† class çš„æ¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œæœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œå°±å¯ä»¥æ“ä½œè¿™ä¸ª class äº†</p><p>è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚åˆå¤„ç†ä¸€äº›ç®€å•çš„åœºæ™¯ï¼Œå¦‚ï¼š<strong>å‡ºäºæŸä¸ªç›®çš„ï¼Œå¯»æ‰¾ class æ–‡ä»¶ä¸­çš„ä¸€ä¸ª hook ç‚¹è¿›è¡Œå­—èŠ‚ç ä¿®æ”¹</strong>ã€‚æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼</p><h4 id="1-2-1-1ã€ClassVisitor"><a href="#1-2-1-1ã€ClassVisitor" class="headerlink" title="1.2.1.1ã€ClassVisitor"></a>1.2.1.1ã€ClassVisitor</h4><p>ClassVisitor æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸»è¦ç”¨äºæ¥æ”¶ ClassReader ä¼ é€’è¿‡æ¥çš„æ¯ä¸€ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼Œå¸¸ç”¨çš„å®ç°ç±»æœ‰ï¼šClassWriterã€‚</p><h5 id="1-2-1-1-1ã€ClassVisitor-æ„é€ æ–¹æ³•"><a href="#1-2-1-1-1ã€ClassVisitor-æ„é€ æ–¹æ³•" class="headerlink" title="1.2.1.1.1ã€ClassVisitor æ„é€ æ–¹æ³•"></a>1.2.1.1.1ã€ClassVisitor æ„é€ æ–¹æ³•</h5><p>ClassVisitor æ„é€ æ–¹æ³•ä¸»è¦æœ‰ä¸¤ä¸ªï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassVisitor</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> api)</span> &#123;<br>   <span class="hljs-built_in">this</span>(api, <span class="hljs-literal">null</span>);<br> &#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassVisitor</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> api, <span class="hljs-keyword">final</span> ClassVisitor classVisitor)</span>&#123;<br>   <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š</p><blockquote><p>1ã€ä¼ å…¥ ASM çš„ Api ç‰ˆæœ¬å»æ„å»ºå®ƒï¼šOpcodes.ASM4, Opcodes.ASM5, Opcodes.ASM6 or Opcodes.ASM7</p><p>2ã€ä¼ å…¥ ASM çš„ Api  ç‰ˆæœ¬å’Œ ClassVisitor çš„å®ç°ç±»å¦‚ï¼šClassWriter å»æ„å»ºå®ƒ</p></blockquote><h5 id="1-2-1-1-2ã€ClassVisitor-visitXXX-ç³»åˆ—æ–¹æ³•"><a href="#1-2-1-1-2ã€ClassVisitor-visitXXX-ç³»åˆ—æ–¹æ³•" class="headerlink" title="1.2.1.1.2ã€ClassVisitor visitXXX ç³»åˆ—æ–¹æ³•"></a>1.2.1.1.2ã€ClassVisitor visitXXX ç³»åˆ—æ–¹æ³•</h5><p>å®ƒè¿˜æœ‰ä¸€ç³»åˆ— visitXXX æ–¹æ³•ï¼Œåˆ—ä¸¾å¸¸ç”¨çš„å‡ ä¸ªï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassVisitor</span> &#123;<br>  <span class="hljs-comment">//...</span><br>  <br>  <span class="hljs-comment">//ä¸€å¼€å§‹è°ƒç”¨</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visit</span><span class="hljs-params">(</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> version,</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> access,</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String name,//ç±»åï¼Œä¾‹å¦‚ï¼šcom.dream.androidutil.StringUtils =&gt; com/dream/androidutil/StringUtils</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String signature,//æ³›å‹</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String superName,//çˆ¶ç±»å</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String[] interfaces)</span> &#123;<span class="hljs-comment">//å®ç°çš„æ¥å£</span><br>  &#125;<br><br>  <span class="hljs-comment">//è®¿é—®æ³¨è§£</span><br>  <span class="hljs-keyword">public</span> AnnotationVisitor <span class="hljs-title function_">visitAnnotation</span><span class="hljs-params">(</span><br><span class="hljs-params">    //æ³¨è§£åç§°ï¼Œä¾‹å¦‚ï¼šcom.dream.customannotation.CostTime =&gt; Lcom/dream/customannotation/CostTime;</span><br><span class="hljs-params">    <span class="hljs-keyword">final</span> String descriptor,</span><br><span class="hljs-params">    <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> visible)</span> &#123;<br>    <span class="hljs-comment">//...</span><br>  &#125;<br><br>  <span class="hljs-comment">//è®¿é—®æ–¹æ³•</span><br>  <span class="hljs-keyword">public</span> MethodVisitor <span class="hljs-title function_">visitMethod</span><span class="hljs-params">(</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> access,</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String name,//æ–¹æ³•åï¼Œä¾‹å¦‚ï¼šgetCharArray</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String descriptor,//æ–¹æ³•ç­¾åï¼Œç®€å•æ¥è¯´å°±æ˜¯æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼çš„ç‰¹å®šå­—ç¬¦ä¸²</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String signature,//æ³›å‹</span><br><span class="hljs-params">      <span class="hljs-keyword">final</span> String[] exceptions)</span> &#123;<br>    <span class="hljs-keyword">if</span> (cv != <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">return</span> cv.visitMethod(access, name, descriptor, signature, exceptions);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//è®¿é—®ç»“æŸæ—¶è°ƒç”¨</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitEnd</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (cv != <span class="hljs-literal">null</span>) &#123;<br>      cv.visitEnd();<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="1-2-1-1-3ã€ClassVisitor-visitXXX-æ–¹æ³•è°ƒç”¨é¡ºåº"><a href="#1-2-1-1-3ã€ClassVisitor-visitXXX-æ–¹æ³•è°ƒç”¨é¡ºåº" class="headerlink" title="1.2.1.1.3ã€ClassVisitor visitXXX æ–¹æ³•è°ƒç”¨é¡ºåº"></a>1.2.1.1.3ã€ClassVisitor visitXXX æ–¹æ³•è°ƒç”¨é¡ºåº</h5><p>ä¸Šè¿°æ–¹æ³•çš„è°ƒç”¨éµå¾ªä¸€å®šçš„é¡ºåºï¼Œä¸‹é¢åˆ—ä¸¾çš„æ˜¯æ‰€æœ‰ visitXXX æ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">visit<br>[visitSource][visitModule][visitNestHost][visitPermittedSubclass][visitOuterClass]<br>(<br> visitAnnotation |<br> visitTypeAnnotation |<br> visitAttribute<br>)*<br>(<br> visitNestMember |<br> visitInnerClass |<br> visitRecordComponent |<br> visitField |<br> visitMethod<br>)* <br>visitEnd<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œæ¶‰åŠåˆ°ä¸€äº›ç¬¦å·ï¼Œå®ƒä»¬çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p><code>[]</code> ï¼šè¡¨ç¤ºæœ€å¤šè°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥ä¸è°ƒç”¨ï¼Œä½†æœ€å¤šè°ƒç”¨ä¸€æ¬¡ã€‚</p><p><code>() å’Œ |</code> ï¼šè¡¨ç¤ºåœ¨å¤šä¸ªæ–¹æ³•ä¹‹é—´ï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªï¼Œå¹¶ä¸”å¤šä¸ªæ–¹æ³•ä¹‹é—´ä¸åˆ†å‰åé¡ºåº</p><p><code>*</code> ï¼š è¡¨ç¤ºæ–¹æ³•å¯ä»¥è°ƒç”¨0æ¬¡æˆ–å¤šæ¬¡ã€‚</p></blockquote><p>ç®€åŒ–ä¸€ä¸‹ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">visit<br>(<br> visitAnnotation |<br>)* <br>(<br> visitField |<br> visitMethod<br>)* <br>visitEnd<br></code></pre></td></tr></table></figure><p>è§£é‡Šè¯´æ˜ï¼šä¸Šè¿°ä»£ç ä¼šå…ˆè°ƒç”¨<code>visit</code>æ–¹æ³•ï¼Œæ¥ç€è°ƒç”¨<code>visitAnnotation</code> æ–¹æ³•ï¼Œç„¶ååœ¨è°ƒç”¨<code>visitField</code>æˆ–<code>visitMethod</code>æ–¹æ³•ï¼Œæœ€åè°ƒç”¨<code>visitEnd</code>æ–¹æ³•</p><h4 id="1-2-1-2ã€ClassReader"><a href="#1-2-1-2ã€ClassReader" class="headerlink" title="1.2.1.2ã€ClassReader"></a>1.2.1.2ã€ClassReader</h4><p>ClassReader ä¸»è¦ç”¨äºè¯»å– class æ–‡ä»¶ï¼Œå¹¶æŠŠæ¯ä¸ªå­—èŠ‚ç æŒ‡ä»¤ä¼ é€’ç»™ ClassVisitor çš„ visitXXX æ–¹æ³•</p><h5 id="1-2-1-2-1ã€ClassReader-æ„é€ æ–¹æ³•"><a href="#1-2-1-2-1ã€ClassReader-æ„é€ æ–¹æ³•" class="headerlink" title="1.2.1.2.1ã€ClassReader æ„é€ æ–¹æ³•"></a>1.2.1.2.1ã€ClassReader æ„é€ æ–¹æ³•</h5><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2a50d01c481464fb01503d80c236749~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030123617942.png" width="50%" /><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š</p><blockquote><p>1ã€ByteArrayï¼ˆå­—èŠ‚æ•°ç»„ï¼‰</p><p>2ã€inputStreamï¼ˆè¾“å…¥å…­ï¼‰ï¼Œ</p><p>3ã€classNameï¼ˆString çš„ ç±»åç§°ï¼‰</p></blockquote><p>ç­‰æ¥æ„å»ºå®ƒ</p><h5 id="1-2-1-2-2ã€ClassReader-æ–¹æ³•"><a href="#1-2-1-2-2ã€ClassReader-æ–¹æ³•" class="headerlink" title="1.2.1.2.2ã€ClassReader æ–¹æ³•"></a>1.2.1.2.2ã€ClassReader æ–¹æ³•</h5><p>ClassReader æä¾›äº†ä¸€ç³»åˆ— get æ–¹æ³•è·å–ç±»ä¿¡æ¯ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/edec8136dcf845d2b940f0b403bbcec4~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030124122636.png" width="50%" /><p>ä¸è¿‡ï¼Œå®ƒæœ€é‡è¦çš„æ–¹æ³•è¿˜æ˜¯ accept æ–¹æ³•ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e53c68de33dd4752afe8dffaab0e3796~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030124229333.png" width="50%" /><p>accept å¯ä»¥æ¥æ”¶ä¸€ä¸ª ClassVisitor å’Œä¸€ä¸ª parsingOptionsã€‚parsingOptions å–å€¼å¦‚ä¸‹ï¼š</p><blockquote><p>0ï¼šä¼šç”Ÿæˆæ‰€æœ‰çš„ASMä»£ç ï¼ŒåŒ…æ‹¬è°ƒè¯•ä¿¡æ¯ã€frameä¿¡æ¯å’Œä»£ç ä¿¡æ¯ã€‚</p><p>ClassReader.SKIP_CODEï¼šä¼šå¿½ç•¥ä»£ç ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šä¼šå¿½ç•¥å¯¹äº MethodVisitor.visitXxxInsn() æ–¹æ³•çš„è°ƒç”¨</p><p>ClassReader.SKIP_DEBUGï¼šä¼šå¿½ç•¥è°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šä¼šå¿½ç•¥å¯¹äºMethodVisitor.visitParameter()ã€MethodVisitor.visitLineNumber()ç­‰æ–¹æ³•çš„è°ƒç”¨ã€‚</p><p>ClassReader.SKIP_FRAMESï¼šä¼šå¿½ç•¥ frame ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šä¼šå¿½ç•¥å¯¹äºMethodVisitor.visitFrame()æ–¹æ³•çš„è°ƒç”¨ã€‚</p><p>ClassReader.EXPAND_FRAMESï¼šä¼šå¯¹frameä¿¡æ¯è¿›è¡Œæ‰©å±•ï¼Œä¾‹å¦‚ï¼šä¼šå¯¹ MethodVisitor.visitFrame() æ–¹æ³•çš„å‚æ•°æœ‰å½±å“ã€‚</p></blockquote><p><strong>Tips</strong>:  æ¨èä½¿ç”¨<code>ClassReader.SKIP_DEBUG | ClassReader.SKIP_FRAMES</code>ï¼Œå› ä¸ºä½¿ç”¨è¿™æ ·çš„ä¸€ä¸ªå€¼ï¼Œå¯ä»¥ç”Ÿæˆæœ€å°‘çš„ ASM ä»£ç ï¼Œä½†æ˜¯åˆèƒ½å®ç°å®Œæ•´çš„åŠŸèƒ½</p><p>æ¥æ”¶åä¾¿å¼€å§‹è¯»å–æ•°æ®ã€‚å½“æ»¡è¶³ä¸€å®šæ¡ä»¶æ—¶ï¼Œå°±ä¼šè§¦å‘ ClassVisitor ä¸‹çš„ visitXXX æ–¹æ³•ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.dream.gradletransformdemo;<br><br><span class="hljs-keyword">import</span> org.objectweb.asm.ClassReader;<br><span class="hljs-keyword">import</span> org.objectweb.asm.ClassVisitor;<br><span class="hljs-keyword">import</span> org.objectweb.asm.MethodVisitor;<br><span class="hljs-keyword">import</span> org.objectweb.asm.Opcodes;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] var0)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ClassReader</span> <span class="hljs-variable">cr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassReader</span>(<span class="hljs-string">&quot;java.util.ArrayList&quot;</span>);<br>        cr.accept(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClassVisitor</span>(Opcodes.ASM7),ClassReader.SKIP_DEBUG | ClassReader.SKIP_FRAMES);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClassVisitor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassVisitor</span> &#123;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyClassVisitor</span><span class="hljs-params">(<span class="hljs-type">int</span> api)</span> &#123;<br>            <span class="hljs-built_in">super</span>(api);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> MethodVisitor <span class="hljs-title function_">visitMethod</span><span class="hljs-params">(<span class="hljs-type">int</span> access, String name, String descriptor, String signature, String[] exceptions)</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;visitMethod: &quot;</span> + <span class="hljs-string">&quot;access=&gt;&quot;</span> + access + <span class="hljs-string">&quot; name=&gt;&quot;</span> + name<br>                    + <span class="hljs-string">&quot; descriptor=&gt;&quot;</span> + descriptor);<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.visitMethod(access, name, descriptor, signature, exceptions);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ç»§æ‰¿äº†ClassVisitor ç±»å¹¶é‡å†™äº†visitMethod æ–¹æ³•ã€‚è¿˜è®°å¾—ä¹‹å‰æ‰€è¯´çš„å—ï¼ŸClassVistor å®šä¹‰äº†åœ¨è¯»å– class æ—¶ä¼šè§¦å‘çš„ visitXXX æ–¹æ³•ã€‚é€šè¿‡ accept æ–¹æ³•ï¼Œå»ºç«‹äº† ClassVisitor ä¸ ClassReader ä¹‹é—´çš„è¿æ¥ã€‚å› æ­¤ï¼Œå½“ ClassReader è®¿é—®å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œå®ƒå°†è§¦å‘ClassVisitor å†…çš„ visitMethod æ–¹æ³•ï¼Œè¿™æ—¶ç”±äºæˆ‘ä»¬åœ¨ visitMethod ä¸‹æ·»åŠ äº†ä¸€æ¡æ‰“å°è¯­å¥ï¼Œå› æ­¤ä¼šæ‰“å°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ‰“å°ç»“æœï¼Œå› ä¸º ArrayList æ–¹æ³•ä¼—å¤šï¼Œç®€å•æˆªå–çœ‹å‡ ä¸ªå¸¸ç”¨çš„</span><br><span class="hljs-comment">//...</span><br><span class="hljs-comment">//&lt;init&gt; å¯¹åº”çš„å°±æ˜¯ ArrayList çš„æ„é€ æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ª</span><br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;&lt;init&gt; descriptor=&gt;(I)V<br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;&lt;init&gt; descriptor=&gt;()V<br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;&lt;init&gt; descriptor=&gt;(Ljava/util/Collection;)V<br><span class="hljs-comment">//ArrayList get æ–¹æ³•</span><br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;get descriptor=&gt;(I)Ljava/lang/Object;<br><span class="hljs-comment">//ArrayList set æ–¹æ³•</span><br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;set descriptor=&gt;(ILjava/lang/Object;)Ljava/lang/Object;<br><span class="hljs-comment">//ArrayList add æ–¹æ³•ï¼Œæœ‰ 3 ä¸ª</span><br>visitMethod: access=&gt;<span class="hljs-number">2</span> name=&gt;add descriptor=&gt;(Ljava/lang/Object;[Ljava/lang/Object;I)V<br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;add descriptor=&gt;(Ljava/lang/Object;)Z<br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;add descriptor=&gt;(ILjava/lang/Object;)V<br><span class="hljs-comment">//ArrayList remove æ–¹æ³•                                                                                                      </span><br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;remove descriptor=&gt;(I)Ljava/lang/Object;<br>visitMethod: access=&gt;<span class="hljs-number">1</span> name=&gt;remove descriptor=&gt;(Ljava/lang/Object;)Z                                                                                                      <br><span class="hljs-comment">//...                                                                                                       </span><br></code></pre></td></tr></table></figure><h5 id="1-2-1-2-3ã€å­—æ®µè§£æ"><a href="#1-2-1-2-3ã€å­—æ®µè§£æ" class="headerlink" title="1.2.1.2.3ã€å­—æ®µè§£æ"></a>1.2.1.2.3ã€å­—æ®µè§£æ</h5><p>ä¸Šè¿°æ‰“å°ç»“æœï¼š</p><p><code>&lt;init&gt;</code> ï¼šè¡¨ç¤ºä¸€ä¸ªç±»æ„é€ å‡½æ•°çš„åå­—</p><p><code>access</code> ï¼šæ–¹æ³•çš„è®¿é—®æ§åˆ¶ç¬¦çš„å®šä¹‰</p><p><code>name</code> ï¼šæ–¹æ³•å</p><p><code>descriptor</code> ï¼šæ–¹æ³•ç­¾åï¼Œç®€å•æ¥è¯´å°±æ˜¯æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼çš„ç‰¹å®šå­—ç¬¦ä¸²</p><p>æˆ‘ä»¬æŒ‘ä¸¤ä¸ª descriptor è¿›è¡Œè§£æï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€() é‡Œé¢çš„è¡¨ç¤ºå‚æ•°</span><br><span class="hljs-comment">//2ã€I è¡¨ç¤º intï¼Œ</span><br><span class="hljs-comment">//3ã€å¦‚æœä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œéœ€è¦å†™å®Œæ•´åŒ…åï¼ŒåŒæ—¶ä»¥ L æ‰“å¤´ï¼Œä¾‹å¦‚ Object å¯¹åº”ï¼šLjava/lang/Object;</span><br><span class="hljs-comment">//4ã€V è¡¨ç¤º void</span><br><span class="hljs-comment">//å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸ª descriptor ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šintï¼ŒObject ï¼Œè¿”å›å€¼ä¸ºï¼švoid</span><br>descriptor=&gt;(ILjava/lang/Object;)V<br>  <br><span class="hljs-comment">//1ã€() é‡Œé¢çš„è¡¨ç¤ºå‚æ•°ï¼Œ() å¤–é¢çš„è¡¨ç¤ºè¿”å›å€¼</span><br><span class="hljs-comment">//2ã€å¦‚æœæ˜¯ç‰¹å®šçš„ç±»ï¼Œéœ€è¦å†™å®Œæ•´åŒ…åï¼ŒåŒæ—¶ä»¥ L æ‰“å¤´ï¼Œä¾‹å¦‚ Object å¯¹åº”ï¼šLjava/lang/Object;</span><br><span class="hljs-comment">//4ã€Z è¡¨ç¤º boolean</span><br><span class="hljs-comment">//å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸ª descriptor ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šObject ï¼Œè¿”å›å€¼ä¸ºï¼šboolean</span><br>descriptor=&gt;(Ljava/lang/Object;)Z<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ () é‡Œé¢çš„å‚æ•°</strong>ï¼š</p><p>1ã€æ²¡æœ‰çš„è¯å°±ä»€ä¹ˆéƒ½ä¸å†™</p><p>2ã€æœ‰çš„è¯ï¼Œå¦‚æœä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œè¦æ˜¯ä»¥ L æ‰“å¤´çš„ç±»åï¼ˆåŒ…å«åŒ…åï¼‰</p><p>3ã€å¯¹äºæ•°ç»„ä»¥ [ æ‰“å¤´ï¼Œ</p><p>4ã€å¦‚æœä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨åˆ†å·ï¼›è¿›è¡Œåˆ†éš”ï¼Œå³ä¾¿åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿè¦å†™åˆ†å·</p><p>ç±»å‹å¯¹åº”è¡¨ï¼š</p><table><thead><tr><th>Type Descriptor</th><th>Java Type</th></tr></thead><tbody><tr><td>Z</td><td>boolean</td></tr><tr><td>C</td><td>char</td></tr><tr><td>B</td><td>byte</td></tr><tr><td>S</td><td>short</td></tr><tr><td>I</td><td>int</td></tr><tr><td>F</td><td>float</td></tr><tr><td>J</td><td>long</td></tr><tr><td>D</td><td>double</td></tr><tr><td>Ljava&#x2F;lang&#x2F;Object;</td><td>Object</td></tr><tr><td><code>[I</code></td><td><code>int[]</code></td></tr><tr><td><code>[[Ljava/lang/Object</code></td><td><code>Object[][]</code></td></tr></tbody></table><h4 id="1-2-1-3ã€ClassWriter"><a href="#1-2-1-3ã€ClassWriter" class="headerlink" title="1.2.1.3ã€ClassWriter"></a>1.2.1.3ã€ClassWriter</h4><p>ClassWriter çš„çˆ¶ç±»æ˜¯ ClassVisitor ï¼Œå› æ­¤ç»§æ‰¿äº† ClassVisitor çš„ visitXXX ç³»åˆ—æ–¹æ³•ï¼Œä¸»è¦ç”¨äºå­—èŠ‚ç çš„å†™å…¥</p><h5 id="1-2-1-3-1ã€ClassWriter-æ„é€ æ–¹æ³•"><a href="#1-2-1-3-1ã€ClassWriter-æ„é€ æ–¹æ³•" class="headerlink" title="1.2.1.3.1ã€ClassWriter æ„é€ æ–¹æ³•"></a>1.2.1.3.1ã€ClassWriter æ„é€ æ–¹æ³•</h5><p>ClassWriter çš„æ„é€ æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassWriter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> flags)</span> &#123;<br>  <span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, flags);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassWriter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> ClassReader classReader, <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> flags)</span> &#123;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š</p><blockquote><p>1ã€flags </p><p>2ã€classReader + flags</p></blockquote><p>æ¥æ„å»ºå®ƒï¼Œå…¶ä¸­ flags çš„å–å€¼å¦‚ä¸‹ï¼š</p><blockquote><p>0 ï¼šASM ä¸ä¼šè‡ªåŠ¨è®¡ç®— max stacks å’Œ max localsï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨è®¡ç®— stack map frames</p><p>ClassWriter.COMPUTE_MAXS ï¼šASM ä¼šè‡ªåŠ¨è®¡ç®— max stacks å’Œ max localsï¼Œä½†ä¸ä¼šè‡ªåŠ¨è®¡ç®— stack map frames</p><p>ClassWriter.COMPUTE_FRAMES ï¼šASM ä¼šè‡ªåŠ¨è®¡ç®— max stacks å’Œ max localsï¼Œä¹Ÿä¼šè‡ªåŠ¨è®¡ç®— stack map frames</p></blockquote><p><strong>Tips</strong>ï¼š å»ºè®®ä½¿ç”¨ ClassWriter.COMPUTE_FRAMESï¼Œè®¡ç®—é€Ÿåº¦å¿«ï¼Œæ‰§è¡Œæ•ˆç‡é«˜</p><h5 id="1-2-1-3-2ã€toByteArray-æ–¹æ³•"><a href="#1-2-1-3-2ã€toByteArray-æ–¹æ³•" class="headerlink" title="1.2.1.3.2ã€toByteArray æ–¹æ³•"></a>1.2.1.3.2ã€toByteArray æ–¹æ³•</h5><p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å°†æˆ‘ä»¬ä¹‹å‰å¯¹ class çš„ä¿®æ”¹ï¼ˆvisitXXX å†…éƒ¨ä¿®æ”¹å­—èŠ‚ç ï¼‰è½¬æ¢æˆ byte æ•°ç»„ï¼Œç„¶åé€šè¿‡è¾“å‡ºæµå†™å…¥åˆ°æ–‡ä»¶ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†ä¿®æ”¹å­—èŠ‚ç çš„ç›®çš„</p><p>okï¼ŒASM çš„çŸ¥è¯†ç‚¹å°±ä»‹ç»è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹ Javassist</p><h1 id="äºŒã€Javassist-ç­‘åŸº"><a href="#äºŒã€Javassist-ç­‘åŸº" class="headerlink" title="äºŒã€Javassist ç­‘åŸº"></a>äºŒã€Javassist ç­‘åŸº</h1><p>ç®€å•ä»‹ç»ä¸‹ Javassistï¼Œå› ä¸ºå®ƒå’Œ Java çš„åå°„ Api å¾ˆåƒï¼Œä¸Šæ‰‹ç®€å•ä¸€äº›ï¼Œå¤§å®¶ç›´æ¥ä»£ç ä¸­å»æ„Ÿå—ä¸€ä¸‹ï¼Œå†™äº†è¯¦ç»†çš„æ³¨é‡Š</p><p>é¦–å…ˆå…ˆæ·»åŠ  Javassist Gradle è¿œç¨‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation <span class="hljs-string">&#x27;org.javassist:javassist:3.29.2-GA&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-1ã€ä½¿ç”¨-Javassist-ç”Ÿæˆ-class-æ–‡ä»¶"><a href="#2-1ã€ä½¿ç”¨-Javassist-ç”Ÿæˆ-class-æ–‡ä»¶" class="headerlink" title="2.1ã€ä½¿ç”¨ Javassist ç”Ÿæˆ class æ–‡ä»¶"></a>2.1ã€ä½¿ç”¨ Javassist ç”Ÿæˆ class æ–‡ä»¶</h2><p>1ã€é¦–å…ˆæä¾›ä¸€ä¸ªå¾…ç”Ÿæˆçš„ class æ–‡ä»¶æ¨¡ç‰ˆï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.dream.gradletransformdemo;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-comment">//ç§æœ‰å±æ€§ nameï¼Œåˆå§‹å€¼ï¼šerdai</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;erdai&quot;</span>;<br><br>    <span class="hljs-comment">//name get æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String var1)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = var1;<br>    &#125;<br><br>    <span class="hljs-comment">//name set æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name;<br>    &#125;<br><br>    <span class="hljs-comment">//æ— å‚æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•ä½“ï¼šthis.name = &quot;xiaoming&quot;;</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&quot;xiaoming&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//ä¸€ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•æï¼šthis.name = var1;</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String var1)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = var1;<br>    &#125;<br><br>    <span class="hljs-comment">//æ™®é€šæ–¹æ³•ï¼šprintNameï¼Œæ–¹æ³•æï¼šSystem.out.println(this.name);</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printName</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.name);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™ Javassist ä»£ç ç”Ÿæˆ Person.class æ–‡ä»¶</p><p>Javassist ç”Ÿæˆ .class æ–‡ä»¶å’Œ JavaPoet ç”Ÿæˆ .java æ–‡ä»¶éå¸¸ç±»ä¼¼ï¼Œå¦‚æœä½ ç†Ÿæ‚‰ JavaPoet çš„è¯ï¼Œä¸‹é¢ç”Ÿæˆè¿‡ç¨‹å°†ä¼šå˜å¾—éå¸¸ç®€å•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCreateClass</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºä¸€ä¸ª Person.class æ–‡ä»¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> CtClass <span class="hljs-title function_">createPersonClass</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">ClassPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();<br><br>        <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªç©ºç±»ï¼šPerson ï¼ŒåŒ…åï¼šcom.dream.gradletransformdemo</span><br>        <span class="hljs-type">CtClass</span> <span class="hljs-variable">cc</span> <span class="hljs-operator">=</span> pool.makeClass(<span class="hljs-string">&quot;com.dream.gradletransformdemo.Person&quot;</span>);<br><br>        <span class="hljs-comment">// 2. æ–°å¢ä¸€ä¸ªå­—æ®µ private String name;</span><br>        <span class="hljs-comment">// å­—æ®µåä¸º name</span><br>        <span class="hljs-type">CtField</span> <span class="hljs-variable">param</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtField</span>(pool.get(<span class="hljs-string">&quot;java.lang.String&quot;</span>), <span class="hljs-string">&quot;name&quot;</span>, cc);<br>        <span class="hljs-comment">// è®¿é—®çº§åˆ«æ˜¯ private</span><br>        param.setModifiers(Modifier.PRIVATE);<br>        <span class="hljs-comment">// åˆå§‹å€¼æ˜¯ &quot;erdai&quot;</span><br>        cc.addField(param, CtField.Initializer.constant(<span class="hljs-string">&quot;erdai&quot;</span>));<br><br>        <span class="hljs-comment">// 3. ç”Ÿæˆ setterã€getter æ–¹æ³•</span><br>        cc.addMethod(CtNewMethod.setter(<span class="hljs-string">&quot;setName&quot;</span>, param));<br>      cc.addMethod(CtNewMethod.getter(<span class="hljs-string">&quot;getName&quot;</span>, param));<br>    <br>        <span class="hljs-comment">// 4. æ·»åŠ æ— å‚çš„æ„é€ å‡½æ•°</span><br>        <span class="hljs-type">CtConstructor</span> <span class="hljs-variable">cons</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtConstructor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[]&#123;&#125;, cc);<br>      <span class="hljs-comment">//æ–¹æ³•ä½“ï¼šthis.name = &quot;xiaoming&quot;;</span><br>        cons.setBody(<span class="hljs-string">&quot;&#123;name = \&quot;xiaoming\&quot;;&#125;&quot;</span>);<br>        cc.addConstructor(cons);<br><br>        <span class="hljs-comment">// 5. æ·»åŠ æœ‰å‚çš„æ„é€ å‡½æ•°</span><br>        cons = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtConstructor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[]&#123;pool.get(<span class="hljs-string">&quot;java.lang.String&quot;</span>)&#125;, cc);<br>        <span class="hljs-comment">// æ–¹æ³•æï¼šthis.name = var1; </span><br>      <span class="hljs-comment">//$0=this \$1,$2,$3... ä»£è¡¨æ–¹æ³•å‚æ•°</span><br>        cons.setBody(<span class="hljs-string">&quot;&#123;$0.name = $1;&#125;&quot;</span>);<br>        cc.addConstructor(cons);<br><br>        <span class="hljs-comment">// 6. åˆ›å»ºä¸€ä¸ªåä¸º printName çš„æ–¹æ³•ï¼Œæ— å‚æ•°ï¼Œæ— è¿”å›å€¼ï¼Œè¾“å‡º name å€¼</span><br>        <span class="hljs-type">CtMethod</span> <span class="hljs-variable">ctMethod</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtMethod</span>(CtClass.voidType, <span class="hljs-string">&quot;printName&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[]&#123;&#125;, cc);<br>        ctMethod.setModifiers(Modifier.PUBLIC);<br>        ctMethod.setBody(<span class="hljs-string">&quot;&#123;System.out.println(this.name);&#125;&quot;</span>);<br>        cc.addMethod(ctMethod);<br><br>        <span class="hljs-comment">// å°† Person.class æ–‡ä»¶è¾“å‡ºåˆ°å¦‚ä¸‹æ–‡ä»¶å¤¹</span><br>        cc.writeFile(<span class="hljs-string">&quot;/Users/zhouying/AndroidStudioProjects/MixDemo/GradleTransformDemo/app/src/main/java/&quot;</span>);<br>      <span class="hljs-keyword">return</span> cc;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            createPersonClass();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2ã€ä½¿ç”¨-Javassist-è°ƒç”¨ç”Ÿæˆçš„ç±»å¯¹è±¡"><a href="#2-2ã€ä½¿ç”¨-Javassist-è°ƒç”¨ç”Ÿæˆçš„ç±»å¯¹è±¡" class="headerlink" title="2.2ã€ä½¿ç”¨ Javassist è°ƒç”¨ç”Ÿæˆçš„ç±»å¯¹è±¡"></a>2.2ã€ä½¿ç”¨ Javassist è°ƒç”¨ç”Ÿæˆçš„ç±»å¯¹è±¡</h2><p>ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><blockquote><p>1ã€é€šè¿‡ç”Ÿæˆç±»æ—¶åˆ›å»ºçš„ CtClass å®ä¾‹å¯¹è±¡è·å– Class å¯¹è±¡ï¼Œç„¶åé€šè¿‡åå°„è°ƒç”¨</p><p>2ã€é€šè¿‡è¯»å–ç”Ÿæˆç±»çš„ä½ç½®ç”Ÿæˆ  CtClass å®ä¾‹å¯¹è±¡ï¼Œåœ¨é€šè¿‡ CtClass å®ä¾‹å¯¹è±¡è·å– Class å¯¹è±¡ï¼Œç„¶åé€šè¿‡åå°„è°ƒç”¨</p><p>3ã€é€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°æ¥å£çš„æ–¹å¼</p></blockquote><p>ä»¥ä¸Šé¢ç”Ÿæˆçš„ç±»ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥è°ƒç”¨ä¸€ä¸‹å®ƒ</p><p>1ã€é€šè¿‡ç”Ÿæˆç±»æ—¶åˆ›å»ºçš„ CtClass å®ä¾‹å¯¹è±¡è·å– Class å¯¹è±¡ï¼Œç„¶åé€šè¿‡åå°„è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCreateClass</span> &#123;<br><br>    <span class="hljs-comment">//...</span><br><br>    <span class="hljs-comment">//ä¿®æ”¹ main æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">CtClass</span> <span class="hljs-variable">ctClass</span> <span class="hljs-operator">=</span> createPersonClass();<br>            <span class="hljs-comment">//å°† ctClass è½¬æ¢æˆ Class å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨åå°„æ‹‰</span><br>            Class&lt;?&gt; clazz = ctClass.toClass();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> clazz.newInstance();<br>            <span class="hljs-comment">//è°ƒç”¨ Person çš„ set æ–¹æ³•å°† name è®¾ä¸ºï¼šerdai666</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">setNameMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;setName&quot;</span>,String.class);<br>            setNameMethod.invoke(o,<span class="hljs-string">&quot;erdai666&quot;</span>);<br>            <span class="hljs-comment">//è°ƒç”¨ printName æ–¹æ³•æ‰“å°å‡ºæ¥</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">printNameMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;printName&quot;</span>);<br>            printNameMethod.invoke(o);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œåï¼Œæ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><p>2ã€é€šè¿‡è¯»å–ç”Ÿæˆç±»çš„ä½ç½®ç”Ÿæˆ  CtClass å®ä¾‹å¯¹è±¡ï¼Œåœ¨é€šè¿‡ CtClass å®ä¾‹å¯¹è±¡è·å– Class å¯¹è±¡ï¼Œç„¶åé€šè¿‡åå°„è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCreateClass</span> &#123;<br>  <br>    <span class="hljs-comment">//...</span><br><br>    <span class="hljs-comment">//ä¿®æ”¹ main æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ClassPool</span> <span class="hljs-variable">classPool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();<br>            <span class="hljs-comment">//é€šè¿‡ç”Ÿæˆç±»çš„ç»å¯¹ä½ç½®æ„å»º CtClass å®ä¾‹å¯¹è±¡</span><br>            classPool.appendClassPath<br>                    (<span class="hljs-string">&quot;/Users/zhouying/AndroidStudioProjects/MixDemo/GradleTransformDemo/app/src/main/java/&quot;</span>);<br>            <span class="hljs-type">CtClass</span> <span class="hljs-variable">ctClass</span> <span class="hljs-operator">=</span> classPool.get(<span class="hljs-string">&quot;com.dream.gradletransformdemo.Person&quot;</span>);<br>            <span class="hljs-comment">//å°† ctClass è½¬æ¢æˆ Class å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨åå°„æ‹‰</span><br>            Class&lt;?&gt; clazz = ctClass.toClass();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> clazz.newInstance();<br>            <span class="hljs-comment">//è°ƒç”¨ Person çš„ set æ–¹æ³•å°† name è®¾ä¸ºï¼šerdai666</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">setNameMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;setName&quot;</span>,String.class);<br>            setNameMethod.invoke(o,<span class="hljs-string">&quot;erdai666&quot;</span>);<br>            <span class="hljs-comment">//è°ƒç”¨ printName æ–¹æ³•æ‰“å°å‡ºæ¥</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">printNameMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;printName&quot;</span>);<br>            printNameMethod.invoke(o);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œåï¼Œæ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><p>3ã€é€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°æ¥å£çš„æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPerson</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span>;<br><br>    String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">printName</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCreateClass</span> &#123;<br><br>    <span class="hljs-comment">//...</span><br><br>    <span class="hljs-comment">//ä¿®æ”¹ main æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ClassPool</span> <span class="hljs-variable">classPool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();<br>            <span class="hljs-comment">//é€šè¿‡ç”Ÿæˆç±»çš„ç»å¯¹ä½ç½®æ„å»º CtClass å®ä¾‹å¯¹è±¡</span><br>           classPool.appendClassPath<br>                    (<span class="hljs-string">&quot;/Users/zhouying/AndroidStudioProjects/MixDemo/GradleTransformDemo/app/src/main/java/&quot;</span>);<br>            <span class="hljs-comment">//è·å–æ¥å£</span><br>            <span class="hljs-type">CtClass</span> <span class="hljs-variable">iPersonCtClass</span> <span class="hljs-operator">=</span> classPool.get(<span class="hljs-string">&quot;com.dream.gradletransformdemo.IPerson&quot;</span>);<br>            <span class="hljs-comment">//è·å–ç”Ÿæˆçš„ç±» Person</span><br>            <span class="hljs-type">CtClass</span> <span class="hljs-variable">personCtClass</span> <span class="hljs-operator">=</span> classPool.get(<span class="hljs-string">&quot;com.dream.gradletransformdemo.Person&quot;</span>);<br>            <span class="hljs-comment">//è®© Person å®ç° IPerson æ¥å£</span><br>            personCtClass.setInterfaces(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[]&#123;iPersonCtClass&#125;);<br><br>            <span class="hljs-comment">//æ¥ä¸‹ä¿©å°±å¯ä»¥é€šè¿‡æ¥å£è¿›è¡Œè°ƒç”¨äº†</span><br>            <span class="hljs-type">IPerson</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> (IPerson) personCtClass.toClass().newInstance();<br>            person.setName(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>            person.printName();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œåï¼Œæ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><h2 id="2-3ã€Javassist-ä¿®æ”¹ç°æœ‰çš„ç±»å¯¹è±¡"><a href="#2-3ã€Javassist-ä¿®æ”¹ç°æœ‰çš„ç±»å¯¹è±¡" class="headerlink" title="2.3ã€Javassist ä¿®æ”¹ç°æœ‰çš„ç±»å¯¹è±¡"></a>2.3ã€Javassist ä¿®æ”¹ç°æœ‰çš„ç±»å¯¹è±¡</h2><p>ä¸€èˆ¬æˆ‘ä»¬ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ç»“åˆ Gradle Transform å®ç°å¯¹ç°æœ‰ç±»çš„æ’æ¡©</p><p>1ã€é¦–å…ˆæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ª PersonService.java çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.dream.gradletransformdemo;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PersonService</span> &#123;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getPerson</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;get Person&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">personFly</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I believe i can fly...&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ¥ä¸‹æ¥ä½¿ç”¨ Javassist å¯¹å®ƒè¿›è¡Œä¿®æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestUpdatePersonService</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">ClassPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();<br>            <span class="hljs-type">CtClass</span> <span class="hljs-variable">ctClass</span> <span class="hljs-operator">=</span> pool.get(<span class="hljs-string">&quot;com.dream.gradletransformdemo.PersonService&quot;</span>);<br><br>            <span class="hljs-type">CtMethod</span> <span class="hljs-variable">personFly</span> <span class="hljs-operator">=</span> ctClass.getDeclaredMethod(<span class="hljs-string">&quot;personFly&quot;</span>);<br>            <span class="hljs-comment">//åœ¨ personFly æ–¹æ³•çš„å‰åæ’å…¥ä»£ç </span><br>            <span class="hljs-comment">//å¤šè¡Œè¯­å¥å†™æ³•ï¼š</span><br>            <span class="hljs-comment">//&quot;&#123;System.out.println(\&quot;èµ·é£ä¹‹å‰å‡†å¤‡é™è½ä¼\&quot;);System.out.println(\&quot;èµ·é£ä¹‹å‰å‡†å¤‡é™è½ä¼111\&quot;);&#125;&quot;</span><br>            personFly.insertBefore(<span class="hljs-string">&quot;System.out.println(\&quot;èµ·é£ä¹‹å‰å‡†å¤‡é™è½ä¼\&quot;);&quot;</span>);<br>            personFly.insertAfter(<span class="hljs-string">&quot;System.out.println(\&quot;æˆåŠŸè½åœ°...\&quot;);&quot;</span>);<br><br>            <span class="hljs-comment">//æ–°å¢ä¸€ä¸ªæ–¹æ³•</span><br>            <span class="hljs-type">CtMethod</span> <span class="hljs-variable">ctMethod</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtMethod</span>(CtClass.voidType,<span class="hljs-string">&quot;joinFriend&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[]&#123;&#125;,ctClass);<br>            ctMethod.setModifiers(Modifier.PUBLIC);<br>            ctMethod.setBody(<span class="hljs-string">&quot;System.out.println(\&quot;I want to be your friend\&quot;);&quot;</span>);<br>            ctClass.addMethod(ctMethod);<br><br>            <span class="hljs-comment">//è·å–ç±»å¯¹è±¡ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨åå°„äº†</span><br>            Class&lt;?&gt; clazz = ctClass.toClass();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> clazz.newInstance();<br>            <span class="hljs-comment">//è°ƒç”¨ personFly æ–¹æ³•</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">personFlyMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;personFly&quot;</span>);<br>            personFlyMethod.invoke(o);<br>            <span class="hljs-comment">//è°ƒç”¨ joinFriend æ–¹æ³•</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">joinFriendMethod</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">&quot;joinFriend&quot;</span>);<br>            joinFriendMethod.invoke(o);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œåï¼Œæ‰“å°ç»“æœ</span><br>èµ·é£ä¹‹å‰å‡†å¤‡é™è½ä¼<br>I believe i can fly...<br>æˆåŠŸè½åœ°...<br>I want to be your friend<br></code></pre></td></tr></table></figure><p>éœ€è¦<strong>æ³¨æ„</strong>çš„æ˜¯ï¼š <strong>ä¸Šé¢çš„<code>insertBefore</code>ï¼Œ<code>insertAfter</code>ï¼Œ<code>setBody</code>ä¸­çš„è¯­å¥ï¼Œå¦‚æœä½ æ˜¯å•è¡Œè¯­å¥å¯ä»¥ç›´æ¥ç”¨åŒå¼•å·ï¼Œä½†æ˜¯æœ‰å¤šè¡Œè¯­å¥çš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å°†å¤šè¡Œè¯­å¥ç”¨<code>&#123;&#125;</code>æ‹¬èµ·æ¥ã€‚Javassist åªæ¥å—å•ä¸ªè¯­å¥æˆ–ç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥çš„è¯­å¥å—</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥å®æˆ˜ç¯èŠ‚</p><h1 id="ä¸‰ã€Gradle-Transform-Javassist-å®æˆ˜"><a href="#ä¸‰ã€Gradle-Transform-Javassist-å®æˆ˜" class="headerlink" title="ä¸‰ã€Gradle Transform + Javassist å®æˆ˜"></a>ä¸‰ã€Gradle Transform + Javassist å®æˆ˜</h1><p>é¦–å…ˆçœ‹ä¸‹æˆ‘ä»¬è¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<strong>å‘ç°æŸä¸ªç¬¬ä¸‰æ–¹åº“æœ‰ bug ï¼Œç”¨èµ·æ¥ä¸çˆ½ï¼Œä½†åˆä¸æƒ³æ‹¿å®ƒçš„æºç ä¿®æ”¹åœ¨é‡æ–°ç¼–è¯‘ï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Ÿ</strong></p><p>æˆ‘çš„æ€è·¯ï¼š<strong>ä½¿ç”¨ Gradle Transform + Javassit ä¿®æ”¹åº“é‡Œé¢æ–¹æ³•çš„å†…éƒ¨å®ç°</strong>ï¼Œç­‰äºæ²¡è¯´ï¼ŒğŸ˜„ï¼Œæˆ‘ä»¬æ¥å®æ“ä¸€ä¸‹</p><p>é¦–å…ˆå¼•å…¥ä¸€ä¸ªæˆ‘å‡†å¤‡å¥½çš„ç¬¬ä¸‰æ–¹åº“ï¼š</p><p>åœ¨é¡¹ç›®çš„æ ¹ build.gradle åŠ å…¥ Jitpack ä»“åº“ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">allprojects &#123;<br>    repositories &#123;<br>     <span class="hljs-comment">//...</span><br>        maven &#123; url <span class="hljs-string">&#x27;https://jitpack.io&#x27;</span> &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ app çš„ build.gradle ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation <span class="hljs-string">&#x27;com.github.sweetying520:AndroidUtils:1.0.7&#x27;</span><br></code></pre></td></tr></table></figure><p>okï¼Œæ¥ç€æˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªåº“ä¸­ StringUtils çš„æºç ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1befbd2f80a84595b2e841f8cfb451e5~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030154505788.png" width="50%" /><p>å—¯ï¼Œå°±ä¸¤ä¸ªç®€å•çš„å·¥å…·ç±»ï¼Œæˆ‘ä»¬åœ¨ MainActivity ä¸­ä½¿ç”¨ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        StringUtils.getCharArray(<span class="hljs-literal">null</span>)<br>        StringUtils.getLength(<span class="hljs-literal">null</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œé¡¹ç›®ï¼Œä½ ä¼šå‘ç° Crash äº†ï¼ŒæŸ¥çœ‹ Log æ—¥å¿—å‘ç°æ˜¯ç©ºæŒ‡é’ˆå¼‚å¸¸</p><p>æ£€æŸ¥ç¬¬ä¸‰æ–¹åº“å‘ç°è¿™ä¸¤ä¸ªæ–¹æ³•æ²¡æœ‰åšç©ºåˆ¤æ–­ï¼Œä¼  nullï¼Œç¨‹åºè‚¯å®šå°± Crash äº†ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½å…è®¸è¿™ç§äº‹æƒ…å‘ç”Ÿï¼Œå½“ç„¶ä½ å¯ä»¥ç›´æ¥ä¿®æ”¹æºç åé‡æ–°å‘å¸ƒï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¤ªç®€å•äº†ï¼Œå­¦ä¹ æˆ‘ä»¬å°±åº”è¯¥ä¸æ–­çš„å»æŒ‘æˆ˜è‡ªå·±ï¼Œæƒ³ä¸€äº›åˆ›æ–°çš„æ€è·¯ï¼Œä»Šå¤©æˆ‘ä»¬å°±ç«™åœ¨ä¿®æ”¹å­—èŠ‚ç çš„è§’åº¦å»ä¿®å¤å®ƒ</p><p>è‡ªå®šä¹‰ä¸€ä¸ª Transform ç»§æ‰¿æˆ‘ä»¬ä¸Šç¯‡æ–‡ç« å†™çš„ Transform æ¨¡ç‰ˆï¼Œä½¿ç”¨ Javassist è¿›è¡Œæ’æ¡©ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FixThirdLibTransform</span> : <span class="hljs-type">BaseCustomTransform</span>(<span class="hljs-literal">true</span>) &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å– Transform åç§°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;FixThirdLibTransform&quot;</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åªå¤„ç† StringUtils.class æ–‡ä»¶ï¼Œå…¶ä»–çš„éƒ½ç»™è¿‡æ»¤æ‰</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">classFilter</span><span class="hljs-params">(className: <span class="hljs-type">String</span>)</span></span> = className.endsWith(<span class="hljs-string">&quot;StringUtils.class&quot;</span>)<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”¨äºè¿‡æ»¤ Variantï¼Œè¿”å› false è¡¨ç¤º Variant ä¸æ‰§è¡Œè¯¥ Transform</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Incubating</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">applyToVariant</span><span class="hljs-params">(variant: <span class="hljs-type">VariantInfo</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;debug&quot;</span> == variant?.buildTypeName<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡æ­¤æ–¹æ³•è¿›è¡Œå­—èŠ‚ç æ’æ¡©</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">provideFunction</span><span class="hljs-params">()</span></span> = &#123; input: InputStream, output: OutputStream -&gt;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">val</span> classPool = ClassPool.getDefault()<br>            <span class="hljs-keyword">val</span> makeClass = classPool.makeClass(input)<br>            <span class="hljs-comment">//å¯¹ StringUtils çš„ getLength è¿›è¡Œæ’æ¡©</span><br>            <span class="hljs-keyword">val</span> getLengthMethod = makeClass.getDeclaredMethod(<span class="hljs-string">&quot;getLength&quot;</span>)<br>            getLengthMethod.insertBefore(<span class="hljs-string">&quot;&#123;System.out.println(\&quot;Hello getLength bugä¿®å¤äº†..\&quot;);if($1==null)return 0;&#125;&quot;</span>)<br><br>            <span class="hljs-comment">//å¯¹ StringUtils çš„ getCharArray è¿›è¡Œæ’æ¡©</span><br>            <span class="hljs-keyword">val</span> getCharArrayMethod = makeClass.getDeclaredMethod(<span class="hljs-string">&quot;getCharArray&quot;</span>)<br>            getCharArrayMethod.insertBefore(<span class="hljs-string">&quot;&#123;System.out.println(\&quot;Hello getCharArray bugä¿®å¤äº†..\&quot;);if($1==null)return new char[0];&#125;&quot;</span>)<br><br>            <span class="hljs-comment">//æ‰“å° logï¼Œæ­¤ log æ˜¯ BaseCustomTransform é‡Œé¢çš„</span><br>            log(<span class="hljs-string">&quot;æ’æ¡©çš„ç±»åï¼š<span class="hljs-subst">$&#123;makeClass.name&#125;</span>&quot;</span>)<br>            makeClass.declaredMethods.forEach &#123;<br>                log(<span class="hljs-string">&quot;æ’æ¡©çš„æ–¹æ³•åï¼š<span class="hljs-variable">$it</span>&quot;</span>)<br>            &#125;<br>            output.write(makeClass.toBytecode())<br>            makeClass.detach()<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ CustomTransformPlugin è¿›è¡Œæ’ä»¶çš„æ³¨å†Œï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomTransformPlugin</span>: <span class="hljs-type">Plugin</span>&lt;<span class="hljs-type">Project</span>&gt; &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(project: <span class="hljs-type">Project</span>)</span></span> &#123;<br>      <span class="hljs-comment">//...</span><br>       <br>        <span class="hljs-comment">// 1ã€è·å– Android æ‰©å±•</span><br>        <span class="hljs-keyword">val</span> androidExtension = project.extensions.getByType(AppExtension::<span class="hljs-keyword">class</span>.java)<br>        <span class="hljs-comment">// 2ã€æ³¨å†Œ Transform</span><br>      <span class="hljs-comment">//...</span><br>        androidExtension.registerTransform(FixThirdLibTransform())<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‘å¸ƒä¸€ä¸ªæ–°çš„æ’ä»¶ç‰ˆæœ¬ï¼Œä¿®æ”¹æ ¹ build.gradle æ’ä»¶çš„ç‰ˆæœ¬ï¼ŒåŒæ­¥åé‡æ–°è¿è¡Œ appï¼Œæ•ˆæœéªŒè¯ï¼š</p><p>1ã€å…ˆçœ‹ä¸€çœ¼æˆ‘ä»¬è‡ªå®šä¹‰ Transform é‡Œé¢çš„ log æ‰“å°ï¼Œç¬¦åˆé¢„æœŸï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84bd3d6347245369c016fd7418c651b~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030173819432.png" width="100%" /><p>2ã€åœ¨çœ‹ä¸‹ app æ•ˆæœï¼Œæ²¡æœ‰å¥”æºƒï¼Œç¬¦åˆé¢„æœŸ</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a798524ab25a492288337456e8eb9a02~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><p>3ã€æœ€åçœ‹ä¸€çœ¼æˆ‘ä»¬æ’æ¡©çš„ log æ—¥å¿—ï¼Œç¬¦åˆé¢„æœŸ</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af1c491bb74f48af80b65c185a78a7a9~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030174041379.png" width="100%" /><h1 id="å››ã€Gradle-Transform-ASM-å®æˆ˜"><a href="#å››ã€Gradle-Transform-ASM-å®æˆ˜" class="headerlink" title="å››ã€Gradle Transform + ASM å®æˆ˜"></a>å››ã€Gradle Transform + ASM å®æˆ˜</h1><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Gradle Transform + ASM è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼š<strong>æˆ‘æƒ³åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹ï¼Œç»Ÿè®¡æŸä¸ªæ–¹æ³•çš„è€—æ—¶ï¼Œå¯¹æŸä¸ªæ–¹æ³•åšåŸ‹ç‚¹ï¼Œæ€ä¹ˆåšï¼Ÿ</strong></p><p>å°±ä»¥ MainActivity çš„ onCreate æ–¹æ³•ä¸ºä¾‹å­ï¼Œæˆ‘ä»¬ç»Ÿè®¡ä¸€ä¸‹ onCreate æ–¹æ³•çš„è€—æ—¶</p><p>1ã€é¦–å…ˆéœ€è¦å¤§å®¶å…ˆå®‰è£…ä¸€ä¸ªæ’ä»¶ï¼š<strong>ASM Bytecode Viewer Support Kotlin</strong> ï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è¿›è¡Œ ASM å­—èŠ‚ç æ’æ¡©çš„æ“ä½œ</p><p>æ‰“å¼€ MainActivity ï¼Œçœ‹ä¸€çœ¼ onCreate æ–¹æ³•æ’æ¡©ä¹‹å‰çš„ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        StringUtils.getCharArray(<span class="hljs-literal">null</span>)<br>        StringUtils.getLength(<span class="hljs-literal">null</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å³é”®é€‰æ‹©ï¼šASM Bytecode Viewer</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df6fe59775e646dd9282725e0144b751~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030175737613.png" width="50%" /><p>ä¼šç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼Œé€‰æ‹© ASMified ï¼Œå°±å¯ä»¥çœ‹åˆ° ASM å­—èŠ‚ç äº†</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/75d6b802f5f34e22a0ad8512c8006fd9~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030175957430.png" width="100%" /><p><strong>æ³¨æ„</strong>ï¼šæˆ‘ä»¬è¦æ“ä½œçš„æ˜¯ ASM å­—èŠ‚ç ï¼Œè€Œé Java å­—èŠ‚ç ï¼Œå…¶å®äºŒè€…éå¸¸æ¥è¿‘ï¼Œåªä¸è¿‡ ASM å­—èŠ‚ç æ˜¯ç”¨ Java ä»£ç çš„å½¢å¼æ¥æè¿°çš„</p><p>2ã€ä¿®æ”¹ MainActivity onCreate æ–¹æ³•ä»£ç </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> startTime = SystemClock.elapsedRealtime()<br>        Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCreate startTime: <span class="hljs-variable">$startTime</span>&quot;</span>)<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        StringUtils.getCharArray(<span class="hljs-literal">null</span>)<br>        StringUtils.getLength(<span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">val</span> endTime = SystemClock.elapsedRealtime()<br>        Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCreate endTime: <span class="hljs-variable">$endTime</span>&quot;</span>)<br>        <span class="hljs-keyword">val</span> cost = endTime - startTime<br>        Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCreate è€—æ—¶: <span class="hljs-variable">$cost</span>&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‡æ–°æŸ¥çœ‹ ASM å­—èŠ‚ç ï¼Œç„¶åç‚¹å‡»ï¼šShow differences ï¼Œå°±ä¼šå‡ºæ¥å‰åä¸¤æ¬¡ä»£ç çš„å¯¹æ¯”ï¼Œç»¿è‰²éƒ¨åˆ†ä»£ç å°±æ˜¯æˆ‘ä»¬è¦æ·»åŠ çš„</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/169a930b56804175b10662a27cebbab5~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030181005402.png" width="100%" /><p>3ã€åˆ›å»ºä¸€ä¸ª Transform ç»§æ‰¿ BaseTransform ï¼Œç¼–å†™ ASM ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CostTimeTransform</span>: <span class="hljs-type">BaseCustomTransform</span>(<span class="hljs-literal">true</span>) &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å– Transform åç§°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;CostTimeTransform&quot;</span><br>    &#125;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿‡æ»¤åªç»Ÿè®¡ä»¥ Activity.class ç»“å°¾çš„æ–‡ä»¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">classFilter</span><span class="hljs-params">(className: <span class="hljs-type">String</span>)</span></span> = className.endsWith(<span class="hljs-string">&quot;Activity.class&quot;</span>)<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”¨äºè¿‡æ»¤ Variantï¼Œè¿”å› false è¡¨ç¤º Variant ä¸æ‰§è¡Œè¯¥ Transform</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Incubating</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">applyToVariant</span><span class="hljs-params">(variant: <span class="hljs-type">VariantInfo</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;debug&quot;</span> == variant?.buildTypeName<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡æ­¤æ–¹æ³•è¿›è¡Œå­—èŠ‚ç æ’æ¡©</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">provideFunction</span><span class="hljs-params">()</span></span> = &#123; input: InputStream,output: OutputStream -&gt;<br>        <span class="hljs-comment">//ä½¿ç”¨ input è¾“å…¥æµæ„å»º ClassReader</span><br>        <span class="hljs-keyword">val</span> reader = ClassReader(input)<br>        <span class="hljs-comment">//ä½¿ç”¨ ClassReader å’Œ flags æ„å»º ClassWriter</span><br>        <span class="hljs-keyword">val</span> writer = ClassWriter(reader, ClassWriter.COMPUTE_FRAMES)<br>        <span class="hljs-comment">//ä½¿ç”¨ ClassWriter æ„å»ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ ClassVisitor</span><br>        <span class="hljs-keyword">val</span> visitor = CostTimeClassVisitor(writer)<br>        <span class="hljs-comment">//æœ€åé€šè¿‡ ClassReader çš„ accept å°†æ¯ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ä¼ é€’ç»™ ClassVisitor</span><br>        reader.accept(visitor, ClassReader.SKIP_DEBUG or  ClassReader.SKIP_FRAMES)<br>        <span class="hljs-comment">//å°†ä¿®æ”¹åçš„å­—èŠ‚ç æ–‡ä»¶è½¬æ¢æˆå­—èŠ‚æ•°ç»„</span><br>        <span class="hljs-keyword">val</span> byteArray = writer.toByteArray()<br>        <span class="hljs-comment">//æœ€åé€šè¿‡è¾“å‡ºæµä¿®æ”¹æ–‡ä»¶ï¼Œè¿™æ ·å°±å®ç°äº†å­—èŠ‚ç çš„æ’æ¡©</span><br>        output.write(byteArray)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€æ ¸å¿ƒé€»è¾‘çš„å¤„ç†æ˜¯åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ ClassVisitor ä¸­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.dream.customtransformplugin<br><br><span class="hljs-keyword">import</span> org.objectweb.asm.*<br><span class="hljs-keyword">import</span> org.objectweb.asm.commons.AdviceAdapter<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CostTimeClassVisitor</span>(nextVisitor: ClassVisitor) : ClassVisitor(Opcodes.ASM6,nextVisitor) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">visitMethod</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">        access: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        name: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        descriptor: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        signature: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        exceptions: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">String</span>&gt;?</span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>: MethodVisitor &#123;<br>        <span class="hljs-keyword">val</span> visitor = <span class="hljs-keyword">super</span>.visitMethod(access, name, descriptor, signature, exceptions)<br>        <span class="hljs-comment">// AdviceAdapter æ˜¯ MethodVisitor çš„å­ç±»ï¼Œä½¿ç”¨ AdviceAdapter å¯ä»¥æ›´æ–¹ä¾¿çš„ä¿®æ”¹æ–¹æ³•çš„å­—èŠ‚ç ã€‚</span><br>        <span class="hljs-comment">// AdviceAdapterå…¶ä¸­å‡ ä¸ªé‡è¦æ–¹æ³•å¦‚ä¸‹ï¼š</span><br>        <span class="hljs-comment">// void visitCode()ï¼šè¡¨ç¤º ASM å¼€å§‹æ‰«æè¿™ä¸ªæ–¹æ³•</span><br>        <span class="hljs-comment">// void onMethodEnter()ï¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•</span><br>        <span class="hljs-comment">// void onMethodExit()ï¼šå³å°†ä»è¿™ä¸ªæ–¹æ³•å‡ºå»</span><br>        <span class="hljs-comment">// void onVisitEnd()ï¼šè¡¨ç¤ºæ–¹æ³•æ‰«æå®Œæ¯•</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">object</span> : AdviceAdapter(Opcodes.ASM6, visitor, access, name, descriptor) &#123;<br><br>            <span class="hljs-comment">//åœ¨åŸæ–¹æ³•ä»£ç çš„å‰é¢æ’å…¥ä»£ç </span><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onMethodEnter</span><span class="hljs-params">()</span></span> &#123;<br>                visitMethodInsn(INVOKESTATIC, <span class="hljs-string">&quot;android/os/SystemClock&quot;</span>, <span class="hljs-string">&quot;elapsedRealtime&quot;</span>, <span class="hljs-string">&quot;()J&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitVarInsn(LSTORE, <span class="hljs-number">2</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;erdai&quot;</span>)<br>                visitTypeInsn(NEW, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>)<br>                visitInsn(DUP)<br>                visitMethodInsn(INVOKESPECIAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-string">&quot;()V&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;onCreate startTime: &quot;</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitVarInsn(LLOAD, <span class="hljs-number">2</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(J)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;toString&quot;</span>, <span class="hljs-string">&quot;()Ljava/lang/String;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKESTATIC, <span class="hljs-string">&quot;android/util/Log&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;Ljava/lang/String;)I&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitInsn(POP)<br>            &#125;<br><br>            <span class="hljs-comment">//åœ¨åŸæ–¹æ³•ä»£ç çš„åé¢æ’å…¥ä»£ç </span><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onMethodExit</span><span class="hljs-params">(opcode: <span class="hljs-type">Int</span>)</span></span> &#123;<br>                visitMethodInsn(INVOKESTATIC, <span class="hljs-string">&quot;android/os/SystemClock&quot;</span>, <span class="hljs-string">&quot;elapsedRealtime&quot;</span>, <span class="hljs-string">&quot;()J&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitVarInsn(LSTORE, <span class="hljs-number">4</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;erdai&quot;</span>)<br>                visitTypeInsn(NEW, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>)<br>                visitInsn(DUP)<br>                visitMethodInsn(INVOKESPECIAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-string">&quot;()V&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;onCreate endTime: &quot;</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitVarInsn(LLOAD, <span class="hljs-number">4</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(J)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;toString&quot;</span>, <span class="hljs-string">&quot;()Ljava/lang/String;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKESTATIC, <span class="hljs-string">&quot;android/util/Log&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;Ljava/lang/String;)I&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitInsn(POP)<br>                visitVarInsn(LLOAD, <span class="hljs-number">4</span>)<br>                visitVarInsn(LLOAD, <span class="hljs-number">2</span>)<br>                visitInsn(LSUB)<br>                visitVarInsn(LSTORE, <span class="hljs-number">6</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;erdai&quot;</span>)<br>                visitTypeInsn(NEW, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>)<br>                visitInsn(DUP)<br>                visitMethodInsn(INVOKESPECIAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-string">&quot;()V&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitLdcInsn(<span class="hljs-string">&quot;onCreate \u8017\u65f6: &quot;</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitVarInsn(LLOAD, <span class="hljs-number">6</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;append&quot;</span>, <span class="hljs-string">&quot;(J)Ljava/lang/StringBuilder;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKEVIRTUAL, <span class="hljs-string">&quot;java/lang/StringBuilder&quot;</span>, <span class="hljs-string">&quot;toString&quot;</span>, <span class="hljs-string">&quot;()Ljava/lang/String;&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitMethodInsn(INVOKESTATIC, <span class="hljs-string">&quot;android/util/Log&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;Ljava/lang/String;)I&quot;</span>, <span class="hljs-literal">false</span>)<br>                visitInsn(POP)<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬åœ¨ Activity ä¸­æ’å…¥æ–¹æ³•çš„è€—æ—¶å°±å·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼š<strong>åˆšè¯´çš„ Activity æ˜¯æ‰€æœ‰çš„ Activity åŒ…æ‹¬ç³»ç»Ÿçš„</strong>ï¼Œ<strong>æ–¹æ³•æ˜¯æ‰€æœ‰çš„æ–¹æ³•</strong> ï¼Œè¿™ç§æ•ˆæœè‚¯å®šä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œè€Œä¸”è¿˜å¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œå¯ä»¥åŠ ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£å»æ§åˆ¶ä¸€ä¸‹ï¼Œåªç»Ÿè®¡æ·»åŠ äº†æ³¨è§£æ–¹æ³•çš„è€—æ—¶</p><p>5ã€åœ¨ä¸»å·¥ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.dream.gradletransformdemo.<span class="hljs-keyword">annotation</span>;<br><br><span class="hljs-keyword">import</span> java.lang.<span class="hljs-keyword">annotation</span>.ElementType;<br><span class="hljs-keyword">import</span> java.lang.<span class="hljs-keyword">annotation</span>.Retention;<br><span class="hljs-keyword">import</span> java.lang.<span class="hljs-keyword">annotation</span>.RetentionPolicy;<br><span class="hljs-keyword">import</span> java.lang.<span class="hljs-keyword">annotation</span>.Target;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è‡ªå®šä¹‰æ–¹æ³•è€—æ—¶æ³¨è§£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> CostTime &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>6ã€æ¥ç€å¯¹ CostTimeClassVisitor ä»£ç è¿›è¡Œä¿®æ”¹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CostTimeClassVisitor</span>(nextVisitor: ClassVisitor) : ClassVisitor(Opcodes.ASM6,nextVisitor) &#123;<br>    <span class="hljs-comment">//æ˜¯å¦éœ€è¦è¢« hook</span><br>    <span class="hljs-keyword">var</span> isHook = <span class="hljs-literal">false</span><br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">visitMethod</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">        access: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        name: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        descriptor: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        signature: <span class="hljs-type">String</span>?,</span></span><br><span class="hljs-params"><span class="hljs-function">        exceptions: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">String</span>&gt;?</span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>: MethodVisitor &#123;<br>        <span class="hljs-keyword">val</span> visitor = <span class="hljs-keyword">super</span>.visitMethod(access, name, descriptor, signature, exceptions)<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">object</span> : AdviceAdapter(Opcodes.ASM6, visitor, access, name, descriptor) &#123;<br><br>            <span class="hljs-comment">/**</span><br><span class="hljs-comment">             * è®¿é—®è‡ªå®šä¹‰æ³¨è§£</span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">visitAnnotation</span><span class="hljs-params">(descriptor: <span class="hljs-type">String</span>, visible: <span class="hljs-type">Boolean</span>)</span></span>: AnnotationVisitor? &#123;<br>              <span class="hljs-comment">//å¦‚æœæ·»åŠ äº†è‡ªå®šä¹‰æ³¨è§£ï¼Œåˆ™è¿›è¡Œ hook</span><br>                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;Lcom/dream/gradletransformdemo/annotation/CostTime;&quot;</span> == descriptor) &#123;<br>                    isHook = <span class="hljs-literal">true</span><br>                &#125;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.visitAnnotation(descriptor, visible)<br>            &#125;<br><br>            <span class="hljs-comment">//åœ¨åŸæ–¹æ³•ä»£ç çš„å‰é¢æ’å…¥ä»£ç </span><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onMethodEnter</span><span class="hljs-params">()</span></span> &#123;<br>                <span class="hljs-keyword">if</span>(!isHook)<span class="hljs-keyword">return</span><br>              <span class="hljs-comment">//...</span><br>                <br>            &#125;<br><br>            <span class="hljs-comment">//åœ¨åŸæ–¹æ³•ä»£ç çš„åé¢æ’å…¥ä»£ç </span><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onMethodExit</span><span class="hljs-params">(opcode: <span class="hljs-type">Int</span>)</span></span> &#123;<br>                <span class="hljs-keyword">if</span>(!isHook)<span class="hljs-keyword">return</span><br>                <span class="hljs-comment">//...</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>okï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰ Gradle Transform å°±ç¼–å†™å®Œæˆäº†</p><p>åœ¨ CustomTransformPlugin è¿›è¡Œæ’ä»¶çš„æ³¨å†Œï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomTransformPlugin</span>: <span class="hljs-type">Plugin</span>&lt;<span class="hljs-type">Project</span>&gt; &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(project: <span class="hljs-type">Project</span>)</span></span> &#123;<br>      <span class="hljs-comment">//...</span><br>       <br>        <span class="hljs-comment">// 1ã€è·å– Android æ‰©å±•</span><br>        <span class="hljs-keyword">val</span> androidExtension = project.extensions.getByType(AppExtension::<span class="hljs-keyword">class</span>.java)<br>        <span class="hljs-comment">// 2ã€æ³¨å†Œ Transform</span><br>      <span class="hljs-comment">//...</span><br>        androidExtension.registerTransform(CostTimeTransform())<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‘å¸ƒä¸€ä¸ªæ–°çš„æ’ä»¶ç‰ˆæœ¬ï¼Œä¿®æ”¹æ ¹ build.gradle æ’ä»¶çš„ç‰ˆæœ¬ï¼ŒåŒæ­¥åé‡æ–°è¿è¡Œ appï¼Œæ•ˆæœéªŒè¯ï¼š</p><p>1ã€çœ‹æ§åˆ¶å° log æ—¥å¿—æ‰“å°ï¼Œç¬¦åˆé¢„æœŸï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1faec719787f48329555ab8e45a92273~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030194559152.png" width="100%" /><p>2ã€æ¥ç€é€šè¿‡åç¼–è¯‘å·¥å…·çœ‹ä¸‹æˆ‘ä»¬æ’æ¡©åçš„ MainActivity ï¼Œç¬¦åˆé¢„æœŸï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4cf0cb63fd5c45d2bb412beb15614b0c~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030194522742.png" width="50%" /><h1 id="äº”ã€AGP-8-0-ç‰ˆæœ¬å…³äº-Gradle-Transform-çš„æ›¿æ¢æ–¹æ¡ˆ"><a href="#äº”ã€AGP-8-0-ç‰ˆæœ¬å…³äº-Gradle-Transform-çš„æ›¿æ¢æ–¹æ¡ˆ" class="headerlink" title="äº”ã€AGP 8.0 ç‰ˆæœ¬å…³äº Gradle Transform çš„æ›¿æ¢æ–¹æ¡ˆ"></a>äº”ã€AGP 8.0 ç‰ˆæœ¬å…³äº Gradle Transform çš„æ›¿æ¢æ–¹æ¡ˆ</h1><p>Google åœ¨ AGP 8.0 ä¼šå°† Gradle Transform ç»™ç§»é™¤ï¼Œå› æ­¤å¦‚æœé¡¹ç›®å‡çº§äº† AGP 8.0ï¼Œå°±éœ€è¦åšå¥½ Gradle Transform çš„å…¼å®¹ã€‚</p><p><code>Gradle Transform</code>è¢«åºŸå¼ƒä¹‹åï¼Œå®ƒçš„ä»£æ›¿å“æ˜¯<code>Transform Action</code>ï¼Œ<code>Transform API</code>æ˜¯ç”±<code>AGP</code>æä¾›çš„ï¼Œè€Œ<code>Transform Action</code>åˆ™æ˜¯ç”±Gradle æä¾›ã€‚ä¸å…‰æ˜¯ <code>AGP</code> éœ€è¦ <code>Transform</code>ï¼Œ<code>Java</code> ä¹Ÿéœ€è¦ï¼Œæ‰€ä»¥ç”± <code>Gradle</code> æ¥æä¾›ç»Ÿä¸€çš„ <code>Transform API</code> ä¹Ÿåˆæƒ…åˆç†ï¼Œå…³äº <code>Transform Action</code>ä¸æ‰“ç®—ä»‹ç»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹è¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7131889789787176974">Transform è¢«åºŸå¼ƒï¼ŒTransformAction äº†è§£ä¸€ä¸‹~</a></p><p>æˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸€ä¸‹ AGP ç»™æˆ‘ä»¬æä¾›çš„ <code>AsmClassVisitorFactory</code></p><h2 id="5-1ã€AsmClassVisitorFactory-ä»‹ç»"><a href="#5-1ã€AsmClassVisitorFactory-ä»‹ç»" class="headerlink" title="5.1ã€AsmClassVisitorFactory ä»‹ç»"></a>5.1ã€AsmClassVisitorFactory ä»‹ç»</h2><p>1ã€AsmClassVisitorFactory å°±å¥½æ¯”æˆ‘ä»¬ä¹‹å‰å†™çš„è‡ªå®šä¹‰ Transform æ¨¡ç‰ˆï¼Œåªä¸è¿‡ç°åœ¨æ˜¯ç”±å®˜æ–¹æä¾›äº†ï¼Œé‡Œé¢åšäº†å¤§é‡çš„å°è£…ï¼šè¾“å…¥æ–‡ä»¶éå†ã€åŠ è§£å‹ã€å¢é‡ï¼Œå¹¶å‘ç­‰ï¼Œç®€åŒ–æˆ‘ä»¬çš„ä¸€ä¸ªä½¿ç”¨ã€‚æ ¹æ®å®˜æ–¹çš„è¯´æ³•ï¼ŒAsmClassVisitoFactory ä¼šå¸¦æ¥çº¦18%çš„æ€§èƒ½æå‡ï¼ŒåŒæ—¶å¯ä»¥å‡å°‘çº¦ 5 å€ä»£ç ã€‚</p><p>2ã€å¦å¤–ä»å‘½åä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒGoogle æ›´åŠ æ¨èæˆ‘ä»¬ä½¿ç”¨ ASM è¿›è¡Œå­—èŠ‚ç çš„æ’æ¡©</p><h2 id="5-2ã€AsmClassVisitorFactory-ä½¿ç”¨"><a href="#5-2ã€AsmClassVisitorFactory-ä½¿ç”¨" class="headerlink" title="5.2ã€AsmClassVisitorFactory ä½¿ç”¨"></a>5.2ã€AsmClassVisitorFactory ä½¿ç”¨</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ›¿æ¢ä¸€ä¸‹ Gradle Transform + ASM çš„å®ç°æ–¹æ¡ˆï¼Œä½¿ç”¨ AsmClassVisitorFactory çœŸçš„æ˜¯éå¸¸ç®€å•ï¼š</p><p>1ã€è‡ªå®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ç»§æ‰¿ AsmClassVisitorFactoryï¼Œç„¶å createClassVisitor æ–¹æ³•è¿”å›ä¹‹å‰å†™çš„ CostTimeClassVisitor å³å¯</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.dream.customtransformplugin.foragp8<br><br><span class="hljs-keyword">import</span> com.android.build.api.instrumentation.*<br><span class="hljs-keyword">import</span> com.dream.customtransformplugin.costtime.CostTimeClassVisitor<br><span class="hljs-keyword">import</span> org.objectweb.asm.ClassVisitor<br><br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CostTimeASMFactory</span>: <span class="hljs-type">AsmClassVisitorFactory</span>&lt;<span class="hljs-type">InstrumentationParameters.None</span>&gt; &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createClassVisitor</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">        classContext: <span class="hljs-type">ClassContext</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        nextClassVisitor: <span class="hljs-type">ClassVisitor</span></span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>: ClassVisitor &#123;<br>        <span class="hljs-keyword">return</span> CostTimeClassVisitor(nextClassVisitor)<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isInstrumentable</span><span class="hljs-params">(classData: <span class="hljs-type">ClassData</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ¥ä¸‹æ¥åœ¨ CustomTransformPlugin è¿›è¡Œæ³¨å†Œï¼Œæ³¨å†Œä½¿ç”¨äº†ä¸€ç§æ–°çš„æ–¹å¼ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/840a846b0a0d4bf890c504f8105021d2~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030202421200.png" width="100%" /><p>3ã€å‘å¸ƒä¸€ä¸ªæ–°çš„æ’ä»¶ç‰ˆæœ¬ï¼Œä¿®æ”¹æ ¹ build.gradle æ’ä»¶çš„ç‰ˆæœ¬ï¼ŒåŒæ­¥åé‡æ–°è¿è¡Œ appï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„</p><p>ä¸€äº›ä¸åŒç‚¹ï¼š</p><p>1ã€ç¼–è¯‘ä»»åŠ¡çš„ Task åç§°å˜äº†ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b93abc01ba554764aed034bda62ceba5~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030202805807.png" width="100%" /><p>2ã€æˆ‘ä»¬ç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´äº§ç‰©æœ‰äº† Asm ç›¸å…³çš„æ–‡ä»¶å¤¹ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¸€ä¸ªæ•ˆæœçš„éªŒè¯</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d19e57f5e4664c1bae1a6f48f15e4edb~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221030203100651.png" width="50%" /><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼š Kotlin æ–‡ä»¶çœ‹ä¸åˆ°æ’æ¡©çš„ä»£ç ï¼Œæ·¦ğŸ˜¯</p><h1 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h1><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€ASM Visitor Api ä¸­çš„å‡ ä¸ªæ ¸å¿ƒç±»ï¼š</p><blockquote><p>1ã€ClassVisitor</p><p>2ã€ClassReader</p><p>3ã€ClassWriter</p></blockquote><p>2ã€Javassist ç›¸å…³è¯­æ³•ï¼Œä½¿ç”¨èµ·æ¥æ¥è¿‘åŸç”Ÿçš„åå°„ Api ï¼Œæ¯”è¾ƒå®¹æ˜“ä¸Šæ‰‹</p><p>3ã€è‡ªå®šä¹‰ GradleTransform + Javassist å®ç°äº†ä¿®æ”¹ç¬¬ä¸‰æ–¹åº“çš„æºç </p><p>4ã€è‡ªå®šä¹‰ GradleTransform + ASM å®ç°äº† MainActivity onCreate æ–¹æ³•è€—æ—¶çš„ç»Ÿè®¡</p><p>5ã€ä»‹ç»äº† AGP 8.0 Gradle Transform è¢«ç§»é™¤åä½¿ç”¨ AsmClassVisitorFactory è¿›è¡Œé€‚é…ï¼Œè¿‡ç¨‹éå¸¸ç®€å•</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><a href="https://github.com/sweetying520/GradleTransformDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥ç»“åˆ demo ä¸€èµ·çœ‹ï¼Œæ•ˆæœæ æ æ»´ğŸº</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h2 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h2><p><a href="https://rebooters.github.io/2020/01/04/Gradle-Transform-ASM-%E6%8E%A2%E7%B4%A2/">Gradle Transform + ASM æ¢ç´¢</a></p><p><a href="https://juejin.cn/post/7131889789787176974">Transform è¢«åºŸå¼ƒï¼ŒTransformAction äº†è§£ä¸€ä¸‹~</a></p><p><a href="https://juejin.cn/post/7105925343680135198#heading-2">Transform è¢«åºŸå¼ƒï¼ŒASM å¦‚ä½•é€‚é…?</a></p><p><a href="https://juejin.cn/post/7078681608206680094#heading-3">javassistè¯¦è§£</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šCSS ç­‘åŸºä¸Šç¯‡</title>
    <link href="/2022/10/26/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9ACSS%20%E7%AD%91%E5%9F%BA%E4%B8%8A%E7%AF%87/"/>
    <url>/2022/10/26/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9ACSS%20%E7%AD%91%E5%9F%BA%E4%B8%8A%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/90995936f19e495394b06df771ebd096~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Web å¿…å¤‡çš„å¼€å‘å·¥å…·ï¼šVS Code + Chrome æµè§ˆå™¨ï¼Œä»‹ç»äº†å¾ˆå¤šéå¸¸å¥½ç”¨çš„æ’ä»¶å’Œå¿«æ·é”®ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹å»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7158479477717073934">Web ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šWeb å¼€å‘å·¥å…·ä»‹ç»</a> ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç» Web åŸºç¡€ä¸‰ä»¶å¥—ä¸­çš„ CSS</p><h2 id="ä¸€ã€CSS-åŸºç¡€è¯­æ³•"><a href="#ä¸€ã€CSS-åŸºç¡€è¯­æ³•" class="headerlink" title="ä¸€ã€CSS åŸºç¡€è¯­æ³•"></a>ä¸€ã€CSS åŸºç¡€è¯­æ³•</h2><p>CSS å…¨ç§° Cascading Style Sheets ï¼Œä¸­æ–‡ç¿»è¯‘ï¼šå±‚å æ ·å¼è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è£…é¥° HTML é¡µé¢ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šHTML å°±å¥½æ¯”ä½ çš„èº«ä½“ï¼Œä½†æ˜¯è¿˜æ²¡ç©¿è¡£æœğŸ˜‚ï¼ŒCSS å°±æ˜¯ç»™ä½ æ­é…ä¸€å¥—è±ªåç‚«é…·å¼ç‚¸å¤©çš„è¡£æœï¼Œè®©ä½ å˜å¾—å¾ˆæ¼‚äº®ã€‚</p><h3 id="1-1ã€CSS-è¯­æ³•è§„åˆ™"><a href="#1-1ã€CSS-è¯­æ³•è§„åˆ™" class="headerlink" title="1.1ã€CSS è¯­æ³•è§„åˆ™"></a>1.1ã€CSS è¯­æ³•è§„åˆ™</h3><p>CSS ä¸»è¦ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š</p><blockquote><p>1ã€é€‰æ‹©å™¨</p><p>2ã€ä¸€å¯¹å¤§æ‹¬å·ï¼š<code>&#123;&#125;</code></p><p>3ã€ä¸€æ¡æˆ–å¤šæ¡å£°æ˜</p></blockquote><p>ç¤ºä¾‹ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34901e0725c34f579cfb7c78c9604177~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026154840868.png" width="100%" /><p>1ã€é€‰æ‹©å™¨é€šå¸¸æ˜¯ä½ è¦æ”¹å˜æ ·å¼çš„ HTML æ ‡ç­¾</p><p>2ã€æ¯æ¡å£°æ˜ç”±<code>å±æ€§ï¼Œå†’å·ï¼Œå±æ€§å€¼ï¼Œåˆ†å·</code> 4 éƒ¨åˆ†ç»„æˆ</p><p>3ã€ä¸ºäº†å¢å¼º CSS å¯è¯»æ€§ï¼Œå»ºè®®æ¯è¡Œåªæè¿°ä¸€ä¸ªå£°æ˜ï¼Œè¡Œå†…æ ·å¼è¡¨é™¤å¤–</p><p>å¦å¤–éœ€è¦<strong>æ³¨æ„</strong>ï¼š</p><p>åœ¨ CSS å†…çš„æ³¨é‡Šä»¥<code>/*</code>å¼€å§‹ï¼Œä»¥<code>*/</code>ç»“æŸï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/* æ³¨é‡Š */</span><br><span class="hljs-selector-tag">h1</span>&#123;<br>    <span class="hljs-comment">/* å­—ä½“é¢œè‰²ï¼šç²‰è‰² å­—ä½“å¤§å°ï¼š40px */</span><br>    <span class="hljs-attribute">color</span>: pink;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">40px</span>;<br> &#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€CSS-å¼•å…¥æ–¹å¼"><a href="#äºŒã€CSS-å¼•å…¥æ–¹å¼" class="headerlink" title="äºŒã€CSS å¼•å…¥æ–¹å¼"></a>äºŒã€CSS å¼•å…¥æ–¹å¼</h2><p>CSS å¼•å…¥æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§ï¼š</p><blockquote><p>1ã€å†…éƒ¨æ ·å¼è¡¨</p><p>2ã€å¤–éƒ¨æ ·å¼è¡¨</p><p>3ã€è¡Œå†…æ ·å¼è¡¨</p></blockquote><h3 id="2-1ã€å†…éƒ¨æ ·å¼è¡¨"><a href="#2-1ã€å†…éƒ¨æ ·å¼è¡¨" class="headerlink" title="2.1ã€å†…éƒ¨æ ·å¼è¡¨"></a>2.1ã€å†…éƒ¨æ ·å¼è¡¨</h3><p>å†…éƒ¨æ ·å¼è¡¨å°±æ˜¯åœ¨ä¸€ä¸ª html æ–‡ä»¶å†…éƒ¨ä½¿ç”¨ CSS</p><h4 id="2-1-1ã€å†…éƒ¨æ ·å¼è¡¨ä½¿ç”¨"><a href="#2-1-1ã€å†…éƒ¨æ ·å¼è¡¨ä½¿ç”¨" class="headerlink" title="2.1.1ã€å†…éƒ¨æ ·å¼è¡¨ä½¿ç”¨"></a>2.1.1ã€å†…éƒ¨æ ·å¼è¡¨ä½¿ç”¨</h4><p>1ã€åœ¨ head æ ‡ç­¾å†…éƒ¨å®šä¹‰ style æ ‡ç­¾ï¼Œç„¶ååœ¨ style æ ‡ç­¾å†…éƒ¨å®šä¹‰ CSS å³å¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰å†…éƒ¨æ ·å¼è¡¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* ç»™ h1 å®šä¹‰ CSS æ ·å¼ */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">h1</span>&#123;</span><br><span class="language-css">            <span class="hljs-comment">/* å­—ä½“é¢œè‰²ï¼šç²‰è‰² å­—ä½“å¤§å°ï¼š40px */</span></span><br><span class="language-css">            <span class="hljs-attribute">color</span>: pink;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b0babcd6c1344c1dacc97cff4013dac2~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026172633783.png" width="100%" /><h3 id="2-2ã€å¤–éƒ¨æ ·å¼è¡¨"><a href="#2-2ã€å¤–éƒ¨æ ·å¼è¡¨" class="headerlink" title="2.2ã€å¤–éƒ¨æ ·å¼è¡¨"></a>2.2ã€å¤–éƒ¨æ ·å¼è¡¨</h3><p>å¤–éƒ¨æ ·å¼è¡¨å°±æ˜¯åœ¨ html æ–‡ä»¶å¤–éƒ¨å®šä¹‰ä¸€ä¸ª<code>.css</code>åç¼€çš„æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ link æ ‡ç­¾é“¾æ¥è¯¥ css æ–‡ä»¶</p><h4 id="2-2-1ã€å¤–éƒ¨æ ·å¼è¡¨ä½¿ç”¨"><a href="#2-2-1ã€å¤–éƒ¨æ ·å¼è¡¨ä½¿ç”¨" class="headerlink" title="2.2.1ã€å¤–éƒ¨æ ·å¼è¡¨ä½¿ç”¨"></a>2.2.1ã€å¤–éƒ¨æ ·å¼è¡¨ä½¿ç”¨</h4><p>1ã€åœ¨å¤–éƒ¨å®šä¹‰ä¸€ä¸ª<code>.css</code>çš„æ–‡ä»¶</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/19029b319624486c9d4883b4dc98a2b0~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026161548418.png" width="100%" /><p>2ã€åœ¨ head æ ‡ç­¾å†…éƒ¨å®šä¹‰ link æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ link æ ‡ç­¾é“¾æ¥è¯¥ css æ–‡ä»¶å³å¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ–¹å¼ä¸€ï¼šä½¿ç”¨ link æ ‡ç­¾å¼•ç”¨å¤–éƒ¨æ ·å¼è¡¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;css/index.css&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ–¹å¼äºŒï¼šé€šè¿‡ import å¼•ç”¨</span><br><span class="hljs-comment">        import æ˜¯ css æä¾›çš„æ–¹å¼ï¼Œå‡ºæ¥çš„æ™šï¼Œå…¼å®¹æ€§å·®ï¼Œå®ƒçš„æ¸²æŸ“æ—¶æœºæ˜¯åœ¨ html åŠ è½½ååœ¨è¢«æ¸²æŸ“</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-comment">&lt;!-- &lt;style&gt;</span><br><span class="hljs-comment">        @import url(&quot;css/index.css&quot;);</span><br><span class="hljs-comment">    &lt;/style&gt; --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢è®²äº†ä¸¤ç§å¼•ç”¨å¤–éƒ¨æ ·å¼è¡¨çš„æ–¹å¼ï¼Œå»ºè®®ä½¿ç”¨æ–¹å¼ä¸€</p><h3 id="2-3ã€è¡Œå†…æ ·å¼è¡¨"><a href="#2-3ã€è¡Œå†…æ ·å¼è¡¨" class="headerlink" title="2.3ã€è¡Œå†…æ ·å¼è¡¨"></a>2.3ã€è¡Œå†…æ ·å¼è¡¨</h3><p>è¡Œå†…æ ·å¼è¡¨å°±æ˜¯åœ¨æ ‡ç­¾å†…éƒ¨ä½¿ç”¨ CSS</p><h4 id="2-3-1ã€è¡Œå†…æ ·å¼è¡¨ä½¿ç”¨"><a href="#2-3-1ã€è¡Œå†…æ ·å¼è¡¨ä½¿ç”¨" class="headerlink" title="2.3.1ã€è¡Œå†…æ ·å¼è¡¨ä½¿ç”¨"></a>2.3.1ã€è¡Œå†…æ ·å¼è¡¨ä½¿ç”¨</h4><p>ç›´æ¥åœ¨æ ‡ç­¾å†…éƒ¨çš„ style å±æ€§ä¸­å®šä¹‰ CSS æ ·å¼å³å¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- åœ¨æ ‡ç­¾å†…éƒ¨ä½¿ç”¨ CSS --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink; font-size: 40px;&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>Tips</strong>ï¼š</p><p>1ã€å½“æˆ‘ä»¬åªéœ€è¦åœ¨å•ä¸ª html æ–‡ä»¶é‡Œé¢ä½¿ç”¨ CSS æ—¶ï¼Œä½¿ç”¨å†…éƒ¨æ ·å¼è¡¨</p><p>2ã€å½“å¤šä¸ª html æ–‡ä»¶å…·æœ‰ç›¸åŒçš„ CSS æ ·å¼æ—¶ï¼Œä¸ºäº†ç»Ÿä¸€å’Œç»´æŠ¤ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨å¤–éƒ¨æ ·å¼è¡¨</p><p>3ã€å½“æˆ‘ä»¬åªéœ€è¦åœ¨ä¸€ä¸ªæ ‡ç­¾ä¸Šä½¿ç”¨  CSS æ ·å¼æ—¶ï¼Œä½¿ç”¨è¡Œå†…æ ·å¼è¡¨</p><p>å› æ­¤å¤§å®¶éœ€è¦æ ¹æ®è‡ªå·±çš„åˆ¤æ–­ï¼Œé€‰æ‹©åˆé€‚çš„æ ·å¼è¡¨</p><p>æ¥ä¸‹æ¥æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘åœ¨ä¸€ä¸ª html æ–‡ä»¶é‡Œé¢åŒæ—¶å¼•ç”¨äº†ä¸Šé¢ä¸‰ç§ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿ</p><p>è¿™é‡Œå°±æ¶‰åŠåˆ°äº†æ ·å¼è¡¨çš„ä¼˜å…ˆçº§ï¼Œæ¥ç€å¾€ä¸‹çœ‹</p><h3 id="2-4ã€æ ·å¼è¡¨ä¼˜å…ˆçº§"><a href="#2-4ã€æ ·å¼è¡¨ä¼˜å…ˆçº§" class="headerlink" title="2.4ã€æ ·å¼è¡¨ä¼˜å…ˆçº§"></a>2.4ã€æ ·å¼è¡¨ä¼˜å…ˆçº§</h3><p>æˆ‘ä»¬é€šè¿‡ç»“è®ºçš„æ–¹å¼æ¥è®ºè¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å¤–éƒ¨æ ·å¼è¡¨ï¼Œè¿˜æ˜¯ä¹‹å‰é‚£ä¸ªæ–‡ä»¶ï¼šç²‰è‰² å­—ä½“ 40px --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;css/index.css&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å†…éƒ¨æ ·å¼è¡¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">      <span class="hljs-comment">/* è“è‰²ï¼Œå­—ä½“ 40px */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">h1</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: blue;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- è¡Œå†…æ ·å¼è¡¨ï¼šç»¿è‰²ï¼Œå­—ä½“ 40px--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: green; font-size: 40px;&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9df926c8e7264fadb3ec84c983f1e6d8~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026172610437.png" width="100%" /><p>ğŸ˜¯ï¼Œå±•ç¤ºäº†<strong>ç»¿è‰²</strong>ï¼Œè¯´æ˜è¡Œå†…æ ·å¼è¡¨çš„ä¼˜å…ˆçº§æœ€é«˜</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠè¡Œå†…æ ·å¼è¡¨ç»™å»æ‰ï¼Œé‡æ–°è¿è¡Œï¼Œä½ ä¼šå‘ç°å±•ç¤ºäº†<strong>è“è‰²</strong>ï¼Œè¯´æ˜è¡Œå†…æ ·å¼è¡¨çš„ä¼˜å…ˆçº§æ¬¡é«˜ï¼Œæœ€åæ‰æ˜¯å¤–éƒ¨æ ·å¼è¡¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¼˜å…ˆçº§çš„ç»“è®ºï¼š<strong>è¡Œå†…æ ·å¼è¡¨ &gt; å†…éƒ¨æ ·å¼è¡¨ &gt; å¤–éƒ¨æ ·å¼è¡¨</strong></p><h3 id="2-5ã€-important-è§„åˆ™"><a href="#2-5ã€-important-è§„åˆ™" class="headerlink" title="2.5ã€!important è§„åˆ™"></a>2.5ã€<code>!important</code> è§„åˆ™</h3><p>ä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ğŸ˜„ï¼šä½¿ç”¨äº† <code>!important</code>å±æ€§çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œäº«å— Vip å¾…é‡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å¤–éƒ¨æ ·å¼è¡¨ï¼Œè¿˜æ˜¯ä¹‹å‰é‚£ä¸ªæ–‡ä»¶ï¼šç²‰è‰² å­—ä½“ 40px --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;css/index.css&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å†…éƒ¨æ ·å¼è¡¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">      <span class="hljs-comment">/* è“è‰²ï¼Œå­—ä½“ 40px */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">h1</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: blue <span class="hljs-meta">!important</span>;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- è¡Œå†…æ ·å¼è¡¨ï¼šç»¿è‰²ï¼Œå­—ä½“ 40px--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: green; font-size: 40px;&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨å†…éƒ¨æ ·å¼è¡¨çš„ color å±æ€§ä¸­åŠ äº†ä¸€ä¸ª<code>!import</code>ä¿®é¥°ï¼Œæ­¤æ—¶å°±ä¼šä¼˜å…ˆä½¿ç”¨å†…éƒ¨æ ·å¼è¡¨çš„ color å±æ€§</p><p><strong>éœ€è¦é‡ç‚¹è¯´æ˜çš„æ˜¯</strong>ï¼š</p><p>1ã€ä½¿ç”¨<code>!important</code>æ˜¯ä¸€ä¸ªåä¹ æƒ¯ï¼Œåº”è¯¥å°½é‡é¿å…ï¼Œå› ä¸ºè¿™ç ´åäº†æ ·å¼è¡¨ä¸­çš„å›ºæœ‰çš„çº§è”è§„åˆ™ ä½¿å¾—è°ƒè¯•æ‰¾ bug å˜å¾—æ›´åŠ å›°éš¾äº†</p><p>2ã€å½“ä¸¤æ¡ç›¸äº’å†²çªçš„å¸¦æœ‰<code>!important</code>è§„åˆ™çš„å£°æ˜è¢«åº”ç”¨åˆ°ç›¸åŒçš„å…ƒç´ ä¸Šæ—¶ï¼Œæ‹¥æœ‰æ›´å¤§ä¼˜å…ˆçº§çš„å£°æ˜å°†ä¼šè¢«é‡‡ç”¨</p><p><strong>ä½¿ç”¨å»ºè®®</strong>ï¼š</p><p>1ã€<strong>ä¸€å®š</strong>è¦ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ ·å¼è§„åˆ™çš„ä¼˜å…ˆçº§æ¥è§£å†³é—®é¢˜è€Œä¸æ˜¯ <code>!important</code></p><p>2ã€<strong>åªæœ‰</strong>åœ¨éœ€è¦è¦†ç›–å…¨ç«™æˆ–å¤–éƒ¨ CSS çš„ç‰¹å®šé¡µé¢ä¸­ä½¿ç”¨ <code>!important</code></p><p>3ã€<strong>æ°¸è¿œä¸è¦</strong>åœ¨ä½ çš„æ’ä»¶ä¸­ä½¿ç”¨ <code>!important</code></p><p>4ã€<strong>æ°¸è¿œä¸è¦</strong>åœ¨å…¨ç«™èŒƒå›´çš„ CSS ä»£ç ä¸­ä½¿ç”¨ <code>!important</code></p><h2 id="ä¸‰ã€CSS-é€‰æ‹©å™¨"><a href="#ä¸‰ã€CSS-é€‰æ‹©å™¨" class="headerlink" title="ä¸‰ã€CSS é€‰æ‹©å™¨"></a>ä¸‰ã€CSS é€‰æ‹©å™¨</h2><p>CSS é€‰æ‹©å™¨è§„å®šäº† CSS æ ·å¼ä¼šè¢«åº”ç”¨åˆ°å“ªäº›æ ‡ç­¾ä¸Š</p><h3 id="3-1ã€CSS-ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨"><a href="#3-1ã€CSS-ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨" class="headerlink" title="3.1ã€CSS ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨"></a>3.1ã€CSS ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨</h3><h4 id="3-1-1ã€id-é€‰æ‹©å™¨"><a href="#3-1-1ã€id-é€‰æ‹©å™¨" class="headerlink" title="3.1.1ã€id é€‰æ‹©å™¨"></a>3.1.1ã€id é€‰æ‹©å™¨</h4><p>id é€‰æ‹©å™¨å¯ä»¥ç»™æ ‡æœ‰ç‰¹å®š id å±æ€§çš„ html æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="id-é€‰æ‹©å™¨ä½¿ç”¨"><a href="#id-é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="id é€‰æ‹©å™¨ä½¿ç”¨"></a>id é€‰æ‹©å™¨ä½¿ç”¨</h5><p>é¦–å…ˆç»™ html æ ‡ç­¾è®¾ç½®ä¸€ä¸ª id çš„å±æ€§ï¼Œç„¶ååœ¨ CSS ä¸­é€šè¿‡ <code>#idå±æ€§çš„å€¼</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* 2ã€åœ¨ CSS ä¸­é€šè¿‡ #idå±æ€§çš„å€¼ æ¥æŒ‡å®šè¦æ¸²æŸ“çš„ html æ ‡ç­¾ */</span></span><br><span class="language-css">        <span class="hljs-selector-id">#params</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: orange;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 1ã€ç»™ p æ ‡ç­¾å®šä¹‰ä¸€ä¸ª id å±æ€§ï¼Œå€¼ä¸ºï¼šparams --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;params&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/767afc5a760c446c9c58f75d64dedf27~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026222037414.png" width="100%" /><h4 id="3-1-2ã€ç±»é€‰æ‹©å™¨"><a href="#3-1-2ã€ç±»é€‰æ‹©å™¨" class="headerlink" title="3.1.2ã€ç±»é€‰æ‹©å™¨"></a>3.1.2ã€ç±»é€‰æ‹©å™¨</h4><p>ç±»é€‰æ‹©å™¨å¯ä»¥ç»™æ ‡æœ‰ç‰¹å®š class å±æ€§çš„ html æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="ç±»é€‰æ‹©å™¨ä½¿ç”¨"><a href="#ç±»é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="ç±»é€‰æ‹©å™¨ä½¿ç”¨"></a>ç±»é€‰æ‹©å™¨ä½¿ç”¨</h5><p>é¦–å…ˆç»™ html æ ‡ç­¾è®¾ç½®ä¸€ä¸ª class å±æ€§ï¼Œç„¶ååœ¨ CSS ä¸­é€šè¿‡ <code>.classå±æ€§çš„å€¼</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* 2ã€åœ¨ CSS ä¸­é€šè¿‡ .classå±æ€§çš„å€¼ æ¥æŒ‡å®šè¦æ¸²æŸ“çš„ html æ ‡ç­¾ */</span></span><br><span class="language-css">        <span class="hljs-selector-class">.params</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 1ã€ç»™ p æ ‡ç­¾å®šä¹‰ class å±æ€§ï¼Œå€¼ä¸ºï¼šparams --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;params&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/822ba8ecac9540449b0874bd43e36bb6~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026222930379.png" width="100%" /><h4 id="3-1-3ã€å±æ€§é€‰æ‹©å™¨"><a href="#3-1-3ã€å±æ€§é€‰æ‹©å™¨" class="headerlink" title="3.1.3ã€å±æ€§é€‰æ‹©å™¨"></a>3.1.3ã€å±æ€§é€‰æ‹©å™¨</h4><p>å±æ€§é€‰æ‹©å™¨å¯ä»¥ç»™è®¾ç½®äº†è¯¥å±æ€§çš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="å±æ€§é€‰æ‹©å™¨ä½¿ç”¨"><a href="#å±æ€§é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="å±æ€§é€‰æ‹©å™¨ä½¿ç”¨"></a>å±æ€§é€‰æ‹©å™¨ä½¿ç”¨</h5><p>é¦–å…ˆæˆ‘ä»¬ç»™æ ‡ç­¾è®¾ç½®ä¸€äº›å±æ€§ï¼Œç„¶ååœ¨ CSS ä¸­é€šè¿‡ <code>æ ‡ç­¾å[å±æ€§å]</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚æœä¸å†™æ ‡ç­¾åï¼Œåˆ™è¡¨ç¤ºå¯¹æ‰€æœ‰è®¾ç½®äº†è¯¥å±æ€§çš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* 2ã€åœ¨ CSS ä¸­é€šè¿‡ [å±æ€§å] æ¥æŒ‡å®šè¦æ¸²æŸ“çš„ html æ ‡ç­¾ */</span></span><br><span class="language-css">        <span class="hljs-selector-attr">[title]</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: green;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 1ã€ç»™æ ‡ç­¾è®¾ç½®äº†ç›¸åŒçš„å±æ€§åï¼štitle --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;erdai666&quot;</span>&gt;</span>erdai666<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;ç™¾åº¦&quot;</span>&gt;</span>æ‰“å¼€ç™¾åº¦<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šè¿°å¦‚æœæˆ‘ä»¬è¿™ä¹ˆå†™ï¼š<code>h1[title]</code> æˆ–è€…è¿™ä¹ˆå†™ï¼š<code>[title=erdai666]</code>ï¼Œé‚£ä¹ˆä¸Šé¢å°±åªæœ‰ h1 æ ‡ç­¾ä¼šç”Ÿæ•ˆ</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70b424005016437990e2f8ca16482765~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026223737596.png" width="100%" /><h4 id="3-1-4ã€ä¼ªç±»é€‰æ‹©å™¨"><a href="#3-1-4ã€ä¼ªç±»é€‰æ‹©å™¨" class="headerlink" title="3.1.4ã€ä¼ªç±»é€‰æ‹©å™¨"></a>3.1.4ã€ä¼ªç±»é€‰æ‹©å™¨</h4><p>ä¼ªç±»é€‰æ‹©å™¨å¯ä»¥ç»™è§¦å‘äº†æŸç§è¡Œä¸ºçŠ¶æ€çš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="ä¼ªç±»é€‰æ‹©å™¨ä½¿ç”¨"><a href="#ä¼ªç±»é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="ä¼ªç±»é€‰æ‹©å™¨ä½¿ç”¨"></a>ä¼ªç±»é€‰æ‹©å™¨ä½¿ç”¨</h5><p>è¿™é‡Œä»¥ a æ ‡ç­¾ä¸ºä¾‹å­ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼š</p><blockquote><p>1ã€link ï¼šè¶…é“¾æ¥çš„åˆå§‹çŠ¶æ€</p><p>2ã€visited ï¼šè¶…é“¾æ¥è¢«è®¿é—®çš„çŠ¶æ€</p><p>3ã€hover ï¼šé¼ æ ‡æ‚¬åœï¼Œå³é¼ æ ‡åˆ’è¿‡è¶…é“¾æ¥æ—¶çš„çŠ¶æ€</p><p>4ã€active ï¼š é¼ æ ‡æŒ‰ä¸‹æ—¶è¶…é“¾æ¥çš„çŠ¶æ€</p></blockquote><p>åœ¨ CSS ä¸­é€šè¿‡ <code>æ ‡ç­¾åï¼šå±æ€§çŠ¶æ€</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 2ã€é¡ºåºå¿…é¡»ä¸º:  link--visited--hover--active --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:Link</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: yellow;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:visited</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: orange;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:active</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: green;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 1ã€ä¼ªç±»é€‰æ‹©å™¨ ä¸»è¦é’ˆå¯¹è¶…é“¾æ¥ a æ ‡ç­¾--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>&gt;</span>ç™¾åº¦<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œåï¼Œé€šè¿‡ä½ å¯¹è¯¥é“¾æ¥çš„æ“ä½œï¼Œå®ƒä¼šå±•ç¤ºå‡ºä¸åŒçš„é¢œè‰²</p><h4 id="3-1-5ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨"><a href="#3-1-5ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨" class="headerlink" title="3.1.5ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨"></a>3.1.5ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨</h4><p>ä¼ªå…ƒç´ é€‰æ‹©å™¨å¯ä»¥é€šè¿‡é™„åŠ æŒ‡å®šçš„å…³é”®è¯æ¥ç»™æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="ä¼ªå…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨"><a href="#ä¼ªå…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="ä¼ªå…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨"></a>ä¼ªå…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨</h5><p>å¦‚ä¸‹ç‰¹å®šè¯­æ³•ï¼š</p><p>1ã€<code>æ ‡ç­¾::first-line</code> ï¼šä¸ºæŸä¸€ä¸ªæ ‡ç­¾çš„ç¬¬ä¸€è¡Œä½¿ç”¨æ ·å¼</p><p>2ã€<code>æ ‡ç­¾::first-letter</code> ï¼šä¸ºæŸä¸€ä¸ªæ ‡ç­¾çš„é¦–å­—æ¯ä½¿ç”¨æ ·å¼</p><p>3ã€<code>æ ‡ç­¾::before</code> ï¼šåœ¨æŸä¸ªæ ‡ç­¾ä¹‹å‰æ’å…¥ä¸€äº›å†…å®¹</p><p>4ã€<code>æ ‡ç­¾::after</code> ï¼šåœ¨æŸä¸ªæ ‡ç­¾ä¹‹åæ’å…¥ä¸€äº›å†…å®¹</p><p>å®šä¹‰å¥½æ ‡ç­¾ï¼Œåœ¨ CSS ä¸­é€šè¿‡ä¸Šè¿°è¿™ç§æ–¹å¼å¼•ç”¨å³å¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">h1</span><span class="hljs-selector-pseudo">::first-line</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h2</span><span class="hljs-selector-pseudo">::first-letter</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: green;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h3</span><span class="hljs-selector-pseudo">::before</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;erdai666: &quot;</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h4</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot; :erdai777&quot;</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä½ å¯ä»¥ä½¿ç”¨ first-line ç»™è¿™ä¸€è¡Œè®¾ç½®æˆçº¢è‰²<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ä½ å¯ä»¥ä½¿ç”¨ first-letter ç»™è¿™ä¸€è¡Œé¦–å­—æ¯è®¾ç½®æˆç»¿è‰²<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä½ å¯ä»¥ä½¿ç”¨ before ç»™è¿™ä¸€è¡Œå‰é¢æ’å…¥ä¸€æ®µè¯<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>ä½ å¯ä»¥ä½¿ç”¨ after ç»™è¿™ä¸€è¡Œåé¢æ’å…¥ä¸€æ®µè¯<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a845bc0dc84f4b558217a88f20e5974e~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026231526910.png" width="100%" /><h4 id="3-1-6ã€æ ‡ç­¾é€‰æ‹©å™¨"><a href="#3-1-6ã€æ ‡ç­¾é€‰æ‹©å™¨" class="headerlink" title="3.1.6ã€æ ‡ç­¾é€‰æ‹©å™¨"></a>3.1.6ã€æ ‡ç­¾é€‰æ‹©å™¨</h4><p>æ ‡ç­¾é€‰æ‹©å™¨å¯ä»¥ç»™æŒ‡å®šçš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><p><strong>æ ‡ç­¾é€‰æ‹©å™¨ä½¿ç”¨</strong></p><p>é¦–å…ˆå®šä¹‰å¥½æ ‡ç­¾ï¼Œç„¶ååœ¨ CSS ä¸­é€šè¿‡<code>æ ‡ç­¾å</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">h1</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: orange;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h2</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h3</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: green;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">h4</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: blue;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä¸€çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>äºŒçº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä¸‰çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å››çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47fc20e52561430ea7003c29b864f846~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026232034677.png" width="100%" /><h4 id="3-1-7ã€é€šé…ç¬¦é€‰æ‹©å™¨"><a href="#3-1-7ã€é€šé…ç¬¦é€‰æ‹©å™¨" class="headerlink" title="3.1.7ã€é€šé…ç¬¦é€‰æ‹©å™¨"></a>3.1.7ã€é€šé…ç¬¦é€‰æ‹©å™¨</h4><p>é€šé…ç¬¦é€‰æ‹©å™¨å¯ä»¥ç»™æ‰€æœ‰çš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="é€šé…ç¬¦é€‰æ‹©å™¨ä½¿ç”¨"><a href="#é€šé…ç¬¦é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="é€šé…ç¬¦é€‰æ‹©å™¨ä½¿ç”¨"></a>é€šé…ç¬¦é€‰æ‹©å™¨ä½¿ç”¨</h5><p>é¦–å…ˆå®šä¹‰å‡ ä¸ªæ ‡ç­¾ï¼Œç„¶åé€šè¿‡<code>*</code>æ¥è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* æ¸…é™¤æ‰€æœ‰æ ‡ç­¾çš„å¤–è¾¹è·ï¼Œå…§è¾¹è· */</span></span><br><span class="language-css">        *&#123;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2222<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>3333<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b9030486fd7459fb5413bee1735303b~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026232357410.png" width="100%" /><h3 id="3-2ã€ç»„åˆé€‰æ‹©å™¨"><a href="#3-2ã€ç»„åˆé€‰æ‹©å™¨" class="headerlink" title="3.2ã€ç»„åˆé€‰æ‹©å™¨"></a>3.2ã€ç»„åˆé€‰æ‹©å™¨</h3><p>ç»„åˆé€‰æ‹©å™¨ä¸»è¦ç”±ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨ç»„åˆè€Œæˆ</p><h4 id="3-2-1ã€ç¾¤ç»„é€‰æ‹©å™¨"><a href="#3-2-1ã€ç¾¤ç»„é€‰æ‹©å™¨" class="headerlink" title="3.2.1ã€ç¾¤ç»„é€‰æ‹©å™¨"></a>3.2.1ã€ç¾¤ç»„é€‰æ‹©å™¨</h4><p>ç¾¤ç»„é€‰æ‹©å™¨å¯ä»¥å¯¹ä¸€ç»„åŸºç¡€é€‰æ‹©å™¨æŒ‡å®š CSS æ ·å¼</p><h5 id="ç¾¤ç»„é€‰æ‹©å™¨ä½¿ç”¨"><a href="#ç¾¤ç»„é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="ç¾¤ç»„é€‰æ‹©å™¨ä½¿ç”¨"></a>ç¾¤ç»„é€‰æ‹©å™¨ä½¿ç”¨</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* ç¾¤ç»„é€‰æ‹©å™¨ */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span>,<span class="hljs-selector-class">.boxp</span>,<span class="hljs-selector-tag">h1</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: yellow;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>1111111111<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;boxp&quot;</span>&gt;</span>9999999<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>3333333333<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b540e4d7e55c474da54a40b381131472~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026232918991.png" width="100%" /><h4 id="3-2-2ã€åä»£é€‰æ‹©å™¨"><a href="#3-2-2ã€åä»£é€‰æ‹©å™¨" class="headerlink" title="3.2.2ã€åä»£é€‰æ‹©å™¨"></a>3.2.2ã€åä»£é€‰æ‹©å™¨</h4><p>åä»£é€‰æ‹©å™¨å¯ä»¥å¯¹æŒ‡å®šçš„åä»£æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="åä»£é€‰æ‹©å™¨ä½¿ç”¨"><a href="#åä»£é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="åä»£é€‰æ‹©å™¨ä½¿ç”¨"></a>åä»£é€‰æ‹©å™¨ä½¿ç”¨</h5><p>è¯­æ³•è§„åˆ™ï¼š<code>æ ‡ç­¾ æ ‡ç­¾</code>ï¼Œæ ‡ç­¾ä¹‹é—´é€šè¿‡ç©ºæ ¼æ¥è¿›è¡ŒæŒ‡å®šï¼Œåä¸€ä¸ªæ ‡ç­¾æ˜¯å‰ä¸€ä¸ªæ ‡ç­¾çš„åä»£å…ƒç´ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* åä»£é€‰æ‹©å™¨ */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">span</span> <span class="hljs-selector-tag">p</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><br>   111111111<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>2222222222<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šè¿°åä»£é€‰æ‹©å™¨æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼š<code>div p</code>ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œæ„æ€å°±æ˜¯æ‰¾åˆ° div åä»£ä¸­æ‰€æœ‰çš„ p æ ‡ç­¾ï¼Œè€Œä¸è®º p æ ‡ç­¾åµŒå¥—çš„æœ‰å¤šæ·±</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/97c29e3b489e499abe18b8635a267ef1~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026233126017.png" width="100%" /><h4 id="3-2-3ã€å­å…ƒç´ é€‰æ‹©å™¨"><a href="#3-2-3ã€å­å…ƒç´ é€‰æ‹©å™¨" class="headerlink" title="3.2.3ã€å­å…ƒç´ é€‰æ‹©å™¨"></a>3.2.3ã€å­å…ƒç´ é€‰æ‹©å™¨</h4><p>å­å…ƒç´ é€‰æ‹©å™¨å¯ä»¥å¯¹æ ‡ç­¾çš„å­å…ƒç´ æŒ‡å®š CSS æ ·å¼</p><h5 id="å­å…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨"><a href="#å­å…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="å­å…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨"></a>å­å…ƒç´ é€‰æ‹©å™¨ä½¿ç”¨</h5><p>è¯­æ³•è§„åˆ™ï¼š<code>æ ‡ç­¾ &gt; æ ‡ç­¾</code>ï¼Œæ ‡ç­¾ä¹‹é—´é€šè¿‡ &gt; æ¥è¿›è¡ŒæŒ‡å®šï¼Œåä¸€ä¸ªæ ‡ç­¾æ˜¯å‰ä¸€ä¸ªæ ‡ç­¾çš„ç›´æ¥åä»£å…ƒç´ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* å­å…ƒç´ é€‰æ‹©å™¨ */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span> &gt; <span class="hljs-selector-tag">strong</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: red;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>66666<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>7777<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a31e8c8a63d54af9ba7d6f0df48c2cf0~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026234007491.png" width="100%" /><h4 id="3-2-4ã€ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨"><a href="#3-2-4ã€ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨" class="headerlink" title="3.2.4ã€ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨"></a>3.2.4ã€ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨</h4><p>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨å¯ä»¥ç»™å½“å‰æ ‡ç­¾ç›¸é‚»çš„æ ‡ç­¾æŒ‡å®š CSS æ ·å¼</p><h5 id="ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ä½¿ç”¨"><a href="#ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ä½¿ç”¨" class="headerlink" title="ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ä½¿ç”¨"></a>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ä½¿ç”¨</h5><p>è¯­æ³•è§„åˆ™ï¼š<code>æ ‡ç­¾ + æ ‡ç­¾</code>ï¼Œæ ‡ç­¾ä¹‹é—´é€šè¿‡ + æ¥è¿›è¡ŒæŒ‡å®šï¼Œåä¸€ä¸ªæ ‡ç­¾æ˜¯å‰ä¸€ä¸ªæ ‡ç­¾çš„ç›¸é‚»å…ƒç´ ï¼Œä¸”ä¸¤è€…éœ€è¦æœ‰ç›¸åŒçš„çˆ¶æ ‡ç­¾ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-comment">/* ç›¸é‚»é€‰æ‹©å™¨ */</span></span><br><span class="language-css">        <span class="hljs-selector-tag">li</span> + <span class="hljs-selector-tag">li</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5cae7ec6084e43c1a47d7714d0e6dd06~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221026234505823.png" width="100%" /><h3 id="3-3ã€é€‰æ‹©å™¨ä¼˜å…ˆçº§"><a href="#3-3ã€é€‰æ‹©å™¨ä¼˜å…ˆçº§" class="headerlink" title="3.3ã€é€‰æ‹©å™¨ä¼˜å…ˆçº§"></a>3.3ã€é€‰æ‹©å™¨ä¼˜å…ˆçº§</h3><p>ä¸Šé¢å­¦ä¹ äº†è¿™ä¹ˆå¤šé€‰æ‹©å™¨ï¼Œå¦‚æœåŒæ—¶ä½œç”¨äºä¸€ä¸ªæ ‡ç­¾ï¼Œè‚¯å®šä¼šäº§ç”Ÿä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œé‚£ä¹ˆé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ª<strong>æƒé‡</strong>çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªé€‰æ‹©å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªæƒé‡ï¼Œæƒé‡è¶Šå¤§ï¼Œä¼˜å…ˆçº§å°±è¶Šé«˜</p><h5 id="3-3-1ã€æƒé‡è®¡ç®—è§„åˆ™"><a href="#3-3-1ã€æƒé‡è®¡ç®—è§„åˆ™" class="headerlink" title="3.3.1ã€æƒé‡è®¡ç®—è§„åˆ™"></a>3.3.1ã€æƒé‡è®¡ç®—è§„åˆ™</h5><p>1ã€ç¬¬ä¸€ä¼˜å…ˆçº§ï¼š<code>!important</code>ä¼šè¦†ç›–é¡µé¢å†…ä»»ä½•ä½ç½®çš„å…ƒç´ æ ·å¼</p><p>2ã€è¡Œå†…æ ·å¼è¡¨ï¼Œå¦‚<code>style=&quot;color: green&quot;</code>ï¼Œæƒå€¼ä¸º<code>1000</code></p><p>3ã€id é€‰æ‹©å™¨ï¼Œå¦‚<code>#params</code>ï¼Œæƒå€¼ä¸º<code>0100</code></p><p>4ã€ç±»ã€ä¼ªç±»ã€å±æ€§é€‰æ‹©å™¨ï¼Œå¦‚<code>.foo, a:hover, h1[title]</code>ï¼Œæƒå€¼ä¸º<code>0010</code></p><p>5ã€æ ‡ç­¾ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼Œå¦‚<code>div::first-line</code>ï¼Œæƒå€¼ä¸º<code>0001</code></p><p>6ã€é€šé…ç¬¦ã€å­ç±»é€‰æ‹©å™¨ã€ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ï¼Œå¦‚<code>*, &gt;, +</code>ï¼Œæƒå€¼ä¸º<code>0000</code></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ª<strong>ä¼˜å…ˆçº§çš„ç»“è®º</strong>ï¼š</p><p><strong>!import &gt; è¡Œå†…æ ·å¼è¡¨ &gt; id é€‰æ‹©å™¨ &gt; ç±»é€‰æ‹©å™¨ &#x3D; ä¼ªç±»é€‰æ‹©å™¨ &#x3D; å±æ€§é€‰æ‹©å™¨ &gt; æ ‡ç­¾é€‰æ‹©å™¨ &#x3D; ä¼ªå…ƒç´ é€‰æ‹©å™¨ &gt; é€šé…ç¬¦é€‰æ‹©å™¨ &#x3D; å­ç±»é€‰æ‹©å™¨ &#x3D; ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨</strong></p><p>å¦å¤–éœ€è¦<strong>æ³¨æ„</strong>çš„æ˜¯ï¼š</p><p>1ã€æƒé‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½äºåé¢çš„æ ·å¼ä¼šè¦†ç›–å‰é¢çš„æ ·å¼</p><p>2ã€ç¾¤ç»„é€‰æ‹©å™¨æƒé‡ï¼šç»„å†…æ‰€æœ‰é€‰æ‹©å™¨æƒé‡ä¹‹å’Œ</p><p>3ã€åä»£é€‰æ‹©å™¨ï¼šæ‰€æœ‰é€‰æ‹©å™¨æƒé‡ä¹‹å’Œ</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€CSS çš„åŸºç¡€è¯­æ³•</p><p>2ã€CSS çš„ä¸‰ç§å¼•å…¥æ–¹å¼ï¼š</p><blockquote><p>1ã€å†…éƒ¨æ ·å¼è¡¨</p><p>2ã€å¤–éƒ¨æ ·å¼è¡¨</p><p>3ã€è¡Œå†…æ ·å¼è¡¨</p></blockquote><p>3ã€CSS çš„ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨ï¼Œä»¥åŠç”±ä¸ƒå¤§åŸºç¡€é€‰æ‹©å™¨ç»„åˆæˆçš„ç»„åˆé€‰æ‹©å™¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV17z4y1D7Yj/">bç«™webå…¥é—¨æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚ï¼ŒæåŠ›æ¨è</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>Web å¿«é€Ÿå…¥é—¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šWeb å¼€å‘å·¥å…·ä»‹ç»</title>
    <link href="/2022/10/24/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AWeb%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"/>
    <url>/2022/10/24/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AWeb%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1bf5c2229764e99b45835281a0afbda~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† HTML çš„åŸºç¡€è¯­æ³•ï¼Œå¸¸ç”¨æ ‡ç­¾å’Œå±æ€§ï¼Œæœ€åä½¿ç”¨å­¦ä¹ åˆ°çš„æ ‡ç­¾åšäº†ä¸€äº›ç»¼åˆæ¡ˆä¾‹ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹å»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7157713551786934302">Web ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šHTML å¸¸ç”¨æ ‡ç­¾å’Œå±æ€§</a> ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç» Web ä¸­çš„å¼€å‘å·¥å…·</p><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ï¼Œä¸€ä¸ªå¥½çš„å¼€å‘å·¥å…·èƒ½è®©æˆ‘ä»¬äº‹åŠåŠŸå€ï¼Œæå‡å¼€å‘æ•ˆç‡ï¼Œä¸‹é¢ä»‹ç»çš„è¿™äº›å·¥å…·ç®€ç›´ä¸è¦å¤ªå¥½ç”¨ï¼Œè®©ä½ æœ‰ä¸€ç§èƒ½ç¬é—´èµ·é£çš„æ„Ÿè§‰ğŸ˜„</p><h2 id="ä¸€ã€Web-ç¼–è¾‘å™¨ï¼šVS-Code"><a href="#ä¸€ã€Web-ç¼–è¾‘å™¨ï¼šVS-Code" class="headerlink" title="ä¸€ã€Web ç¼–è¾‘å™¨ï¼šVS Code"></a>ä¸€ã€Web ç¼–è¾‘å™¨ï¼šVS Code</h2><h3 id="1-1ã€VS-Code-ä»‹ç»"><a href="#1-1ã€VS-Code-ä»‹ç»" class="headerlink" title="1.1ã€VS Code ä»‹ç»"></a>1.1ã€VS Code ä»‹ç»</h3><p>1ã€VS Code å…¨ç§°ï¼š Visual Studio Code ï¼Œæ˜¯å¾®è½¯ä¸€æ¬¾å¼€æºçš„ã€å…è´¹çš„ã€è·¨å¹³å°çš„ã€é«˜æ€§èƒ½çš„ã€è½»é‡çº§çš„ä»£ç ç¼–è¾‘å™¨ï¼ŒåŠŸèƒ½éå¸¸çš„å¼ºå¤§ï¼Œæ˜¯å¼€å‘ Web çš„ç¥å…µåˆ©å™¨ã€‚å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å®ƒè¿›è¡Œ Markdown åˆ›ä½œï¼Œæ–‡æœ¬ç¼–è¾‘ç­‰ç­‰</p><p>2ã€VS Code çš„å®šä½æ˜¯<strong>ç¼–è¾‘å™¨</strong>ï¼Œæ³¨æ„æ˜¯ç¼–è¾‘å™¨ï¼Œå®ƒä¸æ˜¯ IDEï¼ˆIntegrated Development Environmentï¼Œé›†æˆå¼€å‘ç¯å¢ƒï¼‰ ï¼ŒIDE ç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒé‡é‡çº§çš„ï¼Œæ¯”å¦‚ï¼šAndroidStudioï¼ŒWebstormï¼ˆè¿™ä¸¤æ¬¾éƒ½æ˜¯åŸºäº IntelliJ IDEA å®šåˆ¶çš„ï¼‰ï¼Œæ€§èƒ½ä¸å¥½çš„ç”µè„‘ä½¿ç”¨èµ·æ¥ä¼šå¾ˆå¡ï¼Œä½†æ˜¯ VS Code å°±ä¸ä¼šï¼Œå› ä¸ºå®ƒéå¸¸çš„è½»å·§ï¼Œè€Œä¸”å®ƒè¿˜èƒ½ç»™ä½ å¸¦æ¥æ‹¥æœ‰ IDE çš„å¼€å‘ä½“éªŒï¼Œçˆ±äº†</p><p>3ã€VS Code æ‹¥æœ‰åŠŸèƒ½å¼ºå¤§ï¼Œç”Ÿæ€å®Œå–„çš„æ’ä»¶ç³»ç»Ÿï¼Œä¸€äº› IDE ä¸Šæ²¡æœ‰çš„æ’ä»¶å®ƒæœ‰ï¼Œæˆ‘è§‰å¾—è¿™ä¸€ç‚¹æ˜¯å®ƒèƒ½å¤Ÿçˆ†ç«çš„é‡è¦åŸå› </p><p>4ã€VS Code è‡ªå¸¦ emmetï¼šæ”¯æŒä»£ç è‡ªåŠ¨è¡¥å…¨ï¼Œå¿«é€Ÿåœ°ç”Ÿæˆç®€å•çš„è¯­æ³•ç»“æ„ã€‚è¦çŸ¥é“ï¼Œè¿™ä¸ªåŠŸèƒ½åœ¨ Sublime Textä¸­ï¼Œå¾—å…ˆå®‰è£…æ’ä»¶æ‰è¡Œ</p><p>5ã€VS Code è‡ªå¸¦ HTMLï¼ŒCSSï¼ŒJavaScriptï¼ŒTypeScript å’Œ Node.js çš„è¯­æ³•æ”¯æŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åœ¨ä¹¦å†™è¿™äº›æ—¶ï¼Œæ˜¯è‡ªå¸¦æ™ºèƒ½æç¤ºçš„ã€‚å½“ç„¶ï¼Œå…¶ä»–çš„è¯­è¨€ï¼Œä½ å¯ä»¥å®‰è£…ç›¸åº”çš„<strong>æ‰©å±•åŒ…</strong>æ’ä»¶ï¼Œä¹Ÿä¼šæœ‰æ™ºèƒ½æç¤º</p><p>6ã€VS code è·¨å¹³å°æ”¯æŒï¼Œä½ å¯ä»¥åœ¨ MacOSï¼ŒWindows å’Œ Linux ç­‰å¤šä¸ªå¹³å°ä½¿ç”¨å®ƒ</p><p>è¿™ä¹ˆå¥½ç”¨çš„ä¸€æ¬¾ç¼–è¾‘å™¨ï¼Œè®©æˆ‘ä»¬èµ¶ç´§æ¥ä½¿ç”¨å®ƒå§</p><h3 id="1-2ã€VS-Code-å®‰è£…"><a href="#1-2ã€VS-Code-å®‰è£…" class="headerlink" title="1.2ã€VS Code å®‰è£…"></a>1.2ã€VS Code å®‰è£…</h3><p>ä¸‹è½½é“¾æ¥ï¼š<a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p><p>æ‰“å¼€ä¸‹è½½é“¾æ¥å¦‚ä¸‹å›¾ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54ae0143220e4c6a821a745fbdb4328f~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221024192258131.png" width="100%" /><p>VS Code çš„å®‰è£…å¾ˆç®€å•ï¼Œä¸‹è½½å‹ç¼©åŒ…åï¼Œè§£å‹ä½ ä¼šå‘ç°å°± VS Code è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€å°±èƒ½ç”¨ï¼Œå“ˆå“ˆï¼Œç›¸æ¯” IDE çš„å®‰è£…è¿‡ç¨‹çœŸçš„æ˜¯å¼‚å¸¸ç®€å•ã€‚å‰é¢ä¹Ÿè¯´äº† VS code  è‡ªå¸¦ HTMLï¼ŒCSSï¼ŒJavaScriptï¼ŒTypeScript å’Œ Node.js çš„è¯­æ³•æ”¯æŒï¼Œå› æ­¤ä½ ç°åœ¨å¯ä»¥ç›´æ¥è¿›è¡Œ Web å¼€å‘äº†ã€‚</p><h3 id="1-3ã€VS-Code-å¸¸ç”¨å¿«æ·é”®"><a href="#1-3ã€VS-Code-å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="1.3ã€VS Code å¸¸ç”¨å¿«æ·é”®"></a>1.3ã€VS Code å¸¸ç”¨å¿«æ·é”®</h3><p>å¯¹å¿«æ·é”®çš„ä½¿ç”¨åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½çœ‹å‡ºä½ æ˜¯å¦ç†Ÿæ‚‰è¿™æ¬¾ç¼–è¾‘å™¨æˆ– IDEã€‚ä¸‹é¢æ˜¯æˆ‘åœ¨å­¦ä¹ å®è·µè¿‡ç¨‹ä¸­è§‰å¾—éå¸¸å®ç”¨çš„ä¸€äº›å¿«æ·é”®</p><table><thead><tr><th>Mac å¿«æ·é”®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>Cmd + Shift + P</td><td>æ˜¾ç¤ºå‘½ä»¤é¢æ¿</td></tr><tr><td>Cmd + B</td><td>æ˜¾ç¤º&#x2F;éšè—ä¾§è¾¹æ </td></tr><tr><td>Cmd + J</td><td>æ˜¾ç¤º&#x2F;éšè—æ§åˆ¶å°</td></tr><tr><td>Cmd + \</td><td>æ–°å¼€ä¸€ä¸ªç¼–è¾‘å™¨</td></tr><tr><td>Cmd + 1ã€2</td><td>åˆ‡æ¢ 1ã€2 ç¼–è¾‘å™¨</td></tr><tr><td>Cmd + N</td><td>æ–°å»ºä¸€ä¸ªæ–‡ä»¶</td></tr><tr><td>Cmd + Shift + N</td><td>æ–°å¼€ä¸€ä¸ª VS Code</td></tr><tr><td>Cmd + W</td><td>å…³é—­å½“å‰æ–‡ä»¶</td></tr><tr><td>Cmd + +</td><td>æ”¾å¤§å·¥ä½œåŒºï¼ˆåŒ…æ‹¬ä»£ç å­—ä½“ï¼Œå·¦ä¾§å¯¼èˆªæ ï¼‰</td></tr><tr><td>Cmd + -</td><td>ç¼©å°å·¥ä½œåŒºï¼ˆåŒ…æ‹¬ä»£ç å­—ä½“ï¼Œå·¦ä¾§å¯¼èˆªæ ï¼‰</td></tr><tr><td>Cmd + Option + å·¦å³æ–¹å‘é”®</td><td>åœ¨å¤šä¸ªæ–‡ä»¶ä¹‹é—´åˆ‡æ¢</td></tr><tr><td>Option +  å·¦å³æ–¹å‘é”®</td><td>åœ¨å•è¯ä¹‹é—´ç§»åŠ¨å…‰æ ‡</td></tr><tr><td>Cmd +  å·¦å³æ–¹å‘é”®</td><td>åœ¨æ•´è¡Œä¹‹é—´ç§»åŠ¨å…‰æ ‡</td></tr><tr><td>Option + Shift +  å·¦å³æ–¹å‘é”®</td><td>åœ¨å•è¯ä¹‹é—´ç§»åŠ¨å…‰æ ‡å¹¶å¤åˆ¶</td></tr><tr><td>Cmd + Shift +  å·¦å³æ–¹å‘é”®</td><td>åœ¨æ•´è¡Œä¹‹é—´ç§»åŠ¨å…‰æ ‡å¹¶å¤åˆ¶</td></tr><tr><td>Cmd + Enter</td><td>åœ¨å½“å‰è¡Œä¸‹æ–¹æ–°å¢ä¸€è¡Œ</td></tr><tr><td>Cmd + Shift + Enter</td><td>åœ¨å½“å‰è¡Œä¸Šæ–¹æ–°å¢ä¸€è¡Œ</td></tr><tr><td>Option + ä¸Š&#x2F;ä¸‹æ–¹å‘é”®</td><td>å°†ä»£ç å‘ä¸Š&#x2F;ä¸‹ç§»åŠ¨</td></tr><tr><td>Option + Shift + ä¸Š&#x2F;ä¸‹æ–¹å‘é”®</td><td>å°†ä»£ç å‘ä¸Š&#x2F;ä¸‹å¤åˆ¶ä¸€è¡Œ</td></tr><tr><td>Cmd + Shift + Backspace</td><td>åˆ é™¤å…‰æ ‡ä¹‹å‰çš„æ•´è¡Œå†…å®¹</td></tr><tr><td>Cmd + &#x2F;</td><td>æ·»åŠ æ³¨é‡Š</td></tr><tr><td>Option + Shift + F</td><td>ä»£ç æ ¼å¼åŒ–</td></tr><tr><td>Cmd + Shift + F</td><td>å…¨å±€æœç´¢ä»£ç </td></tr><tr><td>Cmd + F</td><td>å½“å‰æ–‡ä»¶å†…æœç´¢</td></tr></tbody></table><p>å¦å¤–ä¸€ä¸ªå¥½ç”¨çš„ç‚¹ï¼šå°†å…‰æ ‡ç‚¹å‡»åˆ°æŸä¸€è¡Œçš„ä»»æ„ä½ç½®ï¼Œé»˜è®¤å°±æ˜¯é€‰ä¸­æ•´è¡Œï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥å¤åˆ¶æˆ–å‰ªåˆ‡</p><h3 id="1-4ã€VS-Code-å¸¸è§å¿«æ·æ“ä½œ"><a href="#1-4ã€VS-Code-å¸¸è§å¿«æ·æ“ä½œ" class="headerlink" title="1.4ã€VS Code å¸¸è§å¿«æ·æ“ä½œ"></a>1.4ã€VS Code å¸¸è§å¿«æ·æ“ä½œ</h3><h4 id="1-4-1ã€è¾“å…¥-æˆ–-html-5-ç”Ÿæˆ-HTML-éª¨æ¶"><a href="#1-4-1ã€è¾“å…¥-æˆ–-html-5-ç”Ÿæˆ-HTML-éª¨æ¶" class="headerlink" title="1.4.1ã€è¾“å…¥ ! æˆ– html:5 ç”Ÿæˆ HTML éª¨æ¶"></a>1.4.1ã€è¾“å…¥ <code>!</code> æˆ– <code>html:5</code> ç”Ÿæˆ HTML éª¨æ¶</h4><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6791b139377d47a980e1abd0e7a8d760~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="100%" /><h4 id="1-4-2ã€ä½¿ç”¨-code-å‘½ä»¤å¯åŠ¨-VS-Code"><a href="#1-4-2ã€ä½¿ç”¨-code-å‘½ä»¤å¯åŠ¨-VS-Code" class="headerlink" title="1.4.2ã€ä½¿ç”¨ code å‘½ä»¤å¯åŠ¨ VS Code"></a>1.4.2ã€ä½¿ç”¨ code å‘½ä»¤å¯åŠ¨ VS Code</h4><p>1ã€ä½¿ç”¨å¿«æ·é”® <code>Cmd + Shift + P</code>æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥ code ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09c411934064413d90334f4707f25641~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025170748336.png" width="50%" /><p>é€‰æ‹©ç¬¬ä¸€é¡¹ï¼šInstall â€˜codeâ€™ command in PATH ï¼Œè¿™æ · code å‘½ä»¤å°±è¢«æ·»åŠ åˆ°äº†ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨ code å‘½ä»¤äº†</p><p>2ã€code å‘½ä»¤ä½¿ç”¨</p><blockquote><p>1ã€åœ¨ Terminal è¾“å…¥ <code>code</code> å³å¯å¯åŠ¨ VS Code</p><p>2ã€åœ¨ Terminal è¾“å…¥ <code>code pathName/fileName</code>å³å¯é€šè¿‡ VS Code æ‰“å¼€æŒ‡å®šç›®å½•&#x2F;æŒ‡å®šæ–‡ä»¶</p></blockquote><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/072b16b67ecd41f88f438c8249497a24~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (1).gif" width="100%" /><h3 id="1-5ã€VS-Code-å¸¸è§é…ç½®"><a href="#1-5ã€VS-Code-å¸¸è§é…ç½®" class="headerlink" title="1.5ã€VS Code å¸¸è§é…ç½®"></a>1.5ã€VS Code å¸¸è§é…ç½®</h3><h4 id="1-5-1ã€git-ç‰ˆæœ¬ç®¡ç†"><a href="#1-5-1ã€git-ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="1.5.1ã€git ç‰ˆæœ¬ç®¡ç†"></a>1.5.1ã€git ç‰ˆæœ¬ç®¡ç†</h4><p>VS Code è‡ªå¸¦äº† Git ç‰ˆæœ¬ç®¡ç†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cee62d8059574ee8b79886b2cc1ece29~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025191932575.png" width="50%" /><p>æ­¤æ—¶åœ¨é…åˆ <code>Gitlens</code>æ’ä»¶ï¼Œç›´æ¥èµ·é£</p><h4 id="1-5-2ã€Emmet-in-VS-Code"><a href="#1-5-2ã€Emmet-in-VS-Code" class="headerlink" title="1.5.2ã€Emmet in VS Code"></a>1.5.2ã€Emmet in VS Code</h4><p>Emmet èƒ½è¾…åŠ©æˆ‘ä»¬å¿«é€Ÿçš„å»ç”Ÿæˆä¸€äº›è¯­æ³•ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦å®ç°å¦‚ä¸‹çš„æœ‰åºåˆ—è¡¨ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€è¦åœ¨ VS Code ä¸­è¾“å…¥ <code>ol&gt;li&#123;111&#125;*6</code>å³å¯è‡ªåŠ¨ç”Ÿæˆ</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/07ab9667f4c54d6f94546d69385f2983~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (2).gif" width="100%" /><h3 id="1-6ã€VS-Code-å¸¸ç”¨æ’ä»¶"><a href="#1-6ã€VS-Code-å¸¸ç”¨æ’ä»¶" class="headerlink" title="1.6ã€VS Code å¸¸ç”¨æ’ä»¶"></a>1.6ã€VS Code å¸¸ç”¨æ’ä»¶</h3><p>VS Code çš„æ’ä»¶ç®¡ç†å¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bebe391bfe3f47df8aa440115bb1eb6e~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025194519856.png" width="50%" /><p>åœ¨åº”ç”¨å•†åº—ä¸­æœç´¢ä½ è¦å®‰è£…çš„æ’ä»¶å®‰è£…å³å¯ï¼Œä¸‹é¢æ¨èæˆ‘è§‰å¾—éå¸¸å¥½ç”¨çš„æ’ä»¶ç»™ä½ ä»¬</p><h4 id="1-6-1ã€Chinese-Simplified-ç®€ä½“ä¸­æ–‡-Language-Pack-for-Visual-Studio-Code"><a href="#1-6-1ã€Chinese-Simplified-ç®€ä½“ä¸­æ–‡-Language-Pack-for-Visual-Studio-Code" class="headerlink" title="1.6.1ã€Chinese (Simplified) (ç®€ä½“ä¸­æ–‡) Language Pack for Visual Studio Code"></a>1.6.1ã€Chinese (Simplified) (ç®€ä½“ä¸­æ–‡) Language Pack for Visual Studio Code</h4><p>è®©ä½ çš„ VS Code æ˜¾ç¤ºä¸ºç®€ä½“ä¸­æ–‡è¯­è¨€</p><h4 id="1-6-2ã€Live-Server"><a href="#1-6-2ã€Live-Server" class="headerlink" title="1.6.2ã€Live Server"></a>1.6.2ã€Live Server</h4><p>åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä»£ç å†™å®Œåå¯å®ç°çƒ­æ›´æ–°ï¼Œå®æ—¶çš„åœ¨ç½‘é¡µä¸­çœ‹åˆ°è¿è¡Œæ•ˆæœï¼ŒçœŸçš„å¾ˆå¥½ç”¨</p><p>ä½¿ç”¨æ–¹å¼ï¼šå°†å†™å¥½çš„ä»£ç ï¼Œå³é”®é€‰æ‹© Open with Live Server ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼‰æ‰“å¼€å³å¯ï¼Œåç»­æ›´æ–°ä»£ç ä¿å­˜å³å¯é¢„è§ˆ</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/51d3f61a0008457b8383ae0fe8fd7ec0~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (3).gif" width="100%" /><h4 id="1-6-3ã€Auto-Rename-Tag"><a href="#1-6-3ã€Auto-Rename-Tag" class="headerlink" title="1.6.3ã€Auto Rename Tag"></a>1.6.3ã€Auto Rename Tag</h4><p>è‡ªåŠ¨å¯¹æ ‡ç­¾é‡å‘½å</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8314f422fcb54a57b923b158cb13139b~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (4).gif" width="100%" /><h4 id="1-6-4ã€htmltagwrap"><a href="#1-6-4ã€htmltagwrap" class="headerlink" title="1.6.4ã€htmltagwrap"></a>1.6.4ã€htmltagwrap</h4><p>å¿«é€Ÿçš„å¯¹ä¸€æ®µå†…å®¹è¿›è¡Œæ ‡ç­¾åŒ…è£¹</p><p>ä½¿ç”¨æ–¹å¼ï¼šé€‰æ‹©ä¸€æ®µå†…å®¹ï¼Œä½¿ç”¨å¿«æ·é”® <code>Option + W</code> ï¼Œå³å¯å®ç°æ ‡ç­¾åŒ…è£¹</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79716b5c59bc4810821355040a370d06~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (5).gif" width="100%" /><h4 id="1-6-5ã€Gitlens"><a href="#1-6-5ã€Gitlens" class="headerlink" title="1.6.5ã€Gitlens"></a>1.6.5ã€Gitlens</h4><p>å®ƒæ˜¯ VS Code ä¸­éå¸¸å¥½ç”¨çš„ Git ç®¡ç†æ’ä»¶ï¼Œç å†œå¿…å¤‡</p><p>GitLens åœ¨ Git ç®¡ç†ä¸Šæœ‰å¾ˆå¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p><blockquote><p>1ã€å°†å…‰æ ‡æ”¾ç½®åœ¨ä»£ç çš„å½“å‰è¡Œï¼Œå¯ä»¥çœ‹åˆ°è¿™æ ·ä»£ç çš„æäº¤è€…æ˜¯è°ï¼Œä»¥åŠæäº¤æ—¶é—´ã€‚è¿™ä¸€ç‚¹ï¼Œæ˜¯ GitLens æœ€ä¾¿æ·çš„åŠŸèƒ½ã€‚</p><p>2ã€æŸ¥çœ‹æŸä¸ª commit çš„ä»£ç æ”¹åŠ¨è®°å½•</p><p>3ã€æŸ¥çœ‹ä¸åŒçš„åˆ†æ”¯</p><p>4ã€å¯ä»¥å°†ä¸¤ä¸ª commit è¿›è¡Œä»£ç å¯¹æ¯”</p><p>5ã€ç”šè‡³å¯ä»¥å°†ä¸¤ä¸ª branch åˆ†æ”¯è¿›è¡Œæ•´ä½“çš„ä»£ç å¯¹æ¯”ã€‚è¿™ä¸€ç‚¹ï¼Œç®€ç›´æ˜¯ GitLens æœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚å½“æˆ‘ä»¬åœ¨ä¸åŒåˆ†æ”¯ review ä»£ç çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨åˆ°è¿™ä¸€æ‹›</p></blockquote><p>æ‰“å¼€ VS Code çš„ Git ç®¡ç†ï¼Œæœªå®‰è£… Gitlens æ—¶æ˜¯è¿™æ ·çš„ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13952e74e02c49e294c8d5960421c216~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025202301457.png" width="50%" /><p>å®‰è£…åæ˜¯è¿™æ ·çš„ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f0c9e3c4b7149a19e243da2edd4840b~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025202352760.png" width="50%" /><p>å¯ä»¥çœ‹åˆ°ä¸‹é¢å¤šäº†å¾ˆå¤šé€‰é¡¹ï¼Œè¿™äº›éƒ½æ˜¯ Gitlens çš„åŠŸèƒ½</p><h4 id="1-6-6ã€Image-Preview"><a href="#1-6-6ã€Image-Preview" class="headerlink" title="1.6.6ã€Image Preview"></a>1.6.6ã€Image Preview</h4><p>å›¾ç‰‡é¢„è§ˆï¼Œå½“é¼ æ ‡ç§»åŠ¨åˆ°å›¾ç‰‡ url ä¸Šçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ˜¾ç¤ºå›¾ç‰‡çš„é¢„è§ˆå’Œå›¾ç‰‡å°ºå¯¸</p><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d080471e2b0047cba53496b52e072ae3~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (6).gif" width="100%" /><p>okï¼Œå¥½ç”¨çš„æ’ä»¶å°±æ¨èè¿™ä¹ˆå¤š</p><h3 id="1-7ã€VS-Code-é…ç½®äº‘åŒæ­¥"><a href="#1-7ã€VS-Code-é…ç½®äº‘åŒæ­¥" class="headerlink" title="1.7ã€VS Code é…ç½®äº‘åŒæ­¥"></a>1.7ã€VS Code é…ç½®äº‘åŒæ­¥</h3><p>1ã€ä½¿ç”¨å¿«æ·é”® <code>Cmd + Shift + P</code>æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥è®¾ç½®ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5828d9a68a8b4d58985cabb0505ed78a~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025203732645.png" width="50%" /><p>é€‰æ‹©ç¬¬ä¸€é¡¹ï¼šè®¾ç½®åŒæ­¥: æ‰“å¼€â€¦</p><p>2ã€é€‰æ‹©éœ€è¦åŒæ­¥çš„é…ç½®</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b6f11137a057462f87faaf0fb072680b~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025203828081.png" width="50%" /><p>3ã€é€šè¿‡ Microsoft æˆ–è€… GitHub è´¦å·ç™»å½•ã€‚ ä¸Šå›¾ä¸­ï¼Œç‚¹å‡»<code>ç™»å½•å¹¶æ‰“å¼€</code>ï¼Œä¼šå¼¹å‡ºå¦‚ä¸‹ç•Œé¢ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/19d11934d79c43548722f9285e424ca5~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025203901427.png" width="50%" /><p>4ã€ç™»å½•æˆåŠŸå¹¶æˆæƒï¼Œå¦‚æœæ”¶åˆ°å¦‚ä¸‹æç¤ºï¼Œåˆ™è¯æ˜ä½ å·²ç»å¼€å¯äº†äº‘åŒæ­¥</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f4f5ef37c1442298962f350fdc840f3~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221025204213860.png" width="50%" /><p>5ã€æ­¤æ—¶ä½ æ¢å¦å¤–ä¸€å°ç”µè„‘ï¼Œç™»å½•ç›¸åŒçš„è´¦å·ï¼Œå³å¯å®Œæˆ VS Code é…ç½®äº‘åŒæ­¥</p><h2 id="äºŒã€Web-æµè§ˆå™¨ï¼šChrome"><a href="#äºŒã€Web-æµè§ˆå™¨ï¼šChrome" class="headerlink" title="äºŒã€Web æµè§ˆå™¨ï¼šChrome"></a>äºŒã€Web æµè§ˆå™¨ï¼šChrome</h2><p>æˆ‘è®¤ä¸º Chrome æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„æµè§ˆå™¨ï¼Œæ²¡æœ‰ä¹‹ä¸€ï¼Œä½¿ç”¨çš„äººéå¸¸å¤šï¼Œå°¤å…¶æ˜¯ç¨‹åºå‘˜ã€‚ç®€å•çš„ä»‹ç»ä¸€ä¸‹å®ƒçš„ä¼˜åŠ¿ï¼š</p><p>1ã€ç•Œé¢ç®€æ´ï¼Œæ¸…çˆ½å¹²å‡€ï¼Œæ²¡æœ‰å¹¿å‘Šï¼ŒåŠ è½½é€Ÿåº¦å¿«</p><p>2ã€æ’ä»¶èµ„æºä¸°å¯Œï¼Œç”Ÿæ€å®Œå–„</p><p>3ã€å…¨é¢æ”¯æŒ HTML5 ä»¥åŠå…¼å®¹é—®é¢˜ã€‚å‰ç«¯ç¨‹åºå‘˜ä¹‹æ‰€ä»¥é‚£ä¹ˆå–œæ¬¢ chromeï¼Œå°±æ˜¯å› ä¸ºå®ƒå…¼å®¹èµ·æ¥æœ€ç®€å•ï¼Œè€Œä¸” HTML5 å’Œ CSS3 å¯ä»¥ç»™ç”¨æˆ·å¸¦æ¥æ›´é«˜å±‚æ¬¡çš„è§†è§‰å’Œä½“éªŒ</p><p>4ã€å¼€å‘è€…å·¥å…·å¥½ç”¨ï¼Œæ–¹ä¾¿è°ƒè¯•</p><h3 id="2-1ã€Chrome-å¿«æ·é”®"><a href="#2-1ã€Chrome-å¿«æ·é”®" class="headerlink" title="2.1ã€Chrome å¿«æ·é”®"></a>2.1ã€Chrome å¿«æ·é”®</h3><p>æŒæ¡å¥½ Chrome å¿«æ·é”®ï¼Œè®©ä½ å¯¹ Chrome çˆ±ä¸é‡Šæ‰‹</p><table><thead><tr><th>Mac Chrome å¿«æ·é”®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>Cmd + N</td><td>æ‰“å¼€æ–°çª—å£</td></tr><tr><td>Cmd + Shift + N</td><td>åœ¨æ— ç—•æ¨¡å¼ä¸‹æ‰“å¼€æ–°çª—å£</td></tr><tr><td>Cmd + T</td><td>æ‰“å¼€æ–°æ ‡ç­¾é¡µï¼Œå¹¶è·³è½¬åˆ°æ–°æ ‡ç­¾é¡µ</td></tr><tr><td>Cmd + Option + å·¦å³ç®­å¤´</td><td>åˆ‡æ¢å·¦å³æ ‡ç­¾é¡µ</td></tr><tr><td>Cmd + 1ï½8</td><td>åˆ‡æ¢ 1ï½8 æ ‡ç­¾é¡µ</td></tr><tr><td>Cmd + 9</td><td>åˆ‡æ¢åˆ°æœ€åä¸€ä¸ªæ ‡ç­¾é¡µ</td></tr><tr><td>Cmd + W</td><td>å…³é—­å½“å‰æ ‡ç­¾é¡µ</td></tr><tr><td>Cmd + M</td><td>æœ€å°åŒ–çª—å£</td></tr><tr><td>Cmd + H</td><td>éšè— Chrome æµè§ˆå™¨</td></tr><tr><td>Cmd + Q</td><td>é€€å‡º Chrome æµè§ˆå™¨</td></tr><tr><td>Cmd + Shift + B</td><td>æ˜¾ç¤ºæˆ–éšè—ä¹¦ç­¾æ </td></tr><tr><td>Cmd + Option + B</td><td>æ‰“å¼€ä¹¦ç­¾ç®¡ç†å™¨</td></tr><tr><td>Cmd + ,</td><td>æ‰“å¼€è®¾ç½®é¡µ</td></tr><tr><td>Cmd + Y</td><td>åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€å†å²è®°å½•</td></tr><tr><td>Cmd + Shift + J</td><td>åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ä¸‹è½½è®°å½•</td></tr><tr><td>Cmd + F</td><td>åœ¨å½“å‰ç½‘é¡µæ‰“å¼€æœç´¢æ </td></tr><tr><td>Cmd + Option + i æˆ– Fn + F12</td><td>æ‰“å¼€å¼€å‘è€…å·¥å…·</td></tr><tr><td>Cmd + Shift + Backspace</td><td>æ‰“å¼€<code>æ¸…é™¤æµè§ˆæ•°æ®é€‰é¡¹</code></td></tr><tr><td>Cmd + Enter</td><td>åœ¨æ–°çš„æ ‡ç­¾é¡µæ‰“å¼€ç½‘å€</td></tr><tr><td>Cmd + L</td><td>è·³è½¬åˆ°åœ°å€æ </td></tr><tr><td>Cmd + Shift + R</td><td>é‡æ–°åŠ è½½å½“å‰ç½‘é¡µ</td></tr><tr><td>Cmd + O</td><td>ä»æœ¬åœ°é€‰æ‹©æ–‡ä»¶ç”¨ Chrome æ‰“å¼€</td></tr><tr><td>Cmd + Option + U</td><td>æ˜¾ç¤ºå½“å‰ç½‘é¡µä¸å¯ä¿®æ”¹çš„ HTML æºä»£ç </td></tr><tr><td>Cmd + Option + J</td><td>æ‰“å¼€ JavaScript æ§åˆ¶å°</td></tr><tr><td>Cmd + D</td><td>å°†å½“å‰ç½‘é¡µä¿å­˜ä¸ºä¹¦ç­¾</td></tr><tr><td>Cmd + Ctrl + F</td><td>å¼€å¯æˆ–å…³é—­å…¨å±æ¨¡å¼</td></tr><tr><td>Cmd + +</td><td>æ”¾å¤§ç½‘é¡µå†…å®¹</td></tr><tr><td>Cmd + -</td><td>ç¼©å°ç½‘é¡µå†…å®¹</td></tr><tr><td>Cmd + 0</td><td>å°†ç½‘é¡µå†…å®¹æ¢å¤é»˜è®¤å¤§å°</td></tr><tr><td>Cmd + Option + F</td><td>ä½¿ç”¨ Google è¿›è¡Œæœç´¢</td></tr><tr><td>Cmd + Shift + H</td><td>åœ¨å½“å‰æ ‡ç­¾é¡µä¸­æ‰“å¼€ä¸»é¡µ</td></tr><tr><td>Cmd + Shift + T</td><td>æ¢å¤ä¸Šä¸€ä¸ªè¢«å…³é—­çš„æ ‡ç­¾é¡µ</td></tr></tbody></table><h3 id="2-2ã€Chrome-å¸¸ç”¨æ’ä»¶"><a href="#2-2ã€Chrome-å¸¸ç”¨æ’ä»¶" class="headerlink" title="2.2ã€Chrome å¸¸ç”¨æ’ä»¶"></a>2.2ã€Chrome å¸¸ç”¨æ’ä»¶</h3><p>æŒæ¡å¥½ä¸‹é¢è¿™äº›æ’ä»¶ï¼Œè®©ä½ çš„ Chrome æµè§ˆå™¨å˜ä¸ºæµè§ˆç¥å™¨</p><h4 id="2-2-1ã€AdBlock"><a href="#2-2-1ã€AdBlock" class="headerlink" title="2.2.1ã€AdBlock"></a>2.2.1ã€AdBlock</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/adblock-%E2%80%94-best-ad-blocker/gighmmpiobklfepjocnamgkkbiglidom?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/adblock-%E2%80%94-best-ad-blocker/gighmmpiobklfepjocnamgkkbiglidom?utm_source=chrome-ntp-icon</a></p><p>å±è”½ç½‘é¡µå¹¿å‘Šçš„ç¥å™¨ï¼Œå¦‚æœå­˜åœ¨æ¼ç½‘ä¹‹é±¼ï¼Œä¹Ÿå¯æ‰‹åŠ¨æ·»åŠ åˆ°å±è”½åˆ—è¡¨ï¼Œè¿˜ä½ ä¸€ä¸ªå¹²å‡€çš„ç½‘ç»œç¯å¢ƒ</p><h4 id="2-2-2ã€OneTab"><a href="#2-2-2ã€OneTab" class="headerlink" title="2.2.2ã€OneTab"></a>2.2.2ã€OneTab</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/onetab/chphlpgkkbolifaimnlloiipkdnihall?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/onetab/chphlpgkkbolifaimnlloiipkdnihall?utm_source=chrome-ntp-icon</a></p><p>å°†æ‰“å¼€çš„è¯¸å¤šç½‘é¡µåˆå¹¶åœ¨ä¸€ä¸ªé¡µé¢</p><h4 id="2-2-3ã€Octotree-GitHub-code-tree"><a href="#2-2-3ã€Octotree-GitHub-code-tree" class="headerlink" title="2.2.3ã€Octotree - GitHub code tree"></a>2.2.3ã€Octotree - GitHub code tree</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/octotree-github-code-tree/bkhaagjahfmjljalopjnoealnfndnagc?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/octotree-github-code-tree/bkhaagjahfmjljalopjnoealnfndnagc?utm_source=chrome-ntp-icon</a></p><p>è®©ä½ åƒåœ¨ IDE ä¸­æµè§ˆ Github ä¸Šçš„ä»£ç ï¼Œéå¸¸å®ç”¨</p><h4 id="2-2-4ã€GitZip-for-github"><a href="#2-2-4ã€GitZip-for-github" class="headerlink" title="2.2.4ã€GitZip for github"></a>2.2.4ã€GitZip for github</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/gitzip-for-github/ffabmkklhbepgcgfonabamgnfafbdlkn?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/gitzip-for-github/ffabmkklhbepgcgfonabamgnfafbdlkn?utm_source=chrome-ntp-icon</a></p><p>è®©ä½ å¯ä»¥ä¸‹è½½ Github ä¸Šçš„æŸä¸ªæ–‡ä»¶å¤¹æˆ–æ–‡ä»¶</p><h4 id="2-2-5ã€Google-ç¿»è¯‘"><a href="#2-2-5ã€Google-ç¿»è¯‘" class="headerlink" title="2.2.5ã€Google ç¿»è¯‘"></a>2.2.5ã€Google ç¿»è¯‘</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/gitzip-for-github/ffabmkklhbepgcgfonabamgnfafbdlkn?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/gitzip-for-github/ffabmkklhbepgcgfonabamgnfafbdlkn?utm_source=chrome-ntp-icon</a></p><p>Google ç¿»è¯‘åŠŸèƒ½éå¸¸å¼ºå¤§ï¼ŒæåŠ›æ¨è</p><h4 id="2-2-6ã€ç¨€åœŸæ˜é‡‘"><a href="#2-2-6ã€ç¨€åœŸæ˜é‡‘" class="headerlink" title="2.2.6ã€ç¨€åœŸæ˜é‡‘"></a>2.2.6ã€ç¨€åœŸæ˜é‡‘</h4><p>é“¾æ¥ï¼š<a href="https://reurl.cc/eO0jdb">https://reurl.cc/eO0jdb</a></p><p>æ˜é‡‘çš„ç½‘é¡µæ’ä»¶ï¼Œé‡Œé¢è¿˜æœ‰å¾ˆå¤šå®ç”¨çš„å·¥å…·ï¼Œéå¸¸èµ</p><h4 id="2-2-7ã€Evernote-Web-Clipper"><a href="#2-2-7ã€Evernote-Web-Clipper" class="headerlink" title="2.2.7ã€Evernote Web Clipper"></a>2.2.7ã€Evernote Web Clipper</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/evernote-web-clipper/pioclpoplcdbaefihamjohnefbikjilc?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/evernote-web-clipper/pioclpoplcdbaefihamjohnefbikjilc?utm_source=chrome-ntp-icon</a></p><p>æ’ä»¶ç‰ˆå°è±¡ç¬”è®°ï¼Œå½“ä½ æƒ³ä¿å­˜ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œç”¨å®ƒå§</p><h4 id="2-2-8ã€Infinity-New-Tab-Pro"><a href="#2-2-8ã€Infinity-New-Tab-Pro" class="headerlink" title="2.2.8ã€Infinity New Tab (Pro)"></a>2.2.8ã€Infinity New Tab (Pro)</h4><p>é“¾æ¥ï¼š<a href="https://chrome.google.com/webstore/detail/infinity-new-tab-pro/nnnkddnnlpamobajfibfdgfnbcnkgngh?utm_source=chrome-ntp-icon">https://chrome.google.com/webstore/detail/infinity-new-tab-pro/nnnkddnnlpamobajfibfdgfnbcnkgngh?utm_source=chrome-ntp-icon</a></p><p>ç¾è§‚å®ç”¨çš„æ–°å»ºæ ‡ç­¾é¡µï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ç¨€åœŸæ˜é‡‘</p><h2 id="ä¸‰ã€Web-æ–‡æ¡£ç¬”è®°ï¼šMarkdown-è¯­æ³•-and-Typora"><a href="#ä¸‰ã€Web-æ–‡æ¡£ç¬”è®°ï¼šMarkdown-è¯­æ³•-and-Typora" class="headerlink" title="ä¸‰ã€Web æ–‡æ¡£ç¬”è®°ï¼šMarkdown è¯­æ³• and Typora"></a>ä¸‰ã€Web æ–‡æ¡£ç¬”è®°ï¼šMarkdown è¯­æ³• and Typora</h2><p>æˆ‘è®¤ä¸º Typora æ˜¯éå¸¸å¥½ç”¨çš„å†™ä½œ appï¼Œæ­é…ä¸Š Markdown è¯­æ³•ï¼Œç®€ç›´ä¸è¦å¤ªçˆ½ï¼Œæˆ‘å¹³æ—¶å†™åšå®¢éƒ½æ˜¯ç”¨çš„å®ƒã€‚</p><h3 id="3-1ã€Markdown-è¯­æ³•ä»‹ç»"><a href="#3-1ã€Markdown-è¯­æ³•ä»‹ç»" class="headerlink" title="3.1ã€Markdown è¯­æ³•ä»‹ç»"></a>3.1ã€Markdown è¯­æ³•ä»‹ç»</h3><h3 id="3-2ã€Typora"><a href="#3-2ã€Typora" class="headerlink" title="3.2ã€Typora"></a>3.2ã€Typora</h3><h4 id="3-2-1ã€Typora-showtime"><a href="#3-2-1ã€Typora-showtime" class="headerlink" title="3.2.1ã€Typora showtime"></a>3.2.1ã€Typora showtime</h4><h4 id="3-2-2ã€Typora-å¿«æ·é”®"><a href="#3-2-2ã€Typora-å¿«æ·é”®" class="headerlink" title="3.2.2ã€Typora å¿«æ·é”®"></a>3.2.2ã€Typora å¿«æ·é”®</h4><h4 id="3-2-3ã€å…¶ä»–ç»†èŠ‚"><a href="#3-2-3ã€å…¶ä»–ç»†èŠ‚" class="headerlink" title="3.2.3ã€å…¶ä»–ç»†èŠ‚"></a>3.2.3ã€å…¶ä»–ç»†èŠ‚</h4><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº† Web å¼€å‘ä¸­ä¸€äº›éå¸¸å¥½ç”¨çš„å¼€å‘å·¥å…·ï¼š</p><p>1ã€VS Codeï¼šæœ€é€‚åˆ Web å¼€å‘çš„ç¼–è¾‘å™¨</p><p>2ã€Chromeï¼šæœ€é€‚åˆ Web å¼€å‘çš„æµè§ˆå™¨</p><p>3ã€Markdown è¯­æ³• + Typoraï¼šæœ€é€‚åˆå†™ä½œçš„é»„é‡‘ç»„åˆ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6844903826063884296#heading-98">ç¬¬ä¸€æ¬¡ä½¿ç”¨VS Codeæ—¶ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡é…ç½®</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>Web å¿«é€Ÿå…¥é—¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆäº”ï¼‰ã€è‡ªå®šä¹‰ Gradle Transform</title>
    <link href="/2022/10/23/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%94%EF%BC%89%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%20Gradle%20Transform/"/>
    <url>/2022/10/23/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%94%EF%BC%89%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%20Gradle%20Transform/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/blog/sea.jpeg"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>å…³äº Gradle å­¦ä¹ ï¼Œæˆ‘æ‰€ç†è§£çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e010cee57604e179607243e027608d4~tplv-k3u1fbpfcp-zoom-1.image" alt="Gradle_learning" width="100%" /><p>åœ¨æœ¬ç³»åˆ—çš„å‰ 4 ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†ï¼š</p><p>1ã€Groovy è¯­æ³•</p><p>2ã€Gradle å¸¸ç”¨ apiï¼Œç”Ÿå‘½å‘¨æœŸåŠ hook ç‚¹ï¼ŒTask å®šä¹‰ï¼Œä¾èµ–ä¸æŒ‚æ¥åˆ°æ„å»ºæµç¨‹çš„åŸºæœ¬æ“ä½œ</p><p>3ã€è‡ªå®šä¹‰ Gradle æ’ä»¶åŠå®æˆ˜æ¼”ç»ƒ</p><p>è¿˜ä¸æ¸…æ¥šä¸Šé¢è¿™äº›çŸ¥è¯†ç‚¹çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»æˆ‘åˆ›å»ºçš„<a href="https://juejin.cn/column/6987218515514097678">Gradle å­¦ä¹ ä¸“æ </a></p><p>ä¸‹é¢æˆ‘æŠ›å‡ºä¸€äº›<strong>é—®é¢˜</strong>ï¼Œå¤§å®¶å¯ä»¥æ€è€ƒä¸‹ğŸ¤”ï¼š</p><p>1ã€ä¸ºäº†å¯¹ app æ€§èƒ½åšä¸€ä¸ªå…¨é¢çš„è¯„ä¼°ï¼Œæˆ‘ä»¬éœ€è¦åš UIï¼Œå†…å­˜ï¼Œç½‘ç»œç­‰æ–¹é¢çš„æ€§èƒ½ç›‘æ§ï¼Œå¦‚ä½•åš?</p><p>2ã€å‘ç°æŸä¸ªç¬¬ä¸‰æ–¹åº“æœ‰ bug ï¼Œç”¨èµ·æ¥ä¸çˆ½ï¼Œä½†åˆä¸æƒ³æ‹¿å®ƒçš„æºç ä¿®æ”¹åœ¨é‡æ–°ç¼–è¯‘ï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Ÿ</p><p>3ã€æˆ‘æƒ³åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹ï¼Œç»Ÿè®¡æŸä¸ªæ–¹æ³•çš„è€—æ—¶ï¼Œå¯¹æŸä¸ªæ–¹æ³•åšåŸ‹ç‚¹ï¼Œæ€ä¹ˆåšï¼Ÿ</p><p>ä¸ºäº†å®ç°ä¸Šé¢çš„æƒ³æ³•ï¼Œå¯èƒ½æˆ‘ä»¬æœ€å¼€å§‹çš„ç¬¬ä¸€ååº”ï¼šæ˜¯èƒ½å¦é€šè¿‡ APTï¼Œåå°„ï¼ŒåŠ¨æ€ä»£ç†æ¥å®ç°ï¼Ÿä½†æ˜¯æƒ³æ¥æƒ³å»ï¼Œè¿™äº›æ–¹æ¡ˆéƒ½ä¸èƒ½å¾ˆå¥½çš„æ»¡è¶³ä¸Šé¢çš„éœ€æ±‚ï¼Œè€Œä¸”ï¼Œæœ‰äº›é—®é¢˜ä¸èƒ½ä» Java æºæ–‡ä»¶å…¥æ‰‹ï¼Œæˆ‘ä»¬åº”è¯¥ä» Class å­—èŠ‚ç æ–‡ä»¶å¯»æ‰¾çªç ´å£</p><p>JVM å¹³å°ä¸Šï¼Œä¿®æ”¹ã€ç”Ÿæˆå­—èŠ‚ç æ— å¤„ä¸åœ¨ï¼Œä» ORM æ¡†æ¶ï¼ˆå¦‚ Hibernate, MyBatisï¼‰åˆ° Mock æ¡†æ¶ï¼ˆå¦‚ Mockitoï¼‰ï¼Œå†åˆ° Java Web ä¸­çš„å¸¸â»˜æ ‘ Spring å®¶æ—ï¼Œå†åˆ°æ–°å…´çš„ JVM è¯­è¨€ Kotlin ç¼–è¯‘å™¨ï¼Œè¿˜æœ‰å¤§åé¼é¼çš„ cglibï¼Œéƒ½æœ‰å­—èŠ‚ç çš„èº«å½±</p><p>å­—èŠ‚ç ç›¸å…³æŠ€æœ¯çš„å¼ºå¤§ä¹‹å¤„è‡ªç„¶ä¸ç”¨å¤šè¯´ï¼Œè€Œåœ¨ Android å¼€å‘ä¸­ï¼Œæ— è®ºæ˜¯ä½¿ç”¨ Java å¼€å‘è¿˜æ˜¯ Kotlin å¼€å‘ï¼Œéƒ½æ˜¯ JVM å¹³å°çš„è¯­è¨€ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨ Android å¼€å‘ä¸­ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯åšä¸€ä¸‹ hackï¼Œè¿˜å¯ä»¥å¤©ç„¶åœ°å…¼å®¹ Java å’Œ Kotlin è¯­è¨€</p><p>ç°åœ¨ç›®çš„å¾ˆæ˜ç¡®ï¼Œæˆ‘ä»¬å°±æ˜¯è¦é€šè¿‡ä¿®æ”¹å­—èŠ‚ç çš„æŠ€æœ¯å»è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œé‚£è¿™å’Œæˆ‘ä»¬ä»Šå¤©è¦è®²çš„ Gradle Transform æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›å…¥ Gradle Transform çš„å­¦ä¹ </p><h2 id="ä¸€ã€Gradle-Transform-ä»‹ç»"><a href="#ä¸€ã€Gradle-Transform-ä»‹ç»" class="headerlink" title="ä¸€ã€Gradle Transform ä»‹ç»"></a>ä¸€ã€Gradle Transform ä»‹ç»</h2><p>Gradle Transform æ˜¯ AGPï¼ˆAndroid Gradle Plugin ï¼‰1.5 å¼•å…¥çš„ç‰¹æ€§ï¼Œä¸»è¦ç”¨äºåœ¨ Android æ„å»ºè¿‡ç¨‹ä¸­ï¼Œåœ¨ Classâ†’Dex è¿™ä¸ªèŠ‚ç‚¹ä¿®æ”¹ Class å­—èŠ‚ç ã€‚åˆ©ç”¨ Transform APIï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ‰€æœ‰å‚ä¸æ„å»ºçš„ Class æ–‡ä»¶ï¼Œå€ŸåŠ© Javassist æˆ– ASM ç­‰å­—èŠ‚ç ç¼–è¾‘å·¥å…·è¿›è¡Œä¿®æ”¹ï¼Œæ’å…¥è‡ªå®šä¹‰é€»è¾‘</p><p>ä¸€å›¾èƒœåƒè¨€ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43db50c7de2a4c938893ada3e8d7b5fe~tplv-k3u1fbpfcp-watermark.image?" alt="transfrom.webp" width="50%" /><p>è™½ç„¶åœ¨ AGP 7.0 ä¸­ Transform è¢«æ ‡è®°ä¸ºåºŸå¼ƒäº†ï¼Œä½†è¿˜å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸å¦¨ç¢æˆ‘ä»¬çš„å­¦ä¹ ï¼Œä½†æ˜¯ä¼šåœ¨ AGP 8.0 ä¸­ç§»é™¤ã€‚</p><p>åç»­æ–‡ç« æˆ‘ä¹Ÿä¼šè®²å¦‚ä½•é€‚é…ä½¿ç”¨æ–°çš„ Api å»è¿›è¡Œ Transform çš„æ›¿æ¢ï¼Œå› æ­¤å¤§å®¶ä¸ç”¨æ‹…å¿ƒğŸº</p><h2 id="äºŒã€è‡ªå®šä¹‰-Gradle-Transform"><a href="#äºŒã€è‡ªå®šä¹‰-Gradle-Transform" class="headerlink" title="äºŒã€è‡ªå®šä¹‰ Gradle Transform"></a>äºŒã€è‡ªå®šä¹‰ Gradle Transform</h2><p>å…ˆä¸ç®¡ç»†èŠ‚ï¼Œå’±ä»¬ç›´æ¥å®ç°ä¸€ä¸ªè‡ªå®šä¹‰ Gradle Transform åœ¨è¯´ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤ï¼Œä¿å§†å¼æ•™ç¨‹</p><p>å®ç°ä¸€ä¸ª Transform éœ€è¦å…ˆåˆ›å»º Gradle æ’ä»¶ï¼Œå¤§è‡´æµç¨‹ï¼š<strong>è‡ªå®šä¹‰ Gradle æ’ä»¶ -&gt; è‡ªå®šä¹‰ Transform -&gt; æ³¨å†Œ Transform</strong></p><p>å¦‚æœä½ äº†è§£è‡ªå®šä¹‰ Gradle æ’ä»¶ï¼Œé‚£ä¹ˆè‡ªå®šä¹‰ Gradle Transform å°†ä¼šå˜å¾—éå¸¸ç®€å•ï¼Œä¸äº†è§£çš„å»çœ‹æˆ‘çš„è¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6988051489306443789">Gradle ç³»åˆ— ï¼ˆä¸‰ï¼‰ã€Gradle æ’ä»¶å¼€å‘</a></p><p>é¦–å…ˆç»™å¤§å®¶çœ‹ä¸€çœ¼æˆ‘é¡¹ç›®åˆå§‹åŒ–çš„ä¸€ä¸ªé…ç½®ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e350f713f4cd4d8c9c54a93fbb4b0cec~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027193356475.png" width="100%" /><p>å¯ä»¥çœ‹åˆ°ï¼š</p><blockquote><p>1ã€AGP ç‰ˆæœ¬ï¼š7.2.0</p><p>2ã€Gradle ç‰ˆæœ¬ï¼š7.4</p></blockquote><p>æˆ‘çš„ AndroidStudio ç‰ˆæœ¬ï¼šDolphin | 2021.3.1</p><p>å¤§å®¶éœ€è¦å¯¹åº”å¥½ AndroidStudio ç‰ˆæœ¬æ‰€éœ€çš„ AGP ç‰ˆæœ¬ï¼ŒAGP ç‰ˆæœ¬æ‰€éœ€çš„ Gradle ç‰ˆæœ¬ï¼Œå¦åˆ™ä¼šå‡ºç°å…¼å®¹æ€§å’Œå„ç§æœªçŸ¥çš„é—®é¢˜ï¼Œå¯¹åº”å…³ç³»å¯ä»¥å»<a href="https://developer.android.com/studio/releases/gradle-plugin?hl=zh-cn">å®˜ç½‘</a>æŸ¥è¯¢</p><p>å¦å¤–å¤§å®¶ä¼šå‘ç°ï¼ŒAGP 7.x ä¸­ settings.gradle å’Œæ ¹ build.gradle æ–‡ä»¶ä½¿ç”¨äº†ä¸€ç§æ–°çš„é…ç½®æ–¹å¼ï¼Œå»ºè®®æ”¹å›åŸæ¥çš„é…ç½®æ–¹å¼ï¼Œå‘å°‘ğŸ˜„ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€ä¿®æ”¹ settings.gradle </span><br>rootProject.name = <span class="hljs-string">&quot;GradleTransformDemo&quot;</span><br>include <span class="hljs-string">&#x27;:app&#x27;</span><br><br><span class="hljs-comment">//2ã€ä¿®æ”¹æ ¹ build.gradle</span><br>buildscript &#123;<br>    ext.kotlin_version = <span class="hljs-string">&quot;1.7.20&quot;</span><br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>    &#125;<br>    dependencies &#123;<br>        classpath <span class="hljs-string">&quot;com.android.tools.build:gradle:7.2.0&quot;</span><br>        classpath <span class="hljs-string">&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20&quot;</span><br>    &#125;<br>&#125;<br><br>allprojects &#123;<br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>    &#125;<br>&#125;<br><br>task clean(<span class="hljs-attr">type:</span> Delete) &#123;<br>    delete rootProject.buildDir<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-1ã€è‡ªå®šä¹‰-Gradle-æ’ä»¶"><a href="#2-1ã€è‡ªå®šä¹‰-Gradle-æ’ä»¶" class="headerlink" title="2.1ã€è‡ªå®šä¹‰ Gradle æ’ä»¶"></a>2.1ã€è‡ªå®šä¹‰ Gradle æ’ä»¶</h3><p>åˆ›å»º Gradle æ’ä»¶ Moduleï¼šcustomtransformpluginï¼Œåˆå§‹ä»£ç å¦‚ä¸‹å›¾ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9144a5d065354cad98875e318cffe1de~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221028155752896.png" width="100%" /><p><strong>æ³¨æ„</strong>ï¼šæ­¤æ’ä»¶æˆ‘æ˜¯ä½¿ç”¨ Kotlin ç¼–å†™çš„ï¼Œå’Œä¹‹å‰ Groovy ç¼–å†™æ’ä»¶çš„åŒºåˆ«ï¼š</p><p>1ã€Kotlin ç¼–å†™çš„æ’ä»¶å¯ä»¥ç›´æ¥å†™åœ¨ <code>src/main/java</code>ç›®å½•ä¸‹ï¼Œå¦å¤– AndroidStudio å¯¹ Kotlin å¤šäº†å¾ˆå¤šæ‰©å±•æ”¯æŒï¼Œç¼–å†™æ•ˆç‡é«˜</p><p>2ã€ Groovy ç¼–å†™æ’ä»¶éœ€è¦å†™åœ¨<code>src/main/groovy</code>ç›®å½•ä¸‹</p><p>Transform ç›¸å…³ Api éœ€è¦å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation <span class="hljs-string">&quot;com.android.tools.build:gradle-api:7.2.0&quot;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸Šè¿°å¹¶æ²¡æœ‰å¼•å…¥ï¼Œæ˜¯å› ä¸º AGP ç›¸å…³ Api ä¾èµ–äº†å®ƒï¼Œæ ¹æ®ä¾èµ–ä¼ é€’çš„ç‰¹æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¼•ç”¨åˆ° Transform ç›¸å…³ Api </p><h3 id="2-2ã€è‡ªå®šä¹‰-Transform"><a href="#2-2ã€è‡ªå®šä¹‰-Transform" class="headerlink" title="2.2ã€è‡ªå®šä¹‰ Transform"></a>2.2ã€è‡ªå®šä¹‰ Transform</h3><p>åˆå§‹ä»£ç å¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbcbb9f4171646c493a32edb1ac0f7b9~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027225223971.png" width="100%" /><p>æ¥ç€å¯¹å…¶è¿›è¡Œç®€å•çš„ä¿®æ”¹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.dream.customtransformplugin<br><br><span class="hljs-keyword">import</span> com.android.build.api.transform.*<br><span class="hljs-keyword">import</span> com.android.build.gradle.<span class="hljs-keyword">internal</span>.pipeline.TransformManager<br><span class="hljs-keyword">import</span> com.android.utils.FileUtils<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * function: è‡ªå®šä¹‰ Transform</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomTransform</span>: <span class="hljs-type">Transform</span>() &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¾ç½®æˆ‘ä»¬è‡ªå®šä¹‰ Transform å¯¹åº”çš„ Task åç§°ï¼ŒGradle åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šå°†è¿™ä¸ªåç§°ç»è¿‡ä¸€äº›æ‹¼æ¥æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸Š</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ErdaiTransform&quot;</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é¡¹ç›®ä¸­ä¼šæœ‰å„ç§å„æ ·æ ¼å¼çš„æ–‡ä»¶ï¼Œè¯¥æ–¹æ³•å¯ä»¥è®¾ç½® Transform æ¥æ”¶çš„æ–‡ä»¶ç±»å‹</span><br><span class="hljs-comment">     * å…·ä½“å–å€¼èŒƒå›´ï¼š</span><br><span class="hljs-comment">     * CONTENT_CLASSï¼šJava å­—èŠ‚ç æ–‡ä»¶ï¼Œ</span><br><span class="hljs-comment">     * CONTENT_JARSï¼šjar åŒ…</span><br><span class="hljs-comment">     * CONTENT_RESOURCESï¼šèµ„æºï¼ŒåŒ…å« java æ–‡ä»¶</span><br><span class="hljs-comment">     * CONTENT_DEXï¼šdex æ–‡ä»¶</span><br><span class="hljs-comment">     * CONTENT_DEX_WITH_RESOURCESï¼šåŒ…å«èµ„æºçš„ dex æ–‡ä»¶</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * æˆ‘ä»¬èƒ½ç”¨çš„å°±ä¸¤ç§ï¼šCONTENT_CLASS å’Œ CONTENT_JARS</span><br><span class="hljs-comment">     * å…¶ä½™å‡ ç§ä»… AGP å¯ç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInputTypes</span><span class="hljs-params">()</span></span>: MutableSet&lt;QualifiedContent.ContentType&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.CONTENT_CLASS<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å®šä¹‰ Transform æ£€ç´¢çš„èŒƒå›´ï¼š</span><br><span class="hljs-comment">     * PROJECTï¼šåªæ£€ç´¢é¡¹ç›®å†…å®¹</span><br><span class="hljs-comment">     * SUB_PROJECTSï¼šåªæ£€ç´¢å­é¡¹ç›®å†…å®¹</span><br><span class="hljs-comment">     * EXTERNAL_LIBRARIESï¼šåªæ£€ç´¢å¤–éƒ¨åº“ï¼ŒåŒ…æ‹¬å½“å‰æ¨¡å—å’Œå­æ¨¡å—æœ¬åœ°ä¾èµ–å’Œè¿œç¨‹ä¾èµ–çš„ JAR/AAR</span><br><span class="hljs-comment">     * TESTED_CODEï¼šç”±å½“å‰å˜ä½“æ‰€æµ‹è¯•çš„ä»£ç ï¼ˆåŒ…æ‹¬ä¾èµ–é¡¹ï¼‰</span><br><span class="hljs-comment">     * PROVIDED_ONLYï¼šæœ¬åœ°ä¾èµ–å’Œè¿œç¨‹ä¾èµ–çš„ JAR/AARï¼ˆprovided-onlyï¼‰</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScopes</span><span class="hljs-params">()</span></span>: MutableSet&lt;<span class="hljs-keyword">in</span> QualifiedContent.Scope&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.SCOPE_FULL_PROJECT<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¡¨ç¤ºå½“å‰ Transform æ˜¯å¦æ”¯æŒå¢é‡ç¼–è¯‘ trueï¼šæ”¯æŒ falseï¼šä¸æ”¯æŒ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isIncremental</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿›è¡Œå…·ä½“çš„æ£€ç´¢æ“ä½œ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(transformInvocation: <span class="hljs-type">TransformInvocation</span>?)</span></span> &#123;<br>        printLog()<br>        transformInvocation?.inputs?.forEach &#123;<br>            <span class="hljs-comment">// ä¸€ã€è¾“å…¥æºä¸ºæ–‡ä»¶å¤¹ç±»å‹</span><br>            it.directoryInputs.forEach &#123;directoryInput-&gt;<br>                <span class="hljs-comment">//1ã€TODO é’ˆå¯¹æ–‡ä»¶å¤¹è¿›è¡Œå­—èŠ‚ç æ“ä½œï¼Œè¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥åšä¸€äº›ç‹¸çŒ«æ¢å¤ªå­ï¼Œå·å¤©æ¢æ—¥çš„äº‹æƒ…äº†</span><br>                <span class="hljs-comment">//å…ˆå¯¹å­—èŠ‚ç è¿›è¡Œä¿®æ”¹ï¼Œåœ¨å¤åˆ¶ç»™ dest</span><br><br>                <span class="hljs-comment">//2ã€æ„å»ºè¾“å‡ºè·¯å¾„ dest</span><br>                <span class="hljs-keyword">val</span> dest = transformInvocation.outputProvider.getContentLocation(<br>                    directoryInput.name,<br>                    directoryInput.contentTypes,<br>                    directoryInput.scopes,<br>                    Format.DIRECTORY<br>                )<br>                <span class="hljs-comment">//3ã€å°†æ–‡ä»¶å¤¹å¤åˆ¶ç»™ dest ï¼Œdest å°†ä¼šä¼ é€’ç»™ä¸‹ä¸€ä¸ª Transform</span><br>                FileUtils.copyDirectory(directoryInput.file,dest)<br>            &#125;<br><br>            <span class="hljs-comment">// äºŒã€è¾“å…¥æºä¸º jar åŒ…ç±»å‹</span><br>            it.jarInputs.forEach &#123; jarInput-&gt;<br>                <span class="hljs-comment">//1ã€TODO é’ˆå¯¹ jar åŒ…è¿›è¡Œç›¸å…³å¤„ç†</span><br><br>                <span class="hljs-comment">//2ã€æ„å»ºè¾“å‡ºè·¯å¾„ dest</span><br>                <span class="hljs-keyword">val</span> dest = transformInvocation.outputProvider.getContentLocation(<br>                    jarInput.name,<br>                    jarInput.contentTypes,<br>                    jarInput.scopes,<br>                    Format.JAR<br>                )<br>                <span class="hljs-comment">//3ã€å°† jar åŒ…å¤åˆ¶ç»™ destï¼Œdest å°†ä¼šä¼ é€’ç»™ä¸‹ä¸€ä¸ª Transform </span><br>                FileUtils.copyFile(jarInput.file,dest)<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‰“å°ä¸€æ®µ log æ—¥å¿—</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printLog</span><span class="hljs-params">()</span></span> &#123;<br>        println()<br>        println(<span class="hljs-string">&quot;******************************************************************************&quot;</span>)<br>        println(<span class="hljs-string">&quot;******                                                                  ******&quot;</span>)<br>        println(<span class="hljs-string">&quot;******                æ¬¢è¿ä½¿ç”¨ ErdaiTransform ç¼–è¯‘æ’ä»¶                    ******&quot;</span>)<br>        println(<span class="hljs-string">&quot;******                                                                  ******&quot;</span>)<br>        println(<span class="hljs-string">&quot;******************************************************************************&quot;</span>)<br>        println()<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3ã€æ³¨å†Œ-Transform"><a href="#2-3ã€æ³¨å†Œ-Transform" class="headerlink" title="2.3ã€æ³¨å†Œ Transform"></a>2.3ã€æ³¨å†Œ Transform</h3><p>åœ¨ CustomTransformPlugin ä¸­å¯¹ TransForm è¿›è¡Œæ³¨å†Œï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è‡ªå®šä¹‰ï¼šCustomTransformPlugin</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomTransformPlugin</span>: <span class="hljs-type">Plugin</span>&lt;<span class="hljs-type">Project</span>&gt; &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(project: <span class="hljs-type">Project</span>)</span></span> &#123;<br>        println(<span class="hljs-string">&quot;Hello CustomTransformPlugin&quot;</span>)<br><br>        <span class="hljs-comment">//æ–°å¢çš„ä»£ç </span><br>        <span class="hljs-comment">// 1ã€è·å– Android æ‰©å±•</span><br>        <span class="hljs-keyword">val</span> androidExtension = project.extensions.getByType(AppExtension::<span class="hljs-keyword">class</span>.java)<br>        <span class="hljs-comment">// 2ã€æ³¨å†Œ Transform</span><br>        androidExtension.registerTransform(MyCustomTransform())<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>okï¼Œç»è¿‡ä¸Šé¢ä¸‰æ­¥ï¼Œä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰ Gradle Transform æ’ä»¶å·²ç»å®Œæˆäº†</p><h3 id="2-4ã€ä¸Šä¼ æ’ä»¶åˆ°æœ¬åœ°ä»“åº“"><a href="#2-4ã€ä¸Šä¼ æ’ä»¶åˆ°æœ¬åœ°ä»“åº“" class="headerlink" title="2.4ã€ä¸Šä¼ æ’ä»¶åˆ°æœ¬åœ°ä»“åº“"></a>2.4ã€ä¸Šä¼ æ’ä»¶åˆ°æœ¬åœ°ä»“åº“</h3><p>ç‚¹å‡» <code>publish</code>è¿›è¡Œå‘å¸ƒ</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/49a529fad87449ebad4e4d2095a8e51d~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027231411456.png" width="100%" /><p>å¦‚æœä½ çš„é¡¹ç›®å¤šäº†å¦‚ä¸‹å†…å®¹ï¼Œåˆ™è¯æ˜å‘å¸ƒæˆåŠŸäº†</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/402a65c75fb34506b010265ebc2c73e1~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027231609120.png" width="50%" /><h3 id="2-5ã€æ•ˆæœéªŒè¯"><a href="#2-5ã€æ•ˆæœéªŒè¯" class="headerlink" title="2.5ã€æ•ˆæœéªŒè¯"></a>2.5ã€æ•ˆæœéªŒè¯</h3><p>åœ¨æ ¹ build.gradle è¿›è¡Œæ’ä»¶ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>    <span class="hljs-comment">//...</span><br>    repositories &#123;<br>     <span class="hljs-comment">//...</span><br>      <span class="hljs-comment">//æ·»åŠ æœ¬åœ° maven ä»“åº“</span><br>        maven &#123;<br>            url(<span class="hljs-string">&#x27;repo&#x27;</span>)<br>        &#125;<br>    &#125;<br>    dependencies &#123;<br>       <span class="hljs-comment">//...</span><br>      <span class="hljs-comment">//å¼•å…¥æ’ä»¶ä¾èµ–</span><br>        classpath <span class="hljs-string">&quot;com.dream:customtransformplugin:1.0.0&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ app çš„ build.gradle åº”ç”¨æ’ä»¶ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">plugins &#123;<br>   <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//åº”ç”¨æ’ä»¶</span><br>    id <span class="hljs-string">&#x27;CustomTransformPlugin&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åŒæ­¥ä¸€ä¸‹é¡¹ç›®ï¼Œè¿è¡Œ app</p><p>é…ç½®é˜¶æ®µæ‰“å°å¦‚ä¸‹å›¾ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f30e7d1c4a747b98f470598d98ae9d2~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027232532681.png" width="100%" /><p>æ‰§è¡Œé˜¶æ®µæ‰“å°å¦‚ä¸‹å›¾ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/76a33e5203d14af18842507fb02e7c32~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027232433364.png" width="100%" /><p>è¿™æ ·æˆ‘ä»¬ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰ Gradle Transform å°±å®Œæˆäº†</p><p>å¦å¤–éœ€è¦<strong>æ³¨æ„</strong>ï¼šå½“ä½ å¯¹è‡ªå®šä¹‰ Gradle Transform åšä¿®æ”¹åæƒ³çœ‹æ•ˆæœï¼ŒåŠ¡å¿…å‡çº§æ’ä»¶çš„ç‰ˆæœ¬ï¼Œé‡æ–°å‘å¸ƒï¼Œç„¶ååœ¨æ ¹ build.gradle ä¸­ä¿®æ”¹ä¸ºæ–°çš„ç‰ˆæœ¬ï¼ŒåŒæ­¥ååœ¨é‡æ–°è¿è¡Œï¼Œå¦åˆ™ Gradle Transform ä¼šä¸ç”Ÿæ•ˆ</p><p>æ¶ˆåŒ–ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è®²ç‚¹ Transform çš„ç»†èŠ‚</p><h2 id="ä¸‰ã€Transform-ç»†èŠ‚å’Œç›¸å…³-Api-ä»‹ç»"><a href="#ä¸‰ã€Transform-ç»†èŠ‚å’Œç›¸å…³-Api-ä»‹ç»" class="headerlink" title="ä¸‰ã€Transform ç»†èŠ‚å’Œç›¸å…³ Api ä»‹ç»"></a>ä¸‰ã€Transform ç»†èŠ‚å’Œç›¸å…³ Api ä»‹ç»</h2><h3 id="3-1ã€Transform-æ•°æ®æµåŠ¨"><a href="#3-1ã€Transform-æ•°æ®æµåŠ¨" class="headerlink" title="3.1ã€Transform æ•°æ®æµåŠ¨"></a>3.1ã€Transform æ•°æ®æµåŠ¨</h3><p>Transform æ•°æ®æµåŠ¨ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p><blockquote><p>1ã€æ¶ˆè´¹å‹ Transform ï¼šæ•°æ®ä¼šè¾“å‡ºç»™ä¸‹ä¸€ä¸ª Transform</p><p>2ã€å¼•ç”¨å‹ Transform ï¼šæ•°æ®ä¸ä¼šè¾“å‡ºç»™ä¸‹ä¸€ä¸ª Transform</p></blockquote><h4 id="3-1-1ã€æ¶ˆè´¹å‹-Transform"><a href="#3-1-1ã€æ¶ˆè´¹å‹-Transform" class="headerlink" title="3.1.1ã€æ¶ˆè´¹å‹ Transform"></a>3.1.1ã€æ¶ˆè´¹å‹ Transform</h4><p>å¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a11dff3636244c8bbbe6b4b005b7fe96~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221027234522100.png" width="50%" /><p>1ã€æ¯ä¸ª Transform å…¶å®éƒ½æ˜¯ä¸€ä¸ª Gradle Taskï¼ŒAGP ä¸­çš„ TaskManager ä¼šå°†æ¯ä¸ª Transform ä¸²è¿èµ·æ¥</p><p>2ã€ç¬¬ä¸€ä¸ª Transform ä¼šæ¥æ”¶ï¼š</p><blockquote><p>1ã€æ¥è‡ª Javac ç¼–è¯‘çš„ç»“æœ</p><p>2ã€æ‹‰å–åˆ°åœ¨æœ¬åœ°çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆjarï¼Œaarï¼‰</p><p>3ã€resource èµ„æºï¼ˆè¿™é‡Œçš„ resource å¹¶é Android é¡¹ç›®ä¸­çš„ res èµ„æºï¼Œè€Œæ˜¯ assets ç›®å½•ä¸‹çš„èµ„æºï¼‰</p></blockquote><p>3ã€è¿™äº›ç¼–è¯‘çš„ä¸­é—´äº§ç‰©ï¼Œä¼šåœ¨ Transform ç»„æˆçš„é“¾æ¡ä¸ŠæµåŠ¨ï¼Œæ¯ä¸ª Transform èŠ‚ç‚¹å¯ä»¥å¯¹ Class è¿›è¡Œå¤„ç†å†ä¼ é€’ç»™ä¸‹ä¸€ä¸ªTransform</p><p>4ã€æˆ‘ä»¬å¸¸â»…çš„æ··æ·†ï¼ŒDesugar ç­‰é€»è¾‘ï¼Œå®ƒä»¬çš„å®ç°éƒ½æ˜¯å°è£…åœ¨ä¸€ä¸ªä¸ª Transform ä¸­ï¼Œè€Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ Transformï¼Œä¼šæ’å…¥åˆ°è¿™ä¸ªTransform é“¾æ¡çš„æœ€å‰é¢</p><h4 id="3-1-2ã€å¼•ç”¨å‹-Transform"><a href="#3-1-2ã€å¼•ç”¨å‹-Transform" class="headerlink" title="3.1.2ã€å¼•ç”¨å‹ Transform"></a>3.1.2ã€å¼•ç”¨å‹ Transform</h4><p>å¼•ç”¨å‹ Transform ä¼šè¯»å–ä¸Šä¸€ä¸ª Transform è¾“å…¥çš„æ•°æ®ï¼Œè€Œä¸éœ€è¦è¾“å‡ºç»™ä¸‹ä¸€ä¸ªTransformï¼Œä¾‹å¦‚ Instant Run å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ£€æŸ¥ä¸¤æ¬¡ç¼–è¯‘ä¹‹é—´çš„ diff è¿›è¡Œå¿«é€Ÿè¿è¡Œ</p><p>okï¼Œäº†è§£äº† Transform çš„æ•°æ®æµåŠ¨ï¼Œæˆ‘ä»¬å›åˆ°è‡ªå®šä¹‰ Transform çš„åˆå§‹çŠ¶æ€ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomTransform</span>: <span class="hljs-type">Transform</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ErdaiTransform&quot;</span><br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInputTypes</span><span class="hljs-params">()</span></span>: MutableSet&lt;QualifiedContent.ContentType&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.CONTENT_CLASS<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScopes</span><span class="hljs-params">()</span></span>: MutableSet&lt;<span class="hljs-keyword">in</span> QualifiedContent.Scope&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.SCOPE_FULL_PROJECT<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isIncremental</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(transformInvocation: <span class="hljs-type">TransformInvocation</span>?)</span></span> &#123;<br>       <span class="hljs-keyword">super</span>.transform(transformInvocation)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é‡å†™äº† Transform çš„ 5 ä¸ªæ–¹æ³•ï¼Œæ¥ä¸‹æ¥å…·ä½“ä»‹ç»ä¸‹</p><h3 id="3-2ã€getName"><a href="#3-2ã€getName" class="headerlink" title="3.2ã€getName"></a>3.2ã€getName</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ErdaiTransform&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>getName æ–¹æ³•ä¸»è¦æ˜¯è·å–è‡ªå®šä¹‰ Transform çš„åç§°ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶çš„æ˜¯ä¸€ä¸ª String å­—ç¬¦ä¸²çš„ç±»å‹ï¼Œå®ƒçš„ä½œç”¨ï¼š</p><p>1ã€è¿›è¡Œ Transform å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªåº”ç”¨å†…å¯ä»¥æœ‰å¤šä¸ª Transformï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªåç§°ï¼Œæ–¹ä¾¿åé¢è°ƒç”¨</p><p>2ã€åˆ›å»º Transform Task å‘½åæ—¶ä¼šç”¨åˆ°å®ƒ</p><p>é€šè¿‡æºç éªŒè¯ä¸€ä¸‹ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//TransformManager#addTransform</span><br><span class="hljs-meta">@NonNull</span><br><span class="hljs-keyword">public</span> &lt;T extends Transform&gt; Optional&lt;TaskProvider&lt;TransformTask&gt;&gt; addTransform(<br>            <span class="hljs-meta">@NonNull</span> TaskFactory taskFactory,<br>            <span class="hljs-meta">@NonNull</span> VariantCreationConfig creationConfig,<br>            <span class="hljs-meta">@NonNull</span> T transform,<br>            <span class="hljs-meta">@Nullable</span> PreConfigAction preConfigAction,<br>            <span class="hljs-meta">@Nullable</span> TaskConfigAction&lt;TransformTask&gt; configAction,<br>            <span class="hljs-meta">@Nullable</span> TaskProviderCallback&lt;TransformTask&gt; providerCallback) &#123;<br>    <span class="hljs-comment">//...</span><br>    List&lt;TransformStream&gt; inputStreams = Lists.newArrayList();<br>    String taskName = creationConfig.computeTaskName(getTaskNamePrefix(transform), <span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//TransformManager#getTaskNamePrefix</span><br><span class="hljs-meta">@VisibleForTesting</span><br><span class="hljs-meta">@NonNull</span><br>static String getTaskNamePrefix(<span class="hljs-meta">@NonNull</span> Transform transform) &#123;<br>   StringBuilder sb = new StringBuilder(<span class="hljs-number">100</span>);<br>   sb.append(<span class="hljs-string">&quot;transform&quot;</span>);<br>   sb.append(<br>                transform<br>                        .getInputTypes()<br>                        .stream()<br>                        .map(<br>                                inputType -&gt;<br>                                        CaseFormat.UPPER_UNDERSCORE.to(<br>                                                CaseFormat.UPPER_CAMEL, inputType.name()))<br>                        .sorted() <span class="hljs-comment">// Keep the order stable.</span><br>                        .collect(Collectors.joining(<span class="hljs-string">&quot;And&quot;</span>)));<br>   sb.append(<span class="hljs-string">&quot;With&quot;</span>);<br>   StringHelper.appendCapitalized(sb, transform.getName());<br>   sb.append(<span class="hljs-string">&quot;For&quot;</span>);<br>   <span class="hljs-keyword">return</span> sb.toString();   <br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šæ–¹æ³•å‰åçœç•¥äº†å¤§é‡ä»£ç ï¼Œæˆ‘ä»¬åªçœ‹ä¸»çº¿æµç¨‹</p><p>ä»ä¸Šé¢ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–°å»ºçš„ Transform Task çš„å‘½åè§„åˆ™å¯ä»¥ç†è§£ä¸ºï¼š</p><p><code>transform$&#123;inputType1.name&#125;And$&#123;inputType2.name&#125;With$&#123;transform.name&#125;For$&#123;variantName&#125;</code></p><p>é€šè¿‡æˆ‘ä»¬ä¸Šé¢ç”Ÿæˆçš„ Transform Task ä¹Ÿå¯ä»¥éªŒè¯è¿™ä¸€ç‚¹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">&gt; Task :app:transformClassesWithErdaiTransformForDebug<br></code></pre></td></tr></table></figure><h3 id="3-3ã€getInputTypes"><a href="#3-3ã€getInputTypes" class="headerlink" title="3.3ã€getInputTypes"></a>3.3ã€getInputTypes</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInputTypes</span><span class="hljs-params">()</span></span>: MutableSet&lt;QualifiedContent.ContentType&gt; &#123;<br>    <span class="hljs-keyword">return</span> TransformManager.CONTENT_CLASS<br>&#125;<br></code></pre></td></tr></table></figure><p>getInputTypes æ–¹æ³•ä¸»è¦ç”¨äºè·å–è¾“å…¥ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶ä¸€ä¸ª ContentType çš„ Set é›†åˆï¼Œè¡¨ç¤ºå®ƒå…è®¸è¾“å…¥å¤šç§ç±»å‹ã€‚ä¸Šè¿°è¿”å›å€¼æˆ‘ä»¬ä½¿ç”¨äº† TransformManager å†…ç½®çš„è¾“å…¥ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInputTypes</span><span class="hljs-params">()</span></span>: MutableSet&lt;QualifiedContent.ContentType&gt; &#123;<br>    <span class="hljs-comment">//å®é™… TransformManager.CONTENT_CLASS å†…éƒ¨å°±æ˜¯å¯¹å®ƒçš„å°è£…</span><br>    <span class="hljs-keyword">return</span> ImmutableSet.of(QualifiedContent.DefaultContentType.CLASSES)<br>&#125;<br></code></pre></td></tr></table></figure><p>ContentType æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¡¨ç¤ºè¾“å…¥æˆ–è¾“å‡ºå†…å®¹çš„ç±»å‹ï¼Œå®ƒæœ‰ä¸¤ä¸ªå®ç°æšä¸¾ç±» <code>DefaultContentType</code> å’Œ <code>ExtendedContentType</code> ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨è‡ªå®šä¹‰ Transform æ—¶åªèƒ½ä½¿ç”¨ DefaultContentType ä¸­å®šä¹‰çš„æšä¸¾ï¼Œå³ <code>CLASSES</code> å’Œ <code>RESOURCES</code> ä¸¤ç§ç±»å‹ï¼Œå…¶å®ƒç±»å‹ä»…ä¾› AGP å†…ç½®çš„ Transform ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">DefaultContentType</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ContentType</span> &#123;<br>    <span class="hljs-comment">// Java å­—èŠ‚ç ï¼ŒåŒ…æ‹¬ Jar æ–‡ä»¶å’Œç”±æºç ç¼–è¯‘äº§ç”Ÿçš„</span><br>    CLASSES(<span class="hljs-number">0x01</span>),<br>  <br>    <span class="hljs-comment">// Java èµ„æº</span><br>    RESOURCES(<span class="hljs-number">0x02</span>);<br>  <br>  <span class="hljs-comment">//...</span><br>&#125;<br><br><br><span class="hljs-comment">// åŠ å¼ºç±»å‹ï¼Œè‡ªå®šä¹‰ Transform æ— æ³•ä½¿ç”¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ExtendedContentType</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ContentType</span> &#123;<br><br>    <span class="hljs-comment">// DEX æ–‡ä»¶</span><br>    DEX(<span class="hljs-number">0x1000</span>),<br><br>    <span class="hljs-comment">// Native åº“</span><br>    NATIVE_LIBS(<span class="hljs-number">0x2000</span>),<br><br>    <span class="hljs-comment">// Instant Run åŠ å¼ºç±»</span><br>    CLASSES_ENHANCED(<span class="hljs-number">0x4000</span>),<br><br>    <span class="hljs-comment">// Data Binding ä¸­é—´äº§ç‰©</span><br>    DATA_BINDING(<span class="hljs-number">0x10000</span>),<br><br>    <span class="hljs-comment">// Dex Archive</span><br>    DEX_ARCHIVE(<span class="hljs-number">0x40000</span>),<br>    ;<br>  <br>    <span class="hljs-comment">//...</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ Transform æˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªä½ç½®å®šä¹‰ ContentTypeï¼š</p><p><strong>1ã€Set getInputTypes()ï¼š</strong> æŒ‡å®šè¾“å…¥å†…å®¹ç±»å‹ï¼Œå…è®¸é€šè¿‡ Set é›†åˆè®¾ç½®è¾“å…¥å¤šç§ç±»å‹</p><p><strong>2ã€Set getOutputTypes()ï¼š</strong> æŒ‡å®šè¾“å‡ºå†…å®¹ç±»å‹ï¼Œé»˜è®¤å– getInputTypes() çš„å€¼ï¼Œå…è®¸é€šè¿‡ Set é›†åˆè®¾ç½®è¾“å‡ºå¤šç§ç±»å‹</p><p>çœ‹ä¸€çœ¼ TransformManager ç»™æˆ‘ä»¬å†…ç½®çš„ ContentType é›†åˆï¼Œå¸¸ç”¨çš„æ˜¯ CONTENT_CLASS ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ContentType&gt; CONTENT_CLASS = ImmutableSet.of(CLASSES);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ContentType&gt; CONTENT_JARS = ImmutableSet.of(CLASSES, RESOURCES);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ContentType&gt; CONTENT_RESOURCES = ImmutableSet.of(RESOURCES);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ContentType&gt; CONTENT_DEX = ImmutableSet.of(ExtendedContentType.DEX);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ContentType&gt; CONTENT_DEX_WITH_RESOURCES =<br>            ImmutableSet.of(ExtendedContentType.DEX, RESOURCES);<br></code></pre></td></tr></table></figure><h3 id="3-4ã€getScopes"><a href="#3-4ã€getScopes" class="headerlink" title="3.4ã€getScopes"></a>3.4ã€getScopes</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScopes</span><span class="hljs-params">()</span></span>: MutableSet&lt;<span class="hljs-keyword">in</span> QualifiedContent.Scope&gt; &#123;<br>    <span class="hljs-keyword">return</span> TransformManager.SCOPE_FULL_PROJECT<br>&#125;<br></code></pre></td></tr></table></figure><p>getScopes æ–¹æ³•ä¸»è¦ç”¨æ¥å®šä¹‰æ£€ç´¢çš„èŒƒå›´ï¼Œå‘Šè¯‰ Transform éœ€è¦å¤„ç†å“ªäº›è¾“å…¥æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶çš„æ˜¯ä¸€ä¸ª Scope çš„ Set é›†åˆã€‚ä¸Šè¿°è¿”å›å€¼æˆ‘ä»¬ä½¿ç”¨äº† TransformManager å†…ç½®çš„ Scope é›†åˆï¼Œå¦‚æœä¸æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScopes</span><span class="hljs-params">()</span></span>: MutableSet&lt;<span class="hljs-keyword">in</span> QualifiedContent.Scope&gt; &#123;<br>    <span class="hljs-comment">//å®é™… TransformManager.SCOPE_FULL_PROJECT å°±æ˜¯å¯¹å®ƒçš„å°è£…</span><br>    <span class="hljs-keyword">return</span> ImmutableSet.of(QualifiedContent.Scope.PROJECT, <br>             QualifiedContent.Scope.SUB_PROJECTS, <br>             QualifiedContent.Scope.EXTERNAL_LIBRARIES)<br>&#125;<br></code></pre></td></tr></table></figure><p>Scope æ˜¯ä¸€ä¸ªæšä¸¾ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Scope</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ScopeType</span> &#123;<br>    <span class="hljs-comment">//åªæ£€ç´¢é¡¹ç›®å†…å®¹</span><br>    PROJECT(<span class="hljs-number">0x01</span>),<br>    <span class="hljs-comment">//åªæ£€ç´¢å­é¡¹ç›®å†…å®¹</span><br>    SUB_PROJECTS(<span class="hljs-number">0x04</span>),<br>    <span class="hljs-comment">//åªæ£€ç´¢å¤–éƒ¨åº“ï¼ŒåŒ…æ‹¬å½“å‰æ¨¡å—å’Œå­æ¨¡å—æœ¬åœ°ä¾èµ–å’Œè¿œç¨‹ä¾èµ–çš„ JAR/AAR</span><br>    EXTERNAL_LIBRARIES(<span class="hljs-number">0x10</span>),<br>    <span class="hljs-comment">//ç”±å½“å‰å˜ä½“æ‰€æµ‹è¯•çš„ä»£ç ï¼ˆåŒ…æ‹¬ä¾èµ–é¡¹ï¼‰</span><br>    TESTED_CODE(<span class="hljs-number">0x20</span>),<br>    <span class="hljs-comment">//æœ¬åœ°ä¾èµ–å’Œè¿œç¨‹ä¾èµ–çš„ JAR/AARï¼ˆprovided-onlyï¼‰</span><br>    PROVIDED_ONLY(<span class="hljs-number">0x40</span>),<br>&#125;<br></code></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ Transform å¯ä»¥åœ¨ä¸¤ä¸ªä½ç½®å®šä¹‰ Scopeï¼š</p><p><strong>1ã€Set getScopes() æ¶ˆè´¹å‹è¾“å…¥å†…å®¹èŒƒç•´ï¼š</strong> æ­¤èŒƒå›´çš„å†…å®¹ä¼šè¢«æ¶ˆè´¹ï¼Œå› æ­¤å½“å‰ Transform å¿…é¡»å°†ä¿®æ”¹åçš„å†…å®¹å¤åˆ¶åˆ° Transform çš„ä¸­é—´ç›®å½•ä¸­ï¼Œå¦åˆ™æ— æ³•å°†å†…å®¹ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª Transform å¤„ç†</p><p><strong>2ã€Set getReferencedScopes() æŒ‡å®šå¼•ç”¨å‹è¾“å…¥å†…å®¹èŒƒç•´ï¼š</strong> é»˜è®¤æ˜¯ç©ºé›†åˆï¼Œæ­¤èŒƒå›´çš„å†…å®¹ä¸ä¼šè¢«æ¶ˆè´¹ï¼Œå› æ­¤ä¸éœ€è¦å¤åˆ¶ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª Transformï¼Œä¹Ÿä¸å…è®¸ä¿®æ”¹ã€‚</p><p>çœ‹ä¸€çœ¼ TransformManager ç»™æˆ‘ä»¬å†…ç½®çš„ Scope é›†åˆï¼Œå¸¸ç”¨çš„æ˜¯ SCOPE_FULL_PROJECT ã€‚<strong>éœ€è¦æ³¨æ„ï¼ŒLibrary æ¨¡å—æ³¨å†Œçš„ Transform åªèƒ½ä½¿ç”¨ Scope.PROJECT</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ScopeType&gt; PROJECT_ONLY = ImmutableSet.of(Scope.PROJECT);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;ScopeType&gt; SCOPE_FULL_PROJECT = ImmutableSet.of(Scope.PROJECT, Scope.SUB_PROJECTS, Scope.EXTERNAL_LIBRARIES);<br></code></pre></td></tr></table></figure><h3 id="3-5ã€isIncremental"><a href="#3-5ã€isIncremental" class="headerlink" title="3.5ã€isIncremental"></a>3.5ã€isIncremental</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isIncremental</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>isIncremental æ–¹æ³•ä¸»è¦ç”¨äºè·å–æ˜¯å¦æ˜¯å¢é‡ç¼–è¯‘ï¼Œtrueï¼šæ˜¯ï¼Œ falseï¼šå¦ã€‚ä¸€ä¸ªè‡ªå®šä¹‰ Transform åº”è¯¥å°½å¯èƒ½æ”¯æŒå¢é‡ç¼–è¯‘ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœä¸€äº›ç¼–è¯‘çš„æ—¶é—´å’Œèµ„æºï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸€ä¼šå•ç‹¬è®²</p><h3 id="3-6ã€transform"><a href="#3-6ã€transform" class="headerlink" title="3.6ã€transform"></a>3.6ã€transform</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(transformInvocation: <span class="hljs-type">TransformInvocation</span>?)</span></span> &#123;<br>    <span class="hljs-keyword">super</span>.transform(transformInvocation)<br>&#125;<br></code></pre></td></tr></table></figure><p>transform æ–¹æ³•ä¸»è¦ç”¨äºå¯¹è¾“å…¥çš„æ•°æ®åšæ£€ç´¢æ“ä½œï¼Œå®ƒæ˜¯ Transform çš„æ ¸å¿ƒæ–¹æ³•ï¼Œæ–¹æ³•çš„å‚æ•°æ˜¯ TransformInvocationï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæä¾›äº†æ‰€æœ‰ä¸è¾“å…¥è¾“å‡ºç›¸å…³çš„ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TransformInvocation</span> &#123;<br><br>    <span class="hljs-comment">//...</span><br><br>    <span class="hljs-comment">// æ¶ˆè´¹å‹è¾“å…¥å†…å®¹</span><br>    Collection&lt;TransformInput&gt; <span class="hljs-title function_">getInputs</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// å¼•ç”¨å‹è¾“å…¥å†…å®¹</span><br>    Collection&lt;TransformInput&gt; <span class="hljs-title function_">getReferencedInputs</span><span class="hljs-params">()</span>;<br>  <br>    <span class="hljs-comment">//...</span><br><br>    <span class="hljs-comment">// è¾“å‡ºä¿¡æ¯</span><br>    TransformOutputProvider <span class="hljs-title function_">getOutputProvider</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// æ˜¯å¦å¢é‡æ„å»º</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isIncremental</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>1ã€<strong>isIncremental()ï¼š</strong> å½“å‰ Transform ä»»åŠ¡æ˜¯å¦å¢é‡æ„å»ºï¼›</p><p>2ã€<strong>getInputs()ï¼š</strong> è·å– TransformInput å¯¹è±¡ï¼Œå®ƒæ˜¯æ¶ˆè´¹å‹è¾“å…¥å†…å®¹ï¼Œå¯¹åº”äº Transform#getScopes() å®šä¹‰çš„èŒƒå›´ï¼›</p><p>3ã€<strong>getReferencedInputs()ï¼š</strong> è·å– TransformInput å¯¹è±¡ï¼Œå®ƒæ˜¯å¼•ç”¨å‹è¾“å…¥å†…å®¹ï¼Œå¯¹åº”äº Transform#getReferenceScope() å®šä¹‰çš„å†…å®¹èŒƒå›´ï¼›</p><p>4ã€<strong>getOutPutProvider()ï¼š</strong> TransformOutputProvider æ˜¯å¯¹è¾“å‡ºæ–‡ä»¶çš„æŠ½è±¡ã€‚</p></blockquote><p>è¾“å…¥å†…å®¹ TransformInput ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><p>1ã€<strong>DirectoryInput é›†åˆï¼š</strong> ä»¥æºç æ–¹å¼å‚ä¸æ„å»ºçš„è¾“å…¥æ–‡ä»¶ï¼ŒåŒ…æ‹¬å®Œæ•´çš„æºç ç›®å½•ç»“æ„åŠå…¶ä¸­çš„æºç æ–‡ä»¶ï¼›</p><p>2ã€<strong>JarInput é›†åˆï¼š</strong> ä»¥ jar å’Œ aar ä¾èµ–æ–¹å¼å‚ä¸æ„å»ºçš„è¾“å…¥æ–‡ä»¶ï¼ŒåŒ…å«æœ¬åœ°ä¾èµ–å’Œè¿œç¨‹ä¾èµ–ã€‚</p><p>è¾“å‡ºå†…å®¹ TransformOutputProvider æœ‰ä¸¤ä¸ªä¸»è¦åŠŸèƒ½ï¼š</p><p>1ã€<strong>deleteAll()ï¼š</strong> å½“ Transform è¿è¡Œåœ¨éå¢é‡æ„å»ºæ¨¡å¼æ—¶ï¼Œéœ€è¦åˆ é™¤ä¸Šä¸€æ¬¡æ„å»ºäº§ç”Ÿçš„æ‰€æœ‰ä¸­é—´æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ deleteAll() å®Œæˆï¼›</p><p>2ã€<strong>getContentLocation()ï¼š</strong> è·å¾—æŒ‡å®šèŒƒå›´+ç±»å‹çš„è¾“å‡ºç›®æ ‡è·¯å¾„ã€‚</p><h2 id="å››ã€Transform-çš„å¢é‡ä¸å¹¶å‘"><a href="#å››ã€Transform-çš„å¢é‡ä¸å¹¶å‘" class="headerlink" title="å››ã€Transform çš„å¢é‡ä¸å¹¶å‘"></a>å››ã€Transform çš„å¢é‡ä¸å¹¶å‘</h2><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œçœ‹èµ·æ¥ Transform ç”¨èµ·æ¥ä¹Ÿä¸éš¾ï¼Œä½†æ˜¯ï¼Œå¦‚æœç›´æ¥è¿™æ ·ä½¿ç”¨ï¼Œä¼šå¤§å¤§æ‹–æ…¢ç¼–è¯‘æ—¶é—´ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‘¸ç´¢äº†ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå€Ÿé‰´äº†Android ç¼–è¯‘å™¨ä¸­ Desugar ç­‰å‡ ä¸ª Transform çš„å®ç°ï¼Œå‘ç°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¢é‡ç¼–è¯‘ï¼Œå¹¶ä¸”ä¸Šé¢ transform æ–¹æ³•éå†å¤„ç†æ¯ä¸ªjar&#x2F;class çš„æµç¨‹ï¼Œå…¶å®å¯ä»¥å¹¶å‘å¤„ç†ï¼ŒåŠ ä¸Šä¸€èˆ¬ç¼–è¯‘æµç¨‹éƒ½æ˜¯åœ¨ PC ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°½é‡æ•²è¯ˆæœºå™¨çš„èµ„æºã€‚</p><p>ä¸Šé¢ä¹Ÿè®²äº†ï¼Œæƒ³è¦å¼€å¯å¢é‡ç¼–è¯‘ï¼Œåªéœ€è¦é‡å†™ Transform çš„è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å› true å³å¯ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isIncremental</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-comment">//å¼€å¯å¢é‡ç¼–è¯‘</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å—¯ï¼Œæ²¡äº†ï¼Œå·²ç»å¼€å¯äº†ğŸ˜„ã€‚æœ‰è¿™ä¹ˆç®€å•å°±å¥½äº†ï¼Œè¨€å½’æ­£ä¼ ï¼š</p><p>1ã€å¦‚æœä¸æ˜¯å¢é‡ç¼–è¯‘ï¼Œåˆ™ä¼šæ¸…ç©º output ç›®å½•ï¼Œç„¶åæŒ‰ç…§å‰é¢çš„æ–¹å¼ï¼Œé€ä¸ªå¤„ç† class&#x2F;jar ã€‚</p><p>2ã€å¦‚æœæ˜¯å¢é‡ç¼–è¯‘ï¼Œåˆ™ä¼šæ£€æŸ¥æ¯ä¸ªæ–‡ä»¶çš„ Statusï¼ŒStatus åˆ†å››ç§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Status</span> &#123;<br><br>    <span class="hljs-comment">// æœªä¿®æ”¹ï¼Œä¸éœ€è¦å¤„ç†ï¼Œä¹Ÿä¸éœ€è¦å¤åˆ¶æ“ä½œ</span><br>    NOTCHANGED,<br>    <br>    <span class="hljs-comment">// æ–°å¢ï¼Œæ­£å¸¸å¤„ç†å¹¶å¤åˆ¶ç»™ä¸‹ä¸€ä¸ªä»»åŠ¡</span><br>    ADDED,<br>    <br>    <span class="hljs-comment">// å·²ä¿®æ”¹ï¼Œæ­£å¸¸å¤„ç†å¹¶å¤åˆ¶ç»™ä¸‹ä¸€ä¸ªä»»åŠ¡</span><br>    CHANGED,<br><br>    <span class="hljs-comment">// å·²åˆ é™¤ï¼Œéœ€åŒæ­¥ç§»é™¤ OutputProvider æŒ‡å®šçš„ç›®æ ‡æ–‡ä»¶</span><br>    REMOVED;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä¸åŒçš„ Status å¤„ç†é€»è¾‘å³å¯</p><p>3ã€å®ç°å¢é‡ç¼–è¯‘åï¼Œæˆ‘ä»¬æœ€å¥½ä¹Ÿæ”¯æŒå¹¶å‘ç¼–è¯‘ï¼Œå¹¶å‘ç¼–è¯‘çš„å®ç°å¹¶ä¸å¤æ‚ï¼ŒåŸç†ï¼šå¯¹ä¸Šé¢å¤„ç†å•ä¸ª class&#x2F;jar çš„é€»è¾‘è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œæœ€åé˜»å¡ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸå³å¯</p><h3 id="4-1ã€è‡ªå®šä¹‰-Tranform-æ¨¡ç‰ˆ"><a href="#4-1ã€è‡ªå®šä¹‰-Tranform-æ¨¡ç‰ˆ" class="headerlink" title="4.1ã€è‡ªå®šä¹‰ Tranform æ¨¡ç‰ˆ"></a>4.1ã€è‡ªå®šä¹‰ Tranform æ¨¡ç‰ˆ</h3><p>æ•´ä¸ª Transform çš„æ ¸å¿ƒè¿‡ç¨‹æ˜¯æœ‰å›ºå®šå¥—è·¯çš„ï¼Œæ¨¡æ¿æµç¨‹å¼•å…¥<a href="https://rebooters.github.io/2020/01/04/Gradle-Transform-ASM-%E6%8E%A2%E7%B4%A2/">è¯—ä¸è¿œæ–¹</a>çš„ä¸€å¼ å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/de688e827f1243ceafd98d912dcc6524~tplv-k3u1fbpfcp-watermark.image?" alt="transforms.png" width="50%" /><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æŒ‰ç…§ä¸Šé¢è¿™å¼ å›¾ï¼Œæ¥å¤„ç† Transform çš„å¢é‡å’Œå¹¶å‘ï¼Œå¹¶å°è£…ä¸€å¥—é€šç”¨çš„æ¨¡ç‰ˆä»£ç ï¼Œä¸‹é¢æ¨¡ç‰ˆå†™äº†è¯¦ç»†çš„æ³¨é‡Šï¼š</p><p><strong>æ³¨æ„</strong>ï¼šWaitableExecutor åœ¨ AGP 7.0 ä¸­å·²ç»å¼•ç”¨ä¸åˆ°äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ·»åŠ <a href="https://github.com/sweetying520/GradleTransformDemo/blob/master/customtransformplugin/src/main/java/com/dream/customtransformplugin/WaitableExecutor.java">WaitableExecutoræºç </a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseCustomTransform</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> enableLog: <span class="hljs-built_in">Boolean</span>) : Transform() &#123;<br><br>    <span class="hljs-comment">//çº¿ç¨‹æ± ï¼Œå¯æå‡ 80% çš„æ‰§è¡Œé€Ÿåº¦</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> waitableExecutor: WaitableExecutor = WaitableExecutor.useGlobalSharedThreadPool()<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ­¤æ–¹æ³•æä¾›ç»™ä¸Šå±‚è¿›è¡Œå­—èŠ‚ç æ’æ¡©</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">provideFunction</span><span class="hljs-params">()</span></span>: ((InputStream, OutputStream) -&gt; <span class="hljs-built_in">Unit</span>)?<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸Šå±‚å¯é‡å†™è¯¥æ–¹æ³•è¿›è¡Œæ–‡ä»¶è¿‡æ»¤</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">classFilter</span><span class="hljs-params">(className: <span class="hljs-type">String</span>)</span></span> = className.endsWith(SdkConstants.DOT_CLASS)<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é»˜è®¤ï¼šè·å–è¾“å…¥çš„å­—èŠ‚ç æ–‡ä»¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInputTypes</span><span class="hljs-params">()</span></span>: MutableSet&lt;QualifiedContent.ContentType&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.CONTENT_CLASS<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é»˜è®¤ï¼šæ£€ç´¢æ•´ä¸ªé¡¹ç›®çš„å†…å®¹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScopes</span><span class="hljs-params">()</span></span>: MutableSet&lt;<span class="hljs-keyword">in</span> QualifiedContent.Scope&gt; &#123;<br>        <span class="hljs-keyword">return</span> TransformManager.SCOPE_FULL_PROJECT<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é»˜è®¤å¼€å¯å¢é‡ç¼–è¯‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isIncremental</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¯¹è¾“å…¥çš„æ•°æ®åšæ£€ç´¢æ“ä½œï¼š</span><br><span class="hljs-comment">     * 1ã€å¤„ç†å¢é‡ç¼–è¯‘</span><br><span class="hljs-comment">     * 2ã€å¤„ç†å¹¶å‘é€»è¾‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(transformInvocation: <span class="hljs-type">TransformInvocation</span>)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.transform(transformInvocation)<br><br>        log(<span class="hljs-string">&quot;Transform start...&quot;</span>)<br><br>        <span class="hljs-comment">//è¾“å…¥å†…å®¹</span><br>        <span class="hljs-keyword">val</span> inputProvider = transformInvocation.inputs<br>        <span class="hljs-comment">//è¾“å‡ºå†…å®¹</span><br>        <span class="hljs-keyword">val</span> outputProvider = transformInvocation.outputProvider<br><br>        <span class="hljs-comment">// 1. å­ç±»å®ç°å­—èŠ‚ç æ’æ¡©æ“ä½œ</span><br>        <span class="hljs-keyword">val</span> function = provideFunction()<br><br>        <span class="hljs-comment">// 2. ä¸æ˜¯å¢é‡ç¼–è¯‘ï¼Œåˆ é™¤æ‰€æœ‰æ—§çš„è¾“å‡ºå†…å®¹</span><br>        <span class="hljs-keyword">if</span> (!transformInvocation.isIncremental) &#123;<br>            outputProvider.deleteAll()<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (input <span class="hljs-keyword">in</span> inputProvider) &#123;<br>            <span class="hljs-comment">// 3. Jar åŒ…å¤„ç†</span><br>            log(<span class="hljs-string">&quot;Transform jarInputs start.&quot;</span>)<br>            <span class="hljs-keyword">for</span> (jarInput <span class="hljs-keyword">in</span> input.jarInputs) &#123;<br>                <span class="hljs-keyword">val</span> inputJar = jarInput.file<br>                <span class="hljs-keyword">val</span> outputJar = outputProvider.getContentLocation(jarInput.name, jarInput.contentTypes, jarInput.scopes, Format.JAR)<br>                <span class="hljs-keyword">if</span> (transformInvocation.isIncremental) &#123;<br>                    <span class="hljs-comment">// 3.1. å¢é‡ç¼–è¯‘ä¸­å¤„ç† Jar åŒ…é€»è¾‘</span><br>                    <span class="hljs-keyword">when</span> (jarInput.status ?: Status.NOTCHANGED) &#123;<br>                        Status.NOTCHANGED -&gt; &#123;<br>                            <span class="hljs-comment">// Do nothing.</span><br>                        &#125;<br>                        Status.ADDED, Status.CHANGED -&gt; &#123;<br>                            <span class="hljs-comment">// Do transform.</span><br>                            waitableExecutor.execute &#123;<br>                                doTransformJar(inputJar, outputJar, function)<br>                            &#125;<br>                        &#125;<br>                        Status.REMOVED -&gt; &#123;<br>                            <span class="hljs-comment">// Delete.</span><br>                            FileUtils.delete(outputJar)<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// 3.2 éå¢é‡ç¼–è¯‘ä¸­å¤„ç† Jar åŒ…é€»è¾‘</span><br>                    waitableExecutor.execute &#123;<br>                        doTransformJar(inputJar, outputJar, function)<br>                    &#125;<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// 4. æ–‡ä»¶å¤¹å¤„ç†</span><br>            log(<span class="hljs-string">&quot;Transform dirInput start.&quot;</span>)<br>            <span class="hljs-keyword">for</span> (dirInput <span class="hljs-keyword">in</span> input.directoryInputs) &#123;<br>                <span class="hljs-keyword">val</span> inputDir = dirInput.file<br>                <span class="hljs-keyword">val</span> outputDir = outputProvider.getContentLocation(dirInput.name, dirInput.contentTypes, dirInput.scopes, Format.DIRECTORY)<br>                <span class="hljs-keyword">if</span> (transformInvocation.isIncremental) &#123;<br>                    <span class="hljs-comment">// 4.1. å¢é‡ç¼–è¯‘ä¸­å¤„ç†æ–‡ä»¶å¤¹é€»è¾‘</span><br>                    <span class="hljs-keyword">for</span> ((inputFile, status) <span class="hljs-keyword">in</span> dirInput.changedFiles) &#123;<br>                        <span class="hljs-keyword">val</span> outputFile = concatOutputFilePath(outputDir, inputFile)<br>                        <span class="hljs-keyword">when</span> (status ?: Status.NOTCHANGED) &#123;<br>                            Status.NOTCHANGED -&gt; &#123;<br>                                <span class="hljs-comment">// Do nothing.</span><br>                            &#125;<br>                            Status.ADDED, Status.CHANGED -&gt; &#123;<br>                                <span class="hljs-comment">// Do transform.</span><br>                                waitableExecutor.execute &#123;<br>                                    doTransformFile(inputFile, outputFile, function)<br>                                &#125;<br>                            &#125;<br>                            Status.REMOVED -&gt; &#123;<br>                                <span class="hljs-comment">// Delete</span><br>                                FileUtils.delete(outputFile)<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// 4.2. éå¢é‡ç¼–è¯‘ä¸­å¤„ç†æ–‡ä»¶å¤¹é€»è¾‘</span><br>                    <span class="hljs-comment">// Traversal fileTree (depthFirstPreOrder).</span><br>                    <span class="hljs-keyword">for</span> (inputFile <span class="hljs-keyword">in</span> FileUtils.getAllFiles(inputDir)) &#123;<br>                        waitableExecutor.execute &#123;<br>                            <span class="hljs-keyword">val</span> outputFile = concatOutputFilePath(outputDir, inputFile)<br>                            <span class="hljs-keyword">if</span> (classFilter(inputFile.name)) &#123;<br>                                doTransformFile(inputFile, outputFile, function)<br>                            &#125; <span class="hljs-keyword">else</span> &#123;<br>                                <span class="hljs-comment">// Copy.</span><br>                                Files.createParentDirs(outputFile)<br>                                FileUtils.copyFile(inputFile, outputFile)<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        waitableExecutor.waitForTasksWithQuickFail&lt;Any&gt;(<span class="hljs-literal">true</span>)<br>        log(<span class="hljs-string">&quot;Transform end...&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Do transform Jar.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doTransformJar</span><span class="hljs-params">(inputJar: <span class="hljs-type">File</span>, outputJar: <span class="hljs-type">File</span>, function: ((<span class="hljs-type">InputStream</span>, <span class="hljs-type">OutputStream</span>) -&gt; <span class="hljs-type">Unit</span>)?)</span></span> &#123;<br>        <span class="hljs-comment">// Create parent directories to hold outputJar file.</span><br>        Files.createParentDirs(outputJar)<br>        <span class="hljs-comment">// Unzip.</span><br>        FileInputStream(inputJar).use &#123; fis -&gt;<br>            ZipInputStream(fis).use &#123; zis -&gt;<br>                <span class="hljs-comment">// Zip.</span><br>                FileOutputStream(outputJar).use &#123; fos -&gt;<br>                    ZipOutputStream(fos).use &#123; zos -&gt;<br>                        <span class="hljs-keyword">var</span> entry = zis.nextEntry<br>                        <span class="hljs-keyword">while</span> (entry != <span class="hljs-literal">null</span> &amp;&amp; isValidZipEntryName(entry)) &#123;<br>                            <span class="hljs-keyword">if</span> (!entry.isDirectory) &#123;<br>                                zos.putNextEntry(ZipEntry(entry.name))<br>                                <span class="hljs-keyword">if</span> (classFilter(entry.name)) &#123;<br>                                    <span class="hljs-comment">// Apply transform function.</span><br>                                    applyFunction(zis, zos, function)<br>                                &#125; <span class="hljs-keyword">else</span> &#123;<br>                                    <span class="hljs-comment">// Copy.</span><br>                                    zis.copyTo(zos)<br>                                &#125;<br>                            &#125;<br>                            entry = zis.nextEntry<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Do transform file.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doTransformFile</span><span class="hljs-params">(inputFile: <span class="hljs-type">File</span>, outputFile: <span class="hljs-type">File</span>, function: ((<span class="hljs-type">InputStream</span>, <span class="hljs-type">OutputStream</span>) -&gt; <span class="hljs-type">Unit</span>)?)</span></span> &#123;<br>        <span class="hljs-comment">// Create parent directories to hold outputFile file.</span><br>        Files.createParentDirs(outputFile)<br>        FileInputStream(inputFile).use &#123; fis -&gt;<br>            FileOutputStream(outputFile).use &#123; fos -&gt;<br>                <span class="hljs-comment">// Apply transform function.</span><br>                applyFunction(fis, fos, function)<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">applyFunction</span><span class="hljs-params">(input: <span class="hljs-type">InputStream</span>, output: <span class="hljs-type">OutputStream</span>, function: ((<span class="hljs-type">InputStream</span>, <span class="hljs-type">OutputStream</span>) -&gt; <span class="hljs-type">Unit</span>)?)</span></span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != function) &#123;<br>                function.invoke(input, output)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// Copy</span><br>                input.copyTo(output)<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (e: UncheckedIOException) &#123;<br>            <span class="hljs-keyword">throw</span> e.cause!!<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºè¾“å‡ºçš„æ–‡ä»¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">concatOutputFilePath</span><span class="hljs-params">(outputDir: <span class="hljs-type">File</span>, inputFile: <span class="hljs-type">File</span>)</span></span> = File(outputDir, inputFile.name)<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * log æ‰“å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">log</span><span class="hljs-params">(logStr: <span class="hljs-type">String</span>)</span></span> &#123;<br>        <span class="hljs-keyword">if</span> (enableLog) &#123;<br>            println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> - <span class="hljs-variable">$logStr</span>&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æ¨¡ç‰ˆç»™æˆ‘ä»¬åšäº†å¤§é‡å·¥ä½œï¼š Trasform çš„è¾“å…¥æ–‡ä»¶éå†ã€åŠ è§£å‹ã€å¢é‡ï¼Œå¹¶å‘ç­‰ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸“æ³¨å­—èŠ‚ç æ–‡ä»¶çš„ä¿®æ”¹å³å¯</p><h2 id="äº”ã€è‡ªå®šä¹‰æ¨¡ç‰ˆä½¿ç”¨"><a href="#äº”ã€è‡ªå®šä¹‰æ¨¡ç‰ˆä½¿ç”¨" class="headerlink" title="äº”ã€è‡ªå®šä¹‰æ¨¡ç‰ˆä½¿ç”¨"></a>äº”ã€è‡ªå®šä¹‰æ¨¡ç‰ˆä½¿ç”¨</h2><p>okï¼Œæ¥ä¸‹æ¥ä¿®æ”¹è‡ªå®šä¹‰ Gradle Transform çš„ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.dream.customtransformplugin<br><br><span class="hljs-keyword">import</span> java.io.InputStream<br><span class="hljs-keyword">import</span> java.io.OutputStream<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * function: è‡ªå®šä¹‰ Transform</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomTransform</span>: <span class="hljs-type">BaseCustomTransform</span>(<span class="hljs-literal">true</span>) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ErdaiTransform&quot;</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ­¤æ–¹æ³•å¯ä»¥ä½¿ç”¨ ASM æˆ– Javassist è¿›è¡Œå­—èŠ‚ç æ’æ¡©</span><br><span class="hljs-comment">     * ç›®å‰åªæ˜¯ä¸€ä¸ªé»˜è®¤å®ç°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">provideFunction</span><span class="hljs-params">()</span></span> = &#123; ios: InputStream, zos: OutputStream -&gt;                         <br>        zos.write(ios.readAllBytes())<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯ç¬é—´æ¸…çˆ½äº†å¾ˆå¤šï¼Œå‘å¸ƒä¸€ä¸ªæ–°çš„æ’ä»¶ç‰ˆæœ¬ï¼Œä¿®æ”¹æ ¹ build.gradle æ’ä»¶çš„ç‰ˆæœ¬ï¼ŒåŒæ­¥åé‡æ–°è¿è¡Œ appï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b1ec726c58d413893c2675e607971bd~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221029150353716.png" width="100%" /><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†ï¼š</p><p>1ã€Gradle Transform æ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>ç®€å•çš„ç†è§£ï¼šæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ Gradle Transform ä¿®æ”¹å­—èŠ‚ç æ–‡ä»¶å®ç°ç¼–è¯‘æ’æ¡©</p></blockquote><p>2ã€ä½¿ç”¨ Kotlin ç¼–å†™è‡ªå®šä¹‰ Gradle Transform çš„æµç¨‹ï¼Œæ³¨æ„å’Œ Groovy ç¼–å†™æ’ä»¶çš„åŒºåˆ«</p><blockquote><p>1ã€Kotlin ç¼–å†™æ’ä»¶å¯ç›´æ¥å†™åœ¨ src&#x2F;main&#x2F;java ç›®å½•ä¸‹</p><p>2ã€Groovy ç¼–å†™æ’ä»¶éœ€å†™åœ¨ src&#x2F;main&#x2F;groovy ç›®å½•ä¸‹</p></blockquote><p>3ã€ä»‹ç»äº† Transform çš„æ•°æ®æµåŠ¨å’Œè‡ªå®šä¹‰ Gradle Transform å®ç°çš„ç›¸å…³ Api</p><p>4ã€ä»‹ç»äº† Transform çš„å¢é‡ä¸å¹¶å‘ï¼Œå¹¶å°è£…äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼Œç®€åŒ–æˆ‘ä»¬è‡ªå®šä¹‰ Gradle Transform çš„ä½¿ç”¨</p><p>å¦å¤–ï¼Œæœ¬ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬åªæ˜¯è®²äº† Gradle Transform ç®€å•ä½¿ç”¨ï¼Œè¿˜æ²¡æœ‰åšå…·ä½“çš„æ’æ¡©é€»è¾‘ï¼Œå› æ­¤å‰è¨€ä¸­çš„é—®é¢˜æš‚æ—¶è¿˜è§£å†³ä¸äº†</p><p>é¢„çŸ¥åäº‹å¦‚ä½•ï¼Œè¯·å¬ä¸‹å›åˆ†è§£</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><a href="https://github.com/sweetying520/GradleTransformDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥ç»“åˆ demo ä¸€èµ·çœ‹ï¼Œæ•ˆæœæ æ æ»´ğŸº</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/7098752199575994405#heading-17">Gradle ç³»åˆ—ï¼ˆ8ï¼‰å…¶å® Gradle Transform å°±æ˜¯ä¸ªçº¸è€è™</a></p><p><a href="https://rebooters.github.io/2020/01/04/Gradle-Transform-ASM-%E6%8E%A2%E7%B4%A2/">Gradle Transform + ASM æ¢ç´¢</a></p><p><a href="https://developer.android.com/studio/releases/gradle-plugin?hl=zh-cn">Android Gradle æ’ä»¶ç‰ˆæœ¬è¯´æ˜</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android é€†å‘ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šåç¼–è¯‘ APK æŠ€æœ¯å®Œå…¨è§£æ</title>
    <link href="/2022/10/21/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%8F%8D%E7%BC%96%E8%AF%91%20APK%20%E6%8A%80%E6%9C%AF%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/10/21/Android%20%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%8F%8D%E7%BC%96%E8%AF%91%20APK%20%E6%8A%80%E6%9C%AF%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ab04bb7513747959b3401bd60266181~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åç¼–è¯‘ apk å»æŸ¥çœ‹æˆ–åˆ†æä¸€äº›é—®é¢˜ï¼Œå¦‚ï¼š</p><p>1ã€è¿™ä¸ª app æ•ˆæœæŒºé…·çš„å•Šï¼Œæ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿæ­¤æ—¶ä½ å°±å¯ä»¥åç¼–è¯‘çœ‹ä¸‹å®ƒçš„å¸ƒå±€å’Œä»£ç å®ç°</p><p>2ã€è¿™ä¸ª app é‡Œé¢çš„èµ„æºæŒºå¤šçš„å•Šï¼Œæˆ‘æƒ³æ‹¿è¿‡æ¥ç”¨ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥åç¼–è¯‘å»æ‹¿è¿™ä¸ª app é‡Œé¢çš„èµ„æº</p><p>3ã€ä½¿ç”¨ aop åœ¨ä¸€ä¸ªç±»é‡Œé¢æ’å…¥äº†ä¸€äº›ä»£ç ï¼Œæƒ³éªŒè¯ä¸€ä¸‹ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥åç¼–è¯‘æŸ¥çœ‹æ˜¯å¦æŒ‰ç…§ä½ çš„é¢„æœŸæ’å…¥äº†ä»£ç </p><p>4ã€æˆ‘æƒ³æ”¹å§æ”¹å§è¿™ä¸ª app ï¼Œä¾‹å¦‚æ›¿æ¢å®ƒçš„ app iconï¼Œæ›¿æ¢é‡Œé¢çš„ç¿»è¯‘ï¼Œapp æ±‰åŒ–ç­‰ç­‰ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥åç¼–è¯‘ä¿®æ”¹ï¼Œç„¶åæ‰“æˆä¸€ä¸ªæ–°çš„ apk å‘å¸ƒï¼ˆè¿™ç§å¤§å®¶çŸ¥é“å°±å¥½ï¼Œåƒä¸‡åˆ«å»åšå•¥åäº‹ï¼‰</p><p>ä¸Šé¢åˆ—ä¸¾çš„ 4 ç§åœºæ™¯åŸºæœ¬å¯ä»¥è¦†ç›–æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ­£å¼è¿›å…¥ APK åç¼–è¯‘æŠ€æœ¯çš„è®²è§£</p><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢æ¼”ç¤ºå‡æ˜¯åœ¨ mac ä¸‹è¿›è¡Œ</p><h2 id="ä¸€ã€åç¼–è¯‘å·¥å…·ä»‹ç»"><a href="#ä¸€ã€åç¼–è¯‘å·¥å…·ä»‹ç»" class="headerlink" title="ä¸€ã€åç¼–è¯‘å·¥å…·ä»‹ç»"></a>ä¸€ã€åç¼–è¯‘å·¥å…·ä»‹ç»</h2><p>å¦‚æœæˆ‘ä»¬åªæ˜¯éœ€è¦ app ä¸­çš„å›¾ç‰‡èµ„æºï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ <code>xxx.apk</code>çš„åç¼€ä¸º <code>xxx.zip</code>ï¼Œè§£å‹åçš„æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f3fe2ed61584c35a6b6284902e7f1d1~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022210917119.png"></p><p>æ‰€æœ‰çš„ä»£ç å¤„äº <code>classes.dex</code> ä¸­ï¼Œå›¾ç‰‡å¸ƒå±€ç­‰èµ„æºå¤„äº res ç›®å½•ä¸‹ã€‚æ­¤æ—¶ä½ å¯ä»¥ç›´æ¥å» res ç›®å½•ä¸‹å¤åˆ¶å›¾ç‰‡èµ„æºä½¿ç”¨ï¼Œä½†æ˜¯ä½ å»æ‰“å¼€ AndroidManifest.xml æ–‡ä»¶å’Œ activity_main.xml æ–‡ä»¶ï¼Œä¼šå‘ç°çœ‹ä¸æ‡‚</p><p>AndroidManifest.xml æ–‡ä»¶ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44b5736525c345898c4ab5e7638202ff~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221022175713114.png" width="50%" /><p>activity_main.xml æ–‡ä»¶ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01ccf592ea8f48f8bcfd793c47a63da2~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221022175816393.png" width="50%" /><p>å°±æ˜¯ä¸€æ¨æ•´é½æ’åˆ—çš„ 16 è¿›åˆ¶æ•°ï¼Œé‚£å¦‚æœæˆ‘æƒ³çœ‹æ‡‚è¦æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>ç­”ï¼šä½¿ç”¨ apktool</p><h3 id="1-1ã€apktool"><a href="#1-1ã€apktool" class="headerlink" title="1.1ã€apktool"></a>1.1ã€apktool</h3><p>ä½œç”¨ï¼šåç¼–è¯‘ APK ä¸­çš„èµ„æº</p><p>ä¸‹è½½é“¾æ¥ï¼š<a href="https://ibotpeaches.github.io/Apktool/install/">https://ibotpeaches.github.io/Apktool/install/</a></p><p>æ‰“å¼€ä¸‹è½½é“¾æ¥ä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ef9157c45414b0ca8143fee8e98d327~tplv-k3u1fbpfcp-watermark.image" alt="image-20221021173948270.png"></p><p>mac å»ºè®®ä½¿ç”¨çº¢æ¡†ä¸­çš„ Homebrew å»å®‰è£…ï¼Œæ‰§è¡Œ <code>brew install apktool</code> å‘½ä»¤ä¸€é”®å®‰è£…ï¼Œå®ƒä¼šè‡ªåŠ¨ç»™ä½ é…ç½®å¥½ç¯å¢ƒå˜é‡ä»¥åŠå¢åŠ æ–‡ä»¶çš„æ“ä½œæƒé™</p><p>å®‰è£…å®Œæˆåï¼Œè¾“å…¥<code>apktool</code>å‘½ä»¤ ï¼Œå¦‚æœå±•ç¤ºäº† apktool ç›¸å…³ä¿¡æ¯è¯æ˜ä½ é…ç½®æˆåŠŸäº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cc044f1b08334ca8aa8dcbf285e236d8~tplv-k3u1fbpfcp-watermark.image" alt="image-20221021174740419.png"></p><h4 id="1-1-1ã€apktool-ä½¿ç”¨"><a href="#1-1-1ã€apktool-ä½¿ç”¨" class="headerlink" title="1.1.1ã€apktool ä½¿ç”¨"></a>1.1.1ã€apktool ä½¿ç”¨</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ apktool æ¥åç¼–è¯‘ apk ä¸­çš„èµ„æº</p><p>1ã€å…ˆå‡†å¤‡ä¸€ä¸ª apk æ–‡ä»¶</p><p>2ã€æ‰§è¡Œ <code>apktool d xxx.apk</code> å‘½ä»¤</p><p>å…¶ä¸­ d æ˜¯ decode çš„æ„æ€ï¼Œè¡¨ç¤ºæˆ‘ä»¬è¦å¯¹ xxx.apk è¿›è¡Œè§£ç ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†åŠ ä¸Šä¸€äº›é™„åŠ å‚æ•°æ¥æ§åˆ¶ decode çš„æ›´å¤šè¡Œä¸ºï¼š</p><blockquote><p>-f ï¼šå¦‚æœç›®æ ‡æ–‡ä»¶å¤¹å·²å­˜åœ¨ï¼Œåˆ™å¼ºåˆ¶åˆ é™¤ç°æœ‰æ–‡ä»¶å¤¹ï¼ˆé»˜è®¤å¦‚æœç›®æ ‡æ–‡ä»¶å¤¹å·²å­˜åœ¨ï¼Œåˆ™è§£ç å¤±è´¥ï¼‰</p><p>-o ï¼šæŒ‡å®šè§£ç ç›®æ ‡æ–‡ä»¶å¤¹çš„åç§°ï¼ˆé»˜è®¤ä½¿ç”¨ APK æ–‡ä»¶çš„åå­—æ¥å‘½åç›®æ ‡æ–‡ä»¶å¤¹ï¼‰</p><p>-s ï¼šä¸åç¼–è¯‘dexæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ classes.dex æ–‡ä»¶ä¼šè¢«ä¿ç•™ï¼ˆé»˜è®¤ä¼šå°† dex æ–‡ä»¶è§£ç æˆ smali æ–‡ä»¶ï¼‰</p><p>-r ï¼šä¸åç¼–è¯‘èµ„æºæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ resources.arsc æ–‡ä»¶ä¼šè¢«ä¿ç•™ï¼ˆé»˜è®¤ä¼šå°† resources.arsc è§£ç æˆå…·ä½“çš„èµ„æºæ–‡ä»¶ï¼‰</p></blockquote><p>å¸¸ç”¨çš„ç”¨æ³•å°±è¿™ä¹ˆå¤šï¼Œä¸Šè¿°å‘½ä»¤çš„æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7fc82cc34d240dfb6a42bd6a9485846~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022172954424.png"></p><p>è¿™å°±è¯´æ˜åç¼–è¯‘èµ„æºæˆåŠŸäº†</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼š</p><p>1ã€ä¸Šè¿° <code>app-debug.apk</code>ï¼Œmac çš„ terminal ä¼šè‡ªåŠ¨æ·»åŠ  <code>.zip</code> åç¼€ï¼Œå¤§å®¶åˆ«ç»™è¯¯å¯¼äº†å“ˆ</p><p>2ã€å¦å¤–ç”Ÿæˆçš„æ–‡ä»¶å¤¹ä¼šåœ¨ <code>apk-debug.apk.zip</code> çš„åŸºç¡€ä¸Šåœ¨å¢åŠ  <code>.out</code> åç¼€ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2c1a1eabc75446b95c4335552378e7d~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022173342679.png"></p><p>è¿™ç§ç°è±¡å’Œ windows ç³»ç»Ÿè¡¨ç°ä¸å¤ªä¸€æ ·ï¼Œå¤§å®¶æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœçœ‹ç€ä¸çˆ½ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šè¿°è®²çš„é™„åŠ å‚æ•°<code>-o</code> ï¼Œæ¥å¯¹è¾“å‡ºçš„æ–‡ä»¶å¤¹è¿›è¡Œé‡å‘½å</p><p>3ã€å»ºè®®å¤§å®¶æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥è¿›è¡Œåç¼–è¯‘çš„æ“ä½œï¼Œä¾‹å¦‚ä¸Šé¢æˆ‘æ–°å»ºäº†ä¸€ä¸ª apktool_reverse çš„æ–‡ä»¶å¤¹ï¼Œç„¶åå°† apk èµ„æºæ”¾åˆ°ä¸‹é¢ï¼Œé€šè¿‡ terminal cd åˆ°è¿™ä¸ªç›®å½•ï¼Œæœ€åæ‰§è¡Œè§£ç çš„å‘½ä»¤</p><p>4ã€å¦‚æœæˆ‘ä»¬æ‰§è¡Œè§£ç å‘½ä»¤ <code>apktool d xxx.apk</code> æˆåŠŸåï¼Œæƒ³æ·»åŠ é™„åŠ å‚æ•°ç»§ç»­æ‰§è¡Œï¼Œå¦‚ï¼š<code>apktool d -s -r xxx.apk</code>ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/203c37f04db742c1a732b6ea631e4055~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022174758839.png"></p><p>æŠ¥é”™æç¤ºæˆ‘ä»¬è¯¥æ–‡ä»¶å¤¹å·²ç»å­˜åœ¨äº†ï¼Œå› æ­¤åœ¨è¿™ç§æ–‡ä»¶å¤¹å·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œå¤§å®¶åº”è¯¥åŠ ä¸Šé™„åŠ å‚æ•°<code>-f</code>å¼ºåˆ¶åˆ é™¤ç°æœ‰æ–‡ä»¶å¤¹</p><p>okï¼Œçœ‹ä¸€ä¸‹ apktool åç¼–è¯‘åç”Ÿæˆçš„ä¸€äº›å…·ä½“æ–‡ä»¶ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80148ce5bee2429ab1d27fa81ac091c9~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022180713615.png"></p><blockquote><p>1ã€AndroidManifest.xmlï¼šç»è¿‡åç¼–è¯‘è¿˜åŸåçš„ manifest æ–‡ä»¶</p><p>2ã€original æ–‡ä»¶å¤¹ï¼šå­˜æ”¾äº†æœªç»åç¼–è¯‘è¿‡ã€åŸå§‹çš„ AndroidManifest.xml æ–‡ä»¶</p><p>3ã€res æ–‡ä»¶å¤¹ï¼šå­˜æ”¾äº†åç¼–è¯‘å‡ºæ¥çš„æ‰€æœ‰èµ„æº</p><p>4ã€smali æ–‡ä»¶å¤¹ï¼šå­˜æ”¾äº†åç¼–è¯‘å‡ºæ¥çš„æ‰€æœ‰ä»£ç ï¼Œåªä¸è¿‡æ ¼å¼éƒ½æ˜¯<code>.smali</code>ç±»å‹çš„</p></blockquote><p>çœ‹ä¸€çœ¼åç¼–è¯‘åçš„ AndroidManifest.xml æ–‡ä»¶å’Œ activity_main.xml æ–‡ä»¶</p><p>AndroidManifest.xml æ–‡ä»¶ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f8978eadfcc846b6b4bd6db736906642~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022180343979.png"></p><p>activity_main.xml æ–‡ä»¶ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16c6072a853d4b11bf9a2d7cf7dccb75~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022180428331.png"></p><p>å·²ç»è¿˜åŸæˆæˆ‘ä»¬çœ‹å¾—æ‡‚çš„æ–‡ä»¶äº†ï¼Œæ ¼å¼å·®ç‚¹æ„æ€ï¼Œä½ å¯ä»¥å°†å†…å®¹å¤åˆ¶å‡ºæ¥æ”¾åˆ° AndroidStudio é‡Œé¢æ ¼å¼åŒ–ä¸€ä¸‹å°±å®Œç¾äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±æŠŠåç¼–è¯‘èµ„æºçš„æ–¹æ³•ç»™æŒæ¡äº†</p><p>å¦å¤–ä½¿ç”¨ apktool åç¼–è¯‘åçš„ä»£ç å¤„äº smali æ–‡ä»¶å¤¹ä¸‹ï¼Œä¸”éƒ½æ˜¯<code>.smali</code>æ ¼å¼çš„ï¼Œæˆ‘ä»¬ç®€å•æˆªå–ä¸€æ®µ MainActivity.smali æ–‡ä»¶çš„ä»£ç ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f640f3207d74456ab42724c37648f02~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022205951161.png"></p><p>å—¯ï¼Œçœ‹ä¸æ‡‚ğŸ˜‚ï¼Œå¦‚æœä½ èƒ½çœ‹å¾—æ‡‚ï¼Œé‚£ä¹ˆåšçš„äº‹æƒ…å°±å¤šäº†ï¼Œä½ å¯ä»¥éšæ„ä¿®æ”¹åº”ç”¨ç¨‹åºå†…çš„é€»è¾‘ï¼Œå°†å…¶è¿›è¡Œç ´è§£å‘å¸ƒã€‚</p><p>é‚£æ€ä¹ˆæ‰èƒ½è½¬æ¢æˆèƒ½çœ‹æ‡‚çš„ Java ä»£ç å‘¢ï¼Ÿ</p><p>ç­”ï¼šä½¿ç”¨ dex2jar + jd-gui</p><h3 id="1-2ã€dex2jar"><a href="#1-2ã€dex2jar" class="headerlink" title="1.2ã€dex2jar"></a>1.2ã€dex2jar</h3><p>ä½œç”¨ï¼šå°† dex æ–‡ä»¶è½¬æ¢æˆ jar æ–‡ä»¶</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://sourceforge.net/projects/dex2jar/files/">https://sourceforge.net/projects/dex2jar/files/</a></p><h4 id="1-1-1ã€dex2jar-ä½¿ç”¨"><a href="#1-1-1ã€dex2jar-ä½¿ç”¨" class="headerlink" title="1.1.1ã€dex2jar ä½¿ç”¨"></a>1.1.1ã€dex2jar ä½¿ç”¨</h4><p>å°†ä¸‹è½½çš„ dex2jar å‹ç¼©åŒ…è§£å‹ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9204b93487bf4ec6856e1ca5ab606649~tplv-k3u1fbpfcp-watermark.image" alt="image-20221021165416847.png"></p><p>åœ¨ mac ä¸­ä½¿ç”¨ <code>d2j-dex2jar.sh</code> æ–‡ä»¶å°± ok äº†</p><p>1ã€å°†éœ€è¦è½¬æ¢çš„ dex æ–‡ä»¶å¤åˆ¶åˆ°å½“å‰ dex2jar ç›®å½•ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43231aff34ed42d3b8b519257f6e1d46~tplv-k3u1fbpfcp-watermark.image" alt="image-20221021165712150.png"></p><p>2ã€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sh d2j-dex2jar.sh classes.dex<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ terminal ä¼šæŠ¥é”™ï¼š<strong>Permission denied</strong> </p><p>è¿™æ˜¯å› ä¸ºæ–‡ä»¶æƒé™ä¸è¶³å¯¼è‡´çš„ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ææƒå³å¯ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">chmod</span> 777 d2j_invoke.sh<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨æ‰§è¡Œä¸Šè¿°åç¼–è¯‘å‘½ä»¤ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/33df075c54194c43bd0e2f916fa6bb15~tplv-k3u1fbpfcp-watermark.image" alt="image-20221021170548196.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° dex2jar å¤šäº†ä¸¤ä¸ªå‹ç¼©åŒ…ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1ab69073a78e4379ae98cb15688ed95f~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221021170810169.png" width="30%" /><p>å…¶ä¸­ä»£ç éƒ½å¤„äº classes-dex2jar.jar ä¸­ï¼Œ dex2jar å·²ç»å®Œæˆå®ƒçš„ä½¿å‘½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦é€šè¿‡ jd-gui å»æŸ¥çœ‹ jar åŒ…ä¸‹çš„å†…å®¹</p><h3 id="1-2ã€jd-gui"><a href="#1-2ã€jd-gui" class="headerlink" title="1.2ã€jd-gui"></a>1.2ã€jd-gui</h3><p>ä½œç”¨ï¼šæŸ¥çœ‹ jar åŒ…é‡Œé¢çš„å…·ä½“ç±»å®¹</p><p>ä¸‹è½½åœ°å€ï¼š<a href="http://java-decompiler.github.io/">http://java-decompiler.github.io/</a></p><p>æ‰“å¼€ä¸‹è½½é“¾æ¥å¦‚ä¸‹å›¾ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bd16ed40b3749dd8cc94ace9b82e534~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221022212449198.png" width="50%" /><p>æ ¹æ®è‡ªå·±çš„æ“ä½œç³»ç»Ÿä¸‹è½½ä¸åŒçš„å‹ç¼©åŒ…å³å¯ï¼Œè¿™é‡Œæˆ‘ä¸‹è½½çš„æ˜¯ <code>jd-gui-osx-1.6.6.tar</code>ï¼Œè§£å‹åä½ ä¼šçœ‹åˆ°ä¸‹é¢ 4 ä¸ªæ–‡ä»¶ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/96a2e03ca12248fba16164ca98d6e68e~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221022212625065.png" width="50%" /><p>åŒå‡»æ‰“å¼€ JD-GUI ï¼Œä½ ä¼šå‘ç°ç³»ç»Ÿç»™æˆ‘ä»¬æŠ¥äº†ä¸ªé”™è¯¯ï¼š</p><blockquote><p>ERROR launching â€˜JD-GUIâ€™</p><p>No suitable Java version found on your system!<br> This program requires Java 1.8+<br> Make sure you install the required Java version.</p></blockquote><p>è¿™æ˜¯å› ä¸º <code>universalJavaApplicationStub.sh</code> è„šæœ¬åœ¨ Mac Big Sur åŠä»¥ä¸Šç‰ˆæœ¬æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªè„šæœ¬çš„å†…å®¹è¿›è¡Œæ›¿æ¢</p><p>1ã€åŒå‡» JD-GUI æ˜¾ç¤ºåŒ…å†…å®¹</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c48e47d5faf4f74871f8294dabe67e5~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022213637572.png"></p><p>2ã€æ ¹æ®æˆªå›¾æ‰¾åˆ° <code>universalJavaApplicationStub.sh</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c11f33feea7046e3bd7a6e35161139c8~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022213535766.png"></p><p>3ã€å°†æ­¤æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸º   <a href="https://github.com/tofi86/universalJavaApplicationStub/blob/v3.0.6/src/universalJavaApplicationStub">https://github.com/tofi86/universalJavaApplicationStub/blob/v3.0.6/src/universalJavaApplicationStub</a> è¿™ä¸ªé“¾æ¥ä¸­çš„å†…å®¹</p><p><strong>æ³¨æ„</strong>ï¼šå®‰è£…ä¹‹å‰ä½ è¦ä¿è¯ç³»ç»Ÿå·²ç»å®‰è£…äº† JDK 1.8 åŠä»¥ä¸Šç‰ˆæœ¬</p><p>ç»è¿‡ä¸Šé¢ 3 æ­¥ï¼Œä½ å°±å¯ä»¥æ­£ç¡®çš„æ‰“å¼€ JD-GUI äº†ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/078b71c3bf9e4c60ba1c591299de9820~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022214020602.png"></p><p>æ¥ç€å°†éœ€è¦æ‰“å¼€çš„ jar åŒ…ç»™æ‹–è¿›å»ï¼ŒæŸ¥çœ‹ MainActivityï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72cc2408924348e0b86a4613945d4c12~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022214433643.png"></p><p>ä¸Šè¿° MainActivity æˆ‘ä½¿ç”¨ AspectJ åœ¨ onCreate æ–¹æ³•ä¸­æ’å…¥äº†ä¸€äº›ä»£ç ï¼Œæ•ˆæœç¬¦åˆæˆ‘çš„é¢„æœŸ</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å­¦ä¼šäº†å¦‚ä½•åç¼–è¯‘ä»£ç å’Œèµ„æºäº†ï¼Œç®€å•çš„å°ç»“ä¸€ä¸‹ï¼š</p><p><strong>1ã€å¦‚æœè¦åç¼–è¯‘ app çš„ä»£ç ï¼Œå°±ä½¿ç”¨ dex2jar + jd-gui</strong></p><p><strong>2ã€å¦‚æœè¦åç¼–è¯‘ app çš„èµ„æºï¼Œå°±ä½¿ç”¨ apktool</strong></p><p>okï¼Œè¿˜æ²¡ç»“æŸï¼Œç°åœ¨ä½ è¿˜åªä¼šæˆ‘åœ¨å‰è¨€ä¸­æåˆ°çš„ 1ï¼Œ2ï¼Œ3 ç‚¹ï¼Œå¯¹äºç¬¬ 4 ç‚¹ï¼š<strong>åç¼–è¯‘ä¸€ä¸ª appï¼Œå°†å®ƒæ‰“åŒ…æˆä¸€ä¸ªæ–°çš„ app</strong> ä½ è¿˜ä¸ä¼šï¼Œè·Ÿç€æˆ‘çš„æ­¥ä¼ç»§ç»­å¾€ä¸‹èµ°</p><h2 id="äºŒã€åŸºäºä¸€ä¸ª-app-æ‰“é€ ä¸€ä¸ªæ–°çš„-app"><a href="#äºŒã€åŸºäºä¸€ä¸ª-app-æ‰“é€ ä¸€ä¸ªæ–°çš„-app" class="headerlink" title="äºŒã€åŸºäºä¸€ä¸ª app æ‰“é€ ä¸€ä¸ªæ–°çš„ app"></a>äºŒã€åŸºäºä¸€ä¸ª app æ‰“é€ ä¸€ä¸ªæ–°çš„ app</h2><p><strong>æé†’</strong>ï¼šè¿™é‡Œå¤§å®¶å°±ç«™åœ¨ä¸€ä¸ªæŠ€æœ¯çš„è§’åº¦å»å­¦ä¹ ï¼Œåƒä¸‡åˆ«å¹²åäº‹</p><p>æˆ‘ä»¬åŸºäºä¸Šè¿°ä½¿ç”¨ apktool åç¼–è¯‘åçš„æ–‡ä»¶å¤¹å»åšä¿®æ”¹ï¼Œå…ˆå†çœ‹ä¸€çœ¼ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80148ce5bee2429ab1d27fa81ac091c9~tplv-k3u1fbpfcp-watermark.image" alt="image-20221022180713615.png"></p><p>æœªä¿®æ”¹å‰ activity_main.xml æ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b212d00ac7754f7c87d658e472a23200~tplv-k3u1fbpfcp-watermark.image" alt="image-20221023094920363.png"></p><p>æˆ‘ä»¬è¿™é‡Œå°±ç®€å•çš„å¯¹ activity_main.xml æ–‡ä»¶è¿›è¡Œä¸€äº›ä¿®æ”¹ç„¶åæ‰“åŒ…ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dfaf1d2dfea9478eab100970a4ea9cd9~tplv-k3u1fbpfcp-watermark.image" alt="image-20221023095336625.png"></p><p>æ¥ç€ä½¿ç”¨ apktool å°†æˆ‘ä»¬åç¼–è¯‘çš„<code>app-debug.apk.zip.out</code>æ–‡ä»¶å¤¹é‡æ–°æ‰“åŒ…æˆ apkï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">apktool b app-debug.apk.zip.out -o new_app_debug.apk<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac452017b89b4bc4bb2e79370f98b70f~tplv-k3u1fbpfcp-watermark.image" alt="image-20221023100440147.png"></p><p>ç°åœ¨ä½ ä¼šå‘ç°åŒçº§ç›®å½•æœ‰äº†ä¸€ä¸ªæ–°çš„ apk æ–‡ä»¶ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09669596505f4e629bd4a499de3539a2~tplv-k3u1fbpfcp-watermark.image" alt="image-20221023100528479.png"></p><p>ç»“æœçŒ´æ€¥çŒ´æ€¥çš„æ‹¿å»å®‰è£…ï¼Œä½ ä¼šå‘ç°å®‰è£…æŠ¥é”™äº†ï¼š</p><blockquote><p>adb: failed to install xxx&#x2F;new_app_debug.apk: Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from &#x2F;data&#x2F;app&#x2F;vmdl2142334632.tmp&#x2F;base.apk: Attempt to get length of null array]</p></blockquote><p>è¿˜æ˜¯æˆ‘ä»¬é«˜å…´çš„å¤ªæ—©äº†ï¼Œç›®å‰è¿™ä¸ªæ–° apk æ˜¯ä¸èƒ½å®‰è£…çš„ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰è¿›è¡Œç­¾åï¼Œé‚£ä¹ˆå¦‚æœè¿™æ˜¯åˆ«äººçš„ appï¼Œæˆ‘ä»¬ä»å“ªå„¿å»æ•´ä¸€ä¸ªç­¾åæ–‡ä»¶å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œæ‹¿åˆ«äººçš„æ˜¯ä¸å¯èƒ½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±å»ç”Ÿæˆï¼Œä½¿ç”¨ AndroidStudio å¯ä»¥éå¸¸ç®€å•çš„ç”Ÿæˆä¸€ä¸ªç­¾åæ–‡ä»¶ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è¯´äº†ï¼Œä¸æ‡‚å¾—è‡ªå·±å»æŸ¥ä¸€ä¸‹</p><p>æœ‰äº†ç­¾åæ–‡ä»¶ä¹‹åå† terminal æ‰§è¡Œå¦‚ä¸‹ç­¾åå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore ç­¾åæ–‡ä»¶å -storepass ç­¾åå¯†ç  å¾…ç­¾åçš„APKæ–‡ä»¶å ç­¾åçš„åˆ«å<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ jarsigner å‘½ä»¤æ–‡ä»¶æ˜¯å­˜æ”¾åœ¨ JDK çš„ bin ç›®å½•ä¸‹ï¼Œéœ€è¦å°† bin ç›®å½•é…ç½®åœ¨ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡å½“ä¸­æ‰å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ‰§è¡Œæ­¤å‘½ä»¤</p><p>ä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore certificate -storepass erdai666 new_app_debug.apk key0<br></code></pre></td></tr></table></figure><p>å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡å•¥é—®é¢˜ï¼Œå°±è¯æ˜ç­¾åæˆåŠŸäº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒå®‰è£…åˆ°æ‰‹æœºä¸Šäº†ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼ŒAndroid è¿˜æåº¦å»ºè®®æˆ‘ä»¬å¯¹ç­¾ååçš„ apk æ–‡ä»¶è¿›è¡Œä¸€æ¬¡å¯¹é½æ“ä½œï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„ç¨‹åºåœ¨ Android ç³»ç»Ÿä¸­è¿è¡Œå¾—æ›´å¿«ã€‚å¯¹é½æ“ä½œä½¿ç”¨çš„æ˜¯ zipalign å·¥å…·ï¼Œè¯¥å·¥å…·å­˜æ”¾äº<code>&lt;Android SDK&gt;/build-tools/&lt;version&gt;</code>ç›®å½•ä¸‹ï¼Œå°†è¿™ä¸ªç›®å½•é…ç½®åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡å½“ä¸­å°±å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ‰§è¡Œæ­¤å‘½ä»¤äº†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">zipalign 4 new_app_debug.apk new_app_debug_aligned.apk<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ 4 æ˜¯å›ºå®šçš„å€¼ï¼Œåé¢æŒ‡å®šå¾…å¯¹é½çš„ apk æ–‡ä»¶åå’Œå¯¹é½åçš„ apk æ–‡ä»¶åï¼Œè¿è¡Œè¿™æ®µå‘½ä»¤ä¹‹åï¼Œä¼šç”Ÿæˆä¸€ä¸ª<code>new_app_debug_aligned.apk</code>æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd2d9d53fd7f4c01bcb739d4fb518a3c~tplv-k3u1fbpfcp-watermark.image" alt="image-20221023102830691.png"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠè¿™ä¸ªç­¾åå¯¹é½åçš„ apk å®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/933c32ea1cf44f9b939ae59583d076b5~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æ‰“å¼€ app åï¼Œé¡µé¢çš„å¸ƒå±€å˜æˆæˆ‘ä»¬ä¿®æ”¹åçš„äº†ï¼Œè¯´æ˜æˆ‘ä»¬åŸºäºä¸€ä¸ª app æ‰“é€ ä¸€ä¸ªæ–°çš„ app æˆåŠŸäº†</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘è®²äº†ï¼š</p><p>1ã€åç¼–è¯‘èµ„æºï¼Œä¸»è¦é€šè¿‡ apktool</p><p>2ã€åç¼–è¯‘ä»£ç ï¼Œä¸»è¦é€šè¿‡ dex2jar + jd-gui</p><p>3ã€åŸºäºä¸€ä¸ª app æ‰“é€ ä¸€ä¸ªæ–°çš„ appï¼Œä¸»è¦é€šè¿‡ apktool åç¼–è¯‘åï¼Œä¿®æ”¹ activity_main.xml æ–‡ä»¶ï¼Œç„¶åè¿›è¡Œé‡æ–°æ‰“åŒ…ï¼Œç­¾åï¼Œå¯¹é½ï¼Œæœ€åå®‰è£…å±•ç¤ºäº†é¢„æœŸçš„æ•ˆæœã€‚å½“ç„¶è¿™é‡Œä½ æœ‰èƒ½åŠ›çœ‹æ‡‚ <code>.smali</code>æ ¼å¼çš„ä»£ç ï¼Œé‚£ä¹ˆä½ å¯ä»¥åšçš„äº‹æƒ…å°±æ›´åŠ å¤š</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://blog.csdn.net/guolin_blog/article/details/49738023">Androidå®‰å…¨æ”»é˜²æˆ˜ï¼Œåç¼–è¯‘ä¸æ··æ·†æŠ€æœ¯å®Œå…¨è§£æï¼ˆä¸Šï¼‰</a></p><p><a href="http://www.feiyunjs.com/2581.html">MACä¸‹åç¼–è¯‘APKçš„å·¥å…·ApkTool,dex2jar,JD-GUIå®‰è£…ä¸ä½¿ç”¨æ–¹æ³•</a></p><p><a href="https://www.jianshu.com/p/ee2932b46d80">Mac Big Sur å‡çº§å JD-GUI æ— æ³•æ‰“å¼€çš„é—®é¢˜ä¿®å¤</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Android é€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android é€†å‘</tag>
      
      <tag>åç¼–è¯‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šHTML å¸¸ç”¨æ ‡ç­¾å’Œå±æ€§</title>
    <link href="/2022/10/17/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AHTML%20%E5%B8%B8%E7%94%A8%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7/"/>
    <url>/2022/10/17/Web%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AHTML%20%E5%B8%B8%E7%94%A8%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb182be50949442c8ae00c9f2ce9c6ad~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æœ€è¿‘åŸºäº Github æŠ˜è…¾å‡ºäº†ä¸€ä¸ªè‡ªå·±çš„<a href="https://sweetying520.github.io/">åšå®¢ç½‘ç«™</a>ï¼Œå‘ç°é‡Œé¢ä½¿ç”¨åˆ°çš„æŠ€æœ¯éƒ½æ˜¯ Web ç›¸å…³çš„ï¼Œè‡ªå·±æƒ³ä¿®æ”¹ä¸€äº›æ•ˆæœä¹Ÿéœ€è¦ç”¨åˆ°è¿™äº›ï¼Œè¿™å‹¾èµ·äº†æˆ‘å­¦ä¹  Web çš„ä¸€ä¸ªå…´è¶£ã€‚</p><p>å¦å¤–å½“å‰å¤§ç¯å¢ƒä¸‹ï¼Œåªæ˜¯æŒæ¡ç§»åŠ¨ç«¯å¼€å‘æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬åº”è¯¥å‘å¤§å‰ç«¯è¿™ä¸ªæ–¹å‘å»å‘å±•ï¼Œå»å­¦ä¹  Flutter ï¼ŒWeb å¼€å‘ï¼Œæå‡è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚</p><p>å­¦ä¹  Web æˆ‘ä»¬å°±è¦æŒæ¡åŸºç¡€ä¸‰ä»¶å¥—ï¼šHTMLï¼ŒCSSï¼ŒJavaScriptã€‚</p><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä¸»è¦ä»‹ç» HTML ç›¸å…³çš„é‡ç‚¹å†…å®¹</p><h2 id="ä¸€ã€HTML-åŸºç¡€è¯­æ³•"><a href="#ä¸€ã€HTML-åŸºç¡€è¯­æ³•" class="headerlink" title="ä¸€ã€HTML åŸºç¡€è¯­æ³•"></a>ä¸€ã€HTML åŸºç¡€è¯­æ³•</h2><h3 id="1-1ã€HTML-æ ‡ç­¾"><a href="#1-1ã€HTML-æ ‡ç­¾" class="headerlink" title="1.1ã€HTML æ ‡ç­¾"></a>1.1ã€HTML æ ‡ç­¾</h3><p>æˆ‘ä»¬å†™çš„ HTML é™æ€ç½‘é¡µå°±æ˜¯ç”± HTML æ ‡ç­¾å®šä¹‰çš„</p><p>HTML æ ‡ç­¾ä¸»è¦åˆ†ä¸ºä¸¤ç§:</p><p>1ã€åŒæ ‡ç­¾</p><p>2ã€å•æ ‡ç­¾</p><h4 id="1-1-1ã€åŒæ ‡ç­¾"><a href="#1-1-1ã€åŒæ ‡ç­¾" class="headerlink" title="1.1.1ã€åŒæ ‡ç­¾"></a>1.1.1ã€åŒæ ‡ç­¾</h4><p>åŒæ ‡ç­¾ä¹Ÿç§°å¸¸è§„æ ‡ç­¾æˆ–åŒæ ‡è®°ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><blockquote><p>&lt;å¼€å§‹æ ‡ç­¾&gt;å†…å®¹&lt;&#x2F;ç»“æŸæ ‡ç­¾&gt;</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªæ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="1-1-2ã€å•æ ‡ç­¾"><a href="#1-1-2ã€å•æ ‡ç­¾" class="headerlink" title="1.1.2ã€å•æ ‡ç­¾"></a>1.1.2ã€å•æ ‡ç­¾</h4><p>å•æ ‡ç­¾ä¹Ÿç§°ç©ºæ ‡è®°æˆ–å•æ ‡è®°ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><blockquote><p>&lt;å¼€å§‹æ ‡ç­¾&gt;æˆ–&lt;å¼€å§‹æ ‡ç­¾&#x2F;&gt;</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span> //ç­‰ä»· <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br></code></pre></td></tr></table></figure><p><strong>tips</strong>ï¼šå¯¹äºå•æ ‡ç­¾ï¼Œå»ºè®®å¤§å®¶ä½¿ç”¨ <code>&lt;br/&gt;</code> è¿™ç§å¸¦ &#x2F; çš„ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æˆ‘ä»¬ä¸€ä¸ªä¹¦å†™çš„è§„èŒƒ</p><h3 id="1-2ã€HTML-æ ‡ç­¾è¯­æ³•"><a href="#1-2ã€HTML-æ ‡ç­¾è¯­æ³•" class="headerlink" title="1.2ã€HTML æ ‡ç­¾è¯­æ³•"></a>1.2ã€HTML æ ‡ç­¾è¯­æ³•</h3><ul><li>HTML æ ‡ç­¾ä»¥å¼€å§‹æ ‡ç­¾èµ·å§‹</li><li>HTML æ ‡ç­¾ä»¥ç»“æŸæ ‡ç­¾ç»ˆæ­¢</li><li>æ ‡ç­¾çš„å†…å®¹æ˜¯å¼€å§‹æ ‡ç­¾ä¸ç»“æŸæ ‡ç­¾ä¹‹é—´çš„å†…å®¹</li><li>å•æ ‡ç­¾æ²¡æœ‰å†…å®¹</li><li>å•æ ‡ç­¾åœ¨å¼€å§‹æ ‡ç­¾ä¸­è¿›è¡Œå…³é—­ï¼ˆä»¥å¼€å§‹æ ‡ç­¾çš„ç»“æŸè€Œç»“æŸï¼‰</li><li>å¤§å¤šæ•° HTML æ ‡ç­¾å¯æ‹¥æœ‰å±æ€§</li></ul><h3 id="1-3ã€HTML-åµŒå¥—"><a href="#1-3ã€HTML-åµŒå¥—" class="headerlink" title="1.3ã€HTML åµŒå¥—"></a>1.3ã€HTML åµŒå¥—</h3><p>å¤§å¤šæ•° HTML æ ‡ç­¾å¯ä»¥åµŒå¥—ï¼ŒHTML é™æ€ç½‘é¡µå°±æ˜¯ç”±ç›¸äº’åµŒå¥—çš„ HTML æ ‡ç­¾æ„æˆ</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªæ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªæ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h3 id="1-4ã€å®ä¾‹è§£æ"><a href="#1-4ã€å®ä¾‹è§£æ" class="headerlink" title="1.4ã€å®ä¾‹è§£æ"></a>1.4ã€å®ä¾‹è§£æ</h3><p>è¿˜æ˜¯ä¸Šé¢ 1.3 è¿™ä¸ªä¾‹å­ï¼š</p><p>1ã€<code>&lt;!DOCTYPE html&gt;</code> ä¸»è¦ç”¨äºå‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ HTML5 æ¥è¿›è¡Œæ ‡ç­¾çš„è§£æ</p><p>2ã€html æ˜¯ä¸€ä¸ªç½‘é¡µçš„æ ¹æ ‡ç­¾ï¼Œå®ƒä¸»è¦åŒ…å«å›ºå®šçš„ä¸¤éƒ¨åˆ†ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å¤´éƒ¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- ä¸»ä½“éƒ¨åˆ† --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬å¯ä»¥åœ¨ head æˆ– body éƒ¨åˆ†è¿›è¡Œæ ‡ç­¾åµŒå¥—å®ç°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ</p><p><strong>tips</strong>ï¼š</p><p>1ã€è™½ç„¶è¯´ HTML æ ‡ç­¾å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä¾‹å¦‚ï¼š<code>&lt;P&gt;ç­‰åŒäº&lt;p&gt;</code>ï¼Œä½†è¿˜æ˜¯å»ºè®®å¤§å®¶ç»Ÿä¸€ä½¿ç”¨å°å†™æ ‡ç­¾ï¼Œå› ä¸º W3C åœ¨ HTML 4 ä¸­å°±æ¨èæˆ‘ä»¬ä½¿ç”¨å°å†™ï¼Œè€Œåœ¨æœªæ¥ XHTML ç‰ˆæœ¬ä¸­ä¼šå¼ºåˆ¶æˆ‘ä»¬ä½¿ç”¨å°å†™</p><p>2ã€å¦‚ä¸‹å†™æ³•ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªæ®µè½<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬æ²¡æœ‰å†™ç»“æŸæ ‡ç­¾ï¼Œä½†åœ¨æµè§ˆå™¨ä¸­ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œå› ä¸ºç»“æŸæ ‡ç­¾æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æœ€å¥½ä¸è¦ä¾èµ–è¿™ç§å†™æ³•ï¼Œå› ä¸ºå¿˜è®°ä½¿ç”¨ç»“æŸæ ‡ç­¾ä¼šäº§ç”Ÿä¸å¯é¢„æ–™çš„ç»“æœæˆ–é”™è¯¯</p><h2 id="äºŒã€æ ‡é¢˜-h1-h6"><a href="#äºŒã€æ ‡é¢˜-h1-h6" class="headerlink" title="äºŒã€æ ‡é¢˜ h1~h6"></a>äºŒã€æ ‡é¢˜ h1~h6</h2><p>1ã€h1ï½h6 æ ‡ç­¾ä¸»è¦ç”¨æ¥å®šä¹‰ HTML æ ‡é¢˜ï¼Œç‹¬å ä¸€è¡Œï¼Œæ•°å­—è¶Šå°ç­‰çº§è¶Šé«˜</p><p>2ã€å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>align</td><td>left ï¼šå·¦è¾¹å¯¹é½<br>right ï¼šå³è¾¹å¯¹é½<br>center ï¼šä¸­é—´å¯¹é½<br>justify ï¼šä¸¤ç«¯å¯¹é½</td><td>è§„å®šæ ‡é¢˜åœ¨ HTML ä¸­çš„æ’åˆ—</td></tr></tbody></table><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ html5 è¿›è¡Œæ ‡ç­¾çš„è§£æ --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-comment">&lt;!-- è¯­è¨€è‹±è¯­ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ UTF-8 æ¥è¿›è¡Œè§£ç  --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ˜¾ç¤ºåœ¨ç½‘é¡µçš„æ ‡é¢˜ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å†…å®¹éƒ¨åˆ†ï¼š1ï½6çº§æ ‡é¢˜ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä¸€çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>äºŒçº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä¸‰çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å››çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>äº”çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h6</span>&gt;</span>å…­çº§æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h6</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db5901ebdaa9464a98466ea7d6cbba23~tplv-k3u1fbpfcp-watermark.image" alt="image-20221017193252786.png"></p><h2 id="ä¸‰ã€æ®µè½-p"><a href="#ä¸‰ã€æ®µè½-p" class="headerlink" title="ä¸‰ã€æ®µè½ p"></a>ä¸‰ã€æ®µè½ p</h2><p>1ã€p æ ‡ç­¾ä¸»è¦ç”¨äºæ ‡è®°ä¸€ä¸ªæ®µè½ï¼Œç‹¬å ä¸€è¡Œ</p><p>2ã€å±æ€§åŒæ ‡é¢˜æ ‡ç­¾</p><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ html5 è¿›è¡Œæ ‡ç­¾çš„è§£æ --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-comment">&lt;!-- è¯­è¨€è‹±è¯­ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ UTF-8 æ¥è¿›è¡Œè§£ç  --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ˜¾ç¤ºåœ¨ç½‘é¡µçš„æ ‡é¢˜ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆ‘æ˜¯æ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å†…å®¹éƒ¨åˆ†ï¼špæ®µè½ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>æ®µè½1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ®µè½2<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ®µè½3<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ccfc79790de940fc8bea998e535455da~tplv-k3u1fbpfcp-watermark.image" alt="image-20221017194115729.png"></p><h2 id="å››ã€HTML-æ–‡æœ¬æ ¼å¼åŒ–æ ‡ç­¾"><a href="#å››ã€HTML-æ–‡æœ¬æ ¼å¼åŒ–æ ‡ç­¾" class="headerlink" title="å››ã€HTML æ–‡æœ¬æ ¼å¼åŒ–æ ‡ç­¾"></a>å››ã€HTML æ–‡æœ¬æ ¼å¼åŒ–æ ‡ç­¾</h2><h3 id="4-1ã€åŠ ç²—æ ‡ç­¾-b-or-strong"><a href="#4-1ã€åŠ ç²—æ ‡ç­¾-b-or-strong" class="headerlink" title="4.1ã€åŠ ç²—æ ‡ç­¾ b or strong"></a>4.1ã€åŠ ç²—æ ‡ç­¾ b or strong</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ b æˆ– strong æ ‡ç­¾å¯¹ä¸€æ®µæ–‡æœ¬è¿›è¡ŒåŠ ç²—</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>æ–‡æœ¬åŠ ç²—<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>æ–‡æœ¬åŠ ç²—<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>tips</strong>ï¼šå»ºè®®ä½¿ç”¨ strong æ ‡ç­¾ï¼Œèµ·åˆ°ä¸€ä¸ªå¼ºè°ƒä½œç”¨</p><h3 id="4-2ã€æ–œä½“æ ‡ç­¾-i-or-em"><a href="#4-2ã€æ–œä½“æ ‡ç­¾-i-or-em" class="headerlink" title="4.2ã€æ–œä½“æ ‡ç­¾ i or em"></a>4.2ã€æ–œä½“æ ‡ç­¾ i or em</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ i æˆ– em æ ‡ç­¾å¯¹ä¸€æ®µæ–‡æœ¬è¿›è¡ŒåŠ ç²—</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>æ–‡æœ¬å€¾æ–œ<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ–‡æœ¬å€¾æ–œ<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>tips</strong>ï¼šå»ºè®®ä½¿ç”¨ em æ ‡ç­¾ï¼Œèµ·åˆ°ä¸€ä¸ªå¼ºè°ƒä½œç”¨</p><h3 id="4-3ã€åˆ é™¤çº¿æ ‡ç­¾-s-or-del"><a href="#4-3ã€åˆ é™¤çº¿æ ‡ç­¾-s-or-del" class="headerlink" title="4.3ã€åˆ é™¤çº¿æ ‡ç­¾ s or del"></a>4.3ã€åˆ é™¤çº¿æ ‡ç­¾ s or del</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ del æ ‡ç­¾å¯¹ä¸€æ®µæ–‡æœ¬æ ‡è®°ä¸ºåˆ é™¤</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">s</span>&gt;</span>æ–‡æœ¬åˆ é™¤çº¿æ•ˆæœ<span class="hljs-tag">&lt;/<span class="hljs-name">s</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">del</span>&gt;</span>æ–‡æœ¬åˆ é™¤çº¿æ•ˆæœ<span class="hljs-tag">&lt;/<span class="hljs-name">del</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>tips</strong>ï¼šå»ºè®®ä½¿ç”¨ del æ ‡ç­¾ï¼Œèµ·åˆ°ä¸€ä¸ªå¼ºè°ƒä½œç”¨</p><h3 id="4-4ã€ä¸‹åˆ’çº¿æ ‡ç­¾-u"><a href="#4-4ã€ä¸‹åˆ’çº¿æ ‡ç­¾-u" class="headerlink" title="4.4ã€ä¸‹åˆ’çº¿æ ‡ç­¾ u"></a>4.4ã€ä¸‹åˆ’çº¿æ ‡ç­¾ u</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ u æ ‡ç­¾å¯¹ä¸€æ®µæ–‡æœ¬æ·»åŠ ä¸‹åˆ’çº¿</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">u</span>&gt;</span>æ–‡æœ¬åˆ é™¤çº¿æ•ˆæœ<span class="hljs-tag">&lt;/<span class="hljs-name">u</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-5ã€ä¸Šä¸‹æ ‡æ ‡ç­¾-supï¼Œsub"><a href="#4-5ã€ä¸Šä¸‹æ ‡æ ‡ç­¾-supï¼Œsub" class="headerlink" title="4.5ã€ä¸Šä¸‹æ ‡æ ‡ç­¾ supï¼Œsub"></a>4.5ã€ä¸Šä¸‹æ ‡æ ‡ç­¾ supï¼Œsub</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ supï¼Œsub æ ‡ç­¾å¯¹ä¸€æ®µæ–‡æœ¬æ ‡è®°ä¸Šä¸‹æ ‡</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">sup</span>&gt;</span>[1]<span class="hljs-tag">&lt;/<span class="hljs-name">sup</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">sub</span>&gt;</span>[2]<span class="hljs-tag">&lt;/<span class="hljs-name">sub</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-6ã€æ°´å¹³çº¿æ ‡ç­¾-hr"><a href="#4-6ã€æ°´å¹³çº¿æ ‡ç­¾-hr" class="headerlink" title="4.6ã€æ°´å¹³çº¿æ ‡ç­¾ hr"></a>4.6ã€æ°´å¹³çº¿æ ‡ç­¾ hr</h3><p>1ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ hr æ ‡ç­¾æ˜¾ç¤ºä¸€æ¡æ°´å¹³çº¿ï¼Œå®ƒæ˜¯ä¸€ä¸ªå•æ ‡ç­¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span> //ç­‰ä»· <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>align</td><td>left ï¼šå·¦è¾¹å¯¹é½<br>right ï¼šå³è¾¹å¯¹é½<br>center ï¼šä¸­é—´å¯¹é½<br></td><td>è§„å®šæ°´å¹³çº¿åœ¨ HTML ä¸­çš„æ’åˆ—</td></tr><tr><td>noshade</td><td>noshade</td><td>è§„å®šæ°´å¹³çº¿å‘ˆç°ä¸ºçº¯è‰²</td></tr><tr><td>size</td><td>pixelsï¼šåƒç´ å€¼</td><td>è§„å®šæ°´å¹³çº¿çš„é«˜åº¦</td></tr><tr><td>width</td><td>pixels: åƒç´ å€¼<br>%ï¼šç™¾åˆ†æ¯”å®½åº¦</td><td>è§„å®šæ°´å¹³çº¿çš„å®½åº¦</td></tr></tbody></table><h3 id="4-7ã€ç»¼åˆæ¡ˆä¾‹"><a href="#4-7ã€ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="4.7ã€ç»¼åˆæ¡ˆä¾‹"></a>4.7ã€ç»¼åˆæ¡ˆä¾‹</h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°å­¦ä¹ åˆ°çš„æ ¼å¼åŒ–æ ‡ç­¾åšä¸€ä¸ªç»¼åˆæ¡ˆä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¨å¹¿åè¯ˆ app<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç§¦å§‹çš‡ç©¿è¶Šæ¨å¹¿åè¯ˆ app<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ°´å¹³çº¿ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ä¸Šä¸‹æ ‡ï¼Œæ¢è¡Œ --&gt;</span><br>        è¿‘æ—¥ï¼Œé™•è¥¿è¥¿å®‰ï¼Œä¸€æ®µç§¦å§‹çš‡<span class="hljs-tag">&lt;<span class="hljs-name">sup</span>&gt;</span>[1]<span class="hljs-tag">&lt;/<span class="hljs-name">sup</span>&gt;</span>åœ¨å…µé©¬ä¿‘<span class="hljs-tag">&lt;<span class="hljs-name">sub</span>&gt;</span>[2]<span class="hljs-tag">&lt;/<span class="hljs-name">sub</span>&gt;</span>å¹¿åœºå®£ä¼ åè¯ˆ app çš„è§†é¢‘èµ°çº¢<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- åŠ ç²—--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ç”±æ¼”å‘˜æ‰®æ¼”çš„ç§¦å§‹çš‡éšæœºé—®è·¯äººæ˜¯å¦ä¸‹è½½åè¯ˆ appï¼Œæœªä¸‹è½½ä¼šè¢«å£«å…µæ‹–èµ°<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- åŠ ç²—å€¾æ–œ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç›¸å…³è´Ÿè´£äººç§°ï¼Œå¸Œæœ›åˆ©ç”¨ç§¦å§‹çš‡è¿™ä¸ª IPï¼Œä»¥åœ°åŸŸæ–‡åŒ–å’Œè¯™è°å¹½é»˜çš„æ–¹å¼ï¼Œä¼ é€’æ­£èƒ½é‡<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- åˆ é™¤çº¿ï¼Œä¸‹åˆ’çº¿ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é—¨ç¥¨ä¸è¦<span class="hljs-tag">&lt;<span class="hljs-name">del</span>&gt;</span>998<span class="hljs-tag">&lt;/<span class="hljs-name">del</span>&gt;</span>ï¼Œä¸è¦98ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">u</span>&gt;</span>åªè¦ 9.8<span class="hljs-tag">&lt;/<span class="hljs-name">u</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9847a68a683045d7b6b192956cef1693~tplv-k3u1fbpfcp-watermark.image" alt="image-20221017201219915.png"></p><h2 id="äº”ã€HTML-ä¸­çš„ç‰¹æ®Šç¬¦å·"><a href="#äº”ã€HTML-ä¸­çš„ç‰¹æ®Šç¬¦å·" class="headerlink" title="äº”ã€HTML ä¸­çš„ç‰¹æ®Šç¬¦å·"></a>äº”ã€HTML ä¸­çš„ç‰¹æ®Šç¬¦å·</h2><table><thead><tr><th>ç‰¹æ®Šç¬¦å·</th><th>value</th></tr></thead><tbody><tr><td>å°–è§’å·</td><td><code>&amp;lt;</code> ï¼šå·¦å°–è§’å·<br><code>&amp;gt;</code> ï¼šå³å°–è§’å·</td></tr><tr><td>ç©ºæ ¼</td><td><code>&amp;emsp;</code> ï¼šå æ®çš„å®½åº¦æ­£å¥½æ˜¯ä¸€ä¸ªä¸­æ–‡çš„å®½åº¦ï¼Œä¸”åŸºæœ¬ä¸å—å­—ä½“çš„å½±å“</td></tr><tr><td>ç‰ˆæƒ</td><td><code>&amp;copy;</code></td></tr><tr><td>å•†æ ‡</td><td><code>&amp;trade;</code><br><code>&amp;reg;</code></td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç‰¹æ®Šç¬¦å·<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å°–è§’å· --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>       hr æ ‡ç­¾çš„ç”¨æ³•æ˜¯è¿™æ ·çš„ <span class="hljs-symbol">&amp;lt;</span>hr noshade/<span class="hljs-symbol">&amp;gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> <span class="hljs-attr">noshade</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- ç©ºæ ¼ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;emsp;</span><span class="hljs-symbol">&amp;emsp;</span>èµµé’±å­™æï¼Œå‘¨å´éƒ‘ç‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- ç‰ˆæƒ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;copy;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å—ä¿æŠ¤çš„å•†æ ‡ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;reg;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æœªå—ä¿æŠ¤çš„å•†æ ‡ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;trade;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- emoji --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;#128512;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;#128513;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;#128514;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå›¾ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e583935daff4c2589ea055308e56cff~tplv-k3u1fbpfcp-watermark.image" alt="image-20221017202748615.png"></p><h2 id="å…­ã€åˆ†åŒº-div-å’Œ-span"><a href="#å…­ã€åˆ†åŒº-div-å’Œ-span" class="headerlink" title="å…­ã€åˆ†åŒº div å’Œ span"></a>å…­ã€åˆ†åŒº div å’Œ span</h2><p>1ã€div æ ‡ç­¾ä¸»è¦ç”¨æ¥åˆ’åˆ†é¡µé¢çš„åŒºåŸŸï¼Œç‹¬å ä¸€è¡Œ</p><p>2ã€span æ ‡ç­¾ä¸»è¦ç”¨äºåœ¨æ–‡æœ¬ç‹¬ç«‹ä¿®é¥°çš„æ—¶å€™ï¼Œå†…å®¹æœ‰å¤šå®½å°±å ç”¨å¤šå®½çš„ç©ºé—´è·ç¦»</p><p>3ã€div å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>align</td><td>left ï¼šå·¦è¾¹å¯¹é½<br>right ï¼šå³è¾¹å¯¹é½<br>center ï¼šä¸­é—´å¯¹é½<br>justify ï¼šä¸¤ç«¯å¯¹é½</td><td>è§„å®š div åˆ’åˆ†çš„åŒºåŸŸåœ¨ HTML ä¸­çš„æ’åˆ—</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>divæ ‡ç­¾ï¼Œç”¨æ¥åˆ’åˆ†é¡µé¢çš„åŒºåŸŸï¼Œç‹¬å ä¸€è¡Œ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- div --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>111111<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>22222<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>spanæ ‡ç­¾ï¼Œä¸»è¦åº”ç”¨åœ¨æ–‡æœ¬ç‹¬ç«‹ä¿®é¥°çš„æ—¶å€™ï¼Œå†…å®¹æœ‰å¤šå®½å°±å ç”¨å¤šå®½çš„ç©ºé—´è·ç¦»<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- span é‡Œé¢ä½¿ç”¨åˆ°äº† css è¡Œå†…æ ·å¼è¡¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ä½“è‚²<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red;&quot;</span>&gt;</span>sports<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8697f96828f6458c9bba78410a9016cb~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018111504355.png"></p><h2 id="ä¸ƒã€åˆ—è¡¨-olã€ulã€dl"><a href="#ä¸ƒã€åˆ—è¡¨-olã€ulã€dl" class="headerlink" title="ä¸ƒã€åˆ—è¡¨ olã€ulã€dl"></a>ä¸ƒã€åˆ—è¡¨ olã€ulã€dl</h2><h3 id="7-1ã€ol-li-æ„æˆæœ‰åºåˆ—è¡¨"><a href="#7-1ã€ol-li-æ„æˆæœ‰åºåˆ—è¡¨" class="headerlink" title="7.1ã€ol + li æ„æˆæœ‰åºåˆ—è¡¨"></a>7.1ã€ol + li æ„æˆæœ‰åºåˆ—è¡¨</h3><p>1ã€å°† li ä½œä¸º ol çš„å­©å­æ ‡ç­¾å°±å¯ä»¥æ„æˆä¸€ä¸ªæœ‰åºåˆ—è¡¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æŠŠå†°ç®±æ‰“å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å¤§è±¡æ”¾è¿›å»<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å†°ç®±å…³ä¸Šé—¨<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ol å¸¸ç”¨å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>reversed</td><td>reversed</td><td>æŒ‡å®šåˆ—è¡¨å€’åº</td></tr><tr><td>start</td><td>number ç±»å‹</td><td>æŒ‡å®šåˆ—è¡¨ç¼–å·çš„èµ·å§‹å€¼</td></tr><tr><td>type</td><td>a ï¼šå°å†™è‹±æ–‡å­—æ¯ç¼–å·<br/>A ï¼šå¤§å†™è‹±æ–‡å­—æ¯ç¼–å·<br/>i ï¼šå°å†™ç½—é©¬æ•°å­—ç¼–å·<br/>I ï¼šå¤§å†™ç½—é©¬æ•°å­—ç¼–å·<br/>1 ï¼šé˜¿æ‹‰ä¼¯æ•°å­—ç¼–å·ï¼ˆé»˜è®¤ï¼‰</td><td>è§„å®šåˆ—è¡¨çš„ç±»å‹</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æœ‰åºåˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å¤§å†™è‹±æ–‡å­—æ¯ç¼–å·ï¼Œä» C å¼€å§‹ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ol</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;A&quot;</span> <span class="hljs-attr">start</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æŠŠå†°ç®±æ‰“å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å¤§è±¡æ”¾è¿›å»<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å†°ç®±å…³ä¸Šé—¨<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4d8d5a3b3ac412b9392bf744d7f42ab~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018112817936.png"></p><h3 id="7-2ã€ul-li-æ„æˆæ— åºåˆ—è¡¨"><a href="#7-2ã€ul-li-æ„æˆæ— åºåˆ—è¡¨" class="headerlink" title="7.2ã€ul + li æ„æˆæ— åºåˆ—è¡¨"></a>7.2ã€ul + li æ„æˆæ— åºåˆ—è¡¨</h3><p>1ã€å°† li ä½œä¸º ul çš„å­©å­æ ‡ç­¾å°±å¯ä»¥æ„æˆä¸€ä¸ªæ— åºåˆ—è¡¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åƒé¥­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¡è§‰<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ’¸ç <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ul å¸¸ç”¨å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>type</td><td>disc ï¼šå®å¿ƒåœ†<br/>circle ï¼šç©ºå¿ƒåœ†<br>square ï¼šå®å¿ƒæ­£æ–¹å½¢<br>none ï¼šæ— </td><td>è§„å®šåˆ—è¡¨çš„ç¬¦å·ç±»å‹</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ— åºåˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰åˆ—è¡¨çš„ç¬¦å·ç±»å‹ä¸ºå®å¿ƒæ­£æ–¹å½¢ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;square&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åƒé¥­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¡è§‰<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ’¸ç <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b805edf81274ae8bd5fb9c32cbc8825~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018113436180.png"></p><h3 id="7-3ã€dl-dt-dd-æ„æˆè‡ªå®šä¹‰åˆ—è¡¨"><a href="#7-3ã€dl-dt-dd-æ„æˆè‡ªå®šä¹‰åˆ—è¡¨" class="headerlink" title="7.3ã€dl + dt + dd æ„æˆè‡ªå®šä¹‰åˆ—è¡¨"></a>7.3ã€dl + dt + dd æ„æˆè‡ªå®šä¹‰åˆ—è¡¨</h3><p>1ã€å°† dt ï¼Œdd ä½œä¸º dl çš„å­©å­èŠ‚ç‚¹å°±å¯ä»¥æ„æˆä¸€ä¸ªè‡ªå®šä¹‰åˆ—è¡¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>Coffee<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>Black hot drink<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>Milk<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>White cold drink<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è‡ªå®šä¹‰åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>Coffee<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>Black hot drink<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>Milk<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>White cold drink<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7e2cd26e4a54b1897ef0c32d2e7a0c7~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018113949759.png"></p><h2 id="å…«ã€å›¾ç‰‡-img"><a href="#å…«ã€å›¾ç‰‡-img" class="headerlink" title="å…«ã€å›¾ç‰‡ img"></a>å…«ã€å›¾ç‰‡ img</h2><p>1ã€img æ ‡ç­¾å¯ä»¥å°†å›¾ç‰‡æ˜¾ç¤ºåœ¨ HTML ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªå•æ ‡ç­¾</p><p>2ã€img æ ‡ç­¾å¸¸ç”¨å±æ€§</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>src</td><td>urlï¼šå›¾ç‰‡çš„è·¯å¾„</td><td>url å¯ä»¥æ˜¯ç½‘ç»œå›¾ç‰‡è·¯å¾„å’Œæœ¬åœ°å›¾ç‰‡è·¯å¾„</td></tr><tr><td>alt</td><td>textï¼šæ–‡æœ¬</td><td>å½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶å°±ä¼šæ˜¾ç¤ºè¿™ä¸ªæ–‡æœ¬çš„ä¿¡æ¯</td></tr><tr><td>width</td><td>pixelsï¼šåƒç´ å€¼</td><td>è§„å®šå›¾ç‰‡çš„å®½åº¦</td></tr><tr><td>height</td><td>pixelsï¼šåƒç´ å€¼</td><td>è§„å®šå›¾ç‰‡çš„é«˜åº¦</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å›¾ç‰‡<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;å›¾ç‰‡åŠ è½½ error&quot;</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;400px&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;400px&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2b3be6207f24a548a400bb688baaf89~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018141828808.png"></p><h2 id="ä¹ã€è¶…é“¾æ¥-a"><a href="#ä¹ã€è¶…é“¾æ¥-a" class="headerlink" title="ä¹ã€è¶…é“¾æ¥ a"></a>ä¹ã€è¶…é“¾æ¥ a</h2><p>1ã€a æ ‡ç­¾ä¸»è¦ç”¨äºå®šä¹‰ä¸€ä¸ªè¶…é“¾æ¥ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>&gt;</span>æ‰“å¼€ç™¾åº¦æœç´¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å¸¸ç”¨å±æ€§</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>href</td><td>url</td><td>è·³è½¬é“¾æ¥çš„ url</td></tr><tr><td>title</td><td>text</td><td>é¼ æ ‡æ”¾åœ¨é“¾æ¥ä¸Šå‡ºæ¥çš„æ‚¬æµ®æ–‡å­—</td></tr><tr><td>target</td><td><code>_blank</code> ï¼šæ–°çª—å£æ‰“å¼€<br/><code>_self</code> ï¼šå½“å‰é¡µé¢æ‰“å¼€</td><td>è§„å®šåœ¨ä½•å¤„æ‰“å¼€ç›®å‰ urlï¼Œä»…åœ¨ href å±æ€§å­˜åœ¨æ—¶ä½¿ç”¨</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è¶…é“¾æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- åœ¨æ–°é¡µé¢æ‰“å¼€å½“å‰é“¾æ¥ --&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;ç™¾åº¦&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span>&gt;</span>æ‰“å¼€ç™¾åº¦æœç´¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/925cfa46137b47d8a42da2bdfb660ef6~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018143448433.png"></p><h2 id="åã€HTML-è¡¨æ ¼"><a href="#åã€HTML-è¡¨æ ¼" class="headerlink" title="åã€HTML è¡¨æ ¼"></a>åã€HTML è¡¨æ ¼</h2><h3 id="10-1ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾"><a href="#10-1ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾" class="headerlink" title="10.1ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾"></a>10.1ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾</h3><p>ç»„æˆ HTML è¡¨æ ¼çš„æ ‡ç­¾æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬ä»‹ç»å¸¸ç”¨çš„ï¼š</p><table><thead><tr><th>æ ‡ç­¾</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>table</td><td>å®šä¹‰è¡¨æ ¼</td></tr><tr><td>caption</td><td>å®šä¹‰è¡¨æ ¼æ ‡é¢˜</td></tr><tr><td>th</td><td>å®šä¹‰è¡¨æ ¼çš„è¡¨å¤´</td></tr><tr><td>tr</td><td>å®šä¹‰è¡¨æ ¼çš„è¡Œ</td></tr><tr><td>td</td><td>å®šä¹‰è¡¨æ ¼çš„å•å…ƒ</td></tr></tbody></table><h3 id="10-2ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾å±æ€§"><a href="#10-2ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾å±æ€§" class="headerlink" title="10.2ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾å±æ€§"></a>10.2ã€å¸¸ç”¨è¡¨æ ¼æ ‡ç­¾å±æ€§</h3><h4 id="10-2-1ã€table-æ ‡ç­¾å±æ€§"><a href="#10-2-1ã€table-æ ‡ç­¾å±æ€§" class="headerlink" title="10.2.1ã€table æ ‡ç­¾å±æ€§"></a>10.2.1ã€table æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>width</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>è¡¨æ ¼çš„å®½åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>height</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>è¡¨æ ¼çš„é«˜åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>border</td><td>æ•°å€¼</td><td>è¡¨æ ¼è¾¹æ¡†</td></tr><tr><td>bordercolor</td><td>rgb(x,x,x)  ï¼šrgb ç»„æˆçš„é¢œè‰²<br/>#xxxxxx ï¼šåå…­è¿›åˆ¶é¢œè‰²<br/>colorname ï¼šé¢œè‰²çš„è‹±æ–‡åç§°</td><td>è¡¨æ ¼è¾¹æ¡†é¢œè‰²</td></tr><tr><td>bgcolor</td><td>rgb(x,x,x)  ï¼šrgb ç»„æˆçš„é¢œè‰²<br/>#xxxxxx ï¼šåå…­è¿›åˆ¶é¢œè‰²<br/>colorname ï¼šé¢œè‰²çš„è‹±æ–‡åç§°</td><td>è¡¨æ ¼èƒŒæ™¯é¢œè‰²</td></tr><tr><td>align</td><td>left ï¼šå·¦è¾¹<br/>center ï¼š ä¸­é—´<br/>right ï¼šå³è¾¹</td><td>è¡¨æ ¼åœ¨ HTML ä¸­çš„å¯¹é½æ–¹å¼</td></tr><tr><td>cellspacing</td><td>pixels ï¼šåƒç´ å€¼<br/></td><td>å•å…ƒæ ¼ä¸å•å…ƒæ ¼ä¹‹é—´çš„é—´è·</td></tr><tr><td>cellpadding</td><td>pixels ï¼šåƒç´ å€¼<br/></td><td>å•å…ƒæ ¼çš„å†…é—´è·</td></tr></tbody></table><h4 id="10-2-2ã€th-æ ‡ç­¾å±æ€§"><a href="#10-2-2ã€th-æ ‡ç­¾å±æ€§" class="headerlink" title="10.2.2ã€th æ ‡ç­¾å±æ€§"></a>10.2.2ã€th æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>width</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>è¡¨å¤´å•å…ƒæ ¼å®½åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>height</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>è¡¨å¤´å•å…ƒæ ¼é«˜åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>bgcolor</td><td>rgb(x,x,x)  ï¼šrgb ç»„æˆçš„é¢œè‰²<br/>#xxxxxx ï¼šåå…­è¿›åˆ¶é¢œè‰²<br/>colorname ï¼šé¢œè‰²çš„è‹±æ–‡åç§°</td><td>è¡¨å¤´å•å…ƒæ ¼çš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>align</td><td>left ï¼šå·¦è¾¹<br/>center ï¼š ä¸­é—´<br/>right ï¼šå³è¾¹</td><td>è¡¨å¤´å•å…ƒæ ¼æ–‡å­—æ°´å¹³å¯¹é½æ–¹å¼</td></tr><tr><td>valign</td><td>top ï¼šä¸Š<br/>middle ï¼š ä¸­<br/>bottom ï¼šä¸‹</td><td>è¡¨å¤´å•å…ƒæ ¼æ–‡å­—å‚ç›´å¯¹é½æ–¹å¼</td></tr><tr><td>rowspan</td><td>æ•°å€¼</td><td>è¡¨å¤´å•å…ƒæ ¼è¡Œåˆå¹¶</td></tr><tr><td>colspan</td><td>æ•°å€¼</td><td>è¡¨å¤´å•å…ƒæ ¼åˆ—åˆå¹¶</td></tr></tbody></table><h4 id="10-2-3ã€tr-æ ‡ç­¾å±æ€§"><a href="#10-2-3ã€tr-æ ‡ç­¾å±æ€§" class="headerlink" title="10.2.3ã€tr æ ‡ç­¾å±æ€§"></a>10.2.3ã€tr æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>height</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>å½“å‰è¡Œé«˜åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>bgcolor</td><td>rgb(x,x,x)  ï¼šrgb ç»„æˆçš„é¢œè‰²<br/>#xxxxxx ï¼šåå…­è¿›åˆ¶é¢œè‰²<br/>colorname ï¼šé¢œè‰²çš„è‹±æ–‡åç§°</td><td>å½“å‰è¡Œçš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>align</td><td>left ï¼šå·¦è¾¹<br/>center ï¼š ä¸­é—´<br/>right ï¼šå³è¾¹</td><td>å½“å‰è¡Œæ–‡å­—æ°´å¹³å¯¹é½æ–¹å¼</td></tr><tr><td>valign</td><td>top ï¼šä¸Š<br/>middle ï¼š ä¸­<br/>bottom ï¼šä¸‹</td><td>å½“å‰è¡Œæ–‡å­—å‚ç›´å¯¹é½æ–¹å¼</td></tr></tbody></table><h4 id="10-2-4ã€td-æ ‡ç­¾å±æ€§"><a href="#10-2-4ã€td-æ ‡ç­¾å±æ€§" class="headerlink" title="10.2.4ã€td æ ‡ç­¾å±æ€§"></a>10.2.4ã€td æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>width</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>å•å…ƒæ ¼å®½åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>height</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>å•å…ƒæ ¼é«˜åº¦ï¼Œå¯ä»¥æ˜¯åƒç´ å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ¯”</td></tr><tr><td>bgcolor</td><td>rgb(x,x,x)  ï¼šrgb ç»„æˆçš„é¢œè‰²<br/>#xxxxxx ï¼šåå…­è¿›åˆ¶é¢œè‰²<br/>colorname ï¼šé¢œè‰²çš„è‹±æ–‡åç§°</td><td>å•å…ƒæ ¼çš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>align</td><td>left ï¼šå·¦è¾¹<br/>center ï¼š ä¸­é—´<br/>right ï¼šå³è¾¹</td><td>å•å…ƒæ ¼æ–‡å­—æ°´å¹³å¯¹é½æ–¹å¼</td></tr><tr><td>valign</td><td>top ï¼šä¸Š<br/>middle ï¼š ä¸­<br/>bottom ï¼šä¸‹</td><td>å•å…ƒæ ¼æ–‡å­—å‚ç›´å¯¹é½æ–¹å¼</td></tr><tr><td>rowspan</td><td>æ•°å€¼</td><td>è¡Œåˆå¹¶</td></tr><tr><td>colspan</td><td>æ•°å€¼</td><td>åˆ—åˆå¹¶</td></tr></tbody></table><h3 id="10-3ã€ç»¼åˆæ¡ˆä¾‹"><a href="#10-3ã€ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="10.3ã€ç»¼åˆæ¡ˆä¾‹"></a>10.3ã€ç»¼åˆæ¡ˆä¾‹</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°å­¦ä¹ çš„ HTML è¡¨æ ¼æ ‡ç­¾å®ç°ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è¡¨æ ¼ç»¼åˆæ¡ˆä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">cellspacing</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">cellpadding</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span> <span class="hljs-attr">bordercolor</span>=<span class="hljs-string">&quot;pink&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">caption</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red;&quot;</span>&gt;</span>ä¼šå‘˜ç™»è®°ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">caption</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red;&quot;</span>&gt;</span>key<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red;&quot;</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>ä¼šå‘˜å§“å<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;300&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>å‡ºç”Ÿæ—¥æœŸ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;300&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>èº«ä»½è¯å·<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>é€šä¿¡åœ°å€<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>è”ç³»ç”µè¯<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: pink;&quot;</span>&gt;</span>ä¼šå‘˜å¡å·<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e1803095769944b39fb99d67b6e1718e~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018151549235.png"></p><h2 id="åä¸€ã€HTML-è¡¨å•"><a href="#åä¸€ã€HTML-è¡¨å•" class="headerlink" title="åä¸€ã€HTML è¡¨å•"></a>åä¸€ã€HTML è¡¨å•</h2><h3 id="11-1ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾"><a href="#11-1ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾" class="headerlink" title="11.1ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾"></a>11.1ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾</h3><p>HTML è¡¨å•çš„æ ‡ç­¾æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬ä»‹ç»å¸¸ç”¨çš„ï¼š</p><table><thead><tr><th>æ ‡ç­¾</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>form</td><td>å®šä¹‰ç”¨æˆ·è¾“å…¥çš„è¡¨å•</td></tr><tr><td>input</td><td>å®šä¹‰è¾“å…¥åŸŸ</td></tr><tr><td>label</td><td>å®šä¹‰æ ‡ç­¾</td></tr><tr><td>select + option</td><td>å®šä¹‰ä¸‹æ‹‰åˆ—è¡¨ï¼Œselectï¼šä¸‹æ‹‰åˆ—è¡¨ optonï¼šå…·ä½“çš„æ¯ä¸€é¡¹</td></tr><tr><td>button</td><td>å®šä¹‰ä¸€ä¸ªç‚¹å‡»æŒ‰é’®</td></tr></tbody></table><h3 id="11-2ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾å±æ€§"><a href="#11-2ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾å±æ€§" class="headerlink" title="11.2ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾å±æ€§"></a>11.2ã€å¸¸ç”¨è¡¨å•æ ‡ç­¾å±æ€§</h3><h4 id="11-2-1ã€form-æ ‡ç­¾å±æ€§"><a href="#11-2-1ã€form-æ ‡ç­¾å±æ€§" class="headerlink" title="11.2.1ã€form æ ‡ç­¾å±æ€§"></a>11.2.1ã€form æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>action</td><td>url</td><td>å‘é€è¡¨å•æ•°æ®çš„ url</td></tr><tr><td>method</td><td>get<br/>post</td><td>å‘é€è¡¨å•æ•°æ®çš„ HTTP æ–¹æ³•</td></tr></tbody></table><h4 id="11-2-2ã€input-æ ‡ç­¾å±æ€§"><a href="#11-2-2ã€input-æ ‡ç­¾å±æ€§" class="headerlink" title="11.2.2ã€input æ ‡ç­¾å±æ€§"></a>11.2.2ã€input æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>type</td><td>button<br/>checkbox<br/>color<br/>date<br/>datetime<br/>datetime-local<br/>email<br/>file<br/>hidden<br/>image<br/>month<br/>number<br/>password<br/>radio<br/>range<br/>reset<br/>search<br/>submit<br/>tel<br/>text<br/>time<br/>url</td><td>æŒ‡å®š input æ ‡ç­¾è¦æ˜¾ç¤ºçš„ç±»å‹</td></tr><tr><td>value</td><td>text</td><td>æŒ‡å®š input æ ‡ç­¾çš„å€¼</td></tr><tr><td>placeholder</td><td>text</td><td>æç¤ºæ–‡æ¡ˆ</td></tr><tr><td>name</td><td>text</td><td>æŒ‡å®š input æ ‡ç­¾çš„åç§°ï¼Œä¹Ÿç”¨äºæäº¤æœåŠ¡å™¨çš„ key</td></tr></tbody></table><h4 id="11-2-3ã€select-æ ‡ç­¾å±æ€§"><a href="#11-2-3ã€select-æ ‡ç­¾å±æ€§" class="headerlink" title="11.2.3ã€select æ ‡ç­¾å±æ€§"></a>11.2.3ã€select æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>disabled</td><td></td><td>ç¦ç”¨ä¸‹æ‹‰åˆ—è¡¨</td></tr><tr><td>multiple</td><td></td><td>å¯é€‰æ‹©å¤šä¸ªé€‰é¡¹</td></tr><tr><td>name</td><td>text</td><td>å®šä¹‰ä¸‹æ‹‰åˆ—è¡¨çš„åç§°ï¼Œä¹Ÿç”¨äºæäº¤æœåŠ¡å™¨çš„ key</td></tr></tbody></table><h4 id="11-2-4ã€option-æ ‡ç­¾å±æ€§"><a href="#11-2-4ã€option-æ ‡ç­¾å±æ€§" class="headerlink" title="11.2.4ã€option æ ‡ç­¾å±æ€§"></a>11.2.4ã€option æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>disabled</td><td></td><td>ç¦ç”¨å½“å‰é¡¹</td></tr><tr><td>value</td><td>text</td><td>å®šä¹‰æäº¤æœåŠ¡å™¨çš„ value</td></tr></tbody></table><h4 id="11-2-5ã€button-æ ‡ç­¾å±æ€§"><a href="#11-2-5ã€button-æ ‡ç­¾å±æ€§" class="headerlink" title="11.2.5ã€button æ ‡ç­¾å±æ€§"></a>11.2.5ã€button æ ‡ç­¾å±æ€§</h4><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>name</td><td>text</td><td>å®šä¹‰æŒ‰é’®çš„åç§°ï¼Œä¹Ÿç”¨äºæäº¤æœåŠ¡å™¨çš„ key</td></tr><tr><td>type</td><td>button<br/>reset<br/>submit</td><td>è§„å®šæŒ‰é’®çš„ç±»å‹</td></tr><tr><td>value</td><td>text</td><td>è§„å®šæŒ‰é’®çš„åˆå§‹å€¼</td></tr><tr><td>onclick</td><td></td><td>æŒ‰é’®ç‚¹å‡»åçš„å›è°ƒ</td></tr></tbody></table><h3 id="11-3ã€ç»¼åˆæ¡ˆä¾‹"><a href="#11-3ã€ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="11.3ã€ç»¼åˆæ¡ˆä¾‹"></a>11.3ã€ç»¼åˆæ¡ˆä¾‹</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢å­¦ä¹ åˆ°çš„è¡¨å•æ ‡ç­¾å®ç°ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯ç™»è®°ç³»ç»Ÿ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è¡¨å•ç»¼åˆæ¡ˆä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç”¨æˆ·ä¿¡æ¯ç™»è®°ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> &gt;</span><br>        å§“åï¼š<br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;è¯·è¾“å…¥ç”¨æˆ·å§“å&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        æ€§åˆ«ï¼š<br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;male&quot;</span>&gt;</span>ç”·<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;male&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;male&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;female&quot;</span>&gt;</span>å¥³<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;female&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;female&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;face&quot;</span>&gt;</span>é¢œå€¼<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;face&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;face&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;900&quot;</span>&gt;</span>70<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;80&quot;</span>&gt;</span>80<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;90&quot;</span>&gt;</span>90<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        å…´è¶£çˆ±å¥½ï¼š<br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;palyball&quot;</span>&gt;</span>æ‰“ç¯®çƒ<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;palyball&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;palyball&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;climb&quot;</span>&gt;</span>çˆ¬å±±<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;climb&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;climb&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;code&quot;</span>&gt;</span>å†™ä»£ç <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;code&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;code&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æäº¤ç”¨æˆ·ä¿¡æ¯&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;alert(&#x27;æ¯å¤©è¿›æ­¥ä¸€å˜ç±³ï¼ŒåŠ æ²¹æ‰“å·¥äººï¼ï¼ï¼&#x27;)&quot;</span>&gt;</span>ç‚¹æˆ‘é€ä½ ä¸€å¥è¯<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p>1ã€åˆå§‹æ•ˆæœ</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/71ac3411006349049835cc93cf163c41~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018163152674.png"></p><p>2ã€å¡«å†™ç”¨æˆ·ä¿¡æ¯å¹¶æäº¤æœåŠ¡å™¨</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc2d911a71074a13b4ae4ffdd8c489b9~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018163248560.png"></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62f6ac93a36742beb1a8b5fb34307bb1~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018163308247.png"></p><p>3ã€ç‚¹å‡»<code>ç‚¹æˆ‘é€ä½ ä¸€å¥è¯</code>æŒ‰é’®</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/181a0e11ece34a43bb4bce0e05a9d0ac~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018163429448.png"></p><h2 id="åäºŒã€æ¡†æ¶-iframe-å†…åµŒç½‘é¡µ"><a href="#åäºŒã€æ¡†æ¶-iframe-å†…åµŒç½‘é¡µ" class="headerlink" title="åäºŒã€æ¡†æ¶ iframe(å†…åµŒç½‘é¡µ)"></a>åäºŒã€æ¡†æ¶ iframe(å†…åµŒç½‘é¡µ)</h2><p>1ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ iframe æ ‡ç­¾å†…åµŒä¸€ä¸ªç½‘é¡µ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://www.hao123.com/&quot;</span>  &gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å±æ€§</p><table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>width</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>å®šä¹‰æŒ‰é’®çš„åç§°ï¼Œä¹Ÿç”¨äºæäº¤æœåŠ¡å™¨çš„ key</td></tr><tr><td>height</td><td>pixels ï¼šåƒç´ å€¼<br/>% ï¼šç™¾åˆ†æ¯”</td><td>è§„å®šæŒ‰é’®çš„ç±»å‹</td></tr><tr><td>frameborder</td><td>1 ï¼šæœ‰è¾¹æ¡†<br/>0 ï¼šæ— è¾¹æ¡†</td><td>è§„å®šæ˜¯å¦æ˜¾ç¤º iframe æ ‡ç­¾çš„è¾¹æ¡†</td></tr><tr><td>src</td><td>url</td><td>ç›®æ ‡ç½‘é¡µé“¾æ¥</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>iframeæ ‡ç­¾<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>iframe æ ‡ç­¾ç”¨äºå†…åµŒä¸€ä¸ªç½‘é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://www.hao123.com/&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600px&quot;</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b24d00fdbfe427a82bf727c514f2a4d~tplv-k3u1fbpfcp-watermark.image" alt="image-20221018164537784.png"></p><h2 id="åä¸‰ã€æ€»ç»“"><a href="#åä¸‰ã€æ€»ç»“" class="headerlink" title="åä¸‰ã€æ€»ç»“"></a>åä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€HTML åŸºç¡€è¯­æ³•</p><p>2ã€HTML å¸¸ç”¨æ ‡ç­¾å’Œå±æ€§ï¼š</p><blockquote><p>1ã€æ ‡é¢˜ï¼šh1~h6</p><p>2ã€æ®µè½ï¼šp</p><p>3ã€HTML æ–‡æœ¬æ ¼å¼åŒ–æ ‡ç­¾ï¼šbï¼Œstrongï¼Œiï¼Œemï¼Œsï¼Œdelï¼Œuï¼Œsupï¼Œsubï¼Œhr</p><p>4ã€HTML ä¸­çš„ç‰¹æ®Šç¬¦å·ï¼š<code>&amp;lt;</code>ï¼Œ<code>&amp;gt;</code>ï¼Œ<code>&amp;emsp;</code>ï¼Œ<code>&amp;copy;</code>ï¼Œ<code>&amp;trade;</code>ï¼Œ<code>&amp;reg;</code></p><p>5ã€åŒºï¼šdiv å’Œ span</p><p>6ã€åˆ—è¡¨ï¼šol + liï¼Œul + liï¼Œdl + dt + dd</p><p>7ã€å›¾ç‰‡ï¼šimg</p><p>8ã€è¶…é“¾æ¥ï¼ša</p><p>9ã€HTML è¡¨æ ¼ï¼štableï¼Œcaptionï¼Œthï¼Œtrï¼Œtd</p><p>10ã€HTML è¡¨å•ï¼šformï¼Œinputï¼Œlabelï¼Œselect + optionï¼Œbutton</p><p>11ã€æ¡†æ¶ iframe</p></blockquote><p>3ã€å­¦ä¹ æ ‡ç­¾ååšçš„ç»¼åˆæ¡ˆä¾‹</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV17z4y1D7Yj/">bç«™webå…¥é—¨æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚ï¼ŒæåŠ›æ¨è</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="https://link.juejin.cn/?target=http://m6z.cn/6jwi7b" title="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>Web å¿«é€Ÿå…¥é—¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šRxJava æ ¸å¿ƒè§£å¯†</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9ARxJava%20%E6%A0%B8%E5%BF%83%E8%A7%A3%E5%AF%86/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9ARxJava%20%E6%A0%B8%E5%BF%83%E8%A7%A3%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95599612f89a4939b24dc92b23a41f5a~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒRxJava æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼Œå®ƒèƒ½å°†å¤æ‚çš„é€»è¾‘ç®€å•åŒ–ï¼Œæé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ï¼Œä¸€ä¸ªè¿™ä¹ˆå¥½ç”¨çš„åº“ï¼Œæ¥è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹å§ğŸº</p><p>ä¸‹é¢æˆ‘æŠ›å‡ºä¸€äº›é—®é¢˜ï¼Œå¦‚æœä½ éƒ½çŸ¥é“ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ å¯¹ RxJava æŒæ¡çš„å¾ˆé€å½»ï¼Œå¦‚æœä½ å¯¹ä¸‹é¢è¿™äº›é—®é¢˜æœ‰ä¸€äº›ç–‘æƒ‘ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æ¥ç€å¾€ä¸‹çœ‹ï¼Œæˆ‘ä¼šç”±æµ…å…¥æ·±çš„ç»™ä½ è®²è§£ RxJavaï¼Œçœ‹å®Œä¹‹åï¼Œè¿™äº›é—®é¢˜ä½ ä¼šéå¸¸æ˜äº†</p><p>1ã€ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿä»€ä¹ˆæ˜¯è£…é¥°è€…æ¨¡å¼ï¼Ÿ</p><p>2ã€è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè£…é¥°è€…æ¨¡å¼åœ¨ RxJava ä¸­çš„åº”ç”¨ï¼Ÿ</p><p>3ã€RxJava map å’Œ flatMap æ“ä½œç¬¦æœ‰å•¥åŒºåˆ«ï¼Ÿ</p><p>4ã€å¦‚æœæœ‰å¤šä¸ª subscribeOn ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæƒ…å†µï¼Ÿä¸ºå•¥ï¼Ÿ</p><p>5ã€å¦‚æœæœ‰å¤šä¸ª observeOn ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæƒ…å†µï¼Ÿä¸ºå•¥ï¼Ÿ</p><p>6ã€RxJava æ¡†æ¶æµæ€æƒ³è®¾è®¡ï¼Ÿ</p><p>7ã€RxJava çš„ Subject æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>8ã€å¦‚ä½•é€šè¿‡ RxJava å®ç°ä¸€ä¸ªè‡ªå·±çš„äº‹ä»¶æ€»çº¿ï¼Ÿ</p><h2 id="ä¸€ã€è®¾è®¡æ¨¡å¼ä»‹ç»"><a href="#ä¸€ã€è®¾è®¡æ¨¡å¼ä»‹ç»" class="headerlink" title="ä¸€ã€è®¾è®¡æ¨¡å¼ä»‹ç»"></a>ä¸€ã€è®¾è®¡æ¨¡å¼ä»‹ç»</h2><p>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ä¸‹é¢ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼š</p><p>1ã€è§‚å¯Ÿè€…æ¨¡å¼</p><p>2ã€è£…é¥°è€…æ¨¡å¼</p><h3 id="1-1ã€è§‚å¯Ÿè€…æ¨¡å¼"><a href="#1-1ã€è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="1.1ã€è§‚å¯Ÿè€…æ¨¡å¼"></a>1.1ã€è§‚å¯Ÿè€…æ¨¡å¼</h3><h4 id="1-1-1ã€è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰"><a href="#1-1-1ã€è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰" class="headerlink" title="1.1.1ã€è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰"></a>1.1.1ã€è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰</h4><p>ç®€å•çš„ç†è§£ï¼šå¯¹è±¡é—´å­˜åœ¨ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°</p><h4 id="1-1-2ã€è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹"><a href="#1-1-2ã€è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹" class="headerlink" title="1.1.2ã€è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹"></a>1.1.2ã€è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¥æ”¶äº‹ä»¶çš„æ–¹æ³•</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onChange</span><span class="hljs-params">(o: <span class="hljs-type">Any</span>)</span></span><br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observable</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ è§‚å¯Ÿè€…</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç§»é™¤è§‚å¯Ÿè€…</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘é€äº‹ä»¶é€šçŸ¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">changeEvent</span><span class="hljs-params">(o: <span class="hljs-type">Any</span>)</span></span><br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObserverImpl</span>: <span class="hljs-type">Observer</span> &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onChange</span><span class="hljs-params">(o: <span class="hljs-type">Any</span>)</span></span> &#123;<br>      <span class="hljs-comment">//å¯¹äº‹ä»¶è¿›è¡Œæ‰“å°</span><br>        println(o)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableImpl</span>: <span class="hljs-type">Observable</span> &#123;<br><br>    <span class="hljs-comment">//å­˜æ”¾è§‚å¯Ÿè€…çš„é›†åˆ</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observerList: MutableList&lt;Observer&gt; = LinkedList()<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span> &#123;<br>        observerList.add(observer)<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span> &#123;<br>        observerList.remove(observer)<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">changeEvent</span><span class="hljs-params">(o: <span class="hljs-type">Any</span>)</span></span> &#123;<br>        <span class="hljs-keyword">for</span> (observer <span class="hljs-keyword">in</span> observerList) &#123;<br>            observer.onChange(o)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//1ã€åˆ›å»ºè¢«è§‚å¯Ÿè€…</span><br>    <span class="hljs-keyword">val</span> observable = ObservableImpl()<br>    <span class="hljs-comment">//2ã€åˆ›å»ºè§‚å¯Ÿè€…</span><br>    <span class="hljs-keyword">val</span> observer1 = ObserverImpl()<br>    <span class="hljs-keyword">val</span> observer2 = ObserverImpl()<br>    <span class="hljs-keyword">val</span> observer3 = ObserverImpl()<br>    <span class="hljs-comment">//3ã€æ·»åŠ è§‚å¯Ÿè€…</span><br>    observable.addObserver(observer1)<br>    observable.addObserver(observer2)<br>    observable.addObserver(observer3)<br>    <span class="hljs-comment">//4ã€å‘é€äº‹ä»¶</span><br>    observable.changeEvent(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br>erdai666<br>erdai666<br></code></pre></td></tr></table></figure><h3 id="1-2ã€è£…é¥°è€…æ¨¡å¼"><a href="#1-2ã€è£…é¥°è€…æ¨¡å¼" class="headerlink" title="1.2ã€è£…é¥°è€…æ¨¡å¼"></a>1.2ã€è£…é¥°è€…æ¨¡å¼</h3><h4 id="1-2-1ã€è£…é¥°è€…æ¨¡å¼å®šä¹‰"><a href="#1-2-1ã€è£…é¥°è€…æ¨¡å¼å®šä¹‰" class="headerlink" title="1.2.1ã€è£…é¥°è€…æ¨¡å¼å®šä¹‰"></a>1.2.1ã€è£…é¥°è€…æ¨¡å¼å®šä¹‰</h4><p>ç®€å•çš„ç†è§£ï¼šåŠ¨æ€çš„ç»™ä¸€ä¸ªç±»è¿›è¡ŒåŠŸèƒ½å¢å¼º</p><h4 id="1-2-2ã€è£…é¥°è€…æ¨¡å¼ç¤ºä¾‹"><a href="#1-2-2ã€è£…é¥°è€…æ¨¡å¼ç¤ºä¾‹" class="headerlink" title="1.2.2ã€è£…é¥°è€…æ¨¡å¼ç¤ºä¾‹"></a>1.2.2ã€è£…é¥°è€…æ¨¡å¼ç¤ºä¾‹</h4><p>ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘æƒ³åƒä¸ªè›‹ç‚’é¥­ï¼Œä½†æ˜¯å•ç‹¬ä¸€ä¸ªè›‹ç‚’é¥­æˆ‘è§‰å¾—ä¸å¥½åƒï¼Œæˆ‘æƒ³åœ¨ä¸Šé¢åŠ ç«è…¿ï¼ŒåŠ ç‰›è‚‰ã€‚æˆ‘ä»¬ä½¿ç”¨è£…é¥°è€…æ¨¡å¼æ¥å®ç°å®ƒ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Rice</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cook</span><span class="hljs-params">()</span></span><br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­æ¥å£çš„å®ç°ç±»ï¼šè›‹ç‚’é¥­</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">EggFriedRice</span>: <span class="hljs-type">Rice</span> &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cook</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;è›‹ç‚’é¥­&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªç‚’é¥­çš„æŠ½è±¡è£…é¥°ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RiceDecorate</span>(<span class="hljs-keyword">var</span> rice: Rice): Rice<br><br><span class="hljs-comment">//4ã€å¾€è›‹ç‚’é¥­ä¸­åŠ ç«è…¿</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HamFriedRiceDecorate</span>(rice: Rice): RiceDecorate(rice) &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cook</span><span class="hljs-params">()</span></span> &#123;<br>        rice.cook()<br>        println(<span class="hljs-string">&quot;åŠ ç«è…¿&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€å¾€è›‹ç‚’é¥­ä¸­åŠ ç‰›è‚‰</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BeefFriedRiceDecorate</span>(rice: Rice): RiceDecorate(rice) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cook</span><span class="hljs-params">()</span></span> &#123;<br>        rice.cook()<br>        println(<span class="hljs-string">&quot;åŠ ç‰›è‚‰&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//6ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//è›‹ç‚’é¥­</span><br>    <span class="hljs-keyword">val</span> rice = EggFriedRice()<br>    <span class="hljs-comment">//åŠ ç«è…¿</span><br>    <span class="hljs-keyword">val</span> hamFriedRiceDecorate = HamFriedRiceDecorate(rice)<br>    <span class="hljs-comment">//åŠ ç‰›è‚‰</span><br>    <span class="hljs-keyword">val</span> beefFriedRiceDecorate = BeefFriedRiceDecorate(hamFriedRiceDecorate)<br>    beefFriedRiceDecorate.cook()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>è›‹ç‚’é¥­<br>åŠ ç«è…¿<br>åŠ ç‰›è‚‰<br></code></pre></td></tr></table></figure><p>è£…é¥°è€…æ¨¡å¼çš„æ ¸å¿ƒï¼šå®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„è£…é¥°ç±»ç»§æ‰¿é¡¶çº§æ¥å£ï¼Œç„¶åæŒæœ‰è¿™ä¸ªé¡¶çº§æ¥å£çš„å¼•ç”¨ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œæ— é™å¥—å¨ƒäº†ğŸ˜„</p><h2 id="äºŒã€æ‰‹æ’¸-RxJava-æ ¸å¿ƒæºç å®ç°"><a href="#äºŒã€æ‰‹æ’¸-RxJava-æ ¸å¿ƒæºç å®ç°" class="headerlink" title="äºŒã€æ‰‹æ’¸ RxJava æ ¸å¿ƒæºç å®ç°"></a>äºŒã€æ‰‹æ’¸ RxJava æ ¸å¿ƒæºç å®ç°</h2><p>okï¼Œäº†è§£äº†ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ­£å¼è¿›å…¥ RxJava çš„å­¦ä¹ </p><h3 id="2-1ã€RxJava-ä»‹ç»"><a href="#2-1ã€RxJava-ä»‹ç»" class="headerlink" title="2.1ã€RxJava ä»‹ç»"></a>2.1ã€RxJava ä»‹ç»</h3><p>RxJava æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œæ¡†æ¶ï¼Œå…¶æ ¸å¿ƒå¯ä»¥å½’çº³ä¸ºä¸¤ç‚¹ï¼š1ã€å¼‚æ­¥äº‹ä»¶æµ 2ã€å“åº”å¼ç¼–ç¨‹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥å¥½å¥½çš„å»æ„Ÿå—è¿™ä¸¤ç‚¹</p><h3 id="2-2ã€RxJava-æ“ä½œç¬¦"><a href="#2-2ã€RxJava-æ“ä½œç¬¦" class="headerlink" title="2.2ã€RxJava æ“ä½œç¬¦"></a>2.2ã€RxJava æ“ä½œç¬¦</h3><p>RxJava ä¹‹æ‰€ä»¥å¼ºå¤§æºäºå®ƒå„ç§å¼ºå¤§çš„æ“ä½œç¬¦ï¼ŒæŒæ¡å¥½è¿™äº›æ“ä½œç¬¦èƒ½è®©ä½ å¯¹ RxJava çš„ä½¿ç”¨å¾—å¿ƒåº”æ‰‹ï¼ŒRxJava æ“ä½œç¬¦ä¸»è¦åˆ†ä¸º 6 å¤§ç±»ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86c610f277a04ab786cd788ffb73a32c~tplv-k3u1fbpfcp-watermark.image?" alt="RxJava æ“ä½œç¬¦.png" width="100%" /><p>æ¯ä¸€ä¸ªæ“ä½œç¬¦èƒŒåéƒ½å¯¹åº”äº†ä¸€ä¸ªå…·ä½“çš„å®ç°ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æŒ‘å‡ ä¸ªæœ€å¸¸ç”¨ï¼Œæœ€æ ¸å¿ƒçš„æ“ä½œç¬¦ï¼šcreateï¼Œmapï¼ŒflatMapï¼ŒobserveOnï¼ŒsubscribeOn è¿›è¡Œæ‰‹æ’¸å®ç°ï¼Œç›¸ä¿¡çœ‹å®Œè¿™äº›æ“ä½œç¬¦çš„å®ç°åï¼Œä½ èƒ½èä¼šè´¯é€šï¼Œä¸¾ä¸€åä¸‰</p><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢è¿™äº›æ“ä½œç¬¦çš„å®ç°å’Œ RxJava å®ç°ç»†èŠ‚ä¸å°½ç›¸åŒï¼Œä½†æ ¸å¿ƒæ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œå¤§å®¶åªè¦ç†è§£æ ¸å¿ƒæ€æƒ³å°±å¥½</p><h3 id="2-3ã€create-æ“ä½œç¬¦å®ç°"><a href="#2-3ã€create-æ“ä½œç¬¦å®ç°" class="headerlink" title="2.3ã€create æ“ä½œç¬¦å®ç°"></a>2.3ã€create æ“ä½œç¬¦å®ç°</h3><p>create æ˜¯æ¥åˆ›å»ºä¸€ä¸ªè¢«è§‚å¯Ÿè€…å¯¹è±¡ï¼Œçœ‹äº† RxJava create æ“ä½œç¬¦æºç ä½ ä¼šå‘ç°ï¼š</p><p>1ã€create æ˜¯ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°çš„ï¼Œä½† RxJava é‡Œé¢ä½¿ç”¨çš„è§‚å¯Ÿè€…æ¨¡å¼å’Œæˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„è¿˜æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯ä¸€ç§å˜ç§çš„è§‚å¯Ÿè€…æ¨¡å¼</p><p>2ã€ä¸Šé¢ä¾‹å­ä¸­æˆ‘ä»¬æ˜¯é€šè¿‡è¢«è§‚å¯Ÿè€…å»å‘é€äº‹ä»¶ï¼Œè€Œ RxJava é‡Œé¢å®šä¹‰äº†ä¸“é—¨å‘é€äº‹ä»¶çš„æ¥å£ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯è®©è¢«è§‚å¯Ÿè€…å’Œå‘å°„äº‹ä»¶è¿›è¡Œè§£è€¦</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…çš„é¡¶çº§æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br>    <span class="hljs-comment">//å»ºç«‹äº†è®¢é˜…å…³ç³»</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span><br>    <span class="hljs-comment">//æ¥æ”¶åˆ°æ­£å¸¸äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span><br>    <span class="hljs-comment">//æ¥æ”¶åˆ° error äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span><br>    <span class="hljs-comment">//æ¥æ”¶åˆ° onComplete äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span><br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„é¡¶çº§æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ObservableSource</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br>    <span class="hljs-comment">//è®¢é˜…è§‚å¯Ÿè€…</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span><br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…æŠ½è±¡ç±»å®ç°é¡¶å±‚è¢«è§‚å¯Ÿè€…æ¥å£</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observable</span>&lt;<span class="hljs-type">T</span>&gt;: <span class="hljs-type">ObservableSource</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> &#123;<br>        subscribeActual(observer)<br>    &#125;<br><br>    <span class="hljs-comment">//å®é™…è®¢é˜…è§‚å¯Ÿè€…çš„æŠ½è±¡æ–¹æ³•ï¼Œè®©å­ç±»å»å®ç°</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span><br><br>    <span class="hljs-comment">//ä¼´ç”Ÿç±»é‡Œé¢çš„æ–¹æ³•ï¼Œç›´æ¥é€šè¿‡ç±»åè°ƒç”¨    </span><br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>      <span class="hljs-comment">//è¿™é‡Œæ˜¯æˆ‘ä»¬å®ç° create æ“ä½œç¬¦å¯¹å¤–æä¾›å’Œ RxJava ç±»ä¼¼çš„æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(source: <span class="hljs-type">ObservableOnSubscribe</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: ObservableCreate&lt;T&gt;&#123;<br>            <span class="hljs-keyword">return</span> ObservableCreate(source)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®šä¹‰ä¸€ä¸ªä¸è¢«è§‚å¯Ÿè€…å‘å°„äº‹ä»¶è§£è€¦çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ObservableOnSubscribe</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br>    <span class="hljs-comment">//é€šè¿‡ Emitter å‘å°„äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span><br>&#125;<br><br><span class="hljs-comment">//5ã€å®šä¹‰äº‹ä»¶å‘å°„å™¨æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Emitter</span>&lt;<span class="hljs-type">T</span>&gt; &#123;<br>    <span class="hljs-comment">//å‘é€ onNext äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span><br>    <span class="hljs-comment">//å‘é€ onError äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span><br>    <span class="hljs-comment">//å‘é€ onComplete äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span><br>&#125;<br><br><span class="hljs-comment">//6ã€å®šä¹‰ create æ“ä½œç¬¦çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableCreate</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">var</span> source: ObservableOnSubscribe&lt;T&gt;): Observable&lt;T&gt;() &#123;<br><br>    <span class="hljs-comment">//å®ç°çˆ¶ç±»è®¢é˜…è§‚å¯Ÿè€…çš„æ–¹æ³•</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(downStream: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> &#123;<br>      <span class="hljs-comment">//å¯ä»¥çœ‹åˆ°åªè¦ä¸€è®¢é˜…ï¼Œé¦–å…ˆå°±ä¼šæ¥æ”¶ onSubscribe äº‹ä»¶</span><br>        downStream.onSubscribe()<br>      <span class="hljs-comment">//é€šè¿‡ ObservableOnSubscribe é‡Œé¢çš„ Emitter è¿›è¡Œäº‹ä»¶çš„å‘é€ï¼Œå®Œæˆè¢«è§‚å¯Ÿè€…å‘é€äº‹ä»¶çš„è§£è€¦</span><br>        source.subscribe(CreateEmitter(downStream))<br>    &#125;<br><br>    <span class="hljs-comment">//äº‹ä»¶å‘å°„å™¨å®ç°ç±»ï¼Œå¯ä»¥çœ‹åˆ°ä¼ å…¥äº†ä¸‹æ¸¸çš„è§‚å¯Ÿè€…æ¥æ¥æ”¶æˆ‘ä»¬å‘å°„çš„äº‹ä»¶</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateEmitter</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">var</span> downStream: Observer&lt;T&gt;): Emitter&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>            downStream.onNext(t)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>            downStream.onError(e)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            downStream.onComplete()<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//7ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>            <span class="hljs-comment">//å‘å°„ onNext äº‹ä»¶</span><br>            emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>            <span class="hljs-comment">//å‘å°„ onComplete äº‹ä»¶</span><br>            emitter.onComplete()<br>        &#125;<br>    &#125;).subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onSubscribe&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>        &#125;<br>    &#125;)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribe<br>onNextï¼šerdai666<br>onComplete<br></code></pre></td></tr></table></figure><p>okï¼Œä¸Šè¿°ä»£ç å°±æ˜¯ create æ“ä½œç¬¦çš„å®ç°ï¼Œå¤§å®¶å¦‚æœæ²¡çœ‹æ˜ç™½å¯ä»¥å¤šçœ‹å‡ éï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠæˆ‘ä¸Šé¢çš„ä»£ç ç›´æ¥æ‹·è´åˆ°ä¸€ä¸ª kt æ–‡ä»¶ä¸­å»è¿è¡Œ</p><h3 id="2-4ã€map-æ“ä½œç¬¦å®ç°"><a href="#2-4ã€map-æ“ä½œç¬¦å®ç°" class="headerlink" title="2.4ã€map æ“ä½œç¬¦å®ç°"></a>2.4ã€map æ“ä½œç¬¦å®ç°</h3><p>map æ˜¯ä¸€ä¸ªè½¬æ¢æ“ä½œç¬¦ï¼Œå®ƒèƒ½æŠŠä¸€ç§ç±»å‹è½¬ä¸ºä¸ºå¦å¤–ä¸€ç§ç±»å‹ï¼Œå¦‚ï¼šInt -&gt; Stringã€‚</p><p>å®ƒçš„ä¸»è¦å®ç°ï¼šè§‚å¯Ÿè€…æ¨¡å¼ + è£…é¥°è€…æ¨¡å¼ + æ³›å‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæŠ½è±¡è£…é¥°ç±»ï¼Œæ³¨æ„é‡Œé¢æ³›å‹çš„ä½¿ç”¨</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractObservableWithUpstream</span>&lt;<span class="hljs-type">T,U</span>&gt;(<span class="hljs-keyword">var</span> source: ObservableSource&lt;T&gt;): Observable&lt;U&gt;()<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªç±»å‹è½¬æ¢çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Function</span>&lt;<span class="hljs-type">T,U</span>&gt; &#123;<br>    <span class="hljs-comment">//ä¼ å…¥ T ç±»å‹ï¼Œè¿”å› U ç±»å‹</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span>: U<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ map æ“ä½œç¬¦çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableMap</span>&lt;<span class="hljs-type">T,U</span>&gt;(source: ObservableSource&lt;T&gt;,<span class="hljs-keyword">var</span> function: Function&lt;T,U&gt;): AbstractObservableWithUpstream&lt;T,U&gt;(source) &#123;<br><br>    <span class="hljs-comment">//å®ç°çˆ¶ç±»è®¢é˜…è§‚å¯Ÿè€…çš„æ–¹æ³•</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">U</span>&gt;)</span></span> &#123;<br>      <span class="hljs-comment">//æ¥æ”¶ onSubscribe äº‹ä»¶</span><br>        observer.onSubscribe()<br>      <span class="hljs-comment">//å®Œæˆäº‹ä»¶çš„è½¬æ¢</span><br>        source.subscribe(MapObserver(function,observer))<br>    &#125;<br><br>    <span class="hljs-comment">//MapObserver æ¥æ”¶ function å¯¹ç±»å‹è¿›è¡Œè½¬æ¢ï¼ŒdownStream å¯¹äº‹ä»¶è¿›è¡Œæ¥æ”¶</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">MapObserver</span>&lt;<span class="hljs-type">T,U</span>&gt;(<span class="hljs-keyword">var</span> function: Function&lt;T,U&gt;,<span class="hljs-keyword">var</span> downStream: Observer&lt;U&gt;): Observer&lt;T&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>            <span class="hljs-comment">//æ ¸å¿ƒï¼šå½“æ¥æ”¶åˆ° T ç±»å‹ï¼Œè°ƒç”¨ function.apply è½¬æ¢ä¸º U ç±»å‹</span><br>            <span class="hljs-keyword">val</span> u: U = function.apply(t)<br>            downStream.onNext(u)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>            downStream.onError(e)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            downStream.onComplete()<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€Observable ä¸­å¢åŠ ç›¸åº”çš„è°ƒç”¨æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;U&gt;</span> <span class="hljs-title">map</span><span class="hljs-params">(function: <span class="hljs-type">Function</span>&lt;<span class="hljs-type">T</span>, U&gt;)</span></span>: ObservableMap&lt;T,U&gt;&#123;<br>    <span class="hljs-keyword">return</span> ObservableMap(<span class="hljs-keyword">this</span>, function)<br>&#125;<br><br><span class="hljs-comment">//5ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>            emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>            emitter.onComplete()<br>        &#125;<br>    &#125;)<br>        .map(<span class="hljs-keyword">object</span> : Function&lt;String,String&gt;&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span>: String &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;map è½¬æ¢ï¼š<span class="hljs-variable">$t</span>&quot;</span><br>            &#125;<br>        &#125;)<br>        .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onSubscribe&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>        &#125;<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribe<br>onNextï¼šmap è½¬æ¢ï¼šerdai666<br>onComplete<br></code></pre></td></tr></table></figure><h3 id="2-5ã€flatMap-æ“ä½œç¬¦å®ç°"><a href="#2-5ã€flatMap-æ“ä½œç¬¦å®ç°" class="headerlink" title="2.5ã€flatMap æ“ä½œç¬¦å®ç°"></a>2.5ã€flatMap æ“ä½œç¬¦å®ç°</h3><p>flatMap æ“ä½œç¬¦çš„å®ç°å…¶å®å’Œ map ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯æŠŠ ï¼šFunction&lt;T, U&gt; -&gt; Function&lt;T, ObservableSource&gt; ï¼Œå°†ä¸€ç§ç±»å‹è½¬æ¢ä¸ºäº†ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„ç±»å‹ï¼Œè¢«è§‚å¯Ÿè€…çš„ç±»å‹åˆå¯ä»¥è¿›è¡Œä¸€ç³»åˆ—çš„è½¬æ¢ï¼Œå› æ­¤èƒ½æ‹†åˆ†æ›´ç»†çš„ç²’åº¦ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ flatMap æ“ä½œç¬¦çš„å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableFlatMap</span>&lt;<span class="hljs-type">T,U</span>&gt;(source: ObservableSource&lt;T&gt;,<span class="hljs-keyword">var</span> function: Function&lt;T,ObservableSource&lt;U&gt;&gt;): AbstractObservableWithUpstream&lt;T,U&gt;(source) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">U</span>&gt;)</span></span> &#123;<br>        observer.onSubscribe()<br>        source.subscribe(FlatMapObserver(function,observer))<br>    &#125;<br><br>    <span class="hljs-comment">//FlatMapObserver æ¥æ”¶ function å¯¹ç±»å‹è¿›è¡Œè½¬æ¢ï¼ŒdownStream å¯¹äº‹ä»¶è¿›è¡Œæ¥æ”¶</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlatMapObserver</span>&lt;<span class="hljs-type">T,U</span>&gt;(<span class="hljs-keyword">var</span> function: Function&lt;T,ObservableSource&lt;U&gt;&gt;, <span class="hljs-keyword">var</span> downStream: Observer&lt;U&gt;): Observer&lt;T&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>            <span class="hljs-comment">//æ ¸å¿ƒï¼šå½“æ¥æ”¶åˆ° T ç±»å‹ï¼Œè°ƒç”¨ function.apply è½¬æ¢ä¸º ObservableSource&lt;U&gt; ç±»å‹</span><br>            <span class="hljs-keyword">val</span> u: ObservableSource&lt;U&gt; = function.apply(t)<br>            <span class="hljs-comment">//å¯¹ u è¿›è¡Œæ›´ç»†ç²’åº¦çš„æ‹†åˆ†ï¼Œåœ¨è®©ä¸‹æ¸¸è§‚å¯Ÿè€…è¿›è¡Œæ¥æ”¶</span><br>            u.subscribe(<span class="hljs-keyword">object</span> : Observer&lt;U&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br><br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">U</span>)</span></span> &#123;<br>                    downStream.onNext(t)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br><br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br><br>                &#125;<br>            &#125;)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>            downStream.onError(e)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            downStream.onComplete()<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€Observable ä¸­å¢åŠ ç›¸åº”çš„è°ƒç”¨æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;U&gt;</span> <span class="hljs-title">flatMap</span><span class="hljs-params">(function: <span class="hljs-type">Function</span>&lt;<span class="hljs-type">T</span>,ObservableSource&lt;U&gt;&gt;)</span></span>: ObservableFlatMap&lt;T,U&gt;&#123;<br>    <span class="hljs-keyword">return</span> ObservableFlatMap(<span class="hljs-keyword">this</span>,function)<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>            emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>            emitter.onComplete()<br>        &#125;<br>    &#125;).flatMap(<span class="hljs-keyword">object</span> : Function&lt;String,ObservableSource&lt;String&gt;&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span>: ObservableSource&lt;String&gt; &#123;<br>            <span class="hljs-keyword">return</span> Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                    emitter.onNext(<span class="hljs-string">&quot;flatMapï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                &#125;<br>            &#125;)<br>        &#125;<br><br>    &#125;)<br>        .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onSubscribe&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>        &#125;<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribe<br>onNextï¼šflatMapï¼šerdai666<br>onComplete<br></code></pre></td></tr></table></figure><h3 id="2-6ã€subscribeOn-æ“ä½œç¬¦å®ç°"><a href="#2-6ã€subscribeOn-æ“ä½œç¬¦å®ç°" class="headerlink" title="2.6ã€subscribeOn æ“ä½œç¬¦å®ç°"></a>2.6ã€subscribeOn æ“ä½œç¬¦å®ç°</h3><p>subscribeOn ä¸»è¦æ˜¯ç”¨æ¥å†³å®šæˆ‘ä»¬è®¢é˜…è§‚å¯Ÿè€…æ˜¯åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„è°ƒåº¦å™¨</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Scheduler</span> &#123;<br><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createWorker</span><span class="hljs-params">()</span></span>: Worker<br>    <br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„ Worker</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Worker</span>&#123;<br>      <span class="hljs-comment">//çœŸæ­£å†³å®šçº¿ç¨‹æ‰§è¡Œ</span><br>        <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">schedule</span><span class="hljs-params">(runnable: <span class="hljs-type">Runnable</span>)</span></span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰è°ƒåº¦å™¨çš„å®ç°ç±»ï¼Œæˆ‘ä»¬ä¸»è¦å®ç°ä¸¤ç§ï¼š</span><br><span class="hljs-comment">//2.1ã€AndroidMainSchedulerï¼šAndroid ä¸»çº¿ç¨‹</span><br><span class="hljs-comment">//å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°±æ˜¯ä½¿ç”¨ Handler å°†çº¿ç¨‹åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidMainScheduler</span>(<span class="hljs-keyword">var</span> handler: Handler): Scheduler() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createWorker</span><span class="hljs-params">()</span></span>: Worker &#123;<br>        <span class="hljs-keyword">return</span> AndroidMainWorker(handler)<br>    &#125;<br>    <br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidMainWorker</span>(<span class="hljs-keyword">var</span> handler: Handler): Worker()&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">schedule</span><span class="hljs-params">(runnable: <span class="hljs-type">Runnable</span>)</span></span> &#123;<br>            handler.post(runnable)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2.2ã€NewThreadSchedulerï¼šå¼€å¯ä¸€ä¸ªæ–°çš„å­çº¿ç¨‹</span><br><span class="hljs-comment">//å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°±æ˜¯ä½¿ç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œ runnable</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NewThreadScheduler</span>(<span class="hljs-keyword">var</span> executorService: ExecutorService): Scheduler() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createWorker</span><span class="hljs-params">()</span></span>: Worker &#123;<br>        <span class="hljs-keyword">return</span> NewThreadWork(executorService)<br>    &#125;<br>  <br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewThreadWork</span>(<span class="hljs-keyword">var</span> executorService: ExecutorService): Worker()&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">schedule</span><span class="hljs-params">(runnable: <span class="hljs-type">Runnable</span>)</span></span> &#123;<br>            executorService.execute(runnable)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨çš„å·¥å…·ç±»ï¼Œç±»ä¼¼ RxJava çš„è°ƒç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Schedulers</span> &#123;<br>  <br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>      <span class="hljs-comment">//åˆ‡æ¢åˆ°å­çº¿ç¨‹</span><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">newThread</span><span class="hljs-params">()</span></span>: NewThreadScheduler&#123;<br>            <span class="hljs-keyword">return</span> NewThreadScheduler(Executors.newScheduledThreadPool(<span class="hljs-number">2</span>))<br>        &#125;<br><br>      <span class="hljs-comment">//åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹</span><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mainThread</span><span class="hljs-params">()</span></span>: AndroidMainScheduler&#123;<br>            <span class="hljs-keyword">return</span> AndroidMainScheduler(Handler(Looper.getMainLooper()))<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€å®šä¹‰ subscribeOn æ“ä½œç¬¦å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableSubscribeOn</span>&lt;<span class="hljs-type">T</span>&gt;(source: ObservableSource&lt;T&gt;,<span class="hljs-keyword">var</span> scheduler: Scheduler): AbstractObservableWithUpstream&lt;T,T&gt;(source) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> &#123;<br>      <span class="hljs-comment">//æ¥æ”¶è®¢é˜…äº‹ä»¶</span><br>        observer.onSubscribe()<br>      <span class="hljs-comment">//åˆ›å»º Worker å†³å®šæˆ‘ä»¬ä»£ç æ‰€æ‰§è¡Œçš„çº¿ç¨‹</span><br>        <span class="hljs-keyword">val</span> worker = scheduler.createWorker()<br>        worker.schedule(SubscribeTask(SubscribeOnObserver(observer)))<br>    &#125;<br><br><br>    <span class="hljs-comment">//å¯ä»¥çœ‹åˆ°ï¼ŒRunnable é‡Œé¢å°±åªåšäº†ä¸€ä¸ªè®¢é˜…æ“ä½œï¼Œå› æ­¤ subscribeOn ä¼šå†³å®šæˆ‘ä»¬è®¢é˜…è§‚å¯Ÿè€…çš„çº¿ç¨‹</span><br>    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubscribeTask</span>(<span class="hljs-keyword">var</span> observer: SubscribeOnObserver&lt;T&gt;): Runnable&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> &#123;<br>            source.subscribe(observer)<br>        &#125;<br>    &#125;<br>  <br>    <span class="hljs-comment">//å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ observeOn åˆ‡æ¢çº¿ç¨‹ï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…æ¥æ”¶äº‹ä»¶çš„çº¿ç¨‹ä¹Ÿä¼šç”± subscribeOn çº¿ç¨‹å†³å®š</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubscribeOnObserver</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">var</span> observer: Observer&lt;T&gt;): Observer&lt;T&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>            observer.onNext(t)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>            observer.onError(e)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            observer.onComplete()<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€Observable ä¸­å¢åŠ ç›¸åº”çš„è°ƒç”¨æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeOn</span><span class="hljs-params">(scheduler: <span class="hljs-type">Scheduler</span>)</span></span>: ObservableSubscribeOn&lt;T&gt;&#123;<br>    <span class="hljs-keyword">return</span> ObservableSubscribeOn(<span class="hljs-keyword">this</span>,scheduler)<br>&#125;<br><br><span class="hljs-comment">//6ã€æµ‹è¯•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Observable.create(<span class="hljs-keyword">object</span> :ObservableOnSubscribe&lt;String&gt;&#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>            emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>            emitter.onComplete()<br>            println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>        &#125;<br><br>    &#125;).subscribeOn(Schedulers.newThread())<br>        .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>                println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br>        &#125;)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribeï¼šmain<br>onNextï¼šerdai666<br>onNextï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span><br>onComplete<br>onCompleteï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span><br>subscribeï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹ä¸Šé¢çš„æ‰“å°ç»“æœï¼š</p><p>1ã€onSubscribe æ˜¯åœ¨ä¸€å¼€å§‹è®¢é˜…å°±è§¦å‘çš„ï¼Œæ­¤æ—¶ Worker éƒ½è¿˜æ²¡åˆ›å»ºï¼Œå› æ­¤æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„</p><p>2ã€å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ observeOn å¯¹è§‚å¯Ÿè€…æ¥æ”¶äº‹ä»¶çš„çº¿ç¨‹è¿›è¡Œåˆ‡æ¢ï¼Œæ‰€ä»¥ onNextï¼ŒonComplete æ¥æ”¶äº‹ä»¶çš„çº¿ç¨‹ç”± subscribeOn åˆ‡æ¢çš„çº¿ç¨‹å†³å®šï¼Œ</p><p>3ã€subscribe åœ¨æˆ‘ä»¬å®é™…è®¢é˜…è§‚å¯Ÿè€…çš„æ–¹æ³•é‡Œä¼šæ‰§è¡Œå®ƒï¼Œå› æ­¤æ˜¯ç”± subscribeOn åˆ‡æ¢çš„çº¿ç¨‹å†³å®š</p><h3 id="2-7ã€observeOn-æ“ä½œç¬¦å®ç°"><a href="#2-7ã€observeOn-æ“ä½œç¬¦å®ç°" class="headerlink" title="2.7ã€observeOn æ“ä½œç¬¦å®ç°"></a>2.7ã€observeOn æ“ä½œç¬¦å®ç°</h3><p>observeOn æ˜¯ç”¨æ¥å†³å®šæˆ‘ä»¬è§‚å¯Ÿè€…æ¥æ”¶äº‹ä»¶æ˜¯åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå®ç°ç›¸å¯¹å¤æ‚ä¸€ç‚¹ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªé˜Ÿåˆ—æ¥å­˜å‚¨å‘é€è¿‡æ¥çš„ onNext äº‹ä»¶ï¼Œç„¶åé€šè¿‡ While å¾ªç¯å¯¹é˜Ÿåˆ—ä¸­çš„äº‹ä»¶è¿›è¡Œå¤„ç†ï¼Œå…·ä½“å¤§å®¶å¯ä»¥çœ‹æˆ‘ä¸‹é¢çš„å®ç°ï¼Œå†™äº†è¯¦ç»†çš„æ³¨é‡Š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ observeOn æ“ä½œç¬¦å®ç°ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableObserveOn</span>&lt;<span class="hljs-type">T</span>&gt;(source: ObservableSource&lt;T&gt;, <span class="hljs-keyword">var</span> scheduler: Scheduler): AbstractObservableWithUpstream&lt;T, T&gt;(source) &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribeActual</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> &#123;<br>      <span class="hljs-comment">//æ¥æ”¶è®¢é˜…äº‹ä»¶</span><br>        observer.onSubscribe()<br>        <span class="hljs-keyword">val</span> worker = scheduler.createWorker()<br>        source.subscribe(ObserveOnObserver(observer,worker))<br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObserveOnObserver</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">var</span> observer: Observer&lt;T&gt;, <span class="hljs-keyword">var</span> worker: Scheduler.Worker, <span class="hljs-keyword">var</span> queue: Deque&lt;T&gt;? = <span class="hljs-literal">null</span>): Observer&lt;T&gt;,Runnable &#123;<br><br>        <span class="hljs-comment">//æ ‡è®°æ˜¯å¦äº‹ä»¶éƒ½å·²ç»æ¥æ”¶ï¼Œä¸€èˆ¬åœ¨ onError æˆ– onComplete æ—¶æ ‡è®°</span><br>        <span class="hljs-meta">@Volatile</span><br>        <span class="hljs-keyword">var</span> done = <span class="hljs-literal">false</span><br><br>        <span class="hljs-comment">//è®°å½• onError çš„å¼‚å¸¸</span><br>        <span class="hljs-meta">@Volatile</span><br>        <span class="hljs-keyword">var</span> throwable: Throwable? = <span class="hljs-literal">null</span><br><br>        <span class="hljs-comment">//æ˜¯å¦èƒ½ç»“æŸ While å¾ªç¯ï¼šä¾‹å¦‚è§‚å¯Ÿè€…æ¥æ”¶äº† onError æˆ– onComplete äº‹ä»¶ï¼Œå°±å¯ä»¥ç»“æŸå¾ªç¯äº†</span><br>        <span class="hljs-meta">@Volatile</span><br>        <span class="hljs-keyword">var</span> over = <span class="hljs-literal">false</span><br><br>        <span class="hljs-keyword">init</span> &#123;<br>            <span class="hljs-comment">//å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æ–°å»º</span><br>            <span class="hljs-keyword">if</span>(queue == <span class="hljs-literal">null</span>)&#123;<br>                queue = ArrayDeque()<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">T</span>)</span></span> &#123;<br>            <span class="hljs-keyword">if</span>(done)<span class="hljs-keyword">return</span><br>            <span class="hljs-comment">//å°†æ¥æ”¶çš„ onNext äº‹ä»¶åŠ å…¥é˜Ÿåˆ—ä¸­</span><br>            queue?.offer(t)<br>            <span class="hljs-comment">//æ‰§è¡Œè°ƒåº¦</span><br>            schedule()<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>            <span class="hljs-keyword">if</span>(done)<span class="hljs-keyword">return</span><br>            <span class="hljs-comment">//è®°å½•å¼‚å¸¸</span><br>            throwable = e<br>            <span class="hljs-comment">//æ ‡è®°æ¥æ”¶äº‹ä»¶å®Œæˆ</span><br>            done = <span class="hljs-literal">true</span><br>            <span class="hljs-comment">//æ‰§è¡Œè°ƒåº¦</span><br>            schedule()<br><br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>            <span class="hljs-keyword">if</span>(done)<span class="hljs-keyword">return</span><br>            <span class="hljs-comment">//æ ‡è®°æ¥æ”¶äº‹ä»¶å®Œæˆ</span><br>            done = <span class="hljs-literal">true</span><br>            <span class="hljs-comment">//æ‰§è¡Œè°ƒåº¦</span><br>            schedule()<br>        &#125;<br><br>        <span class="hljs-comment">//å¯ä»¥çœ‹åˆ°è¿™é‡Œè¿›è¡Œäº†ä»»åŠ¡çš„æ‰§è¡Œï¼Œç”± observeOn å†³å®šæ‰§è¡Œçš„çº¿ç¨‹</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">schedule</span><span class="hljs-params">()</span></span> &#123;<br>            worker.schedule(<span class="hljs-keyword">this</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> &#123;<br>            drainNormal()<br>        &#125;<br><br>        <span class="hljs-comment">//å®é™…æœ€ç»ˆçš„é€»è¾‘å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢è¿›è¡Œå¤„ç†</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">drainNormal</span><span class="hljs-params">()</span></span> &#123;<br>            <span class="hljs-comment">//å–å½“å‰çš„é˜Ÿåˆ—</span><br>            <span class="hljs-keyword">val</span> q = queue<br>            <span class="hljs-comment">//å–è§‚å¯Ÿè€…</span><br>            <span class="hljs-keyword">val</span> obs = observer<br><br>            <span class="hljs-comment">//while å¾ªç¯å–å‡ºé˜Ÿåˆ—é‡Œé¢çš„ onNext äº‹ä»¶</span><br>            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-comment">//å– done æ ‡è®°</span><br>                <span class="hljs-keyword">val</span> d = done<br>                <span class="hljs-comment">//ä»é˜Ÿåˆ—ä¸­å–å‡ºå…ƒç´ å¹¶å‡ºé˜Ÿ</span><br>                <span class="hljs-keyword">val</span> t = q?.poll()<br>                <span class="hljs-comment">//å¦‚æœ t ä¸º null è¡¨ç¤ºé˜Ÿåˆ—é‡Œé¢æ²¡æœ‰äº‹ä»¶äº†</span><br>                <span class="hljs-keyword">val</span> empty = t == <span class="hljs-literal">null</span><br>                <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦èƒ½ç»ˆæ­¢ While å¾ªç¯</span><br>                <span class="hljs-keyword">if</span>(checkTerminated(d,empty,obs))&#123;<br>                    <span class="hljs-keyword">return</span><br>                &#125;<br><br>                <span class="hljs-comment">//å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè·³å‡º While å¾ªç¯</span><br>                <span class="hljs-keyword">if</span>(empty)<span class="hljs-keyword">break</span><br><br>                <span class="hljs-comment">//è§‚å¯Ÿè€…æ¥æ”¶ onNext äº‹ä»¶</span><br>                t?.apply &#123;<br>                    obs.onNext(<span class="hljs-keyword">this</span>)<br>                &#125;<br>            &#125;<br><br>        &#125;<br><br>        <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦èƒ½ç»ˆæ­¢ While å¾ªç¯</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkTerminated</span><span class="hljs-params">(d: <span class="hljs-type">Boolean</span>, empty: <span class="hljs-type">Boolean</span>, obs: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>            <span class="hljs-keyword">if</span>(over)&#123;<br>                <span class="hljs-comment">//å¦‚æœèƒ½ç»“æŸäº†ï¼Œæ¸…ç©ºé˜Ÿåˆ—</span><br>                queue?.clear()<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>            &#125;<br><br>            <span class="hljs-comment">//å¦‚æœå·²ç»å®Œæˆäº‹ä»¶çš„å‘é€</span><br>            <span class="hljs-keyword">if</span>(d)&#123;<br>                <span class="hljs-keyword">val</span> e = throwable<br>                <span class="hljs-keyword">if</span>(e != <span class="hljs-literal">null</span>)&#123;<br>                    <span class="hljs-comment">//å¦‚æœæœ‰ onError äº‹ä»¶ï¼Œæ ‡è®°ç»“æŸï¼Œå¹¶æ¥æ”¶ onError äº‹ä»¶</span><br>                    over = <span class="hljs-literal">true</span><br>                    obs.onError(e)<br>                &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(empty)&#123;<br>                    <span class="hljs-comment">//å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œæ ‡è®°ç»“æŸï¼Œå¹¶æ¥æ”¶ onComplete äº‹ä»¶</span><br>                    over = <span class="hljs-literal">true</span><br>                    obs.onComplete()<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>        <br>    &#125;<br>&#125; <br><br><span class="hljs-comment">//2ã€Observable ä¸­å¢åŠ ç›¸åº”çš„è°ƒç”¨æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observeOn</span><span class="hljs-params">(scheduler: <span class="hljs-type">Scheduler</span>)</span></span>: ObservableObserveOn&lt;T&gt;&#123;<br>    <span class="hljs-keyword">return</span> ObservableObserveOn(<span class="hljs-keyword">this</span>,scheduler)<br>&#125;<br><br><span class="hljs-comment">//3ã€æµ‹è¯•ï¼Œå› ä¸ºæ¶‰åŠåˆ° Handler åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œæˆ‘ä»¬è¿™é‡Œæ”¾åˆ° Activity é‡Œé¢å»æµ‹è¯•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br><br>        Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt; &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>                emitter.onComplete()<br>                println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>        &#125;)<br>            .subscribeOn(Schedulers.newThread())<br>            .observeOn(Schedulers.mainThread())<br>            .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt; &#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br>            &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribeï¼šmain<br>subscribeï¼špool-<span class="hljs-number">2</span>-thread-<span class="hljs-number">1</span><br>onNextï¼šerdai666<br>onNextï¼šmain<br>onComplete<br>onCompleteï¼šmain<br></code></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹ä¸Šé¢çš„æ‰“å°ç»“æœï¼š</p><p>1ã€onSubscribe æ˜¯åœ¨ä¸€å¼€å§‹è®¢é˜…å°±è§¦å‘çš„ï¼Œæ­¤æ—¶ Worker éƒ½è¿˜æ²¡åˆ›å»ºï¼Œå› æ­¤æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„</p><p>2ã€subscribe åœ¨æˆ‘ä»¬å®é™…è®¢é˜…è§‚å¯Ÿè€…çš„æ–¹æ³•é‡Œä¼šæ‰§è¡Œå®ƒï¼Œå› æ­¤æ˜¯ç”± subscribeOn åˆ‡æ¢çš„çº¿ç¨‹å†³å®š</p><p>3ã€observeOn å†³å®šäº†è§‚å¯Ÿè€…æ¥æ”¶äº‹ä»¶æ‰€åœ¨çš„çº¿ç¨‹ï¼Œå› æ­¤ onNextï¼ŒonComplete æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„</p><h2 id="ä¸‰ã€RxJava-æ¡†æ¶æµæ€æƒ³è®¾è®¡"><a href="#ä¸‰ã€RxJava-æ¡†æ¶æµæ€æƒ³è®¾è®¡" class="headerlink" title="ä¸‰ã€RxJava æ¡†æ¶æµæ€æƒ³è®¾è®¡"></a>ä¸‰ã€RxJava æ¡†æ¶æµæ€æƒ³è®¾è®¡</h2><p>æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥åˆ†æ RxJava çš„æ¡†æ¶æµè®¾è®¡ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>      <span class="hljs-comment">//create æ“ä½œç¬¦</span><br>        Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt; &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>                emitter.onComplete()<br>                println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>        &#125;)<br>          <span class="hljs-comment">//map æ“ä½œç¬¦</span><br>            .map(<span class="hljs-keyword">object</span> : Function&lt;String,String&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span>: String &#123;<br>                    println(<span class="hljs-string">&quot;mapï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;mapï¼š<span class="hljs-variable">$t</span>&quot;</span><br>                &#125;<br>            &#125;)<br>          <span class="hljs-comment">//flatMap æ“ä½œç¬¦</span><br>            .flatMap(<span class="hljs-keyword">object</span> : Function&lt;String,ObservableSource&lt;String&gt;&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span>: ObservableSource&lt;String&gt; &#123;<br>                    println(<span class="hljs-string">&quot;flatMapï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">return</span> Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>                        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                            emitter.onNext(<span class="hljs-string">&quot;flatMapï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                        &#125;<br>                    &#125;)<br>                &#125;<br><br>            &#125;)<br>          <span class="hljs-comment">//subscribeOn æ“ä½œç¬¦</span><br>            .subscribeOn(Schedulers.newThread())<br>          <span class="hljs-comment">//observeOn æ“ä½œç¬¦</span><br>            .observeOn(Schedulers.mainThread())<br>          <span class="hljs-comment">//è®¢é˜…</span><br>            .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt; &#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br>            &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-1ã€é“¾å¼æ„å»ºæµ"><a href="#3-1ã€é“¾å¼æ„å»ºæµ" class="headerlink" title="3.1ã€é“¾å¼æ„å»ºæµ"></a>3.1ã€é“¾å¼æ„å»ºæµ</h3><p>ç‰¹ç‚¹ï¼šä»ä¸Šå¾€ä¸‹</p><p>ä½¿ç”¨ä¸€æ®µä¼ªä»£ç æ¥åˆ†æ RxJava Observable çš„æ„å»º</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> source = ObservableOnSubscribe()<br><span class="hljs-comment">//create æ“ä½œç¬¦</span><br>Observable.create(souce) ---&gt; observable0 = ObservableCreate(source)<br><span class="hljs-comment">//map æ“ä½œç¬¦</span><br>observable0.map() ---&gt; observable1 = ObservableMap(observable0)<br><span class="hljs-comment">//flatMap æ“ä½œç¬¦</span><br>observable1.flatMap() ---&gt; observable2 = ObservableFlatMap(observable1)<br><span class="hljs-comment">//subscribeOn æ“ä½œç¬¦</span><br>observable2.subscribeOn() ---&gt; observable3 = ObservableSubscribeOn(observable2)<br><span class="hljs-comment">//observeOn æ“ä½œç¬¦</span><br>observable3.observeOn() ---&gt; observable4 = ObservableObserveOn(observable3)<br></code></pre></td></tr></table></figure><p>æœ‰æ²¡æœ‰å‘ç°è§„å¾‹ï¼š<strong>æˆ‘ä»¬åœ¨ä¸Šæ¸¸åˆ›å»ºçš„ Observable(è¢«è§‚å¯Ÿè€…) ä¼šè¢«ä¼ å…¥åˆ°ä¸‹æ¸¸ã€‚è¿™å°±æ˜¯å…¸å‹çš„è£…é¥°è€…æ¨¡å¼çš„åº”ç”¨ï¼Œå®ƒçš„ç‰¹ç‚¹å°±æ˜¯ä»ä¸Šå¾€ä¸‹ï¼Œæ— é™å¥—å¨ƒï¼ŒåŠ¨æ€çš„è¾¾åˆ°åŠŸèƒ½çš„å¢å¼º</strong></p><h3 id="3-2ã€è®¢é˜…æµ"><a href="#3-2ã€è®¢é˜…æµ" class="headerlink" title="3.2ã€è®¢é˜…æµ"></a>3.2ã€è®¢é˜…æµ</h3><p>ç‰¹ç‚¹ï¼šä»ä¸‹å¾€ä¸Š</p><p>ä½¿ç”¨ä¸€æ®µä¼ªä»£ç æ¥åˆ†æ RxJava è®¢é˜…çš„è¿‡ç¨‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> observe5 = Observer()&#123;&#125;...<br>observable4.subscribe(observe5) ---&gt; observable4.subscribeActual(observe5)<br><br><span class="hljs-comment">//observeOn æ“ä½œç¬¦</span><br><span class="hljs-keyword">val</span> observe4 = ObserveOnObserver(observe5)<br>observable3.subscribe(observe4) ---&gt; observable3.subscribeActual(observe4)<br><br><span class="hljs-comment">//subscribeOn æ“ä½œç¬¦</span><br><span class="hljs-keyword">val</span> observe3 = SubscribeOnObserver(observe4)<br>observable2.subscribe(observe3) ---&gt; observable2.subscribeActual(observe3)<br><br><span class="hljs-comment">//flatMap æ“ä½œç¬¦</span><br><span class="hljs-keyword">val</span> observe2 = FlatMapObserver(observe3)<br>observable1.subscribe(observe2) ---&gt; observable1.subscribeActual(observe2)<br><br><span class="hljs-comment">//map æ“ä½œç¬¦</span><br><span class="hljs-keyword">val</span> observe1 = MapObserver(observe2)<br>observable0.subscribe(observe1) ---&gt; observable0.subscribeActual(observe1)<br><br><span class="hljs-comment">//create æ“ä½œç¬¦</span><br><span class="hljs-keyword">val</span> emitter = CreateEmitter(observe1)<br>source.subscribe(emitter)<br></code></pre></td></tr></table></figure><p>æœ‰ç‚¹é€’å½’çš„æ„æ€å“ˆ</p><p>å¯ä»¥å‘ç°è§„å¾‹ï¼š<strong>æˆ‘ä»¬åœ¨ä¸‹æ¸¸åˆ›å»ºçš„ Observable è®¢é˜…æ—¶ï¼Œä¼šé€’å½’å…ˆæ‰§è¡Œä¸Šæ¸¸çš„è®¢é˜…ï¼Œå› æ­¤è®¢é˜…æµçš„ç‰¹ç‚¹å°±æ˜¯ä»ä¸‹å¾€ä¸Š</strong></p><h3 id="3-3ã€å›è°ƒæµ"><a href="#3-3ã€å›è°ƒæµ" class="headerlink" title="3.3ã€å›è°ƒæµ"></a>3.3ã€å›è°ƒæµ</h3><p>ç‰¹ç‚¹ï¼šä»ä¸Šå¾€ä¸‹</p><p>æˆ‘ä»¬åˆ†æè®¢é˜…æµå¯ä»¥å‘ç°ï¼Œè§‚å¯Ÿè€…å¯¹è±¡æ˜¯ä»ä¸‹å¾€ä¸Šä¼ çš„ï¼Œå› æ­¤å½“ emitter å‘é€äº‹ä»¶æ—¶ï¼Œæ¥æ”¶çš„é¡ºåºï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//create æ“ä½œç¬¦</span><br>emitter -&gt; observe1<br><br><span class="hljs-comment">//map æ“ä½œç¬¦</span><br>observe1 -&gt; observe2<br><br><span class="hljs-comment">//flatMap æ“ä½œç¬¦</span><br>observe2 -&gt; observe3<br><br><span class="hljs-comment">//subscribeOn æ“ä½œç¬¦</span><br>observe3 -&gt; observe4<br><br><span class="hljs-comment">//observeOn æ“ä½œç¬¦</span><br>observe4 -&gt; observe5<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼š<strong>å½“ emitter å‘é€äº‹ä»¶åï¼Œè§‚å¯Ÿè€…æ”¶åˆ°äº‹ä»¶çš„é¡ºåºæ˜¯ä»ä¸Šå¾€ä¸‹çš„</strong></p><p>ä¸Šé¢è¿™ä¸‰ä¸ªæµå°±æ˜¯ RxJava æ¡†æ¶æµçš„ä¸€ä¸ªæ€æƒ³è®¾è®¡ï¼Œå¯¹äºä½ ç†è§£ RxJava éå¸¸é‡è¦ï¼Œå¦‚æœæ²¡çœ‹æ˜ç™½ï¼Œå¤šçœ‹å‡ é</p><h3 id="3-4ã€é—®é¢˜å›é¡¾"><a href="#3-4ã€é—®é¢˜å›é¡¾" class="headerlink" title="3.4ã€é—®é¢˜å›é¡¾"></a>3.4ã€é—®é¢˜å›é¡¾</h3><p>æŒæ¡äº† RxJava æ¡†æ¶æµï¼Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹å‰é¢æåˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p><p>1ã€å¦‚æœæœ‰å¤šä¸ª subscribeOn ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæƒ…å†µï¼Ÿä¸ºå•¥ï¼Ÿ</p><p>ç­”ï¼šåªæœ‰æœ€ä¸Šé¢é‚£ä¸ª subscribeOn åˆ‡æ¢çš„çº¿ç¨‹æ‰ä¼šç”Ÿæ•ˆã€‚å› ä¸º subscribeOn çš„ä½œç”¨å°±æ˜¯å†³å®šä½ è®¢é˜…æ‰€æ‰§è¡Œçš„çº¿ç¨‹ï¼Œè€Œè®¢é˜…æµæ˜¯ä»ä¸‹å¾€ä¸Šçš„ï¼Œå› æ­¤ä½ å¦‚æœä½¿ç”¨å¤šä¸ª subscribeOn å¯¹çº¿ç¨‹è¿›è¡Œåˆ‡æ¢ï¼Œæœ€ç»ˆç”Ÿæ•ˆçš„åªä¼šæ˜¯æœ€ä¸Šé¢é‚£ä¸ª</p><p>2ã€å¦‚æœæœ‰å¤šä¸ª observeOn ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆæƒ…å†µï¼Ÿä¸ºå•¥ï¼Ÿ</p><p>ç­”ï¼šåŒç†ï¼Œåªæœ‰æœ€ä¸‹æ¸¸é‚£ä¸ª observeOn åˆ‡æ¢çš„çº¿ç¨‹æ‰ä¼šç”Ÿæ•ˆã€‚å› ä¸ºå›è°ƒæµæ˜¯ä»ä¸Šå¾€ä¸‹çš„ï¼Œæ‰€ä»¥å¦‚æœä½ åˆ›å»ºäº†å¤šä¸ªè§‚å¯Ÿè€…æ¥æ”¶äº‹ä»¶ï¼Œæœ€ç»ˆç”Ÿæ•ˆçš„åªä¼šæ˜¯æœ€ä¸‹é¢é‚£ä¸ª</p><p>å¥½å¥½ä½“ä¼šä¸‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt; &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">Emitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>                emitter.onComplete()<br>                println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br><br>        &#125;)<br>            .subscribeOn(Schedulers.newThread())<br>            .map(<span class="hljs-keyword">object</span> : Function&lt;String, String&gt; &#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span>: String &#123;<br>                    println(<span class="hljs-string">&quot;mapï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;mapï¼š<span class="hljs-variable">$t</span>&quot;</span><br>                &#125;<br><br>            &#125;)<br>            .subscribeOn(Schedulers.mainThread())<br>            .subscribeOn(Schedulers.newThread())<br>            .subscribeOn(Schedulers.mainThread())<br>            .observeOn(Schedulers.newThread())<br>            .observeOn(Schedulers.mainThread())<br>            .observeOn(Schedulers.newThread())<br>          .observeOn(Schedulers.mainThread())<br>            .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt; &#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-variable">$t</span>&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>            &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribeï¼šmain<br>mapï¼špool-<span class="hljs-number">2</span>-thread-<span class="hljs-number">1</span><br>subscribeï¼špool-<span class="hljs-number">2</span>-thread-<span class="hljs-number">1</span><br>onNextï¼šmapï¼šerdai666<br>onNextï¼šmain<br>onComplete<br>onCompleteï¼šmain<br></code></pre></td></tr></table></figure><h2 id="å››ã€RxLifeCycle"><a href="#å››ã€RxLifeCycle" class="headerlink" title="å››ã€RxLifeCycle"></a>å››ã€RxLifeCycle</h2><p>å®ç° RxLifeCycle ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ compose æ“ä½œç¬¦</p><h3 id="4-1ã€compose-æ“ä½œç¬¦ä»‹ç»"><a href="#4-1ã€compose-æ“ä½œç¬¦ä»‹ç»" class="headerlink" title="4.1ã€compose æ“ä½œç¬¦ä»‹ç»"></a>4.1ã€compose æ“ä½œç¬¦ä»‹ç»</h3><p>compose æ“ä½œç¬¦ä½œç”¨ï¼šä¼ å…¥ä¸€ä¸ªä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…è¿”å›ä¸€ä¸ªä¸‹æ¸¸çš„è¢«è§‚å¯Ÿè€…ï¼Œèƒ½èµ·åˆ°ä¸€ä¸ªä»£ç å¤ç”¨çš„é€»è¾‘</p><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢ä½¿ç”¨çš„æ˜¯ RxJava åŒ…ä¸‹çš„ç±»</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTransformer</span>&lt;<span class="hljs-type">T: Any</span>&gt;: <span class="hljs-type">ObservableTransformer</span>&lt;<span class="hljs-type">T,T</span>&gt; &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(upstream: <span class="hljs-type">Observable</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: ObservableSource&lt;T&gt; &#123;<br>      <span class="hljs-comment">//å®Œæˆè®¢é˜…å’Œå›è°ƒçº¿ç¨‹çš„åˆ‡æ¢</span><br>        <span class="hljs-keyword">return</span> upstream.subscribeOn(Schedulers.io())<br>            .observeOn(AndroidSchedulers.mainThread())<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//å®é™…åº”ç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">ObservableEmitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>                emitter.onComplete()<br>                println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br>        &#125;)<br>          <span class="hljs-comment">//compose æ“ä½œç¬¦éœ€è¦ä¼ å…¥ä¸€ä¸ª ObservableTransformer ç±»å‹çš„å¯¹è±¡</span><br>            .compose(MyTransformer())<br>            .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">(d: <span class="hljs-type">Disposable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onNext <span class="hljs-variable">$t</span>&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br>            &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>onSubscribeï¼šmain<br>subscribeï¼šRxCachedThreadScheduler-<span class="hljs-number">1</span><br>onNext erdai666<br>onNextï¼šmain<br>onComplete<br>onCompleteï¼šmain<br></code></pre></td></tr></table></figure><h3 id="4-2ã€RxLifeCycle-å®ç°"><a href="#4-2ã€RxLifeCycle-å®ç°" class="headerlink" title="4.2ã€RxLifeCycle å®ç°"></a>4.2ã€RxLifeCycle å®ç°</h3><p>æˆ‘ä»¬ä¸Šé¢å†™çš„ä»£ç æ˜¯å­˜åœ¨å†…å­˜æ³„æ¼çš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ RxJava åœ¨ Activity åšä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæ­¤æ—¶ç”¨æˆ·é€€å‡ºäº†å½“å‰ Activity ï¼Œä½†æ˜¯ç½‘ç»œè¯·æ±‚è¿˜åœ¨ç»§ç»­ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šäº§ç”Ÿå†…å­˜æ³„æ¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨åšç½‘ç»œè¯·æ±‚çš„æ—¶å€™æ„ŸçŸ¥ Activity çš„ç”Ÿå‘½å‘¨æœŸå»åšç›¸åº”çš„é€»è¾‘å¤„ç†ï¼Œé‚£ä¹ˆæ­¤æ—¶ RxLifeCycle å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€RxLifeCycle å®ç°ç±»</span><br><span class="hljs-comment">//1.1ã€å®ƒå®ç°äº† LifecycleEventObserverï¼Œå› æ­¤å¯ä»¥æ„ŸçŸ¥ LifecycleOwner çš„å£°æ˜å‘¨æœŸ</span><br><span class="hljs-comment">//1.2ã€å®ƒå®ç°äº† ObservableTransformerï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ compose æ“ä½œç¬¦</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RxLifeCycle</span>&lt;<span class="hljs-type">T: Any</span>&gt;: <span class="hljs-type">LifecycleEventObserver</span>,<span class="hljs-type">ObservableTransformer</span>&lt;<span class="hljs-type">T,T</span>&gt; &#123;<br><br>    <span class="hljs-keyword">var</span> compositeDisposable = CompositeDisposable()<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> &#123;<br>        <span class="hljs-keyword">if</span>(event == Lifecycle.Event.ON_DESTROY)&#123;<br>            <span class="hljs-comment">//ç›‘å¬åˆ° LifecycleOwner ç”Ÿå‘½å‘¨æœŸä¸º Destroy æ—¶ï¼Œç§»é™¤ Disposable å®¹å™¨ä¸­çš„æ‰€æœ‰ Disposable å¯¹è±¡</span><br>            compositeDisposable.clear()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">apply</span><span class="hljs-params">(upstream: <span class="hljs-type">Observable</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: ObservableSource&lt;T&gt; &#123;<br>        <span class="hljs-keyword">return</span> upstream.doOnSubscribe&#123;<br>            <span class="hljs-comment">//å°† Disposable åŠ å…¥ Disposable å®¹å™¨</span><br>            compositeDisposable.add(it)<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>      <span class="hljs-comment">//ä¼ å…¥ LifecycleOwnerï¼Œå’Œ RxJava è¿›è¡Œç”Ÿå‘½å‘¨æœŸç»‘å®š</span><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T: Any&gt;</span> <span class="hljs-title">bindToDestroy</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span>: RxLifeCycle&lt;T&gt;&#123;<br>            <span class="hljs-keyword">val</span> rxLifeCycle = RxLifeCycle&lt;T&gt;()<br>            owner.lifecycle.addObserver(rxLifeCycle)<br>            <span class="hljs-keyword">return</span> rxLifeCycle<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€ä½¿ç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        Observable.create(<span class="hljs-keyword">object</span> : ObservableOnSubscribe&lt;String&gt;&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(emitter: <span class="hljs-type">ObservableEmitter</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>                emitter.onNext(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>                emitter.onComplete()<br>                println(<span class="hljs-string">&quot;subscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>            &#125;<br>        &#125;)<br>            .compose(MyTransformer())<br>          <span class="hljs-comment">//ç»‘å®šç”Ÿå‘½å‘¨æœŸï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span><br>          .compose(RxLifeCycle.bindToDestroy(<span class="hljs-keyword">this</span>))<br>            .subscribe(<span class="hljs-keyword">object</span> : Observer&lt;String&gt;&#123;<br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">(d: <span class="hljs-type">Disposable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onSubscribeï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onNext <span class="hljs-variable">$t</span>&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onNextï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onErrorï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br><br>                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> &#123;<br>                    println(<span class="hljs-string">&quot;onComplete&quot;</span>)<br>                    println(<span class="hljs-string">&quot;onCompleteï¼š<span class="hljs-subst">$&#123;Thread.currentThread().name&#125;</span>&quot;</span>)<br>                &#125;<br>            &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€RxBus"><a href="#äº”ã€RxBus" class="headerlink" title="äº”ã€RxBus"></a>äº”ã€RxBus</h2><p>å®ç° RxBus å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ Subject</p><h3 id="5-1ã€Subject-ä»‹ç»"><a href="#5-1ã€Subject-ä»‹ç»" class="headerlink" title="5.1ã€Subject ä»‹ç»"></a>5.1ã€Subject ä»‹ç»</h3><p>1ã€Subject æ—¢å¯ä»¥è¡¨ç¤ºä¸€ä¸ªè¢«è§‚å¯Ÿè€…ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œå®é™…å®ƒå°±æ˜¯ç»§æ‰¿äº† Observable æŠ½è±¡ç±»å¹¶å®ç°äº† Observer æ¥å£</p><p>2ã€Subject ä¸»è¦åˆ†ä¸ºå››ç§ï¼š</p><blockquote><p>1ã€AsyncSubject</p><p>2ã€BehaviorSubject</p><p>3ã€PublishSubject</p><p>4ã€ReplaySubject</p></blockquote><h4 id="5-1-1ã€AsyncSubject"><a href="#5-1-1ã€AsyncSubject" class="headerlink" title="5.1.1ã€AsyncSubject"></a>5.1.1ã€AsyncSubject</h4><p>ç‰¹ç‚¹ï¼šäº‹ä»¶å‘å°„æ— è®ºæ˜¯åœ¨è®¢é˜…å‰è¿˜æ˜¯åï¼Œéƒ½åªä¼šæ¥æ”¶æœ€åä¸€ä¸ªäº‹ä»¶</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> subject = AsyncSubject.create&lt;String&gt;()<br>    subject.onNext(<span class="hljs-string">&quot;A&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;B&quot;</span>)<br>    subject.subscribe &#123;<br>        println(it)<br>    &#125;<br>    subject.onNext(<span class="hljs-string">&quot;C&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;D&quot;</span>)<br>    subject.onComplete()<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>D<br></code></pre></td></tr></table></figure><h4 id="5-1-2ã€BehaviorSubject"><a href="#5-1-2ã€BehaviorSubject" class="headerlink" title="5.1.2ã€BehaviorSubject"></a>5.1.2ã€BehaviorSubject</h4><p>ç‰¹ç‚¹ï¼šæ¥æ”¶è®¢é˜…å‰æœ€åä¸€ä¸ªäº‹ä»¶ä»¥åŠè®¢é˜…åçš„æ‰€æœ‰äº‹ä»¶</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> subject = BehaviorSubject.create&lt;String&gt;()<br>    subject.onNext(<span class="hljs-string">&quot;A&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;B&quot;</span>)<br>    subject.subscribe &#123;<br>        println(it)<br>    &#125;<br>    subject.onNext(<span class="hljs-string">&quot;C&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;D&quot;</span>)<br>    subject.onComplete()<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>B<br>C<br>D<br></code></pre></td></tr></table></figure><h4 id="5-1-3ã€PublishSubject"><a href="#5-1-3ã€PublishSubject" class="headerlink" title="5.1.3ã€PublishSubject"></a>5.1.3ã€PublishSubject</h4><p>ç‰¹ç‚¹ï¼šåªæ¥æ”¶è®¢é˜…åçš„æ‰€æœ‰äº‹ä»¶</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> subject = PublishSubject.create&lt;String&gt;()<br>    subject.onNext(<span class="hljs-string">&quot;A&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;B&quot;</span>)<br>    subject.subscribe &#123;<br>        println(it)<br>    &#125;<br>    subject.onNext(<span class="hljs-string">&quot;C&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;D&quot;</span>)<br>    subject.onComplete()<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>C<br>D<br></code></pre></td></tr></table></figure><h4 id="5-1-4ã€ReplaySubject"><a href="#5-1-4ã€ReplaySubject" class="headerlink" title="5.1.4ã€ReplaySubject"></a>5.1.4ã€ReplaySubject</h4><p>ç‰¹ç‚¹ï¼šäº‹ä»¶å‘å°„æ— è®ºæ˜¯åœ¨è®¢é˜…å‰è¿˜æ˜¯åï¼Œéƒ½ä¼šè¢«å…¨éƒ¨æ¥æ”¶</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> subject = ReplaySubject.create&lt;String&gt;()<br>    subject.onNext(<span class="hljs-string">&quot;A&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;B&quot;</span>)<br>    subject.subscribe &#123;<br>        println(it)<br>    &#125;<br>    subject.onNext(<span class="hljs-string">&quot;C&quot;</span>)<br>    subject.onNext(<span class="hljs-string">&quot;D&quot;</span>)<br>    subject.onComplete()<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>A<br>B<br>C<br>D<br></code></pre></td></tr></table></figure><h3 id="5-2ã€RxBus-å®ç°"><a href="#5-2ã€RxBus-å®ç°" class="headerlink" title="5.2ã€RxBus å®ç°"></a>5.2ã€RxBus å®ç°</h3><p>æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œäº‹ä»¶æ€»çº¿ç”¨çš„æœ€å¤šçš„å¯èƒ½æ˜¯ EventBusï¼Œæ®Šä¸çŸ¥ RxJava ä¹Ÿèƒ½é€šè¿‡ Subject å®ç°äº‹ä»¶æ€»çº¿çš„åŠŸèƒ½ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥æ¯” EventBus è¿˜ç®€å•ä¸€äº›ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€RxBus å®ç°ç±»</span><br><span class="hljs-keyword">object</span> RxBus &#123;<br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª PublishSubject ç±»å‹çš„ Subjectï¼Œåªæ¥æ”¶è®¢é˜…åçš„äº‹ä»¶</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> subject: Subject&lt;Any&gt; = PublishSubject.create&lt;Any&gt;().toSerialized()<br>    <br>    <span class="hljs-comment">//æ¥æ”¶äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T: Any&gt;</span> <span class="hljs-title">receive</span><span class="hljs-params">(clazz: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: Observable&lt;T&gt;&#123;<br>        <span class="hljs-keyword">return</span> subject.ofType(clazz)<br>    &#125;<br><br>    <span class="hljs-comment">//å‘é€äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">post</span><span class="hljs-params">(o: <span class="hljs-type">Any</span>)</span></span>&#123;<br>        subject.onNext(o)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€ä½¿ç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        RxBus.receive(String::<span class="hljs-keyword">class</span>.java)<br>          <span class="hljs-comment">//ç»‘å®šç”Ÿå‘½å‘¨æœŸï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span><br>            .compose(RxLifeCycle.bindToDestroy(<span class="hljs-keyword">this</span>))<br>            .subscribe &#123;<br>                println(it)<br>            &#125;<br><br>        RxBus.post(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ç”±æµ…å…¥æ·±å¯¹ RxJava è¿›è¡Œäº†å…¨é¢çš„ä»‹ç»ï¼š</p><p>1ã€ä»‹ç»äº† RxJava ä¸­ä½¿ç”¨çš„ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼š</p><blockquote><p>1ã€å˜ç§çš„è§‚å¯Ÿè€…æ¨¡å¼</p><p>2ã€è£…é¥°è€…æ¨¡å¼</p></blockquote><p>2ã€æ‰‹æ’¸äº† RxJava æ ¸å¿ƒæ“ä½œç¬¦çš„å®ç°ï¼Œå¸Œæœ›ä½ èƒ½ä¸¾ä¸€åä¸‰ï¼Œå…¶å®ƒæ“ä½œç¬¦çš„å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„å¥—è·¯</p><p>3ã€ä»‹ç»äº† RxJava æ¡†æ¶æµæ€æƒ³è®¾è®¡ï¼š</p><blockquote><p>1ã€é“¾å¼æ„å»ºæµï¼šä»ä¸Šå¾€ä¸‹</p><p>2ã€è®¢é˜…æµï¼šä»ä¸‹å¾€ä¸Š</p><p>3ã€å›è°ƒæµï¼šä»ä¸Šå¾€ä¸‹</p></blockquote><p>4ã€ä»‹ç»äº† compose æ“ä½œç¬¦å¹¶æ‰©å±•å®ç°äº† RxLifeCycle</p><p>5ã€ä»‹ç»äº† Subject å¹¶æ‰©å±•å®ç°äº† RxBus</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://github.com/ReactiveX/RxJava">RxJava</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šAndroid ä¸­ä½¿ç”¨ Protobuf</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AAndroid%20%E4%B8%AD%E4%BD%BF%E7%94%A8%20Protobuf/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AAndroid%20%E4%B8%AD%E4%BD%BF%E7%94%A8%20Protobuf/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8ddd1d4e057458ab3c236644e0ae27c~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æœ€è¿‘æˆ‘è´Ÿè´£çš„ LiveChat å®¢æœèŠå¤©ç³»ç»Ÿåˆ°äº†è‡ªç ”é˜¶æ®µï¼Œç±»ä¼¼åšä¸€ä¸ªè…¾è®¯ IM é€šä¿¡ SDKã€‚å’Œåå°è®¨è®ºåï¼Œç¡®å®šæ•°æ®ä¼ è¾“æ–¹å¼ä½¿ç”¨ Protobufï¼Œç®€å•çš„ä»‹ç»ä¸‹è‡ªå·±çš„ä¸€ä¸ªä½¿ç”¨å¿ƒå¾—</p><h2 id="ä¸€ã€Protobuf-ä»‹ç»"><a href="#ä¸€ã€Protobuf-ä»‹ç»" class="headerlink" title="ä¸€ã€Protobuf ä»‹ç»"></a>ä¸€ã€Protobuf ä»‹ç»</h2><p>Protobuf å…¨ç§°ï¼šProtocol Buffersï¼Œæ˜¯ Google æ¨å‡ºçš„ä¸€ç§ä¸å¹³å°æ— å…³ã€è¯­è¨€æ— å…³ã€å¯æ‰©å±•çš„è½»ä¾¿é«˜æ•ˆçš„åºåˆ—åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œç±»ä¼¼äºæˆ‘ä»¬å¸¸ç”¨çš„ xml å’Œ jsonã€‚</p><p><strong>é—®é¢˜</strong>ï¼šæ—¢ç„¶æœ‰äº† xml å’Œ jsonï¼ŒGoogle ä¸ºå•¥è¿˜è¦æ¨å‡º Protobuf å‘¢ï¼Ÿ</p><p>å­˜åœ¨æ˜¯æœ‰åŸå› çš„ï¼ŒProtobuf ç”¨ä¸¤ä¸ªå­—æ€»ç»“ï¼šå°ï¼Œå¿«ã€‚ç”¨ Protobuf åºåˆ—åŒ–åçš„å¤§å°æ˜¯ json çš„ååˆ†ä¹‹ä¸€ï¼Œæ˜¯ xml æ ¼å¼çš„äºŒååˆ†ä¹‹ä¸€ï¼Œè€Œä¸”æ€§èƒ½æ˜¯ä»–ä»¬çš„ 5ï½100 å€ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ xml æˆ–è€… json è¿›è¡Œæ•°æ®é€šä¿¡æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨é«˜æ€§èƒ½å’Œå¤§æ•°æ®é€šä¿¡çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰åŠæ³•å‹ç¼©æ•°æ®é‡ï¼Œæé«˜ä¼ è¾“æ•ˆç‡ï¼Œæ˜¾ç„¶ä¼šç»™ç”¨æˆ·å¸¦æ¥æ›´å¿«æ›´æµç•…çš„ä½“éªŒï¼Œå› æ­¤åš LiveChat è‡ªç ”ï¼ŒProtobuf æˆä¸ºæˆ‘ä»¬è¿›è¡Œæ•°æ®ä¼ è¾“çš„ç¬¬ä¸€é€‰æ‹©ã€‚</p><table><thead><tr><th></th><th>xml</th><th>json</th><th>protobuf</th></tr></thead><tbody><tr><td>æ•°æ®ä¿å­˜æ–¹å¼</td><td>æ–‡æœ¬</td><td>æ–‡æœ¬</td><td>äºŒè¿›åˆ¶</td></tr><tr><td>æ•°æ®ä¿å­˜å¤§å°</td><td>å¤§</td><td>ä¸€èˆ¬</td><td>å°</td></tr><tr><td>è§£ææ•ˆç‡</td><td>æ…¢</td><td>ä¸€èˆ¬</td><td>å¿«</td></tr></tbody></table><h2 id="äºŒã€Protobuf-ç¯å¢ƒé…ç½®"><a href="#äºŒã€Protobuf-ç¯å¢ƒé…ç½®" class="headerlink" title="äºŒã€Protobuf ç¯å¢ƒé…ç½®"></a>äºŒã€Protobuf ç¯å¢ƒé…ç½®</h2><p>ä»‹ç»ä¸¤ç§å®‰è£… Protobuf çš„æ–¹å¼ï¼š</p><p>1ã€Github ä¸‹è½½ Protobuf å¹¶å®‰è£…</p><p>2ã€brew å®‰è£…</p><h3 id="2-1ã€æ–¹å¼ä¸€ï¼šGithub-ä¸‹è½½-Protobuf-å¹¶å®‰è£…"><a href="#2-1ã€æ–¹å¼ä¸€ï¼šGithub-ä¸‹è½½-Protobuf-å¹¶å®‰è£…" class="headerlink" title="2.1ã€æ–¹å¼ä¸€ï¼šGithub ä¸‹è½½ Protobuf å¹¶å®‰è£…"></a>2.1ã€æ–¹å¼ä¸€ï¼šGithub ä¸‹è½½ Protobuf å¹¶å®‰è£…</h3><p><strong>æ³¨æ„</strong>ï¼šProtobuf ç‰ˆæœ¬å°½é‡ä¿æŒå‰åå°ä¸€è‡´ï¼Œè¿™é‡Œæ˜¯åå°å’Œæˆ‘çº¦å®šçš„ä¸€ä¸ªç‰ˆæœ¬</p><p>Protobuf Github ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/protocolbuffers/protobuf/releases/tag/v3.19.2">https://github.com/protocolbuffers/protobuf/releases/tag/v3.19.2</a></p><p>1ã€æ ¹æ®è‡ªå·±çš„ç³»ç»Ÿé€‰æ‹©ç›¸åº”çš„ zip åŒ…ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e6590e6d53f442b96f578cd6b78d726~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823172254077"></p><p>2ã€è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡</p><p>ä»¥æˆ‘ä¸‹è½½çš„ä¸ºä¾‹ï¼Œè§£å‹åç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e9e549beafa401cad0ea26b1dcda3b5~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823172812299"></p><p>å¯ä»¥çœ‹åˆ° bin ç›®å½•ä¸‹æœ‰ä¸ª protoc çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬ç»™å®ƒé…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"># protobuf ç¯å¢ƒå˜é‡<br>export PROTOBUF_HOME=/Users/zhouying/Downloads/protoc-<span class="hljs-number">3.19</span>.<span class="hljs-number">2</span>-osx-x86_64<br>export PATH=$&#123;PATH&#125;:$&#123;PROTOBUF_HOME&#125;/bin<br></code></pre></td></tr></table></figure><p>3ã€é…ç½®å¥½åï¼Œä½¿ç”¨ protoc â€“version éªŒè¯</p><p>æ‰“å¼€ç»ˆç«¯é”®å…¥ protoc â€“version å‘½ä»¤ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e0b7da1f5d0489884a6e361977c1888~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823174015288"></p><p>å¯ä»¥çœ‹åˆ°æ‰“å°å‡ºäº†ç‰ˆæœ¬ï¼Œè¯æ˜æˆ‘ä»¬å®‰è£…æˆåŠŸäº†</p><h3 id="2-2ã€æ–¹å¼äºŒï¼šbrew-å®‰è£…"><a href="#2-2ã€æ–¹å¼äºŒï¼šbrew-å®‰è£…" class="headerlink" title="2.2ã€æ–¹å¼äºŒï¼šbrew å®‰è£…"></a>2.2ã€æ–¹å¼äºŒï¼šbrew å®‰è£…</h3><p>ç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°±å¯ä»¥ä¸€é”®å®‰è£…æˆ–å¸è½½ï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-comment">//ä¸€é”®å®‰è£… protobuf</span><br>brew install protobuf<br><br><span class="hljs-comment">//ä¸€é”®å¸è½½ protobuf</span><br>brew uninstall protobuf<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šè¿™ç§æ–¹å¼åªé€‚ç”¨äº Mac ç³»ç»Ÿï¼Œè€Œä¸”å®‰è£…çš„ protobuf ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œå› æ­¤å¦‚æœæƒ³è¦ä½¿ç”¨æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨æ–¹å¼ä¸€</p><h2 id="ä¸‰ã€ä½¿ç”¨-IDE-åˆ›å»º-Protobuf-æ–‡ä»¶"><a href="#ä¸‰ã€ä½¿ç”¨-IDE-åˆ›å»º-Protobuf-æ–‡ä»¶" class="headerlink" title="ä¸‰ã€ä½¿ç”¨ IDE åˆ›å»º Protobuf æ–‡ä»¶"></a>ä¸‰ã€ä½¿ç”¨ IDE åˆ›å»º Protobuf æ–‡ä»¶</h2><p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œæˆ‘ä½¿ç”¨çš„ IDE æ˜¯ AndroidStudio</p><p>1ã€åˆ›å»ºä¸€ä¸ªä»¥ .proto ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8b17c40fb4545c4ad25fb481a7be618~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823192237038"></p><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶å‰é¢çš„ icon æ˜¯ä¸ªæ–‡æœ¬ç±»å‹çš„ï¼Œè€Œä¸”ä½ åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæ²¡æœ‰ä»»ä½•æç¤ºï¼Œå…³é”®å­—ä¹Ÿæ²¡é«˜äº®æ˜¾ç¤ºï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦é›†æˆä¸€ä¸ªæ’ä»¶æ¥æ”¯æŒ Protobuf çš„ç¼–å†™</p><p>2ã€é›†æˆ Protocol Buffers æ’ä»¶</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/700811520b5347c994017a72637f2f3b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823192414258"></p><p>å½“æˆ‘ä»¬é›†æˆè¿™ä¸ªæ’ä»¶åï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶ icon å’Œä»£ç é«˜äº®çš„å˜åŒ–ï¼Œè€Œä¸”è¿˜ä¼šæœ‰è¯­æ³•æç¤º</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3a54b01c63be42c1bcd1ad2038c4495b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220823192636386"></p><p>okï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ç¼–å†™ Protobuf äº†ï¼Œä½†æ˜¯è¦æ€ä¹ˆå†™å‘¢ğŸ˜‚ ï¼Ÿä½ æ˜¯ä¸æ˜¯è¿˜ä¸ä¼š Protobuf çš„è¯­æ³•ï¼Œæ¥ç€å¾€ä¸‹çœ‹</p><h2 id="å››ã€Protobuf-è¯­æ³•åŸºç¡€"><a href="#å››ã€Protobuf-è¯­æ³•åŸºç¡€" class="headerlink" title="å››ã€Protobuf è¯­æ³•åŸºç¡€"></a>å››ã€Protobuf è¯­æ³•åŸºç¡€</h2><p>å…³äº Protobuf çš„è¯­æ³•æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬è®²ä¸€äº›å¸¸ç”¨çš„</p><h3 id="4-1ã€Protobuf-å¸¸ç”¨å…³é”®å­—ä»‹ç»"><a href="#4-1ã€Protobuf-å¸¸ç”¨å…³é”®å­—ä»‹ç»" class="headerlink" title="4.1ã€Protobuf å¸¸ç”¨å…³é”®å­—ä»‹ç»"></a>4.1ã€Protobuf å¸¸ç”¨å…³é”®å­—ä»‹ç»</h3><table><thead><tr><th>å…³é”®å­—</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>syntax</td><td>æŒ‡å®š Protobuf çš„ç‰ˆæœ¬ï¼ŒProtobuf ç›®å‰æœ‰ proto2 å’Œ proto3 ä¸¤ä¸ªå¸¸ç”¨ç‰ˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰å£°æ˜ï¼Œåˆ™é»˜è®¤æ˜¯proto2</td></tr><tr><td>package</td><td>æŒ‡å®šæ–‡ä»¶åŒ…å</td></tr><tr><td>import</td><td>å¯¼åŒ…ï¼Œå’Œ Java çš„ import ç±»ä¼¼</td></tr><tr><td>message</td><td>å®šä¹‰æ¶ˆæ¯ç±»ï¼Œå’Œ Java çš„ class å…³é”®å­—ç±»ä¼¼ï¼Œæ¶ˆæ¯ç±»ä¹‹é—´å¯ä»¥åµŒå¥—</td></tr><tr><td>repeated</td><td>å®šä¹‰ä¸€ä¸ªé›†åˆï¼Œå’Œ Java çš„é›†åˆç±»ä¼¼</td></tr><tr><td>reserved</td><td>ä¿ç•™å­—æ®µï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå…³é”®å­—ä¿®é¥°ï¼Œç”¨æˆ·å°±ä¸èƒ½ä½¿ç”¨è¿™ä¸ªå­—æ®µç¼–å·æˆ–å­—æ®µå</td></tr><tr><td>option</td><td>option å¯ä»¥ç”¨åœ¨ Protobuf çš„ scope ä¸­ï¼Œæˆ–è€… messageã€enumã€service çš„å®šä¹‰ä¸­ï¼ŒProtobuf å®šä¹‰çš„ option æœ‰ java_packageï¼Œjava_outer_classnameï¼Œjava_multiple_files ç­‰ç­‰</td></tr><tr><td>optional</td><td>è¡¨ç¤ºè¯¥å­—æ®µæ˜¯å¯é€‰çš„</td></tr><tr><td>java_package</td><td>æŒ‡å®šç”Ÿæˆç±»æ‰€åœ¨çš„åŒ…åï¼Œéœ€é…åˆ</td></tr><tr><td>java_outer_classname</td><td>å®šä¹‰å½“å‰æ–‡ä»¶çš„ç±»åï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™é»˜è®¤ä¸ºæ–‡ä»¶çš„é¦–å­—æ¯å¤§å†™åç§°</td></tr><tr><td>java_multiple_files</td><td>æŒ‡å®šç¼–è¯‘è¿‡å Java çš„æ–‡ä»¶ä¸ªæ•°ï¼Œå¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆå°†ä¼šä¸€ä¸ª Java å¯¹è±¡ä¸€ä¸ªç±»ï¼Œå¦‚æœæ˜¯ falseï¼Œé‚£ä¹ˆå®šä¹‰çš„Java å¯¹è±¡å°†ä¼šè¢«åŒ…å«åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­</td></tr></tbody></table><p><strong>æ³¨æ„</strong>ï¼šåœ¨ Proto3 ä¸­ä¸æ”¯æŒ required (å¿…é¡»)å­—æ®µ</p><h3 id="4-2ã€Protobuf-åŸºæœ¬æ•°æ®ç±»å‹"><a href="#4-2ã€Protobuf-åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="4.2ã€Protobuf åŸºæœ¬æ•°æ®ç±»å‹"></a>4.2ã€Protobuf åŸºæœ¬æ•°æ®ç±»å‹</h3><table><thead><tr><th align="left">Protobuf Type</th><th>è¯´æ˜</th><th align="left">å¯¹åº” Java&#x2F;Kotlin Type</th></tr></thead><tbody><tr><td align="left">double</td><td>å›ºå®š 8 å­—èŠ‚é•¿åº¦</td><td align="left">double</td></tr><tr><td align="left">float</td><td>å›ºå®š 4 å­—èŠ‚é•¿åº¦</td><td align="left">float</td></tr><tr><td align="left">int32</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œå¯¹è´Ÿæ•°ç¼–ç ä½æ•ˆï¼Œå¦‚æœå­—æ®µå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œç”¨ sint32 ä»£æ›¿</td><td align="left">int</td></tr><tr><td align="left">int64</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œå¯¹è´Ÿæ•°ç¼–ç ä½æ•ˆï¼Œå¦‚æœå­—æ®µå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œç”¨ sint64 ä»£æ›¿</td><td align="left">long</td></tr><tr><td align="left">uint32</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œæ— ç¬¦å·æ•´æ•°</td><td align="left">int</td></tr><tr><td align="left">uint64</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œæ— ç¬¦å·æ•´æ•°</td><td align="left">long</td></tr><tr><td align="left">sint32</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œæœ‰ç¬¦å·æ•´æ•°</td><td align="left">int</td></tr><tr><td align="left">sint64</td><td>å¯å˜é•¿åº¦ç¼–ç ï¼Œæœ‰ç¬¦å·æ•´æ•°</td><td align="left">long</td></tr><tr><td align="left">fixed32</td><td>å›ºå®š 4 å­—èŠ‚é•¿åº¦ï¼Œæ— ç¬¦å·æ•´æ•°</td><td align="left">int</td></tr><tr><td align="left">fixed64</td><td>å›ºå®š 8 å­—èŠ‚é•¿åº¦ï¼Œæ— ç¬¦å·æ•´æ•°</td><td align="left">long</td></tr><tr><td align="left">sfixed32</td><td>å›ºå®š 4 å­—èŠ‚é•¿åº¦ï¼Œæœ‰ç¬¦å·æ•´æ•°</td><td align="left">int</td></tr><tr><td align="left">sfixed64</td><td>å›ºå®š 8 å­—èŠ‚é•¿åº¦ï¼Œæœ‰ç¬¦å·æ•´æ•°</td><td align="left">long</td></tr><tr><td align="left">bool</td><td>å¸ƒå°”ç±»å‹ï¼Œå€¼ä¸º true æˆ– false</td><td align="left">boolean</td></tr><tr><td align="left">string</td><td>å­—ç¬¦ä¸²ç±»å‹</td><td align="left">String</td></tr></tbody></table><p>å¯å˜é•¿åº¦ç¼–ç å’Œå›ºå®šé•¿åº¦ç¼–ç åŒºåˆ«ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¾‹å¦‚è¯´æˆ‘åœ¨ Java é‡Œé¢è¿›è¡Œå¦‚ä¸‹å®šä¹‰ï¼š</span><br><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-comment">//å› ä¸º int ç±»å‹å  4 ä¸ªå­—èŠ‚ï¼Œ1ä¸ªå­—èŠ‚å  8 ä½ï¼Œæˆ‘ä»¬æŠŠ 1 çš„å­—èŠ‚å ä½ç»™åˆ—å‡ºæ¥ï¼š</span><br><span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span> <span class="hljs-number">00000001</span><br><span class="hljs-comment">//å¯ä»¥çœ‹åˆ° 1 çš„å‰é¢ 3 ä¸ªå­—èŠ‚å ä½éƒ½æ˜¯ 0ï¼Œåœ¨ Protobuf é‡Œé¢æ˜¯å¯ä»¥å»æ‰çš„ï¼Œäºæ˜¯å°±å˜æˆäº†ï¼š</span><br><span class="hljs-number">00000001</span><br><span class="hljs-comment">//å› æ­¤ 1 åœ¨ Protobuf é‡Œé¢å°±åªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚ï¼ŒèŠ‚çœäº†ç©ºé—´</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ç§å°±æ˜¯å¯å˜é•¿åº¦ç¼–ç ã€‚è€Œå›ºå®šé•¿åº¦ç¼–ç å°±æ˜¯å³ä½¿å‰é¢çš„å­—èŠ‚å ä½æ˜¯ 0ï¼Œä¹Ÿä¸èƒ½å»æ‰ï¼Œæˆ‘å°±æ˜¯è¦å è¿™ä¹ˆå¤šå­—èŠ‚</p><h4 id="4-2-1ã€åŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å€¼"><a href="#4-2-1ã€åŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å€¼" class="headerlink" title="4.2.1ã€åŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å€¼"></a>4.2.1ã€åŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å€¼</h4><table><thead><tr><th>ç±»å‹</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>æ•°å€¼ç±»å‹</td><td>0</td></tr><tr><td>bool</td><td>false</td></tr><tr><td>string</td><td>ç©ºå­—ç¬¦ä¸²</td></tr><tr><td>enum</td><td>é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ </td></tr></tbody></table><h3 id="4-3ã€æ¶ˆæ¯ç±»å‹å®šä¹‰"><a href="#4-3ã€æ¶ˆæ¯ç±»å‹å®šä¹‰" class="headerlink" title="4.3ã€æ¶ˆæ¯ç±»å‹å®šä¹‰"></a>4.3ã€æ¶ˆæ¯ç±»å‹å®šä¹‰</h3><p>åœ¨ä¸Šé¢åˆ›å»ºçš„ Protobuf æ–‡ä»¶ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªå­¦ç”Ÿï¼Œå­¦ç”Ÿæœ‰å§“åï¼Œå¹´é¾„ï¼Œé‚®ç®±å’Œè¯¾ç¨‹ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹å®ƒï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-comment">//æŒ‡å®š Protobuf ç‰ˆæœ¬</span><br>syntax = <span class="hljs-string">&quot;proto3&quot;</span>;<br><br><span class="hljs-comment">//æŒ‡å®šåŒ…å</span><br><span class="hljs-keyword">package</span> erdai;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå­¦ç”Ÿçš„æ¶ˆæ¯ç±»</span><br><span class="hljs-keyword">message </span><span class="hljs-title class_">Student</span>&#123;<br>  <span class="hljs-comment">//å§“å</span><br>  <span class="hljs-type">string</span> name = <span class="hljs-number">1</span>;<br>  <span class="hljs-comment">//å¹´é¾„</span><br>  <span class="hljs-type">int32</span> age = <span class="hljs-number">2</span>;<br>  <span class="hljs-comment">//é‚®ç®±</span><br>  <span class="hljs-type">string</span> email = <span class="hljs-number">3</span>;<br>  <span class="hljs-comment">//è¯¾ç¨‹</span><br>  <span class="hljs-keyword">repeated</span> <span class="hljs-type">string</span> course = <span class="hljs-number">4</span>; <span class="hljs-comment">//ç›¸å½“äº Java çš„ List&lt;String&gt;</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€ä¸€ä¸ª Protobuf æ–‡ä»¶é‡Œé¢å¯ä»¥æ·»åŠ å¤šä¸ªæ¶ˆæ¯ç±»ï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒåµŒå¥—</p><p>2ã€ä¸Šé¢çš„ 1ï¼Œ2ï¼Œ3ï¼Œ4 å¹¶ä¸æ˜¯ç»™å­—æ®µèµ‹å€¼ï¼Œè€Œæ˜¯ç»™æ¯ä¸ªå­—æ®µå®šä¹‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ã€‚è¿™äº›ç¼–å·ç”¨äºäºŒè¿›åˆ¶æ ¼å¼ä¸­æ ‡è¯†ä½ çš„å­—æ®µï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ä½ çš„æ¶ˆæ¯ç±»å‹åä¸åº”æ›´æ”¹</p><p>3ã€1-15 çš„å­—æ®µç¼–å·åªå ä¸€ä¸ªå­—èŠ‚è¿›è¡Œç¼–ç ï¼Œ16-2047 çš„å­—æ®µç¼–å·å ä¸¤ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬å­—æ®µç¼–å·å’Œå­—æ®µç±»å‹ï¼Œå› æ­¤å»ºè®®æ›´å¤šçš„ä½¿ç”¨ 1-15 çš„å­—æ®µç¼–å·</p><p>4ã€å¯ä»¥æŒ‡å®šæœ€å°å­—æ®µç¼–å·ä¸º 1ï¼Œæœ€å¤§å­—æ®µç¼–å·ä¸º 2^29 - 1 æˆ– 536870911ã€‚å¦å¤–ä¸èƒ½ä½¿ç”¨ 19000-19999 çš„æ ‡è¯†å·ï¼Œå› ä¸º protobuf åè®®å®ç°å¯¹è¿™äº›è¿›è¡Œäº†é¢„ç•™ï¼ŒåŒæ ·ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ä»»ä½•ä»¥å‰ä¿ç•™ï¼ˆreservedï¼‰ çš„å­—æ®µç¼–å·</p><h3 id="4-4ã€Protobuf-æšä¸¾ç±»å‹"><a href="#4-4ã€Protobuf-æšä¸¾ç±»å‹" class="headerlink" title="4.4ã€Protobuf æšä¸¾ç±»å‹"></a>4.4ã€Protobuf æšä¸¾ç±»å‹</h3><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-keyword">message </span><span class="hljs-title class_">Weather</span>&#123;<br>  <span class="hljs-type">int32</span> query = <span class="hljs-number">1</span>;<br><br>  <span class="hljs-comment">//å­£èŠ‚</span><br>  <span class="hljs-keyword">enum </span><span class="hljs-title class_">Season</span>&#123;<br>    <span class="hljs-comment">//å…è®¸å¯¹æšä¸¾å¸¸é‡è®¾ç½®åˆ«å</span><br>    <span class="hljs-keyword">option</span> allow_alias = <span class="hljs-literal">true</span>;<br>    <span class="hljs-comment">//æšä¸¾é‡Œé¢çš„ = æ“ä½œæ˜¯å¯¹å¸¸é‡è¿›è¡Œèµ‹å€¼æ“ä½œ</span><br>    <span class="hljs-comment">//æ˜¥</span><br>    SPRING = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//å¤</span><br>    SUMMER = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">//ç§‹ å¦‚æœä¸è®¾ç½®åˆ«åï¼Œä¸å…è®¸å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„å€¼</span><br>    FALL = <span class="hljs-number">2</span>;<br>    AUTUMN = <span class="hljs-number">2</span>;<br>    <span class="hljs-comment">//å†¬</span><br>    WINTER = <span class="hljs-number">3</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//å¯¹ season è¿›è¡Œç¼–å·</span><br>  Season season = <span class="hljs-number">2</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>1ã€å®šä¹‰æšä¸¾ç±»å‹ä½¿ç”¨ enum å…³é”®å­—</p><p>2ã€æšä¸¾ç±»å‹ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ä¸ºå¿…é¡» 0ï¼Œå¦åˆ™ç¼–è¯‘ä¼šæŠ¥é”™</p><p>3ã€æšä¸¾å¸¸é‡å€¼å¿…é¡»åœ¨ 32 ä½æ•´å‹å€¼çš„èŒƒå›´å†…ã€‚å› ä¸º enum å€¼æ˜¯ä½¿ç”¨å¯å˜ç¼–ç æ–¹å¼çš„ï¼Œå¯¹è´Ÿæ•°ä¸å¤Ÿé«˜æ•ˆï¼Œå› æ­¤ä¸æ¨èåœ¨ enum ä¸­ä½¿ç”¨è´Ÿæ•°</p><p>4ã€æšä¸¾é‡Œé¢çš„ &#x3D; æ“ä½œæ˜¯å¯¹å¸¸é‡è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œè€Œæšä¸¾å¤–é¢çš„ &#x3D; åˆ™æ˜¯å¯¹å½“å‰å­—æ®µè¿›è¡Œç¼–å·</p><h3 id="4-5ã€Protobuf-é›†åˆ"><a href="#4-5ã€Protobuf-é›†åˆ" class="headerlink" title="4.5ã€Protobuf é›†åˆ"></a>4.5ã€Protobuf é›†åˆ</h3><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-keyword">repeated</span> <span class="hljs-type">string</span> list = <span class="hljs-number">1</span>; <span class="hljs-comment">//ç±»ä¼¼ Java çš„ List&lt;String&gt;</span><br><br>map&lt;<span class="hljs-type">string</span>,<span class="hljs-type">string</span>&gt; = <span class="hljs-number">2</span>; <span class="hljs-comment">//ç±»ä¼¼ Java çš„ Map&lt;String,String&gt;</span><br></code></pre></td></tr></table></figure><p>1ã€Protobuf ä¸­å®šä¹‰é›†åˆï¼Œå°±æ˜¯åœ¨ä½ å®šä¹‰å¥½çš„å±æ€§å‰é¢åŠ  repeated å…³é”®å­—</p><p>2ã€Protobuf ä¸­å®šä¹‰ map å’Œ Java ç±»ä¼¼ï¼Œåªä¸è¿‡ map æ˜¯å°å†™çš„</p><h3 id="4-6ã€reserved-ä¿ç•™å­—æ®µ"><a href="#4-6ã€reserved-ä¿ç•™å­—æ®µ" class="headerlink" title="4.6ã€reserved ä¿ç•™å­—æ®µ"></a>4.6ã€reserved ä¿ç•™å­—æ®µ</h3><p>å½“æˆ‘ä»¬ä½¿ç”¨ reserved å…³é”®å­—æŒ‡å®šä¸€ä¸ªå­—æ®µç¼–å·æˆ–å­—æ®µåä¸ºä¿ç•™å­—æ®µåï¼Œæˆ‘ä»¬å°±ä¸èƒ½å»ä½¿ç”¨å®ƒï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/345fc00ef64c48638750c2de5a2d7b0f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220824165406735"></p><p>okï¼Œç®€å•çš„ä»‹ç»äº† Protobuf è¯­æ³•åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ AndroidStudio å°† Protobuf æ–‡ä»¶è½¬æ¢ä¸ºå¯¹åº”çš„ Java æ–‡ä»¶æ¥è¿›è¡Œå¼€å‘</p><h2 id="äº”ã€Protobuf-è½¬-Java-æ–‡ä»¶"><a href="#äº”ã€Protobuf-è½¬-Java-æ–‡ä»¶" class="headerlink" title="äº”ã€Protobuf è½¬ Java æ–‡ä»¶"></a>äº”ã€Protobuf è½¬ Java æ–‡ä»¶</h2><p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ä¸€ç‚¹ï¼šProtobuf æ˜¯ä¸€ç§ä¸å¹³å°ï¼Œè¯­è¨€æ— å…³çš„æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œå› æ­¤æˆ‘ä»¬è¦åœ¨å…¶å®ƒè¯­è¨€å¦‚ï¼šJavaï¼ŒKotlinï¼ŒDart ç­‰è¯­è¨€ä¸­ä½¿ç”¨å®ƒï¼Œåˆ™å¿…é¡»å°† Protobuf æ–‡ä»¶è½¬æ¢ä¸ºå¯¹åº”å¹³å°çš„è¯­è¨€æ–‡ä»¶å»ä½¿ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥è½¬ Java æ–‡ä»¶ä¸ºä¾‹ï¼Œä»‹ç»ä¸¤ç§è½¬æ¢çš„æ–¹å¼ï¼š</p><p>1ã€é›†æˆ Protobuf æ’ä»¶è½¬æ¢</p><p>2ã€ä½¿ç”¨ protoc å‘½ä»¤è¡Œè½¬æ¢</p><p>åœ¨ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼è½¬æ¢å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé›†æˆ protobuf-java è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå› ä¸ºæˆ‘ä»¬è½¬æ¢çš„ Java æ–‡ä»¶ä¸­ä¼šä½¿ç”¨è¿™ä¸ªåº“é‡Œé¢çš„åŠŸèƒ½</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs protobuf">implementation &#x27;com.google.protobuf:protobuf-java:<span class="hljs-number">3.19</span>.<span class="hljs-number">2</span>&#x27;<br></code></pre></td></tr></table></figure><p>æœ€æ–°ç‰ˆæœ¬å¯æŸ¥çœ‹æ­¤é“¾æ¥ï¼š<a href="https://github.com/protocolbuffers/protobuf/tree/main/java">https://github.com/protocolbuffers/protobuf/tree/main/java</a></p><h3 id="5-1ã€é›†æˆ-Protobuf-æ’ä»¶è½¬æ¢"><a href="#5-1ã€é›†æˆ-Protobuf-æ’ä»¶è½¬æ¢" class="headerlink" title="5.1ã€é›†æˆ Protobuf æ’ä»¶è½¬æ¢"></a>5.1ã€é›†æˆ Protobuf æ’ä»¶è½¬æ¢</h3><p>æ’ä»¶é“¾æ¥ï¼š<a href="https://github.com/google/protobuf-gradle-plugin">https://github.com/google/protobuf-gradle-plugin</a></p><p>1ã€åœ¨é¡¹ç›®çš„æ ¹ build.gradle æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs protobuf">buildscript &#123;<br>    repositories &#123;<br>        gradlePluginPortal()<br>    &#125;<br>    dependencies &#123;<br>        classpath &#x27;com.google.protobuf:protobuf-gradle-plugin:<span class="hljs-number">0.8</span>.<span class="hljs-number">19</span>&#x27;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­åº”ç”¨æ’ä»¶</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-comment">//1ã€å¦‚æœä½¿ç”¨çš„æ˜¯ apply æ–¹å¼ï¼ŒAndroid æ’ä»¶å¿…é¡»åœ¨ Protobuf æ’ä»¶ä¹‹å‰ï¼Œå¦‚ä¸‹ï¼š</span><br>apply plugin: &#x27;com.android.application&#x27;<br>apply plugin: &#x27;com.google.protobuf&#x27;<br><br><span class="hljs-comment">//2ã€å¦‚æœä½¿ç”¨çš„æ˜¯ Gradle DSL æ–¹å¼ï¼Œåˆ™ä¸é¡ºåºæ— å…³</span><br>plugins &#123;<br>    id &#x27;com.google.protobuf&#x27;<br>    id &#x27;com.android.application&#x27;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­é…ç½® protobuf ç¼–è¯‘ä»»åŠ¡</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs protobuf">android &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br>protobuf &#123;<br>    <span class="hljs-comment">//é…ç½® protoc ç¼–è¯‘å™¨</span><br>    protoc &#123;<br>        artifact = &#x27;com.google.protobuf:protoc:<span class="hljs-number">3.19</span>.<span class="hljs-number">2</span>&#x27;<br>    &#125;<br>    <span class="hljs-comment">//é…ç½®ç”Ÿæˆç›®å½•ï¼Œç¼–è¯‘åä¼šåœ¨ build çš„ç›®å½•ä¸‹ç”Ÿæˆå¯¹åº”çš„javaæ–‡ä»¶</span><br>    generateProtoTasks &#123;<br>        all().each &#123; task -&gt;<br>            task.builtins &#123;<br>                remove java<br>            &#125;<br>            task.builtins &#123;<br>                java &#123;&#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€æŒ‡å®š protobuf æ–‡ä»¶æ‰€åœ¨è·¯å¾„</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs protobuf">android &#123;<br>    <span class="hljs-comment">//...</span><br><br>    sourceSets &#123;<br>        main &#123;<br>            <span class="hljs-comment">//å®é™…æµ‹è¯•æŒ‡ä¸æŒ‡å®šæ— æ‰€è°“ï¼Œä¸å½±å“ Java æ–‡ä»¶ç”Ÿæˆ</span><br>            proto &#123;<br>                srcDir &#x27;src/main/proto&#x27;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢ 4 æ­¥ï¼Œæˆ‘ä»¬çš„æ’ä»¶å°±ç®—é…ç½®å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹</p><p>5ã€é‡æ–°ç¼–è¯‘é¡¹ç›®</p><p>ä»¥æˆ‘ä»¬ä¸Šé¢é‚£ä¸ª student.proto ä¸ºä¾‹ï¼Œé‡Œé¢çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs protobuf"><span class="hljs-comment">//æŒ‡å®š Protobuf ç‰ˆæœ¬</span><br>syntax = <span class="hljs-string">&quot;proto3&quot;</span>;<br><br><span class="hljs-comment">//æŒ‡å®šåŒ…å</span><br><span class="hljs-keyword">package</span> erdai;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå­¦ç”Ÿçš„æ¶ˆæ¯ç±»</span><br><span class="hljs-keyword">message </span><span class="hljs-title class_">Student</span>&#123;<br>  <span class="hljs-comment">//å§“å</span><br>  <span class="hljs-type">string</span> name = <span class="hljs-number">1</span>;<br>  <span class="hljs-comment">//å¹´é¾„</span><br>  <span class="hljs-type">int32</span> age = <span class="hljs-number">2</span>;<br>  <span class="hljs-comment">//é‚®ç®±</span><br>  <span class="hljs-type">string</span> email = <span class="hljs-number">3</span>;<br>  <span class="hljs-comment">//è¯¾ç¨‹</span><br>  <span class="hljs-keyword">repeated</span> <span class="hljs-type">string</span> course = <span class="hljs-number">4</span>;<br><br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¤©æ°”çš„æ¶ˆæ¯ç±»</span><br><span class="hljs-keyword">message </span><span class="hljs-title class_">Weather</span>&#123;<br>  <span class="hljs-type">int32</span> query = <span class="hljs-number">1</span>;<br><br>  <span class="hljs-comment">//å­£èŠ‚</span><br>  <span class="hljs-keyword">enum </span><span class="hljs-title class_">Season</span>&#123;<br>    <span class="hljs-keyword">option</span> allow_alias = <span class="hljs-literal">true</span>;<br>    <span class="hljs-comment">//æ˜¥</span><br>    SPRING = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//å¤</span><br>    SUMMER = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">//ç§‹</span><br>    FALL = <span class="hljs-number">2</span>;<br>    AUTUMN = <span class="hljs-number">2</span>;<br>    <span class="hljs-comment">//å†¬</span><br>    WINTER = <span class="hljs-number">3</span>;<br>  &#125;<br><br>  Season season = <span class="hljs-number">2</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘åï¼Œä¼šåœ¨ app&#x2F;build&#x2F;generated&#x2F;source&#x2F;proto&#x2F; ç›®å½•ä¸‹ç”Ÿæˆå¦‚ä¸‹æ–‡ä»¶ï¼š</p><p><img src="https://raw.githubusercontent.com/sweetying520/picgo/master/img/202208241633803.png" alt="image-20220824110842489"></p><p>è¿™ç§æ–¹å¼ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„ Java ç±»ï¼Œå°±æ˜¯é›†æˆçš„æ—¶å€™éº»çƒ¦ä¸€ç‚¹</p><h3 id="5-2ã€ä½¿ç”¨-protoc-å‘½ä»¤è¡Œè½¬æ¢"><a href="#5-2ã€ä½¿ç”¨-protoc-å‘½ä»¤è¡Œè½¬æ¢" class="headerlink" title="5.2ã€ä½¿ç”¨ protoc å‘½ä»¤è¡Œè½¬æ¢"></a>5.2ã€ä½¿ç”¨ protoc å‘½ä»¤è¡Œè½¬æ¢</h3><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">protoc --java_out=$&#123;<span class="hljs-string">&quot;ä½ è¦ç”Ÿæˆçš„ Java æ–‡ä»¶ç›®å½•&quot;</span>&#125; $&#123;<span class="hljs-string">&quot;Protobuf æ–‡ä»¶ä½ç½®&quot;</span>&#125;<br><br><span class="hljs-comment">//ä»¥æˆ‘çš„ä¸ºä¾‹ï¼š</span><br>protoc --java_out=./app/src/main/java ./app/src/main/proto/student.proto<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆçš„æ–‡ä»¶ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d84f8aace4f4fa2a3bc04b6465d5e9c~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220824112730091"></p><p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ä½¿ç”¨éå¸¸ç®€å•ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡åˆ›å»ºæ–°çš„ Protobuf æ–‡ä»¶éƒ½éœ€è¦æ‰§è¡Œä¸€ä¸‹å‘½ä»¤</p><h3 id="5-3ã€ç”Ÿæˆçš„-Java-æ–‡ä»¶ä»‹ç»"><a href="#5-3ã€ç”Ÿæˆçš„-Java-æ–‡ä»¶ä»‹ç»" class="headerlink" title="5.3ã€ç”Ÿæˆçš„ Java æ–‡ä»¶ä»‹ç»"></a>5.3ã€ç”Ÿæˆçš„ Java æ–‡ä»¶ä»‹ç»</h3><p>å…³äºè¿™ä¸ªç±»çš„å†…å®¹ç®€å•ä»‹ç»ä¸‹ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ç”Ÿæˆåè‡ªè¡Œçœ‹æºç ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/33a15c47616b447191f4f468e4e6d284~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220824143229899"></p><p>1ã€ç”Ÿæˆçš„ç±» StudentOuterClass æœ‰ 4 ä¸ªå­ç±»ï¼š</p><blockquote><p>Student ï¼ˆå®ç°äº† StudentOrBuilder æ¥å£ï¼‰</p><p>Weather ï¼ˆå®ç°äº† WeatherOrBuilder æ¥å£ï¼‰</p><p>StudentOrBuilder ï¼ˆæ¥å£ï¼‰</p><p>WeatherOrBuilder ï¼ˆæ¥å£ï¼‰</p></blockquote><p>2ã€Student æ˜¯ StudentOuterClass çš„é™æ€å†…éƒ¨ç±»ï¼Œæ„é€ æ–¹æ³•ç§æœ‰åŒ–ï¼Œéœ€é€šè¿‡ Builder æ¨¡å¼åˆ›å»ºå¯¹è±¡ã€‚å¦å¤– Student æä¾›äº†å±æ€§çš„ get æ–¹æ³•ï¼Œæ—  set æ–¹æ³•ï¼ŒBuilder ä½œä¸º Student çš„é™æ€å†…éƒ¨ç±»æä¾›äº†å±æ€§çš„ getï¼Œsetï¼Œclearæ–¹æ³•ï¼Œclear å°±æ˜¯æ¸…ç©ºæŸä¸ªå±æ€§å›åˆ°åˆå§‹å€¼</p><p>3ã€Weather åŒ 2</p><h2 id="å…­ã€Protobuf-ä½¿ç”¨"><a href="#å…­ã€Protobuf-ä½¿ç”¨" class="headerlink" title="å…­ã€Protobuf ä½¿ç”¨"></a>å…­ã€Protobuf ä½¿ç”¨</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹åˆšæ‰ç”Ÿæˆçš„ Java ç±»è¿›è¡Œä½¿ç”¨</p><h3 id="6-1ã€åŸºæœ¬è°ƒç”¨"><a href="#6-1ã€åŸºæœ¬è°ƒç”¨" class="headerlink" title="6.1ã€åŸºæœ¬è°ƒç”¨"></a>6.1ã€åŸºæœ¬è°ƒç”¨</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//æ„å»º Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> student = StudentOuterClass.Student.newBuilder()<br>        .setName(<span class="hljs-string">&quot;erdai&quot;</span>)<br>        .setAge(<span class="hljs-number">18</span>)<br>        .setEmail(<span class="hljs-string">&quot;erdai666@qq.com&quot;</span>)<br>        .addAllCourse(mutableListOf(<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>))<br>        .build()<br>    println(student)<br>    println()<br>    println(StudentOuterClass.Weather.Season.SPRING.number)<br>    println(StudentOuterClass.Weather.Season.SUMMER.number)<br>    println(StudentOuterClass.Weather.Season.AUTUMN.number)<br>    println(StudentOuterClass.Weather.Season.WINTER.number)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>name: <span class="hljs-string">&quot;erdai&quot;</span><br>age: <span class="hljs-number">18</span><br>email: <span class="hljs-string">&quot;erdai666@qq.com&quot;</span><br>course: <span class="hljs-string">&quot;Math&quot;</span><br>course: <span class="hljs-string">&quot;English&quot;</span><br>course: <span class="hljs-string">&quot;Computer&quot;</span><br><br><br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="6-2ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#6-2ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="6.2ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>6.2ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//1ã€æ„å»º Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> student = StudentOuterClass.Student.newBuilder()<br>        .setName(<span class="hljs-string">&quot;erdai&quot;</span>)<br>        .setAge(<span class="hljs-number">18</span>)<br>        .setEmail(<span class="hljs-string">&quot;erdai666@qq.com&quot;</span>)<br>        .addAllCourse(mutableListOf(<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>))<br>        .build()<br>    <span class="hljs-comment">//2ã€åºåˆ—åŒ–å¹¶è¿”å›ä¸€ä¸ªåŒ…å«å…¶åŸå§‹å­—èŠ‚çš„å­—èŠ‚æ•°ç»„</span><br>    <span class="hljs-keyword">val</span> byteArray: ByteArray = student.toByteArray()<br>    <span class="hljs-comment">//3ã€ååºåˆ—åŒ–ä»å­—èŠ‚æ•°ç»„ä¸­è§£ææ¶ˆæ¯</span><br>    <span class="hljs-keyword">val</span> parseStudent: StudentOuterClass.Student = StudentOuterClass.Student.parseFrom(byteArray)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸ƒã€Protobuf-å’Œ-Json-ç›¸äº’è½¬æ¢"><a href="#ä¸ƒã€Protobuf-å’Œ-Json-ç›¸äº’è½¬æ¢" class="headerlink" title="ä¸ƒã€Protobuf å’Œ Json ç›¸äº’è½¬æ¢"></a>ä¸ƒã€Protobuf å’Œ Json ç›¸äº’è½¬æ¢</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">implementation <span class="hljs-string">&#x27;com.google.protobuf:protobuf-java-util:3.19.2&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="7-1ã€Protobuf-è½¬-Json"><a href="#7-1ã€Protobuf-è½¬-Json" class="headerlink" title="7.1ã€Protobuf è½¬ Json"></a>7.1ã€Protobuf è½¬ Json</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//1ã€æ„å»º Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> student = StudentOuterClass.Student.newBuilder()<br>        .setName(<span class="hljs-string">&quot;erdai&quot;</span>)<br>        .setAge(<span class="hljs-number">18</span>)<br>        .setEmail(<span class="hljs-string">&quot;erdai666@qq.com&quot;</span>)<br>        .addAllCourse(mutableListOf(<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>))<br>        .build()<br>    <span class="hljs-comment">//2ã€Protobuf è½¬ Json</span><br>    <span class="hljs-keyword">val</span> json = JsonFormat.printer().print(student)<br>    <span class="hljs-comment">//3ã€æ‰“å° json</span><br>    println(json)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;erdai&quot;</span>,<br>  <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">18</span>,<br>  <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;erdai666@qq.com&quot;</span>,<br>  <span class="hljs-string">&quot;course&quot;</span>: [<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7-2ã€Json-è½¬-Protobuf"><a href="#7-2ã€Json-è½¬-Protobuf" class="headerlink" title="7.2ã€Json è½¬ Protobuf"></a>7.2ã€Json è½¬ Protobuf</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//1ã€æ„å»º Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> student = StudentOuterClass.Student.newBuilder()<br>        .setName(<span class="hljs-string">&quot;erdai&quot;</span>)<br>        .setAge(<span class="hljs-number">18</span>)<br>        .setEmail(<span class="hljs-string">&quot;erdai666@qq.com&quot;</span>)<br>        .addAllCourse(mutableListOf(<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>))<br>        .build()<br>    <span class="hljs-comment">//2ã€Protobuf å¯¹è±¡è½¬ Json</span><br>    <span class="hljs-keyword">val</span> json = JsonFormat.printer().print(student)<br>    <span class="hljs-comment">//3ã€Json è½¬ Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> builder = StudentOuterClass.Student.newBuilder()<br>    JsonFormat.parser().ignoringUnknownFields().merge(json,builder)<br>    <span class="hljs-comment">//4ã€æ‰“å° Protobuf å¯¹è±¡</span><br>    println(builder.build())<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>name: <span class="hljs-string">&quot;erdai&quot;</span><br>age: <span class="hljs-number">18</span><br>email: <span class="hljs-string">&quot;erdai666@qq.com&quot;</span><br>course: <span class="hljs-string">&quot;Math&quot;</span><br>course: <span class="hljs-string">&quot;English&quot;</span><br>course: <span class="hljs-string">&quot;Computer&quot;</span><br></code></pre></td></tr></table></figure><h2 id="å…«ã€Protobuf-å’Œ-Java-å¯¹è±¡ç›¸äº’è½¬æ¢"><a href="#å…«ã€Protobuf-å’Œ-Java-å¯¹è±¡ç›¸äº’è½¬æ¢" class="headerlink" title="å…«ã€Protobuf å’Œ Java å¯¹è±¡ç›¸äº’è½¬æ¢"></a>å…«ã€Protobuf å’Œ Java å¯¹è±¡ç›¸äº’è½¬æ¢</h2><p>è¿™ä¸ªå®åˆ™æ˜¯åœ¨ä¸ƒçš„åŸºç¡€ä¸Šï¼Œå½“æˆ‘ä»¬å°† Protobuf è½¬æ¢ä¸º Json åï¼Œåœ¨æŠŠ Json è½¬æ¢ä¸ºå¯¹åº”çš„ Java å¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆå¼•å…¥ Gson ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">implementation <span class="hljs-string">&#x27;com.google.code.gson:gson:2.8.9&#x27;</span><br></code></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ªæ¥æ”¶å½“å‰ Json çš„æ•°æ®æ¨¡å‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyStudent</span>(<br>    <span class="hljs-keyword">var</span> name: String? = <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-keyword">var</span> age: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>,<br>    <span class="hljs-keyword">var</span> email: String? = <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-keyword">var</span> course: MutableList&lt;String&gt;? = <span class="hljs-literal">null</span><br>)<br></code></pre></td></tr></table></figure><p>æœ€åè¿›è¡Œè½¬æ¢ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//1ã€æ„å»º Protobuf å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> student = StudentOuterClass.Student.newBuilder()<br>        .setName(<span class="hljs-string">&quot;erdai&quot;</span>)<br>        .setAge(<span class="hljs-number">18</span>)<br>        .setEmail(<span class="hljs-string">&quot;erdai666@qq.com&quot;</span>)<br>        .addAllCourse(mutableListOf(<span class="hljs-string">&quot;Math&quot;</span>, <span class="hljs-string">&quot;English&quot;</span>, <span class="hljs-string">&quot;Computer&quot;</span>))<br>        .build()<br>    <span class="hljs-comment">//2ã€å°† Protobuf è½¬æ¢ä¸º Json</span><br>    <span class="hljs-keyword">val</span> json = JsonFormat.printer().print(student)<br><br>    <span class="hljs-comment">//3ã€å°† Json è½¬æ¢ä¸º Java Bean å¯¹è±¡</span><br>    <span class="hljs-keyword">val</span> myStudent = Gson().fromJson(json,MyStudent::<span class="hljs-keyword">class</span>.java)<br>    println(myStudent)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>MyStudent(name=erdai, age=<span class="hljs-number">18</span>, email=<span class="hljs-symbol">erdai666@</span>qq.com, course=[Math, English, Computer])<br></code></pre></td></tr></table></figure><h2 id="ä¹ã€æ€»ç»“"><a href="#ä¹ã€æ€»ç»“" class="headerlink" title="ä¹ã€æ€»ç»“"></a>ä¹ã€æ€»ç»“</h2><p>å…³äº Protobuf çš„å¼€å‘æµç¨‹ï¼šä¸€èˆ¬éƒ½æ˜¯åå°å®šä¹‰å¥½ Protobuf ï¼Œç„¶åç»™åˆ°æˆ‘ä»¬å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯åœ¨æ ¹æ® Protobuf ç”Ÿæˆå¯¹åº”å¹³å°çš„ä»£ç è¿›è¡Œä½¿ç”¨å³å¯ã€‚å› æ­¤ä¸Šé¢æˆ‘è®²çš„è¿™äº›å†…å®¹ä½ æŒæ¡äº†ï¼ŒåŸºæœ¬ä¸Šèƒ½æ»¡è¶³æ—¥å¸¸çš„å¼€å‘</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¦‚æœæœ‰å•¥é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºä¸€èµ·äº¤æµ</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://developers.google.com/protocol-buffers/docs/proto3">Protocol Buffers å®˜æ–¹æ–‡æ¡£</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šAndroid Emoji è¡¨æƒ…åˆ†äº«å’Œå®è·µ</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AAndroid%20Emoji%20%E8%A1%A8%E6%83%85%E5%88%86%E4%BA%AB%E5%92%8C%E5%AE%9E%E8%B7%B5/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AAndroid%20Emoji%20%E8%A1%A8%E6%83%85%E5%88%86%E4%BA%AB%E5%92%8C%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/301a8e00a98440299835b6d3220b110a~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æœ€è¿‘å¼€å‘äº†ä¸€ä¸ª LiveChat å®¢æœèŠå¤©çš„æ¨¡å—ï¼Œé‡Œé¢æ¶‰åŠåˆ° Emoji è¡¨æƒ…ï¼Œé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œåˆ†äº«ä¸‹è‡ªå·±çš„ä¸€ä¸ªè§£å†³è¿‡ç¨‹ä»¥åŠå…³äº Android Emoji çš„ç›¸å…³çŸ¥è¯†ç‚¹</p><h2 id="ä¸€ã€Emoji-è¡¨æƒ…ä»‹ç»"><a href="#ä¸€ã€Emoji-è¡¨æƒ…ä»‹ç»" class="headerlink" title="ä¸€ã€Emoji è¡¨æƒ…ä»‹ç»"></a>ä¸€ã€Emoji è¡¨æƒ…ä»‹ç»</h2><p>ä¸‹é¢å¤§æ¦‚ä»‹ç»ä¸€ä¸‹å…³äº Emoji è¡¨æƒ…ï¼š</p><p>1ã€Emoji æ˜¯å¯ä»¥è¢«æ’å…¥æ–‡å­—ä¸­çš„å›¾å½¢ç¬¦å·ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ—¥æœ¬è¯­ï¼Œe è¡¨ç¤ºâ€ç»˜â€ï¼Œmoji è¡¨ç¤º â€œæ–‡å­—â€ ï¼Œè¿åœ¨ä¸€èµ·å°±æ˜¯ â€œç»˜æ–‡å­—â€ï¼Œå®ƒæœ€æ—©æ˜¯ç”¨äºæˆ‘ä»¬å‘çŸ­ä¿¡æ¥å¢å¼ºç”¨æˆ·çš„ä¸€ä¸ªä½“éªŒï¼Œ2007 å¹´ï¼ŒApple åœ¨ iPhone ä¸­æ”¯æŒäº† Emojiï¼Œæ‰è®©å®ƒåœ¨å…¨çƒèŒƒå›´å†…æµè¡Œèµ·æ¥ã€‚</p><p>2ã€åœ¨ 2010 å¹´ä»¥å‰ï¼ŒEmoji çš„å®ç°æ˜¯å°†ä¸€äº›ç‰¹æ®Šçš„ç¬¦å·ç»„åˆæ›¿æ¢æˆå›¾ç‰‡è¡¨æƒ…ï¼Œä¾‹å¦‚ <code>:)</code> æ›¿æ¢æˆ ğŸ˜Š ï¼Œè¿™æ ·çš„è§£å†³æ–¹æ¡ˆå¯¼è‡´ Emoji è¡¨æƒ…å¾ˆéš¾æ ‡å‡†åŒ–ï¼Œè€Œä¸”è¡¨è¾¾èŒƒå›´æœ‰é™</p><p>3ã€ä» 2010 å¹´å¼€å§‹ï¼ŒUnicode å¼€å§‹ä¸º Emoji åˆ†é…å›ºå®šçš„ç ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ä¹‹åï¼Œæ¯ä¸€ä¸ª Unicode å­—ç¬¦å¯¹åº”ä¸€ä¸ªå­—ä½“ï¼Œå®ƒä¼šè¢«æ¸²æŸ“ä¸ºå›¾ç‰‡æ˜¾ç¤º</p><p>4ã€Emoji è¡¨æƒ…ç”±äºå…¶è¡¨è¾¾æƒ…ç»ªçš„ç‰¹ç‚¹ï¼Œè¢«å¹¿å—æ¬¢è¿ã€‚Emoji è¡¨æƒ…çš„å›½é™…æ ‡å‡†åœ¨ 2015 å¹´å‡ºå°ï¼Œåˆ°ç›®å‰ä¸ºæ­¢å·²ç»æ˜¯ V13.1 ç‰ˆæœ¬çš„æ ‡å‡†äº†ï¼Œå…·ä½“å…³äº Unicode å­—ç¬¦å’Œ Emoji è¡¨æƒ…çš„ä¸€ä¸ªæ˜ å°„å…³ç³»ä»¥åŠå…¶ä»–çš„ä¸€äº›ç»†èŠ‚ï¼Œå¯ä»¥ä»è¿™ä¸ªç½‘ç«™ä¸­å»æŸ¥è¯¢ï¼š<a href="http://www.unicode.org/emoji/charts/full-emoji-list.html">http://www.unicode.org/emoji/charts/full-emoji-list.html</a> </p><h2 id="äºŒã€éœ€æ±‚"><a href="#äºŒã€éœ€æ±‚" class="headerlink" title="äºŒã€éœ€æ±‚"></a>äºŒã€éœ€æ±‚</h2><p>å¯¹ Emoji è¡¨æƒ…æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ä¹‹åï¼Œä¸‹é¢è®²ä¸‹äº§å“ç»™æˆ‘æçš„ä¸€ä¸ªéœ€æ±‚ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š<strong>ä» <a href="http://www.unicode.org/emoji/charts/full-emoji-list.html">http://www.unicode.org/emoji/charts/full-emoji-list.html</a> è¿™ä¸ªç½‘ç«™ä¸­ï¼Œç­›é€‰ä¸€äº›å¸¸ç”¨çš„ Emoji è¡¨æƒ…ï¼Œç„¶åæ ¹æ® UI è®¾è®¡ç¨¿ï¼Œå®ç°è¡¨æƒ…åŒ…åŠŸèƒ½å³å¯</strong></p><p>äº†è§£äº†éœ€æ±‚ä¹‹åï¼Œæˆ‘ä»¬å°±è¦å»æ€è€ƒå¦‚ä½•å»å®ç°è¿™ä¸ªåŠŸèƒ½ğŸ¤”ï¼Ÿ</p><p>é¦–å…ˆæ‰“å¼€è¿™ä¸ªç½‘ç«™çœ‹çœ‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/880be0265dfc4da18cd2e30d6566aa66~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210521105455542"></p><p>ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€æ¯ä¸ªè¡¨æƒ…çš„ Unicode å­—ç¬¦</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ Unicodeï¼šUnicode å°±æ˜¯ç»Ÿä¸€çš„å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œå½“éœ€è¦è¡¨ç¤ºä¸€ä¸ª Unicode å­—ç¬¦æ—¶ï¼Œé€šå¸¸ä¼šç”¨ U+ ç„¶åç´§æ¥ç€ä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•°å­—æ¥è¡¨ç¤ºï¼Œå¦‚ä¸Šå›¾æ‰€åˆ—ä¸¾çš„è¿™äº›</p><p>2ã€æ¯ä¸ª Unicode å­—ç¬¦å¯¹åº”çš„ Emoji è¡¨æƒ…åœ¨å„ä¸ªå¹³å°å±•ç¤ºçš„æ ·å¼éƒ½ä¸å¤ªä¸€æ ·ï¼Œå› ä¸º Unicode åªæ˜¯è§„å®šäº† Emoji çš„ç ç‚¹å’Œå«ä¹‰ï¼Œå¹¶æ²¡æœ‰è§„å®šå®ƒçš„æ ·å¼ï¼Œæ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ Emoji å®ç°</p><h2 id="ä¸‰ã€Unicode-ä½¿ç”¨"><a href="#ä¸‰ã€Unicode-ä½¿ç”¨" class="headerlink" title="ä¸‰ã€Unicode ä½¿ç”¨"></a>ä¸‰ã€Unicode ä½¿ç”¨</h2><p>åˆ°è¿™é‡Œæˆ‘å¿ƒé‡Œä¼šæœ‰ä¸ªç–‘é—®ï¼šæˆ‘å¦‚ä½•å°†è¿™äº› Unicode å­—ç¬¦å¦‚ U+1F600 åœ¨ Android ä¸­ä½¿ç”¨å‘¢ï¼Ÿ</p><p>Unicode å…è®¸æˆ‘ä»¬ä½¿ç”¨ Codeã€UTF-8ã€Surrogates ç­‰è¿™äº›å½¢å¼æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œé‚£å…¶å®è¿™å°±æ˜¯ä¸€ä¸ªçªç ´å£</p><p>ä»¥ code å½¢å¼ä¸¾ä¾‹ï¼šä¾‹å¦‚è¯´æˆ‘çš„ä¸€ä¸ª Emoji è¡¨æƒ…çš„ code å½¢å¼æ˜¯ 1F600ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥ç»è¿‡ä¸€ç³»åˆ— Api çš„è½¬æ¢ï¼Œè®©ä»–èƒ½å¤Ÿä½¿ç”¨ Android æ§ä»¶å»åŠ è½½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å°†å½“å‰ code è½¬æ¢ä¸º 16 è¿›åˆ¶æ•°</span><br><span class="hljs-type">int</span> <span class="hljs-variable">hex</span> <span class="hljs-operator">=</span> Integer.parseInt(<span class="hljs-string">&quot;1F600&quot;</span>, <span class="hljs-number">16</span>);<br><span class="hljs-comment">//å°†å½“å‰ 16 è¿›åˆ¶æ•°è½¬æ¢æˆå­—ç¬¦æ•°ç»„</span><br><span class="hljs-type">char</span>[] chars = Character.toChars(hex);<br><span class="hljs-comment">//å°†å½“å‰å­—ç¬¦æ•°ç»„è½¬æ¢æˆ TextView å¯åŠ è½½çš„ String å­—ç¬¦ä¸²</span><br><span class="hljs-type">String</span> <span class="hljs-variable">mEmojiString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(chars);<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šè¿°è½¬æ¢ï¼Œå°†ç”Ÿæˆçš„ String å¯¹è±¡ï¼Œä¼ é€’ç»™ TextViewï¼Œå¦‚æœæ˜¯å½“å‰è®¾å¤‡æ”¯æŒçš„ Emojiï¼Œå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†</p><h2 id="å››ã€Emoji-è¡¨æƒ…å®è·µ"><a href="#å››ã€Emoji-è¡¨æƒ…å®è·µ" class="headerlink" title="å››ã€Emoji è¡¨æƒ…å®è·µ"></a>å››ã€Emoji è¡¨æƒ…å®è·µ</h2><p>æœ‰äº†æ€è·¯ï¼Œå°±å¼€å§‹æ’¸èµ·æŸšå­å¹²ï¼ŒæŠŠç­›é€‰å‡ºçš„è¡¨æƒ… code æ”¾åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œç„¶åé€šè¿‡ ViewPager + Fragment + RecyclerView ç­‰ä¸€ç³»åˆ—æ§ä»¶çš„é…åˆï¼Œå®ç°äº† UI éœ€è¦çš„æ•ˆæœï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3a456040f8a4825854a804bdbdc73b4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210510130326366"></p><p>ä»ä¸Šå›¾å¯ä»¥å‘ç°ä¸€ä¸ªé—®é¢˜ï¼š<strong>æœ‰äº› Emoji è¡¨æƒ…æ˜¾ç¤ºå‡ºæ¥åƒä¸€ä¸ªä¿¡å°</strong></p><p>åŸå› æ˜¯å½“å‰è®¾å¤‡ä¸æ”¯æŒï¼Œä¸Šé¢æˆ‘è®²åˆ°æ¯ä¸€ä¸ª Unicode å­—ç¬¦å¯¹åº”ä¸€ä¸ªå­—ä½“ï¼Œå®ƒä¼šè¢«æ¸²æŸ“ä¸ºå›¾ç‰‡æ˜¾ç¤ºï¼Œä½†æ˜¯å¦‚æœå½“å‰ç³»ç»Ÿä¸æ”¯æŒè¿™ç§å­—ä½“ï¼Œé‚£ä¹ˆå°±ä¼šæ˜¾ç¤ºå‡ºä¸€ä¸ªä¿¡å°ï¼Œè€Œä¸”éšç€ Android ç‰ˆæœ¬è¶Šæ¥è¶Šä½ï¼Œè¿™ç§æƒ…å†µè¶Šæ¥è¶Šå¤šï¼Œè¿™ç§æ•ˆæœè‚¯å®šæ˜¯ä¸è¡Œçš„</p><p>çŸ¥é“äº†å‡ºç°çš„é—®é¢˜å’ŒåŸå› ï¼Œæˆ‘ä»¬å°±è¦å»æƒ³è§£å†³æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™ EmojiCompat å°±æ¥äº†</p><h2 id="äº”ã€EmojiCompat-ä»‹ç»"><a href="#äº”ã€EmojiCompat-ä»‹ç»" class="headerlink" title="äº”ã€EmojiCompat ä»‹ç»"></a>äº”ã€EmojiCompat ä»‹ç»</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯-EmojiCompat-ï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯-EmojiCompat-ï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ EmojiCompat ï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯ EmojiCompat ï¼Ÿ</h3><p>EmojiCompat æ˜¯ Google å®˜æ–¹ç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ª Emoji è¡¨æƒ…å…¼å®¹åº“ï¼Œæœ€ä½æ”¯æŒåˆ° Android 4.4(Api Level 19) çš„ç³»ç»Ÿè®¾å¤‡ï¼Œå®ƒå¯ä»¥é˜²æ­¢åº”ç”¨ä¸­ï¼Œå‡ºç°ä»¥ä¿¡å°çš„å½¢å¼æ¥æ˜¾ç¤º Emojiï¼Œè™½ç„¶å®ƒä»…ä»…åªæ˜¯å› ä¸ºä½ å½“å‰çš„è®¾å¤‡æ²¡æœ‰è¿™ä¸ªå­—ä½“è€Œå·²ã€‚é€šè¿‡ EmojiCompat ï¼Œä½ çš„è®¾å¤‡æ— éœ€ç­‰å¾… Android ç³»ç»Ÿæ›´æ–°ï¼Œå°±å¯ä»¥è·å¾—æœ€æ–°çš„ Emoji è¡¨æƒ…æ˜¾ç¤ºæ•ˆæœã€‚</p><p>EmojiCompat çš„è¿è¡ŒåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/269e10afe7234f38bec1d40cb4c86be1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210510142708101"></p><p>ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šEmojiCompat ä¼šåˆ¤æ–­å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒè¿™ä¸ª Emojiï¼Œå¦‚æœæ”¯æŒåˆ™è¿˜æ˜¯ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„å­—ä½“åŠ è½½ï¼Œå¦‚æœä¸æ”¯æŒï¼Œåˆ™ä½¿ç”¨ EmojiSpan æ¥è¿›è¡Œæ›¿æ¢ï¼Œä»è€Œè¾¾åˆ°æ›¿æ¢æ¸²æŸ“çš„æ•ˆæœ</p><h3 id="2ã€å¦‚ä½•ä½¿ç”¨-EmojiCompat-ï¼Ÿ"><a href="#2ã€å¦‚ä½•ä½¿ç”¨-EmojiCompat-ï¼Ÿ" class="headerlink" title="2ã€å¦‚ä½•ä½¿ç”¨ EmojiCompat ï¼Ÿ"></a>2ã€å¦‚ä½•ä½¿ç”¨ EmojiCompat ï¼Ÿ</h3><p>è¦ä½¿ç”¨ EmojiCompat ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">EmojiCompat.init(config);<br><span class="hljs-comment">//EmojiCompat çš„ init æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> EmojiCompat <span class="hljs-title function_">init</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Config config)</span> &#123;<br>    <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">synchronized</span> (sInstanceLock) &#123;<br>            <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) &#123;<br>                sInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>(config);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sInstance;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œ EmojiCompat æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œåˆå§‹åŒ–æ–¹æ³•å°±æ˜¯ä¼ å…¥äº†ä¸€ä¸ª config å³é…ç½®ï¼Œå› æ­¤æ„å»ºé…ç½®æ˜¯ EmojiCompat åˆå§‹åŒ–èƒ½å¦æˆåŠŸçš„é‡ç‚¹æ‰€åœ¨ï¼ŒGoogle ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§é…ç½® ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š</p><p>1ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®</p><p>2ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®</p><p>æ ¹æ® Google å®˜æ–¹ä»‹ç»ï¼š</p><h5 id="1ï¼‰ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®"><a href="#1ï¼‰ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®" class="headerlink" title="1ï¼‰ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®"></a>1ï¼‰ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®</h5><p>åŸç†ï¼šå¯ä¸‹è½½çš„å­—ä½“çš„æ–¹å¼ä¼šåœ¨é¦–æ¬¡å¯åŠ¨ app çš„æ—¶å€™æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰è¯¥å­—ä½“ï¼Œæ²¡æœ‰çš„è¯ä¼šä»ç½‘ä¸Šä¸‹è½½æœ€æ–°çš„ Emoji å­—ä½“ï¼Œç„¶åé‡åˆ°ä¸æ”¯æŒçš„ Emojiï¼Œå°±ä¼šä»è¿™ä¸ªå­—ä½“æ–‡ä»¶ä¸­ï¼ŒåŠ è½½èµ„æºå¹¶ä¸”æ¸²æŸ“</p><p>ç¼ºç‚¹ï¼šå¯ä¸‹è½½å­—ä½“çš„æ–¹å¼ï¼Œå®Œå…¨ä¾èµ– GMS æœåŠ¡ï¼Œåœ¨æ²¡æœ‰ GMS æœåŠ¡çš„æ‰‹æœºä¸Šå¹¶ä¸å¯ç”¨</p><h5 id="2ï¼‰ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®"><a href="#2ï¼‰ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®" class="headerlink" title="2ï¼‰ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®"></a>2ï¼‰ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®</h5><p>åŸç†ï¼šæœ¬åœ°æ†ç»‘çš„æ–¹å¼ä¼šåœ¨ App æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œæ¤å…¥ä¸€ä¸ªæœ€æ–°çš„ Emoji å­—ä½“æ–‡ä»¶ï¼Œç„¶åé‡åˆ°ä¸æ”¯æŒçš„ Emojiï¼Œå°±ä¼šä»è¿™ä¸ªå­—ä½“æ–‡ä»¶ä¸­ï¼ŒåŠ è½½èµ„æºå¹¶ä¸”æ¸²æŸ“</p><p>ç¼ºç‚¹ï¼šæœ¬åœ°æ†ç»‘çš„æ–¹å¼ä¼šåµŒå…¥ä¸€ä¸ªçº¦ 9M+ çš„å­—ä½“æ–‡ä»¶ï¼Œæ— å½¢ä¸­å¢å¤§äº† Apk å®‰è£…åŒ…çš„ä½“ç§¯</p><p>ç›®å‰å®˜æ–¹ä½¿ç”¨çš„æ˜¯ NotoColorEmojiCompat.ttf å­—ä½“æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°çº¦ 9M+</p><p>ä¸‹é¢å…ˆè®²ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼å»è¿›è¡Œåˆå§‹åŒ–</p><h4 id="1ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®"><a href="#1ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®" class="headerlink" title="1ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®"></a>1ã€å¯ä¸‹è½½çš„å­—ä½“é…ç½®</h4><p>1ï¼‰ã€æ·»åŠ  Gradle ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;androidx.emoji:emoji:1.1.0&#x27;</span><br></code></pre></td></tr></table></figure><p>2ï¼‰ã€æ„å»ºå¯ä¸‹è½½å­—ä½“é…ç½®åˆå§‹åŒ– EmojiCompat ï¼Œæ„å»ºç›¸å…³ä¿¡æ¯å‚ç…§ <strong><a href="https://github.com/googlearchive/android-EmojiCompat">android-EmojiCompat</a></strong> è¿™ä¸ªé¡¹ç›®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">FontRequest</span> <span class="hljs-variable">fontRequest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontRequest</span>(<br>                <span class="hljs-string">&quot;com.google.android.gms.fonts&quot;</span>,<br>                <span class="hljs-string">&quot;com.google.android.gms&quot;</span>,<br>                <span class="hljs-string">&quot;Noto Color Emoji Compat&quot;</span>,<br>                R.array.chat_com_google_android_gms_fonts_certs);<br>EmojiCompat.<span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontRequestEmojiCompatConfig</span>(mContext, fontRequest);<br>config.setReplaceAll(<span class="hljs-literal">true</span>);<br>config.registerInitCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>.InitCallback() &#123;<br>     <span class="hljs-meta">@Override</span><br>     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInitialized</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//åˆå§‹åŒ–æˆåŠŸå›è°ƒ  </span><br>     &#125;<br><br>     <span class="hljs-meta">@Override</span><br>     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Throwable throwable)</span> &#123;<br>  <span class="hljs-comment">//åˆå§‹åŒ–å¤±è´¥å›è°ƒ</span><br>     &#125;<br>&#125;);<br>EmojiCompat.init(config);<br></code></pre></td></tr></table></figure><h4 id="2ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®"><a href="#2ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®" class="headerlink" title="2ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®"></a>2ã€æœ¬åœ°æ†ç»‘çš„å­—ä½“é…ç½®</h4><p>1ï¼‰ã€æ·»åŠ  Gradle ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;androidx.emoji:emoji-bundled:1.1.0&#x27;</span><br></code></pre></td></tr></table></figure><p>2ï¼‰ã€æ„å»ºæœ¬åœ°æ†ç»‘å­—ä½“é…ç½®åˆå§‹åŒ– EmojiCompat</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">EmojiCompat.<span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundledEmojiCompatConfig</span>(mContext, fontRequest);<br>config.setReplaceAll(<span class="hljs-literal">true</span>);<br>config.registerInitCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>.InitCallback() &#123;<br>     <span class="hljs-meta">@Override</span><br>     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInitialized</span><span class="hljs-params">()</span> &#123;<br>         <span class="hljs-comment">//åˆå§‹åŒ–æˆåŠŸå›è°ƒ      </span><br>     &#125;<br><br>     <span class="hljs-meta">@Override</span><br>     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Throwable throwable)</span> &#123;<br>  <span class="hljs-comment">//åˆå§‹åŒ–å¤±è´¥å›è°ƒ</span><br>     &#125;<br>&#125;);<br>EmojiCompat.init(config);<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼ŒEmojiCompat çš„åˆå§‹åŒ–å·¥ä½œå°±å®Œæˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸¤ç§æ–¹å¼å…¶å®éƒ½æ˜¯å»æ„å»ºä¸€ä¸ªå­—ä½“é…ç½®å³ config å»åˆå§‹åŒ–</p><p>é‚£æˆ‘ä¼šæƒ³ï¼šæ˜¯å¦å¯ä»¥æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å­—ä½“é…ç½®å»å®Œæˆ EmojiCompat çš„åˆå§‹åŒ–å‘¢ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å…ˆç•™ç€ï¼Œç»§ç»­å¾€ä¸‹çœ‹</p><h4 id="3ã€EmojiCompat-å®è·µ"><a href="#3ã€EmojiCompat-å®è·µ" class="headerlink" title="3ã€EmojiCompat å®è·µ"></a>3ã€EmojiCompat å®è·µ</h4><p>ç°åœ¨æˆ‘ä»¬æ¸…æ¥šäº†ï¼š</p><p>1ã€æ„å»ºå­—ä½“é…ç½®</p><p>2ã€ä¸¤ç§å­—ä½“é…ç½®çš„åŸç†å’Œç¼ºç‚¹</p><p>3ã€åˆå§‹åŒ– EmojiCompat</p><p>å› ä¸ºæœ¬åœ°æ†ç»‘å­—ä½“é…ç½®çš„æ–¹å¼ä¼šä½¿æˆ‘ä»¬çš„ app åŒ…ä½“ç§¯å¢å¤§ 9M+ï¼Œè¿™æ˜¯å®Œå…¨ä¸èƒ½æ¥å—çš„ï¼Œè€Œä¸”æˆ‘ä»¬çš„ app ä¸»è¦æ˜¯é¢å‘å›½å¤–çš„ç”¨æˆ·ï¼Œå›½å¤–ç”¨æˆ·æ‰‹æœºä¸€èˆ¬éƒ½æœ‰ GMS æœåŠ¡ï¼Œå› æ­¤æˆ‘é€‰ç”¨äº†<strong>å¯ä¸‹è½½å­—ä½“é…ç½®</strong>æ¥å®Œæˆ EmojiCompat çš„åˆå§‹åŒ–</p><p>åˆå§‹åŒ–æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ EmojiCompat æä¾›çš„åŠŸèƒ½äº†ï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œè¡¨æƒ…åŒ…åŠ è½½çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å°†å½“å‰ code è½¬æ¢ä¸º 16 è¿›åˆ¶æ•°</span><br><span class="hljs-type">int</span> <span class="hljs-variable">hex</span> <span class="hljs-operator">=</span> Integer.parseInt(<span class="hljs-string">&quot;1F600&quot;</span>, <span class="hljs-number">16</span>);<br><span class="hljs-comment">//å°†å½“å‰ 16 è¿›åˆ¶æ•°è½¬æ¢æˆå­—ç¬¦æ•°ç»„</span><br><span class="hljs-type">char</span>[] chars = Character.toChars(hex);<br><span class="hljs-comment">//å°†å½“å‰å­—ç¬¦æ•°ç»„è½¬æ¢æˆ TextView å¯åŠ è½½çš„ String å­—ç¬¦ä¸²</span><br><span class="hljs-type">String</span> <span class="hljs-variable">mEmojiString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(chars);<br></code></pre></td></tr></table></figure><p>ç°åœ¨åªéœ€è¦å¯¹å½“å‰ mEmojiString é€šè¿‡ EmojiCompat å¤„ç†ä¸€ä¸‹å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åˆ¤æ–­å½“å‰ EmojiCompat æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmojiCompatInit</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">return</span> EmojiCompat.get().getLoadState() == EmojiCompat.LOAD_STATE_SUCCEEDED;<br>&#125;<br><br><span class="hljs-comment">//è·å–å¯å…¼å®¹çš„ emoji å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> CharSequence <span class="hljs-title function_">getCompatEmojiString</span><span class="hljs-params">(String code)</span> &#123;<br>    <span class="hljs-comment">//å°†å½“å‰ code è½¬æ¢ä¸º 16 è¿›åˆ¶æ•°</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">hex</span> <span class="hljs-operator">=</span> Integer.parseInt(code, <span class="hljs-number">16</span>);<br>    <span class="hljs-comment">//å°†å½“å‰ 16 è¿›åˆ¶æ•°è½¬æ¢æˆå­—ç¬¦æ•°ç»„</span><br>    <span class="hljs-type">char</span>[] chars = Character.toChars(hex);<br>    <span class="hljs-comment">//å°†å½“å‰å­—ç¬¦æ•°ç»„è½¬æ¢æˆ TextView å¯åŠ è½½çš„ String å­—ç¬¦ä¸²</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">mEmojiString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(chars);<br>    <span class="hljs-comment">//åˆ¤æ–­å½“å‰ç³»ç»Ÿæ˜¯å¦å¤§äºç­‰äº 19ï¼Œå¹¶ä¸” EmojiCompat åˆå§‹åŒ–æˆåŠŸ</span><br>    <span class="hljs-keyword">if</span>(Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT &amp;&amp; isEmojiCompatInit())&#123;<br>        <span class="hljs-keyword">return</span> EmojiCompat.get().process(mEmojiString);<br>    &#125;<br>    <span class="hljs-keyword">return</span> mEmojiString;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨ EmojiCompat çš„ process æ–¹æ³•å¯¹ä¹‹å‰çš„  emoji å­—ç¬¦ä¸²åšäº†å…¼å®¹å¤„ç†ï¼Œç°åœ¨æ˜¾ç¤ºå‡ºæ¥çš„è¡¨æƒ…å°±ä¸ä¼šæœ‰å•¥é—®é¢˜äº†ï¼Œè¿™ä¸ªåº“ä½¿ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„</p><h4 id="4ã€-EmojiCompat-æä¾›çš„æ§ä»¶"><a href="#4ã€-EmojiCompat-æä¾›çš„æ§ä»¶" class="headerlink" title="4ã€ EmojiCompat æä¾›çš„æ§ä»¶"></a>4ã€ EmojiCompat æä¾›çš„æ§ä»¶</h4><p>è¿™é‡Œæˆ‘ä»¬åœ¨å»¶ä¼¸ä¸€ä¸‹ï¼Œå‡è®¾ä¹‹å‰çš„ä»£ç æˆ‘éƒ½ä¸æƒ³åŠ¨ï¼Œä¹Ÿå°±æ˜¯è¯´ getCompatEmojiString è¿™ä¸ªæ–¹æ³•æˆ‘éƒ½ä¸æƒ³å†™ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¹‹å‰çš„æ–¹å¼å»å®ç°è¡¨æƒ…åŒ…çš„å…¼å®¹ï¼Œå¯ä»¥åšåˆ°ä¹ˆï¼Ÿ</p><p>ç­”ï¼šå¯ä»¥çš„ï¼Œä½¿ç”¨ EmojiCompat æä¾›çš„æ§ä»¶</p><p>EmojiCompat é‡Œé¢æä¾›äº†å¦‚ï¼šEmojiTextViewï¼ŒEmojiButtonï¼ŒEmojiEditTextç­‰æ§ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;androidx.emoji.widget.EmojiTextView<br>    android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span> /&gt;<br>      <br>&lt;androidx.emoji.widget.EmojiButton<br>    android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span> /&gt;<br><br>&lt;androidx.emoji.widget.EmojiEditText<br>    android:layout_width=<span class="hljs-string">&quot;wrap_content&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šè¿™äº›æ§ä»¶çš„æºç é‡Œé¢æœ€ç»ˆè¿˜æ˜¯ä¼šè°ƒç”¨ EmojiCompat çš„ process æ–¹æ³•å¯¹ä¹‹å‰çš„ emoji å­—ç¬¦ä¸²åšå…¼å®¹å¤„ç†ï¼Œå¦‚æœ EmojiCompat åˆå§‹åŒ–å¤±è´¥ï¼Œè¿™äº› EmojiCompat æä¾›çš„æ§ä»¶å’Œå®ƒç»§æ‰¿çš„æ§ä»¶åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œä»…æ­¤è€Œå·²</p><p>æœ€ç»ˆæˆ‘çš„å®ç°æ–¹æ¡ˆå°±æ˜¯ï¼š<strong>ä½¿ç”¨å¯ä¸‹è½½å­—ä½“é…ç½®åˆå§‹åŒ– EmojiCompatï¼Œåœ¨ä½¿ç”¨ EmojiCompat æä¾›çš„æ§ä»¶æ›¿æ¢ä¹‹å‰çš„æ§ä»¶å®ç°äº†è¡¨æƒ…åŒ…çš„å…¼å®¹</strong>ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/451cf961936f4522a18c3b8e29d1feb5~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210526145027221"></p><p>å¯èƒ½ä½ ä¼šå‘ç°è¿™å¼ æ•ˆæœå›¾å’Œä¹‹å‰é‚£å¼ ä¸€äº›èƒ½æ˜¾ç¤ºå‡ºæ¥çš„ Emoji è¡¨æƒ…æ•ˆæœä¸ä¸€æ ·ï¼Œè¿™æ˜¯å•¥æƒ…å†µå‘¢ï¼Ÿ</p><p>ä¹‹å‰æˆ‘è®²è¿‡ï¼šEmojiCompat ä¼šåˆ¤æ–­å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒè¿™ä¸ª Emojiï¼Œå¦‚æœæ”¯æŒåˆ™è¿˜æ˜¯ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„å­—ä½“åŠ è½½ï¼Œå¦‚æœä¸æ”¯æŒï¼Œåˆ™ä½¿ç”¨ EmojiSpan æ¥è¿›è¡Œæ›¿æ¢ï¼Œä»è€Œè¾¾åˆ°æ›¿æ¢æ¸²æŸ“çš„æ•ˆæœã€‚è¿™æ˜¯åœ¨ä½ æ²¡è®¾ç½® config.setReplaceAll(true) çš„æƒ…å†µä¸‹ï¼Œè€Œå¦‚æœä½ è®¾ç½®äº†  config.setReplaceAll(true) ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ Emoji è¡¨æƒ…éƒ½ä¼šä½¿ç”¨ EmojiSpan æ›¿æ¢å¹¶æ¸²æŸ“</p><h2 id="å…­ã€æ–°çš„é—®é¢˜"><a href="#å…­ã€æ–°çš„é—®é¢˜" class="headerlink" title="å…­ã€æ–°çš„é—®é¢˜"></a>å…­ã€æ–°çš„é—®é¢˜</h2><p>å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œä¼¼ä¹å°±è¦ç»“æŸäº†ï¼Œæˆ‘ä¹Ÿè§‰å¾—è¦ç»“æŸäº†ï¼Œç„¶è€Œæµ‹è¯•é‚£è¾¹å‘ç°è¿˜æ˜¯ä¼šæœ‰æ˜¾ç¤ºé—®é¢˜ï¼ŒåŸå› å…¶å®æˆ‘ä¹ŸçŒœåˆ°äº†ï¼Œé‚£å°±æ˜¯å½“å‰è®¾å¤‡æ²¡æœ‰ GMS æœåŠ¡</p><p>æˆ‘è®²è¿‡å›½å¤–çš„æ‰‹æœºä¸€èˆ¬éƒ½ä¼šæœ‰ GMS æœåŠ¡ï¼Œä½†æ˜¯è¿‘äº›å¹´ä¸­ç¾è´¸æ˜“æˆ˜ï¼Œå¾ˆå¤šåä¸ºæ‰‹æœºæ²¡æœ‰ GMS æœåŠ¡äº†ï¼Œè€Œæˆ‘ä»¬çš„ç”¨æˆ·å­˜åœ¨å¾ˆå¤§ä¸€éƒ¨åˆ†ç”¨æˆ·ç”¨çš„å°±æ˜¯åä¸ºæ‰‹æœºï¼Œå› æ­¤æ‹…å¿ƒå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥å¿…é¡»å¾—å»è§£å†³è¿™ä¸ªé—®é¢˜</p><p>æ‹ä¸€æ‹ç°åœ¨çš„é—®é¢˜ï¼šå¯ä¸‹è½½çš„å­—ä½“é…ç½®å®Œå…¨ä¾èµ– GMS æœåŠ¡ï¼Œå¦‚æœæ²¡æœ‰  GMS æœåŠ¡ï¼Œåˆ™ä¼šå¯¼è‡´å­—ä½“ä¸‹è½½å¤±è´¥ï¼Œç›¸åº”çš„ EmojiCompat å°±ä¼šåˆå§‹åŒ–å¤±è´¥ï¼ŒEmojiCompat åˆå§‹åŒ–å¤±è´¥ï¼Œåˆ™çœ‹å½“å‰ç³»ç»Ÿæ˜¯å¦æ”¯æŒè¯¥ emojiï¼Œå¦‚æœä¸æ”¯æŒï¼Œé‚£å°±ä¼šæ˜¾ç¤ºæˆä¿¡å°çŠ¶ã€‚ä¹‹å‰æœ¬åœ°æ†ç»‘å­—ä½“é…ç½®çš„æ–¹å¼å› ä¸ºä¼šä½¿æˆ‘ä»¬çš„ app åŒ…ä½“ç§¯å¢å¤§ï¼Œç›´æ¥è¢« pass æ‰äº†</p><p>å¦‚æœè¿˜è¦ç»§ç»­ä½¿ç”¨ EmojiCompatï¼Œé—®é¢˜åˆ°äº†è¿™é‡Œä¼¼ä¹æ— è§£äº†ï¼Œåˆ«ç€æ€¥ï¼ŒåŠæ³•æ€»æ¯”å›°éš¾å¤šï¼Œå½“æ—¶æˆ‘å¿ƒé‡Œæœ‰ä¸¤ä¸ªæƒ³æ³•ï¼š</p><p>1ã€æ¨åˆ°ç›®å‰çš„å®ç°æ–¹æ¡ˆè¿›è¡Œé‡æ„</p><p>2ã€ç»§ç»­ç ”ç©¶ EmojiCompat ï¼Œçœ‹æ˜¯å¦æœ‰æ–°çš„è§£å†³æ€è·¯</p><p>æˆ‘è¿™ä¸ªäººæ¯”è¾ƒå–œæ¬¢å·æ‡’ï¼Œ1 å› ä¸ºæ„Ÿè§‰éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›è¢«æˆ‘ pass æ‰äº†ï¼Œ2 å¦‚æœèƒ½ç ”ç©¶è§£å†³ï¼Œé‚£æ”¹åŠ¨å°±éå¸¸çš„å°äº†</p><p>æŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€ï¼Œæˆ‘é€‰æ‹©äº† 2ï¼Œç»§ç»­ç ”ç©¶ EmojiCompat</p><h2 id="ä¸ƒã€EmojiCompat-æºç åˆ†æ"><a href="#ä¸ƒã€EmojiCompat-æºç åˆ†æ" class="headerlink" title="ä¸ƒã€EmojiCompat æºç åˆ†æ"></a>ä¸ƒã€EmojiCompat æºç åˆ†æ</h2><p>å»ºè®®ä½ é…åˆæºç è·Ÿç€æˆ‘çš„æ€è·¯å¾€ä¸‹èµ°</p><p>æˆ‘ä»¬ä» EmojiCompat åˆå§‹åŒ–å¼€å§‹åˆ†æï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> EmojiCompat <span class="hljs-title function_">init</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Config config)</span> &#123;<br>    <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">synchronized</span> (sInstanceLock) &#123;<br>            <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) &#123;<br>                sInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>(config);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sInstance;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢å°±æ˜¯æŠŠ config ä¼ è¿›æ¥ï¼Œé€šè¿‡åŒé‡æ ¡éªŒçš„æ–¹å¼åˆ›å»ºäº†ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œæ¥ç€çœ‹ EmojiCompat çš„è¿™ä¸ªæ„é€ æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-title function_">EmojiCompat</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Config config)</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    mHelper = Build.VERSION.SDK_INT &lt; <span class="hljs-number">19</span> ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompatInternal</span>(<span class="hljs-built_in">this</span>) : <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompatInternal19</span>(<span class="hljs-built_in">this</span>);<br>    loadMetadata();<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å®é™…ä¸Šå°±æ˜¯åšäº†ä¸€äº›å±æ€§åˆå§‹åŒ–çš„å·¥ä½œï¼ŒmHelper åœ¨ç³»ç»Ÿç‰ˆæœ¬å°äº 19 å’Œ ç³»ç»Ÿç‰ˆæœ¬å¤§äºç­‰äº 19 åˆ›å»ºçš„å®ä¾‹æœ‰æ‰€ä¸åŒï¼Œæˆ‘ä»¬çœ‹ä¸‹è¿™ä¸¤ä¸ªç±»ï¼Œå› ä¸ºä»£ç å¤ªé•¿å°±ä¸è´´ä»£ç äº†ï¼š</p><p>CompatInternal ç±»ï¼šé‡Œé¢éƒ½æ˜¯ä¸€äº›é»˜è®¤å®ç°</p><p>CompatInternal19 ç±»ï¼šç»§æ‰¿ CompatInternalï¼Œå¹¶é‡çˆ¶ç±»çš„æ–¹æ³•ä»è€Œè¾¾åˆ°å®ç°åŠŸèƒ½çš„æ•ˆæœ</p><p>æˆ‘ä»¬ä¸»è¦è·Ÿè¿›æœ€åä¸€è¡Œä»£ç  loadMetadata æ–¹æ³•ï¼Œè§åçŸ¥æ„ï¼ŒloadMetadata å°±æ˜¯åŠ è½½å…ƒæ•°æ®å³æ‹‰å–å­—ä½“æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadMetadata</span><span class="hljs-params">()</span> &#123;<br>    mInitLock.writeLock().lock();<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (mMetadataLoadStrategy == LOAD_STRATEGY_DEFAULT) &#123;<br>            mLoadState = LOAD_STATE_LOADING;<br>        &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        mInitLock.writeLock().unlock();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (getLoadState() == LOAD_STATE_LOADING) &#123;<br>        mHelper.loadMetadata();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€å°† mLoadState ç½®ä¸º LOAD_STATE_LOADING è¿›è¡Œä¸Šé”æ“ä½œï¼Œé˜²æ­¢å¤šçº¿ç¨‹å¹¶å‘ï¼Œå¯¼è‡´é‡å¤åˆå§‹åŒ–</p><p>2ã€å¦‚æœå½“å‰çŠ¶æ€ä¸º LOAD_STATE_LOADING , åˆ™è°ƒç”¨ mHelper.loadMetadata()</p><p>æ¥ç€åˆ†æ mHelper.loadMetadata()</p><p>å½“ç³»ç»Ÿç‰ˆæœ¬å°äº 19 çš„æ—¶å€™ï¼Œä¼šèµ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">loadMetadata</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Moves into LOAD_STATE_SUCCESS state immediately.</span><br>    mEmojiCompat.onMetadataLoadSuccess();<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿè¿› mEmojiCompat.onMetadataLoadSuccess æ–¹æ³•çœ‹ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">onMetadataLoadSuccess</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    mInitLock.writeLock().lock();<br>    <span class="hljs-keyword">try</span> &#123;<br>        mLoadState = LOAD_STATE_SUCCEEDED;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        mInitLock.writeLock().unlock();<br>    &#125;<br><br>    mMainHandler.post(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ListenerDispatcher</span>(initCallbacks, mLoadState));<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€å°† mLoadState ç½®ä¸ºLOAD_STATE_SUCCEEDED ï¼ˆå³åˆå§‹åŒ–æˆåŠŸï¼‰è¿›è¡Œä¸Šé”æ“ä½œï¼Œé˜²æ­¢å¤šçº¿ç¨‹å¹¶å‘</p><p>2ã€é€šè¿‡ä¸»çº¿ç¨‹ mMainHandler å°†æ¶ˆæ¯å‘é€åˆ°ä¸»çº¿ç¨‹å¤„ç†</p><p>3ã€é€šè¿‡ ListenerDispatcher è¿›è¡Œç›‘å¬çš„åˆ†å‘ï¼Œæœ€ç»ˆä¼šå›è°ƒåˆ°æˆ‘ä»¬ä¹‹å‰åˆå§‹åŒ–é…ç½®çš„ç›‘å¬</p><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ç³»ç»Ÿç‰ˆæœ¬å°äº 19  å°±ç›´æ¥å›è°ƒæˆåŠŸäº†ï¼Œå¹¶æ²¡æœ‰ä»»ä½•æ‹‰å–å­—ä½“çš„æ“ä½œï¼Œå®é™…å½“ç³»ç»Ÿç‰ˆæœ¬å°äº 19 çš„æ—¶å€™éƒ½æ˜¯ä¸€äº›é»˜è®¤å®ç°ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹æºç ã€‚å› æ­¤å½“ç³»ç»Ÿç‰ˆæœ¬å°äº 19 çš„æ—¶å€™ï¼ŒEmojiCompat æ”¯æŒåº“å¹¶ä¸ä¼šèµ·ä½œç”¨</p><p>æ¥ç€çœ‹å½“ç³»ç»Ÿç‰ˆæœ¬å¤§äºç­‰äº 19 çš„æ—¶å€™ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">loadMetadata</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">MetadataRepoLoaderCallback</span> <span class="hljs-variable">callback</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MetadataRepoLoaderCallback</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onLoaded</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> MetadataRepo metadataRepo)</span> &#123;<br>                onMetadataLoadSuccess(metadataRepo);<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Throwable throwable)</span> &#123;<br>                mEmojiCompat.onMetadataLoadFailed(throwable);<br>            &#125;<br>        &#125;;<br>        mEmojiCompat.mMetadataLoader.load(callback);<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>        mEmojiCompat.onMetadataLoadFailed(t);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€åˆ›å»ºäº†ä¸€ä¸ª MetadataRepoLoaderCallback çš„ callback</p><p>2ã€å¦‚æœ callback å›è°ƒ onLoaded æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒ onMetadataLoadSuccess ï¼Œé‚£ä¹ˆå°±ç›´æ¥åˆå§‹åŒ–æˆåŠŸäº†</p><p>3ã€å¦‚æœ callback å›è°ƒ onFailed æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒ mEmojiCompat.onMetadataLoadFailed(throwable)ï¼Œé‚£ä¹ˆå°±ä¼šåˆå§‹åŒ–å¤±è´¥</p><p>4ã€æœ€ç»ˆä¼šé€šè¿‡ mEmojiCompat.mMetadataLoader çš„ load æ–¹æ³•å»åŠ è½½è¿™ä¸ª callback</p><p>åˆ°è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯æ²¡æœ‰çœ‹åˆ°æ‹‰å–å­—ä½“çš„æ“ä½œï¼Œè€Œæ˜¯æŠŠè¿™ä¸ª callback ä¼ å…¥åˆ°äº† load æ–¹æ³•ä¸­</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ†æ load æ–¹æ³•ï¼Œload æ–¹æ³•æ˜¯ mMetadataLoader çš„ï¼ŒmMetadataLoader æ˜¯ EmojiCompat çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œä¸”åœ¨ EmojiCompat çš„æ„é€ æ–¹æ³•é‡Œåšäº†èµ‹å€¼æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-title function_">EmojiCompat</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Config config)</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    mMetadataLoader = config.mMetadataLoader;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒEmojiCompat çš„ mMetadataLoader æ˜¯ä»æˆ‘ä»¬ä¼ è¿›æ¥çš„ config ä¸­æ‹¿çš„ï¼Œç°åœ¨é—®é¢˜å°±è½¬å˜åˆ°äº†æˆ‘ä»¬é…ç½®çš„ config ä¸­ï¼Œæˆ‘ä»¬çœ‹ä¸€çœ¼å¯ä¸‹è½½å­—ä½“é…ç½®çš„ configï¼Œçœ‹ä¸»è¦æµç¨‹çš„ä¸€äº›ä»£ç ï¼Œå…¶ä»–çš„ç»™çœç•¥äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FontRequestEmojiCompatConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">EmojiCompat</span>.Config &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FontRequestMetadataLoader</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmojiCompat</span>.MetadataRepoLoader &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-meta">@RequiresApi(19)</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">load</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> EmojiCompat.MetadataRepoLoaderCallback loaderCallback)</span> &#123;<br>            Preconditions.checkNotNull(loaderCallback, <span class="hljs-string">&quot;LoaderCallback cannot be null&quot;</span>);<br>            <span class="hljs-keyword">synchronized</span> (mLock) &#123;<br>                <span class="hljs-keyword">if</span> (mHandler == <span class="hljs-literal">null</span>) &#123;<br>                    mThread = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerThread</span>(<span class="hljs-string">&quot;emojiCompat&quot;</span>, Process.THREAD_PRIORITY_BACKGROUND);<br>                    mThread.start();<br>                    mHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(mThread.getLooper());<br>                &#125;<br>                mHandler.post(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                        mCallback = loaderCallback;<br>                        createMetadata();<br>                    &#125;<br>                &#125;);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-meta">@RequiresApi(19)</span><br>        <span class="hljs-keyword">void</span> <span class="hljs-title function_">createMetadata</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>              <span class="hljs-comment">//...</span><br>              <span class="hljs-keyword">final</span> FontsContractCompat.<span class="hljs-type">FontInfo</span> <span class="hljs-variable">font</span> <span class="hljs-operator">=</span> retrieveFontInfo();<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> mFontProviderHelper.buildTypeface(mContext, font);<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> TypefaceCompatUtil.mmap(mContext, <span class="hljs-literal">null</span>, font.getUri());<br>                <span class="hljs-keyword">if</span> (buffer == <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Unable to open file.&quot;</span>);<br>                &#125;<br>                mCallback.onLoaded(MetadataRepo.create(typeface, buffer));<br>                cleanUp();<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>                mCallback.onFailed(t);<br>                cleanUp();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>1ã€FontRequestMetadataLoader å®ç°äº† EmojiCompat.MetadataRepoLoader æ¥å£ï¼Œå®ƒæ˜¯ FontRequestEmojiCompatConfig çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå¹¶é‡å†™äº† load æ–¹æ³•</p><p>2ã€load æ–¹æ³•ä¸»è¦åšçš„äº‹æƒ…æ˜¯ï¼šé€šè¿‡ HandlerThread é…åˆ Handler æŠŠçº¿ç¨‹åˆ‡æ¢åˆ°å­çº¿ç¨‹ï¼Œå°†ä¼ è¿›æ¥çš„ loaderCallback(ä¹Ÿå°±æ˜¯æˆ‘ä»¬å‰é¢åˆ†æçš„é‚£ä¸ª callback) èµ‹å€¼ç»™äº† mCallBackï¼Œå¹¶æ‰§è¡Œ  createMetadata æ–¹æ³•</p><p>æ¥ç€çœ‹ createMetadata æ–¹æ³•ï¼Œå®ƒé‡Œé¢åšçš„ä¸»è¦äº‹æƒ…å°±æ˜¯ï¼š</p><p>1ã€é€šè¿‡ GMS æœåŠ¡æ‹‰å–å­—ä½“ä¿¡æ¯ï¼Œç»ˆäºçœ‹åˆ°äº†è¿™ä¸ªæ“ä½œ</p><p>2ã€é€šè¿‡æ‹‰å–çš„å­—ä½“ä¿¡æ¯æ„å»ºä¸€ä¸ª Typeface å¯¹è±¡</p><p>3ã€é€šè¿‡æ‹‰å–çš„å­—ä½“ä¿¡æ¯æ„å»ºä¸€ä¸ª ByteBuffer æµå¯¹è±¡</p><p>4ã€é€šè¿‡ typeface å’Œ buffer æ„å»ºä¸€ä¸ª MetadataRepo å¯¹è±¡å¹¶æœ€ç»ˆå›è°ƒ onLoaded æ–¹æ³•ï¼Œåˆå§‹åŒ–æˆåŠŸ</p><p>MetadataRepo è§£é‡Šï¼šå®é™…ä¸Š MetadataRepo å°±æ˜¯ EmojiCompat å¤„ç†å’Œç»˜åˆ¶è¡¨æƒ…çš„ä¸€ä¸ªæ•°æ®ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ç§æ–¹å¼å»æ„å»ºå®ƒï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4fb9455f949940dd8b2354fb3d1f7a53~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210526191217511"></p><p>ä»æˆªå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼š</p><p>1ã€æ–¹å¼ä¸€ï¼šä¼ å…¥ä¸€ä¸ª Typeface å¯¹è±¡å’Œä¸€ä¸ª InputStream æµå¯¹è±¡</p><p>2ã€æ–¹å¼äºŒï¼šä¼ å…¥ä¸€ä¸ª  Typeface å¯¹è±¡å’Œä¸€ä¸ª ByteBuffer æµå¯¹è±¡</p><p>3ã€æ–¹å¼ä¸‰ï¼šä¼ å…¥ä¸€ä¸ª AssetManager å¯¹è±¡å’Œä¸€ä¸ª assetPath è·¯å¾„</p><p>å®é™…ä¸Šï¼Œå¯ä¸‹è½½å­—ä½“é…ç½®ç”¨çš„å°±æ˜¯æ–¹å¼äºŒï¼Œæœ¬åœ°æ†ç»‘å­—ä½“é…ç½®ç”¨çš„æ˜¯æ–¹å¼ä¸‰ï¼Œ<strong>æˆ‘ä»¬è¿˜æœ‰æ–¹å¼ä¸€å¯ä»¥ç”¨ï¼Œè¿™ä¹Ÿæ˜¯åç»­è§£å†³é—®é¢˜çš„ä¸€ä¸ªçªç ´å£</strong></p><p>4ã€å¦‚æœæµç¨‹æœ‰ä»»ä½•å¼‚å¸¸ï¼Œèµ°åˆ° catch é‡Œé¢ï¼Œæœ€ç»ˆå›è°ƒ onFailed æ–¹æ³•ï¼Œåˆå§‹åŒ–å¤±è´¥</p><p>é€šè¿‡ä¸Šé¢æµç¨‹çš„ä¸€ä¸ªåˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šEmojiCompat ä¼šé€šè¿‡ä¼ å…¥çš„ config ä¸­çš„ MetadataRepoLoader çš„ load æ–¹æ³•åˆ‡æ¢åˆ°å­çº¿ç¨‹å»æ‹‰å–å­—ä½“æ–‡ä»¶ï¼Œå¦‚æœæ‹‰å–æˆåŠŸå¹¶æˆåŠŸæ„å»º MetadataRepo å¯¹è±¡ï¼Œåˆ™èƒ½åˆå§‹åŒ–æˆåŠŸï¼Œå¦‚æœæ‹‰å–å¤±è´¥ï¼Œåˆ™ä¼šåˆå§‹åŒ–å¤±è´¥</p><p>æºç åˆ†æåˆ°äº†è¿™é‡Œï¼Œä½ å¿ƒé‡Œæ˜¯å¦æœ‰äº†æ–°çš„æ€è·¯äº†å‘¢ï¼Ÿè¿˜è®°å¾—ä¸Šé¢æˆ‘é¢„ç•™çš„ä¸€ä¸ªé—®é¢˜å—ï¼Ÿ</p><p>æˆ‘ä»¬æ˜¯å¦å¯ä»¥æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å­—ä½“é…ç½®å»å®Œæˆ EmojiCompat çš„åˆå§‹åŒ–å‘¢ï¼Ÿ</p><p>å½“æ—¶åªæ˜¯çŒœæƒ³ï¼Œæˆ‘ä»¬ç°åœ¨ç†æ€§åˆ†æä¸€æ³¢ï¼š</p><p>1ã€ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨çš„å¯ä¸‹è½½çš„å­—ä½“é…ç½®æ˜¯é€šè¿‡ GMS æœåŠ¡æ‹‰å–çš„å­—ä½“æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ä¸Šè¿°æ–¹å¼äºŒå»æ„å»º MetadataRepoï¼Œæœ€ç»ˆåˆå§‹åŒ–æˆåŠŸ</p><p>2ã€æœ¬åœ°æ†ç»‘å­—ä½“é…ç½®æ˜¯é€šè¿‡ä»æœ¬åœ° assets æ–‡ä»¶å¤¹ä¸‹æ‹‰å–å­—ä½“æ–‡ä»¶ï¼Œç„¶åé€šè¿‡æ–¹å¼ä¸‰å»æ„å»º MetadataRepoï¼Œæœ€ç»ˆåˆå§‹åŒ–æˆåŠŸ</p><p>é‚£ä¹ˆä¾è‘«èŠ¦ç”»ç“¢ï¼šæˆ‘æ˜¯å¦å¯ä»¥æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å­—ä½“é…ç½®ï¼ŒæŠŠå­—ä½“å­˜åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šå»æ‹‰å–å­—ä½“ï¼Œæ‹‰å–æˆåŠŸåï¼Œé€šè¿‡æ–¹å¼ä¸€å»æ„å»º MetadataRepoï¼Œé‚£ä¹ˆè¿™æ ·æ˜¯å¦ä¹Ÿèƒ½åˆå§‹åŒ–æˆåŠŸå‘¢ï¼Ÿ</p><p>å—¯ï¼Œæ„Ÿè§‰æ–¹æ¡ˆå¯è¡Œï¼Œå¹²å°±å®Œäº†</p><h2 id="å…«ã€æ–°æ–¹æ¡ˆå®è·µ"><a href="#å…«ã€æ–°æ–¹æ¡ˆå®è·µ" class="headerlink" title="å…«ã€æ–°æ–¹æ¡ˆå®è·µ"></a>å…«ã€æ–°æ–¹æ¡ˆå®è·µ</h2><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬æœ‰äº†æ–°çš„æ€è·¯ï¼Œä¸‹é¢æ˜¯æˆ‘å®è·µçš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå› ä»£ç å¤ªå¤šï¼Œè´´å‡ºéƒ¨åˆ†å…³é”®ä»£ç ï¼Œä¸»è¦å…³æ³¨è§£å†³é—®é¢˜çš„æ€è·¯ï¼š</p><p>1ã€å°† Google å®˜æ–¹æä¾›çš„ NotoColorEmojiCompat.ttf å­—ä½“æ–‡ä»¶ï¼Œä¸Šä¼ åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨</p><p>2ã€é’ˆå¯¹æ²¡æœ‰ GMS çš„æ‰‹æœºï¼ŒEmojiCompat ä¼šåˆå§‹åŒ–å¤±è´¥ï¼Œé‚£ä¹ˆåœ¨ EmojiCompat é¦–æ¬¡åˆå§‹åŒ–å¤±è´¥åï¼Œåœ¨å®ƒå¤±è´¥çš„å›è°ƒé‡Œé¢å¯åŠ¨ä¸€ä¸ªä¸‹è½½ä»»åŠ¡å»ä¸‹è½½ NotoColorEmojiCompat.ttf è¿™ä¸ªå­—ä½“</p><p>3ã€è‹¥ä¸‹è½½æˆåŠŸï¼Œåˆ™æ„é€ ä¸€ä¸ªè‡ªå®šä¹‰çš„å­—ä½“é…ç½®é‡æ–°åˆå§‹åŒ– EmojiCompat</p><p>ä¸‹é¢æ˜¯ä¸€äº›å…³é”®çš„ä»£ç ï¼Œä»…ä¾›å‚è€ƒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åˆå§‹åŒ– EmojiCompat</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initEmotionCompat</span><span class="hljs-params">(Context mContext)</span> &#123;<br>    <span class="hljs-type">FontRequest</span> <span class="hljs-variable">fontRequest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontRequest</span>(<br>            <span class="hljs-string">&quot;com.google.android.gms.fonts&quot;</span>,<br>            <span class="hljs-string">&quot;com.google.android.gms&quot;</span>,<br>            <span class="hljs-string">&quot;Noto Color Emoji Compat&quot;</span>,<br>            R.array.chat_com_google_android_gms_fonts_certs);<br>    EmojiCompat.<span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontRequestEmojiCompatConfig</span>(mContext, fontRequest);<br>    config.setReplaceAll(<span class="hljs-literal">true</span>);<br>    config.registerInitCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>.InitCallback() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInitialized</span><span class="hljs-params">()</span> &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;loadEmojiFontFromNetwork()-&gt;onInitialized()&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Throwable throwable)</span> &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;loadEmojiFontFromNetwork()-&gt;onFailed():&quot;</span> + throwable.getMessage());<br>            <span class="hljs-comment">//è‹¥åˆå§‹åŒ–å¤±è´¥åˆ™æ‰§è¡Œä¸‹è½½å­—ä½“æ“ä½œ</span><br>            downloadFont(mContext,<span class="hljs-string">&quot;ä½ çš„å­—ä½“ä¸‹è½½ url &quot;</span>);<br>        &#125;<br>    &#125;);<br>    EmojiCompat.init(config);<br>&#125;<br><br><span class="hljs-comment">//ä¸‹è½½å­—ä½“</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">downloadFont</span><span class="hljs-params">(Context mContext,String fontUrl)</span>&#123;<br>    EmojiFontDownloadUtils.downloadFont(fontUrl,<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiFontPreloadUtils</span>.OnEmojiFontDownloadListener() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(File file)</span> &#123;<br>            <span class="hljs-comment">//ä¸‹è½½æˆåŠŸï¼Œé‡æ–°åˆå§‹åŒ– EmojiCompat</span><br>            resetConfig(mContext);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(Throwable throwable)</span> &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;onFailed: &quot;</span> + throwable.getMessage());<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-comment">//é‡æ–°åˆå§‹åŒ–</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">resetConfig</span><span class="hljs-params">(Context mContext)</span> &#123;<br>    <span class="hljs-comment">//æ„å»ºè‡ªå®šä¹‰å­—ä½“é…ç½®</span><br>    <span class="hljs-keyword">final</span> EmojiCompat.<span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalEmojiCompatConfig</span>(mContext);<br>    config.registerInitCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmojiCompat</span>.InitCallback() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInitialized</span><span class="hljs-params">()</span> &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;reInit success...&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailed</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Throwable throwable)</span> &#123;<br>            Log.e(TAG, <span class="hljs-string">&quot;reInit failed:&quot;</span> + throwable.getMessage());<br>        &#125;<br>    &#125;);<br>    <span class="hljs-comment">//é‡ç½®åˆå§‹åŒ–é…ç½®è¿›è¡Œé‡æ–°åˆå§‹åŒ–</span><br>    EmojiCompat.reset(config);<br>&#125;<br></code></pre></td></tr></table></figure><p> å¯èƒ½å¤§å®¶æƒ³çœ‹çœ‹æˆ‘æ„å»ºçš„è‡ªå®šä¹‰å­—ä½“é…ç½®é•¿å•¥æ ·ï¼Ÿå®‰æ’ğŸ˜„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalEmojiCompatConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">EmojiCompat</span>.Config &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LocalEmojiCompatConfig</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Context context)</span> &#123;<br>        <span class="hljs-built_in">super</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalEmojiCompatConfig</span>.LocalMetadataLoader(context));<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalMetadataLoader</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmojiCompat</span>.MetadataRepoLoader &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Context mContext;<br><br>        LocalMetadataLoader(<span class="hljs-meta">@NonNull</span> Context context) &#123;<br>            mContext = context.getApplicationContext();<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-meta">@RequiresApi(19)</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">load</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> EmojiCompat.MetadataRepoLoaderCallback loaderCallback)</span> &#123;<br>            Preconditions.checkNotNull(loaderCallback, <span class="hljs-string">&quot;loaderCallback cannot be null&quot;</span>);<br>            <span class="hljs-comment">//å¼€å¯å­çº¿ç¨‹æ‰§è¡Œä»»åŠ¡</span><br>            <span class="hljs-keyword">final</span> LocalEmojiCompatConfig.<span class="hljs-type">InitRunnable</span> <span class="hljs-variable">runnable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalEmojiCompatConfig</span>.InitRunnable(mContext, loaderCallback);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(runnable);<br>            thread.setDaemon(<span class="hljs-literal">false</span>);<br>            thread.start();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@RequiresApi(19)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmojiCompat.MetadataRepoLoaderCallback mLoaderCallback;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Context mContext;<br><br>        InitRunnable(Context context, EmojiCompat.MetadataRepoLoaderCallback loaderCallback) &#123;<br>            mContext = context;<br>            mLoaderCallback = loaderCallback;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>              <span class="hljs-comment">//æ„å»º MetadataRepo </span><br>                <span class="hljs-keyword">final</span> <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> Typeface.createFromFile(EmojiFontPreloadUtils.getFile());<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(EmojiFontPreloadUtils.getFile());<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">MetadataRepo</span> <span class="hljs-variable">metadataRepo</span> <span class="hljs-operator">=</span> MetadataRepo.create(typeface, inputStream);<br>                mLoaderCallback.onLoaded(metadataRepo);<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>                mLoaderCallback.onFailed(t);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶å®è¿™ä¸ªè‡ªå®šä¹‰çš„å­—ä½“é…ç½®å¾ˆç®€å•ï¼Œå°±æ˜¯ä»¿ç…§ä¹‹å‰æˆ‘ä»¬åˆ†æçš„é‚£ä¸ªæºç æµç¨‹ï¼Œç»“åˆå¯ä¸‹è½½å­—ä½“é…ç½®çš„æ€è·¯å†™å‡ºæ¥çš„ï¼Œä¸Šè¿°è‡ªå®šä¹‰çš„å­—ä½“é…ç½®ä¸»è¦åšçš„äº‹æƒ…ï¼š</p><p>1ã€åœ¨ load æ–¹æ³•é‡Œé¢å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹æ‰§è¡Œä»»åŠ¡</p><p>2ã€åœ¨å¯æ‰§è¡Œçš„ä»»åŠ¡é‡Œé¢é€šè¿‡æ–¹å¼ä¸€æ„å»º MetadataRepo æœ€ç»ˆå®Œæˆåˆå§‹åŒ–æ“ä½œ</p><p>æœ€ç»ˆç»è¿‡å®è·µï¼Œå‘ç°è¿™ç§æ–¹æ¡ˆèƒ½å¤Ÿåˆå§‹åŒ–æˆåŠŸï¼Œé—®é¢˜è§£å†³</p><h2 id="ä¹ã€æ€»ç»“"><a href="#ä¹ã€æ€»ç»“" class="headerlink" title="ä¹ã€æ€»ç»“"></a>ä¹ã€æ€»ç»“</h2><p>æ¢³ç†ä¸€ä¸‹è¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ‰€è®²çš„ä¸€äº›ä¸œè¥¿ï¼š</p><p>é¦–å…ˆä»‹ç»äº† Emoji è¡¨æƒ…ï¼Œè®²äº†ä¸‹æˆ‘æ¥åˆ°çš„éœ€æ±‚ï¼Œç„¶åå¯¹ Emoji è¡¨æƒ…æ–¹æ¡ˆè¿›è¡Œäº†å®è·µï¼Œå‘ç°æœ‰æ˜¾ç¤ºé—®é¢˜ï¼Œäºæ˜¯å¼•å…¥  EmojiCompat æ”¯æŒåº“è§£å†³äº†æ˜¾ç¤ºé—®é¢˜ï¼Œä½†æ˜¯å‘ç°åœ¨æ²¡æœ‰ GMS æœåŠ¡çš„æ‰‹æœºä¸Šæ˜¾ç¤ºä»ç„¶ä¼šå‡ºç°ä¸€äº›æ˜¾ç¤ºé—®é¢˜ï¼Œäºæ˜¯æˆ‘ä»¬é€šè¿‡å°†å­—ä½“æ–‡ä»¶ä¸Šä¼ åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¹¶æ‹‰å–æ„å»ºè‡ªå®šä¹‰çš„å­—ä½“æ–‡ä»¶é…ç½®åˆå§‹åŒ– EmojiCompat è§£å†³äº†è¯¥é—®é¢˜</p><p>å¥½äº†ï¼Œå¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ ä¸€å®šæ”¶è·æ»¡æ»¡ï¼Œå¦‚æœæœ‰å•¥é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºä¸€èµ·äº¤æµğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šHandleræ‰©å±•ç¯‡</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AHandler%E6%89%A9%E5%B1%95%E7%AF%87/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AHandler%E6%89%A9%E5%B1%95%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>Handlerç³»åˆ—æ–‡ç« å…±ä¸¤ç¯‡ï¼š</p><p>ç¬¬ä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/6924084444609544199#heading-5">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—: Handleræ¶ˆæ¯æœºåˆ¶å®Œå…¨è§£æ</a></p><p>ç¬¬äºŒç¯‡ï¼š <a href="https://juejin.cn/post/6932608660354891790/">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—: Handleræ‰©å±•ç¯‡</a></p></blockquote><p>åœ¨<a href="https://juejin.cn/post/6924084444609544199">ä¸Šä¸€ç¯‡</a>ä¸­ï¼Œæˆ‘ä»¬å¯¹Handlerçš„ä¸»ä½“éƒ¨åˆ†è¿›è¡Œäº†è®²è§£ï¼Œä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸€ä¸‹Handlerç›¸å…³çš„ä¸€äº›æ‰©å±•çŸ¥è¯†ï¼Œè®²å®Œè¿™äº›æ‰©å±•çŸ¥è¯†åï¼Œåœ¨æ¥å›ç­”ä¹‹å‰åˆ—å‡ºæ¥çš„ä¸€ç³»åˆ—é—®é¢˜</p><h2 id="åŒæ­¥å±éšœ"><a href="#åŒæ­¥å±éšœ" class="headerlink" title="åŒæ­¥å±éšœ"></a>åŒæ­¥å±éšœ</h2><p>é€šè¿‡ä¸Šä¸€ç¯‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“: Handlerå‘é€çš„Messageä¼šæ”¾å…¥åˆ°MessageQueueä¸­ï¼ŒMessageQueueä¸­ç»´æŠ¤äº†ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä¼˜å…ˆçº§é˜Ÿåˆ—çš„æ„æ€å°±æ˜¯å°†å­˜å‚¨æ•°æ®çš„å•é“¾è¡¨æŒ‰ç…§æ—¶é—´å‡åºè¿›è¡Œæ’åºå½¢æˆçš„ï¼ŒLooperåˆ™æŒ‰ç…§é¡ºåºï¼Œæ¯æ¬¡ä»è¿™ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªMessageè¿›è¡Œåˆ†å‘ï¼Œä¸€ä¸ªå¤„ç†å®Œå°±å¤„ç†ä¸‹ä¸€ä¸ªã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šæˆ‘èƒ½ä¸èƒ½è®©æˆ‘çš„ä¸€ä¸ªMessageè¢«ä¼˜å…ˆå¤„ç†ï¼Ÿ</p><p>å¯ä»¥ï¼Œä½¿ç”¨åŒæ­¥å±éšœ</p><p>è¿™é‡Œï¼Œæˆ‘å¿ƒé‡Œåˆä¼šæœ‰ä¸ªç–‘é—®ï¼Œä»€ä¹ˆæ˜¯åŒæ­¥å±éšœï¼Ÿæ€ä¹ˆä½¿ç”¨åŒæ­¥å±éšœï¼ŸåŒæ­¥å±éšœæœ‰å•¥ä½œç”¨ï¼Ÿå¸¦ç€è¿™äº›ç–‘é—®ğŸ¤”ï¸ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹æºç </p><p>å…ˆçœ‹ä¸‹MessageQueueçš„<code>next</code>æ–¹æ³•ï¼Œåœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬çœç•¥äº†ä¸€éƒ¨åˆ†ä»£ç ï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯è¿™æ ·å­çš„ï¼Œä»…è´´å‡ºå…³é”®ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">Message <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>            <span class="hljs-keyword">if</span> (msg != <span class="hljs-literal">null</span> &amp;&amp; msg.target == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">// Stalled by a barrier.  Find the next asynchronous message in the queue.</span><br>                <span class="hljs-keyword">do</span> &#123;<br>                     prevMsg = msg;<br>                     msg = msg.next;<br>                &#125; <span class="hljs-keyword">while</span> (msg != <span class="hljs-literal">null</span> &amp;&amp; !msg.isAsynchronous());<br>            &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€åˆ¤æ–­å½“å‰msgä¸ä¸ºç©ºå¹¶ä¸”msg.targetä¸ºç©ºï¼Œåˆ™è¿›å…¥æ¡ä»¶ä½“é‡Œé¢</p><p>2ã€æ¡ä»¶ä½“é‡Œé¢æœ‰ä¸€è¡Œæºç æ³¨é‡Šï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯: <strong>è¢«ä¸€ä¸ªå±éšœç»™é˜»ç¢ã€‚åœ¨é˜Ÿåˆ—ä¸­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¼‚æ­¥æ¶ˆæ¯</strong></p><p>3ã€æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œéå†æ‰¾å‡ºä¸€æ¡å¼‚æ­¥æ¶ˆæ¯ï¼Œå¾ªç¯ä½“é‡Œé¢å°±æ˜¯é“¾è¡¨ç›¸å…³çš„æ“ä½œ</p><p>è¿™é‡Œå¤§å®¶æ˜¯ä¸æ˜¯ä¼šæœ‰ä¸ªç–‘é—®ï¼Ÿmsg.targetæ€ä¹ˆå¯èƒ½ä¼šä¸ºç©ºå‘¢ï¼Ÿä¹‹å‰å‘é€æ¶ˆæ¯çš„ä¸€ç³»åˆ—æ–¹æ³•ä¸æ˜¯éƒ½ä¼šç»™msg.targetå¯¹è±¡èµ‹å€¼å—ï¼Ÿ</p><p>æ²¡é”™ï¼Œæˆ‘ä»¬åœ¨å›é¡¾ä¸€ä¸‹Handlerçš„<code>enqueueMessage</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">enqueueMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> MessageQueue queue, <span class="hljs-meta">@NonNull</span> Message msg,<span class="hljs-type">long</span> uptimeMillis)</span> &#123;<br>     <span class="hljs-comment">//å°†å½“å‰Handlerèµ‹å€¼ç»™msg.target</span><br>     msg.target = <span class="hljs-built_in">this</span>;<br>     msg.workSourceUid = ThreadLocalWorkSource.getUid();<br>     <span class="hljs-keyword">if</span> (mAsynchronous) &#123;<br>         msg.setAsynchronous(<span class="hljs-literal">true</span>);<br>     &#125;<br>     <span class="hljs-comment">//è°ƒç”¨MessageQueueçš„enqueueMessageæ–¹æ³•</span><br>     <span class="hljs-keyword">return</span> queue.enqueueMessage(msg, uptimeMillis);<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“Handlerçš„<code>post</code>å’Œ<code>send</code>ç³»åˆ—æ–¹æ³•å‘é€çš„æ¶ˆæ¯ï¼Œæœ€ç»ˆéƒ½ä¼šèµ°åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œmsg.targetéƒ½ä¼šè¢«èµ‹å€¼ï¼Œå› æ­¤ä¸å¯èƒ½ä¸ºç©ºã€‚é‚£msg.targetå•¥æ—¶å€™ä¼šä¸ºç©ºå‘¢ï¼Ÿæˆ‘ä»¬æ¨æ–­è‚¯å®šæ˜¯å…¶ä»–å‘é€æ¶ˆæ¯çš„æ–¹æ³•ä½¿å¾—msg.targetä¸ºç©ºï¼Œé‚£æˆ‘ä»¬å°±æ‰¾ä¸€ä¸‹ï¼Œä¼šå‘ç°MessageQueueçš„<code>postSyncBarrier</code>çš„æ–¹æ³•ä¸­æ²¡æœ‰ç»™msg.targetå¯¹è±¡èµ‹å€¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">postSyncBarrier</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> postSyncBarrier(SystemClock.uptimeMillis());<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">postSyncBarrier</span><span class="hljs-params">(<span class="hljs-type">long</span> when)</span> &#123;<br>     <span class="hljs-comment">// Enqueue a new sync barrier token.</span><br>     <span class="hljs-comment">// We don&#x27;t need to wake the queue because the purpose of a barrier is to stall it.</span><br>     <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> mNextBarrierToken++;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> Message.obtain();<br>         msg.markInUse();<br>         msg.when = when;<br>         msg.arg1 = token;<br><br>         <span class="hljs-type">Message</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>         <span class="hljs-type">Message</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> mMessages;<br>         <span class="hljs-keyword">if</span> (when != <span class="hljs-number">0</span>) &#123;<br>             <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span> &amp;&amp; p.when &lt;= when) &#123;<br>                 prev = p;<br>                 p = p.next;<br>             &#125;<br>         &#125;<br>         <span class="hljs-keyword">if</span> (prev != <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// invariant: p == prev.next</span><br>             msg.next = p;<br>             prev.next = msg;<br>         &#125; <span class="hljs-keyword">else</span> &#123;<br>             msg.next = p;<br>             mMessages = msg;<br>         &#125;<br>         <span class="hljs-keyword">return</span> token;<br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å°±æ˜¯å¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­åˆé€‚çš„ä½ç½®æ’å…¥targetå±æ€§ä¸ºnullçš„Message</p><p>å› æ­¤æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥çŸ¥é“ï¼ŒMessageçš„targetå±æ€§ä¸ºç©ºå’Œéç©ºæ˜¯å¾ˆä¸ä¸€æ ·çš„ï¼Œè¿™é‡Œå°±ä¸å–å…³å­äº†ï¼Œç›´æ¥ç»™ç»“è®º: <strong>targetå±æ€§ä¸ºç©ºçš„Messageå°±æ˜¯åŒæ­¥å±éšœï¼Œä»–æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¶ˆæ¯ï¼Œå¹¶ä¸ä¼šè¢«æ¶ˆè´¹ï¼Œä»…ä»…æ˜¯ä½œä¸ºä¸€ä¸ªæ ‡è¯†å¤„äº MessageQueue ä¸­ï¼Œå½“MessageQueueçš„<code>next</code>æ–¹æ³•é‡åˆ°åŒæ­¥å±éšœçš„æ—¶å€™ï¼Œå°±ä¼šå¾ªç¯éå†æ•´ä¸ªé“¾è¡¨æ‰¾åˆ°æ ‡è®°ä¸ºå¼‚æ­¥æ¶ˆæ¯çš„Messageï¼Œå…¶ä»–çš„æ¶ˆæ¯ä¼šç›´æ¥å¿½è§†ï¼Œé‚£ä¹ˆè¿™æ ·å¼‚æ­¥æ¶ˆæ¯å°±ä¼šæå‰è¢«æ‰§è¡Œäº†</strong></p><p>ç°åœ¨æˆ‘ä»¬ç°åœ¨å°±å¯ä»¥å›ç­”ä¸Šé¢çš„é—®é¢˜äº†ï¼š<strong>targetå±æ€§ä¸ºç©ºçš„Messageå°±æ˜¯åŒæ­¥å±éšœï¼ŒåŒæ­¥å±éšœå¯ä»¥ä½¿å¾—å¼‚æ­¥æ¶ˆæ¯ä¼˜å…ˆè¢«å¤„ç†ï¼Œé€šè¿‡MessageQueueçš„<code>postSyncBarrier</code>å¯ä»¥æ·»åŠ ä¸€ä¸ªåŒæ­¥å±éšœ</strong></p><p><strong>æ³¨æ„</strong>: <strong>åœ¨å¼‚æ­¥æ¶ˆæ¯å¤„ç†å®Œä¹‹åï¼ŒåŒæ­¥å±éšœå¹¶ä¸ä¼šè¢«ç§»é™¤ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç§»é™¤ï¼Œä»ä¸Šé¢çš„æºç æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœä¸ç§»é™¤åŒæ­¥å±éšœï¼Œé‚£ä¹ˆä»–ä¼šä¸€ç›´åœ¨é‚£é‡Œï¼Œè¿™æ ·åŒæ­¥æ¶ˆæ¯å°±æ°¸è¿œæ— æ³•è¢«æ‰§è¡Œäº†ã€‚</strong></p><p>å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨å®ŒåŒæ­¥å±éšœåï¼Œéœ€è¦æ‰‹åŠ¨ç§»é™¤ï¼Œä»£ç å¦‚ä¸‹: </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeSyncBarrier</span><span class="hljs-params">(<span class="hljs-type">int</span> token)</span> &#123;<br>     <span class="hljs-comment">// Remove a sync barrier token from the queue.</span><br>     <span class="hljs-comment">// If the queue is no longer stalled by a barrier then wake it.</span><br>     <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>         <span class="hljs-type">Message</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>         <span class="hljs-type">Message</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> mMessages;<br>         <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span> &amp;&amp; (p.target != <span class="hljs-literal">null</span> || p.arg1 != token)) &#123;<br>             prev = p;<br>             p = p.next;<br>         &#125;<br>         <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span>) &#123;<br>             <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;The specified message queue synchronization &quot;</span><br>                     + <span class="hljs-string">&quot; barrier token has not been posted or has already been removed.&quot;</span>);<br>         &#125;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> needWake;<br>         <span class="hljs-keyword">if</span> (prev != <span class="hljs-literal">null</span>) &#123;<br>             prev.next = p.next;<br>             needWake = <span class="hljs-literal">false</span>;<br>         &#125; <span class="hljs-keyword">else</span> &#123;<br>             mMessages = p.next;<br>             needWake = mMessages == <span class="hljs-literal">null</span> || mMessages.target != <span class="hljs-literal">null</span>;<br>         &#125;<br>         p.recycleUnchecked();<br><br>         <span class="hljs-comment">// If the loop is quitting then it is already awake.</span><br>         <span class="hljs-comment">// We can assume mPtr != 0 when mQuitting is false.</span><br>         <span class="hljs-keyword">if</span> (needWake &amp;&amp; !mQuitting) &#123;<br>             nativeWake(mPtr);<br>         &#125;<br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæˆ‘å¿ƒé‡Œåˆæœ‰ä¸€ä¸ªç–‘é—®äº†ï¼Ÿæ€ä¹ˆæŠŠä¸€ä¸ªæ¶ˆæ¯å˜æˆå¼‚æ­¥æ¶ˆæ¯å‘¢ï¼Ÿè¿˜æ˜¯å›åˆ°Handlerçš„<code>enqueueMessage</code>æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">enqueueMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> MessageQueue queue, <span class="hljs-meta">@NonNull</span> Message msg,<span class="hljs-type">long</span> uptimeMillis)</span> &#123;<br>     msg.target = <span class="hljs-built_in">this</span>;<br>     msg.workSourceUid = ThreadLocalWorkSource.getUid();<br>     <span class="hljs-comment">//å¦‚æœmAsynchronousï¼Œåˆ™å°†è¯¥æ¶ˆæ¯è®¾ç½®ä¸ºå¼‚æ­¥æ¶ˆæ¯</span><br>     <span class="hljs-keyword">if</span> (mAsynchronous) &#123;<br>         msg.setAsynchronous(<span class="hljs-literal">true</span>);<br>     &#125;<br>     <span class="hljs-keyword">return</span> queue.enqueueMessage(msg, uptimeMillis);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç æˆ‘æ˜¯å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡msg.setAsynchronousæ–¹æ³•è®¾ç½®ä¸ºtrueï¼Œå¯ä»¥æŠŠä¸€ä¸ªæ¶ˆæ¯å˜æˆå¼‚æ­¥æ¶ˆæ¯ï¼Œä½†æ˜¯å‰æå¾—æ»¡è¶³mAsynchronouså±æ€§ä¸ºtrueï¼ŒmAsynchronousæ˜¯Handlerä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä»–ä¼šåœ¨è¿™ä¸¤ä¸ªæ„é€ æ–¹æ³•ä¸­è¢«èµ‹å€¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@UnsupportedAppUsage</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Looper looper, <span class="hljs-meta">@Nullable</span> Callback callback, <span class="hljs-type">boolean</span> async)</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    mAsynchronous = async;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Callback callback, <span class="hljs-type">boolean</span> async)</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    mAsynchronous = async;<br>&#125;<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒæŠŠä¸€ä¸ªæ¶ˆæ¯è®¾ç½®ä¸ºå¼‚æ­¥æ¶ˆæ¯ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ã€åœ¨Handlerçš„æ„é€ æ–¹æ³•ä¸­ï¼Œä¼ å…¥asyncä¸ºtrueï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å‘é€çš„Messageå°±éƒ½æ˜¯å¼‚æ­¥çš„çš„æ¶ˆæ¯</p><p>2ã€ç»™Messageé€šè¿‡<code>setAsynchronous</code> æ–¹æ³•æ ‡å¿—ä¸ºå¼‚æ­¥</p><p>ä½†æ˜¯ï¼Œä¸Šé¢ä¸¤ä¸ªæ„é€ æ–¹æ³•å¯¹å¤–æ˜¯ä¸å¯è§çš„ï¼Œæˆ‘ä»¬è°ƒç”¨ä¸åˆ°ï¼Œè€Œä¸”è®¾ç½®åŒæ­¥å±éšœçš„æ–¹æ³•å¯¹å¤–ä¹Ÿæ˜¯ä¸å¯è§çš„ï¼Œè¯´æ˜è°·æ­Œä¸æƒ³è¦æˆ‘ä»¬å»ä½¿ç”¨ä»–ã€‚æ‰€ä»¥è¿™é‡ŒåŒæ­¥å±éšœä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªäº†è§£ï¼Œä¸€èˆ¬åªæœ‰ç³»ç»Ÿä¼šå»ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ï¼šåœ¨è¿›è¡ŒUIç»˜åˆ¶çš„æ—¶å€™ï¼Œä»¥ä¸‹æ˜¯ViewRootImplä¸­æ‰§è¡ŒUIç»˜åˆ¶çš„æ–¹æ³•ä½¿ç”¨åˆ°äº†åŒæ­¥å±éšœ:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@UnsupportedAppUsage</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">scheduleTraversals</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (!mTraversalScheduled) &#123;<br>        mTraversalScheduled = <span class="hljs-literal">true</span>;<br>        mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();<br>        mChoreographer.postCallback(<br>                Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, <span class="hljs-literal">null</span>);<br>        <span class="hljs-keyword">if</span> (!mUnbufferedInputDispatch) &#123;<br>            scheduleConsumeBatchedInput();<br>        &#125;<br>        notifyRendererOfFramePending();<br>        pokeDrawLockIfNeeded();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">unscheduleTraversals</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (mTraversalScheduled) &#123;<br>        mTraversalScheduled = <span class="hljs-literal">false</span>;<br>        mHandler.getLooper().getQueue().removeSyncBarrier(mTraversalBarrier);<br>        mChoreographer.removeCallbacks(<br>                Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, <span class="hljs-literal">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç åœ¨æŠŠç»˜åˆ¶æ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—ä¹‹å‰ï¼Œå…ˆæ”¾å…¥äº†ä¸€ä¸ªåŒæ­¥å±éšœï¼Œç„¶ååœ¨å‘é€å¼‚æ­¥ç»˜åˆ¶æ¶ˆæ¯ï¼Œä»è€Œä½¿å¾—ç•Œé¢ç»˜åˆ¶çš„æ¶ˆæ¯ä¼šæ¯”å…¶ä»–æ¶ˆæ¯ä¼˜å…ˆæ‰§è¡Œï¼Œé¿å…äº†å› ä¸º MessageQueue ä¸­æ¶ˆæ¯å¤ªå¤šå¯¼è‡´ç»˜åˆ¶æ¶ˆæ¯è¢«é˜»å¡å¯¼è‡´ç”»é¢å¡é¡¿ï¼Œå½“ç»˜åˆ¶å®Œæˆåï¼Œå°±ä¼šå°†åŒæ­¥å±éšœç§»é™¤ã€‚</p><h2 id="IdleHandler"><a href="#IdleHandler" class="headerlink" title="IdleHandler"></a>IdleHandler</h2><p>è§åçŸ¥æ„ï¼Œidleæ˜¯ç©ºé—²çš„æ„æ€ï¼Œé‚£ä¹ˆIdleHandlerå°±æ˜¯ç©ºé—²çš„Handlerï¼Œæœ‰ç‚¹è¿™ä¸ªæ„æ€ï¼Œå®é™…ä¸Šå®ƒæ˜¯MessageQueueä¸­æœ‰ä¸€ä¸ªé™æ€æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IdleHandler</span> &#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">queueIdle</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ªå•æ–¹æ³•çš„æ¥å£ï¼Œä¹Ÿå¯ç§°ä¸ºå‡½æ•°å‹æ¥å£ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š<strong>åœ¨UIçº¿ç¨‹å¤„ç†å®Œæ‰€æœ‰Viewäº‹åŠ¡åï¼Œå›è°ƒä¸€äº›é¢å¤–çš„æ“ä½œï¼Œä¸”ä¸ä¼šå µå¡ä¸»è¿›ç¨‹ï¼›</strong>æˆ‘ä»¬æ¥å®é™…æ“ä½œä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>().getLooper().getQueue().addIdleHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageQueue</span>.IdleHandler() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">queueIdle</span><span class="hljs-params">()</span> &#123;<br>                Log.d(<span class="hljs-string">&quot;print&quot;</span>, <span class="hljs-string">&quot;queueIdle: ç©ºé—²æ—¶åšä¸€äº›è½»é‡çº§åˆ«&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¸Šé¢ä»£ç ä¼šæ‰“å°å¦‚ä¸‹ç»“æœ</span><br>queueIdle: ç©ºé—²æ—¶åšä¸€äº›è½»é‡çº§åˆ«<br></code></pre></td></tr></table></figure><p>æ¥ç€è¿›è¡Œæºç åˆ†æï¼Œæˆ‘ä»¬åœ¨çœ‹ä¸‹<code>addIdleHandler</code>è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addIdleHandler</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IdleHandler handler)</span> &#123;<br>    <span class="hljs-keyword">if</span> (handler == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(<span class="hljs-string">&quot;Can&#x27;t add a null IdleHandler&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        mIdleHandlers.add(handler);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¢«æ·»åŠ è¿›æ¥çš„handleræ”¾åˆ°äº†mIdleHandlersï¼Œè·Ÿè¿‡å»çœ‹ä¸‹mIdleHandlersï¼Œä¼šå‘ç°MessageQueueä¸­å®šä¹‰äº†IdleHandlerçš„é›†åˆå’Œæ•°ç»„ï¼Œå¹¶ä¸”æœ‰ä¸€äº›æ“ä½œæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ArrayList&lt;IdleHandler&gt; mIdleHandlers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;IdleHandler&gt;();<br><span class="hljs-keyword">private</span> IdleHandler[] mPendingIdleHandlers;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addIdleHandler</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IdleHandler handler)</span> &#123;<br>    <span class="hljs-keyword">if</span> (handler == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(<span class="hljs-string">&quot;Can&#x27;t add a null IdleHandler&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        mIdleHandlers.add(handler);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeIdleHandler</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IdleHandler handler)</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        mIdleHandlers.remove(handler);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€ååœ¨çœ‹ä¸‹MessageQueueä¸­çš„<code>Next</code>æ–¹æ³•ï¼Œä»…è´´å‡ºå…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java">Message <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-type">int</span> <span class="hljs-variable">pendingIdleHandlerCount</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// -1 only during first iteration</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>             <span class="hljs-comment">//...</span><br>             <span class="hljs-comment">//å½“å‰æ— æ¶ˆæ¯ï¼Œæˆ–è¿˜éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ¶ˆæ¯æ‰èƒ½åˆ†å‘ï¼Œè·å¾—IdleHandlerçš„æ•°é‡</span><br>             <span class="hljs-keyword">if</span> (pendingIdleHandlerCount &lt; <span class="hljs-number">0</span> &amp;&amp; (mMessages == <span class="hljs-literal">null</span> || now &lt; mMessages.when)) &#123;<br>                 pendingIdleHandlerCount = mIdleHandlers.size();<br>             &#125;<br>          <br>           <span class="hljs-keyword">if</span> (pendingIdleHandlerCount &lt;= <span class="hljs-number">0</span>) &#123;<br>                 <span class="hljs-comment">// No idle handlers to run.  Loop and wait some more.</span><br>                <span class="hljs-comment">//å¦‚æœæ²¡æœ‰idle handleréœ€è¦æ‰§è¡Œï¼Œé˜»å¡çº¿ç¨‹è¿›å…¥ä¸‹æ¬¡å¾ªç¯</span><br>                 mBlocked = <span class="hljs-literal">true</span>;<br>                 <span class="hljs-keyword">continue</span>;<br>             &#125;<br>     <span class="hljs-comment">//åˆå§‹åŒ–mPendingIdleHandlers</span><br>             <span class="hljs-keyword">if</span> (mPendingIdleHandlers == <span class="hljs-literal">null</span>) &#123;<br>                 mPendingIdleHandlers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdleHandler</span>[Math.max(pendingIdleHandlerCount, <span class="hljs-number">4</span>)];<br>             &#125;<br>             <span class="hljs-comment">//æŠŠListè½¬åŒ–æˆæ•°ç»„ç±»å‹</span><br>             mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers);<br>         &#125;<br>      <br>        <span class="hljs-comment">//å¾ªç¯éå†æ‰€æœ‰çš„IdleHandler</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; pendingIdleHandlerCount; i++) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">IdleHandler</span> <span class="hljs-variable">idler</span> <span class="hljs-operator">=</span> mPendingIdleHandlers[i];<br>            mPendingIdleHandlers[i] = <span class="hljs-literal">null</span>; <span class="hljs-comment">// release the reference to the handler</span><br><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">keep</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">try</span> &#123;<br>              <span class="hljs-comment">//è·å¾—idler.queueIdleçš„è¿”å›å€¼</span><br>                keep = idler.queueIdle();<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>                Log.wtf(TAG, <span class="hljs-string">&quot;IdleHandler threw exception&quot;</span>, t);<br>            &#125;<br>            <span class="hljs-comment">//keepå³idler.queueIdleçš„è¿”å›å€¼ï¼Œå¦‚æœä¸ºfalseè¡¨æ˜åªè¦æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ç§»é™¤ï¼Œå¦åˆ™ä¸ç§»é™¤</span><br>            <span class="hljs-keyword">if</span> (!keep) &#123;<br>                <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>                    mIdleHandlers.remove(idler);<br>                &#125;<br>            &#125;<br>         &#125;<br>         <span class="hljs-comment">// Reset the idle handler count to 0 so we do not run them again.</span><br>       <span class="hljs-comment">//å°†pendingIdleHandlerCountç½®ä¸º0é¿å…ä¸‹æ¬¡å†æ¬¡æ‰§è¡Œ</span><br>         pendingIdleHandlerCount = <span class="hljs-number">0</span>;<br>      <br>       <span class="hljs-comment">// å½“åœ¨æ‰§è¡ŒIdleHandlerçš„æ—¶å€™ï¼Œå¯èƒ½æœ‰æ–°çš„æ¶ˆæ¯å·²ç»è¿›æ¥äº†</span><br>         <span class="hljs-comment">// æ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¸èƒ½é˜»å¡ï¼Œè¦å›å»å¾ªç¯ä¸€æ¬¡çœ‹ä¸€ä¸‹</span><br>         nextPollTimeoutMillis = <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç è§£æï¼š</p><p>1ã€å½“è°ƒç”¨nextæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå°†pendingIdleHandlerCountèµ‹å€¼ä¸º-1</p><p>2ã€åˆ¤æ–­pendingIdleHandlerCountæ˜¯å¦å°äº0å¹¶ä¸”MessageQueue æ˜¯å¦ä¸ºç©ºæˆ–è€…æœ‰å»¶è¿Ÿæ¶ˆæ¯éœ€è¦æ‰§è¡Œï¼Œå¦‚æœæ˜¯åˆ™æŠŠå­˜å‚¨IdleHandlerçš„listçš„é•¿åº¦èµ‹å€¼ç»™pendingIdleHandlerCount</p><p>3ã€åˆ¤æ–­å¦‚æœæ²¡æœ‰IdleHandleréœ€è¦æ‰§è¡Œï¼Œé˜»å¡çº¿ç¨‹è¿›å…¥ä¸‹æ¬¡å¾ªç¯ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åˆå§‹åŒ–mPendingIdleHandlersï¼ŒæŠŠlistä¸­çš„æ‰€æœ‰IdleHandleræ”¾åˆ°æ•°ç»„ä¸­ã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ä¸è®©åœ¨æ‰§è¡ŒIdleHandlerçš„æ—¶å€™Listè¢«æ’å…¥æ–°çš„IdleHandlerï¼Œé€ æˆé€»è¾‘æ··ä¹±</p><p>4ã€å¾ªç¯éå†æ‰€æœ‰çš„IdleHandlerå¹¶æ‰§è¡Œï¼ŒæŸ¥çœ‹idler.queueIdleæ–¹æ³•çš„è¿”å›å€¼ï¼Œä¸ºfalseè¡¨æ˜è¿™ä¸ªIdleHandleråªéœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ç§»é™¤ï¼Œä¸ºtrueï¼Œåˆ™ä¸ç§»é™¤</p><p>5ã€å°†pendingIdleHandlerCountç½®ä¸º0é¿å…ä¸‹æ¬¡å†æ¬¡æ‰§è¡Œï¼Œ å½“åœ¨æ‰§è¡ŒIdleHandlerçš„æ—¶å€™ï¼Œå¯èƒ½æœ‰æ–°çš„æ¶ˆæ¯å·²ç»è¿›æ¥äº†ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¸èƒ½é˜»å¡ï¼Œè¦å›å»å¾ªç¯ä¸€æ¬¡çœ‹ä¸€ä¸‹</p><p>åˆ°è¿™é‡ŒåŒæ­¥å±éšœå’ŒIdleHandleréƒ½è®²å®Œäº†ï¼Œå»ºè®®è¯»è€…é…åˆå®Œæ•´çš„æºç åœ¨å»ä»”ç»†é˜…è¯»ä¸€æ¬¡ã€‚</p><p><strong>å®é™…åº”ç”¨</strong>: å¯ä»¥åœ¨IdleHandleré‡Œé¢è·å–Viewçš„å®½é«˜</p><h2 id="ä¸»çº¿ç¨‹æ¶ˆæ¯å¾ªç¯"><a href="#ä¸»çº¿ç¨‹æ¶ˆæ¯å¾ªç¯" class="headerlink" title="ä¸»çº¿ç¨‹æ¶ˆæ¯å¾ªç¯"></a>ä¸»çº¿ç¨‹æ¶ˆæ¯å¾ªç¯</h2><p>åœ¨ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬è®²åˆ°ï¼ŒActivityThreadå°±æ˜¯ä¸»çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯UIçº¿ç¨‹ï¼Œåœ¨ä¸»çº¿ç¨‹çš„<code>mainæ–¹æ³•ä¸­</code>åˆ›å»ºäº†Looperï¼Œå¹¶å¼€å¯äº†æ¶ˆæ¯å¾ªç¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//åˆ›å»ºLooper</span><br>  Looper.prepareMainLooper();<br>  <br>  <span class="hljs-type">ActivityThread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActivityThread</span>();<br>  thread.attach(<span class="hljs-literal">false</span>);<br><br>  <span class="hljs-keyword">if</span> (sMainThreadHandler == <span class="hljs-literal">null</span>) &#123;<br>    sMainThreadHandler = thread.getHandler();<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//å¼€å¯å¾ªç¯è¯»å–æ¶ˆæ¯</span><br>  Looper.loop();<br>  <span class="hljs-comment">//Looperå¦‚æœå› å¼‚å¸¸åŸå› åœæ­¢å¾ªç¯åˆ™æŠ›å¼‚å¸¸</span><br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Main thread loop unexpectedly exited&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸»çº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯å¼€å§‹äº†ä»¥åï¼ŒActivityThreadè¿˜éœ€è¦æœ‰ä¸€ä¸ªHandleræ¥å’Œæ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªHandlerå°±æ˜¯ActivityThread.Hï¼Œå®ƒå†…éƒ¨å®šä¹‰äº†å¾ˆå¤šçš„æ¶ˆæ¯ç±»å‹ï¼Œä¾‹å¦‚å››å¤§ç»„ä»¶çš„å¯åŠ¨ï¼ŒApplicationçš„å¯åŠ¨ç­‰ç­‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">H</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BIND_APPLICATION</span>        <span class="hljs-operator">=</span> <span class="hljs-number">110</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">EXIT_APPLICATION</span>        <span class="hljs-operator">=</span> <span class="hljs-number">111</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">RECEIVER</span>                <span class="hljs-operator">=</span> <span class="hljs-number">113</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CREATE_SERVICE</span>          <span class="hljs-operator">=</span> <span class="hljs-number">114</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SERVICE_ARGS</span>            <span class="hljs-operator">=</span> <span class="hljs-number">115</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STOP_SERVICE</span>            <span class="hljs-operator">=</span> <span class="hljs-number">116</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONFIGURATION_CHANGED</span>   <span class="hljs-operator">=</span> <span class="hljs-number">118</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CLEAN_UP_CONTEXT</span>        <span class="hljs-operator">=</span> <span class="hljs-number">119</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">GC_WHEN_IDLE</span>            <span class="hljs-operator">=</span> <span class="hljs-number">120</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BIND_SERVICE</span>            <span class="hljs-operator">=</span> <span class="hljs-number">121</span>;<br>        <span class="hljs-meta">@UnsupportedAppUsage</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">UNBIND_SERVICE</span>          <span class="hljs-operator">=</span> <span class="hljs-number">122</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DUMP_SERVICE</span>            <span class="hljs-operator">=</span> <span class="hljs-number">123</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">LOW_MEMORY</span>              <span class="hljs-operator">=</span> <span class="hljs-number">124</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROFILER_CONTROL</span>        <span class="hljs-operator">=</span> <span class="hljs-number">127</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CREATE_BACKUP_AGENT</span>     <span class="hljs-operator">=</span> <span class="hljs-number">128</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DESTROY_BACKUP_AGENT</span>    <span class="hljs-operator">=</span> <span class="hljs-number">129</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SUICIDE</span>                 <span class="hljs-operator">=</span> <span class="hljs-number">130</span>;<br>     <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> &#123;<br>          <span class="hljs-comment">//...</span><br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…³äºActivityThread.Hçš„å®é™…åº”ç”¨ï¼Œæˆ‘ä»¬åœ¨çœ‹<a href="https://juejin.cn/post/6847902222294990862">Activityçš„å¯åŠ¨æµç¨‹</a>å¯èƒ½ä¼šæœ‰æ¯”è¾ƒæ·±å…¥çš„ç†è§£ï¼ŒActivityThreadé€šè¿‡ApplicationThreadå’ŒAMSè¿›è¡Œè¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼å®ŒæˆActivityThreadçš„è¯·æ±‚åï¼Œä¼šå›è°ƒApplicationThreadä¸­çš„Binderæ–¹æ³•ï¼Œç„¶åApplicationThreadä¼šå‘Hå‘é€æ¶ˆæ¯ï¼ŒHæ”¶åˆ°æ¶ˆæ¯åä¼šå°†ApplicationThreadä¸­çš„é€»è¾‘åˆ‡æ¢åˆ°ActivityThreadä¸­å»æ‰§è¡Œï¼Œå³åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å»æ‰§è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸»çº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯æ¨¡å‹</p><h2 id="å¦™ç”¨-Looper-æœºåˆ¶"><a href="#å¦™ç”¨-Looper-æœºåˆ¶" class="headerlink" title="å¦™ç”¨ Looper æœºåˆ¶"></a>å¦™ç”¨ Looper æœºåˆ¶</h2><p>1ã€æˆ‘ä»¬å¯ä»¥é€šè¿‡Looper<code>getMainLooper</code>æ–¹æ³•è·å–ä¸»çº¿ç¨‹Looperï¼Œä»è€Œå¯ä»¥åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯ä¸»çº¿ç¨‹</p><p>2ã€å°† Runnable post åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainThread</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">MainThread</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">HANDLER</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(Looper.getMainLooper());<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Runnable runnable)</span> &#123;<br>        <span class="hljs-keyword">if</span> (isMainThread()) &#123;<br>            runnable.run();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            HANDLER.post(runnable);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isMainThread</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Looper.myLooper() == Looper.getMainLooper();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å­çº¿ç¨‹ä½¿ç”¨HandleråŠç›¸å…³æ³¨æ„äº‹é¡¹"><a href="#å­çº¿ç¨‹ä½¿ç”¨HandleråŠç›¸å…³æ³¨æ„äº‹é¡¹" class="headerlink" title="å­çº¿ç¨‹ä½¿ç”¨HandleråŠç›¸å…³æ³¨æ„äº‹é¡¹"></a>å­çº¿ç¨‹ä½¿ç”¨HandleråŠç›¸å…³æ³¨æ„äº‹é¡¹</h2><p>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨Handleréƒ½æ˜¯ä»å­çº¿ç¨‹å‘é€æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹å»å¤„ç†ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹ä»ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯åˆ°å­çº¿ç¨‹æ¥å¤„ç†ï¼Œä¸Šä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-comment">//åˆ›å»ºçº¿ç¨‹å®ä¾‹å¹¶å¼€å¯</span><br>        <span class="hljs-type">MyThread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();<br>        myThread.start();<br>        <span class="hljs-comment">//æ‰“å¼€è¿™æ®µæ³¨é‡Šå°±ä¸ä¼šcrashï¼Œä¸”çœ‹ä¸‹é¢åˆ†æ</span><br><span class="hljs-comment">//      try &#123;</span><br><span class="hljs-comment">//          Thread.sleep(500);</span><br><span class="hljs-comment">//      &#125; catch (InterruptedException e) &#123;</span><br><span class="hljs-comment">//          e.printStackTrace();</span><br><span class="hljs-comment">//      &#125;</span><br>        <span class="hljs-comment">//è·å–Handlerå‘é€æ¶ˆæ¯</span><br>        myThread.getHandler().sendEmptyMessage(<span class="hljs-number">0x001</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-keyword">private</span> Handler mHandler;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            Looper.prepare();<br>            mHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>                    <span class="hljs-keyword">if</span>(msg.what == <span class="hljs-number">0x001</span>)&#123;<br>                        Log.d(<span class="hljs-string">&quot;print&quot;</span>, <span class="hljs-string">&quot;handleMessage: &quot;</span>);<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            Looper.loop();<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> Handler <span class="hljs-title function_">getHandler</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> mHandler;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œä¸€ä¸‹ä¸Šè¿°ä»£ç ï¼Œå‘ç°ä¼šCrashï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79f6a7b7e65d4c1ea07ea76b3ac49689~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210223112129732"></p><p>æŠ¥äº†ä¸€ä¸ªç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ŒåŸå› å°±æ˜¯å¤šçº¿ç¨‹å¹¶å‘ï¼Œå½“ä¸»çº¿ç¨‹æ‰§è¡Œåˆ°sendEnptyMessageæ—¶ï¼Œå­çº¿ç¨‹çš„Handlerè¿˜æ²¡æœ‰åˆ›å»ºã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨è·å–Handlerçš„æ—¶å€™è®©ä¸»çº¿ç¨‹ä¼‘çœ ä¸€ä¸‹åœ¨æ‰§è¡Œï¼Œåº”ç”¨å°±ä¸ä¼šCrashäº†ï¼Œæ‰“å¼€ä¸Šé¢ä»£ç çš„æ³¨é‡Šå³å¯</p><p><strong>å€¼å¾—æ³¨æ„çš„æ˜¯</strong>ï¼šæˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„Looperåœ¨ä½¿ç”¨å®Œæ¯•ååº”è¯¥è°ƒç”¨<code>quit</code>æ–¹æ³•æ¥ç»ˆæ­¢æ¶ˆæ¯å¾ªç¯ï¼Œå¦‚æœä¸é€€å‡ºçš„è¯ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹çš„Looperå¤„ç†å®Œæ‰€æœ‰çš„æ¶ˆæ¯åï¼Œå°±ä¼šå¤„äºä¸€ä¸ªé˜»å¡çŠ¶æ€ï¼Œè¦çŸ¥é“çº¿ç¨‹æ˜¯æ¯”è¾ƒé‡é‡çº§çš„ï¼Œå¦‚æœä¸€ç›´å­˜åœ¨ï¼Œè‚¯å®šä¼šå¯¹åº”ç”¨æ€§èƒ½é€ æˆä¸€å®šçš„å½±å“ã€‚è€Œå¦‚æœé€€å‡ºLooperï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¼šç«‹åˆ»ç»ˆæ­¢ï¼Œå› æ­¤å»ºè®®ä¸éœ€è¦çš„æ—¶å€™ç»ˆæ­¢Looperã€‚</p><p>å› æ­¤åœ¨å­çº¿ç¨‹ä½¿ç”¨Handlerï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸‹ä¸¤ç‚¹ï¼š</p><p><strong>1ã€å¿…é¡»è°ƒç”¨<code> Looper.prepare()</code>åˆ›å»ºå½“å‰çº¿ç¨‹çš„ Looperï¼Œå¹¶è°ƒç”¨<code>Looper.loop()</code>å¼€å¯æ¶ˆæ¯å¾ªç¯</strong></p><p><strong>2ã€å¿…é¡»åœ¨ä½¿ç”¨ç»“æŸåè°ƒç”¨Looperçš„<code>quit</code>æ–¹æ³•é€€å‡ºå½“å‰çº¿ç¨‹</strong></p><h2 id="HandlerThread"><a href="#HandlerThread" class="headerlink" title="HandlerThread"></a>HandlerThread</h2><p>ä¸Šé¢è®²åˆ°ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯åˆ°å­çº¿ç¨‹æ¥å¤„ç†ï¼Œå…¶å®Androidå·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¿™æ ·è½»é‡çº§çš„å¼‚æ­¥ç±»ï¼Œé‚£å°±æ˜¯HandlerThread</p><p>HandlerThreadçš„å®ç°åŸç†ä¹Ÿæ¯”è¾ƒç®€å•ï¼š<strong>ç»§æ‰¿Threadå¹¶å¯¹Looperè¿›è¡Œäº†å°è£…</strong></p><p>å…·ä½“æºç å°±ä¸è¿‡å¤šåˆ†æäº†ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥å»çœ‹ä¸€ä¸‹ï¼Œä¹Ÿå°±100å¤šè¡Œä»£ç ï¼Œè¿™é‡Œä¸»è¦è®²è§£ä¸€ä¸‹ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>      <span class="hljs-comment">//1ï¼Œåˆ›å»ºHandlerå®ä¾‹</span><br>      <span class="hljs-type">HandlerThread</span> <span class="hljs-variable">mHandlerThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerThread</span>(<span class="hljs-string">&quot;HandlerThread&quot;</span>);<br>      <span class="hljs-comment">//2ï¼Œå¯åŠ¨çº¿ç¨‹</span><br>        mHandlerThread.start();<br>      <span class="hljs-comment">//3ï¼Œä½¿ç”¨ä¼ å…¥Looperä¸ºå‚æ•°çš„æ„é€ æ–¹æ³•åˆ›å»ºHandlerå®ä¾‹</span><br>        <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(mHandlerThread.getLooper())&#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>                Log.d(<span class="hljs-string">&quot;print&quot;</span>, <span class="hljs-string">&quot;å½“å‰çº¿ç¨‹: &quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot; handleMessage&quot;</span>);<br>            &#125;<br>        &#125;;<br>        <span class="hljs-comment">//4ï¼Œä½¿ç”¨Handlerå‘é€æ¶ˆæ¯</span><br>        mHandler.sendEmptyMessage(<span class="hljs-number">0x001</span>);<br>      <span class="hljs-comment">//5ï¼Œåœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨HandlerThreadçš„quitæ–¹æ³•ï¼Œé€€å‡ºæ¶ˆæ¯å¾ªç¯</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¸Šè¿°ä»£ç æ‰“å°ç»“æœ:</span><br>å½“å‰çº¿ç¨‹: HandlerThread handleMessage<br></code></pre></td></tr></table></figure><h3 id="Handler-HandlerThread-Threadä¸‰è€…åŒºåˆ«"><a href="#Handler-HandlerThread-Threadä¸‰è€…åŒºåˆ«" class="headerlink" title="Handler  HandlerThread  Threadä¸‰è€…åŒºåˆ«"></a>Handler  HandlerThread  Threadä¸‰è€…åŒºåˆ«</h3><p><strong>Handler</strong>ï¼šåœ¨Androidä¸­è´Ÿè´£å‘é€å’Œå¤„ç†æ¶ˆæ¯</p><p><strong>HandlerThread</strong>ï¼šç»§æ‰¿è‡ªThreadï¼Œå¯¹Looperè¿›è¡Œäº†å°è£…ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåœ¨å­çº¿ç¨‹ç»´æŠ¤äº†ä¸€ä¸ªLooperï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å­çº¿ç¨‹ä¸­å»å¤„ç†æ¶ˆæ¯</p><p><strong>Thread</strong>: cpuæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œå³çº¿ç¨‹ï¼Œå®ƒåœ¨æ‰§è¡Œå®Œåå°±ç«‹é©¬ç»“æŸäº†ï¼Œå¹¶ä¸èƒ½å»å¤„ç†æ¶ˆæ¯ã€‚å¦‚æœè¦å¤„ç†ï¼Œéœ€è¦é…åˆLooperï¼ŒHandlerä¸€èµ·ä½¿ç”¨</p><h2 id="å­çº¿ç¨‹å¼¹Toast"><a href="#å­çº¿ç¨‹å¼¹Toast" class="headerlink" title="å­çº¿ç¨‹å¼¹Toast"></a>å­çº¿ç¨‹å¼¹Toast</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;å­çº¿ç¨‹å¼¹Toast&quot;</span>, Toast.LENGTH_SHORT).show();<br>    &#125;<br>&#125;.start();<br><br><span class="hljs-comment">//2</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        Looper.prepare();<br>        Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;å­çº¿ç¨‹å¼¹Toast&quot;</span>, Toast.LENGTH_SHORT).show();<br>        Looper.loop();<br>    &#125;<br>&#125;.start();<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°1ä»£ç è¿è¡Œä¼šå¥”æºƒï¼Œä¼šæŠ¥è¿™ä¹ˆä¸€ä¸ªå¼‚å¸¸æç¤ºï¼š**â€Canâ€™t toast on a thread that has not called Looper.prepare()â€**</p><p>åŸå› å°±æ˜¯Toastçš„å®ç°ä¹Ÿæ˜¯ä¾èµ–Handlerï¼Œè€Œæˆ‘ä»¬çŸ¥é“åœ¨å­çº¿ç¨‹ä¸­åˆ›å»ºHandlerï¼Œéœ€å…ˆåˆ›å»ºLooperå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯ï¼Œè¿™ç‚¹åœ¨Toastä¸­çš„æºç ä¹Ÿæœ‰ä½“ç°ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4fb7b199888404f864e1d0c43d0dc7f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210223131023498"></p><p>å› æ­¤æˆ‘ä»¬åœ¨å­çº¿ç¨‹åˆ›å»ºToastå°±éœ€è¦ä½¿ç”¨ä¸Šè¿°2ä»£ç çš„æ–¹å¼</p><h2 id="å­çº¿ç¨‹å¼¹Dialog"><a href="#å­çº¿ç¨‹å¼¹Dialog" class="headerlink" title="å­çº¿ç¨‹å¼¹Dialog"></a>å­çº¿ç¨‹å¼¹Dialog</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>    <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            Looper.prepare();<br>          <span class="hljs-keyword">new</span> <span class="hljs-title class_">AlertDialog</span>.Builder(MainActivity.<span class="hljs-built_in">this</span>)<br>                  .setTitle(<span class="hljs-string">&quot;æ ‡é¢˜&quot;</span>)<br>                  .setMessage(<span class="hljs-string">&quot;å­çº¿ç¨‹å¼¹Dialog&quot;</span>)<br>                  .setNegativeButton(<span class="hljs-string">&quot;å–æ¶ˆ&quot;</span>,<span class="hljs-literal">null</span>)<br>                  .setPositiveButton(<span class="hljs-string">&quot;ç¡®å®š&quot;</span>,<span class="hljs-literal">null</span>)<br>                  .show();<br>            Looper.loop();     <br>    &#125;    <br>&#125;.start();<br></code></pre></td></tr></table></figure><p>å’Œä¸Šé¢Toastå·®ä¸å¤šï¼Œè¿™é‡Œè´´å‡ºæ­£ç¡®çš„ä»£ç ç¤ºä¾‹ï¼Œå®ƒçš„å®ç°ä¹Ÿæ˜¯ä¾èµ–Handlerï¼Œæˆ‘ä»¬åœ¨å®ƒçš„æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>();<br></code></pre></td></tr></table></figure><p>ä»–ç›´æ¥å°±newäº†ä¸€ä¸ªHandlerå®ä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåˆ›å»ºHandlerï¼Œéœ€è¦å…ˆåˆ›å»ºLooperå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯ï¼Œä¸»çº¿ç¨‹ä¸­å·²ç»ç»™æˆ‘ä»¬åˆ›å»ºå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯ï¼Œè€Œå­çº¿ç¨‹ä¸­å¹¶æ²¡æœ‰ï¼Œå¦‚æœä¸åˆ›å»ºé‚£å°±ä¼šæŠ¥è¿™å¥ç»å…¸çš„å¼‚å¸¸æç¤ºï¼š**â€Canâ€™t create handler inside thread that has not called Looper.prepare() â€œ**ï¼Œå› æ­¤åœ¨å­çº¿ç¨‹ä¸­ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»åˆ›å»ºå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯</p><p>åˆ°è¿™é‡Œï¼ŒHandlerç›¸å…³çš„æ‰©å±•çŸ¥è¯†å°±å…¨éƒ¨è®²å®Œäº†ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¹Ÿæœ‰ç€å¾ˆå¤šä½¿ç”¨çš„å°æŠ€å·§ï¼Œæ¯”å¦‚ IdleHandlerï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ä¸»çº¿ç¨‹ç­‰ç­‰</p><p>ç”±äº Handler çš„ç‰¹æ€§ï¼Œå®ƒåœ¨ Android é‡Œçš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæ¯”å¦‚ï¼š AsyncTaskã€HandlerThreadã€Messengerã€IdleHandler å’Œ IntentService ç­‰ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å›ç­”ä¸Šä¸€ç¯‡ä¸­åˆ—å‡ºæ¥çš„ä¸€ç³»åˆ—é—®é¢˜</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="1ã€Handleræœ‰å“ªäº›ä½œç”¨"><a href="#1ã€Handleræœ‰å“ªäº›ä½œç”¨" class="headerlink" title="1ã€Handleræœ‰å“ªäº›ä½œç”¨?"></a>1ã€Handleræœ‰å“ªäº›ä½œç”¨?</h3><p>ç­”ï¼š</p><p> 1ã€Handlerèƒ½å¤Ÿè¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢ </p><p>2ã€Handlerèƒ½å¤ŸæŒ‰ç…§é¡ºåºå¤„ç†æ¶ˆæ¯ï¼Œé¿å…å¹¶å‘ </p><p>3ã€Handlerèƒ½å¤Ÿé˜»å¡çº¿ç¨‹ </p><p>4ã€Handlerèƒ½å¤Ÿå‘é€å¹¶å¤„ç†å»¶è¿Ÿæ¶ˆæ¯</p><p>è§£æ: </p><p>1ã€Handlerèƒ½å¤Ÿè¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢ï¼Œæ˜¯å› ä¸ºä½¿ç”¨äº†ä¸åŒçº¿ç¨‹çš„Looperå¤„ç†æ¶ˆæ¯</p><p>2ã€Handlerèƒ½å¤ŸæŒ‰ç…§é¡ºåºå¤„ç†æ¶ˆæ¯ï¼Œé¿å…å¹¶å‘ï¼Œæ˜¯å› ä¸ºæ¶ˆæ¯åœ¨å…¥é˜Ÿçš„æ—¶å€™ä¼šæŒ‰ç…§æ—¶é—´å‡åºå¯¹å½“å‰é“¾è¡¨è¿›è¡Œæ’åºï¼ŒLooperè¯»å–çš„æ—¶å€™ï¼ŒMessageQueueçš„<code>next</code>æ–¹æ³•ä¼šå¾ªç¯åŠ é”ï¼ŒåŒæ—¶é…åˆé˜»å¡å”¤é†’æœºåˆ¶</p><p>3ã€Handlerèƒ½å¤Ÿé˜»å¡çº¿ç¨‹ä¸»è¦æ˜¯åŸºäºLinuxçš„epollæœºåˆ¶å®ç°çš„</p><p>4ã€Handlerèƒ½å¤Ÿå¤„ç†å»¶è¿Ÿæ¶ˆæ¯ï¼Œæ˜¯å› ä¸ºMessageQueueçš„<code>next</code>æ–¹æ³•ä¸­ä¼šæ‹¿å½“å‰æ¶ˆæ¯æ—¶é—´å’Œå½“å‰æ—¶é—´åšæ¯”è¾ƒï¼Œå¦‚æœæ˜¯å»¶è¿Ÿæ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç­‰é˜»å¡æ—¶é—´åˆ°ï¼Œåœ¨æ‰§è¡Œè¯¥æ¶ˆæ¯</p><h3 id="2ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥ä½¿ç”¨Handlerï¼Œè€Œä¸éœ€è¦åˆ›å»ºLooperï¼Ÿ"><a href="#2ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥ä½¿ç”¨Handlerï¼Œè€Œä¸éœ€è¦åˆ›å»ºLooperï¼Ÿ" class="headerlink" title="2ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥ä½¿ç”¨Handlerï¼Œè€Œä¸éœ€è¦åˆ›å»ºLooperï¼Ÿ"></a>2ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥ä½¿ç”¨Handlerï¼Œè€Œä¸éœ€è¦åˆ›å»ºLooperï¼Ÿ</h3><p>ç­”ï¼šä¸»çº¿ç¨‹å·²ç»åˆ›å»ºäº†Looperï¼Œå¹¶å¼€å¯äº†æ¶ˆæ¯å¾ªç¯</p><h3 id="3ã€å¦‚æœæƒ³è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œéœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ"><a href="#3ã€å¦‚æœæƒ³è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œéœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ" class="headerlink" title="3ã€å¦‚æœæƒ³è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œéœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ"></a>3ã€å¦‚æœæƒ³è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œéœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ</h3><p>ç­”ï¼šéœ€è¦å…ˆåˆ›å»ºLooperï¼Œå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯</p><h3 id="4ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandlerï¼Ÿ"><a href="#4ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandlerï¼Ÿ" class="headerlink" title="4ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandlerï¼Ÿ"></a>4ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandlerï¼Ÿ</h3><p>ç­”ï¼šå¯ä»¥æœ‰ä»»æ„å¤šä¸ª</p><h3 id="5ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooperï¼Ÿå¦‚ä½•ä¿è¯ï¼Ÿ"><a href="#5ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooperï¼Ÿå¦‚ä½•ä¿è¯ï¼Ÿ" class="headerlink" title="5ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooperï¼Ÿå¦‚ä½•ä¿è¯ï¼Ÿ"></a>5ã€ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooperï¼Ÿå¦‚ä½•ä¿è¯ï¼Ÿ</h3><p>ç­”ï¼šä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªLooperï¼Œé€šè¿‡ThreadLocalæ¥ä¿è¯</p><h3 id="6ã€Handlerå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ—¶é—´ä¸ºå•¥è¦å–SystemClock-uptimeMillis-delayMillisï¼Œå¯ä»¥æŠŠSystemClock-uptimeMillis-æ¢æˆSystem-currentTimeMillis-å—ï¼Ÿ"><a href="#6ã€Handlerå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ—¶é—´ä¸ºå•¥è¦å–SystemClock-uptimeMillis-delayMillisï¼Œå¯ä»¥æŠŠSystemClock-uptimeMillis-æ¢æˆSystem-currentTimeMillis-å—ï¼Ÿ" class="headerlink" title="6ã€Handlerå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ—¶é—´ä¸ºå•¥è¦å–SystemClock.uptimeMillis() + delayMillisï¼Œå¯ä»¥æŠŠSystemClock.uptimeMillis() æ¢æˆSystem.currentTimeMillis()å—ï¼Ÿ"></a>6ã€Handlerå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ—¶é—´ä¸ºå•¥è¦å–SystemClock.uptimeMillis() + delayMillisï¼Œå¯ä»¥æŠŠSystemClock.uptimeMillis() æ¢æˆSystem.currentTimeMillis()å—ï¼Ÿ</h3><p>ç­”ï¼šä¸å¯ä»¥</p><p><strong>SystemClock.uptimeMillis()</strong> è¿™ä¸ªæ–¹æ³•è·å–çš„æ—¶é—´ï¼Œæ˜¯è‡ªç³»ç»Ÿå¼€æœºåˆ°ç°åœ¨çš„ä¸€ä¸ªæ¯«ç§’æ•°ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯ä¸ªç›¸å¯¹çš„</p><p><strong>System.currentTimeMillis()</strong> è¿™ä¸ªæ–¹æ³•è·å–çš„æ˜¯è‡ª<strong>1970-01-01 00:00:00</strong> åˆ°ç°åœ¨çš„ä¸€ä¸ªæ¯«ç§’æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå’Œç³»ç»Ÿå¼ºå…³è”çš„æ—¶é—´ï¼Œè€Œä¸”è¿™ä¸ªå€¼å¯ä»¥åšä¿®æ”¹</p><p>1ã€ä½¿ç”¨System.currentTimeMillis()å¯èƒ½ä¼šå¯¼è‡´å»¶è¿Ÿæ¶ˆæ¯å¤±æ•ˆ</p><p>2ã€æœ€ç»ˆè¿™ä¸ªæ—¶é—´ä¼šè¢«è®¾ç½®åˆ°Messageçš„whenå±æ€§ï¼Œè€ŒMessageçš„whenå±æ€§åªæ˜¯éœ€è¦ä¸€ä¸ªæ—¶é—´å·®æ¥è¡¨ç¤ºæ¶ˆæ¯çš„å…ˆåé¡ºåºï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹æ—¶é—´å°±è¡Œäº†ï¼Œæ²¡å¿…è¦ä½¿ç”¨ä¸€ä¸ªç»å¯¹æ—¶é—´</p><h3 id="7ã€ä¸ºä»€ä¹ˆLooperæ­»å¾ªç¯ï¼Œå´ä¸ä¼šå¯¼è‡´åº”ç”¨å¡æ­»ï¼Ÿ"><a href="#7ã€ä¸ºä»€ä¹ˆLooperæ­»å¾ªç¯ï¼Œå´ä¸ä¼šå¯¼è‡´åº”ç”¨å¡æ­»ï¼Ÿ" class="headerlink" title="7ã€ä¸ºä»€ä¹ˆLooperæ­»å¾ªç¯ï¼Œå´ä¸ä¼šå¯¼è‡´åº”ç”¨å¡æ­»ï¼Ÿ"></a>7ã€ä¸ºä»€ä¹ˆLooperæ­»å¾ªç¯ï¼Œå´ä¸ä¼šå¯¼è‡´åº”ç”¨å¡æ­»ï¼Ÿ</h3><p>ç­”ï¼šå› ä¸ºå½“Looperå¤„ç†å®Œæ‰€æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨Linuxçš„epollæœºåˆ¶è¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œå½“æœ‰æ–°çš„Messageè¿›æ¥çš„æ—¶å€™ä¼šæ‰“ç ´é˜»å¡ç»§ç»­æ‰§è¡Œã€‚</p><p>åº”ç”¨å¡æ­»å³ANR: å…¨ç§°Applicationn Not Respondingï¼Œä¸­æ–‡æ„æ€æ˜¯åº”ç”¨æ— å“åº”ï¼Œå½“æˆ‘å‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ï¼ŒHandlerç»è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰æ‰§è¡Œå®Œè¿™æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šæŠ›å‡ºANRå¼‚å¸¸</p><p>Looperæ­»å¾ªç¯: å¾ªç¯æ‰§è¡Œå„ç§äº‹åŠ¡ï¼ŒLooperæ­»å¾ªç¯è¯´æ˜çº¿ç¨‹è¿˜æ´»ç€ï¼Œå¦‚æœæ²¡æœ‰Looperæ­»å¾ªç¯ï¼Œçº¿ç¨‹ç»“æŸï¼Œåº”ç”¨å°±é€€å‡ºäº†ï¼Œå½“Looperå¤„ç†å®Œæ‰€æœ‰æ¶ˆæ¯çš„æ—¶å€™ä¼šè°ƒç”¨Linuxçš„epollæœºåˆ¶è¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œå½“æœ‰æ–°çš„Messageè¿›æ¥çš„æ—¶å€™ä¼šæ‰“ç ´é˜»å¡ç»§ç»­æ‰§è¡Œ</p><h3 id="8ã€Handlerå†…å­˜æ³„éœ²åŸå› -å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#8ã€Handlerå†…å­˜æ³„éœ²åŸå› -å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="8ã€Handlerå†…å­˜æ³„éœ²åŸå› ? å¦‚ä½•è§£å†³ï¼Ÿ"></a>8ã€Handlerå†…å­˜æ³„éœ²åŸå› ? å¦‚ä½•è§£å†³ï¼Ÿ</h3><p>å†…å­˜æ³„æ¼çš„æœ¬è´¨æ˜¯é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡çš„å¼•ç”¨ï¼Œå¯¼è‡´çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æ— æ³•è¢«å›æ”¶ï¼Œä»è€Œå¯¼è‡´äº†å†…å­˜æ³„æ¼</p><p>ä¸‹é¢æˆ‘ä»¬å°±çœ‹ä¸ªå¯¼è‡´å†…å­˜æ³„æ¼çš„ä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>           <span class="hljs-comment">//do something</span><br>        &#125;<br>    &#125;;<br>  <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-comment">//å‘é€ä¸€ä¸ªå»¶è¿Ÿæ¶ˆæ¯ï¼Œ10åˆ†é’Ÿååœ¨æ‰§è¡Œ</span><br>        mHandler.sendEmptyMessageDelayed(<span class="hljs-number">0x001</span>,<span class="hljs-number">10</span>*<span class="hljs-number">60</span>*<span class="hljs-number">1000</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç :</p><p>1ã€æˆ‘ä»¬é€šè¿‡åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºäº†ä¸€ä¸ªHandlerçš„å®ä¾‹</p><p>2ã€åœ¨<code>onCreate</code>æ–¹æ³•é‡Œé¢é€šè¿‡Handlerå®ä¾‹å‘é€äº†ä¸€ä¸ªå»¶è¿Ÿ10åˆ†é’Ÿæ‰§è¡Œçš„æ¶ˆæ¯</p><p>æˆ‘ä»¬å‘é€çš„è¿™ä¸ªå»¶è¿Ÿ10åˆ†é’Ÿæ‰§è¡Œçš„æ¶ˆæ¯å®ƒæ˜¯æŒæœ‰Handlerçš„å¼•ç”¨çš„ï¼Œæ ¹æ®Javaç‰¹æ€§æˆ‘ä»¬åˆçŸ¥é“ï¼Œéé™æ€å†…éƒ¨ç±»ä¼šæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œå› æ­¤å½“å‰HandleråˆæŒæœ‰Activityçš„å¼•ç”¨ï¼Œè€ŒMessageåˆå­˜åœ¨MessageQueueä¸­ï¼ŒMessageQueueåˆåœ¨å½“å‰çº¿ç¨‹ä¸­ï¼Œå› æ­¤ä¼šå­˜åœ¨ä¸€ä¸ªå¼•ç”¨é“¾å…³ç³»:</p><p><strong>å½“å‰çº¿ç¨‹-&gt;MessageQueue-&gt;Message-&gt;Handler-&gt;Activity</strong></p><p>å› æ­¤å½“æˆ‘ä»¬é€€å‡ºActivityçš„æ—¶å€™ï¼Œç”±äºæ¶ˆæ¯éœ€è¦åœ¨10åˆ†é’Ÿååœ¨æ‰§è¡Œï¼Œå› æ­¤ä¼šä¸€ç›´æŒæœ‰Activityï¼Œä»è€Œå¯¼è‡´äº†Activityçš„å†…å­˜æ³„æ¼</p><p>é€šè¿‡ä¸Šé¢åˆ†ææˆ‘ä»¬çŸ¥é“äº†å†…å­˜æ³„æ¼çš„åŸå› å°±æ˜¯æŒæœ‰äº†Activityçš„å¼•ç”¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¼šæƒ³ï¼Œåˆ‡æ–­è¿™æ¡å¼•ç”¨ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬éœ€è¦ç”¨åˆ°Activityç›¸å…³çš„å±æ€§å’Œæ–¹æ³•é‡‡ç”¨å¼±å¼•ç”¨çš„æ–¹å¼ä¸å°±å¯ä»¥äº†ä¹ˆï¼Ÿæˆ‘ä»¬å®é™…æ“ä½œä¸€ä¸‹ï¼ŒæŠŠHandlerå†™æˆä¸€ä¸ªé™æ€å†…éƒ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">SafeHandler</span> <span class="hljs-variable">mSafeHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SafeHandler</span>(<span class="hljs-built_in">this</span>);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>      <span class="hljs-comment">//å‘é€ä¸€ä¸ªå»¶è¿Ÿæ¶ˆæ¯ï¼Œ10åˆ†é’Ÿååœ¨æ‰§è¡Œ</span><br>        mSafeHandler.sendEmptyMessageDelayed(<span class="hljs-number">0x001</span>,<span class="hljs-number">10</span>*<span class="hljs-number">60</span>*<span class="hljs-number">1000</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//é™æ€å†…éƒ¨ç±»å¹¶æŒæœ‰Activityçš„å¼±å¼•ç”¨</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span>&#123;<br>      <br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WeakReference&lt;MainActivity&gt; mWeakReference;<br>      <br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">SafeHandler</span><span class="hljs-params">(MainActivity activity)</span>&#123;<br>            mWeakReference = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakReference</span>&lt;&gt;(activity);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>            <span class="hljs-type">MainActivity</span> <span class="hljs-variable">mMainActivity</span> <span class="hljs-operator">=</span> mWeakReference.get();<br>            <span class="hljs-keyword">if</span>(mMainActivity != <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-comment">//do something</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç </p><p>1ã€æŠŠHandlerå®šä¹‰æˆäº†ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå¹¶æŒæœ‰å½“å‰Activityçš„å¼±å¼•ç”¨ï¼Œå¼±å¼•ç”¨ä¼šåœ¨Javaè™šæ‹Ÿæœºå‘ç”Ÿgcçš„æ—¶å€™æŠŠå¯¹è±¡ç»™å›æ”¶æ‰</p><p>ç»è¿‡ä¸Šè¿°æ”¹é€ ï¼Œæˆ‘ä»¬è§£å†³äº†Activityçš„å†…å­˜æ³„æ¼ï¼Œæ­¤æ—¶çš„å¼•ç”¨é“¾å…³ç³»ä¸º:</p><p><strong>å½“å‰çº¿ç¨‹-&gt;MessageQueue-&gt;Message-&gt;Handler</strong></p><p>æˆ‘ä»¬ä¼šå‘ç°Messageè¿˜æ˜¯ä¼šæŒæœ‰Handlerçš„å¼•ç”¨ï¼Œä»è€Œå¯¼è‡´Handlerä¹Ÿä¼šå†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨Activityé”€æ¯çš„æ—¶å€™ï¼Œåœ¨ä»–çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œï¼ŒæŠŠMessageQueueä¸­çš„Messageéƒ½ç»™ç§»é™¤æ‰ï¼Œå› æ­¤æœ€ç»ˆå°±å˜æˆäº†è¿™æ ·ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">SafeHandler</span> <span class="hljs-variable">mSafeHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SafeHandler</span>(<span class="hljs-built_in">this</span>);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>      <span class="hljs-comment">//å‘é€ä¸€ä¸ªå»¶è¿Ÿæ¶ˆæ¯ï¼Œ10åˆ†é’Ÿååœ¨æ‰§è¡Œ</span><br>        mSafeHandler.sendEmptyMessageDelayed(<span class="hljs-number">0x001</span>,<span class="hljs-number">10</span>*<span class="hljs-number">60</span>*<span class="hljs-number">1000</span>);<br>    &#125;<br>  <br>  <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroy</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onDestroy();<br>        mSafeHandler.removeCallbacksAndMessages(<span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//é™æ€å†…éƒ¨ç±»å¹¶æŒæœ‰Activityçš„å¼±å¼•ç”¨</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span>&#123;<br>      <br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WeakReference&lt;MainActivity&gt; mWeakReference;<br>      <br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">SafeHandler</span><span class="hljs-params">(MainActivity activity)</span>&#123;<br>            mWeakReference = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakReference</span>&lt;&gt;(activity);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>            <span class="hljs-type">MainActivity</span> <span class="hljs-variable">mMainActivity</span> <span class="hljs-operator">=</span> mWeakReference.get();<br>            <span class="hljs-keyword">if</span>(mMainActivity != <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-comment">//do something</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å› æ­¤å½“Activityé”€æ¯åï¼Œå¼•ç”¨é“¾å…³ç³»ä¸º:</p><p><strong>å½“å‰çº¿ç¨‹-&gt;MessageQueue</strong></p><p>è€Œå½“å‰çº¿ç¨‹å’ŒMessageQueueçš„ç”Ÿå‘½å‘¨æœŸå’Œåº”ç”¨ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ ·é•¿çš„ï¼Œå› æ­¤ä¹Ÿå°±ä¸å­˜åœ¨å†…å­˜æ³„æ¼äº†ï¼Œå®Œç¾ã€‚</p><p>æ‰€ä»¥è§£å†³Handlerå†…å­˜æ³„æ¼æœ€å¥½çš„æ–¹å¼å°±æ˜¯ï¼š<strong>å°†Handlerå®šä¹‰æˆé™æ€å†…éƒ¨ç±»ï¼Œå†…éƒ¨æŒæœ‰Activityçš„å¼±å¼•ç”¨ï¼Œå¹¶åœ¨Activityé”€æ¯çš„æ—¶å€™ç§»é™¤æ‰€æœ‰æ¶ˆæ¯</strong></p><h3 id="9ã€çº¿ç¨‹ç»´æŠ¤çš„Looperï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶çš„å¤„ç†æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#9ã€çº¿ç¨‹ç»´æŠ¤çš„Looperï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶çš„å¤„ç†æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="9ã€çº¿ç¨‹ç»´æŠ¤çš„Looperï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶çš„å¤„ç†æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>9ã€çº¿ç¨‹ç»´æŠ¤çš„Looperï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶çš„å¤„ç†æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>ç­”ï¼šå½“æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶ï¼ŒLooperä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œé‡Šæ”¾cpuèµ„æºï¼Œæé«˜Appæ€§èƒ½</p><p>æˆ‘ä»¬çŸ¥é“Looperçš„<code>loop</code>æ–¹æ³•ä¸­æœ‰ä¸ªæ­»å¾ªç¯ä¸€ç›´åœ¨è¯»å–MessageQueueä¸­çš„æ¶ˆæ¯ï¼Œå…¶å®æ˜¯è°ƒç”¨äº†MessageQueueä¸­çš„<code>next</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ— æ¶ˆæ¯æ—¶ï¼Œè°ƒç”¨Linuxçš„epollæœºåˆ¶ï¼Œä½¿å¾—çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå½“æœ‰æ–°æ¶ˆæ¯åˆ°æ¥æ—¶ï¼Œå°±ä¼šå°†å®ƒå”¤é†’ï¼Œnextæ–¹æ³•é‡Œä¼šåˆ¤æ–­å½“å‰æ¶ˆæ¯æ˜¯å¦æ˜¯å»¶è¿Ÿæ¶ˆæ¯ï¼Œå¦‚æœæ˜¯åˆ™é˜»å¡çº¿ç¨‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¼šè¿”å›è¿™æ¡æ¶ˆæ¯å¹¶å°†å…¶ä»ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ç»™ç§»é™¤</p><h3 id="10ã€MessageQueueä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«å”¤é†’ï¼Ÿ"><a href="#10ã€MessageQueueä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«å”¤é†’ï¼Ÿ" class="headerlink" title="10ã€MessageQueueä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«å”¤é†’ï¼Ÿ"></a>10ã€MessageQueueä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«å”¤é†’ï¼Ÿ</h3><p>ç­”ï¼šéœ€è¦åˆ†æƒ…å†µ</p><p>1ã€å‘é€æ¶ˆæ¯è¿‡æ¥ï¼Œæ­¤æ—¶MessageQueueä¸­æ— æ¶ˆæ¯æˆ–è€…å½“å‰å‘é€è¿‡æ¥çš„æ¶ˆæ¯æºå¸¦çš„whenä¸º0æˆ–è€…æœ‰å»¶è¿Ÿæ‰§è¡Œçš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆéœ€è¦å”¤é†’</p><p>2ã€å½“é‡åˆ°åŒæ­¥å±éšœä¸”å½“å‰å‘é€è¿‡æ¥çš„æ¶ˆæ¯ä¸ºå¼‚æ­¥æ¶ˆæ¯ï¼Œåˆ¤æ–­è¯¥å¼‚æ­¥æ¶ˆæ¯æ˜¯å¦æ’å…¥åœ¨æ‰€æœ‰å¼‚æ­¥æ¶ˆæ¯çš„é˜Ÿé¦–ï¼Œå¦‚æœæ˜¯åˆ™éœ€è¦å”¤é†’ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¸å”¤é†’</p><h3 id="11ã€çº¿ç¨‹ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«é˜»å¡ï¼Ÿ"><a href="#11ã€çº¿ç¨‹ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«é˜»å¡ï¼Ÿ" class="headerlink" title="11ã€çº¿ç¨‹ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«é˜»å¡ï¼Ÿ"></a>11ã€çº¿ç¨‹ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«é˜»å¡ï¼Ÿ</h3><p>ç­”ï¼šåˆ†æƒ…å†µ</p><p>1ã€å½“MessageQueueä¸­æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ— é™é˜»å¡ï¼Œ</p><p>2ã€å½“å‰MessageQueueä¸­å…¨éƒ¨æ˜¯å»¶è¿Ÿæ¶ˆæ¯ï¼Œé˜»å¡æ—¶é—´ä¸º(å½“å‰å»¶è¿Ÿæ¶ˆæ¯æ—¶é—´ - å½“å‰æ—¶é—´)ï¼Œå¦‚æœè¿™ä¸ªé˜»å¡æ—¶é—´è¶…è¿‡æ¥Integerç±»å‹çš„æœ€å¤§å€¼ï¼Œåˆ™å–Integerç±»å‹çš„æœ€å¤§å€¼</p><h3 id="12ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªHandlerå¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‘æ¶ˆæ¯çš„Handlerå­˜åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œé‚£ä¹ˆHandleræ˜¯å¦‚ä½•ä¿è¯MessageQueueå¹¶å‘è®¿é—®å®‰å…¨çš„å‘¢ï¼Ÿ"><a href="#12ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªHandlerå¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‘æ¶ˆæ¯çš„Handlerå­˜åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œé‚£ä¹ˆHandleræ˜¯å¦‚ä½•ä¿è¯MessageQueueå¹¶å‘è®¿é—®å®‰å…¨çš„å‘¢ï¼Ÿ" class="headerlink" title="12ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªHandlerå¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‘æ¶ˆæ¯çš„Handlerå­˜åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œé‚£ä¹ˆHandleræ˜¯å¦‚ä½•ä¿è¯MessageQueueå¹¶å‘è®¿é—®å®‰å…¨çš„å‘¢ï¼Ÿ"></a>12ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªHandlerå¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‘æ¶ˆæ¯çš„Handlerå­˜åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œé‚£ä¹ˆHandleræ˜¯å¦‚ä½•ä¿è¯MessageQueueå¹¶å‘è®¿é—®å®‰å…¨çš„å‘¢ï¼Ÿ</h3><p>ç­”ï¼šå¾ªç¯åŠ é”ï¼Œé…åˆé˜»å¡å”¤é†’æœºåˆ¶</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°MessageQueueå…¶å®æ˜¯â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å‹ï¼ŒHandlerä¸æ–­åœ°æ”¾å…¥æ¶ˆæ¯ï¼ŒLooperä¸æ–­åœ°å–å‡ºï¼Œè¿™å°±æ¶‰åŠåˆ°æ­»é”é—®é¢˜ã€‚å¦‚æœLooperæ‹¿åˆ°é”ï¼Œä½†æ˜¯é˜Ÿåˆ—ä¸­æ²¡æœ‰æ¶ˆæ¯ï¼Œå°±ä¼šä¸€ç›´ç­‰å¾…ï¼Œè€ŒHandleréœ€è¦æŠŠæ¶ˆæ¯æ”¾è¿›å»ï¼Œé”å´è¢«Looperæ‹¿ç€æ— æ³•å…¥é˜Ÿï¼Œè¿™å°±é€ æˆäº†æ­»é”ã€‚Handleræœºåˆ¶çš„è§£å†³æ–¹æ³•æ˜¯<strong>å¾ªç¯åŠ é”</strong>ã€‚åœ¨MessageQueueçš„nextæ–¹æ³•ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">Message <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>   ...<br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>  ...<br>        nativePollOnce(ptr, nextPollTimeoutMillis);<br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>            ...<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„ç­‰å¾…æ˜¯åœ¨é”å¤–çš„ï¼Œå½“é˜Ÿåˆ—ä¸­æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œä»–ä¼šå…ˆé‡Šæ”¾é”ï¼Œå†è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è¢«å”¤é†’ã€‚è¿™æ ·å°±ä¸ä¼šé€ æˆæ­»é”é—®é¢˜äº†ã€‚</p><p>é‚£åœ¨å…¥é˜Ÿçš„æ—¶å€™ä¼šä¸ä¼šå› ä¸ºé˜Ÿåˆ—å·²ç»æ»¡äº†ç„¶åä¸€è¾¹åœ¨ç­‰å¾…æ¶ˆæ¯å¤„ç†ä¸€è¾¹æ‹¿ç€é”å‘¢ï¼Ÿè¿™ä¸€ç‚¹ä¸åŒçš„æ˜¯MessageQueueçš„æ¶ˆæ¯æ²¡æœ‰ä¸Šé™ï¼Œæˆ–è€…è¯´ä»–çš„ä¸Šé™å°±æ˜¯JVMç»™ç¨‹åºåˆ†é…çš„å†…å­˜ï¼Œå¦‚æœè¶…å‡ºå†…å­˜ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸ä¼šçš„ã€‚</p><h3 id="13ã€Handleræ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹åˆ‡æ¢çš„å‘¢ï¼Ÿ"><a href="#13ã€Handleræ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹åˆ‡æ¢çš„å‘¢ï¼Ÿ" class="headerlink" title="13ã€Handleræ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹åˆ‡æ¢çš„å‘¢ï¼Ÿ"></a>13ã€Handleræ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹åˆ‡æ¢çš„å‘¢ï¼Ÿ</h3><p>ç­”ï¼šä½¿ç”¨ä¸åŒçº¿ç¨‹çš„Looperå¤„ç†æ¶ˆæ¯</p><p>æˆ‘ä»¬é€šå¸¸å¤„ç†æ¶ˆæ¯æ˜¯åœ¨Handlerçš„<code>handleMessage</code>æ–¹æ³•ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨å“ªé‡Œå›è°ƒçš„å‘¢ï¼Ÿçœ‹ä¸‹é¢è¿™æ®µä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loop</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">//å¼€å¯æ­»å¾ªç¯è¯»å–æ¶ˆæ¯</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>         <span class="hljs-comment">// è°ƒç”¨Messageå¯¹åº”çš„Handlerå¤„ç†æ¶ˆæ¯</span><br>         msg.target.dispatchMessage(msg);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­<code>msg.target</code>å…¶å®å°±æ˜¯æˆ‘ä»¬å‘é€æ¶ˆæ¯çš„Handlerï¼Œå› æ­¤ä»–ä¼šå›è°ƒHandlerçš„<code>dispatchMessage</code>æ–¹æ³•ï¼Œè€Œ<code>dispatchMessage</code>è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡ä¸­é‡ç‚¹åˆ†æè¿‡ï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†é€»è¾‘å°±æ˜¯ä¼šå›è°ƒåˆ°Handlerçš„<code>handleMessage</code>æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‘ç°ï¼ŒHandlerçš„<code>handleMessage</code>æ–¹æ³•æ‰€åœ¨çš„çº¿ç¨‹æ˜¯ç”±Looperçš„<code>loop</code>æ–¹æ³•å†³å®šçš„ã€‚å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯ä»å¼‚æ­¥çº¿ç¨‹å‘é€æ¶ˆæ¯åˆ° Handlerï¼Œè€Œè¿™ä¸ª Handler çš„ <code>handleMessage()</code> æ–¹æ³•æ˜¯åœ¨ä¸»çº¿ç¨‹è°ƒç”¨çš„ï¼Œå› ä¸ºLooperæ˜¯åœ¨ä¸»çº¿ç¨‹åˆ›å»ºçš„ï¼Œæ‰€ä»¥æ¶ˆæ¯å°±ä»å¼‚æ­¥çº¿ç¨‹åˆ‡æ¢åˆ°äº†ä¸»çº¿ç¨‹ã€‚</p><h3 id="14ã€æˆ‘ä»¬åœ¨ä½¿ç”¨Messageçš„æ—¶å€™ï¼Œåº”è¯¥å¦‚ä½•å»åˆ›å»ºå®ƒï¼Ÿ"><a href="#14ã€æˆ‘ä»¬åœ¨ä½¿ç”¨Messageçš„æ—¶å€™ï¼Œåº”è¯¥å¦‚ä½•å»åˆ›å»ºå®ƒï¼Ÿ" class="headerlink" title="14ã€æˆ‘ä»¬åœ¨ä½¿ç”¨Messageçš„æ—¶å€™ï¼Œåº”è¯¥å¦‚ä½•å»åˆ›å»ºå®ƒï¼Ÿ"></a>14ã€æˆ‘ä»¬åœ¨ä½¿ç”¨Messageçš„æ—¶å€™ï¼Œåº”è¯¥å¦‚ä½•å»åˆ›å»ºå®ƒï¼Ÿ</h3><p>ç­”ï¼šAndroid ç»™ Message è®¾è®¡äº†å›æ”¶æœºåˆ¶ï¼Œå®˜æ–¹å»ºè®®æ˜¯é€šè¿‡<code>Message.obtain</code>æ–¹æ³•æ¥è·å–ï¼Œè€Œä¸æ˜¯ç›´æ¥newä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™åº”å°½é‡å¤ç”¨ Message ï¼Œå‡å°‘å†…å­˜æ¶ˆè€—ï¼Œæ–¹å¼æœ‰äºŒï¼š</p><p>1ã€è°ƒç”¨ Message çš„ä¸€ç³»åˆ—é™æ€é‡è½½æ–¹æ³• <code>Message.obtain</code>  è·å–</p><p>2ã€é€šè¿‡ Handler çš„å…¬æœ‰æ–¹æ³• <code>handler.obtainMessage</code>ï¼Œå®é™…ä¸Š<code>handler.obtainMessage</code>å†…éƒ¨è°ƒç”¨çš„ä¹Ÿæ˜¯<code>Message.obtain</code>çš„é‡è½½æ–¹æ³•</p><h3 id="15ã€Handleré‡Œé¢è—ç€çš„CallBackèƒ½åšä»€ä¹ˆï¼Ÿ"><a href="#15ã€Handleré‡Œé¢è—ç€çš„CallBackèƒ½åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="15ã€Handleré‡Œé¢è—ç€çš„CallBackèƒ½åšä»€ä¹ˆï¼Ÿ"></a>15ã€Handleré‡Œé¢è—ç€çš„CallBackèƒ½åšä»€ä¹ˆï¼Ÿ</h3><p>ç­”: åˆ©ç”¨æ­¤CallBackæ‹¦æˆªHandlerçš„æ¶ˆæ¯å¤„ç†</p><p>åœ¨ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬åˆ†æåˆ°ï¼Œ<code>dispatchMessage</code>æ–¹æ³•çš„å¤„ç†æ­¥éª¤:</p><p>1ã€é¦–å…ˆï¼Œæ£€æŸ¥Messageçš„callbackæ˜¯å¦ä¸ºnullï¼Œä¸ä¸ºnullå°±é€šè¿‡<code>handleCallBack</code>æ¥å¤„ç†æ¶ˆæ¯ï¼ŒMessageçš„callbackæ˜¯ä¸€ä¸ªRunnableå¯¹è±¡ï¼Œå®é™…ä¸Šå°±æ˜¯Handlerçš„<code>post</code>ç³»åˆ—æ–¹æ³•æ‰€ä¼ é€’çš„Runnableå‚æ•°</p><p>2ã€å…¶æ¬¡ï¼Œæ£€æŸ¥Handleré‡Œé¢è—ç€çš„CallBackæ˜¯å¦ä¸ºnullï¼Œä¸ä¸ºnullå°±è°ƒç”¨mCallbackçš„<code>handleMessage</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯ï¼Œå¹¶åˆ¤æ–­å…¶è¿”å›å€¼ï¼šä¸ºtrueï¼Œé‚£ä¹ˆ Handler çš„ <code>handleMessage(msg)</code> æ–¹æ³•å°±ä¸ä¼šè¢«è°ƒç”¨äº†ï¼›ä¸ºfalseï¼Œé‚£ä¹ˆå°±æ„å‘³ç€<strong>ä¸€ä¸ªæ¶ˆæ¯å¯ä»¥åŒæ—¶è¢« Callback ä»¥åŠ Handler å¤„ç†</strong>ã€‚</p><p>3ã€æœ€åï¼Œè°ƒç”¨Handlerçš„<code>handleMessage</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯</p><p>é€šè¿‡ä¸Šé¢åˆ†ææˆ‘ä»¬çŸ¥é“Handlerå¤„ç†æ¶ˆæ¯çš„é¡ºåºæ˜¯ï¼š<strong>Messageçš„Callback &gt; Handlerçš„Callback &gt; Handlerçš„<code>handleMessage</code>æ–¹æ³•</strong></p><p>ä½¿ç”¨åœºæ™¯: Hook ActivityThread.mH ï¼Œ åœ¨ ActivityThread ä¸­æœ‰ä¸ªæˆå‘˜å˜é‡ <code>mH</code> ï¼Œå®ƒæ˜¯ä¸ª Handlerï¼Œåˆæ˜¯ä¸ªæå…¶é‡è¦çš„ç±»ï¼Œå‡ ä¹æ‰€æœ‰çš„æ’ä»¶åŒ–æ¡†æ¶éƒ½ä½¿ç”¨äº†è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="16ã€Handleré˜»å¡å”¤é†’æœºåˆ¶æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ"><a href="#16ã€Handleré˜»å¡å”¤é†’æœºåˆ¶æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ" class="headerlink" title="16ã€Handleré˜»å¡å”¤é†’æœºåˆ¶æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ"></a>16ã€Handleré˜»å¡å”¤é†’æœºåˆ¶æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ</h3><p>ç­”ï¼š Handlerçš„é˜»å¡å”¤é†’æœºåˆ¶æ˜¯åŸºäºLinuxçš„é˜»å¡å”¤é†’æœºåˆ¶ã€‚</p><p>è¿™ä¸ªæœºåˆ¶ä¹Ÿæ˜¯ç±»ä¼¼äºhandleræœºåˆ¶çš„æ¨¡å¼ã€‚åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶åéœ€è¦ç­‰å¾…çš„ä¸€æ–¹åˆ™ç›‘å¬è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå”¤é†’çš„ä¸€æ–¹åªéœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆç­‰å¾…çš„ä¸€æ–¹å°±ä¼šæ”¶åˆ°æ–‡ä»¶ä»è€Œæ‰“ç ´å”¤é†’ã€‚å’ŒLooperç›‘å¬MessageQueueï¼ŒHandleræ·»åŠ messageæ˜¯æ¯”è¾ƒç±»ä¼¼çš„ã€‚å…·ä½“çš„Linuxå±‚çŸ¥è¯†è¯»è€…å¯é€šè¿‡è¿™ç¯‡æ–‡ç« è¯¦ç»†äº†è§£ï¼ˆ<a href="https://mp.weixin.qq.com/s/Ylc5mPwMzWoK2CIthZy0Vw">ä¼ é€é—¨</a>ï¼‰</p><h3 id="17ã€ä»€ä¹ˆæ˜¯Handlerçš„åŒæ­¥å±éšœï¼Ÿ"><a href="#17ã€ä»€ä¹ˆæ˜¯Handlerçš„åŒæ­¥å±éšœï¼Ÿ" class="headerlink" title="17ã€ä»€ä¹ˆæ˜¯Handlerçš„åŒæ­¥å±éšœï¼Ÿ"></a>17ã€ä»€ä¹ˆæ˜¯Handlerçš„åŒæ­¥å±éšœï¼Ÿ</h3><p>ç­”: åŒæ­¥å±éšœæ˜¯ä¸€ç§ä½¿å¾—å¼‚æ­¥æ¶ˆæ¯å¯ä»¥è¢«æ›´å¿«å¤„ç†çš„æœºåˆ¶</p><h3 id="18ã€èƒ½ä¸èƒ½è®©ä¸€ä¸ªMessageè¢«åŠ æ€¥å¤„ç†ï¼Ÿ"><a href="#18ã€èƒ½ä¸èƒ½è®©ä¸€ä¸ªMessageè¢«åŠ æ€¥å¤„ç†ï¼Ÿ" class="headerlink" title="18ã€èƒ½ä¸èƒ½è®©ä¸€ä¸ªMessageè¢«åŠ æ€¥å¤„ç†ï¼Ÿ"></a>18ã€èƒ½ä¸èƒ½è®©ä¸€ä¸ªMessageè¢«åŠ æ€¥å¤„ç†ï¼Ÿ</h3><p>ç­”ï¼šå¯ä»¥ï¼Œæ·»åŠ åŠ åŒæ­¥å±éšœï¼Œå¹¶å‘é€å¼‚æ­¥æ¶ˆæ¯</p><h3 id="19ã€ä»€ä¹ˆæ˜¯IdleHandlerï¼Ÿ"><a href="#19ã€ä»€ä¹ˆæ˜¯IdleHandlerï¼Ÿ" class="headerlink" title="19ã€ä»€ä¹ˆæ˜¯IdleHandlerï¼Ÿ"></a>19ã€ä»€ä¹ˆæ˜¯IdleHandlerï¼Ÿ</h3><p>ç­”: IdleHandleræ˜¯MessageQueueä¸­ä¸€ä¸ªé™æ€å‡½æ•°å‹æ¥å£ï¼Œå®ƒåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ‰€æœ‰çš„Viewäº‹åŠ¡åï¼Œå›è°ƒä¸€äº›é¢å¤–çš„æ“ä½œï¼Œä¸”ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Handleræ¶ˆæ¯æœºåˆ¶åœ¨Androidç³»ç»Ÿæºç ä¸­è¿›è¡Œäº†å¤§é‡çš„ä½¿ç”¨ï¼Œå¯ä»¥è¯´æ˜¯æ¶‰åŠäº†Androidçš„æ–¹æ–¹é¢é¢ï¼Œæ¯”å¦‚æˆ‘ä»¬å››å¤§ç»„ä»¶çš„å¯åŠ¨ï¼ŒApplicationçš„åˆ›å»ºç­‰ç­‰ï¼Œå­¦å¥½Handlerç›¸å…³çš„çŸ¥è¯†ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„å»é˜…è¯»Androidæºç ï¼Œè€Œä¸”Handleråœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç›´æ¥æˆ–é—´æ¥çš„ä¼šè¢«ç”¨åˆ°ã€‚åŒæ—¶é€šè¿‡å¯¹Handleræºç çš„å­¦ä¹ ï¼Œè®©æˆ‘æ„Ÿå—åˆ°äº†ä»£ç è®¾è®¡çš„èƒŒåï¼Œè•´è—ç€å·¥ç¨‹å¸ˆå¤§é‡çš„æ™ºæ…§ï¼Œå¿ƒé‡Œç›´å‘¼666ï¼Œå“ˆå“ˆã€‚</p><p>åˆ°äº†è¿™é‡Œï¼Œå…³äºHandlerç›¸å…³çš„çŸ¥è¯†å°±éƒ½è®²å®Œäº†ï¼Œå¦‚æœä½ è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè¯„è®ºåŒºå‘Šè¯‰æˆ‘å§ã€‚</p><h2 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h2><p><a href="https://juejin.cn/post/6887933281686421518">Androidå…¨é¢è§£æä¹‹Handleræœºåˆ¶ï¼ˆç»ˆç¯‡ï¼‰ï¼šå¸¸è§é—®é¢˜æ±‡æ€»</a></p><p><a href="https://juejin.cn/post/6844903783139393550">Handler éƒ½æ²¡ææ‡‚ï¼Œæ‹¿ä»€ä¹ˆå»è·³æ§½å•Šï¼Ÿ</a></p><p><a href="https://juejin.cn/post/6844904150140977165#heading-22">æ¢ä¸ªå§¿åŠ¿ï¼Œå¸¦ç€é—®é¢˜çœ‹Handler</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šHandleræ¶ˆæ¯æœºåˆ¶å®Œå…¨è§£æ</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AHandler%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9AHandler%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>Handlerç³»åˆ—æ–‡ç« å…±ä¸¤ç¯‡ï¼š</p><p>ç¬¬ä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/6924084444609544199#heading-5">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—: Handleræ¶ˆæ¯æœºåˆ¶å®Œå…¨è§£æ</a></p><p>ç¬¬äºŒç¯‡ï¼š <a href="https://juejin.cn/post/6932608660354891790/">â€œä¸€ç¯‡å°±å¤Ÿâ€ç³»åˆ—: Handleræ‰©å±•ç¯‡</a></p></blockquote><p>å…³äºHandlerï¼Œæƒ³å¿…å¤§å®¶éƒ½å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œå®ƒæ˜¯Androidä¸­éå¸¸åŸºç¡€ï¼Œä½†åŒæ—¶ä¹Ÿæå…¶é‡è¦çš„æ¶ˆæ¯æœºåˆ¶ï¼Œè¯´å®ƒåŸºç¡€ï¼Œæ˜¯å› ä¸ºå®ƒä½¿ç”¨ç®€å•ï¼Œåœ¨æˆ‘ä»¬ä¸€å¼€å§‹å­¦ä¹ Androidæ—¶ï¼Œå°±ä¼šæ¥è§¦åˆ°Handlerï¼Œç”¨å®ƒæ¥è¿›è¡Œçº¿ç¨‹é—´çš„é€šä¿¡ã€‚è¯´å®ƒæå…¶é‡è¦ï¼Œæ˜¯å› ä¸ºå®ƒåœ¨Androidç³»ç»Ÿä¸­æ‰®æ¼”äº†ä¸€ä¸ªæå…¶æ ¸å¿ƒçš„è§’è‰²ï¼Œå¯ä»¥è¯´åªè¦æœ‰å¼‚æ­¥é€šä¿¡çš„åœ°æ–¹å°±ä¸€å®šä¼šæœ‰Handlerï¼Œæ­£æ˜¯å› ä¸ºå®ƒçš„å­˜åœ¨ï¼Œä½¿å¾—æˆ‘ä»¬Androidç³»ç»Ÿä¸­çš„å¾ˆå¤šç»„ä»¶èƒ½å¤Ÿæ­£å¸¸çš„è¿è¡Œ</p><p><strong>æ³¨æ„ï¼šæœ¬æ–‡æ‰€å±•ç¤ºçš„ç³»ç»Ÿæºç éƒ½æ˜¯åŸºäºAndroid-29 ï¼Œå¹¶æå–æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œåˆ†æ</strong></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ä¸‹é¢æˆ‘åœ¨è¿™é‡ŒæŠ›å‡ºä¸€äº›é—®é¢˜ï¼Œå¦‚æœä½ éƒ½çŸ¥é“ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ å¯¹Handleræœºåˆ¶æŒæ¡çš„å¾ˆé€å½»ï¼Œå¦‚æœä½ å¯¹ä¸‹é¢è¿™äº›é—®é¢˜æœ‰ä¸€äº›ç–‘æƒ‘ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æ¥ç€å¾€ä¸‹çœ‹ï¼Œæˆ‘ä¼šç”±æµ…å…¥æ·±çš„ç»™ä½ è®²è§£Handleræœºåˆ¶ï¼Œçœ‹å®Œä¹‹åï¼Œè¿™äº›é—®é¢˜ä½ å°±éƒ½ä¼šéå¸¸çš„æ˜äº†ï¼ŒåŒæ—¶åœ¨æœ€åæˆ‘ä¹Ÿä¼šå¯¹è¿™äº›é—®é¢˜ç»™å‡ºè‡ªå·±çš„å›ç­”</p><ol><li>Handleræœ‰å“ªäº›ä½œç”¨?</li><li>ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨ä¸»çº¿ç¨‹ç›´æ¥ä½¿ç”¨Handlerï¼Œè€Œä¸éœ€è¦åˆ›å»ºLooper?</li><li>å¦‚æœæƒ³è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œéœ€è¦åšä»€ä¹ˆå‡†å¤‡?</li><li>ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandler?</li><li>ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooper?å¦‚ä½•ä¿è¯?</li><li>ä¸ºä»€ä¹ˆLopperæ­»å¾ªç¯ï¼Œå´ä¸ä¼šå¯¼è‡´åº”ç”¨å¡æ­»?</li><li>Handlerå†…å­˜æ³„éœ²åŸå› ? å¦‚ä½•è§£å†³ï¼Ÿ</li><li>çº¿ç¨‹ç»´æŠ¤çš„Looperï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯æ—¶çš„å¤„ç†æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ?æœ‰ä»€ä¹ˆç”¨?</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªHandlerå¾€æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‘æ¶ˆæ¯çš„Handlerå­˜åœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œé‚£ä¹ˆHandleræ˜¯å¦‚ä½•ä¿è¯MessageQueueå¹¶å‘è®¿é—®å®‰å…¨çš„å‘¢ï¼Ÿ</li><li>Handleræ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹åˆ‡æ¢çš„å‘¢ï¼Ÿ</li><li>æˆ‘ä»¬åœ¨ä½¿ç”¨Messageçš„æ—¶å€™,åº”è¯¥å¦‚ä½•å»åˆ›å»ºå®ƒï¼Ÿ</li><li>Handleré‡Œé¢è—ç€çš„CallBackèƒ½åšä»€ä¹ˆï¼Ÿ</li><li>Handleré˜»å¡å”¤é†’æœºåˆ¶æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ</li><li>ä»€ä¹ˆæ˜¯Handlerçš„åŒæ­¥å±éšœï¼Ÿ</li><li>èƒ½ä¸èƒ½è®©ä¸€ä¸ªMessageè¢«åŠ æ€¥å¤„ç†ï¼Ÿ</li></ol><h2 id="ä»€ä¹ˆæ˜¯Handler"><a href="#ä»€ä¹ˆæ˜¯Handler" class="headerlink" title="ä»€ä¹ˆæ˜¯Handler?"></a>ä»€ä¹ˆæ˜¯Handler?</h2><p>æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„Handlerï¼Œä»–å…¶å®æ˜¯Handleræœºåˆ¶ä¸­çš„ä¸€ä¸ªè§’è‰²ï¼Œåªä¸è¿‡æˆ‘ä»¬å¯¹Handleræ¥è§¦æ¯”è¾ƒå¤šï¼Œå› æ­¤ç”¨Handleræ¥ä»£ç§°</p><p><strong>Handleræœºåˆ¶æ˜¯Androidä¸­åŸºäºå•çº¿æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å¼çš„ä¸€å¥—çº¿ç¨‹æ¶ˆæ¯æœºåˆ¶ã€‚</strong></p><h2 id="HandleråŸºæœ¬ç”¨æ³•"><a href="#HandleråŸºæœ¬ç”¨æ³•" class="headerlink" title="HandleråŸºæœ¬ç”¨æ³•"></a>HandleråŸºæœ¬ç”¨æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åœ¨ä¸»çº¿ç¨‹åˆ›å»ºHandlerå®ä¾‹</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>            <span class="hljs-comment">//å¤„ç†æ¥æ”¶çš„æ¶ˆæ¯</span><br>        &#125;<br>    &#125;;<br><br><span class="hljs-comment">//åœ¨é€‚å½“çš„æ—¶æœºä½¿ç”¨Handlerå®ä¾‹å‘é€æ¶ˆæ¯</span><br>mHandler.sendMessage(message);<br>mHandler.post(runnable);<span class="hljs-comment">//Runnableä¼šè¢«å°è£…è¿›ä¸€ä¸ªMessageï¼Œæ‰€ä»¥å®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªMessage</span><br></code></pre></td></tr></table></figure><p>çœ‹ä¸Šé¢è¿™æ®µä»£ç ï¼Œåˆ›å»ºäº†ä¸€ä¸ªHandlerå®ä¾‹å¹¶é‡å†™äº† <code>handleMessage</code> æ–¹æ³• ï¼Œç„¶ååœ¨é€‚å½“çš„æ—¶æœºè°ƒç”¨å®ƒçš„ <code>send</code> æˆ–è€… <code>post</code> ç³»åˆ—æ–¹æ³•å°±å¯ä»¥äº†ï¼Œä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹é—´çš„é€šä¿¡çš„å‘¢? ä¸‹é¢æˆ‘ä»¬å°±éœ€è¦å¯¹æºç è¿›è¡Œåˆ†æ</p><h2 id="Handleræœºåˆ¶æºç åˆ†æ"><a href="#Handleræœºåˆ¶æºç åˆ†æ" class="headerlink" title="Handleræœºåˆ¶æºç åˆ†æ"></a>Handleræœºåˆ¶æºç åˆ†æ</h2><p>åœ¨åˆ†ææºç ä¹‹å‰,æˆ‘å…ˆè®²ä¸‹Handleræœºåˆ¶æ¶‰åŠçš„å‡ å¤§è§’è‰²: <strong>Handler,Looper,MessageQueue,Message</strong></p><p>å…ˆæå‰ä»‹ç»ä¸‹è¿™å‡ ä¸ªè§’è‰²çš„ä½œç”¨,ä¾¿äºåç»­åˆ†ææºç çš„ä¸€ä¸ªç†è§£</p><p><strong>Handler</strong>: å‘é€æ¶ˆæ¯å’Œå¤„ç†æ¶ˆæ¯</p><p><strong>Looper</strong>: ä»MessageQueueä¸­è·å–Messageï¼Œç„¶åäº¤ç»™Handlerå¤„ç†</p><p><strong>MessageQueue</strong>: æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå­˜æ”¾Handlerå‘é€è¿‡æ¥çš„æ¶ˆæ¯</p><p><strong>Message</strong>: æ¶ˆæ¯çš„è½½ä½“</p><p>ä¸‹é¢æˆ‘ä»¬å¼€å§‹è¿›è¡Œæºç åˆ†æï¼Œåœ¨æˆ‘ä»¬ä¸€å¼€å§‹ä½¿ç”¨çš„æ—¶å€™ï¼Œåˆ›å»ºäº†ä¸€ä¸ªHandlerå®ä¾‹ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸‹å®ƒå®ä¾‹åŒ–çš„è¿™ä¸ªæ„é€ æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">()</span> &#123;<br>     <span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒå…¶å®æ˜¯è°ƒç”¨äº†å®ƒçš„ä¸€ä¸ªé‡è½½çš„æ–¹æ³•,æ¥ç€çœ‹å®ƒçš„é‡è½½æ–¹æ³•</p><p><strong>æ³¨æ„:</strong> </p><ol><li>Handlerçš„æ„é€ æ–¹æ³•ä¸­è¿˜å¯ä»¥ä¼ å…¥Looperï¼Œé€šè¿‡ä¼ å…¥Looperçš„æ„é€ æ–¹æ³•å¯ä»¥å®ç°ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½</li><li>Handlerçš„æ„é€ æ–¹æ³•ä¸­è¿˜å¯ä»¥ä¼ å…¥Callbackï¼Œè¿™ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªHandlerçš„å®ä¾‹ï¼Œå®ƒå¹¶ä¸éœ€è¦æ´¾ç”Ÿå‡ºä¸€ä¸ªå­ç±»ï¼Œåé¢æˆ‘ä¹Ÿä¼šä»‹ç»åˆ°</li><li>æœ‰äº›æ„é€ æ–¹æ³•ä½¿ç”¨äº†<code>@UnsupportedAppUsage</code>æ³¨è§£ï¼Œè¡¨ç¤ºä¸æ”¯æŒå¤–éƒ¨åº”ç”¨è°ƒç”¨</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Callback callback, <span class="hljs-type">boolean</span> async)</span> &#123;<br>  <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">//è·å–å½“å‰çº¿ç¨‹çš„Lopper</span><br>    mLooper = Looper.myLooper();<br>    <span class="hljs-comment">//å¦‚æœå½“å‰Looperä¸ºç©º,åˆ™æŠ›å‡ºå¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (mLooper == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<br>            <span class="hljs-string">&quot;Can&#x27;t create handler inside thread &quot;</span> + Thread.currentThread()<br>                    + <span class="hljs-string">&quot; that has not called Looper.prepare()&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//å°†å½“å‰Lopperä¸­çš„MessageQueueèµ‹å€¼ç»™Handlerä¸­çš„MessageQueue</span><br>    mQueue = mLooper.mQueue;<br>    <span class="hljs-comment">//...</span><br> &#125;<br><br><span class="hljs-comment">//---------------------ä»¥ä¸‹ä¸ºé¢å¤–æ‰©å±•å†…å®¹--------------------------</span><br><span class="hljs-comment">//ä¼ å…¥Looperçš„æ„é€ æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Looper looper)</span> &#123;<br>    <span class="hljs-built_in">this</span>(looper, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);<br>&#125;<br><br><span class="hljs-comment">//ä¼ å…¥Callbackçš„æ„é€ æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Callback callback)</span> &#123;<br>    <span class="hljs-built_in">this</span>(callback, <span class="hljs-literal">false</span>);<br>&#125;<br><br><span class="hljs-comment">//ä½¿ç”¨äº†@UnsupportedAppUsageæ³¨è§£çš„æ„é€ æ–¹æ³•</span><br><span class="hljs-meta">@UnsupportedAppUsage</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Handler</span><span class="hljs-params">(<span class="hljs-type">boolean</span> async)</span> &#123;<br>    <span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, async);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç æ³¨é‡Šå†™çš„å¾ˆæ¸…æ¥šï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å°±å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š <strong>æˆ‘ä»¬åœ¨åˆ›å»ºHandlerå®ä¾‹çš„æ—¶å€™ï¼Œä¸€å®šè¦å…ˆåˆ›å»ºä¸€ä¸ªLopperï¼Œå¹¶å¼€å¯å¾ªç¯è¯»å–æ¶ˆæ¯</strong>ï¼Œé‚£ä¹ˆå¤§å®¶è‚¯å®šæœ‰ä¸ªç–‘é—®ï¼Ÿ ä½ ä¸Šé¢çš„ä½¿ç”¨å°±æ²¡æœ‰åˆ›å»ºLopperï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬çš„ä¸»çº¿ç¨‹å·²ç»ç»™æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªLopper</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰¾ä¸‹ä¸»çº¿ç¨‹çš„è¿™ä¸ªLopperæ˜¯åœ¨å“ªé‡Œåˆ›å»ºçš„ï¼Œæˆ‘ä»¬æ‰¾åˆ°ActivityThreadçš„main()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>  <span class="hljs-comment">//...</span><br> <span class="hljs-comment">//åˆ›å»ºLopper</span><br>  Looper.prepareMainLooper();<br>  <br>  <span class="hljs-type">ActivityThread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActivityThread</span>();<br>  thread.attach(<span class="hljs-literal">false</span>);<br><br>  <span class="hljs-keyword">if</span> (sMainThreadHandler == <span class="hljs-literal">null</span>) &#123;<br>    sMainThreadHandler = thread.getHandler();<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//å¼€å¯å¾ªç¯è¯»å–æ¶ˆæ¯</span><br>  Looper.loop();<br><span class="hljs-comment">//Looperå¦‚æœå› å¼‚å¸¸åŸå› åœæ­¢å¾ªç¯åˆ™æŠ›å¼‚å¸¸</span><br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Main thread loop unexpectedly exited&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šé€šå¸¸æˆ‘ä»¬è®¤ä¸º ActivityThread å°±æ˜¯ä¸»çº¿ç¨‹ã€‚äº‹å®ä¸Šå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯ä¸»çº¿ç¨‹æ“ä½œçš„ç®¡ç†è€…ï¼Œæ‰€ä»¥ä»¬æŠŠ ActivityThread è®¤ä¸ºå°±æ˜¯ä¸»çº¿ç¨‹æ— å¯åšéï¼Œå¦å¤–ä¸»çº¿ç¨‹ä¹Ÿå¯ä»¥è¯´æˆ UI çº¿ç¨‹ã€‚</strong></p><p>æˆ‘ä»¬åœ¨ ActivityThreadé‡Œçš„<code>main</code>æ–¹æ³•é‡Œè°ƒç”¨äº†Looper.prepareMainLooper() æ–¹æ³•åˆ›å»ºäº†ä¸»çº¿ç¨‹çš„Looper ï¼Œå¹¶ä¸”è°ƒç”¨äº†<code>loop</code>æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ Handler</p><p>ç»§ç»­åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“main()æ–¹æ³•æ˜¯Javaç¨‹åºçš„å…¥å£ï¼ŒåŒæ—¶ä¹Ÿæ˜¯Androidåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œè€Œåœ¨Javaä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œå®Œmain()æ–¹æ³•ï¼Œé©¬ä¸Šå°±é€€å‡ºäº†ï¼Œè€Œåœ¨Androidä¸­ï¼Œä¸ºå•¥æ²¡æœ‰é€€å‡ºå‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬åšä¸ªå‡è®¾ï¼Œå¦‚æœåœ¨Androidä¸­ä¹Ÿé€€å‡ºäº†ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯Androidå°±æ²¡å¾—ç©äº†ï¼Œæ‰€ä»¥Googleè‚¯å®šæ˜¯ä¸èƒ½è®©ä»–é€€å‡ºçš„ï¼Œä¹‹æ‰€ä»¥åœ¨Androidä¸­æ²¡æœ‰é€€å‡ºï¼Œæ­£æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œåˆ›å»ºå¹¶å¼€å¯äº†Looperæ­»å¾ªç¯ï¼Œä»–ä¼šå¾ªç¯æ‰§è¡Œå„ç§äº‹ç‰©ã€‚Looperæ­»å¾ªç¯è¯´æ˜çº¿ç¨‹æ²¡æœ‰æ­»äº¡ï¼Œå¦‚æœLooperåœæ­¢å¾ªç¯ï¼Œçº¿ç¨‹åˆ™ç»“æŸé€€å‡ºäº†</p><p>é‚£ä¹ˆå¤§å®¶æ˜¯ä¸æ˜¯åˆä¼šæœ‰ä¸ªç–‘é—®ï¼Ÿæ—¢ç„¶æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œé‚£ä¸ºå•¥ä¸ä¼šé€ æˆANRï¼Ÿ</p><p>å…¶å®Lopperæ­»å¾ªç¯å’Œç¨‹åºANRæ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè¿™é‡Œæ„Ÿè§‰å°±æ˜¯åœ¨è¿›è¡Œä¸€ä¸ªæ¦‚å¿µçš„æ··æ·†ï¼Œè¿™é‡Œæˆ‘è§£é‡Šä¸€ä¸‹è¿™ä¸¤ä¸ªæ¦‚å¿µ</p><p>ANR: å…¨ç§°Applicationn Not Respondingï¼Œä¸­æ–‡æ„æ€æ˜¯åº”ç”¨æ— å“åº”ï¼Œå½“æˆ‘å‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ï¼Œç»è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰è¢«æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šæŠ›å‡ºANRå¼‚å¸¸</p><p>Lopperæ­»å¾ªç¯: å¾ªç¯æ‰§è¡Œå„ç§äº‹åŠ¡ï¼Œå½“Looperå¤„ç†å®Œæ‰€æœ‰æ¶ˆæ¯çš„æ—¶å€™ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå½“æœ‰æ–°çš„Messageè¿›æ¥çš„æ—¶å€™ä¼šæ‰“ç ´é˜»å¡ç»§ç»­æ‰§è¡Œ</p><p>åˆ°äº†è¿™é‡Œï¼Œç›¸ä¿¡å¤§å®¶å¯¹äºåˆ›å»ºHandlerå·²ç»å¾ˆæ˜äº†äº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å®é™…åº”ç”¨ä¸€ä¸‹ï¼Œåœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>    <span class="hljs-keyword">public</span> Handler mHandler;<br> <br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            Looper.prepare();<br>            mHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br><span class="hljs-comment">//å¤„ç†æ¥æ”¶çš„æ¶ˆæ¯</span><br>                &#125;<br>            &#125;;<br>            Looper.loop();<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¥½ï¼Œåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬åº”è¯¥å¯¹<strong>åˆ›å»ºHandlerå®ä¾‹çš„æ—¶å€™,ä¸€å®šè¦å…ˆåˆ›å»ºä¸€ä¸ªLopperï¼Œå¹¶å¼€å¯å¾ªç¯è¯»å–æ¶ˆæ¯</strong>ï¼Œæœ‰äº†æ·±åˆ»çš„ç†è§£ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†ææºç </p><p>ä¸Šé¢è¯´äº†åˆ›å»ºHandlerå®ä¾‹ä¹‹å‰è¦å…ˆåˆ›å»ºLooperå¹¶å¼€å¯å¾ªç¯ï¼Œé‚£æˆ‘ä»¬åˆ†æä¸‹åˆ›å»ºLopperå¹¶å¼€å¯å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œå…ˆçœ‹ä¸‹ActivityThreadé‡Œçš„<code>main</code>æ–¹æ³•é‡Œè°ƒç”¨çš„Looper.prepareMainLooper()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prepareMainLooper</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-comment">//åˆ›å»ºLooper,å‚æ•°falseè¡¨ç¤ºè¯¥Looperä¸èƒ½é€€å‡º</span><br>    prepare(<span class="hljs-literal">false</span>);<br>  <span class="hljs-comment">//æ·»åŠ åŒæ­¥é”</span><br>    <span class="hljs-keyword">synchronized</span> (Looper.class) &#123;<br>      <span class="hljs-comment">//å¦‚æœå½“å‰sMainLooperå·²ç»å­˜åœ¨,åˆ™æŠ›å¼‚å¸¸</span><br>        <span class="hljs-keyword">if</span> (sMainLooper != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;The main Looper has already been prepared.&quot;</span>);<br>        &#125;<br>      <span class="hljs-comment">//å°†å½“å‰çº¿ç¨‹çš„Looperå®ä¾‹èµ‹å€¼ç»™sMainLooper</span><br>        sMainLooper = myLooper();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šä¸»è¦æ˜¯è°ƒç”¨äº†å¦å¤–ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨çœ‹ä¸‹prepare(false)å’ŒmyLooper()æ–¹æ³•çš„å†…éƒ¨å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prepare</span><span class="hljs-params">(<span class="hljs-type">boolean</span> quitAllowed)</span> &#123;<br>   <span class="hljs-comment">//é€šè¿‡sThreadLocalè·å–å½“å‰Looperå®ä¾‹,å¦‚æœå½“å‰Lopperå®ä¾‹ä¸ä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸</span><br>     <span class="hljs-keyword">if</span> (sThreadLocal.get() != <span class="hljs-literal">null</span>) &#123;<br>         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Only one Looper may be created per thread&quot;</span>);<br>     &#125;<br>   <span class="hljs-comment">//å°†newå‡ºæ¥çš„Looperå®ä¾‹è®¾ç½®ç»™sThreadLocal</span><br>     sThreadLocal.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Looper</span>(quitAllowed));<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-meta">@Nullable</span> Looper <span class="hljs-title function_">myLooper</span><span class="hljs-params">()</span> &#123;<br>   <span class="hljs-comment">//é€šè¿‡sThreadLocalè·å–Looperå®ä¾‹å¯¹è±¡</span><br>     <span class="hljs-keyword">return</span> sThreadLocal.get();<br>&#125;<br></code></pre></td></tr></table></figure><p><code>prepare</code>æ–¹æ³•: newä¸€ä¸ªLooperè®¾ç½®ç»™sThreadLocal. <code>myLooper</code>æ–¹æ³•: é€šè¿‡sThreadLocalè·å–Looper. ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯ä¼šå¯¹è¿™ä¸ªsThreadLocalå¾ˆå¥½å¥‡ï¼Œè¿™ä¸ªä¸œè¥¿æœ‰å•¥ä½œç”¨ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•å¯ä»¥æ¨æ–­å‡º: sThreadLocalæ˜¯ç”¨æ¥å­˜æ”¾Looperçš„</p><h3 id="ThreadLocalä»‹ç»"><a href="#ThreadLocalä»‹ç»" class="headerlink" title="ThreadLocalä»‹ç»"></a>ThreadLocalä»‹ç»</h3><p><strong>ThreadLocalæ˜¯Javaä¸­ä¸€ä¸ªç”¨äºçº¿ç¨‹å†…éƒ¨å­˜å‚¨æ•°æ®çš„å·¥å…·ç±»</strong></p><p>çœ‹ä¸‹é¢è¿™ä¸€æ®µä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>     ThreadLocal&lt;Boolean&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();<br>     threadLocal.set(<span class="hljs-literal">true</span>);<br>     <span class="hljs-type">Boolean</span> <span class="hljs-variable">aBoolean</span> <span class="hljs-operator">=</span> threadLocal.get();<br>     System.out.println(<span class="hljs-string">&quot;Current Thread &quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;: &quot;</span> + aBoolean);<br> <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹å‘½åä¸ºa</span><br>     <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-string">&quot;a&quot;</span>)&#123;<br>         <span class="hljs-meta">@Override</span><br>          <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>              threadLocal.set(<span class="hljs-literal">false</span>);<br>              <span class="hljs-type">Boolean</span> <span class="hljs-variable">bBoolean</span> <span class="hljs-operator">=</span> threadLocal.get();<br>              System.out.println(<span class="hljs-string">&quot;Current Thread &quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;: &quot;</span> + bBoolean);<br>          &#125;<br>     &#125;.start();<br> <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹å‘½åä¸ºb</span><br>     <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-string">&quot;b&quot;</span>)&#123;<br>         <span class="hljs-meta">@Override</span><br>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123; ;<br>             <span class="hljs-type">Boolean</span> <span class="hljs-variable">cBoolean</span> <span class="hljs-operator">=</span> threadLocal.get();<br>             System.out.println(<span class="hljs-string">&quot;Current Thread &quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;: &quot;</span> + cBoolean);<br>         &#125;<br>     &#125;.start();<br> &#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ:</span><br>Current Thread main: <span class="hljs-literal">true</span><br>Current Thread a: <span class="hljs-literal">false</span><br>Current Thread b: <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç : </p><ol><li>åœ¨ä¸»çº¿ç¨‹åˆ›å»ºäº†ä¸€ä¸ªthreadLocalå˜é‡ï¼Œå¹¶è°ƒç”¨<code>set</code>æ–¹æ³•è®¾ç½®ä¸ºtrueï¼Œç„¶åè·å–è¯¥å€¼å¹¶æ‰“å°</li><li>åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨<code>set</code>æ–¹æ³•è®¾ç½®å€¼ä¸ºfalseï¼Œè·å–è·å–è¯¥å€¼å¹¶æ‰“å°</li><li>åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œè·å–è¯¥å€¼å¹¶æ‰“å°</li></ol><p>ä»ä¸Šé¢çš„æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­è®¿é—®åŒä¸€ä¸ªthreadLocalå¯¹è±¡ï¼Œä½†æ˜¯å®ƒä»¬é€šè¿‡ThreadLocalè·å–çš„å€¼å´æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ThreadLocalçš„å¥‡å¦™ä¹‹å¤„ï¼Œè¿™é‡Œæˆ‘åˆæƒ³é—®ä¸€å¥,ä¸ºä»€ä¹ˆ? å‡¡äº‹å¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼ŒçŸ¥è¯†åŸç†å°±å­¦åˆ°æ‰‹äº†ï¼Œå“ˆå“ˆğŸ˜„ï¼Œæˆ‘ä»¬ç‚¹è¿›å»ThreadLocalçš„<code>set</code>æ–¹æ³•çœ‹ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(T value)</span> &#123;<br>  <span class="hljs-comment">//è·å–å½“å‰çº¿ç¨‹</span><br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>  <span class="hljs-comment">//è·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMap</span><br>    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);<br>    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>)<br>      <span class="hljs-comment">//å¦‚æœmapä¸ä¸ºç©º,åˆ™å°†å½“å‰çš„ThreadLocalå˜é‡ä½œä¸ºkey,ä¼ è¿›æ¥çš„æ³›å‹ä½œä¸ºvalueè¿›è¡Œå­˜å‚¨</span><br>        map.set(<span class="hljs-built_in">this</span>, value);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-comment">//å¦‚æœmapä¸ºç©º,åˆ™ä¼šåˆ›å»ºmap,å°†å½“å‰çš„ThreadLocalå˜é‡ä½œä¸ºkey,ä¼ è¿›æ¥çš„æ³›å‹ä½œä¸ºvalueè¿›è¡Œå­˜å‚¨</span><br>        createMap(t, value);<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢ä»£ç æˆ‘ä»¬çŸ¥é“ï¼Œé€šè¿‡è·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMapï¼Œåœ¨æŠŠThreadLocalå˜é‡ä½œä¸ºkeyï¼Œä¼ è¿›æ¥çš„æ³›å‹ä½œä¸ºvalueè¿›è¡Œå­˜å‚¨</p><p><strong>ThreadLocalMap</strong>å®ƒæ˜¯ThreadLocalé‡Œé¢çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå®ƒç±»ä¼¼äºä¸€ä¸ªæ”¹ç‰ˆçš„HashMapï¼Œå†…éƒ¨ä¹Ÿæ˜¯ä½¿ç”¨æ•°ç»„å’ŒHashç®—æ³•æ¥å­˜å‚¨æ•°æ®ï¼Œä½¿å¾—å­˜å‚¨å’Œè¯»å–çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨HashMapçš„æ€æƒ³å»ç†è§£ThreadLocalMapå°±å¥½äº†ï¼Œå¦‚æœå¯¹ThreadLocalMapå·¥ä½œåŸç†æ„Ÿå…´è¶£çš„ï¼Œå¯ä»¥é˜…è¯»è¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6844904141890781192">ä¼ é€é—¨</a></p><p>åœ¨çœ‹ä¸‹<code>get</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);<br>    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) &#123;<br>        ThreadLocalMap.<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> map.getEntry(<span class="hljs-built_in">this</span>);<br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>            <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> (T)e.value;<br>            <span class="hljs-keyword">return</span> result;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> setInitialValue();<br>&#125;<br></code></pre></td></tr></table></figure><p>è·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMapï¼Œå‰é¢è®²åˆ°ThreadLocalMapå…¶å®éå¸¸åƒä¸€ä¸ªHashMapï¼Œä»–çš„getæ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨ThreadLocalä½œä¸ºkeyè·å–åˆ°å¯¹åº”çš„Entryï¼Œå†æŠŠvalueè¿”å›å³å¯ï¼Œå¦‚æœmapå°šæœªåˆå§‹åŒ–åˆ™ä¼šæ‰§è¡Œåˆå§‹åŒ–æ“ä½œ</p><p>å› æ­¤æˆ‘ä»¬æ˜¯å¦å¯ä»¥å¾—åˆ°ç»“è®º:</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/88a4d99892f746b988d2f88a1e44a2f9~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210201082013061"></p><p>ThreadLocalä¼šä»å„è‡ªçš„çº¿ç¨‹ï¼Œå–å‡ºè‡ªå·±ç»´æŠ¤çš„ThreadLocalMapï¼Œå…¶keyä¸ºThreadLocalï¼Œvalueä¸ºThreadLocalå¯¹åº”çš„æ³›å‹å¯¹è±¡ï¼Œè¿™æ ·æ¯ä¸ªThreadLocalå°±å¯ä»¥æŠŠè‡ªå·±ä½œä¸ºkeyæŠŠä¸åŒçš„valueå­˜å‚¨åœ¨ä¸åŒçš„ThreadLocalMapï¼Œå½“è·å–æ•°æ®çš„æ—¶å€™ï¼ŒåŒä¸ªThreadLocalå°±å¯ä»¥ä»ä¸åŒçº¿ç¨‹çš„ThreadLocalMapä¸­å¾—åˆ°ä¸åŒçš„æ•°æ®ã€‚å› æ­¤å½“æˆ‘ä»¬ä»¥çº¿ç¨‹ä½œä¸ºä½œç”¨åŸŸï¼Œå¹¶ä¸”ä¸åŒçº¿ç¨‹éœ€è¦å…·æœ‰ä¸åŒæ•°æ®å‰¯æœ¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ThreadLocalã€‚è€ŒLooperæ­£å¥½é€‚ç”¨äºè¿™ç§åœºæ™¯</p><h3 id="Looperä»‹ç»"><a href="#Looperä»‹ç»" class="headerlink" title="Looperä»‹ç»"></a>Looperä»‹ç»</h3><p>ä¸Šé¢æˆ‘ä»¬åˆ†æåˆ°Looperä½¿ç”¨ThreadLocalæ¥ä¿è¯æ¯ä¸ªçº¿ç¨‹æœ‰ä¸”åªæœ‰ä¸€ä¸ªç›¸åŒçš„å‰¯æœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®º: <strong>ä¸€ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªLooper</strong>ï¼Œè¿™ä¸ªç»“è®ºéå¸¸çš„é‡è¦ï¼ŒHandleræœºåˆ¶ä¹‹æ‰€ä»¥èƒ½å¤Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œå°±æ˜¯å› ä¸ºä½¿ç”¨äº†ä¸åŒçº¿ç¨‹çš„Looperå¤„ç†æ¶ˆæ¯ï¼Œä¸¾ä¸ªä¾‹å­: æˆ‘åœ¨çº¿ç¨‹Aåˆ›å»ºäº†å‡ ä¸ªHanlderå®ä¾‹å¤„ç†æ¶ˆæ¯ï¼Œé‚£æˆ‘é¦–å…ˆå°±è¦åˆ›å»ºAçº¿ç¨‹çš„Looperå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯ï¼Œé‚£ä¹ˆæˆ‘ä¸ç®¡ä½ è¿™äº›Hanlderçš„å®ä¾‹ä»é‚£ä¸ªçº¿ç¨‹å‘é€æ¶ˆæ¯è¿‡æ¥ï¼Œæœ€ç»ˆéƒ½ä¼šå›åˆ°æˆ‘Açº¿ç¨‹çš„MessageQueueä¸­ï¼Œç„¶åé€šè¿‡Açº¿ç¨‹Looperä¸æ–­è¯»å–æ¶ˆæ¯ï¼Œåœ¨äº¤ç»™å½“å‰Açº¿ç¨‹çš„Handleræ¥å¤„ç†</p><p>Looperå¯ä»¥è¯´æ˜¯Handleræœºåˆ¶ä¸­çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ ¸å¿ƒã€‚Looperç›¸å½“äºçº¿ç¨‹æ¶ˆæ¯æœºåˆ¶çš„å¼•æ“ï¼Œé©±åŠ¨æ•´ä¸ªæ¶ˆæ¯æœºåˆ¶è¿è¡Œã€‚Looperè´Ÿè´£ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ï¼Œç„¶åäº¤ç»™å¯¹åº”çš„Handlerå»å¤„ç†ã€‚å¦‚æœé˜Ÿåˆ—ä¸­æ²¡æœ‰æ¶ˆæ¯ï¼Œåˆ™MessageQueueçš„nextæ–¹æ³•ä¼šé˜»å¡çº¿ç¨‹ï¼Œç­‰å¾…æ–°çš„æ¶ˆæ¯çš„åˆ°æ¥ã€‚æ¯ä¸ªçº¿ç¨‹æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªâ€œå¼•æ“â€ï¼Œä¹Ÿå°±æ˜¯Looperï¼Œå¦‚æœæ²¡æœ‰Looperï¼Œé‚£ä¹ˆæ¶ˆæ¯æœºåˆ¶å°±è¿è¡Œä¸èµ·æ¥ï¼Œè€Œå¦‚æœæœ‰å¤šä¸ªLooperï¼Œåˆ™ä¼šè¿èƒŒå•çº¿æ“ä½œçš„æ¦‚å¿µï¼Œé€ æˆå¹¶å‘æ“ä½œã€‚</p><h4 id="Looperåˆ›å»º"><a href="#Looperåˆ›å»º" class="headerlink" title="Looperåˆ›å»º"></a>Looperåˆ›å»º</h4><p>åœ¨ä¸Šé¢åˆ›å»ºLooperçš„æ—¶å€™æˆ‘ä»¬åˆ†æåˆ°:</p><ol><li><p>ä¸»çº¿ç¨‹ActivityThreadåˆ›å»ºLooperï¼Œä½¿ç”¨çš„æ˜¯<code>prepareMainLooper</code>æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸ºä¸»çº¿ç¨‹é‡èº«å®šåšçš„ï¼Œç”±äºä¸»çº¿ç¨‹çš„Looperæ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€ä»¥Looperæä¾›äº†ä¸€ä¸ª<code>getMainLooper</code>æ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è·å–åˆ°ä¸»çº¿ç¨‹çš„Looperï¼Œä¸”ä¸»çº¿ç¨‹çš„Looperä¸èƒ½é€€å‡º</p></li><li><p>æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„Looperï¼Œä½¿ç”¨çš„æ˜¯<code>prepare</code>æ–¹æ³•ï¼Œå®è´¨ä¸Šå®ƒä»¬æœ€ç»ˆéƒ½ä¼šè°ƒåˆ°<code>prepare(boolean quitAllowed)</code>è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼ŒåŒºåˆ«å°±æ˜¯ä¸»çº¿ç¨‹åˆ›å»ºçš„Looperä¸èƒ½é€€å‡ºï¼Œè€Œæˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„å¯ä»¥é€€å‡º</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¸»çº¿ç¨‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prepareMainLooper</span><span class="hljs-params">()</span> &#123;<br>    prepare(<span class="hljs-literal">false</span>);<br>  <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//è·å–ä¸»çº¿ç¨‹Looper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Looper <span class="hljs-title function_">getMainLooper</span><span class="hljs-params">()</span> &#123;<br>     <span class="hljs-keyword">synchronized</span> (Looper.class) &#123;<br>     <span class="hljs-keyword">return</span> sMainLooper;<br>     &#125;<br> &#125;<br><br><span class="hljs-comment">//æˆ‘ä»¬è‡ªå·±åˆ›å»ºLooper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prepare</span><span class="hljs-params">()</span> &#123;<br>    prepare(<span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-comment">//å‚æ•°quitAllowed true: å¯é€€å‡º false: ä¸å¯é€€å‡º</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">prepare</span><span class="hljs-params">(<span class="hljs-type">boolean</span> quitAllowed)</span> &#123;<br>     <span class="hljs-keyword">if</span> (sThreadLocal.get() != <span class="hljs-literal">null</span>) &#123;<br>         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Only one Looper may be created per thread&quot;</span>);<br>     &#125;<br>     sThreadLocal.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Looper</span>(quitAllowed));<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæˆ‘åˆæœ‰ä¸ªç–‘é—®ï¼Œä¸ºå•¥Looperä¸èƒ½ç›´æ¥åœ¨å¤–éƒ¨ç»™Newå‡ºæ¥å‘¢ï¼Ÿæˆ‘ä»¬ç‚¹å‡»å»Looperçš„æ„é€ æ–¹æ³•çœ‹ä¸€ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-title function_">Looper</span><span class="hljs-params">(<span class="hljs-type">boolean</span> quitAllowed)</span> &#123;<br>   <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªMessageQueue,èµ‹å€¼ç»™å½“å‰Looperçš„mQueue</span><br>     mQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageQueue</span>(quitAllowed);<br>   <span class="hljs-comment">//è·å–å½“å‰çº¿ç¨‹èµ‹å€¼ç»™Looperçš„mThread</span><br>     mThread = Thread.currentThread();<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ï¼Œä»–çš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼ŒåŸæ¥å¦‚æ­¤ã€‚è€Œä¸”æˆ‘ä»¬è¿˜ä¼šå‘ç°ï¼šLooperçš„å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªMessageQueueï¼Œå½“åˆå§‹åŒ–Looperçš„æ—¶å€™ä¼šé¡ºå¸¦åˆå§‹åŒ–è¿™ä¸ªMessageQueue</p><h4 id="Looperå¼€å¯æ¶ˆæ¯å¾ªç¯"><a href="#Looperå¼€å¯æ¶ˆæ¯å¾ªç¯" class="headerlink" title="Looperå¼€å¯æ¶ˆæ¯å¾ªç¯"></a>Looperå¼€å¯æ¶ˆæ¯å¾ªç¯</h4><p>å½“æˆ‘ä»¬çš„Looperåˆ›å»ºå¥½åï¼Œä»–æ˜¯ä¸ä¼šè‡ªå·±å¯åŠ¨çš„ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å¯åŠ¨Looperï¼Œè°ƒç”¨Looperçš„<code>loop()</code>æ–¹æ³•å³å¯ï¼Œæ‰€ä»¥å‰é¢åˆ›å»ºLooperçš„æ—¶å€™æˆ‘æ€»æ˜¯ä¼šè¯´ï¼Œåˆ›å»ºLooperå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯ï¼ŒLooperçš„<code>prepare</code>å’Œ<code>loop</code>æ–¹æ³•æ˜¯é…å¥—ä½¿ç”¨çš„ï¼Œä¸¤è€…å¿…é¡»æˆå¯¹å­˜åœ¨ã€‚ç°åœ¨æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æä¸€ä¸‹Looperçš„<code>loop</code>æ–¹æ³•ï¼Œä¸Šæºç :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loop</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹çš„Looper</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">Looper</span> <span class="hljs-variable">me</span> <span class="hljs-operator">=</span> myLooper();<br>    <span class="hljs-comment">//å½“å‰çº¿ç¨‹çš„Looper,ç›´æ¥æŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (me == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;No Looper; Looper.prepare() wasn&#x27;t called on this thread.&quot;</span>);<br>    &#125;<br>  <span class="hljs-comment">//è·å–å½“å‰Looperä¸­çš„MessageQueue</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">MessageQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> me.mQueue;<br>    <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//å¼€å¯æ­»å¾ªç¯è¯»å–æ¶ˆæ¯</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-comment">// è·å–æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</span><br>        <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> queue.next(); <span class="hljs-comment">// might block</span><br>        <span class="hljs-keyword">if</span> (msg == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// è¿”å›nullè¯´æ˜MessageQueueé€€å‡ºäº†</span><br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// è°ƒç”¨Messageå¯¹åº”çš„Handlerå¤„ç†æ¶ˆæ¯</span><br>            msg.target.dispatchMessage(msg);<br>            <span class="hljs-keyword">if</span> (observer != <span class="hljs-literal">null</span>) &#123;<br>                observer.messageDispatched(token, msg);<br>            &#125;<br>            dispatchEnd = needEndTime ? SystemClock.uptimeMillis() : <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">// å›æ”¶Message</span><br>        msg.recycleUnchecked();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>loop</code>æ–¹æ³•å°±æ˜¯Looperè¿™ä¸ªâ€œå¼•æ“â€çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œä»–å°±åƒæ˜¯ä¸€ä¸ªå¼€å…³</p><p>åˆ†æä¸‹è¿™æ®µä»£ç ï¼Œé¦–å…ˆè·å–å½“å‰çº¿ç¨‹çš„Looperå¯¹è±¡ï¼Œæ²¡æœ‰åˆ™æŠ›å¼‚å¸¸ï¼Œç„¶åè¿›å…¥ä¸€ä¸ªæ­»å¾ªç¯: ä¸æ–­è°ƒç”¨MessageQueueçš„nextæ–¹æ³•æ¥è·å–æ¶ˆæ¯ï¼Œç„¶åè°ƒç”¨messageçš„ç›®æ ‡handlerçš„<code>dispatchMessage</code>æ–¹æ³•æ¥å¤„ç†Messageã€‚</p><h4 id="Looperé€€å‡º"><a href="#Looperé€€å‡º" class="headerlink" title="Looperé€€å‡º"></a>Looperé€€å‡º</h4><p>Looperæä¾›äº†<code>quit</code>å’Œ<code>quitSafely</code>æ–¹æ³•æ¥é€€å‡ºä¸€ä¸ªLooperï¼ŒäºŒè€…çš„åŒºåˆ«æ˜¯ï¼š quitä¼šç›´æ¥é€€å‡ºLooperï¼Œè€ŒquitSafelyåªæ˜¯è®¾å®šä¸€ä¸ªæ ‡è®°ï¼Œç„¶åæŠŠæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„å·²æœ‰æ¶ˆæ¯å¤„ç†å®Œæ¯•åæ‰å®‰å…¨é€€å‡º.åœ¨æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºLooperçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ‰€æœ‰çš„æ¶ˆæ¯éƒ½è¢«å¤„ç†å®Œæˆåï¼Œæˆ‘ä»¬åº”è¯¥è°ƒç”¨<code>quit</code>æ–¹æ³•æ¥ç»ˆæ­¢æ¶ˆæ¯å¾ªç¯ï¼Œå¦åˆ™å­çº¿ç¨‹å°±ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œè€Œå¦‚æœé€€å‡ºLooperï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¼šç«‹åˆ»ç»ˆæ­¢ï¼Œå› æ­¤å»ºè®®ä¸éœ€è¦çš„æ—¶å€™ç»ˆæ­¢Looperã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quit</span><span class="hljs-params">()</span> &#123;<br>    mQueue.quit(<span class="hljs-literal">false</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quitSafely</span><span class="hljs-params">()</span> &#123;<br>    mQueue.quit(<span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-comment">// æœ€ç»ˆéƒ½æ˜¯è°ƒç”¨åˆ°äº†è¿™ä¸ªæ–¹æ³•</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">quit</span><span class="hljs-params">(<span class="hljs-type">boolean</span> safe)</span> &#123;<br>    <span class="hljs-comment">// å¦‚æœä¸èƒ½é€€å‡ºåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¸ªå€¼åœ¨åˆå§‹åŒ–Looperçš„æ—¶å€™è¢«èµ‹å€¼</span><br>    <span class="hljs-keyword">if</span> (!mQuitAllowed) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;Main thread not allowed to quit.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        <span class="hljs-comment">// é€€å‡ºä¸€æ¬¡ä¹‹åå°±æ— æ³•å†æ¬¡è¿è¡Œäº†</span><br>        <span class="hljs-keyword">if</span> (mQuitting) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        mQuitting = <span class="hljs-literal">true</span>;<br>        <span class="hljs-comment">// æ‰§è¡Œä¸åŒçš„æ–¹æ³•</span><br>        <span class="hljs-keyword">if</span> (safe) &#123;<br>            removeAllFutureMessagesLocked();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            removeAllMessagesLocked();<br>        &#125;<br>        <span class="hljs-comment">// å”¤é†’MessageQueue</span><br>        nativeWake(mPtr);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>quit</code>å’Œ<code>quitSafely</code>æ–¹æ³•æœ€ç»ˆéƒ½è°ƒç”¨äº†<code>quit(boolean safe)</code>è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å…ˆåˆ¤æ–­æ˜¯å¦èƒ½é€€å‡ºï¼Œç„¶åå†æ‰§è¡Œé€€å‡ºé€»è¾‘ã€‚å¦‚æœmQuitting&#x3D;&#x3D;trueï¼Œé‚£ä¹ˆè¿™é‡Œä¼šç›´æ¥returnæ‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°mQuittingè¿™ä¸ªå˜é‡åªæœ‰åœ¨è¿™é‡Œè¢«æ‰§è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥ä¸€æ—¦looperé€€å‡ºï¼Œåˆ™æ— æ³•å†æ¬¡è¿è¡Œäº†ã€‚ä¹‹åæ‰§è¡Œä¸åŒçš„é€€å‡ºé€»è¾‘,ç„¶åå”¤é†’MessageQueue,ä¹‹åMessageQueueçš„nextæ–¹æ³•ä¼šé€€å‡ºï¼ŒLooperçš„loopæ–¹æ³•ä¹Ÿä¼šè·Ÿç€é€€å‡ºï¼Œé‚£ä¹ˆçº¿ç¨‹ä¹Ÿå°±åœæ­¢äº†ã€‚</p><h4 id="Looperæ€»ç»“"><a href="#Looperæ€»ç»“" class="headerlink" title="Looperæ€»ç»“"></a>Looperæ€»ç»“</h4><p>Looperä½œä¸ºHandleræ¶ˆæ¯æœºåˆ¶çš„â€œåŠ¨åŠ›å¼•æ“â€ï¼Œä¸æ–­ä»MessageQueueä¸­è·å–æ¶ˆæ¯ï¼Œç„¶åäº¤ç»™Handlerå»å¤„ç†ã€‚Looperçš„ä½¿ç”¨å‰éœ€è¦å…ˆåˆå§‹åŒ–å½“å‰çº¿ç¨‹çš„Looperå¯¹è±¡ï¼Œå†è°ƒç”¨loopæ–¹æ³•æ¥å¯åŠ¨å®ƒã€‚</p><p>åŒæ—¶Handlerä¹Ÿæ˜¯å®ç°åˆ‡æ¢çš„æ ¸å¿ƒï¼Œå› ä¸ºä¸åŒçš„Looperè¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œä»–æ‰€è°ƒç”¨çš„dispatchMessageæ–¹æ³•åˆ™è¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œæ‰€ä»¥Messageçš„å¤„ç†å°±è¢«åˆ‡æ¢åˆ°Looperæ‰€åœ¨çš„çº¿ç¨‹äº†ã€‚å½“looperä¸å†ä½¿ç”¨æ—¶ï¼Œå¯è°ƒç”¨ä¸åŒçš„é€€å‡ºæ–¹æ³•æ¥é€€å‡ºä»–ï¼Œæ³¨æ„Looperä¸€æ—¦é€€å‡ºï¼Œçº¿ç¨‹åˆ™ä¼šç›´æ¥ç»“æŸã€‚</p><h3 id="Handlerå‘é€æ¶ˆæ¯"><a href="#Handlerå‘é€æ¶ˆæ¯" class="headerlink" title="Handlerå‘é€æ¶ˆæ¯"></a>Handlerå‘é€æ¶ˆæ¯</h3><p>Handlerå’ŒLooperéƒ½åˆ›å»ºå¥½äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦ä½¿ç”¨Handlerå»å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬åœ¨æœ€å¼€å§‹ä»‹ç»Handlerä½¿ç”¨çš„æ—¶å€™ï¼Œå†™äº†å‘é€çš„ä¸¤ç§æ¶ˆæ¯ç±»å‹ï¼Œå¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åœ¨é€‚å½“çš„æ—¶æœºä½¿ç”¨Handlerå®ä¾‹å‘é€æ¶ˆæ¯</span><br>mHandler.sendMessage(message);<br>mHandler.post(runnable);<span class="hljs-comment">//Runnableä¼šè¢«å°è£…è¿›ä¸€ä¸ªMessage,æ‰€ä»¥å®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªMessage</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨Handlerå‘é€æ¶ˆæ¯ï¼Œå®ƒæœ‰<code>send</code> æˆ–è€… <code>post</code>ç­‰ä¸€ç³»åˆ—æ–¹æ³•ï¼Œæœ€ç»ˆè¿™äº›å‘é€çš„æ–¹æ³•ä¼šè°ƒç”¨åˆ°Handlerä¸­çš„enqueueMessage()æ–¹æ³•ï¼Œè€ŒHandlerä¸­çš„<code>enqueueMessage</code>æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°MessageQueueçš„<code>enqueueMessage</code>æ–¹æ³•ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå‘é€æ¶ˆæ¯æ–¹æ³•çš„æºç çœ‹ä¸‹ï¼Œä»¥æˆ‘ä»¬æœ€å¸¸ç”¨çš„sendMessage()è¿™ä¸ªæ–¹æ³•ä¸ºä¾‹ï¼š</p><p><strong>æ³¨æ„</strong>ï¼š<code>post</code>ç³»åˆ—æ–¹æ³•ï¼Œå‘é€çš„æ˜¯ä¸€ä¸ªRunnableï¼ŒRunnableä¼šè¢«å°è£…è¿›ä¸€ä¸ªMessageï¼Œæ‰€ä»¥å®ƒæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªMessage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>    <span class="hljs-keyword">return</span> sendMessageDelayed(msg, <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-comment">//2</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">sendMessageDelayed</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg, <span class="hljs-type">long</span> delayMillis)</span> &#123;<br>    <span class="hljs-keyword">if</span> (delayMillis &lt; <span class="hljs-number">0</span>) &#123;<br>      delayMillis = <span class="hljs-number">0</span>;<br>    &#125;<br>   <span class="hljs-keyword">return</span> sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis);<br>&#125;<br><br><span class="hljs-comment">//3</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">sendMessageAtTime</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg, <span class="hljs-type">long</span> uptimeMillis)</span> &#123;<br>    <span class="hljs-type">MessageQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> mQueue;<br>    <span class="hljs-keyword">if</span> (queue == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">RuntimeException</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<br>        <span class="hljs-built_in">this</span> + <span class="hljs-string">&quot; sendMessageAtTime() called with no mQueue&quot;</span>);<br>        Log.w(<span class="hljs-string">&quot;Looper&quot;</span>, e.getMessage(), e);<br>       <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> enqueueMessage(queue, msg, uptimeMillis);<br>&#125;<br><br><span class="hljs-comment">//4</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">enqueueMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> MessageQueue queue, <span class="hljs-meta">@NonNull</span> Message msg,<span class="hljs-type">long</span> uptimeMillis)</span> &#123;<br>     <span class="hljs-comment">//å°†å½“å‰çš„Handlerèµ‹å€¼ç»™Messageçš„targetå±æ€§</span><br>   msg.target = <span class="hljs-built_in">this</span>;<br>     msg.workSourceUid = ThreadLocalWorkSource.getUid();<br><br>     <span class="hljs-keyword">if</span> (mAsynchronous) &#123;<br>         msg.setAsynchronous(<span class="hljs-literal">true</span>);<br>     &#125;<br>     <span class="hljs-keyword">return</span> queue.enqueueMessage(msg, uptimeMillis);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç çš„è°ƒç”¨é¡ºåºå°±æ˜¯1-&gt;2-&gt;3-&gt;4</p><p>è¿™é‡Œæˆ‘ç»™ä¸€å¼ å›¾æ¥æ€»ç»“ä¸€ä¸‹ï¼Œ<code>send</code> æˆ–è€… <code>post</code>ç­‰ä¸€ç³»åˆ—æ–¹æ³•çš„è°ƒç”¨åŠæœ€ç»ˆçš„èµ°å‘ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72362e6cb08043fa8094f459fbd6291e~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210131222442908"></p><h3 id="MessageQueue-enqueueMessageæ–¹æ³•ä»‹ç»"><a href="#MessageQueue-enqueueMessageæ–¹æ³•ä»‹ç»" class="headerlink" title="MessageQueue enqueueMessageæ–¹æ³•ä»‹ç»"></a>MessageQueue enqueueMessageæ–¹æ³•ä»‹ç»</h3><p>åˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ¥é‡ç‚¹åˆ†æä¸€ä¸‹MessageQueueçš„enqueueMessage()æ–¹æ³•ï¼ŒenqueueMessageä¸­æ–‡æ„æ€æ˜¯å…¥é˜Ÿæ¶ˆæ¯ï¼Œè§åçŸ¥æ„ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯æŠŠHandlerå‘é€çš„æ¶ˆæ¯ï¼Œæ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span> <span class="hljs-title function_">enqueueMessage</span><span class="hljs-params">(Message msg, <span class="hljs-type">long</span> when)</span> &#123;<br>    <span class="hljs-comment">// Hanlderä¸ºç©ºåˆ™æŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (msg.target == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Message must have a target.&quot;</span>);<br>    &#125;<br>  <span class="hljs-comment">//å½“å‰æ¶ˆæ¯å¦‚æœå·²ç»å·²ç»è¢«æ‰§è¡Œåˆ™æŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (msg.isInUse()) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(msg + <span class="hljs-string">&quot; This message is already in use.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// å¯¹MessageQueueè¿›è¡ŒåŠ é”</span><br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        <span class="hljs-comment">// åˆ¤æ–­ç›®æ ‡threadæ˜¯å¦å·²ç»æ­»äº¡</span><br>        <span class="hljs-keyword">if</span> (mQuitting) &#123;<br>            <span class="hljs-type">IllegalStateException</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<br>                    msg.target + <span class="hljs-string">&quot; sending message to a Handler on a dead thread&quot;</span>);<br>            Log.w(TAG, e.getMessage(), e);<br>            msg.recycle();<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">// æ ‡è®°Messageæ­£åœ¨è¢«æ‰§è¡Œï¼Œä»¥åŠéœ€è¦è¢«æ‰§è¡Œçš„æ—¶é—´</span><br>        <span class="hljs-comment">//è¿™é‡Œçš„whençš„å€¼éœ€è¦åˆ†æƒ…å†µ:1,å¯èƒ½ä¸º0 2, å¦‚æœä¸ä¸º0ï¼Œåˆ™æ˜¯ç³»ç»Ÿå¼€æœºåˆ°ç°åœ¨çš„ä¸€ä¸ªæ¯«ç§’æ•° + å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´</span><br>        <span class="hljs-comment">//è¿™ä¸¤ç§æƒ…å†µä¸»è¦çœ‹ä½ è°ƒç”¨çš„æ˜¯Handlerå“ªä¸ªå‘é€Messageçš„æ–¹æ³•</span><br>        msg.markInUse();<br>        msg.when = when;<br>        <span class="hljs-comment">// pæ˜¯MessageQueueçš„é“¾è¡¨å¤´</span><br>        <span class="hljs-type">Message</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> mMessages;<br>      <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦å”¤é†’MessageQueue</span><br>        <span class="hljs-type">boolean</span> needWake;<br>        <span class="hljs-comment">// å¦‚æœæœ‰æ–°çš„é˜Ÿå¤´ï¼ŒåŒæ—¶MessageQueueå¤„äºé˜»å¡çŠ¶æ€åˆ™éœ€è¦å”¤é†’é˜Ÿåˆ—</span><br>        <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span> || when == <span class="hljs-number">0</span> || when &lt; p.when) &#123;<br>            msg.next = p;<br>            mMessages = msg;<br>            needWake = mBlocked;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//...</span><br>            <span class="hljs-comment">// æ ¹æ®æ—¶é—´æ‰¾åˆ°æ’å…¥çš„ä½ç½®</span><br>            Message prev;<br>            <span class="hljs-keyword">for</span> (;;) &#123;<br>                prev = p;<br>                p = p.next;<br>                <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span> || when &lt; p.when) &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">//...</span><br>            &#125;<br>            msg.next = p; <br>            prev.next = msg;<br>        &#125;<br><br>        <span class="hljs-comment">// å¦‚æœéœ€è¦åˆ™å”¤é†’é˜Ÿåˆ—</span><br>        <span class="hljs-keyword">if</span> (needWake) &#123;<br>            nativeWake(mPtr);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹:</p><ol><li><p>é¦–å…ˆåˆ¤æ–­Messageä¸­çš„Handlerä¸èƒ½ä¸ç©ºï¼Œä¸”ä¸èƒ½ä¸ºåœ¨ä½¿ç”¨ä¸­ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</p></li><li><p>å¯¹MessageQueueè¿›è¡ŒåŠ é”ï¼Œåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦deadï¼Œå¦‚æœdeadåˆ™æ‰“å°ä¸€ä¸ªå¼‚å¸¸ï¼Œå¹¶è¿”å›false</p></li><li><p>åˆå§‹åŒ–Messageçš„æ‰§è¡Œæ—¶é—´ä»¥å¹¶ä¸”æ ‡è®°ä¸ºæ­£åœ¨æ‰§è¡Œä¸­</p></li><li><p>å½“æ–°æ’å…¥çš„Messageåœ¨é“¾è¡¨å¤´æ—¶ï¼Œå¦‚æœmessageQueueæ˜¯ç©ºçš„æˆ–è€…æ­£åœ¨ç­‰å¾…ä¸‹ä¸ªå»¶è¿Ÿæ¶ˆæ¯ï¼Œåˆ™éœ€è¦å”¤é†’MessageQueue</p></li><li><p>æ ¹æ®Messageçš„æ‰§è¡Œæ—¶é—´ï¼Œæ‰¾åˆ°åœ¨é“¾è¡¨ä¸­çš„æ’å…¥ä½ç½®è¿›è¡Œæ’å…¥ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç†è§£MessageQueueä¸­ç»´æŠ¤äº†ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—,</p><p>ä¼˜å…ˆçº§é˜Ÿåˆ—å°±æ˜¯é“¾è¡¨æ ¹æ®æ—¶é—´è¿›è¡Œæ’åºå¹¶åŠ å…¥é˜Ÿåˆ—çš„æ•°æ®ç»“æ„å½¢æˆçš„ï¼Œä¾‹å¦‚æˆ‘ä»¬å‘é€çš„å‡ ä¸ªæ¶ˆæ¯æºå¸¦çš„æ—¶é—´åˆ†åˆ«ä¸ºï¼š1sï¼Œ20msï¼Œ3sï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šæ ¹æ®æ—¶é—´è¿›è¡Œæ’åºä¸ºï¼š20msï¼Œ1sï¼Œ3sï¼Œ é‚£ä¹ˆå¦‚æœæˆ‘æ–°åŠ å…¥çš„ä¸€ä¸ªæ¶ˆæ¯çš„æ—¶é—´ä¸º2sï¼Œé‚£ä¹ˆä»–å°±ä¼šæ’å…¥1så’Œ3sçš„ä¸­é—´ï¼Œæ­¤æ—¶è¿™ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—å°±æœ‰äº†4ä¸ªå…ƒç´ ï¼š 20msï¼Œ1sï¼Œ2sï¼Œ3s</p></li></ol><h3 id="MessageQueue-nextæ–¹æ³•ä»‹ç»"><a href="#MessageQueue-nextæ–¹æ³•ä»‹ç»" class="headerlink" title="MessageQueue nextæ–¹æ³•ä»‹ç»"></a>MessageQueue nextæ–¹æ³•ä»‹ç»</h3><p>åˆ°è¿™é‡Œï¼ŒHandlerå‘é€çš„æ¶ˆæ¯å·²ç»æ”¾åˆ°äº†MessageQueueä¸­ï¼Œé‚£æ¥ç€è‚¯å®šå°±è¦è¿›è¡Œæ¶ˆæ¯çš„è¯»å–ï¼Œæˆ‘ä»¬åˆšè®²åˆ°Looperçš„<code>Loop</code>æ–¹æ³•ä¼šä»MessageQueueä¸­å¾ªç¯è¯»å–æ¶ˆæ¯ï¼Œ<code>loop</code>æ–¹æ³•ä¸­è°ƒç”¨<code>queue.next()</code>çš„åœ°æ–¹æœ‰å¥æºç æ³¨é‡Šï¼šmight block,ä¸­æ–‡æ„æ€æ˜¯å¯èƒ½è¢«é˜»å¡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loop</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-comment">//è·å–å½“å‰Looperä¸­çš„MessageQueue</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">MessageQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> me.mQueue;<br>    <span class="hljs-comment">//...</span><br>  <span class="hljs-comment">//å¼€å¯æ­»å¾ªç¯è¯»å–æ¶ˆæ¯</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>      <span class="hljs-comment">// è·å–æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</span><br>        <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> queue.next(); <span class="hljs-comment">// might block</span><br>    &#125;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å°±çœ‹ä¸‹MessageQueueçš„<code>next</code>æ–¹æ³•åˆ°åº•åšäº†ä»€ä¹ˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java">Message <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Return here if the message loop has already quit and been disposed.</span><br>    <span class="hljs-comment">// æºç ä¸­çš„æ³¨é‡Šè¡¨ç¤º:å¦‚æœlooperå·²ç»é€€å‡ºäº†,è¿™é‡Œå°±è¿”å›null</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">ptr</span> <span class="hljs-operator">=</span> mPtr;<br>    <span class="hljs-keyword">if</span> (ptr == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">// å®šä¹‰é˜»å¡æ—¶é—´èµ‹å€¼ä¸º0</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">nextPollTimeoutMillis</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">//æ­»å¾ªç¯</span><br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-keyword">if</span> (nextPollTimeoutMillis != <span class="hljs-number">0</span>) &#123;<br>            Binder.flushPendingCommands();<br>        &#125;<br>        <span class="hljs-comment">// é˜»å¡å¯¹åº”æ—¶é—´ è¿™ä¸ªæ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°linuxçš„epollæœºåˆ¶</span><br>        nativePollOnce(ptr, nextPollTimeoutMillis);<br>    <span class="hljs-comment">// å¯¹MessageQueueè¿›è¡ŒåŠ é”ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨</span><br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">now</span> <span class="hljs-operator">=</span> SystemClock.uptimeMillis();<br>            <span class="hljs-type">Message</span> <span class="hljs-variable">prevMsg</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mMessages;<br>            <span class="hljs-comment">//...</span><br>            <span class="hljs-keyword">if</span> (msg != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (now &lt; msg.when) &#123;<br>                    <span class="hljs-comment">// ä¸‹ä¸€ä¸ªæ¶ˆæ¯è¿˜æ²¡å¼€å§‹ï¼Œç­‰å¾…ä¸¤è€…çš„æ—¶é—´å·®</span><br>                    nextPollTimeoutMillis = (<span class="hljs-type">int</span>) Math.min(msg.when - now, Integer.MAX_VALUE);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// è·å¾—æ¶ˆæ¯ä¸”ç°åœ¨è¦æ‰§è¡Œï¼Œæ ‡è®°MessageQueueä¸ºéé˜»å¡</span><br>                    mBlocked = <span class="hljs-literal">false</span>;<br>                    <span class="hljs-comment">// é“¾è¡¨æ“ä½œ</span><br>                    <span class="hljs-keyword">if</span> (prevMsg != <span class="hljs-literal">null</span>) &#123;<br>                        prevMsg.next = msg.next;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        mMessages = msg.next;<br>                    &#125;<br>                    msg.next = <span class="hljs-literal">null</span>;<br>                    msg.markInUse();<br>                    <span class="hljs-keyword">return</span> msg;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// æ²¡æœ‰æ¶ˆæ¯ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</span><br>                nextPollTimeoutMillis = -<span class="hljs-number">1</span>;<br>            &#125;<br>          <span class="hljs-comment">//é€€å‡º</span><br>          <span class="hljs-keyword">if</span> (mQuitting) &#123;<br>                 dispose();<br>                 <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>             &#125;<br>            <span class="hljs-comment">//...æ¶‰åŠäº†åŒæ­¥å±éšœå’ŒIdleHandler,åç»­åœ¨åˆ†æ</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å‘ç°<code>next</code>æ–¹æ³•ç›®çš„æ˜¯è·å–MessageQueueä¸­çš„ä¸€ä¸ªMessageï¼Œå®ƒé‡Œé¢æœ‰ä¸€ä¸ªæ­»å¾ªç¯ï¼Œå¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸­æ²¡æœ‰æ¶ˆæ¯ï¼Œé‚£ä¹ˆnextæ–¹æ³•ä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼Œå½“æœ‰æ–°æ¶ˆæ¯åˆ°æ¥æ—¶ï¼Œå°±ä¼šå°†å®ƒå”¤é†’ï¼Œnextæ–¹æ³•ä¼šè¿”å›è¿™æ¡æ¶ˆæ¯å¹¶å°†å…¶ä»ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ç»™ç§»é™¤</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å¦‚æœLooperå·²ç»é€€å‡ºäº†ï¼Œç›´æ¥è¿”å›null</li><li>è¿›å…¥æ­»å¾ªç¯ï¼Œç›´åˆ°è·å–åˆ°Messageæˆ–è€…é€€å‡º</li><li>å¾ªç¯ä¸­å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œé˜»å¡ï¼Œé˜»å¡æœ€ç»ˆä¼šè°ƒç”¨åˆ°linuxçš„epollæœºåˆ¶ï¼Œé˜»å¡ç»“æŸå,å¯¹MessageQueueè¿›è¡ŒåŠ é”ï¼Œè·å–Message</li><li>å¦‚æœMessageQueueä¸­æ²¡æœ‰æ¶ˆæ¯ï¼Œåˆ™ç›´æ¥æŠŠçº¿ç¨‹æ— é™é˜»å¡ç­‰å¾…å”¤é†’</li><li>å¦‚æœMessageQueueä¸­æœ‰æ¶ˆæ¯ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦éœ€è¦ç­‰å¾…ï¼Œå¦åˆ™åˆ™ç›´æ¥è¿”å›å¯¹åº”çš„message</li></ol><p>å¯ä»¥çœ‹åˆ°é€»è¾‘å°±æ˜¯åˆ¤æ–­å½“å‰æ—¶é—´Messageä¸­æ˜¯å¦éœ€è¦ç­‰å¾….å…¶ä¸­<code>nextPollTimeoutMillis</code>è¡¨ç¤ºé˜»å¡çš„æ—¶é—´ï¼Œ<code>-1</code>è¡¨ç¤ºæ— é™æ—¶é—´,ç›´åˆ°æœ‰äº‹ä»¶å‘ç”Ÿä¸ºæ­¢ï¼Œ<code>0</code>è¡¨ç¤ºä¸é˜»å¡</p><h3 id="Handleræ¥æ”¶æ¶ˆæ¯"><a href="#Handleræ¥æ”¶æ¶ˆæ¯" class="headerlink" title="Handleræ¥æ”¶æ¶ˆæ¯"></a>Handleræ¥æ”¶æ¶ˆæ¯</h3><p>åœ¨æˆ‘ä»¬å¯¹Looperè¿›è¡Œæ€»ç»“æ—¶æˆ‘ä»¬è¯´äº†ï¼š Handlerä¹Ÿæ˜¯å®ç°çº¿ç¨‹åˆ‡æ¢çš„æ ¸å¿ƒï¼Œå› ä¸ºä¸åŒçš„Looperè¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œä»–æ‰€è°ƒç”¨çš„dispatchMessageæ–¹æ³•åˆ™ä¼šè¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ï¼Œæ‰€ä»¥Messageçš„å¤„ç†å°±ä¼šè¢«åˆ‡æ¢åˆ°Looperæ‰€åœ¨çš„çº¿ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loop</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>      <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// è°ƒç”¨Messageå¯¹åº”çš„Handlerå¤„ç†æ¶ˆæ¯</span><br>            msg.target.dispatchMessage(msg);<br>        &#125;<br> <span class="hljs-comment">//...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç è°ƒç”¨äº† <code>msg.target.dispatchMessage(msg)</code> æ–¹æ³•ï¼Œmsg.target å°±æ˜¯å‘é€è¯¥æ¶ˆæ¯çš„ Handlerï¼Œè¿™æ ·æ¶ˆæ¯æœ€ç»ˆä¼šå›è°ƒåˆ°Handlerçš„<code>dispatchMessage</code>æ–¹æ³•ä¸­ï¼Œçœ‹ä¸‹è¿™ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatchMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span> &#123;<br>  <span class="hljs-comment">//æ¶ˆæ¯çš„callbackä¸ä¸ºç©º,åˆ™å›è°ƒhandleCallbackæ–¹æ³•</span><br>    <span class="hljs-keyword">if</span> (msg.callback != <span class="hljs-literal">null</span>) &#123;<br>        handleCallback(msg);<br>     &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">//å½“å‰mCallbackä¸ä¸ºç©º,å›è°ƒmCallback.handleMessageæ–¹æ³•</span><br>     <span class="hljs-keyword">if</span> (mCallback != <span class="hljs-literal">null</span>) &#123;<br>              <span class="hljs-keyword">if</span> (mCallback.handleMessage(msg)) &#123;<br>                  <span class="hljs-keyword">return</span>;<br>              &#125;<br>          &#125;<br>      <span class="hljs-comment">//å›è°ƒhandleMessage</span><br>          handleMessage(msg);<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤:</p><p>1ã€é¦–å…ˆï¼Œæ£€æŸ¥Messageçš„callbackæ˜¯å¦ä¸ºnullï¼Œä¸ä¸ºnullå°±é€šè¿‡<code>handleCallBack</code>æ¥å¤„ç†æ¶ˆæ¯ï¼ŒMessageçš„callbackæ˜¯ä¸€ä¸ªRunnableå¯¹è±¡ï¼Œå®é™…ä¸Šå°±æ˜¯Handlerçš„<code>post</code>ç³»åˆ—æ–¹æ³•æ‰€ä¼ é€’çš„Runnableå‚æ•°ï¼Œ<code>handleCallBack</code>æ–¹æ³•å¤„ç†é€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleCallback</span><span class="hljs-params">(Message message)</span> &#123;<br>     message.callback.run();<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€å…¶æ¬¡ï¼Œæ£€æŸ¥mCallbackæ˜¯å¦ä¸ºnullï¼Œä¸ä¸ºnullå°±è°ƒç”¨mCallbackçš„<code>handleMessage</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯ã€‚Callbackæ˜¯ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Callback interface you can use when instantiating a Handler to avoid</span><br><span class="hljs-comment"> * having to implement your own subclass of Handler.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Callback</span> &#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Message msg)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡Callbackå¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹å¼æ¥åˆ›å»ºHandlereå¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Handler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(callback);<br></code></pre></td></tr></table></figure><p>é‚£Callbackçš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæºç é‡Œæ³¨é‡Šåšäº†è¯´æ˜ï¼šå¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªHandlerçš„å®ä¾‹ä½†å¹¶ä¸éœ€è¦æ´¾ç”Ÿçš„å­ç±»ã€‚åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œåˆ›å»ºHandleræœ€å¸¸è§çš„å°±æ˜¯æ´¾ç”Ÿä¸€ä¸ªHandlerçš„å­ç±»å¹¶é‡å†™å…¶<code>handleMessage</code>æ–¹æ³•æ¥å¤„ç†å…·ä½“çš„æ¶ˆæ¯ï¼Œè€ŒCallbackç»™æˆ‘ä»¬æä¾›äº†å¦å¤–ä¸€ç§ä½¿ç”¨Handlerçš„æ–¹å¼ï¼Œå½“æˆ‘ä»¬ä¸æƒ³æ´¾ç”Ÿå­ç±»æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡Callbackæ¥å®ç°ã€‚</p><p>3ã€æœ€åï¼Œè°ƒç”¨Handlerçš„<code>handleMessage</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯</p><p>Handlerå¤„ç†æ¶ˆæ¯çš„è¿‡ç¨‹æˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2849c508f7a342e9b53f2b8384066c57~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210131222054614"></p><h3 id="Messageä»‹ç»"><a href="#Messageä»‹ç»" class="headerlink" title="Messageä»‹ç»"></a>Messageä»‹ç»</h3><p>Messageæ˜¯è´Ÿè´£æ‰¿è½½æ¶ˆæ¯çš„ç±»ï¼Œä¸»è¦æ˜¯å…³æ³¨ä»–çš„å†…éƒ¨å±æ€§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨æˆ·è‡ªå®šä¹‰ï¼Œä¸»è¦ç”¨äºè¾¨åˆ«Messageçš„ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> what;<br><span class="hljs-comment">// ç”¨äºå­˜å‚¨ä¸€äº›æ•´å‹æ•°æ®</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> arg1;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> arg2;<br><span class="hljs-comment">// å¯æ”¾å…¥ä¸€ä¸ªå¯åºåˆ—åŒ–å¯¹è±¡</span><br><span class="hljs-keyword">public</span> Object obj;<br><span class="hljs-comment">// Bundleæ•°æ®</span><br>Bundle data;<br><span class="hljs-comment">// Messageå¤„ç†çš„æ—¶é—´ã€‚ç›¸å¯¹äº1970.1.1è€Œè¨€çš„æ—¶é—´</span><br><span class="hljs-comment">// å¯¹ç”¨æˆ·ä¸å¯è§</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> when;<br><span class="hljs-comment">// å¤„ç†è¿™ä¸ªMessageçš„Handler</span><br><span class="hljs-comment">// å¯¹ç”¨æˆ·ä¸å¯è§</span><br>Handler target;<br><span class="hljs-comment">// å½“æˆ‘ä»¬ä½¿ç”¨Handlerçš„postæ–¹æ³•æ—¶å€™å°±æ˜¯æŠŠrunnableå¯¹è±¡å°è£…æˆMessage</span><br><span class="hljs-comment">// å¯¹ç”¨æˆ·ä¸å¯è§</span><br>Runnable callback;<br><span class="hljs-comment">// MessageQueueæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œnextè¡¨ç¤ºä¸‹ä¸€ä¸ª</span><br><span class="hljs-comment">// å¯¹ç”¨æˆ·ä¸å¯è§</span><br>Message next;<br></code></pre></td></tr></table></figure><h4 id="å¾ªç¯åˆ©ç”¨Message"><a href="#å¾ªç¯åˆ©ç”¨Message" class="headerlink" title="å¾ªç¯åˆ©ç”¨Message"></a>å¾ªç¯åˆ©ç”¨Message</h4><p>å½“æˆ‘ä»¬è·å–Messageçš„æ—¶å€™ï¼Œå®˜æ–¹å»ºè®®æ˜¯é€šè¿‡Message.obtain()æ–¹æ³•æ¥è·å–ï¼Œå½“ä½¿ç”¨å®Œä¹‹åä½¿ç”¨recycle()æ–¹æ³•æ¥å›æ”¶å¾ªç¯åˆ©ç”¨ã€‚è€Œä¸æ˜¯ç›´æ¥newä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Message <span class="hljs-title function_">obtain</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (sPoolSync) &#123;<br>        <span class="hljs-keyword">if</span> (sPool != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">Message</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> sPool;<br>            sPool = m.next;<br>            m.next = <span class="hljs-literal">null</span>;<br>            m.flags = <span class="hljs-number">0</span>; <br>            sPoolSize--;<br>            <span class="hljs-keyword">return</span> m;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>Messageç»´æŠ¤äº†ä¸€ä¸ªé™æ€é“¾è¡¨ï¼Œé“¾è¡¨å¤´æ˜¯<code>sPool</code>ï¼ŒMessageæœ‰ä¸€ä¸ªnextå±æ€§ï¼ŒMessageæœ¬èº«å°±æ˜¯é“¾è¡¨ç»“æ„ã€‚<code>sPoolSync</code>æ˜¯ä¸€ä¸ªobjectå¯¹è±¡ï¼Œä»…ä½œä¸ºè§£å†³å¹¶å‘è®¿é—®å®‰å…¨è®¾è®¡ã€‚å½“æˆ‘ä»¬è°ƒç”¨obtainæ¥è·å–ä¸€ä¸ªæ–°çš„Messageçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ£€æŸ¥é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç©ºé—²çš„Messageï¼Œå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ªè¿”å›ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨å®Œæˆä¹‹åï¼Œå¯ä»¥è°ƒç”¨Messageçš„recycleæ–¹æ³•è¿›è¡Œå›æ”¶ï¼Œå¦‚æœè¿™ä¸ªMessageæ­£åœ¨ä½¿ç”¨åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™åˆ™è°ƒç”¨<code>recycleUnchecked</code>è¿›è¡Œå›æ”¶ï¼ŒæŠŠMessageä¸­çš„å†…å®¹æ¸…ç©ºï¼Œç„¶ååˆ¤æ–­é“¾è¡¨æ˜¯å¦è¾¾åˆ°æœ€å¤§å€¼ï¼ˆ50ï¼‰ï¼Œç„¶åæ’å…¥é“¾è¡¨ä¸­</p><h2 id="Handleræ¶ˆæ¯æœºåˆ¶åŸç†æ€»ç»“"><a href="#Handleræ¶ˆæ¯æœºåˆ¶åŸç†æ€»ç»“" class="headerlink" title="Handleræ¶ˆæ¯æœºåˆ¶åŸç†æ€»ç»“"></a>Handleræ¶ˆæ¯æœºåˆ¶åŸç†æ€»ç»“</h2><p>é€šè¿‡ä¸Šé¢çš„æºç åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><ol><li>å®ä¾‹åŒ–Handlerä¹‹å‰ï¼Œéœ€å…ˆæ„å»ºå½“å‰çº¿ç¨‹çš„Looperå¹¶å¼€å¯æ¶ˆæ¯å¾ªç¯</li><li>é€šè¿‡Handlerçš„sendå’Œpostæ–¹æ³•å‘é€æ¶ˆæ¯</li><li>å‘é€çš„æ¶ˆæ¯ä¼šåŠ å…¥åˆ°MessageQueueä¸­ï¼Œç­‰å¾…Looperè·å–å¤„ç†</li><li>Looperä¼šä¸æ–­åœ°ä»MessageQueueä¸­è·å–Messageç„¶åäº¤ä»˜ç»™å¯¹åº”çš„Handlerå¤„ç†</li></ol><p>å¦‚æœåˆ°è¿™é‡Œä½ è¿˜ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šHandleræ¶ˆæ¯æœºåˆ¶çš„åŸç†ï¼Œé‚£ä¹ˆç»§ç»­çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c76ccdd09feb4aa2a41ba0789da36c38~tplv-k3u1fbpfcp-zoom-1.image"></p><p>å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œï¼Œå…³äºHandleræ¶ˆæ¯æœºåˆ¶çš„ä¸»ä½“éƒ¨åˆ†å°±è®²å®Œäº†ã€‚</p><p>é™äºç¯‡å¹…ï¼Œæœ¬ç¯‡æ–‡ç« å°±åˆ°è¿™é‡Œäº†ï¼Œåç»­æˆ‘ä¼šåœ¨å†™ä¸€ç¯‡å…³äºHandlerçš„æ–‡ç« ï¼Œä»‹ç»Hanlderçš„ä¸€äº›æ‰©å±•çŸ¥è¯†å­¦ä¹ ï¼Œå¹¶å›ç­”å‰é¢æˆ‘æ‰€åˆ—å‡ºæ¥çš„ä¸€ç³»åˆ—é—®é¢˜</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡å°±å¤Ÿç³»åˆ—ï¼šå‘å¸ƒå¼€æºåº“åˆ°JitPackï¼ŒJCenterè¯¦ç»†æ•™ç¨‹</title>
    <link href="/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9A%E5%8F%91%E5%B8%83%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%B0JitPack%EF%BC%8CJCenter%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/"/>
    <url>/2022/10/11/%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E7%B3%BB%E5%88%97%EF%BC%9A%E5%8F%91%E5%B8%83%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%B0JitPack%EF%BC%8CJCenter%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><ul><li><p>JCenterè§£é‡Š: JCenteræ˜¯ä¸€ä¸ªJava&#x2F;Androidå·¥ç¨‹çš„åŒ…ç®¡ç†Mavenä»“åº“,ç”±<a href="https://bintray.com/">bintray.com</a>ç»´æŠ¤,æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å¤§çš„Javaä»“åº“</p></li><li><p><a href="https://jitpack.io/">JitPack</a>å®˜æ–¹è§£é‡Š: æ˜“äºä¸ºJVMå’ŒAndroidåº“ä½¿ç”¨åŒ…å­˜å‚¨åº“ï¼ŒJitPackæ ¹æ®éœ€è¦æ„å»ºGitHubé¡¹ç›®ï¼Œå¹¶å‘å¸ƒéšæ—¶å¯ç”¨çš„åŒ…</p></li><li><p>åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘å½“ä¸­,ç»å¸¸ä¼šå¼•å…¥ä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“æ¥å®ç°ä¸€äº›åŠŸèƒ½,å¦‚ä¸‹</p></li></ul><p>æ–¹å¼1: å‘å¸ƒåˆ°JCenterçš„åº“è¿›è¡Œå¦‚ä¸‹ä¾èµ–:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>åœ¨appçš„build.gradleæˆ–è€…moduleçš„build.gradleä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç <br>dependencies &#123;<br>    implementation <span class="hljs-string">&#x27;org.greenrobot:eventbus:3.2.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ–¹å¼2: å‘å¸ƒåˆ°JitPackçš„åº“è¿›è¡Œå¦‚ä¸‹ä¾èµ–</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-comment">//åœ¨projectçš„build.gradleä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </span><br><span class="hljs-keyword">allprojects</span> &#123;<br>    <span class="hljs-keyword">repositories</span> &#123;<br>       <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">maven</span> &#123; url <span class="hljs-symbol">&#x27;https</span><span class="hljs-operator">:</span><span class="hljs-comment">//jitpack.io&#x27; &#125;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>åœ¨appçš„build.gradleæˆ–è€…moduleçš„build.gradleä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç <br>dependencies &#123;<br>    implementation <span class="hljs-string">&#x27;com.github.sweetying520:AndroidUtils:1.0.1&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢çš„æ“ä½œ,æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™äº›ç¬¬ä¸‰æ–¹åº“çš„åŠŸèƒ½äº†</p><p><strong>æ³¨æ„:</strong></p><blockquote><p>JitPackå’ŒJCenteréƒ½æ˜¯ç¬¬ä¸‰æ–¹çš„ä»£ç ä»“åº“,åœ¨æˆ‘ä»¬ä½¿ç”¨AndroidStudioæ–°å»ºä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™é»˜è®¤å¼•å…¥äº†JCenter,å› æ­¤æˆ‘ä»¬å‘å¸ƒåˆ°Jcenterçš„åº“å°±å¯ä»¥ç›´æ¥åœ¨appçš„build.gradleæˆ–è€…moduleçš„build.gradleæ·»åŠ ä¾èµ–å³å¯,è€ŒJitPackæ²¡æœ‰å¼•å…¥,å› æ­¤åœ¨æ·»åŠ appçš„build.gradleæˆ–è€…moduleçš„build.gradleçš„ä¾èµ–çš„æ—¶å€™,éœ€åœ¨projectä¸­çš„build.gradleä¸­å¼•å…¥JitPackçš„ä»“åº“,æ·»åŠ å…¶ä»–ç¬¬ä¸‰æ–¹åº“ä¸‹çš„ä¾èµ–ä¹Ÿæ˜¯å¦‚æ­¤</p></blockquote><ul><li><p>é—®é¢˜: æˆ‘ä»¬å¦‚ä½•å°†è‡ªå·±å†™çš„Androidåº“è¢«åˆ«äººä¼˜é›…çš„å¼•ç”¨å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆ: å°†æˆ‘ä»¬ç¼–å†™å¥½çš„Androidåº“å‘å¸ƒåˆ°JCenteræˆ–è€…JitPackä»“åº“æˆ–è€…è‡ªå·±çš„æœ¬åœ°ä»“åº“,åœ¨æŒ‰ç…§å¦‚ä¸Šæ–¹å¼å¼•ç”¨</p></li></ul><h2 id="æ–¹å¼ä¸€-å‘å¸ƒAndroidåº“åˆ°JCenter"><a href="#æ–¹å¼ä¸€-å‘å¸ƒAndroidåº“åˆ°JCenter" class="headerlink" title="æ–¹å¼ä¸€: å‘å¸ƒAndroidåº“åˆ°JCenter"></a>æ–¹å¼ä¸€: å‘å¸ƒAndroidåº“åˆ°JCenter</h2><h3 id="æ­¥éª¤1-æ³¨å†ŒBintrayè´¦å·"><a href="#æ­¥éª¤1-æ³¨å†ŒBintrayè´¦å·" class="headerlink" title="æ­¥éª¤1: æ³¨å†ŒBintrayè´¦å·"></a>æ­¥éª¤1: æ³¨å†ŒBintrayè´¦å·</h3><ul><li><a href="https://bintray.com/signup/oss">æ³¨å†Œåœ°å€</a></li></ul><blockquote><p><strong>æ³¨æ„:</strong></p><ol><li>ä¸è¦åœ¨å®˜ç½‘æ³¨å†Œï¼Œå› ä¸ºå®˜ç½‘æ³¨å†Œçš„æ˜¯ä¼ä¸šç‰ˆï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸ªäººç‰ˆ</li><li>ï¼ˆå»ºè®®ï¼‰ç›´æ¥å…³è” <code>Github</code>è´¦å·è¿›è¡Œæ³¨å†Œ &amp; ç™»å½•</li></ol></blockquote><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6de3916fd3a24b0eb68240d8f49a343e~tplv-k3u1fbpfcp-zoom-1.image" alt="944365-93dd43c47e0ffa59"></p><h3 id="æ­¥éª¤2-åœ¨Bintrayä¸Šåˆ›å»ºä»“åº“"><a href="#æ­¥éª¤2-åœ¨Bintrayä¸Šåˆ›å»ºä»“åº“" class="headerlink" title="æ­¥éª¤2: åœ¨Bintrayä¸Šåˆ›å»ºä»“åº“"></a>æ­¥éª¤2: åœ¨Bintrayä¸Šåˆ›å»ºä»“åº“</h3><ol><li><p>ç‚¹å‡»çº¢æ¡†ä¸­çš„Add New Repositoryåˆ›å»ºä¸€ä¸ªä»“åº“</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f8beb73953140df90d44f08300ccd80~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110140256826"></p></li></ol><h3 id="æ­¥éª¤3-æŒ‰æ­¥éª¤å¡«å†™ç›¸å…³é…ç½®"><a href="#æ­¥éª¤3-æŒ‰æ­¥éª¤å¡«å†™ç›¸å…³é…ç½®" class="headerlink" title="æ­¥éª¤3: æŒ‰æ­¥éª¤å¡«å†™ç›¸å…³é…ç½®"></a>æ­¥éª¤3: æŒ‰æ­¥éª¤å¡«å†™ç›¸å…³é…ç½®</h3><p><strong>æ³¨æ„</strong></p><p>å¡«å†™ä»“åº“åçš„æ—¶å€™,è¿™é‡Œæˆ‘ä»¬å¡«å†™mavenå°±å¥½ï¼Œè¿™ä¸ªåœ°æ–¹é‡åˆ°å‘å°±æ˜¯,å½“æˆ‘ä»¬å¡«å†™ä¸Šä¼ åˆ°Bintrayçš„é…ç½®ä¿¡æ¯çš„æ—¶å€™,å¦‚æœæ²¡æœ‰æŒ‡å®šrepoName,é‚£ä¹ˆé»˜è®¤çš„repoNameå°±ä¸ºmaven,å¦‚æœæŒ‡å®šäº†å°±å¡«å†™ä½ åˆ›å»ºçš„ä»“åº“åå³å¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">publish &#123;<br>    userOrg = <span class="hljs-string">&#x27;sweetying520&#x27;</span>  <span class="hljs-regexp">//</span>Bintrayç”¨æˆ·å<br>    repoName = <span class="hljs-string">&#x27;maven&#x27;</span> <span class="hljs-regexp">//</span>Bintrayä¸Šåˆ›å»ºçš„ä»“åº“å,å¦‚æœä½ åˆ›å»ºçš„æ˜¯maven,åˆ™å¯ä»¥å¹²æ‰è¿™ä¸€è¡Œ,å¦åˆ™éœ€è¦æŒ‡å®šä»“åº“å<br>    groupId = <span class="hljs-string">&#x27;com.github.sweetying520&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„x<br>    artifactId = <span class="hljs-string">&#x27;AndroidUtils&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„y<br>    publishVersion = <span class="hljs-string">&#x27;1.0.0&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„z<br>    desc = <span class="hljs-string">&#x27;AndroidUtils is a library of tools to help developers improve their productivity&#x27;</span> <span class="hljs-regexp">//</span>å¯¹è¿™ä¸ªåº“çš„æè¿°<br>    website = <span class="hljs-string">&#x27;https://github.com/sweetying520/AndroidUtils&#x27;</span> <span class="hljs-regexp">//</span>VCSåœ°å€,å¡«å†™è¯¥é¡¹ç›®çš„Githubåœ°å€å°±å¥½<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d9199b5090641488e02c346f513d29c~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110140857448"></p><h3 id="æ­¥éª¤4-åœ¨ä»£ç é¡¹ç›®ä¸­åˆ›å»ºModuleï¼Œå¹¶å°†é¡¹ç›®ä¸Šä¼ åˆ°Github"><a href="#æ­¥éª¤4-åœ¨ä»£ç é¡¹ç›®ä¸­åˆ›å»ºModuleï¼Œå¹¶å°†é¡¹ç›®ä¸Šä¼ åˆ°Github" class="headerlink" title="æ­¥éª¤4: åœ¨ä»£ç é¡¹ç›®ä¸­åˆ›å»ºModuleï¼Œå¹¶å°†é¡¹ç›®ä¸Šä¼ åˆ°Github"></a>æ­¥éª¤4: åœ¨ä»£ç é¡¹ç›®ä¸­åˆ›å»º<code>Module</code>ï¼Œå¹¶å°†é¡¹ç›®ä¸Šä¼ åˆ°Github</h3><p><strong>æ³¨æ„</strong></p><p>Moduleæˆ‘å·²ç»åˆ›å»ºå¥½äº†,è¿™é‡Œåªæ˜¯æ¼”ç¤ºè¿‡ç¨‹</p><ol><li><p>æ–°å»ºModule</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f6203f57c4c34bdabd8abe8bc7b7605f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110144659112"></p></li><li><p>é€‰æ‹©Android Library</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01409ab76bbc47509d5df79d85564520~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110145022512"></p></li><li><p>åœ¨Moduleä¸­ç¼–å†™ä¸€äº›æµ‹è¯•ä»£ç ,æ–¹ä¾¿ä¸Šä¼ æˆåŠŸåéªŒè¯</p></li><li><p>å°†è‡ªå·±çš„è¿™ä¸ªé¡¹ç›®ä¸Šä¼ åˆ°Github,å¦‚ä½•ä¸Šä¼ åˆ°Githubä¸æ‡‚çš„è‡ªå·±ä¸Šç½‘æŸ¥ä¸€ä¸‹</p></li></ol><h3 id="æ­¥éª¤5-é…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ åˆ°JCenter"><a href="#æ­¥éª¤5-é…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ åˆ°JCenter" class="headerlink" title="æ­¥éª¤5: é…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ åˆ°JCenter"></a>æ­¥éª¤5: é…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ åˆ°JCenter</h3><blockquote><p><strong>æ³¨æ„</strong></p><p>ç½‘ä¸Šå¤§éƒ¨åˆ†æ•™ç¨‹æ¨èæˆ‘ä»¬ä½¿ç”¨<a href="https://github.com/novoda/bintray-release">bintray-releaseæ’ä»¶</a>ä¸Šä¼ ,ä½†æ˜¯è¿™ä¸ªæ’ä»¶ä¸æ”¯æŒGradleç‰ˆæœ¬ä¸º6.+çš„,å› æ­¤è¿™é‡Œæˆ‘æ¨èå¤§å®¶ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ’ä»¶<a href="https://github.com/panpf/bintray-publish">ä¼ é€é—¨</a>,å®ƒæ˜¯åŸºäº<a href="https://github.com/novoda/bintray-release">bintray-releaseæ’ä»¶</a>åšäº†ä¸€äº›æ”¹é€ ,ç„¶åæ”¯æŒGradleç‰ˆæœ¬ä¸º6.+ä¸Šä¼ </p></blockquote><ol><li>åœ¨ä½ moduleçš„build.gradleä¸‹é…ç½®å¦‚ä¸‹ä»£ç å³å¯</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>================================bintray ä¸Šä¼ æ’ä»¶é…ç½® start=========================================<br>apply plugin: <span class="hljs-string">&#x27;com.github.panpf.bintray-publish&#x27;</span><br><br><span class="hljs-regexp">//</span>é˜²æ­¢ä¸­æ–‡æ³¨é‡Šå‡ºç°é”™è¯¯<br>allprojects &#123;<br>    tasks.withType(Javadoc) &#123;<br>        options.addStringOption(<span class="hljs-string">&#x27;Xdoclint:none&#x27;</span>, <span class="hljs-string">&#x27;-quiet&#x27;</span>)<br>        options.addStringOption(<span class="hljs-string">&#x27;encoding&#x27;</span>, <span class="hljs-string">&#x27;UTF-8&#x27;</span>)<br>    &#125;<br>&#125;<br><br>buildscript &#123;<br>    repositories &#123;<br>        jcenter()<br>    &#125;<br>    dependencies &#123;<br>      <span class="hljs-regexp">//</span>ä¸Šä¼ æ’ä»¶<br>        classpath <span class="hljs-string">&#x27;com.github.panpf.bintray-publish:bintray-publish:1.0.0&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-regexp">//</span>ä¸‹é¢è¿™äº›é…ç½®æ¢æˆä½ è‡ªå·±çš„å³å¯<br>publish &#123;<br>    userOrg = <span class="hljs-string">&#x27;sweetying520&#x27;</span>  <span class="hljs-regexp">//</span>Bintrayç”¨æˆ·å<br>    repoName = <span class="hljs-string">&#x27;maven&#x27;</span> <span class="hljs-regexp">//</span>Bintrayä¸Šåˆ›å»ºçš„ä»“åº“å,å¦‚æœä½ åˆ›å»ºçš„æ˜¯maven,åˆ™å¯ä»¥å¹²æ‰è¿™ä¸€è¡Œ,å¦åˆ™éœ€è¦æŒ‡å®šä»“åº“å<br>    groupId = <span class="hljs-string">&#x27;com.github.sweetying520&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„x<br>    artifactId = <span class="hljs-string">&#x27;AndroidUtils&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„y<br>    publishVersion = <span class="hljs-string">&#x27;1.0.0&#x27;</span> <span class="hljs-regexp">//</span>ä¾èµ–åimplementation <span class="hljs-string">&#x27;x:y:z&#x27;</span>ä¸­çš„z<br>    desc = <span class="hljs-string">&#x27;AndroidUtils is a library of tools to help developers improve their productivity&#x27;</span> <span class="hljs-regexp">//</span>å¯¹è¿™ä¸ªåº“çš„æè¿°<br>    website = <span class="hljs-string">&#x27;https://github.com/sweetying520/AndroidUtils&#x27;</span> <span class="hljs-regexp">//</span>VCSåœ°å€,å¡«å†™è¯¥é¡¹ç›®çš„Githubåœ°å€å°±å¥½<br>&#125;<br><span class="hljs-regexp">//</span>================================bintray ä¸Šä¼ æ’ä»¶é…ç½® end=========================================<br></code></pre></td></tr></table></figure><ol start="2"><li><p>ä¸Šä¼ é¡¹ç›®åˆ°JCenter</p><ol><li><p>åœ¨ä½ çš„AndroidStudioçš„Terminalä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">å¦‚æœæ˜¯Windowsç³»ç»Ÿ:<br><br>gradlew clean build bintrayUpload <span class="hljs-attribute">-PbintrayUser</span>=<span class="hljs-string">&quot;Bintrayç”¨æˆ·å&quot;</span> <span class="hljs-attribute">-PbintrayKey</span>=<span class="hljs-string">&quot;Binaryå¾—åˆ°çš„API Key&quot;</span> <span class="hljs-attribute">-PdryRun</span>=<span class="hljs-literal">false</span><br>   <br>å¦‚æœæ˜¯Macç³»ç»Ÿ:<br><br>./gradlew clean build bintrayUpload <span class="hljs-attribute">-PbintrayUser</span>=<span class="hljs-string">&quot;Bintrayç”¨æˆ·å&quot;</span> <span class="hljs-attribute">-PbintrayKey</span>=<span class="hljs-string">&quot;Binaryå¾—åˆ°çš„API Key&quot;</span> <span class="hljs-attribute">-PdryRun</span>=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢<strong>PbintrayUser</strong>ä»£è¡¨æ³¨å†Œçš„ç”¨æˆ·åï¼Œ<strong>PbintrayKey</strong>å°±æ˜¯éœ€è¦åœ¨Binaryå¾—åˆ°çš„API Keyï¼ŒPdryRunæ˜¯ä¸€ä¸ªé…ç½®å‚æ•°ï¼Œä¸ºtrueçš„æ—¶å€™ï¼Œä¼šè¿è¡Œæ‰€æœ‰çš„ç¯èŠ‚ï¼Œä½†æ˜¯ä¸ä¼šä¸Šä¼ </p></li><li><p>å¦‚ä½•è·å–Binaryå¾—åˆ°çš„API Key?</p><ol><li><p>ç‚¹å‡»1çš„Edit Profile</p></li><li><p>ç‚¹å‡»2çš„API Key</p></li><li><p>è¾“å…¥3çš„å¯†ç å³å¯è·å–API Key</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1ad70987d56d40ac9a4c3b73d77a3ff4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110152109989"></p></li></ol></li></ol></li><li><p>è‡³æ­¤,å·²ç»å°†é¡¹ç›®ä¸Šä¼ åˆ°JCenterä¸Šé¢å»äº†,æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åº“ç›¸å…³ä¿¡æ¯</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/baca177c4c89447385aa088ed8b07db8~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110152638520"></p><p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™,æˆ‘ä»¬çš„åº“è¿˜ä¸èƒ½è¢«å¤–ç•Œç»™å¼•ç”¨åˆ°</p></li></ol><h3 id="æ­¥éª¤6-æ·»åŠ åˆ°JCenter"><a href="#æ­¥éª¤6-æ·»åŠ åˆ°JCenter" class="headerlink" title="æ­¥éª¤6: æ·»åŠ åˆ°JCenter"></a>æ­¥éª¤6: æ·»åŠ åˆ°JCenter</h3><ol><li><p>ä»Bintrayä¸Šæ‰“å¼€æŸ¥çœ‹è¯¥åº“çš„ä¿¡æ¯,ç‚¹å‡»æ·»åŠ Add to JCenteræŒ‰é’®</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/982c86aae178457da160e2391bbc273a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110153737396"></p></li><li><p>å¡«å†™ä¸€äº›å¯¹libraryçš„æè¿°ï¼Œç„¶åå‘é€ï¼Œç­‰å¾…å®¡æ ¸,å®¡æ ¸æ—¶é—´ä¸€èˆ¬å‡ åˆ†é’Ÿåˆ°å‡ ä¸ªå°æ—¶,å·¥ä½œæ—¥ä¼šå¿«ç‚¹,å®¡æ ¸é€šè¿‡åä¼šé‚®ä»¶é€šçŸ¥ä½ ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ„‰å¿«çš„é€šè¿‡ä¾èµ–ä½¿ç”¨è¿™ä¸ªåº“äº†</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f9bcc30806140a9b66ade7812e415b3~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110154334641"></p></li><li><p>åœ¨ä½ çš„Appæˆ–è€…Moduleçš„build.gradleä¸­æ·»åŠ å¦‚ä¸‹ä»£ç å°±å¯ä»¥ä½¿ç”¨äº†</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs clean">dependencies &#123;<br>    <span class="hljs-keyword">implementation</span> <span class="hljs-string">&#x27;com.github.sweetying520:AndroidUtils:1.0.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>éªŒè¯æ•ˆæœ,æˆ‘çš„Demoä¸­æ˜¯ç”¨Toastæ˜¾ç¤ºä¸€å¥â€äºŒä»£666â€</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a231167e3c042b9aa82c6540bb77b42~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110172426166"></p></li></ol><h3 id="å…³äºåç»­ç‰ˆæœ¬æ›´æ–°"><a href="#å…³äºåç»­ç‰ˆæœ¬æ›´æ–°" class="headerlink" title="å…³äºåç»­ç‰ˆæœ¬æ›´æ–°"></a>å…³äºåç»­ç‰ˆæœ¬æ›´æ–°</h3><ol><li><p>ä¿®æ”¹moduleä¸­build.gradleçš„é…ç½®ç‰ˆæœ¬å·</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0bd7f1b51c3b4876b1e21b2ef759a9f5~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210111103047291"></p></li><li><p>åœ¨ä½ çš„AndroidStudioçš„Terminalä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">//</span>å¦‚æœæ˜¯Windowsç³»ç»Ÿ:<br>gradlew clean build bintrayUpload -PbintrayUser=<span class="hljs-string">&quot;Bintrayç”¨æˆ·å&quot;</span> -PbintrayKey=<span class="hljs-string">&quot;Binaryå¾—åˆ°çš„API Key&quot;</span> -PdryRun=<span class="hljs-literal">false</span><br><br>å¦‚æœæ˜¯Macç³»ç»Ÿ:<br><span class="hljs-string">./gradlew</span> clean build bintrayUpload -PbintrayUser=<span class="hljs-string">&quot;Bintrayç”¨æˆ·å&quot;</span> -PbintrayKey=<span class="hljs-string">&quot;Binaryå¾—åˆ°çš„API Key&quot;</span> -PdryRun=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œä¹‹å,ç­‰å¾…ä¸€æ®µæ—¶é—´,ä½ å°±å¯ä»¥å»Bintrayä¸Šçœ‹åˆ°ä½ æ›´æ–°çš„ç‰ˆæœ¬äº†</p></li></ol><h2 id="æ–¹å¼äºŒ-å‘å¸ƒAndroidåº“åˆ°JitPack"><a href="#æ–¹å¼äºŒ-å‘å¸ƒAndroidåº“åˆ°JitPack" class="headerlink" title="æ–¹å¼äºŒ: å‘å¸ƒAndroidåº“åˆ°JitPack"></a>æ–¹å¼äºŒ: å‘å¸ƒAndroidåº“åˆ°JitPack</h2><p>è¿˜æ˜¯ä»¥ä¸Šé¢è¿™ä¸ªç¼–å†™çš„åº“ä¸ºä¾‹</p><h3 id="æ­¥éª¤1ï¼šåˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™Androidåº“"><a href="#æ­¥éª¤1ï¼šåˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™Androidåº“" class="headerlink" title="æ­¥éª¤1ï¼šåˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™Androidåº“"></a>æ­¥éª¤1ï¼šåˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™Androidåº“</h3><h3 id="æ­¥éª¤2ï¼šé…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ è‡³Github"><a href="#æ­¥éª¤2ï¼šé…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ è‡³Github" class="headerlink" title="æ­¥éª¤2ï¼šé…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ è‡³Github"></a>æ­¥éª¤2ï¼šé…ç½®ä¸Šä¼ æ’ä»¶å¹¶ä¸Šä¼ è‡³Github</h3><blockquote><p><strong>æ³¨æ„</strong></p><p>æ’ä»¶ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨æœ€æ–°çš„,ä»¥å®˜ç½‘ä¸ºä¸» <a href="https://github.com/dcendents/android-maven-gradle-plugin">ä¼ é€é—¨</a></p></blockquote><ol><li><p>åœ¨ä½ moduleçš„build.gradleä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-comment">//==============================JitPack ä¸Šä¼ æ’ä»¶é…ç½® start=====================</span><br>apply plugin: <span class="hljs-string">&#x27;com.github.dcendents.android-maven&#x27;</span><br><span class="hljs-comment">//ç»„å com.githubæ˜¯å›ºå®šçš„,åé¢çš„sweetying520æ˜¯æˆ‘Githubçš„ç”¨æˆ·å,æ›¿æ¢æˆä½ è‡ªå·±çš„å°±å¯ä»¥äº†</span><br><span class="hljs-keyword">group</span>=<span class="hljs-string">&#x27;com.github.sweetying520&#x27;</span><br><br><span class="hljs-keyword">buildscript</span> &#123;<br>    <span class="hljs-keyword">repositories</span> &#123;<br>        jcenter()<br>    &#125;<br>    <span class="hljs-keyword">dependencies</span> &#123;<br>    <span class="hljs-comment">//è¿™é‡Œæˆ‘å†™çš„æ—¶å€™æ˜¯è¿™ä¸ªç‰ˆæœ¬</span><br>        <span class="hljs-keyword">classpath</span> <span class="hljs-string">&#x27;com.github.dcendents:android-maven-gradle-plugin:2.1&#x27;</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//==============================JitPack ä¸Šä¼ æ’ä»¶é…ç½® end=======================</span><br></code></pre></td></tr></table></figure></li><li><p>å°†é¡¹ç›®ä¸Šä¼ åˆ°Github,ä¸æ‡‚å¦‚ä½•ä¸Šä¼ çš„è‡ªå·±ä¸Šç½‘æŸ¥ä¸€ä¸‹</p></li></ol><h3 id="æ­¥éª¤3ï¼šæ‰“å¼€é¡¹ç›®çš„githubä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ªReleaseæˆ–Tag"><a href="#æ­¥éª¤3ï¼šæ‰“å¼€é¡¹ç›®çš„githubä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ªReleaseæˆ–Tag" class="headerlink" title="æ­¥éª¤3ï¼šæ‰“å¼€é¡¹ç›®çš„githubä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ªReleaseæˆ–Tag"></a>æ­¥éª¤3ï¼šæ‰“å¼€é¡¹ç›®çš„githubä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ªReleaseæˆ–Tag</h3><ol><li><p>ç‚¹å‡»å¦‚ä¸‹å›¾æŒ‡ç¤º</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e4e424e448f4041a31630d2d443ad4b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110161833850"></p></li><li><p>åˆ›å»ºä¸€ä¸ªReleaseæˆ–è€…Tag</p><p><strong>æ³¨æ„</strong></p><ol><li><p>é¦–æ¬¡è¿›æ¥æ˜¯è¿™æ ·å­çš„</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba15384fec564aeeba00366cf859ba26~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110162350536"></p></li><li><p>åˆ›å»ºè¿‡ç‰ˆæœ¬ä¹‹å,è¿›æ¥æ˜¯è¿™æ ·å­çš„</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f26dec9bfdfc41f58c64afe51099e518~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110162314370"></p></li><li><p>åˆ›å»ºç‰ˆæœ¬</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69e5c9ee1c7e4698af2d7a6b9b69ae00~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110163349014"></p></li></ol></li></ol><h3 id="æ­¥éª¤4-å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ°JitPack"><a href="#æ­¥éª¤4-å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ°JitPack" class="headerlink" title="æ­¥éª¤4: å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ°JitPack"></a>æ­¥éª¤4: å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ°<a href="https://jitpack.io/">JitPack</a></h3><ol><li><p>æ‰“å¼€<a href="https://jitpack.io/">JitPack</a>,å¹¶ç™»é™†(ä½¿ç”¨çš„æ˜¯ä½ çš„Githubè´¦å·ç™»é™†å³å¯)</p></li><li><p>å°†ä½ çš„é¡¹ç›®Githubåœ°å€æ”¾å…¥æœç´¢æ ,ç‚¹å‡»look up,è¿™ä¸ªæ—¶å€™å°±ä¼šè¿›è¡Œç¼–è¯‘,ç­‰å¾…ç¼–è¯‘å®Œæˆå³å¯,ä¸‹é¢çš„Versionæ˜¯æˆ‘ä¹‹å‰ç”Ÿæˆçš„ä¸€äº›ç‰ˆæœ¬</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b5e669348011438485594afed1950d04~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110165357849"></p><p>ç¼–è¯‘å®ŒæˆåJitPackä¼šè‡ªåŠ¨ç»™ä½ ç”Ÿæˆç›¸å…³çš„é…ç½®ä¿¡æ¯,æŒ‰ç…§å¦‚ä¸‹é…ç½®,é…ç½®ä½ çš„é¡¹ç›®å³å¯ </p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf3b57d281cb4cc292adca3e3f3f4f08~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210110165537556"></p><p>æœ€åå°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œä½¿ç”¨äº†!!!</p></li></ol><h3 id="å…³äºåç»­ç‰ˆæœ¬æ›´æ–°-1"><a href="#å…³äºåç»­ç‰ˆæœ¬æ›´æ–°-1" class="headerlink" title="å…³äºåç»­ç‰ˆæœ¬æ›´æ–°"></a>å…³äºåç»­ç‰ˆæœ¬æ›´æ–°</h3><ol><li>å°†ä¿®æ”¹å¥½çš„ä¸œè¥¿ä¸Šä¼ åˆ°Github</li><li>æ‰“å¼€é¡¹ç›®çš„githubä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ªReleaseæˆ–Tag(è¿™ä¸ªæ­¥éª¤å°±æ˜¯é‡å¤æ­¥éª¤3)</li><li>å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ°<a href="https://jitpack.io/">JitPack</a>(è¿™ä¸ªæ­¥éª¤å°±æ˜¯é‡å¤æ­¥éª¤4)</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆ°è¿™é‡Œ,ä¸¤ç§å¼•ç”¨æ–¹å¼å°±éƒ½ä»‹ç»å®Œäº†,å¯¹æ¯”ä¸‹è¿™ä¸¤ç§ä¸Šä¼ åº“çš„æ–¹å¼:</p><p>ä¸Šä¼ åˆ°JitPack: ç®€å•,çœæ—¶,é¡¹ç›®ä¾èµ–çš„æ—¶å€™,éœ€å¼•å…¥JitPackä»“åº“</p><p>ä¸Šä¼ åˆ°JCenter: æµç¨‹ç›¸å¯¹JitPackå¤æ‚ä¸€ç‚¹,é¡¹ç›®ä¾èµ–çš„æ—¶å€™,ç›´æ¥å¼•ç”¨å³å¯,ä½†æ˜¯ä¸Šä¼ çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å‘,æ–‡ä¸­éƒ½å·²ç»åšäº†è¯´æ˜,å› æ­¤æŒ‰ç…§æˆ‘çš„æ­¥éª¤èµ°,åº”è¯¥å°±æ²¡å•¥é—®é¢˜</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>ä¸€ç¯‡å°±å¤Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>ä¸€ç¯‡å°±å¤Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlin ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šKotlinåç¨‹(ä¸Š)</title>
    <link href="/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AKotlin%E5%8D%8F%E7%A8%8B(%E4%B8%8A)/"/>
    <url>/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AKotlin%E5%8D%8F%E7%A8%8B(%E4%B8%8A)/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b0df73f208c14ee89d6efa1043fd0a62~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº† Kotlin æ³›å‹ï¼Œä½¿ç”¨æ³›å‹èƒ½ä½¿æˆ‘ä»¬çš„ä»£ç å…·æœ‰å¯å¤ç”¨æ€§ï¼Œé¿å…ç±»å‹è½¬æ¢å¼‚å¸¸ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6950042154496425992">â€œKotlinâ€ç³»åˆ—: äºŒã€Kotlinæ³›å‹</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›å…¥ Kotlin åç¨‹çš„å­¦ä¹ ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œ Kotlin åç¨‹ä¹Ÿæ˜¯å±äºé‚£ç§æ¯”è¾ƒéš¾ç†è§£çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä¼šå°½é‡ç”¨æ¯”è¾ƒé€šä¿—æ˜“æ‡‚çš„è¯­è¨€å»è¿›è¡Œè®²è§£ï¼Œå¸Œæœ›é€šè¿‡æˆ‘çš„æ–‡ç« èƒ½å¸¦é¢†å¤§å®¶æ”»å…‹ Kotlin åç¨‹</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>é¦–å…ˆè¿˜æ˜¯å…ˆæŠ›å‡ºä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œå¤§å®¶ææ¸…æ¥šè¿™äº›é—®é¢˜åå­¦ä¹  Kotlin åç¨‹å¯èƒ½ä¼šè½»æ¾ä¸€ç‚¹ï¼š</p><p>1ã€ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿä»€ä¹ˆæ˜¯å¹¶è¡Œï¼Ÿ</p><p>2ã€ä»€ä¹ˆæ˜¯å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯æŠ¢å å¼å¤šä»»åŠ¡ï¼Ÿ</p><p>3ã€ä»€ä¹ˆæ˜¯åŒæ­¥ï¼Ÿä»€ä¹ˆæ˜¯å¼‚æ­¥ï¼Ÿ</p><p>4ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼ï¼Ÿä»€ä¹ˆæ˜¯é˜»å¡å¼ï¼Ÿ</p><p>5ã€ä»€ä¹ˆæ˜¯æŒ‚èµ·ï¼Ÿ</p><p>6ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼æŒ‚èµ·ï¼Ÿ</p><p>7ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ</p><p>8ã€ä»€ä¹ˆæ˜¯ Kotlin åç¨‹ï¼Ÿ</p><p>9ã€Kotlin åç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p><h3 id="1ã€ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿä»€ä¹ˆæ˜¯å¹¶è¡Œï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿä»€ä¹ˆæ˜¯å¹¶è¡Œï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿä»€ä¹ˆæ˜¯å¹¶è¡Œï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿä»€ä¹ˆæ˜¯å¹¶è¡Œï¼Ÿ</h3><p>1ï¼‰ã€å¹¶å‘å°±æ˜¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€æ¡æŒ‡ä»¤åœ¨æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸º CPU æ—¶é—´ç‰‡éå¸¸çš„å°ï¼Œå¤šä¸ªæŒ‡ä»¤é—´èƒ½å¤Ÿå¿«é€Ÿçš„åˆ‡æ¢ï¼Œä½¿å¾—æˆ‘ä»¬çœ‹èµ·æ¥æ‹¥æœ‰åŒæ—¶æ‰§è¡Œçš„æ•ˆæœï¼Œå­˜åœ¨äºå•æ ¸æˆ–å¤šæ ¸ CPU ç³»ç»Ÿä¸­</p><p>2ï¼‰ã€å¹¶è¡Œå°±æ˜¯åŒä¸€æ—¶åˆ»æœ‰å¤šæ¡æŒ‡ä»¤åŒæ—¶åœ¨æ‰§è¡Œï¼Œå­˜åœ¨äºå¤šæ ¸ CPU ç³»ç»Ÿä¸­</p><p>ä¸¾ä¸ªç”Ÿæ´»ä¸­äººåƒé¦’å¤´çš„ä¾‹å­ï¼šä¸€ä¸ªäººä¹°äº† 3 ä¸ªé¦’å¤´ï¼Œé‚£ä¹ˆä»–åŒä¸€æ—¶åˆ»åªèƒ½åœ¨åƒä¸€ä¸ªé¦’å¤´ï¼Œè¿™æ˜¯å¹¶å‘ã€‚è€Œ 3 ä¸ªäººæ¯äººä¹°äº†ä¸€ä¸ªé¦’å¤´ï¼Œé‚£ä¹ˆåŒä¸€æ—¶åˆ»ä»–ä»¬èƒ½åŒæ—¶åƒé¦’å¤´ï¼Œè¿™æ˜¯å¹¶è¡Œã€‚å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«åœ¨äºåŒä¸€æ—¶åˆ»æ˜¯å¦åœ¨åŒæ—¶è¿›è¡Œ</p><h3 id="2ã€ä»€ä¹ˆæ˜¯å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯æŠ¢å å¼å¤šä»»åŠ¡ï¼Ÿ"><a href="#2ã€ä»€ä¹ˆæ˜¯å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯æŠ¢å å¼å¤šä»»åŠ¡ï¼Ÿ" class="headerlink" title="2ã€ä»€ä¹ˆæ˜¯å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯æŠ¢å å¼å¤šä»»åŠ¡ï¼Ÿ"></a>2ã€ä»€ä¹ˆæ˜¯å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿä»€ä¹ˆæ˜¯æŠ¢å å¼å¤šä»»åŠ¡ï¼Ÿ</h3><p>1ï¼‰ã€å¤šä»»åŠ¡å°±æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œä¾‹å¦‚æˆ‘å¯ä»¥ä½¿ç”¨ç¬”è®°æœ¬ç”µè„‘æ‰“å¼€ AndroidStudio å’Œç½‘æ˜“äº‘éŸ³ä¹ï¼Œä¸€è¾¹æ’¸ç ä¸€è¾¹å¬æ­Œ</p><p>2ï¼‰ã€åä½œå¼å¤šä»»åŠ¡å°±æ˜¯ä¸€ä¸ªä»»åŠ¡å¾—åˆ°äº† CPU æ—¶é—´ï¼Œé™¤éå®ƒè‡ªå·±æ”¾å¼ƒä½¿ç”¨ CPU ï¼Œå¦åˆ™å°†å®Œå…¨éœ¸å  CPU ï¼Œæ‰€ä»¥ä»»åŠ¡ä¹‹é—´éœ€è¦åä½œï¼Œä½¿ç”¨ä¸€æ®µæ—¶é—´çš„ CPU åï¼Œæ”¾å¼ƒä½¿ç”¨ï¼Œå…¶å®ƒçš„ä»»åŠ¡ä¹Ÿå¦‚æ­¤ï¼Œæ‰èƒ½ä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚ä¸€èˆ¬å‡ºç°åœ¨æ—©æœŸçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå¦‚ Windows 3.1</p><p>3ï¼‰ã€æŠ¢å å¼å¤šä»»åŠ¡å°±æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥åˆ†é…æ¯ä¸ªä»»åŠ¡çš„ CPU ä½¿ç”¨æ—¶é—´ï¼Œåœ¨ä¸€ä¸ªä»»åŠ¡ä½¿ç”¨ä¸€æ®µæ—¶é—´ CPU åï¼Œæ“ä½œç³»ç»Ÿä¼šå‰¥å¤ºå½“å‰ä»»åŠ¡çš„ CPU ä½¿ç”¨æƒï¼ŒæŠŠå®ƒæ’åœ¨è¯¢é—®é˜Ÿåˆ—çš„æœ€åï¼Œå†å»è¯¢é—®ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ä¸€èˆ¬å‡ºç°åœ¨ç°åœ¨ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œå¦‚ Window 95åŠä¹‹åçš„ Windows ç‰ˆæœ¬</p><p>åä½œå¼å¤šä»»åŠ¡å’ŒæŠ¢å å¼å¤šä»»åŠ¡åŒºåˆ«ï¼šåœ¨åä½œå¼å¤šä»»åŠ¡ä¸­ï¼Œå¦‚æœä¸€ä¸ªä»»åŠ¡æ­»é”ï¼Œåˆ™ç³»ç»Ÿä¹Ÿä¼šæ­»é”ã€‚è€ŒæŠ¢å å¼å¤šä»»åŠ¡ä¸­ï¼Œå¦‚æœä¸€ä¸ªä»»åŠ¡æ­»é”ï¼Œç³»ç»Ÿä»èƒ½æ­£å¸¸è¿è¡Œ</p><h3 id="3ã€ä»€ä¹ˆæ˜¯åŒæ­¥ï¼Ÿä»€ä¹ˆæ˜¯å¼‚æ­¥ï¼Ÿ"><a href="#3ã€ä»€ä¹ˆæ˜¯åŒæ­¥ï¼Ÿä»€ä¹ˆæ˜¯å¼‚æ­¥ï¼Ÿ" class="headerlink" title="3ã€ä»€ä¹ˆæ˜¯åŒæ­¥ï¼Ÿä»€ä¹ˆæ˜¯å¼‚æ­¥ï¼Ÿ"></a>3ã€ä»€ä¹ˆæ˜¯åŒæ­¥ï¼Ÿä»€ä¹ˆæ˜¯å¼‚æ­¥ï¼Ÿ</h3><p>è®¡ç®—æœºé¢†åŸŸä¸­çš„åŒæ­¥å’Œå¼‚æ­¥å’Œæˆ‘ä»¬å¹³æ—¶ç”Ÿæ´»ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å°±è®©å¾ˆå¤šäººéš¾ä»¥ç†è§£</p><p>1ï¼‰ã€è®¡ç®—æœºé¢†åŸŸä¸­çš„åŒæ­¥å°±æ˜¯å½“è°ƒç”¨è€…å‘é€ä¸€ä¸ªè°ƒç”¨æŒ‡ä»¤ï¼Œéœ€ç­‰å¾…è¯¥æŒ‡ä»¤æ‰§è¡Œå®Œï¼Œåœ¨ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ˜¯ä¸€ç§ä¸²è¡Œçš„å¤„ç†æ–¹å¼</p><p>2ï¼‰ã€è®¡ç®—æœºé¢†åŸŸä¸­çš„å¼‚æ­¥å°±æ˜¯å½“è°ƒç”¨è€…å‘é€ä¸€ä¸ªè°ƒç”¨æŒ‡ä»¤ï¼Œæ— éœ€ç­‰å¾…è¯¥æŒ‡ä»¤æ‰§è¡Œå®Œï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ˜¯ä¸€ç§å¹¶è¡Œçš„å¤„ç†æ–¹å¼</p><h3 id="4ã€ä»€ä¹ˆæ˜¯é˜»å¡ï¼Ÿä»€ä¹ˆæ˜¯éé˜»å¡ï¼Ÿ"><a href="#4ã€ä»€ä¹ˆæ˜¯é˜»å¡ï¼Ÿä»€ä¹ˆæ˜¯éé˜»å¡ï¼Ÿ" class="headerlink" title="4ã€ä»€ä¹ˆæ˜¯é˜»å¡ï¼Ÿä»€ä¹ˆæ˜¯éé˜»å¡ï¼Ÿ"></a>4ã€ä»€ä¹ˆæ˜¯é˜»å¡ï¼Ÿä»€ä¹ˆæ˜¯éé˜»å¡ï¼Ÿ</h3><p>é˜»å¡å¾ˆç®€å•ï¼Œå°±æ˜¯å­—é¢æ„æ€ï¼Œåœ¨ Android ä¸­çš„ä½“ç°ï¼Œå…¶å®å°±æ˜¯é˜»å¡äº†ä¸»çº¿ç¨‹çš„è¿è¡Œï¼Œé‚£ä¹ˆéé˜»å¡å°±æ˜¯æ²¡æœ‰å¡ä½ä¸»çº¿ç¨‹çš„è¿è¡Œ</p><h3 id="5ã€ä»€ä¹ˆæ˜¯æŒ‚èµ·ï¼Ÿ"><a href="#5ã€ä»€ä¹ˆæ˜¯æŒ‚èµ·ï¼Ÿ" class="headerlink" title="5ã€ä»€ä¹ˆæ˜¯æŒ‚èµ·ï¼Ÿ"></a>5ã€ä»€ä¹ˆæ˜¯æŒ‚èµ·ï¼Ÿ</h3><p>æŒ‚èµ·å°±æ˜¯ä¿å­˜å½“å‰çŠ¶æ€ï¼Œç­‰å¾…æ¢å¤æ‰§è¡Œï¼Œåœ¨ Android ä¸­çš„ä½“ç°ï¼ŒæŒ‚èµ·å°±æ˜¯ä¸å½±å“ä¸»çº¿ç¨‹çš„å·¥ä½œï¼Œæ›´è´´åˆ‡çš„è¯´æ³•å¯ä»¥ç†è§£ä¸ºåˆ‡æ¢åˆ°äº†ä¸€ä¸ªæŒ‡å®šçš„çº¿ç¨‹ï¼Œ</p><h3 id="6ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼æŒ‚èµ·ï¼Ÿ"><a href="#6ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼æŒ‚èµ·ï¼Ÿ" class="headerlink" title="6ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼æŒ‚èµ·ï¼Ÿ"></a>6ã€ä»€ä¹ˆæ˜¯éé˜»å¡å¼æŒ‚èµ·ï¼Ÿ</h3><p>é€šè¿‡ä¸Šé¢æ¦‚å¿µçš„è§£é‡Šï¼Œéé˜»å¡å¼æŒ‚èµ·å°±æ˜¯ä¸ä¼šå¡ä½ä¸»çº¿ç¨‹ä¸”å°†ç¨‹åºåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªæŒ‡å®šçš„çº¿ç¨‹å»æ‰§è¡Œ</p><h3 id="7ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ"><a href="#7ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ" class="headerlink" title="7ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ"></a>7ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ</h3><p>åç¨‹ï¼Œè‹±æ–‡å Coroutineï¼Œæºè‡ª Simula å’Œ Modula-2 è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€ç§åä½œå¼å¤šä»»åŠ¡å®ç°ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œå¹¶ä¸å±€é™äºç‰¹å®šçš„è¯­è¨€ã€‚åç¨‹è®¾è®¡çš„åˆè¡·æ˜¯ä¸ºäº†è§£å†³å¹¶å‘é—®é¢˜ï¼Œè®©åä½œå¼å¤šä»»åŠ¡å®ç°èµ·æ¥æ›´åŠ æ–¹ä¾¿</p><h3 id="8ã€ä»€ä¹ˆæ˜¯-Kotlin-åç¨‹ï¼Ÿ"><a href="#8ã€ä»€ä¹ˆæ˜¯-Kotlin-åç¨‹ï¼Ÿ" class="headerlink" title="8ã€ä»€ä¹ˆæ˜¯ Kotlin åç¨‹ï¼Ÿ"></a>8ã€ä»€ä¹ˆæ˜¯ Kotlin åç¨‹ï¼Ÿ</h3><p>Kotlin åç¨‹ç®€å•æ¥è¯´æ˜¯ä¸€å¥—çº¿ç¨‹æ“ä½œæ¡†æ¶ï¼Œè¯¦ç»†ç‚¹è¯´å®ƒå°±æ˜¯ä¸€å¥—åŸºäºçº¿ç¨‹è€Œå®ç°çš„ä¸€å¥—æ›´ä¸Šå±‚çš„å·¥å…· APIï¼Œç±»ä¼¼äº Java çš„çº¿ç¨‹æ± ï¼Œä½ å¯ä»¥ç†è§£ Kotlin æ–°é€ äº†ä¸€äº›æ¦‚å¿µç”¨æ¥å¸®åŠ©ä½ æ›´å¥½åœ°ä½¿ç”¨è¿™äº› APIï¼Œä»…æ­¤è€Œå·²</p><h3 id="9ã€Kotlin-åç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#9ã€Kotlin-åç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="9ã€Kotlin åç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>9ã€Kotlin åç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>1ï¼‰ã€Kotlin åç¨‹å¯ä»¥ç”¨çœ‹èµ·æ¥åŒæ­¥çš„æ–¹å¼å†™å‡ºå¼‚æ­¥çš„ä»£ç ï¼Œå¸®ä½ ä¼˜é›…çš„å¤„ç†å›è°ƒåœ°ç‹±</p><p>æ¸…æ¥šäº†ä¸Šé¢è¿™äº›é—®é¢˜åï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹</p><h2 id="ä¸€ã€Kotlin-åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“"><a href="#ä¸€ã€Kotlin-åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“" class="headerlink" title="ä¸€ã€Kotlin åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“"></a>ä¸€ã€Kotlin åç¨‹ç”Ÿæ€å’Œä¾èµ–åº“</h2><p>Kotlin å¹¶æ²¡æœ‰æŠŠåç¨‹çº³å…¥æ ‡å‡†åº“ä¸­ï¼Œè€Œæ˜¯ä»¥ä¾èµ–åº“çš„å½¢å¼æä¾›çš„ï¼Œè¿™æ˜¯ä¸€å¼  Kotlin åç¨‹çš„ç”Ÿæ€å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe3aab023ec74ca0a90d06f6f37bdebe~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210414204413591"></p><p>ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°ï¼ŒKotlin æ ‡å‡†åº“å’Œåç¨‹ä¾èµ–åº“æ‰€æä¾›çš„ä¸œè¥¿ï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Kotlin é¡¹ç›®çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šå¯¼å…¥æ ‡å‡†åº“çš„ä¾èµ–ï¼Œå› æ­¤è¿™é‡Œæ·»åŠ å¦‚ä¸‹åç¨‹ä¾èµ–åº“å°±å¯ä»¥äº†ï¼Œæœ€æ–°åç¨‹ä¾èµ–åº“ç‰ˆæœ¬å¯ä»¥ç‚¹å‡»<a href="https://github.com/Kotlin/kotlinx.coroutines">ä¼ é€é—¨</a>æŸ¥çœ‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//åç¨‹æ ¸å¿ƒåº“</span><br>implementation <span class="hljs-string">&#x27;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.3&#x27;</span><br><span class="hljs-comment">//è¿™ä¸ªåº“åœ¨ Android é¡¹ç›®ä¸­æ‰ä¼šç”¨åˆ°</span><br>implementation <span class="hljs-string">&#x27;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.3&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="äºŒã€ä½¿ç”¨-GlobalScope-launch-å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹"><a href="#äºŒã€ä½¿ç”¨-GlobalScope-launch-å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹" class="headerlink" title="äºŒã€ä½¿ç”¨ GlobalScope.launch å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹"></a>äºŒã€ä½¿ç”¨ GlobalScope.launch å‡½æ•°åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåç¨‹</h2><ul><li>GlobalScope.launch å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œè¿™æ ·ä¼ é€’ç»™ launch å‡½æ•°çš„ä»£ç å—å°±æ˜¯åœ¨åç¨‹ä¸­è¿è¡Œäº†</li><li>GlobalScope.launch å‡½æ•°åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œå½“åº”ç”¨ç¨‹åºè¿è¡Œç»“æŸæ—¶ä¹Ÿä¼šè·Ÿç€ä¸€èµ·ç»“æŸ</li><li>GlobalScope.launch å‡½æ•°åˆ›å»ºçš„åç¨‹å’Œçº¿ç¨‹æœ‰ç‚¹åƒï¼Œå› ä¸ºçº¿ç¨‹æ²¡æœ‰é¡¶çº§è¿™ä¸€è¯´ï¼Œæ‰€ä»¥æ°¸è¿œéƒ½æ˜¯é¡¶çº§çš„</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    GlobalScope.launch &#123;<br>        println(<span class="hljs-string">&quot;codes run in coroutine scope&quot;</span>)<br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µç®€çŸ­çš„ä»£ç å°±æ˜¯å¼€å¯äº†ä¸€ä¸ªåç¨‹ï¼Œå¾ˆç®€å•å§ï¼Œä¸€è¡Œä»£ç å°±å®ç°äº†ï¼Œåç¨‹ä¹Ÿä¸è¿‡å¦‚æ­¤å•ŠğŸ˜‚ã€‚å®é™…ä¸‹é¢è¿™æ®µä»£ç èƒŒååŒ…å«ç€æˆå¨çš„çŸ¥è¯†ç‚¹ï¼š</p><p>1ã€åç¨‹ä½œç”¨åŸŸ</p><p>2ã€åç¨‹ä½œç”¨åŸŸçš„æ‰©å±•å‡½æ•°</p><p>3ã€åç¨‹ä¸Šä¸‹æ–‡</p><p>4ã€åç¨‹å¯åŠ¨æ¨¡å¼</p><p>å¯èƒ½å¤§å®¶ä¼šæœ‰ç‚¹ç–‘æƒ‘ï¼ŒåŒºåŒºä¸€è¡Œä»£ç ï¼Œæ€ä¹ˆå¯èƒ½ä¼šæ¶‰åŠè¿™ä¹ˆå¤šä¸œè¥¿ï¼Ÿä¸ä¿¡æˆ‘ä»¬åœ¨ç‚¹å‡» launch å‡½æ•°çœ‹ä¸‹å®ƒçš„æºç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// launch å‡½æ•°æºç </span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> CoroutineScope.<span class="hljs-title">launch</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    context: <span class="hljs-type">CoroutineContext</span> = EmptyCoroutineContext,</span></span><br><span class="hljs-params"><span class="hljs-function">    start: <span class="hljs-type">CoroutineStart</span> = CoroutineStart.DEFAULT,</span></span><br><span class="hljs-params"><span class="hljs-function">    block: <span class="hljs-type">suspend</span> <span class="hljs-type">CoroutineScope</span>.() -&gt; <span class="hljs-type">Unit</span></span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>: Job &#123;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œlaunch å‡½æ•°æ˜¯ CoroutineScope å³åç¨‹ä½œç”¨åŸŸçš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œå®ƒé‡Œé¢æœ‰ä¸‰ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°ï¼š CoroutineContext å³åç¨‹ä¸Šä¸‹æ–‡ï¼Œæœ‰é»˜è®¤å€¼ã€‚ç¬¬äºŒä¸ªå‚æ•°ï¼š CoroutineStart å³åç¨‹å¯åŠ¨æ¨¡å¼ï¼Œæœ‰é»˜è®¤å€¼ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå‡½æ•°ç±»å‹å‚æ•°ï¼Œæ— é»˜è®¤å€¼ã€‚å› æ­¤ launch å‡½æ•°åœ¨å®é™…è°ƒç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ª Lambda è¡¨è¾¾å¼å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¼ å‚å»è¦†ç›–é»˜è®¤å€¼</p><p>å¥½äº†ï¼ŒçŸ¥é“å®ƒé‡Œé¢æ¶‰åŠåˆ°è¿™ä¹ˆå¤šçŸ¥è¯†ç‚¹ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¿›è¡Œå„ä¸ªå‡»ç ´ï¼Œä¸‹é¢æˆ‘ä¼šè®²è§£åç¨‹ä½œç”¨åŸŸï¼Œå…¶ä»–çš„åœ¨è¿™ç¯‡æ–‡ç« åˆ†æå¯èƒ½æœ‰ç‚¹æ¯ç‡¥ï¼Œæˆ‘ä»¬æ”¾åˆ°ä¸‹ç¯‡æ–‡ç« åœ¨æ¥åˆ†æ</p><h2 id="ä¸‰ã€åç¨‹ä½œç”¨åŸŸ"><a href="#ä¸‰ã€åç¨‹ä½œç”¨åŸŸ" class="headerlink" title="ä¸‰ã€åç¨‹ä½œç”¨åŸŸ"></a>ä¸‰ã€åç¨‹ä½œç”¨åŸŸ</h2><p>å›åˆ°æœ€å¼€å§‹é‚£æ®µä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹åˆ° GlobalScope è¿™ä¸ªä¸œä¸œï¼Œç‚¹è¿›å»çœ‹ä¸€çœ¼å®ƒçš„æºç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">object</span> GlobalScope : CoroutineScope &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Returns [EmptyCoroutineContext].</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext<br>        <span class="hljs-keyword">get</span>() = EmptyCoroutineContext<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šGlobalScope æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œå®ç°äº† CoroutineScope è¿™ä¸ªä¸œä¸œï¼Œå¹¶é‡å†™äº† coroutineContext è¿™ä¸ªå±æ€§</p><h3 id="1ã€CoroutineScope"><a href="#1ã€CoroutineScope" class="headerlink" title="1ã€CoroutineScope"></a>1ã€CoroutineScope</h3><p>æ¥ç€ç‚¹è¿›å» CoroutineScope è¿™ä¸ªä¸œä¸œçœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CoroutineScope</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext<br>&#125;<br></code></pre></td></tr></table></figure><p>1ï¼‰ã€æºç é‡Œé¢æœ‰ä¸€æ®µå¯¹å®ƒçš„æ³¨é‡Šï¼Œç¿»è¯‘è¿‡æ¥å¤§è‡´å°±æ˜¯ï¼šCoroutineScope èƒ½å¤Ÿå®šä¹‰ä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œæ¯ä¸ªåç¨‹æ„å»ºå™¨åƒ launch, async éƒ½æ˜¯å®ƒçš„ä¸€ä¸ªæ‰©å±•ã€‚</p><p>2ï¼‰ã€å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢æŒæœ‰ä¸€ä¸ª CoroutineContext å³åç¨‹ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç±»å®ç°å®ƒï¼Œè®©è¯¥ç±»æˆä¸ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ</p><h3 id="2ã€GlobalScope"><a href="#2ã€GlobalScope" class="headerlink" title="2ã€GlobalScope"></a>2ã€GlobalScope</h3><p>ç°åœ¨å›åˆ° GlobalScope è¿™ä¸ªä¸œä¸œï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥æŠŠå®ƒè§£é‡Šæ¸…æ¥šäº†ï¼šå› ä¸º GlobalScope æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œä¸”å®ç°äº†CoroutineScopeï¼Œæ‰€æœ‰å®ƒæ‹¥æœ‰äº†å…¨å±€çš„åç¨‹ä½œç”¨åŸŸï¼Œä¸”åœ¨æ•´ä¸ª JVM è™šæ‹Ÿæœºä¸­åªæœ‰ä¸€ä»½å¯¹è±¡å®ä¾‹ã€‚å› ä¸ºå®ƒçš„ç”Ÿå‘½å‘¨æœŸè´¯ç©¿æ•´ä¸ª JVMï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™éœ€è¦è­¦æƒ•å†…å­˜æ³„æ¼ã€‚ä¸Šé¢ä»£ç ä¸­è°ƒç”¨çš„ GlobalScope.launchï¼Œå®è´¨ä¸Šæ˜¯è°ƒç”¨äº† CoroutineScope çš„ launch æ‰©å±•å‡½æ•°</p><h3 id="3ã€åç¨‹ä½œç”¨åŸŸä½œç”¨"><a href="#3ã€åç¨‹ä½œç”¨åŸŸä½œç”¨" class="headerlink" title="3ã€åç¨‹ä½œç”¨åŸŸä½œç”¨"></a>3ã€åç¨‹ä½œç”¨åŸŸä½œç”¨</h3><p>é‚£ä¹ˆè¿™é‡Œä½ å¿ƒé‡Œæ˜¯å¦ä¼šæœ‰ä¸ªç–‘é—®ï¼šæ‹¥æœ‰åç¨‹ä½œç”¨åŸŸæœ‰å•¥ç”¨å‘¢ï¼Ÿä½œç”¨å¯å¤§äº†</p><blockquote><p><strong>åç¨‹å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸä¸­æ‰èƒ½å¯åŠ¨ï¼Œåç¨‹ä½œç”¨åŸŸä¸­å®šä¹‰äº†ä¸€äº›çˆ¶å­åç¨‹çš„è§„åˆ™ï¼ŒKotlin åç¨‹é€šè¿‡åç¨‹ä½œç”¨åŸŸæ¥ç®¡æ§åŸŸä¸­çš„æ‰€æœ‰åç¨‹</strong></p></blockquote><p>åç¨‹ä½œç”¨åŸŸé—´å¯å¹¶åˆ—æˆ–åŒ…å«ï¼Œç»„æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œè¿™å°±æ˜¯ Kotlin åç¨‹ä¸­çš„<strong>ç»“æ„åŒ–å¹¶å‘</strong>ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š</p><h3 id="4ã€ä½œç”¨åŸŸç»†åˆ†"><a href="#4ã€ä½œç”¨åŸŸç»†åˆ†" class="headerlink" title="4ã€ä½œç”¨åŸŸç»†åˆ†"></a>4ã€ä½œç”¨åŸŸç»†åˆ†</h3><p>æœ‰ä¸‹è¿°ä¸‰ç§ï¼š</p><p>1ï¼‰ã€<strong>é¡¶çº§ä½œç”¨åŸŸ</strong>ï¼šæ²¡æœ‰çˆ¶åç¨‹çš„åç¨‹æ‰€åœ¨çš„ä½œç”¨åŸŸ</p><p>2ï¼‰ã€<strong>ååŒä½œç”¨åŸŸ</strong>ï¼šåç¨‹ä¸­å¯åŠ¨æ–°åç¨‹(å³å­åç¨‹)ï¼Œæ­¤æ—¶å­åç¨‹æ‰€åœ¨çš„ä½œç”¨åŸŸé»˜è®¤ä¸ºååŒä½œç”¨åŸŸï¼Œå­åç¨‹æŠ›å‡ºçš„æœªæ•è·å¼‚å¸¸éƒ½å°†ä¼ é€’ç»™çˆ¶åç¨‹å¤„ç†ï¼Œçˆ¶åç¨‹åŒæ—¶ä¹Ÿä¼šè¢«å–æ¶ˆï¼›</p><p>3ï¼‰ã€<strong>ä¸»ä»ä½œç”¨åŸŸ</strong>ï¼šä¸ååŒä½œç”¨åŸŸçˆ¶å­å…³ç³»ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äºå­åç¨‹å‡ºç°æœªæ•è·å¼‚å¸¸æ—¶ä¸ä¼šå‘ä¸Šä¼ é€’ç»™çˆ¶åç¨‹</p><h3 id="5ã€çˆ¶å­åç¨‹é—´çš„è§„åˆ™"><a href="#5ã€çˆ¶å­åç¨‹é—´çš„è§„åˆ™" class="headerlink" title="5ã€çˆ¶å­åç¨‹é—´çš„è§„åˆ™"></a>5ã€çˆ¶å­åç¨‹é—´çš„è§„åˆ™</h3><p>1ï¼‰ã€çˆ¶åç¨‹å¦‚æœå–æ¶ˆæˆ–ç»“æŸäº†ï¼Œé‚£ä¹ˆå®ƒä¸‹é¢çš„æ‰€æœ‰å­åç¨‹å‡è¢«å–æ¶ˆæˆ–ç»“æŸ</p><p>2ï¼‰ã€çˆ¶åç¨‹éœ€ç­‰å¾…å­åç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæœ€ç»ˆè¿›å…¥å®ŒæˆçŠ¶æ€ï¼Œè€Œä¸ç®¡çˆ¶åç¨‹æœ¬èº«çš„ä»£ç å—æ˜¯å¦å·²æ‰§è¡Œå®Œ</p><p>3ï¼‰ã€å­åç¨‹ä¼šç»§æ‰¿çˆ¶åç¨‹ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ ï¼Œå¦‚æœè‡ªèº«æœ‰ç›¸åŒ Key çš„æˆå‘˜ï¼Œåˆ™è¦†ç›–å¯¹åº” Keyï¼Œè¦†ç›–æ•ˆæœä»…åœ¨è‡ªèº«èŒƒå›´å†…æœ‰æ•ˆ</p><p>å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œå…³äºåç¨‹ä½œç”¨åŸŸä½ æ˜¯å¦ç†è§£äº†å‘¢ï¼Ÿå¦‚æœä¸æ˜ç™½ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œæˆ–è®¸éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œä½ çš„é—®é¢˜å°±å¼•åˆƒè€Œè§£äº†</p><h2 id="å››ã€ä½¿ç”¨-Delay-å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ"><a href="#å››ã€ä½¿ç”¨-Delay-å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ" class="headerlink" title="å››ã€ä½¿ç”¨ Delay å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ"></a>å››ã€ä½¿ç”¨ Delay å‡½æ•°å»¶è¿Ÿåç¨‹æ‰§è¡Œ</h2><ul><li><p>delay å‡½æ•°æ˜¯ä¸€ä¸ªéé˜»å¡å¼æŒ‚èµ·å‡½æ•°ï¼Œå®ƒå¯ä»¥è®©å½“å‰åç¨‹å»¶è¿Ÿåˆ°æŒ‡å®šçš„æ—¶é—´æ‰§è¡Œï¼Œä¸”åªèƒ½åœ¨åç¨‹çš„ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨</p></li><li><p>å¯¹æ¯” Thread.sleep() å‡½æ•°ï¼Œdelay å‡½æ•°åªä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶ä¸ä¼šå½±å“å…¶ä»–åç¨‹çš„è¿è¡Œï¼Œè€Œ Thread.sleep() å‡½æ•°ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ä¸‹çš„æ‰€æœ‰åç¨‹éƒ½ä¼šè¢«é˜»å¡</p></li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    GlobalScope.launch &#123;<br>        println(<span class="hljs-string">&quot;codes run in coroutine scope&quot;</span>)<br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä½ è¿è¡Œä¸€ä¸‹ä¼šå‘ç°æ—¥å¿—æ‰“å°ä¸å‡ºæ¥ï¼Œå°æœ‹å‹ï¼Œä½ æ˜¯å¦æœ‰å¾ˆå¤šé—®å·ï¼ŸğŸ˜‚</p><p>è¿™æ˜¯å› ä¸ºä»£ç å—ä¸­çš„ä»£ç è¿˜æ²¡æ¥å¾—åŠæ‰§è¡Œï¼Œåº”ç”¨ç¨‹åºå°±ç»“æŸäº†ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç¨‹åºå»¶è¿Ÿä¸€æ®µæ—¶é—´åœ¨ç»“æŸï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    GlobalScope.launch &#123;<br>        println(<span class="hljs-string">&quot;codes run in coroutine scope&quot;</span>)<br>    &#125;  <br>    Thread.sleep(<span class="hljs-number">1000</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>codes run <span class="hljs-keyword">in</span> coroutine scope<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬è®©ä¸»çº¿ç¨‹é˜»å¡äº† 1 ç§’é’Ÿåœ¨æ‰§è¡Œï¼Œå› æ­¤ä»£ç å—ä¸­çš„ä»£ç å¾—åˆ°äº†æ‰§è¡Œã€‚å…¶å®è¿™ç§å†™æ³•è¿˜æ˜¯å­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œå¦‚æœæˆ‘è®©ä»£ç å—ä¸­çš„ä»£ç åœ¨ 1 ç§’é’Ÿå†…ä¸èƒ½è¿è¡Œç»“æŸï¼Œé‚£ä¹ˆå°±ä¼šè¢«å¼ºåˆ¶ä¸­æ–­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    GlobalScope.launch &#123;<br>        println(<span class="hljs-string">&quot;codes run in coroutine scope&quot;</span>)<br>      delay(<span class="hljs-number">1500</span>)<br>        println(<span class="hljs-string">&quot;codes run in coroutine scope finished&quot;</span>)<br>    &#125;  <br>    Thread.sleep(<span class="hljs-number">1000</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>codes run <span class="hljs-keyword">in</span> coroutine scope<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬åœ¨ä»£ç å—ä¸­åŠ å…¥äº†ä¸€ä¸ª delay å‡½æ•°ï¼Œå¹¶åœ¨å…¶ä¹‹ååˆæ‰“å°äº†ä¸€è¡Œæ—¥å¿—ã€‚é‚£ä¹ˆå½“å‰åç¨‹ä¼šæŒ‚èµ· 1.5 ç§’ï¼Œè€Œä¸»çº¿ç¨‹å´åªé˜»å¡äº† 1 ç§’ï¼Œé‚£ä¹ˆé‡æ–°è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œæ–°å¢çš„è¿™æ¡æ—¥å¿—å¹¶æ²¡æœ‰æ‰“å°å‡ºæ¥ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æ¥å¾—åŠè¿è¡Œï¼Œç¨‹åºå°±ç»“æŸäº†ã€‚</p><p>é‚£æœ‰åŠæ³•è®©åç¨‹ä¸­æ‰€æœ‰çš„ä»£ç éƒ½æ‰§è¡Œå®Œäº†ä¹‹ååœ¨ç»“æŸå—ï¼ŸğŸ¤”ï¸</p><p>ç­”ï¼šæœ‰çš„ï¼Œä½¿ç”¨ runBlocking å‡½æ•°</p><h2 id="äº”ã€ä½¿ç”¨-runBlocking-å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ"><a href="#äº”ã€ä½¿ç”¨-runBlocking-å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ" class="headerlink" title="äº”ã€ä½¿ç”¨ runBlocking å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ"></a>äº”ã€ä½¿ç”¨ runBlocking å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½é˜»å¡å½“å‰çº¿ç¨‹çš„åç¨‹ä½œç”¨åŸŸ</h2><ul><li>runBlocking å‡½æ•°å¯ä»¥ä¿è¯åœ¨åç¨‹ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹æ²¡æœ‰å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ä¸€ç›´é˜»å¡å½“å‰çº¿ç¨‹</li></ul><p><strong>æ³¨æ„</strong>ï¼šrunBlocking å‡½æ•°é€šå¸¸åªèƒ½åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåœ¨æ­£å¼ç¯å¢ƒä¸­ä½¿ç”¨ä¼šå®¹æ˜“äº§ç”Ÿä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>       println(<span class="hljs-string">&quot;codes run in coroutine scope&quot;</span>)<br>       delay(<span class="hljs-number">1500</span>)<br>       println(<span class="hljs-string">&quot;codes run in coroutine scope finished&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>codes run <span class="hljs-keyword">in</span> coroutine scope<br>codes run <span class="hljs-keyword">in</span> coroutine scope finished<br></code></pre></td></tr></table></figure><p> ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨äº† runBlocking å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤æ¡æ—¥å¿—éƒ½èƒ½å¤Ÿæ­£å¸¸æ‰“å°å‡ºæ¥äº†ã€‚åˆ°äº†è¿™é‡Œæˆ‘å¿ƒé‡Œä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼šä¸Šé¢çš„ä»£ç éƒ½æ˜¯è·‘åœ¨åŒä¸€ä¸ªåç¨‹ä¸­ï¼Œæˆ‘èƒ½ä¸èƒ½åˆ›å»ºå¤šä¸ªåç¨‹åŒæ—¶è·‘å‘¢ï¼Ÿ</p><p>ç­”ï¼šå¯ä»¥çš„ï¼Œä½¿ç”¨ launch å‡½æ•°</p><h2 id="å…­ã€ä½¿ç”¨-launch-å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹"><a href="#å…­ã€ä½¿ç”¨-launch-å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹" class="headerlink" title="å…­ã€ä½¿ç”¨ launch å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹"></a>å…­ã€ä½¿ç”¨ launch å‡½æ•°åœ¨å½“å‰çš„åç¨‹ä½œç”¨åŸŸä¸‹åˆ›å»ºå­åç¨‹</h2><p>ä¸Šé¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œlaunch å‡½æ•°æ˜¯ CoroutineScope çš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œå› æ­¤åªè¦æ‹¥æœ‰åç¨‹ä½œç”¨åŸŸï¼Œå°±å¯ä»¥è°ƒç”¨ launch å‡½æ•°</p><ul><li>å•ç‹¬ä½¿ç”¨ launch å‡½æ•°å’Œæˆ‘ä»¬åˆšæ‰ä½¿ç”¨çš„ GlobalScope.launch å‡½æ•°ä¸åŒï¼Œ GlobalScope.launch åˆ›å»ºçš„æ˜¯ä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œè€Œ launch å‡½æ•°åˆ›å»ºçš„æ˜¯å­åç¨‹</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>        launch &#123;<br>            println(<span class="hljs-string">&quot;launch1&quot;</span>)<br>            delay(<span class="hljs-number">1000</span>)<br>            println(<span class="hljs-string">&quot;launch1 finished&quot;</span>)<br>        &#125;<br><br>        launch &#123;<br>            println(<span class="hljs-string">&quot;launch2&quot;</span>)<br>            delay(<span class="hljs-number">1000</span>)<br>            println(<span class="hljs-string">&quot;launch2 finished&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>launch1<br>launch2<br>launch1 finished<br>launch2 finished<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬è°ƒç”¨äº†ä¸¤æ¬¡ launch å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºäº†ä¸¤ä¸ªå­åç¨‹ï¼Œè¿è¡Œä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå­åç¨‹çš„æ—¥å¿—æ˜¯äº¤æ›¿æ‰“å°çš„ï¼Œè¿™ä¸€ç°è±¡è¡¨æ˜ä»–ä»¬åƒæ˜¯å¤šçº¿ç¨‹é‚£æ ·å¹¶å‘è¿è¡Œçš„ã€‚ç„¶è€Œè¿™ä¸¤ä¸ªå­åç¨‹å®é™…ä¸Šæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œåªæ˜¯ç”±ç¼–ç¨‹è¯­è¨€æ¥å†³å®šå¦‚ä½•åœ¨å¤šä¸ªåç¨‹ä¹‹é—´è¿›è¡Œè°ƒåº¦ï¼Œè®©è°è¿è¡Œï¼Œè®©è°æŒ‚èµ·ã€‚è°ƒåº¦çš„è¿‡ç¨‹å®Œå…¨ä¸éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸ï¼Œè¿™ä¹Ÿå°±ä½¿å¾—åç¨‹çš„å¹¶å‘æ•ˆç‡å‡ºå¥‡çš„é«˜</p><p>ç›®å‰ launch å‡½æ•°ä¸­çš„é€»è¾‘æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œé‚£ä¹ˆéšç€é€»è¾‘è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†éƒ¨åˆ†ä»£ç æå–åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">performLogistics</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç </span><br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">//è¿™å¥ä»£ç ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸º delay å‡½æ•°åªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨</span><br>    delay(<span class="hljs-number">1500</span>)<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç æŠ¥é”™äº†ï¼Œå› ä¸ºæå–åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­å°±æ²¡æœ‰åç¨‹ä½œç”¨åŸŸäº†ï¼Œé‚£ä¹ˆ delay å‡½æ•°å°±è°ƒç”¨ä¸äº†äº†ï¼Œè›‹ç–¼ï¼Œæœ‰æ²¡æœ‰å…¶ä»–åŠæ³•å‘¢ï¼Ÿ</p><p>ä»”ç»†åˆ†æä¸€ä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“ delay å‡½æ•°åªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸæˆ–è€…å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ï¼Œç°åœ¨æå–å‡ºæ¥çš„å•ç‹¬å‡½æ•°æ²¡æœ‰åç¨‹ä½œç”¨åŸŸäº†ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥æŠŠå®ƒå£°æ˜æˆä¸€ä¸ªæŒ‚èµ·å‡½æ•°å‘¢ï¼Ÿ</p><p>ç­”ï¼šå¯ä»¥çš„ï¼Œä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°ï¼ŒæŒ‚èµ·å‡½æ•°ä¹‹é—´æ˜¯å¯ä»¥ç›¸äº’è°ƒç”¨çš„</p><h2 id="ä¸ƒã€ä½¿ç”¨-suspend-å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°"><a href="#ä¸ƒã€ä½¿ç”¨-suspend-å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°" class="headerlink" title="ä¸ƒã€ä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°"></a>ä¸ƒã€ä½¿ç”¨ suspend å…³é”®å­—å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°</h2><ul><li>suspend å…³é”®å­—èƒ½å°†ä¸€ä¸ªå‡½æ•°å£°æ˜æˆæŒ‚èµ·å‡½æ•°</li><li>æŒ‚èµ·å‡½æ•°å¿…é¡»åœ¨åç¨‹æˆ–è€…å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨</li></ul><p>é‚£ä¹ˆä¸Šé¢ä»£ç æˆ‘ä»¬åŠ ä¸ªå…³é”®å­—ä¿®é¥°ä¸€ä¸‹å°± ok äº†ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">performLogistics</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç </span><br>    <span class="hljs-comment">//...</span><br>    delay(<span class="hljs-number">1500</span>)<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨é—®é¢˜åˆæ¥äº†ï¼Œå¦‚æœæˆ‘æƒ³åœ¨è¿™ä¸ªæŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ launch å‡½æ•°å¯ä»¥ä¹ˆï¼Ÿå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">performLogistics</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//å¤„ç†æˆå¨çš„é€»è¾‘ä»£ç </span><br>    <span class="hljs-comment">//...</span><br>    delay(<span class="hljs-number">1500</span>)<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">//è¿™å¥ä»£ç ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡æœ‰åç¨‹ä½œç”¨åŸŸ</span><br>    launch&#123;<br>      <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç åˆæŠ¥é”™äº†ï¼Œå› ä¸ºæ²¡æœ‰åç¨‹ä½œç”¨åŸŸï¼Œé‚£ä¹ˆå¦‚æœæˆ‘æƒ³è¿™æ ·è°ƒç”¨ï¼Œèƒ½å®ç°ä¹ˆï¼Ÿ</p><p>ç­”ï¼šå¯ä»¥çš„ï¼Œå€ŸåŠ© coroutineScope å‡½æ•°æ¥è§£å†³</p><h2 id="å…«ã€ä½¿ç”¨-coroutineScope-å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ"><a href="#å…«ã€ä½¿ç”¨-coroutineScope-å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ" class="headerlink" title="å…«ã€ä½¿ç”¨ coroutineScope å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ"></a>å…«ã€ä½¿ç”¨ coroutineScope å‡½æ•°åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ</h2><ul><li>coroutineScope å‡½æ•°ä¼šç»§æ‰¿å¤–éƒ¨çš„åç¨‹ä½œç”¨åŸŸå¹¶åˆ›å»ºä¸€ä¸ªå­ä½œç”¨åŸŸ</li><li>coroutineScope å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printDot</span><span class="hljs-params">()</span></span> = coroutineScope &#123;<br>    println(<span class="hljs-string">&quot;.&quot;</span>)<br>    delay(<span class="hljs-number">1000</span>)<br>    launch &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p> ä¸Šè¿°ä»£ç è°ƒç”¨ launch å‡½æ•°å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p><p>å¦å¤–ï¼Œ coroutineScope å‡½æ•°å’Œ runBlocking å‡½æ•°æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒå¯ä»¥ä¿è¯å…¶ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹åœ¨å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¸€ç›´é˜»å¡å½“å‰åç¨‹ã€‚è€Œ runBlocking æ˜¯ä¸€ç›´é˜»å¡å½“å‰çº¿ç¨‹ï¼Œæˆ‘ä»¬æ¥åšä¸ªéªŒè¯ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>        coroutineScope &#123;<br>            launch &#123;<br>                <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span>) &#123;<br>                    println(i)<br>                &#125;<br>            &#125;<br>        &#125;<br>        println(<span class="hljs-string">&quot;coroutineScope finished&quot;</span>)<br>    &#125;<br>    println(<span class="hljs-string">&quot;runBlocking finished&quot;</span>)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">5</span><br>coroutineScope finished<br>runBlocking finished<br></code></pre></td></tr></table></figure><p>ä»æ‰“å°ç»“æœï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯ä¸Šé¢è¿™ä¸€ç»“è®º</p><h2 id="ä¹ã€ä½¿ç”¨-async-å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ"><a href="#ä¹ã€ä½¿ç”¨-async-å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ" class="headerlink" title="ä¹ã€ä½¿ç”¨ async å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ"></a>ä¹ã€ä½¿ç”¨ async å‡½æ•°åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–æ‰§è¡Œç»“æœ</h2><p>ä»ä¸Šé¢çš„å­¦ä¹ æˆ‘ä»¬å¯ä»¥çŸ¥é“ launch å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªå­åç¨‹ï¼Œä½†æ˜¯ launch å‡½æ•°åªèƒ½ç”¨äºæ‰§è¡Œä¸€æ®µé€»è¾‘ï¼Œå´ä¸èƒ½è·å–æ‰§è¡Œçš„ç»“æœï¼Œå› ä¸ºå®ƒçš„è¿”å›å€¼æ°¸è¿œæ˜¯ä¸€ä¸ª Job å¯¹è±¡ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è·å–å®ƒçš„æ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ async å‡½æ•°</p><ul><li>async å‡½æ•°å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸä¸‹æ‰èƒ½è°ƒç”¨</li><li>async å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶è¿”å›ä¸€ä¸ª Deferred å¯¹è±¡ï¼Œå¦‚æœéœ€è¦è·å– async å‡½æ•°ä»£ç å—ä¸­çš„æ‰§è¡Œç»“æœï¼Œåªéœ€è¦è°ƒç”¨ Deferred å¯¹è±¡çš„ await() æ–¹æ³•å³å¯</li><li>async å‡½æ•°åœ¨è°ƒç”¨åä¼šç«‹åˆ»æ‰§è¡Œï¼Œå½“è°ƒç”¨ await() æ–¹æ³•æ—¶ï¼Œå¦‚æœä»£ç å—ä¸­çš„ä»£ç è¿˜æ²¡æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆ await() æ–¹æ³•ä¼šå°†å½“å‰åç¨‹é˜»å¡ä½ï¼Œç›´åˆ°å¯ä»¥è·å– async å‡½æ•°ä¸­çš„æ‰§è¡Œç»“æœ</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>        <span class="hljs-keyword">val</span> start = System.currentTimeMillis()<br>        <span class="hljs-keyword">val</span> result1 = async &#123;<br>            delay(<span class="hljs-number">1000</span>)<br>            <span class="hljs-number">5</span> + <span class="hljs-number">5</span><br>        &#125;.await()<br><br><br>        <span class="hljs-keyword">val</span> result2 = async &#123;<br>            delay(<span class="hljs-number">1000</span>)<br>            <span class="hljs-number">4</span> + <span class="hljs-number">6</span><br>        &#125;.await()<br>        println(<span class="hljs-string">&quot;result is <span class="hljs-subst">$&#123;result1 + result2&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">val</span> end = System.currentTimeMillis()<br>        println(<span class="hljs-string">&quot;cost: <span class="hljs-subst">$&#123;end - start&#125;</span> ms.&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>result <span class="hljs-keyword">is</span> <span class="hljs-number">20</span><br>cost: <span class="hljs-number">2017</span> ms.<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç è¿ç»­ä½¿ç”¨äº†ä¸¤ä¸ª async å‡½æ•°æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶åœ¨ä»£ç å—ä¸­è¿›è¡Œ 1 ç§’çš„å»¶è¿Ÿï¼ŒæŒ‰ç…§åˆšæ‰ä¸Šé¢è¯´çš„ï¼Œawait() æ–¹æ³•åœ¨ async å‡½æ•°ä»£ç å—ä¸­çš„ä»£ç æ‰§è¡Œå®Œä¹‹å‰ä¼šä¸€ç›´å°†å½“å‰åç¨‹é˜»å¡ä½ã€‚æ•´æ®µä»£ç çš„æ‰§è¡Œè€—æ—¶æ˜¯ 2017 msï¼Œè¯´æ˜è¿™é‡Œçš„ä¸¤ä¸ª async å‡½æ•°ç¡®å®æ˜¯ä¸€ç§ä¸²è¡Œçš„å…³ç³»ï¼Œå‰ä¸€ä¸ªæ‰§è¡Œå®Œäº†ä¸‹ä¸€ä¸ªæ‰èƒ½æ‰§è¡Œã€‚å¾ˆæ˜æ˜¾è¿™ç§å†™æ³•æ˜¯æ¯”è¾ƒä½æ•ˆçš„ï¼Œå› ä¸ºä¸¤ä¸ª async å®Œå…¨å¯ä»¥å¼‚æ­¥å»æ‰§è¡Œï¼Œè€Œç°åœ¨å´è¢«æ•´æˆäº†åŒæ­¥ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„å†™æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>        <span class="hljs-keyword">val</span> start = System.currentTimeMillis()<br>        <span class="hljs-keyword">val</span> deferred1 = async &#123;<br>            delay(<span class="hljs-number">1000</span>)<br>            <span class="hljs-number">5</span> + <span class="hljs-number">5</span><br>        &#125;<br><br><br>        <span class="hljs-keyword">val</span> deferred2 = async &#123;<br>            delay(<span class="hljs-number">1000</span>)<br>            <span class="hljs-number">4</span> + <span class="hljs-number">6</span><br>        &#125;<br>        println(<span class="hljs-string">&quot;result is <span class="hljs-subst">$&#123;deferred1.await() + deferred2.await()&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">val</span> end = System.currentTimeMillis()<br>        println(<span class="hljs-string">&quot;cost: <span class="hljs-subst">$&#123;end - start&#125;</span> ms.&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>result <span class="hljs-keyword">is</span> <span class="hljs-number">20</span><br>cost: <span class="hljs-number">1020</span> ms.<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„å†™æ³•æˆ‘ä»¬æ²¡æœ‰åœ¨æ¯æ¬¡è°ƒç”¨ async å‡½æ•°ä¹‹åå°±ç«‹åˆ»ä½¿ç”¨ await() æ–¹æ³•è·å–ç»“æœäº†ï¼Œè€Œæ˜¯ä»…åœ¨éœ€è¦ç”¨åˆ° async å‡½æ•°çš„æ‰§è¡Œç»“æœæ—¶æ‰è°ƒç”¨ await() æ–¹æ³•è¿›è¡Œè·å–ï¼Œè¿™æ · async å‡½æ•°å°±å˜æˆäº†ä¸€ç§å¼‚æ­¥å…³ç³»äº†ï¼Œå¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœä¹ŸéªŒè¯äº†è¿™ä¸€ç‚¹</p><p>æˆ‘æ˜¯ä¸ªå–œæ¬¢å·æ‡’çš„äººï¼Œ async å‡½æ•°æ¯æ¬¡éƒ½è¦è°ƒç”¨ await() æ–¹æ³•æ‰èƒ½è·å–ç»“æœï¼Œæ¯”è¾ƒç¹çï¼Œé‚£æˆ‘å°±ä¼šæƒ³ï¼šæœ‰æ²¡æœ‰ç±»ä¼¼ async å‡½æ•°å¹¶ä¸”ä¸éœ€è¦æ¯æ¬¡éƒ½å»è°ƒç”¨ await() æ–¹æ³•è·å–ç»“æœçš„å‡½æ•°å‘¢ï¼Ÿ</p><p>ç­”ï¼šæœ‰çš„ï¼Œä½¿ç”¨ withContext å‡½æ•°</p><h2 id="10ã€ä½¿ç”¨-withContext-å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„-async-å‡½æ•°"><a href="#10ã€ä½¿ç”¨-withContext-å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„-async-å‡½æ•°" class="headerlink" title="10ã€ä½¿ç”¨ withContext å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„  async å‡½æ•°"></a>10ã€ä½¿ç”¨ withContext å‡½æ•°æ„å»ºä¸€ä¸ªç®€åŒ–ç‰ˆçš„  async å‡½æ•°</h2><ul><li>withContext å‡½æ•°æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå¹¶ä¸”å¼ºåˆ¶è¦æ±‚æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåç¨‹ä¸Šä¸‹æ–‡å‚æ•°ï¼Œè¿™ä¸ªè°ƒåº¦å™¨å…¶å®å°±æ˜¯æŒ‡å®šåç¨‹å…·ä½“çš„è¿è¡Œçº¿ç¨‹</li><li>withContext å‡½æ•°åœ¨è°ƒç”¨åä¼šç«‹åˆ»æ‰§è¡Œï¼Œå®ƒå¯ä»¥ä¿è¯å…¶ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ä»£ç å’Œå­åç¨‹åœ¨å…¨éƒ¨æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¸€ç›´é˜»å¡å½“å‰åç¨‹</li><li>withContext å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå­åç¨‹å¹¶å°†æœ€åä¸€è¡Œçš„æ‰§è¡Œç»“æœä½œä¸ºè¿”å›å€¼</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    runBlocking &#123;<br>        <span class="hljs-keyword">val</span> result = withContext(Dispatchers.Default) &#123;<br>            <span class="hljs-number">5</span> + <span class="hljs-number">5</span><br>        &#125;<br>        println(result)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><h2 id="11ã€ä½¿ç”¨-suspendCoroutine-å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•"><a href="#11ã€ä½¿ç”¨-suspendCoroutine-å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•" class="headerlink" title="11ã€ä½¿ç”¨ suspendCoroutine å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•"></a>11ã€ä½¿ç”¨ suspendCoroutine å‡½æ•°ç®€åŒ–å›è°ƒçš„å†™æ³•</h2><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡å¼‚æ­¥å›è°ƒæœºåˆ¶å»è·å–ç½‘ç»œå“åº”æ•°æ®ï¼Œä¸çŸ¥ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œè¿™ç§å›è°ƒæœºåˆ¶åŸºæœ¬ä¸Šæ˜¯ä¾é åŒ¿åå†…éƒ¨ç±»æ¥å®ç°çš„ï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">sendHttpRequest(<span class="hljs-keyword">object</span> : OnHttpCallBackListener&#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(response: <span class="hljs-type">String</span>)</span></span> &#123;<br>            <br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(exception: <span class="hljs-type">Exception</span>)</span></span> &#123;<br>            <br>    &#125;<br> &#125;)<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨å¤šå°‘åœ°æ–¹å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå°±éœ€è¦ç¼–å†™å¤šå°‘æ¬¡è¿™æ ·çš„åŒ¿åå†…éƒ¨ç±»å»å®ç°ï¼Œè¿™æ ·ä¼šæ˜¾å¾—ç‰¹åˆ«ç¹çã€‚åœ¨æˆ‘ä»¬å­¦ä¹  Kotin åç¨‹ä¹‹å‰ï¼Œå¯èƒ½ç¡®å®æ˜¯æ²¡æœ‰å•¥æ›´ç®€å•çš„å†™æ³•äº†ï¼Œä¸è¿‡ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ© Kotlin åç¨‹é‡Œé¢çš„ suspendCoroutine å‡½æ•°æ¥ç®€åŒ–å›è°ƒçš„å†™æ³•ï¼š</p><ul><li>suspendCoroutine å‡½æ•°å¿…é¡»åœ¨åç¨‹ä½œç”¨åŸŸæˆ–è€…æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†å½“å‰åç¨‹ç«‹å³æŒ‚èµ·ï¼Œç„¶ååœ¨ä¸€ä¸ªæ™®é€šçº¿ç¨‹ä¸­å»æ‰§è¡Œ Lambda è¡¨è¾¾å¼ä¸­çš„ä»£ç </li><li>suspendCoroutine å‡½æ•°çš„ Lambda è¡¨è¾¾å¼å‚æ•°åˆ—è¡¨ä¼šä¼ å…¥ä¸€ä¸ª Contination å‚æ•°ï¼Œè°ƒç”¨å®ƒçš„ resume() æˆ– resumeWithException() æ–¹æ³•å¯ä»¥è®©åç¨‹æ¢å¤æ‰§è¡Œ</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰æˆåŠŸå’Œå¤±è´¥çš„æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">OnHttpCallBackListener</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(response: <span class="hljs-type">String</span>)</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(exception: <span class="hljs-type">Exception</span>)</span></span><br>&#125;<br><br><span class="hljs-comment">//æ¨¡æ‹Ÿå‘é€ä¸€ä¸ªç½‘ç»œè¯·æ±‚</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHttpRequest</span><span class="hljs-params">(url: <span class="hljs-type">String</span>, httpCallBack: <span class="hljs-type">OnHttpCallBackListener</span>)</span></span>&#123;<br><br>&#125;<br><br><span class="hljs-comment">//å¯¹å‘é€çš„ç½‘ç»œè¯·æ±‚å›è°ƒä½¿ç”¨ suspendCoroutine å‡½æ•°è¿›è¡Œå°è£…</span><br><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">request</span><span class="hljs-params">(url: <span class="hljs-type">String</span>)</span></span>: String&#123;<br>    <span class="hljs-keyword">return</span> suspendCoroutine &#123; continuation -&gt;<br>        sendHttpRequest(url,<span class="hljs-keyword">object</span> : OnHttpCallBackListener&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(response: <span class="hljs-type">String</span>)</span></span> &#123;<br>                continuation.resume(response)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(exception: <span class="hljs-type">Exception</span>)</span></span> &#123;<br>                continuation.resumeWithException(exception)<br>            &#125;<br><br>        &#125;)<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“ä½¿ç”¨</span><br><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getBaiduResponse</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">val</span> request = request(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>        <span class="hljs-comment">//å¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œå¤„ç†</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ï¼š</p><p>1ã€æˆ‘ä»¬åœ¨ request å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†åˆšåˆšä»‹ç»çš„ suspendCoroutine å‡½æ•°ï¼Œè¿™æ ·å½“å‰åç¨‹ä¼šç«‹åˆ»è¢«æŒ‚èµ·ï¼Œè€Œ Lambda è¡¨è¾¾å¼ä¸­çš„ä»£ç åˆ™ä¼šåœ¨æ™®é€šçº¿ç¨‹ä¸­æ‰§è¡Œã€‚æ¥ç€æˆ‘ä»¬åœ¨ Lambda è¡¨è¾¾å¼ä¸­è°ƒç”¨äº† sendHttpRequest() æ–¹æ³•å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶é€šè¿‡ä¼ ç»Ÿå›è°ƒçš„æ–¹å¼ç›‘å¬è¯·æ±‚ç»“æœ</p><p>2ã€å¦‚æœè¯·æ±‚æˆåŠŸå°±è°ƒç”¨ Continuation çš„ resume() æ–¹æ³•æ¢å¤è¢«æŒ‚èµ·çš„åç¨‹ï¼Œå¹¶ä¼ å…¥æœåŠ¡å™¨å“åº”çš„æ•°æ®ï¼Œè¯¥å€¼ä¼šæˆä¸º suspendCoroutine å‡½æ•°çš„è¿”å›å€¼</p><p>3ã€å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œå°±è°ƒç”¨ Continuation çš„ resumeWithException() æ–¹æ³•æ¢å¤è¢«æŒ‚èµ·çš„åç¨‹ï¼Œå¹¶ä¼ å…¥å…·ä½“çš„å¼‚å¸¸åŸå› </p><p>4ã€æœ€ååœ¨ getBaiduResponse() ä¸­è¿›è¡Œäº†å…·ä½“ä½¿ç”¨ï¼Œæœ‰æ²¡æœ‰è§‰å¾—è¿™é‡Œçš„ä»£ç æ¸…çˆ½äº†å¾ˆå¤šï¼Ÿç”±äº  getBaiduResponse() æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå½“ getBaiduResponse() è°ƒç”¨äº† request() å‡½æ•°æ—¶ï¼Œå½“å‰åç¨‹ä¼šç«‹åˆ»æŒ‚èµ·ï¼Œç„¶åç­‰å¾…ç½‘ç»œè¯·æ±‚æˆåŠŸæˆ–è€…å¤±è´¥åï¼Œå½“å‰åç¨‹æ‰èƒ½æ¢å¤è¿è¡Œ</p><p>5ã€å¦‚æœè¯·æ±‚æˆåŠŸï¼Œæˆ‘ä»¬å°±èƒ½è·å¾—å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„å“åº”æ•°æ®ï¼Œå¦‚æœè¯·æ±‚å¤±è´¥ï¼Œåˆ™ä¼šç›´æ¥è¿›å…¥ catch è¯­å¥ä¸­</p><p>åˆ°è¿™é‡Œå…¶å®åˆä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼šgetBaiduResponse() å‡½æ•°è¢«å£°æ˜æˆäº†ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå› æ­¤å®ƒåªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸæˆ–å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨äº†ï¼Œä½¿ç”¨èµ·æ¥æ˜¯ä¸æ˜¯éå¸¸æœ‰å±€é™æ€§ï¼Ÿ</p><p>ç­”ï¼šç¡®å®å¦‚æ­¤ï¼Œå› ä¸º suspendCoroutine å‡½æ•°æœ¬èº«å°±æ˜¯è¦ç»“åˆåç¨‹ä¸€èµ·ä½¿ç”¨çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦é€šè¿‡åˆç†çš„é¡¹ç›®æ¶æ„è®¾è®¡å»è§£å†³è¿™ä¸ªé—®é¢˜</p><p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ suspendCoroutine å‡½æ•°å®ç°äº†<strong>çœ‹ä¼¼åŒæ­¥çš„æ–¹å¼å†™å‡ºå¼‚æ­¥çš„ä»£ç </strong>ï¼Œäº‹å®ä¸Š suspendCoroutine å‡½æ•°å‡ ä¹å¯ä»¥ç”¨äºç®€åŒ–ä»»ä½•å›è°ƒçš„å†™æ³•ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ Retrofit å°±å¯ä»¥ä½¿ç”¨ suspendCoroutine å‡½æ•°æ¥ç®€åŒ–å›è°ƒ</p><p>åˆ°äº†è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹åç¨‹æœ‰äº†ä¸€å®šçš„äº†è§£äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†æä¸€ç‚¹æ·±å…¥çš„ä¸œè¥¿</p><h2 id="åäºŒã€Kotlin-ä¸­çš„æŒ‚èµ·æ“ä½œ"><a href="#åäºŒã€Kotlin-ä¸­çš„æŒ‚èµ·æ“ä½œ" class="headerlink" title="åäºŒã€Kotlin ä¸­çš„æŒ‚èµ·æ“ä½œ"></a>åäºŒã€Kotlin ä¸­çš„æŒ‚èµ·æ“ä½œ</h2><p>æŒ‚èµ·ç®—æ˜¯ Kotlin åç¨‹ä¸­çš„ä¸€ä¸ªé»‘é­”æ³•äº†ï¼Œä¸Šé¢æˆ‘ä»¬ç®€å•äº†ä»‹ç»äº†ä¸‹ä½¿ç”¨ suspend å®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†çš„å»å‰–æä¸€ä¸‹ Kotlin ä¸­çš„æŒ‚èµ·æ“ä½œ</p><h3 id="1ã€æŒ‚èµ·çš„æœ¬è´¨"><a href="#1ã€æŒ‚èµ·çš„æœ¬è´¨" class="headerlink" title="1ã€æŒ‚èµ·çš„æœ¬è´¨"></a>1ã€æŒ‚èµ·çš„æœ¬è´¨</h3><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> TAG: String = <span class="hljs-string">&quot;MainActivity&quot;</span><br>  <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br><br>        Log.d(TAG, <span class="hljs-string">&quot;start... &quot;</span>);<br>        GlobalScope.launch(Dispatchers.Main) &#123;<br>            mockTimeConsume()<br>            Log.d(TAG, <span class="hljs-string">&quot;æˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œ&quot;</span>);<br>        &#125;<br>        Log.d(TAG, <span class="hljs-string">&quot;æˆ‘åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†æˆå¨çš„ä»£ç &quot;</span>);<br>    &#125;<br><br><br>    <span class="hljs-comment">//æ¨¡æ‹ŸæŒ‚èµ·å‡½æ•°è€—æ—¶ä»»åŠ¡</span><br>    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mockTimeConsume</span><span class="hljs-params">()</span></span> = withContext(Dispatchers.IO)&#123;<br>        Log.d(TAG, <span class="hljs-string">&quot;ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... &quot;</span> +  + Thread.currentThread().name);<br>        Thread.sleep(<span class="hljs-number">3000</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœå¦‚ä¸‹</span><br>start...<br>æˆ‘åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†æˆå¨çš„ä»£ç <br>ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­...DefaultDispatcher-worker-<span class="hljs-number">2</span><br>æˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œ<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œå¹¶æŒ‡å®šè¯¥åç¨‹åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œ</p><p>2ã€åœ¨åç¨‹ä¸­æ‰§è¡Œ mockTimeConsume è¿™ä¸ªæ–¹æ³•å¹¶æ‰“å°äº†ä¸€å¥ Log</p><p>ç°åœ¨æˆ‘ä»¬ä»çº¿ç¨‹å’Œåç¨‹ä¸¤ä¸ªè§’åº¦å»åˆ†æå®ƒï¼š</p><p>å‰é¢æˆ‘åœ¨å›ç­”é—®é¢˜çš„æ—¶å€™è®²åˆ°è¿‡ï¼ŒæŒ‚èµ·å°±æ˜¯åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªæŒ‡å®šçš„çº¿ç¨‹å»æ‰§è¡Œ</p><p><strong>çº¿ç¨‹</strong></p><p>çº¿ç¨‹ï¼šé‚£ä¹ˆå½“æ‰§è¡Œåˆ°åç¨‹ä¸­çš„ mockTimeConsume() è¿™å¥ä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºé‡åˆ°äº†æŒ‚èµ·å‡½æ•°ï¼Œåç¨‹è¢«æŒ‚èµ·äº†ï¼Œä¸»çº¿ç¨‹å°†ä¼šè·³å‡ºè¿™ä¸ªåç¨‹ï¼Œå¦‚æœä¸‹é¢è¿˜æœ‰ä»£ç ï¼Œåˆ™ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ‰§è¡Œå®ƒç•Œé¢åˆ·æ–°çš„ä»»åŠ¡</p><p><strong>åç¨‹</strong></p><p>åç¨‹ï¼šå½“æ‰§è¡Œåˆ°åç¨‹ä¸­çš„ mockTimeConsume() è¿™å¥ä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºé‡åˆ°äº†æŒ‚èµ·å‡½æ•°ï¼Œå½“å‰åç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œ<strong>æ³¨æ„æ˜¯æ•´ä¸ªåç¨‹è¢«æŒ‚èµ·äº†ï¼Œæ„å‘³ç€ mockTimeConsume() è¿™å¥ä»£ç ä¸‹é¢çš„ä»£ç éƒ½ä¸ä¼šæ‰§è¡Œäº†ï¼Œéœ€ç­‰å¾…æˆ‘è¿™å¥ä»£ç æ‰§è¡Œå®Œä¹‹ååœ¨æ¥ç€å¾€åæ‰§è¡Œ</strong>ï¼Œæ¥ä¸‹æ¥ä¼šåœ¨æŒ‡å®šçš„çº¿ç¨‹æ‰§è¡ŒæŒ‚èµ·å‡½æ•°é‡Œé¢çš„å†…å®¹ã€‚è°æŒ‡å®šçš„ï¼Ÿæ˜¯å½“å‰æŒ‚èµ·å‡½æ•°æŒ‡å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°å†…éƒ¨çš„ withContext ä¼ å…¥çš„ Dispatchers.IO æ‰€æŒ‡å®šçš„ IO çº¿ç¨‹</p><p>Dispatchers è°ƒåº¦å™¨ï¼Œå®ƒå¯ä»¥å°†åç¨‹é™åˆ¶åœ¨ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹æ‰§è¡Œï¼Œæˆ–è€…å°†å®ƒåˆ†æ´¾åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæˆ–è€…è®©å®ƒä¸å—é™åˆ¶åœ°è¿è¡Œ</p><p>å¸¸ç”¨çš„ Dispatchers ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li>Dispatchers.Mainï¼šAndroid ä¸­çš„ä¸»çº¿ç¨‹</li><li>Dispatchers.IOï¼šé’ˆå¯¹ç£ç›˜å’Œç½‘ç»œ IO è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé€‚åˆ IO å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ï¼šè¯»å†™æ–‡ä»¶ï¼Œæ“ä½œæ•°æ®åº“ä»¥åŠç½‘ç»œè¯·æ±‚</li><li>Dispatchers.Defaultï¼šé€‚åˆ CPU å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è®¡ç®—</li></ul><p>å½“æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œåç¨‹ä¸ºæˆ‘ä»¬åšçš„æœ€çˆ½çš„äº‹å°±æ¥äº†ï¼š<strong>æ¢å¤å½“å‰åç¨‹ï¼ŒæŠŠçº¿ç¨‹ä»å…¶ä»–çº¿ç¨‹ï¼Œåˆ‡å›åˆ°äº†å½“å‰çš„çº¿ç¨‹</strong>ã€‚é‚£ä¹ˆæ¥ç€å°±ä¼šæ‰§è¡Œåç¨‹ä¸­ Log.d(TAG, â€œæˆ‘ç­‰æŒ‚èµ·å‡½æ•°æ‰§è¡Œå®Œäº†åœ¨æ‰§è¡Œâ€) è¿™å¥ä»£ç ï¼Œæ•´ä¸ªæµç¨‹å°±ç»“æŸäº†</p><p>é€šè¿‡ä¸Šé¢å¯¹çº¿ç¨‹å’Œåç¨‹ä¸¤ä¸ªè§’åº¦éƒ½åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€äº›ç»“è®ºï¼š</p><p><strong>1ã€è¢« suspend ä¿®é¥°çš„æŒ‚èµ·å‡½æ•°æ¯”æ™®é€šå‡½æ•°å¤šä¸¤ä¸ªæ“ä½œï¼š</strong></p><p>1ï¼‰ã€æŒ‚èµ·ï¼šæš‚åœå½“å‰åç¨‹çš„æ‰§è¡Œï¼Œä¿å­˜æ‰€æœ‰çš„å±€éƒ¨å˜é‡ </p><p>2ï¼‰ã€æ¢å¤ï¼šä»åç¨‹è¢«æš‚åœçš„åœ°æ–¹ç»§ç»­æ‰§è¡Œåç¨‹</p><p><strong>2ã€åç¨‹åœ¨æ‰§è¡Œåˆ°æœ‰ suspend æ ‡è®°çš„æŒ‚èµ·å‡½æ•°æ—¶ï¼Œä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ‰€è°“çš„è¢«æŒ‚èµ·ï¼Œå°±æ˜¯åˆ‡æ¢çº¿ç¨‹</strong></p><p><strong>3ã€åç¨‹è¢«æŒ‚èµ·ä¹‹åéœ€è¦æ¢å¤ï¼Œè€Œæ¢å¤è¿™ä¸ªæ“ä½œæ˜¯åç¨‹æ¡†æ¶ç»™æˆ‘ä»¬åšçš„</strong></p><p>é€šè¿‡ç»“è®º 3 ï¼Œæˆ‘ä»¬å¼•ç”³ä¸€ä¸‹ï¼šå¦‚æœä½ ä¸åœ¨åç¨‹é‡Œé¢è°ƒç”¨æŒ‚èµ·å‡½æ•°ï¼Œæ¢å¤è¿™ä¸ªåŠŸèƒ½æ²¡æ³•å®ç°ï¼Œæ‰€ä»¥ä¹Ÿå°±å›ç­”äº†é—®é¢˜ï¼šä¸ºä»€ä¹ˆæŒ‚èµ·å‡½æ•°å¿…é¡»åœ¨åç¨‹æˆ–è€…å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨</p><p>å†ç»†æƒ³ä¸‹è¿™ä¸ªé€»è¾‘ï¼šä¸€ä¸ªæŒ‚èµ·å‡½æ•°è¦ä¹ˆåœ¨åç¨‹é‡Œè¢«è°ƒç”¨ï¼Œè¦ä¹ˆåœ¨å¦ä¸€ä¸ªæŒ‚èµ·å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå®ƒå…¶å®ç›´æ¥æˆ–è€…é—´æ¥åœ°ï¼Œæ€»æ˜¯ä¼šåœ¨ä¸€ä¸ªåç¨‹é‡Œè¢«è°ƒç”¨çš„</p><p>æ‰€ä»¥ï¼Œè¦æ±‚ suspend å‡½æ•°åªèƒ½åœ¨åç¨‹é‡Œæˆ–è€…å¦ä¸€ä¸ª suspend å‡½æ•°é‡Œè¢«è°ƒç”¨ï¼Œè¿˜æ˜¯ä¸ºäº†è¦è®©åç¨‹èƒ½å¤Ÿåœ¨æŒ‚èµ·å‡½æ•°åˆ‡æ¢çº¿ç¨‹ä¹‹åå†åˆ‡å›æ¥</p><h3 id="2ã€æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ"><a href="#2ã€æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ" class="headerlink" title="2ã€æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ"></a>2ã€æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿ</h3><p>åˆ°è¿™é‡Œä½ å¿ƒé‡Œæ˜¯å¦ä¼šæœ‰å¦å¤–ä¸€ä¸ªç–‘é—®ï¼šåç¨‹æ˜¯æ€ä¹ˆè¢«æŒ‚èµ·çš„ï¼Ÿå¦‚æœä¸Šé¢é‚£ä¸ªæŒ‚èµ·å‡½æ•°è¿™ä¹ˆå†™ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mockTimeConsume</span><span class="hljs-params">()</span></span>&#123;<br>   Log.d(TAG, <span class="hljs-string">&quot;ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­...&quot;</span> + Thread.currentThread().name);<br>   Thread.sleep(<span class="hljs-number">3000</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œåä½ ä¼šå‘ç°æ‰“å°çš„çº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼Œé‚£ä¸ºä»€ä¹ˆæ²¡æœ‰åˆ‡æ¢çº¿ç¨‹å‘¢ï¼Ÿå› ä¸ºå®ƒä¸çŸ¥é“å¾€å“ªåˆ‡ï¼Œéœ€è¦æˆ‘ä»¬å‘Šè¯‰å®ƒï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mockTimeConsume</span><span class="hljs-params">()</span></span> = withContext(Dispatchers.IO)&#123;<br>   Log.d(TAG, <span class="hljs-string">&quot;ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... &quot;</span> +  + Thread.currentThread().name);<br>   Thread.sleep(<span class="hljs-number">3000</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸åŒä¹‹å¤„å…¶å®åœ¨äº withContext å‡½æ•°ã€‚</p><p>å…¶å®é€šè¿‡ withContext æºç å¯ä»¥çŸ¥é“ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª Dispatcher å‚æ•°ï¼Œä¾èµ–è¿™ä¸ª Dispatcher å‚æ•°çš„æŒ‡ç¤ºï¼Œä½ çš„åç¨‹å°±è¢«æŒ‚èµ·äº†ï¼Œç„¶ååˆ‡åˆ°åˆ«çš„çº¿ç¨‹</p><p>æ‰€ä»¥<strong>ä½¿ç”¨ suspend å®šä¹‰çš„æŒ‚èµ·å‡½æ•°ï¼Œè¿˜ä¸æ˜¯çœŸæ­£çš„æŒ‚èµ·å‡½æ•°ï¼ŒçœŸæ­£çš„æŒ‚èµ·å‡½æ•°å†…éƒ¨éœ€è¦è°ƒç”¨åˆ° Kotlin åç¨‹æ¡†æ¶è‡ªå¸¦çš„æŒ‚èµ·å‡½æ•°</strong></p><p>å› æ­¤æˆ‘ä»¬æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œä»…ä»…åªåŠ ä¸Š suspend å…³é”®å­—æ˜¯ä¸è¡Œçš„ï¼Œè¿˜éœ€è¦å‡½æ•°å†…éƒ¨ç›´æ¥æˆ–é—´æ¥åœ°è°ƒç”¨åˆ° Kotlin åç¨‹æ¡†æ¶è‡ªå¸¦çš„ æŒ‚èµ·å‡½æ•°æ‰è¡Œ</p><h3 id="3ã€ä½¿ç”¨-suspend-çš„æ„ä¹‰"><a href="#3ã€ä½¿ç”¨-suspend-çš„æ„ä¹‰" class="headerlink" title="3ã€ä½¿ç”¨ suspend çš„æ„ä¹‰"></a>3ã€ä½¿ç”¨ suspend çš„æ„ä¹‰</h3><p>é€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬çŸ¥é“ï¼Œä½¿ç”¨ suspend å…³é”®å­—ä¿®é¥°çš„å‡½æ•°å¯èƒ½è¿˜ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æŒ‚èµ·å‡½æ•°ï¼Œé‚£å®ƒçš„ä½œç”¨æ˜¯å•¥å‘¢ï¼Ÿ</p><p><strong>èµ·åˆ°ä¸€ä¸ªæé†’çš„ä½œç”¨</strong>ï¼Œæé†’è°ƒç”¨è€…æˆ‘æ˜¯ä¸€ä¸ªè€—æ—¶å‡½æ•°ï¼Œéœ€è¦åœ¨æŒ‚èµ·å‡½æ•°æˆ–è€…åç¨‹ä¸­è°ƒç”¨æˆ‘</p><p>ä¸ºä»€ä¹ˆ suspend å…³é”®å­—å¹¶æ²¡æœ‰å®é™…å»æ“ä½œæŒ‚èµ·ï¼Œä½† Kotlin å´æŠŠå®ƒæä¾›å‡ºæ¥ï¼Ÿ</p><p>å› ä¸ºå®ƒæœ¬æ¥å°±ä¸æ˜¯ç”¨æ¥æ“ä½œæŒ‚èµ·çš„ã€‚</p><p>æŒ‚èµ·çš„æ“ä½œ â€”â€” ä¹Ÿå°±æ˜¯åˆ‡çº¿ç¨‹ï¼Œä¾èµ–çš„æ˜¯æŒ‚èµ·å‡½æ•°é‡Œé¢çš„å®é™…ä»£ç ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå…³é”®å­—</p><p>æ‰€ä»¥è¿™ä¸ªå…³é”®å­—ï¼Œ<strong>åªæ˜¯ä¸€ä¸ªæé†’</strong>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mockTimeConsume</span><span class="hljs-params">()</span></span>&#123;<br>   Log.d(TAG, <span class="hljs-string">&quot;ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­...&quot;</span> + Thread.currentThread().name);<br>   Thread.sleep(<span class="hljs-number">3000</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°è¿™æ®µä»£ç è¿™æ ·åšæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè€Œä¸”ä¼šå½±å“åˆ°ç¨‹åºçš„æ€§èƒ½ï¼ŒAndroidStudio ä¹Ÿä¼šæç¤ºä½  suspend ä¿®é¥°ç¬¦æ˜¯å¤šä½™çš„ã€‚</p><h3 id="4ã€å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ"><a href="#4ã€å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ" class="headerlink" title="4ã€å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ"></a>4ã€å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Ÿ</h3><p>ç¬¬ä¸€æ­¥ï¼šåˆ†æåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å»ä½¿ç”¨æŒ‚èµ·å‡½æ•°ï¼Ÿ</p><p>å¦‚æœä½ çš„æŸä¸ªå‡½æ•°æ¯”è¾ƒè€—æ—¶ï¼Œæ¶‰åŠåˆ°å¤šçº¿ç¨‹æ“ä½œï¼Œå¦‚ï¼šç½‘ç»œè¯·æ±‚ï¼ŒI&#x2F;O æ“ä½œï¼ŒCPU è®¡ç®—å·¥ä½œç­‰éœ€è¦ç­‰å¾…çš„æ“ä½œï¼Œé‚£å°±æŠŠå®ƒå†™æˆ suspend æŒ‚èµ·å‡½æ•°ï¼Œè¿™æ˜¯åŸåˆ™</p><p>ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ suspend å…³é”®å­—ä¿®é¥°ä½ çš„å‡½æ•°ï¼Œå¹¶åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ Kotin åç¨‹æ¡†æ¶æä¾›çš„æŒ‚èµ·å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">mockTimeConsume</span><span class="hljs-params">()</span></span> = withContext(Dispatchers.IO)&#123;<br>   Log.d(TAG, <span class="hljs-string">&quot;ç´§å¼ çš„æ‰§è¡Œè€—æ—¶ä»»åŠ¡ä¸­... &quot;</span> +  + Thread.currentThread().name);<br>   Thread.sleep(<span class="hljs-number">3000</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åä¸‰ã€æ€»ç»“"><a href="#åä¸‰ã€æ€»ç»“" class="headerlink" title="åä¸‰ã€æ€»ç»“"></a>åä¸‰ã€æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« è®²åˆ°äº†ï¼š</p><p>1ã€Kotlin åç¨‹ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›åŸºç¡€æ¦‚å¿µçš„ç†è§£</p><p>2ã€Kotlin åç¨‹çš„åŸºç¡€ä½¿ç”¨ï¼Œä»¥åŠä¸€äº›åç¨‹ä½œç”¨åŸŸæ„å»ºå™¨</p><p>3ã€Kotlin åç¨‹ä¸­å…³äºæŒ‚èµ·çš„ä¸€ä¸ªè¯¦ç»†ä»‹ç»</p><p>åç¨‹çš„å†…å®¹çœŸçš„æŒºå¤šçš„ï¼Œåç»­æˆ‘è¿˜ä¼šå†™ä¸¤ç¯‡å…³äºåç¨‹çš„æ–‡ç« ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p>[ç¬¬ä¸€è¡Œä»£ç  Android ç¬¬3ç‰ˆ]</p><p><a href="https://rengwuxian.com/kotlin-coroutines-2/">æ‰”ç‰©çº¿ - Kotlin åç¨‹çš„æŒ‚èµ·å¥½ç¥å¥‡å¥½éš¾æ‡‚ï¼Ÿä»Šå¤©æˆ‘æŠŠå®ƒçš„çš®ç»™æ‰’äº†</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Kotlin</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Kotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlin ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šKotlinæ³›å‹</title>
    <link href="/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AKotlin%E6%B3%9B%E5%9E%8B/"/>
    <url>/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AKotlin%E6%B3%9B%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05b521446f194f10b323e77e9accaac1~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº† Kotlin å¤§éƒ¨åˆ†çŸ¥è¯†ç‚¹ï¼Œä½“éªŒåˆ°äº† Kotlin è¯­æ³•çš„ä¾¿æ·ï¼Œå¼ºå¤§ï¼Œä»¥åŠé«˜æ•ˆçš„å‡½æ•°å¼ç¼–ç¨‹ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6942251919662383134">â€œKotlinâ€ç³»åˆ—: ä¸€ã€Kotlinå…¥é—¨</a>ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›å…¥ Kotlin æ³›å‹çš„å­¦ä¹ ï¼Œæ³›å‹åœ¨æˆ‘çœ‹æ¥æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯é¢è¯•ä¸­ç»å¸¸é—®çš„ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å¯¹æ³›å‹çš„è®¤è¯†æ¯”è¾ƒæ¨¡ç³Šï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨çš„æ—¶å€™å°±æ›´åŠ ç–‘æƒ‘äº†ï¼Œå› æ­¤è¿™ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¸¦å¤§å®¶æ”»å…‹è¿™ä¸€çŸ¥è¯†ç‚¹</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ä¸‹é¢æˆ‘æŠ›å‡ºä¸€ç³»åˆ—é—®é¢˜ï¼Œå’±ä»¬å¸¦ç€é—®é¢˜å»å­¦ä¹ ï¼š</p><p>1ã€ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ</p><p>2ã€æ³›å‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p>3ã€æ€ä¹ˆå»å®šä¹‰å’Œä½¿ç”¨æ³›å‹ï¼Ÿ</p><h3 id="1ã€ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ</h3><p>æ³›å‹é€šä¿—çš„ç†è§£å°±æ˜¯ï¼šå¾ˆå¤šçš„ç±»å‹ï¼Œå®ƒé€šè¿‡ä½¿ç”¨<strong>å‚æ•°åŒ–ç±»å‹</strong>çš„æ¦‚å¿µï¼Œå…è®¸æˆ‘ä»¬åœ¨ä¸æŒ‡å®šå…·ä½“ç±»å‹çš„æƒ…å†µä¸‹è¿›è¡Œç¼–ç¨‹</p><h3 id="2ã€æ³›å‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#2ã€æ³›å‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="2ã€æ³›å‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>2ã€æ³›å‹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>æ³›å‹æ˜¯ JDK 1.5 å¼•å…¥çš„å®‰å…¨æœºåˆ¶ï¼Œæ˜¯ä¸€ç§ç»™ç¼–è¯‘å™¨ä½¿ç”¨çš„æŠ€æœ¯ï¼š</p><p>1ã€æé«˜äº†ä»£ç çš„å¯é‡ç”¨æ€§</p><p>2ã€å°†è¿è¡ŒæœŸçš„ç±»å‹è½¬æ¢å¼‚å¸¸æå‰åˆ°äº†ç¼–è¯‘æœŸï¼Œä¿è¯ç±»å‹çš„å®‰å…¨ï¼Œé¿å…ç±»å‹è½¬æ¢å¼‚å¸¸</p><h3 id="3ã€æ€ä¹ˆå»å®šä¹‰å’Œä½¿ç”¨æ³›å‹ï¼Ÿ"><a href="#3ã€æ€ä¹ˆå»å®šä¹‰å’Œä½¿ç”¨æ³›å‹ï¼Ÿ" class="headerlink" title="3ã€æ€ä¹ˆå»å®šä¹‰å’Œä½¿ç”¨æ³›å‹ï¼Ÿ"></a>3ã€æ€ä¹ˆå»å®šä¹‰å’Œä½¿ç”¨æ³›å‹ï¼Ÿ</h3><p>æˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ªç±»ï¼Œæ–¹æ³•ï¼Œæˆ–è€…æ¥å£æŒ‡å®šæ³›å‹ï¼Œåœ¨å…·ä½“ä½¿ç”¨çš„åœ°æ–¹æŒ‡å®šå…·ä½“çš„ç±»å‹</p><h2 id="ä¸€ã€Java-æ³›å‹"><a href="#ä¸€ã€Java-æ³›å‹" class="headerlink" title="ä¸€ã€Java æ³›å‹"></a>ä¸€ã€Java æ³›å‹</h2><p>è¦å­¦ä¹ å¥½ Kotlin æ³›å‹ï¼Œæˆ‘ä»¬å…ˆè¦å¯¹ Java æ³›å‹è¶³å¤Ÿçš„äº†è§£ï¼Œå› ä¸º Kotlin æ³›å‹å’Œ Java æ³›å‹åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åœ¨ Kotlin ä¸Šæœ‰äº›ä¸œè¥¿æ¢äº†æ–°çš„å†™æ³•</p><h3 id="1ã€æ³›å‹çš„ç®€å•ä½¿ç”¨"><a href="#1ã€æ³›å‹çš„ç®€å•ä½¿ç”¨" class="headerlink" title="1ã€æ³›å‹çš„ç®€å•ä½¿ç”¨"></a>1ã€æ³›å‹çš„ç®€å•ä½¿ç”¨</h3><p>åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ªç±»ï¼Œæ–¹æ³•ï¼Œæˆ–è€…æ¥å£æŒ‡å®šæ³›å‹ï¼Œåœ¨å…·ä½“ä½¿ç”¨çš„åœ°æ–¹æŒ‡å®šå…·ä½“çš„ç±»å‹</p><p>1ï¼‰ã€å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»ï¼Œåœ¨ç±»åçš„åé¢åŠ ä¸Š <code>&lt;T&gt;</code> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»ï¼Œæ³›å‹å¯ä»¥æœ‰ä»»æ„å¤šä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericClass</span>&lt;T&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> T a;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JavaGenericClass</span><span class="hljs-params">(T a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getA</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setA</span><span class="hljs-params">(T a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-comment">//æ³›å‹ç±»ä½¿ç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">//ç¼–è¯‘å™¨å¯æ¨æ–­æ³›å‹ç±»å‹ï¼Œå› æ­¤ new å¯¹è±¡åé¢çš„æ³›å‹ç±»å‹å¯çœç•¥</span><br>        JavaGenericClass&lt;String&gt; javaGenericClass1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaGenericClass</span>&lt;String&gt;(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        JavaGenericClass&lt;Integer&gt; javaGenericClass2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaGenericClass</span>&lt;&gt;(<span class="hljs-number">666</span>);<br>        System.out.println(javaGenericClass1.getA());<br>        System.out.println(javaGenericClass2.getA());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br><span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p>2ï¼‰ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•çš„è¿”å›å€¼å‰é¢åŠ ä¸Š <code>&lt;T&gt;</code> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œæ³›å‹å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼Œæ³›å‹æ–¹æ³•çš„æ³›å‹ä¸å®ƒæ‰€åœ¨çš„ç±»æ²¡æœ‰ä»»ä½•å…³ç³»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericMethod</span> &#123;<br><br>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">getName</span><span class="hljs-params">(T t)</span>&#123;<br>        System.out.println(t.getClass().getSimpleName());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">JavaGenericMethod</span> <span class="hljs-variable">javaGenericMethod</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaGenericMethod</span>();<br>      <span class="hljs-comment">//ç¼–è¯‘å™¨å¯æ¨æ–­å‡ºæ³›å‹ç±»å‹ï¼Œå› æ­¤è¿™é‡Œçš„æ³›å‹ç±»å‹ä¹Ÿå¯çœç•¥</span><br>        javaGenericMethod.&lt;String&gt;getName(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>String<br></code></pre></td></tr></table></figure><p>3ï¼‰ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£</p><p>åœ¨æ¥å£åçš„åé¢åŠ ä¸Š <code>&lt;T&gt;</code> è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œæ³›å‹å¯ä»¥æœ‰ä»»æ„å¤šä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">JavaGenericInterface</span>&lt;T&gt; &#123;<br><br>    T <span class="hljs-title function_">get</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestClass</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">JavaGenericInterface</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T t;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TestClass</span><span class="hljs-params">(T t)</span> &#123;<br>        <span class="hljs-built_in">this</span>.t = t;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> t;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        JavaGenericInterface&lt;String&gt; javaGenericInterface = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestClass</span>&lt;&gt;(<span class="hljs-string">&quot;erdai666&quot;</span>);<br>        System.out.println(javaGenericInterface.get());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br></code></pre></td></tr></table></figure><h3 id="2ã€æ³›å‹æ“¦é™¤"><a href="#2ã€æ³›å‹æ“¦é™¤" class="headerlink" title="2ã€æ³›å‹æ“¦é™¤"></a>2ã€æ³›å‹æ“¦é™¤</h3><h4 id="1ã€æ³›å‹æ“¦é™¤æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1ã€æ³›å‹æ“¦é™¤æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1ã€æ³›å‹æ“¦é™¤æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1ã€æ³›å‹æ“¦é™¤æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä½¿ç”¨äº†ä¸åŒçš„æ³›å‹ç±»å‹ ç»“æœå¾—åˆ°äº†ç›¸åŒçš„æ•°æ®ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericWipe</span> &#123;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;().getClass();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;().getClass();<br><br>        System.out.println(<span class="hljs-string">&quot;a = &quot;</span> + a);<br>        System.out.println(<span class="hljs-string">&quot;b = &quot;</span> + b);<br>        System.out.println(<span class="hljs-string">&quot;a == b: &quot;</span> + (a == b));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>a = <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.util.<span class="hljs-type">ArrayList</span><br><span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.util.ArrayList<br>a == b: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ä¸ºå•¥ä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ</p><p>å› ä¸º Java ä¸­çš„æ³›å‹æ˜¯ä½¿ç”¨æ“¦é™¤æŠ€æœ¯æ¥å®ç°çš„ï¼š<strong>æ³›å‹æ“¦é™¤æ˜¯æŒ‡é€šè¿‡ç±»å‹å‚æ•°åˆå¹¶ï¼Œå°†æ³›å‹ç±»å‹å®ä¾‹å…³è”åˆ°åŒä¸€ä»½å­—èŠ‚ç ä¸Šã€‚ç¼–è¯‘å™¨åªä¸ºæ³›å‹ç±»å‹ç”Ÿæˆä¸€ä»½å­—èŠ‚ç ï¼Œå¹¶å°†å…¶å®ä¾‹å…³è”åˆ°è¿™ä»½å­—èŠ‚ç ä¸Š</strong></p><p>ä¹‹æ‰€ä»¥è¦ä½¿ç”¨æ³›å‹æ“¦é™¤æ˜¯ä¸ºäº†å…¼å®¹ JDK 1.5 ä¹‹å‰è¿è¡Œæ—¶çš„ç±»åŠ è½½å™¨ï¼Œé¿å…å› ä¸ºå¼•å…¥æ³›å‹è€Œå¯¼è‡´è¿è¡Œæ—¶åˆ›å»ºä¸å¿…è¦çš„ç±»</p><h4 id="2ã€æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤"><a href="#2ã€æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤" class="headerlink" title="2ã€æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤"></a>2ã€æ³›å‹æ“¦é™¤çš„å…·ä½“æ­¥éª¤</h4><p>1ï¼‰ã€æ“¦é™¤æ‰€æœ‰ç±»å‹å‚æ•°ä¿¡æ¯ï¼Œå¦‚æœç±»å‹å‚æ•°æ˜¯æœ‰ç•Œçš„ï¼Œåˆ™å°†æ¯ä¸ªå‚æ•°æ›¿æ¢ä¸ºå…¶ç¬¬ä¸€ä¸ªè¾¹ç•Œï¼›å¦‚æœç±»å‹å‚æ•°æ˜¯æ— ç•Œçš„ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸º Objectç±»å‹æ“¦é™¤çš„è§„åˆ™ï¼š</p><blockquote><p><code>&lt;T&gt;</code> æ“¦é™¤åå˜ä¸º Object </p><p><code>&lt;T extends A&gt;</code> æ“¦é™¤åå˜ä¸º A </p><p><code>&lt;? extends A&gt;</code>  æ“¦é™¤åå˜ä¸º A</p><p><code>&lt;? super A&gt;</code> æ“¦é™¤åå˜ä¸ºObject</p></blockquote><p>2ï¼‰ã€ï¼ˆå¿…è¦æ—¶ï¼‰æ’å…¥ç±»å‹è½¬æ¢ï¼Œä»¥ä¿æŒç±»å‹å®‰å…¨</p><p>3ï¼‰ã€ï¼ˆå¿…è¦æ—¶ï¼‰ç”Ÿæˆæ¡¥æ¥æ–¹æ³•ä»¥åœ¨å­ç±»ä¸­ä¿ç•™å¤šæ€æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æƒ…å†µ1: æ“¦é™¤æ‰€æœ‰ç±»å‹å‚æ•°ä¿¡æ¯ï¼Œå¦‚æœç±»å‹å‚æ•°æ˜¯æœ‰ç•Œçš„ï¼Œåˆ™å°†æ¯ä¸ªå‚æ•°æ›¿æ¢ä¸ºå…¶ç¬¬ä¸€ä¸ªè¾¹ç•Œï¼›å¦‚æœç±»å‹å‚æ•°æ˜¯æ— ç•Œçš„ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸º Object</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Paint</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Paint.draw() called&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å¦‚æœä¸ç»™ T è®¾ç½®è¾¹ç•Œï¼Œé‚£ä¹ˆ work æ–¹æ³•é‡Œé¢çš„ t å°±è°ƒç”¨ä¸åˆ° draw æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Painter</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Paint</span>&gt; &#123;<br>    <span class="hljs-keyword">private</span> T t;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Painter</span><span class="hljs-params">(T t)</span> &#123;<br>        <span class="hljs-built_in">this</span>.t = t;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> &#123;<br>        t.draw();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æƒ…å†µ2ï¼šï¼ˆå¿…è¦æ—¶ï¼‰æ’å…¥ç±»å‹è½¬æ¢ï¼Œä»¥ä¿æŒç±»å‹å®‰å…¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericWipe</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;String&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        stringList.add(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        stringList.add(<span class="hljs-string">&quot;666&quot;</span>);<br><br>        <span class="hljs-keyword">for</span> (String s : stringList) &#123;<br>            System.out.println(s);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¼–è¯‘æ—¶ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ç¿»è¯‘è¿‡æ¥å¤§è‡´å¦‚ä¸‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericWipe</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JavaGenericWipe</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;String&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>        stringList.add(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        stringList.add(<span class="hljs-string">&quot;666&quot;</span>);<br>        <span class="hljs-type">Iterator</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> stringList.iterator();<br><br>        <span class="hljs-keyword">while</span>(var2.hasNext()) &#123;<br>            <span class="hljs-comment">//ç¼–è¯‘å™¨ç»™æˆ‘ä»¬åšäº†å¼ºè½¬çš„å·¥ä½œ</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> (String)var2.next();<br>            System.out.println(s);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æƒ…å†µ3 ï¼ˆå¿…è¦æ—¶ï¼‰ç”Ÿæˆæ¡¥æ¥æ–¹æ³•ä»¥åœ¨å­ç±»ä¸­ä¿ç•™å¤šæ€æ€§</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>    <span class="hljs-keyword">public</span> Object data;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(Object data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(Object data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyNode</span><span class="hljs-params">(Integer data)</span> &#123;<br>        <span class="hljs-built_in">super</span>(data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(Integer data)</span> &#123;<br>        <span class="hljs-built_in">super</span>.setData(data);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¼–è¯‘æ—¶ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ç¿»è¯‘è¿‡æ¥å¤§è‡´å¦‚ä¸‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyNode</span><span class="hljs-params">(Integer data)</span> &#123;<br>        <span class="hljs-built_in">super</span>(data);<br>    &#125;<br>    <span class="hljs-comment">// ç¼–è¯‘å™¨ç”Ÿæˆçš„æ¡¥æ¥æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(Object data)</span> &#123;<br>        setData((Integer) data);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(Integer data)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyNode.setData&quot;</span>);<br>        <span class="hljs-built_in">super</span>.setData(data);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€ä¼ªæ³›å‹"><a href="#3ã€ä¼ªæ³›å‹" class="headerlink" title="3ã€ä¼ªæ³›å‹"></a>3ã€ä¼ªæ³›å‹</h4><p>Java ä¸­çš„æ³›å‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ç³–ï¼Œé€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼Œè¿™ç§æ³›å‹ç§°ä¸ºä¼ªæ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥åå°„ç»•è¿‡ç¼–è¯‘å™¨æ³›å‹æ£€æŸ¥ï¼Œæ·»åŠ ä¸€ä¸ªä¸åŒç±»å‹çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åå°„ç»•è¿‡ç¼–è¯‘å™¨æ£€æŸ¥</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <br>     List&lt;String&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>     stringList.add(<span class="hljs-string">&quot;erdai&quot;</span>);<br>     stringList.add(<span class="hljs-string">&quot;666&quot;</span>);<br><br>     <span class="hljs-comment">//ä½¿ç”¨åå°„å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ </span><br>     Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">List</span>&gt; aClass = stringList.getClass();<br>     <span class="hljs-keyword">try</span> &#123;<br>         <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> aClass.getMethod(<span class="hljs-string">&quot;add&quot;</span>, Object.class);<br>         method.invoke(stringList,<span class="hljs-number">123</span>);<br>     &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>         e.printStackTrace();<br>     &#125;<br><br>     <span class="hljs-type">Iterator</span> <span class="hljs-variable">iterator</span> <span class="hljs-operator">=</span> stringList.iterator();<br>     <span class="hljs-keyword">while</span> (iterator.hasNext())&#123;<br>         System.out.println(iterator.next());<br>     &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br><span class="hljs-number">666</span><br><span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><h4 id="4ã€æ³›å‹æ“¦é™¤è¿›é˜¶"><a href="#4ã€æ³›å‹æ“¦é™¤è¿›é˜¶" class="headerlink" title="4ã€æ³›å‹æ“¦é™¤è¿›é˜¶"></a>4ã€æ³›å‹æ“¦é™¤è¿›é˜¶</h4><p>ä¸‹é¢æˆ‘æŠ›å‡ºä¸€ä¸ªåœ¨å·¥ä½œä¸­ç»å¸¸ä¼šé‡åˆ°çš„é—®é¢˜ï¼š</p><p>åœ¨è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œä¼ å…¥ä¸€ä¸ªæ³›å‹çš„å®é™…ç±»å‹ï¼Œä¸ºå•¥èƒ½å¤Ÿæ­£ç¡®çš„è·å–åˆ°è¯¥æ³›å‹ç±»å‹ï¼Œå¹¶åˆ©ç”¨ Gson è½¬æ¢ä¸ºå®é™…çš„å¯¹è±¡ï¼Ÿ</p><p>ç­”ï¼šæ˜¯å› ä¸ºåœ¨è¿è¡ŒæœŸæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå°„è·å–åˆ°å…·ä½“çš„æ³›å‹ç±»å‹</p><p>What? æ³›å‹ä¸æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™è¢«æ“¦é™¤äº†å—ï¼Ÿä¸ºå•¥åœ¨è¿è¡Œæ—¶è¿˜èƒ½å¤Ÿè·å–åˆ°å…·ä½“çš„æ³›å‹ç±»å‹ï¼ŸğŸ¤”ï¸</p><p>ç­”ï¼šæ³›å‹ä¸­æ‰€è°“çš„ç±»å‹æ“¦é™¤ï¼Œå…¶å®åªæ˜¯æ“¦é™¤ Code å±æ€§ä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œåœ¨ç±»å¸¸é‡æ± å±æ€§ï¼ˆSignature å±æ€§ã€LocalVariableTypeTable å±æ€§ï¼‰ä¸­å…¶å®è¿˜ä¿ç•™ç€æ³›å‹ä¿¡æ¯ï¼Œè€Œç±»å¸¸é‡æ± ä¸­çš„å±æ€§å¯ä»¥è¢« class æ–‡ä»¶ï¼Œå­—æ®µè¡¨ï¼Œæ–¹æ³•è¡¨ç­‰æºå¸¦ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬å£°æ˜çš„æ³›å‹ä¿¡æ¯å¾—ä»¥ä¿ç•™ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å¯ä»¥åå°„è·å–æ³›å‹ä¿¡æ¯çš„æ ¹æœ¬ä¾æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è¿™æ˜¯åç¼–è¯‘åçš„ JavaGenericClass.class æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° T</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaGenericClass</span>&lt;T&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> T a;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JavaGenericClass</span><span class="hljs-params">(T a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getA</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setA</span><span class="hljs-params">(T a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br>  <br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šJava æ˜¯åœ¨ JDK 1.5 å¼•å…¥çš„æ³›å‹ï¼Œä¸ºäº†å¼¥è¡¥æ³›å‹æ“¦é™¤çš„ä¸è¶³ï¼ŒJVM çš„ class æ–‡ä»¶ä¹Ÿåšäº†ç›¸åº”çš„ä¿®æ”¹ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯æ–°å¢äº† <strong>Signature</strong> å±æ€§è¡¨å’Œ <strong>LocalVariableTypeTable</strong> å±æ€§è¡¨</p><p>æˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentGeneric</span>&lt;T&gt; &#123;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;&#123;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubClass2</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ParentGeneric</span>&lt;T&gt; &#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericGet</span> &#123;<br><br>    <span class="hljs-comment">//è·å–å®é™…çš„æ³›å‹ç±»å‹</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Type <span class="hljs-title function_">findGenericType</span><span class="hljs-params">(Class&lt;T&gt; cls)</span> &#123;<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">genType</span> <span class="hljs-operator">=</span> cls.getGenericSuperclass();<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">finalNeedType</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span> (genType <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>            Type[] params = ((ParameterizedType) genType).getActualTypeArguments();<br>            finalNeedType = params[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-keyword">return</span> finalNeedType;<br>    &#125;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">SubClass</span> <span class="hljs-variable">subClass</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubClass</span>();<br>SubClass2&lt;Integer&gt; subClass2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubClass2</span>&lt;Integer&gt;();<br>        <span class="hljs-comment">//æ‰“å° subClass è·å–çš„æ³›å‹</span><br>        System.out.println(<span class="hljs-string">&quot;subClass: &quot;</span> + findNeedClass(subClass.getClass()));<br>      <span class="hljs-comment">//æ‰“å°subClass2è·å–çš„æ³›å‹</span><br>        System.out.println(<span class="hljs-string">&quot;subClass2: &quot;</span> + findGenericType(subClass2.getClass()));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œè¿™æ®µä»£ç  æ‰“å°ç»“æœå¦‚ä¸‹</span><br>subClass: <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.String<br>subClass2: T<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ï¼š</p><p>1ã€ SubClass ç›¸å½“äºå¯¹ ParentGeneric<T> åšäº†èµ‹å€¼æ“ä½œ T &#x3D; Stringï¼Œæˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°äº†æ³›å‹ç±»å‹ä¸º String</p><p>2ã€SubClass2 å¯¹ ParentGeneric<T>æ²¡æœ‰åšèµ‹å€¼æ“ä½œ ï¼Œæˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°äº†æ³›å‹ç±»å‹ä¸º T </p><p>è¿™é‡Œå¤§å®¶è‚¯å®šä¼šæœ‰å¾ˆå¤šç–‘é—®ï¼Ÿ</p><p>1ã€ä¸ºå•¥ 1 ä¸­æ²¡æœ‰ä¼ å…¥ä»»ä½•æ³›å‹çš„ä¿¡æ¯å´èƒ½è·å–åˆ°æ³›å‹ç±»å‹å‘¢ï¼Ÿ</p><p>2ã€ä¸ºå•¥ 2 ä¸­æˆ‘åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ä¼ å…¥çš„æ³›å‹æ˜¯ Integer ï¼Œè·å–çš„æ—¶å€™å˜æˆäº† T å‘¢ï¼Ÿ</p><p>ç°åœ¨æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€æ³¢ï¼š</p><p>ä¸Šé¢æˆ‘è®²è¿‡ï¼Œç±»å‹æ“¦é™¤å…¶å®åªæ˜¯æ“¦é™¤ Code å±æ€§ä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œåœ¨ç±»å¸¸é‡æ± å±æ€§ä¸­è¿˜ä¿ç•™ç€æ³›å‹ä¿¡æ¯ï¼Œå› æ­¤ä¸Šé¢çš„ SubClass å’ŒSubClass2 åœ¨ç¼–è¯‘çš„æ—¶å€™å…¶å®ä¼šä¿ç•™å„è‡ªçš„æ³›å‹åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œä¸€ä¸ªæ˜¯ Stringï¼Œä¸€ä¸ªæ˜¯ T ã€‚è€Œ subClass å’Œ subClass2 æ˜¯è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„ï¼Œè¿™ä¸ªæ—¶å€™ä½ å³ä½¿ä¼ å…¥äº†æ³›å‹ç±»å‹ï¼Œä¹Ÿä¼šè¢«æ“¦é™¤æ‰ï¼Œå› æ­¤æ‰ä¼šå‡ºç°ä¸Šé¢çš„ç»“æœï¼Œåˆ°è¿™é‡Œï¼Œå¤§å®¶æ˜¯å¦æ˜äº†äº†å‘¢ï¼Ÿ</p><p>å¦‚æœè¿˜æœ‰ç‚¹æ¨¡ç³Šï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentGeneric</span>&lt;T&gt; &#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericGet</span> &#123;<br>    <span class="hljs-comment">//è·å–å®é™…çš„æ³›å‹ç±»å‹</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Type <span class="hljs-title function_">findGenericType</span><span class="hljs-params">(Class&lt;T&gt; cls)</span> &#123;<br>       <span class="hljs-type">Type</span> <span class="hljs-variable">genType</span> <span class="hljs-operator">=</span> cls.getGenericSuperclass();<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">finalNeedType</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span> (genType <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>            Type[] params = ((ParameterizedType) genType).getActualTypeArguments();<br>            finalNeedType = params[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-keyword">return</span> finalNeedType;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        ParentGeneric&lt;String&gt; parentGeneric1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;();<br>        ParentGeneric&lt;String&gt; parentGeneric2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;()&#123;&#125;;<br><br>        <span class="hljs-comment">//æ‰“å° parentGeneric1 è·å–çš„æ³›å‹</span><br>        System.out.println(<span class="hljs-string">&quot;parentGeneric1: &quot;</span> + findGenericType(parentGeneric1.getClass()));<br>        <span class="hljs-comment">//æ‰“å° parentGeneric2 è·å–çš„æ³›å‹</span><br>        System.out.println(<span class="hljs-string">&quot;parentGeneric2: &quot;</span> + findGenericType(parentGeneric2.getClass()));<br><br>    &#125;<br>&#125;<br><span class="hljs-comment">//è¿è¡Œè¿™æ®µä»£ç  æ‰“å°ç»“æœå¦‚ä¸‹</span><br>parentGeneric1: <span class="hljs-literal">null</span><br>parentGeneric2: <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.String<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç  parentGeneric1 å’Œ parentGeneric2 å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¤šäº† {}ï¼Œè·å–çš„ç»“æœå´æˆªç„¶ä¸åŒï¼Œæˆ‘ä»¬åœ¨æ¥ä»”ç»†åˆ†æä¸€æ³¢ï¼š</p><p>1ã€ ParentGeneric å£°æ˜çš„æ³›å‹ T åœ¨ç¼–è¯‘çš„æ—¶å€™å…¶å®æ˜¯ä¿ç•™åœ¨äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼ŒparentGeneric1 æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œç”±äºæ³›å‹æ“¦é™¤ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡åå°„è·å–å…¶ä¸­çš„ç±»å‹ï¼Œå› æ­¤æ‰“å°äº† null</p><p>è¿™ä¸ªåœ°æ–¹å¯èƒ½å¤§å®¶åˆä¼šæœ‰ä¸ªç–‘é—®äº†ï¼Œä½ æ—¢ç„¶ä¿ç•™äº†æ³›å‹ç±»å‹ä¸º Tï¼Œé‚£ä¹ˆæˆ‘è·å–çš„æ—¶å€™åº”è¯¥ä¸º T æ‰æ˜¯ï¼Œä¸ºå•¥æ‰“å°çš„ç»“æœæ˜¯ null å‘¢ï¼Ÿ</p><p>å¦‚æœä½ å¿ƒé‡Œæœ‰è¿™ä¸ªç–‘é—®ï¼Œè¯´æ˜ä½ æ€è€ƒçš„éå¸¸ç»†è‡´ï¼Œè¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹ Java ç±»å‹ï¼ˆTypeï¼‰ç³»ç»Ÿæœ‰ä¸€å®šçš„äº†è§£ï¼Œè¿™å…¶å®å’Œæˆ‘ä¸Šé¢å†™çš„é‚£ä¸ªè·å–æ³›å‹ç±»å‹çš„æ–¹æ³•æœ‰å…³ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–å®é™…çš„æ³›å‹ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Type <span class="hljs-title function_">findGenericType</span><span class="hljs-params">(Class&lt;T&gt; cls)</span> &#123;<br>    <span class="hljs-comment">//è·å–å½“å‰å¸¦æœ‰æ³›å‹çš„çˆ¶ç±»</span><br>    <span class="hljs-type">Type</span> <span class="hljs-variable">genType</span> <span class="hljs-operator">=</span> cls.getGenericSuperclass();<br>    <span class="hljs-type">Type</span> <span class="hljs-variable">finalNeedType</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-comment">//å¦‚æœå½“å‰ genType æ˜¯å‚æ•°åŒ–ç±»å‹åˆ™è¿›å…¥åˆ°æ¡ä»¶ä½“</span><br>    <span class="hljs-keyword">if</span> (genType <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>      <span class="hljs-comment">//è·å–å‚æ•°ç±»å‹ &lt;&gt; é‡Œé¢çš„é‚£äº›å€¼,ä¾‹å¦‚ Map&lt;K,V&gt; é‚£ä¹ˆå°±å¾—åˆ° [K,V]çš„ä¸€ä¸ªæ•°ç»„</span><br>        Type[] params = ((ParameterizedType) genType).getActualTypeArguments();<br>      <span class="hljs-comment">//å°†ç¬¬ä¸€ä¸ªæ³›å‹ç±»å‹èµ‹å€¼ç»™ finalNeedType</span><br>        finalNeedType = params[<span class="hljs-number">0</span>];<br>    &#125;<br>    <span class="hljs-keyword">return</span> finalNeedType;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬éœ€è¦å…ˆè·å–è¿™ä¸ªç±»çš„æ³›å‹çˆ¶ç±»ï¼Œå¦‚æœæ˜¯å‚æ•°åŒ–ç±»å‹åˆ™è¿›å…¥åˆ°æ¡ä»¶ä½“ï¼Œè·å–å®é™…çš„æ³›å‹ç±»å‹å¹¶è¿”å›ã€‚å¦‚æœä¸æ˜¯åˆ™ç›´æ¥è¿”å› finalNeedType , é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¸º null äº†</p><p>åœ¨ä¾‹1ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">SubClass1</span> <span class="hljs-variable">subClass1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubClass1</span>();<br>SubClass2&lt;Integer&gt; subClass2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubClass2</span>&lt;&gt;();<br>System.out.println(subClass1.getClass().getGenericSuperclass());<br>System.out.println(subClass2.getClass().getGenericSuperclass());<br><span class="hljs-comment">//è¿è¡Œç¨‹åº æ‰“å°ç»“æœå¦‚ä¸‹</span><br>com.dream.java_generic.share.ParentGeneric&lt;java.lang.String&gt;<br>com.dream.java_generic.share.ParentGeneric&lt;T&gt;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è·å–åˆ°äº†æ³›å‹çˆ¶ç±»ï¼Œå› æ­¤ä¼šèµ°åˆ°æ¡ä»¶ä½“é‡Œé¢è·å–åˆ°å®é™…çš„æ³›å‹ç±»å‹å¹¶è¿”å›</p><p>åœ¨ä¾‹2ä¸­:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">ParentGeneric&lt;String&gt; parentGeneric1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;();<br>System.out.println(parentGeneric1.getClass().getGenericSuperclass());<br><span class="hljs-comment">//è¿è¡Œç¨‹åº æ‰“å°ç»“æœå¦‚ä¸‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.Object<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è·å–åˆ°çš„æ³›å‹çˆ¶ç±»æ˜¯ Objectï¼Œå› æ­¤è¿›ä¸å»æ¡ä»¶ä½“ï¼Œæ‰€ä»¥å°±è¿”å› null äº†</p><p>2ã€parentGeneric2 åœ¨åˆ›å»ºçš„æ—¶å€™åé¢åŠ äº† {}ï¼Œè¿™å°±ä½¿å¾— parentGeneric2 æˆä¸ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œä¸”çˆ¶ç±»å°±æ˜¯ ParentGenericï¼Œå› ä¸ºåŒ¿åå†…éƒ¨ç±»æ˜¯åœ¨ç¼–è¯‘æ—¶åˆ›å»ºçš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šåˆ›å»ºå¹¶æºå¸¦å…·ä½“çš„æ³›å‹ä¿¡æ¯ï¼Œå› æ­¤ parentGeneric2 å¯ä»¥è·å–å…¶ä¸­çš„æ³›å‹ç±»å‹</p><p>é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š<strong>å¦‚æœåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¿å­˜äº†æ³›å‹ç±»å‹åˆ°å­—èŠ‚ç ä¸­ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œæ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åå°„è·å–åˆ°ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶ä¼ å…¥å®é™…çš„æ³›å‹ç±»å‹ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¢«æ“¦é™¤ï¼Œåå°„è·å–ä¸åˆ°å½“å‰ä¼ å…¥çš„æ³›å‹å®é™…ç±»å‹</strong></p><p>ä¾‹å­1ä¸­æˆ‘ä»¬æŒ‡å®šäº†æ³›å‹çš„å®é™…ç±»å‹ä¸º Stringï¼Œç¼–è¯‘çš„æ—¶å€™å°±å°†å®ƒå­˜å‚¨åˆ°äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå› æ­¤æˆ‘ä»¬è·å–åˆ°äº†æ³›å‹ç±»å‹ã€‚ä¾‹å­2ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼ŒåŒæ ·åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¿›è¡Œåˆ›å»ºå¹¶ä¿å­˜äº†å®é™…çš„æ³›å‹åˆ°å­—èŠ‚ç ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è·å–åˆ°ã€‚è€Œ parentGeneric1 æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œè™½ç„¶ ParentGeneric å£°æ˜çš„æ³›å‹ T åœ¨ç¼–è¯‘æ—¶ä¹Ÿä¿ç•™åœ¨äº†å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å®ƒä¼ å…¥çš„å®é™…ç±»å‹è¢«æ“¦é™¤äº†ï¼Œè¿™ç§æ³›å‹ä¹Ÿæ˜¯æ— æ³•é€šè¿‡åå°„è·å–çš„ï¼Œè®°ä½ä¸Šé¢è¿™æ¡ç»“è®ºï¼Œé‚£ä¹ˆå¯¹äºæ³›å‹ç±»å‹çš„è·å–ä½ å°±å¾—å¿ƒåº”æ‰‹äº†</p><h4 id="5ã€æ³›å‹è·å–ç»éªŒæ€»ç»“"><a href="#5ã€æ³›å‹è·å–ç»éªŒæ€»ç»“" class="headerlink" title="5ã€æ³›å‹è·å–ç»éªŒæ€»ç»“"></a>5ã€æ³›å‹è·å–ç»éªŒæ€»ç»“</h4><p>å…¶å®é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥å‘ç°ï¼Œå½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå­ç±»ç»§æ‰¿ä¸€ä¸ªæ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªç±»å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°è¿™ä¸ªæ³›å‹ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå­ç±»ç»§æ‰¿æ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªå®é™…çš„ç±»å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;&#123;<br><br>&#125;<br><br><span class="hljs-comment">//åŒ¿åå†…éƒ¨ç±»ï¼Œå…¶å®æˆ‘ä»¬å®šä¹‰çš„è¿™ä¸ªåŒ¿åå†…éƒ¨ç±»ä¹Ÿæ˜¯ä¸€ä¸ªå­ç±»ï¼Œå®ƒç»§æ‰¿äº†æ³›å‹çˆ¶ç±»ï¼Œå¹¶ç»™è¿™ä¸ªæ³›å‹ä¸€ä¸ªå®é™…çš„ç±»å‹</span><br>ParentGeneric&lt;String&gt; parentGeneric2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParentGeneric</span>&lt;String&gt;()&#123;&#125;;<br></code></pre></td></tr></table></figure><p><strong>å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–æŸä¸ªæ³›å‹ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å­ç±»çš„å¸®åŠ©å»å–å‡ºè¯¥æ³›å‹ç±»å‹ï¼Œä¸€ç§è‰¯å¥½çš„ç¼–ç¨‹å®è·µå°±æ˜¯æŠŠå½“å‰éœ€è¦è·å–çš„æ³›å‹ç±»ç”¨ abstract å£°æ˜</strong></p><h3 id="3ã€è¾¹ç•Œ"><a href="#3ã€è¾¹ç•Œ" class="headerlink" title="3ã€è¾¹ç•Œ"></a>3ã€è¾¹ç•Œ</h3><p>è¾¹ç•Œå°±æ˜¯åœ¨æ³›å‹çš„å‚æ•°ä¸Šè®¾ç½®é™åˆ¶æ¡ä»¶ï¼Œè¿™æ ·å¯ä»¥å¼ºåˆ¶æ³›å‹å¯ä»¥ä½¿ç”¨çš„ç±»å‹ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥æŒ‰ç…§è‡ªå·±çš„è¾¹ç•Œç±»å‹æ¥è°ƒç”¨æ–¹æ³•</p><p>1ï¼‰ã€Java ä¸­è®¾ç½®è¾¹ç•Œä½¿ç”¨ extends å…³é”®å­—ï¼Œå®Œæ•´è¯­æ³•ç»“æ„ï¼š<code>&lt;T extends Bound&gt;</code> ï¼ŒBound å¯ä»¥æ˜¯ç±»å’Œæ¥å£ï¼Œå¦‚æœä¸æŒ‡å®šè¾¹ç•Œï¼Œé»˜è®¤è¾¹ç•Œä¸º Object</p><p>2ï¼‰ã€å¯ä»¥è®¾ç½®å¤šä¸ªè¾¹ç•Œï¼Œä¸­é—´ä½¿ç”¨ &amp; è¿æ¥ï¼Œå¤šä¸ªè¾¹ç•Œä¸­åªèƒ½æœ‰ä¸€ä¸ªè¾¹ç•Œæ˜¯ç±»ï¼Œä¸”ç±»å¿…é¡»æ”¾åœ¨æœ€å‰é¢ï¼Œç±»ä¼¼è¿™ç§è¯­æ³•ç»“æ„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassBound</span> &amp; InterfaceBound1 &amp; InterfaceBound2&gt;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassBound</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">InterfaceBound1</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">InterfaceBound2</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentClass</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassBound</span> &amp; InterfaceBound1 &amp; InterfaceBound2&gt;&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T item;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ParentClass</span><span class="hljs-params">(T item)</span> &#123;<br>        <span class="hljs-built_in">this</span>.item = item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        item.test1();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br>        item.test2();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span>&#123;<br>        item.test3();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassBound</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InterfaceBound1</span>,InterfaceBound2 &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;test1&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;test2&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;test3&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Bound</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">SubClass</span> <span class="hljs-variable">subClass</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubClass</span>();<br>        ParentClass&lt;SubClass&gt; parentClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParentClass</span>&lt;SubClass&gt;(subClass);<br>        parentClass.test1();<br>        parentClass.test2();<br>        parentClass.test3();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>test1<br>test2<br>test3<br></code></pre></td></tr></table></figure><h3 id="4ã€é€šé…ç¬¦"><a href="#4ã€é€šé…ç¬¦" class="headerlink" title="4ã€é€šé…ç¬¦"></a>4ã€é€šé…ç¬¦</h3><h4 id="1ã€æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜"><a href="#1ã€æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜" class="headerlink" title="1ã€æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜"></a>1ã€æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜</h4><p>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Number</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">666</span>);<br>ArrayList&lt;Number&gt; numberList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<span class="hljs-comment">//ç¼–è¯‘å™¨æŠ¥é”™ type mismatch</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œä¸ºå•¥ Number çš„å¯¹è±¡å¯ä»¥ç”± Integer å®ä¾‹åŒ–ï¼Œè€Œ <code>ArrayList&lt;Number&gt;</code> çš„å¯¹è±¡å´ä¸èƒ½ç”± <code>ArrayList&lt;Integer&gt;</code> å®ä¾‹åŒ–ï¼Ÿ</p><p>è¦æ˜ç™½ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½ï¼Œä»€ä¹ˆæ˜¯æ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜</p><blockquote><p>1ï¼‰ã€æ³›å‹åå˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª <code>Class&lt;T&gt;</code> çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ A æ˜¯ B çš„å­ç±»ï¼ŒåŒæ—¶ <code>Class&lt;A&gt;</code> ä¹Ÿæ˜¯ <code>Class&lt;B&gt;</code> çš„å­ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ Class åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯åå˜çš„</p><p>2ï¼‰ã€æ³›å‹é€†å˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª <code>Class&lt;T&gt;</code> çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ <code>A æ˜¯ B</code> çš„å­ç±»ï¼ŒåŒæ—¶ <code>Class&lt;B&gt;</code> ä¹Ÿæ˜¯ <code>Class&lt;A&gt;</code> çš„å­ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ Class åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯é€†å˜çš„</p><p>3ï¼‰ã€æ³›å‹ä¸å˜ï¼Œå‡è®¾æˆ‘å®šä¹‰äº†ä¸€ä¸ª <code>Class&lt;T&gt; </code> çš„æ³›å‹ç±»ï¼Œå…¶ä¸­ A æ˜¯ B çš„å­ç±»ï¼ŒåŒæ—¶ <code>Class&lt;B&gt;</code> å’Œ <code>Class&lt;A&gt;</code> æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ Class åœ¨ T è¿™ä¸ªæ³›å‹ä¸Šæ˜¯ä¸å˜çš„</p></blockquote><p>å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ <code>ArrayList&lt;Number&gt;</code> çš„å¯¹è±¡ä¸èƒ½ç”± <code>ArrayList&lt;Integer&gt;</code> å®ä¾‹åŒ–æ˜¯å› ä¸º ArrayList å½“å‰çš„æ³›å‹æ˜¯ä¸å˜çš„ï¼Œæˆ‘ä»¬è¦è§£å†³ä¸Šé¢æŠ¥é”™çš„é—®é¢˜ï¼Œå¯ä»¥è®© ArrayList å½“å‰çš„æ³›å‹æ”¯æŒåå˜ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Number</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">666</span>);<br>ArrayList&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span>&gt; numberList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br></code></pre></td></tr></table></figure><h4 id="2ã€æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦"><a href="#2ã€æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦" class="headerlink" title="2ã€æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦"></a>2ã€æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦</h4><p>1ï¼‰ã€æ³›å‹çš„ä¸Šè¾¹ç•Œé€šé…ç¬¦è¯­æ³•ç»“æ„ï¼š<code>&lt;? extends Bound&gt;</code>ï¼Œä½¿å¾—æ³›å‹æ”¯æŒåå˜ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸Šè¾¹ç•Œæ¥å£æˆ–è€…å®ç°ç±»ï¼Œä½¿ç”¨ä¸Šè¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªè¯»ï¼Œä¸å¯ä»¥å†™ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildCard</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;Integer&gt; integerList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>        List&lt;Number&gt; numberList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Number&gt;();<br>        integerList.add(<span class="hljs-number">666</span>);<br>        numberList.add(<span class="hljs-number">123</span>);<br><br>        getNumberData(integerList);<br>        getNumberData(numberList);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getNumberData</span><span class="hljs-params">(List&lt;? extends Number&gt; data)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Number data :&quot;</span> + data.get(<span class="hljs-number">0</span>));<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Number data: <span class="hljs-number">666</span><br>Number data: <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šä¸ºå•¥ä½¿ç”¨ä¸Šè¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªè¯»ï¼Œè€Œä¸èƒ½å†™ï¼Ÿ</p><p>1ã€<code>&lt;? extends Bound&gt;</code>,å®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå®ƒæ— æ³•ç¡®å®šè‡ªå·±å…·ä½“çš„ç±»å‹ï¼Œå› æ­¤ç¼–è¯‘å™¨æ— æ³•éªŒè¯ç±»å‹çš„å®‰å…¨ï¼Œæ‰€ä»¥ä¸èƒ½å†™</p><p>2ã€å‡è®¾å¯ä»¥å†™ï¼Œæˆ‘ä»¬å‘å®ƒé‡Œé¢æ·»åŠ è‹¥å¹²ä¸ªå­ç±»ï¼Œç„¶åç”¨ä¸€ä¸ªå…·ä½“çš„å­ç±»å»æ¥æ”¶ï¼ŒåŠ¿å¿…ä¼šé€ æˆç±»å‹è½¬æ¢å¼‚å¸¸</p><h4 id="3ã€æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦"><a href="#3ã€æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦" class="headerlink" title="3ã€æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦"></a>3ã€æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦</h4><p>1ï¼‰ã€æ³›å‹çš„ä¸‹è¾¹ç•Œé€šé…ç¬¦è¯­æ³•ç»“æ„ï¼š<code>&lt;? super Bound&gt;</code>ï¼Œä½¿å¾—æ³›å‹æ”¯æŒé€†å˜ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸‹è¾¹ç•Œæ¥å£æˆ–è€…å…¶çˆ¶æ¥å£ï¼Œä½¿ç”¨ä¸‹è¾¹ç•Œé€šé…ç¬¦çš„å˜é‡åªå†™ï¼Œä¸å»ºè®®è¯»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildCard</span> &#123;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;Number&gt; numberList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Number&gt;();<br>        List&lt;Object&gt; objectList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Object&gt;();<br>        setNumberData(numberList);<br>        setNumberData(objectList);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNumberData</span><span class="hljs-params">(List&lt;? <span class="hljs-built_in">super</span> Number&gt; data)</span> &#123;<br>        <span class="hljs-type">Number</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">666</span>);<br>        data.add(number);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šä¸ºå•¥ä½¿ç”¨ä¸‹è¾¹ç•Œé€šé…ç¬¦çš„å˜é‡å¯ä»¥å†™ï¼Œè€Œä¸å»ºè®®è¯»ï¼Ÿ</p><p>1ã€<code>&lt;? super Bound&gt;</code>ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œè™½ç„¶å®ƒä¹Ÿæ— æ³•ç¡®å®šè‡ªå·±å…·ä½“çš„ç±»å‹ï¼Œä½†æ ¹æ®å¤šæ€ï¼Œå®ƒèƒ½ä¿è¯è‡ªå·±æ·»åŠ çš„å…ƒç´ æ˜¯å®‰å…¨çš„ï¼Œå› æ­¤å¯ä»¥å†™</p><p>2ã€è·å–å€¼çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ª <code>Object</code> ç±»å‹çš„å€¼ï¼Œè€Œä¸èƒ½è·å–å®é™…ç±»å‹å‚æ•°ä»£è¡¨çš„ç±»å‹ï¼Œå› æ­¤å»ºè®®ä¸è¦å»è¯»ï¼Œå¦‚æœä½ å®åœ¨è¦å»è¯»ä¹Ÿè¡Œï¼Œä½†æ˜¯è¦æ³¨æ„ç±»å‹è½¬æ¢å¼‚å¸¸</p><h4 id="4ã€æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦"><a href="#4ã€æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦" class="headerlink" title="4ã€æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦"></a>4ã€æ³›å‹çš„æ— è¾¹ç•Œé€šé…ç¬¦</h4><p>1ï¼‰ã€æ— è¾¹ç•Œé€šé…ç¬¦çš„è¯­æ³•ç»“æ„ï¼š<code>&lt;?&gt;</code>ï¼Œå®é™…ä¸Šå®ƒç­‰ä»·äº <code>&lt;? extends Object&gt;</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„ä¸Šè¾¹ç•Œæ˜¯ Object æˆ–å…¶å­ç±»ï¼Œå› æ­¤ä½¿ç”¨æ— ç•Œé€šé…ç¬¦çš„å˜é‡åŒæ ·åªè¯»ï¼Œä¸èƒ½å†™ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildCard</span> &#123;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;String&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>        List&lt;Number&gt; numberList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Number&gt;();<br>        List&lt;Integer&gt; integerList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>        stringList.add(<span class="hljs-string">&quot;erdai&quot;</span>);<br>        numberList.add(<span class="hljs-number">666</span>);<br>        integerList.add(<span class="hljs-number">123</span>);<br>        getData(stringList);<br>        getData(numberList);<br>        getData(integerList);<br>    &#125;<br>    <br>     <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getData</span><span class="hljs-params">(List&lt;?&gt; data)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;data: &quot;</span> + data.get(<span class="hljs-number">0</span>));<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>data: erdai<br>data: <span class="hljs-number">666</span><br>data: <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><h4 id="5ã€PECS-åŸåˆ™"><a href="#5ã€PECS-åŸåˆ™" class="headerlink" title="5ã€PECS åŸåˆ™"></a>5ã€PECS åŸåˆ™</h4><p>æ³›å‹ä»£ç çš„è®¾è®¡ï¼Œåº”éµå¾ª<strong>PECSåŸåˆ™ï¼ˆProducer extends Consumer superï¼‰ï¼š</strong></p><p>1ï¼‰ã€å¦‚æœåªéœ€è¦è·å–å…ƒç´ ï¼Œä½¿ç”¨ <code>&lt;? extends T&gt;</code></p><p>2ï¼‰ã€å¦‚æœåªéœ€è¦å­˜å‚¨ï¼Œä½¿ç”¨ <code>&lt;? super T&gt;</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è¿™æ˜¯ Collections.java ä¸­ copy æ–¹æ³•çš„æºç </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">copy</span><span class="hljs-params">(List&lt;? <span class="hljs-built_in">super</span> T&gt; dest, List&lt;? extends T&gt; src)</span> &#123;<br>      <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ï¼Œsrc è¡¨ç¤ºåŸå§‹é›†åˆï¼Œä½¿ç”¨äº† <code>&lt;? extends T&gt;</code>ï¼Œåªèƒ½ä»ä¸­è¯»å–å…ƒç´ ï¼Œdest è¡¨ç¤ºç›®æ ‡é›†åˆï¼Œåªèƒ½å¾€é‡Œé¢å†™å…ƒç´ ï¼Œå……åˆ†çš„ä½“ç°äº† PECS åŸåˆ™</p><h4 id="6ã€ä½¿ç”¨é€šé…ç¬¦æ€»ç»“"><a href="#6ã€ä½¿ç”¨é€šé…ç¬¦æ€»ç»“" class="headerlink" title="6ã€ä½¿ç”¨é€šé…ç¬¦æ€»ç»“"></a>6ã€ä½¿ç”¨é€šé…ç¬¦æ€»ç»“</h4><p>1ï¼‰ã€å½“ä½ åªæƒ³è¯»å–å€¼çš„æ—¶å€™ï¼Œä½¿ç”¨ <code>&lt;? extends T&gt;</code></p><p>2ï¼‰ã€å½“ä½ åªæƒ³å†™å…¥å€¼çš„æ—¶å€™ï¼Œä½¿ç”¨ <code>&lt;? super T&gt;</code></p><p>3ï¼‰ã€å½“ä½ æ—¢æƒ³è¯»å–å€¼åˆæƒ³å†™å…¥å€¼çš„æ—¶å€™ï¼Œå°±ä¸è¦ä½¿ç”¨é€šé…ç¬¦</p><h3 id="5ã€æ³›å‹çš„é™åˆ¶"><a href="#5ã€æ³›å‹çš„é™åˆ¶" class="headerlink" title="5ã€æ³›å‹çš„é™åˆ¶"></a>5ã€æ³›å‹çš„é™åˆ¶</h3><p>1ï¼‰ã€æ³›å‹ä¸èƒ½æ˜¾å¼åœ°å¼•ç”¨åœ¨è¿è¡Œæ—¶ç±»å‹çš„æ“ä½œé‡Œï¼Œå¦‚ instanceof æ“ä½œå’Œ new è¡¨è¾¾å¼ï¼Œè¿è¡Œæ—¶ç±»å‹åªé€‚ç”¨äºåŸç”Ÿç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>      <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æ“ä½œ</span><br>        <span class="hljs-keyword">if</span>(str <span class="hljs-keyword">instanceof</span> T)&#123;<br><br>        &#125;<br>        <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æ“ä½œ</span><br>        <span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">T</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€ä¸èƒ½åˆ›å»ºæ³›å‹ç±»å‹çš„æ•°ç»„ï¼Œåªå¯ä»¥å£°æ˜ä¸€ä¸ªæ³›å‹ç±»å‹çš„æ•°ç»„å¼•ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>       GenericLimitedClass&lt;Test&gt;[] genericLimitedClasses;<br>       <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br>       genericLimitedClasses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;Test&gt;[<span class="hljs-number">10</span>];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ï¼‰ã€ä¸èƒ½å£°æ˜ç±»å‹ä¸ºæ³›å‹çš„é™æ€å­—æ®µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; &#123;<br>    <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> T t;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ï¼‰ã€æ³›å‹ç±»ä¸å¯ä»¥ç›´æ¥æˆ–é—´æ¥åœ°ç»§æ‰¿ Throwable</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Throwable</span> &#123;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><p>5ï¼‰ã€æ–¹æ³•ä¸­ä¸å¯ä»¥æ•è·ç±»å‹å‚æ•°çš„å®ä¾‹ï¼Œä½†æ˜¯å¯ä»¥åœ¨ throws è¯­å¥ä¸­ä½¿ç”¨ç±»å‹å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Throwable</span>&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> T&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br><br>        <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br>        &#125;<span class="hljs-keyword">catch</span> (T exception)&#123;<br><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>6ï¼‰ã€ä¸€ä¸ªç±»ä¸å¯ä»¥é‡è½½åœ¨ç±»å‹æ“¦é™¤åæœ‰åŒæ ·æ–¹æ³•ç­¾åçš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericLimitedClass</span>&lt;T&gt; &#123;<br>    <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">(List&lt;String&gt; stringList)</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">(List&lt;Integer&gt; integerList)</span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€é—®é¢˜"><a href="#6ã€é—®é¢˜" class="headerlink" title="6ã€é—®é¢˜"></a>6ã€é—®é¢˜</h3><p>1ï¼‰ã€ç±»å‹è¾¹ç•Œå’Œé€šé…ç¬¦è¾¹ç•Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>ç±»å‹è¾¹ç•Œå¯ä»¥æœ‰å¤šä¸ªï¼Œé€šé…ç¬¦è¾¹ç•Œåªèƒ½æœ‰ä¸€ä¸ª</p><p>2ï¼‰ã€<code>List&lt;?&gt;</code> å’Œ <code>List&lt;Object&gt;</code> ä¸€æ ·å—ï¼Ÿ</p><p>ä¸ä¸€æ ·</p><p>1ã€ <code>List&lt;Object&gt;</code> å¯è¯»å†™ï¼Œä½†æ˜¯ List&lt;?&gt; åªè¯»</p><p>2ã€<code>List&lt;?&gt;</code>å¯ä»¥æœ‰å¾ˆå¤šå­ç±»ï¼Œä½†æ˜¯ <code>List&lt;Object&gt;</code> æ²¡æœ‰</p><h2 id="äºŒã€Kotlin-æ³›å‹"><a href="#äºŒã€Kotlin-æ³›å‹" class="headerlink" title="äºŒã€Kotlin æ³›å‹"></a>äºŒã€Kotlin æ³›å‹</h2><p>Kotlin æ³›å‹å’Œ Java æ³›å‹åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åœ¨ Kotlin ä¸Šæœ‰äº›ä¸œè¥¿æ¢äº†æ–°çš„å†™æ³•</p><h3 id="1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•"><a href="#1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•"></a>1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•</h3><p>1ï¼‰ã€åœ¨ Kotlin ä¸­æˆ‘ä»¬å®šä¹‰å’Œä½¿ç”¨æ³›å‹çš„æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»ï¼Œåœ¨ç±»ååé¢ä½¿ç”¨ &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªç±»å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&lt;<span class="hljs-type">T</span>&gt;&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span> &#123;<br>      <br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ³›å‹è°ƒç”¨</span><br><span class="hljs-keyword">val</span> myClass = MyClass&lt;<span class="hljs-built_in">Int</span>&gt;()<br>myClass.method(<span class="hljs-number">12</span>)<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•åçš„å‰é¢åŠ ä¸Š &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ–¹æ³•å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span>&#123;<br><br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ³›å‹è°ƒç”¨</span><br><span class="hljs-keyword">val</span> myClass = MyClass()<br>myClass.method&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-number">12</span>)<br><span class="hljs-comment">//æ ¹æ® Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ³›å‹ç»™çœç•¥</span><br>myClass.method(<span class="hljs-number">12</span>)<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œåœ¨æ¥å£ååé¢åŠ ä¸Š &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ¥å£å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyInterface</span>&lt;<span class="hljs-type">T</span>&gt;&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">interfaceMethod</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹æ¯” Java ä¸­å®šä¹‰æ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šåœ¨å®šä¹‰ç±»å’Œæ¥å£æ³›å‹ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œåœ¨å®šä¹‰æ–¹æ³•æ³›å‹æ—¶ï¼ŒKotlin æ˜¯åœ¨æ–¹æ³•åå‰é¢æ·»åŠ æ³›å‹ï¼Œè€Œ Java æ˜¯åœ¨è¿”å›å€¼å‰é¢æ·»åŠ æ³›å‹</p><h3 id="2ã€è¾¹ç•Œ"><a href="#2ã€è¾¹ç•Œ" class="headerlink" title="2ã€è¾¹ç•Œ"></a>2ã€è¾¹ç•Œ</h3><p>1ï¼‰ã€ä¸ºæ³›å‹æŒ‡å®šè¾¹ç•Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>&lt;T : Class&gt;</code> è¿™ç§è¯­æ³•ç»“æ„ï¼Œå¦‚æœä¸æŒ‡å®šæ³›å‹çš„è¾¹ç•Œï¼Œé»˜è®¤ä¸º Any? </p><p>2ï¼‰ã€å¦‚æœæœ‰å¤šä¸ªè¾¹ç•Œï¼Œå¯ä»¥ä½¿ç”¨ where å…³é”®å­—ï¼Œä¸­é—´ä½¿ç”¨ : éš”å¼€ï¼Œå¤šä¸ªè¾¹ç•Œä¸­åªèƒ½æœ‰ä¸€ä¸ªè¾¹ç•Œæ˜¯ç±»ï¼Œä¸”ç±»å¿…é¡»æ”¾åœ¨æœ€å‰é¢</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æƒ…å†µ1 å•ä¸ªè¾¹ç•Œ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass1</span>&lt;<span class="hljs-type">T : Number</span>&gt; &#123;<br><br>    <span class="hljs-keyword">var</span> <span class="hljs-keyword">data</span>: T? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span> &#123;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æƒ…å†µ2 å¤šä¸ªè¾¹ç•Œä½¿ç”¨ where å…³é”®å­—</span><br><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Food</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Food2</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass2</span>&lt;<span class="hljs-type">T</span>&gt; <span class="hljs-title">where</span> <span class="hljs-title">T</span> : <span class="hljs-type">Animal</span>, <span class="hljs-type">T</span> : <span class="hljs-type">Food</span>, <span class="hljs-type">T</span> : <span class="hljs-type">Food2</span> &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span> <span class="hljs-keyword">where</span> T : Animal, T : Food, T : Food2 &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€æ³›å‹å®åŒ–"><a href="#3ã€æ³›å‹å®åŒ–" class="headerlink" title="3ã€æ³›å‹å®åŒ–"></a>3ã€æ³›å‹å®åŒ–</h3><p>æ³›å‹å®åŒ–åœ¨ Java ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼ŒKotlin ä¸­ä¹‹æ‰€ä»¥èƒ½å®ç°æ³›å‹å®åŒ–ï¼Œæ˜¯å› ä¸ºä½¿ç”¨çš„å†…è”å‡½æ•°ä¼šå¯¹ä»£ç è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆåœ¨å†…è”å‡½æ•°ä¸­ä½¿ç”¨æ³›å‹ï¼Œæœ€ç»ˆä¹Ÿä¼šä½¿ç”¨å®é™…çš„ç±»å‹è¿›è¡Œæ›¿æ¢</p><p>1ï¼‰ã€ä½¿ç”¨å†…è”å‡½æ•°é…åˆ reified å…³é”®å­—å¯¹æ³›å‹è¿›è¡Œå®åŒ–ï¼Œè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">getGenericType</span><span class="hljs-params">()</span></span> &#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>å®æ“ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">getGenericType</span><span class="hljs-params">()</span></span> = T::<span class="hljs-keyword">class</span>.java<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//æ³›å‹å®åŒ– è¿™ç§æƒ…å†µåœ¨ Java æ˜¯ä¼šè¢«ç±»å‹æ“¦é™¤çš„</span><br>    <span class="hljs-keyword">val</span> result1 = getGenericType&lt;String&gt;()<br>    <span class="hljs-keyword">val</span> result2 = getGenericType&lt;Number&gt;()<br>    println(result1)<br>    println(result2)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.<span class="hljs-title">lang</span>.<span class="hljs-title">String</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.<span class="hljs-title">lang</span>.<span class="hljs-title">Number</span><br></code></pre></td></tr></table></figure><p>2ï¼‰ã€å®é™…åº”ç”¨</p><p>åœ¨æˆ‘ä»¬è·³è½¬ Activity çš„æ—¶å€™é€šå¸¸ä¼šè¿™ä¹ˆæ“ä½œ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> intent = Intent(mContext,TestActivity::<span class="hljs-keyword">class</span>.java)<br>mContext.startActivity(intent)<br></code></pre></td></tr></table></figure><p>æœ‰æ²¡æœ‰æ„Ÿè§‰å†™è¿™ç§ TestActivity::class.java çš„è¯­æ³•å¾ˆéš¾å—ï¼Œåæ­£æˆ‘æ˜¯è§‰å¾—å¾ˆéš¾å—ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ³›å‹å®åŒ–æ¢ä¸€ç§å†™æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé¡¶å±‚å‡½æ•°</span><br><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">startActivity</span><span class="hljs-params">(mContext: <span class="hljs-type">Context</span>)</span></span>&#123;<br>    <span class="hljs-keyword">val</span> intent = Intent(mContext,T::<span class="hljs-keyword">class</span>.java)<br>    mContext.startActivity(intent)<br>&#125;<br><br><span class="hljs-comment">//ä½¿ç”¨çš„æ—¶å€™</span><br>startActivity&lt;TestActivity&gt;(mContext)<br></code></pre></td></tr></table></figure><p>è¿™ç§å†™æ³•æ˜¯ä¸æ˜¯æ¸…çˆ½äº†å¾ˆå¤šï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬è·³è½¬ Activity çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæºå¸¦ä¸€äº›å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> intent  = Intent(mContext,TestActivity::<span class="hljs-keyword">class</span>.java)<br>intent.putExtra(<span class="hljs-string">&quot;params1&quot;</span>,<span class="hljs-string">&quot;erdai&quot;</span>)<br>intent.putExtra(<span class="hljs-string">&quot;params2&quot;</span>,<span class="hljs-string">&quot;666&quot;</span>)<br>mContext.startActivity(intent)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å¢åŠ ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œä½¿ç”¨ Lambda è¡¨è¾¾å¼å»è°ƒç”¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">startActivity</span><span class="hljs-params">(mContext: <span class="hljs-type">Context</span>, block: <span class="hljs-type">Intent</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>&#123;<br>    <span class="hljs-keyword">val</span> intent = Intent(mContext,T::<span class="hljs-keyword">class</span>.java)<br>    intent.block()<br>    mContext.startActivity(intent)<br>&#125;<br><br><span class="hljs-comment">//ä½¿ç”¨çš„æ—¶å€™</span><br>startActivity&lt;SecondActivity&gt;(mContext)&#123;       <br>  putExtra(<span class="hljs-string">&quot;params1&quot;</span>,<span class="hljs-string">&quot;erdai&quot;</span>)     <br>  putExtra(<span class="hljs-string">&quot;params2&quot;</span>,<span class="hljs-string">&quot;666&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜"><a href="#4ã€æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜" class="headerlink" title="4ã€æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜"></a>4ã€æ³›å‹åå˜ï¼Œé€†å˜å’Œä¸å˜</h3><p>1ï¼‰ã€æ³›å‹åå˜çš„è¯­æ³•è§„åˆ™ï¼š<code>&lt;out T&gt;</code> ç±»ä¼¼äº Java çš„  <code>&lt;? extends Bound&gt;</code>ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸Šè¾¹ç•Œç±»æˆ–è€…å…¶å­ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸Šè¾¹ç•Œæ¥å£æˆ–è€…å®ç°ç±»ï¼Œåå˜çš„æ³›å‹å˜é‡åªè¯»ï¼Œä¸å¯ä»¥å†™ï¼Œå¯ä»¥æ·»åŠ  null ï¼Œä½†æ˜¯æ²¡æ„ä¹‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>: <span class="hljs-type">Person</span>()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span>: <span class="hljs-type">Person</span>()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleData</span>&lt;<span class="hljs-type">out T</span>&gt;&#123;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> person: Person = Student()<br>    <span class="hljs-keyword">val</span> personGeneric: SimpleData&lt;Person&gt; = SimpleData&lt;Student&gt;()<br>    <span class="hljs-keyword">val</span> list1: ArrayList&lt;<span class="hljs-keyword">out</span> Person&gt; = ArrayList&lt;Student&gt;()<br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€æ³›å‹é€†å˜çš„è¯­æ³•è§„åˆ™ï¼š<code>&lt;in T&gt;</code> ç±»ä¼¼äº Java çš„ <code>&lt;? super Bound&gt;</code>ï¼Œå®ƒé™å®šçš„ç±»å‹æ˜¯å½“å‰ä¸‹è¾¹ç•Œç±»æˆ–è€…å…¶çˆ¶ç±»ï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯å°±æ˜¯å½“å‰ä¸‹è¾¹ç•Œæ¥å£æˆ–è€…å…¶çˆ¶æ¥å£ï¼Œé€†å˜çš„æ³›å‹å˜é‡åªèƒ½å†™ï¼Œä¸å»ºè®®è¯»</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>: <span class="hljs-type">Person</span>()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span>: <span class="hljs-type">Person</span>()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleData</span>&lt;<span class="hljs-type">in T</span>&gt;&#123;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> person1: Person = Student()<br>    <span class="hljs-keyword">val</span> personGeneric1: SimpleData&lt;Student&gt; = SimpleData&lt;Person&gt;()<br>    <span class="hljs-keyword">val</span> list2: ArrayList&lt;<span class="hljs-keyword">in</span> Person&gt; = ArrayList&lt;Any&gt;()<br>&#125;<br></code></pre></td></tr></table></figure><p>5ï¼‰ã€æ³›å‹ä¸å˜å’Œ Java è¯­æ³•è§„åˆ™æ˜¯ä¸€æ ·çš„</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>: <span class="hljs-type">Person</span>()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span>: <span class="hljs-type">Person</span>()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleData</span>&lt;<span class="hljs-type">T</span>&gt;&#123;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> person: Person = Student()<br>    <span class="hljs-comment">//ç¼–è¯‘å™¨ä¸å…è®¸</span><br>    <span class="hljs-keyword">val</span> personGeneric: SimpleData&lt;Person&gt; = SimpleData&lt;Student&gt;()<br>&#125;<br></code></pre></td></tr></table></figure><p>6ï¼‰ã€Kotlin ä½¿ç”¨ &lt;*&gt; è¿™ç§è¯­æ³•ç»“æ„æ¥è¡¨ç¤ºæ— ç•Œé€šé…ç¬¦ï¼Œå®ƒç­‰ä»·äº <code>&lt;out Any&gt;</code>ï¼Œç±»ä¼¼äº Java ä¸­çš„ &lt;?&gt;ï¼Œåœ¨å®šä¹‰ä¸€ä¸ªç±»çš„æ—¶å€™ä½ å¦‚æœä½¿ç”¨<code>&lt;out T : Number&gt;</code> ï¼Œé‚£ä¹ˆ * å°±ç›¸å½“äº <code>&lt;out Number&gt;</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">KotlinGeneric</span>&lt;<span class="hljs-type">out T: Number</span>&gt;&#123;<br><br>&#125;<br><br><span class="hljs-comment">//æ— ç•Œé€šé…ç¬¦ ç­‰ä»·äº &lt;out Any&gt;ï¼Œä½†æ˜¯æˆ‘è¿™ä¸ªç±»é™åˆ¶äº†æ³›å‹è¾¹ç•Œä¸º Numberï¼Œå› æ­¤è¿™é‡Œç›¸å½“äº &lt;out Number&gt;</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> noBound: KotlinGeneric&lt;*&gt; = KotlinGeneric&lt;<span class="hljs-built_in">Int</span>&gt;()<br> <br>    <span class="hljs-comment">//æ ¹æ®åå˜è§„åˆ™ ç¼–è¯‘å™¨ä¸å…è®¸è¿™æ ·å†™</span><br>    <span class="hljs-keyword">val</span> noBound: KotlinGeneric&lt;*&gt; = KotlinGeneric&lt;Any&gt;()<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ³›å‹æ€»ç»“"><a href="#ä¸‰ã€æ³›å‹æ€»ç»“" class="headerlink" title="ä¸‰ã€æ³›å‹æ€»ç»“"></a>ä¸‰ã€æ³›å‹æ€»ç»“</h2><p>è¦å­¦å¥½ Kotlin æ³›å‹ï¼Œå°±è¦å…ˆå­¦ä¹ å¥½ Java  æ³›å‹ï¼Œæœ€åæ€»ç»“ä¸€ä¸‹è¿™ç¯‡æ–‡ç« è®²çš„å†…å®¹ï¼š</p><p>1ã€å›ç­”äº†ä¸€äº›å…³äºæ³›å‹çš„é—®é¢˜</p><p>2ã€è®²è§£äº† Java æ³›å‹ï¼Œå…¶ä¸­æˆ‘è§‰å¾—æ³›å‹æ“¦é™¤å’Œæ³›å‹çš„åå˜ï¼Œé€†å˜å’Œä¸å˜æ˜¯æ¯”è¾ƒéš¾ç†è§£çš„ï¼Œå› æ­¤å¤§å®¶å¯ä»¥å¤šèŠ±ç‚¹æ—¶é—´å»ç†è§£è¿™ä¸€å—</p><p>3ã€è®²è§£äº† Kotlin æ³›å‹ï¼Œç›¸å¯¹äº Java æ³›å‹ï¼ŒKotlinæ³›å‹å°±æ˜¯åœ¨è¯­æ³•ç»“æ„ä¸Šæœ‰äº›ä¸ä¸€æ ·ï¼Œä½†åŠŸèƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå¦å¤– Kotlin ä¸­çš„æ³›å‹å®åŒ–æ˜¯ Java ä¸­æ‰€æ²¡æœ‰çš„</p><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œï¼ŒKotlin æ³›å‹å°±è®²å®Œäº†ï¼Œç›¸ä¿¡ä½ å¦‚æœä»å¤´çœ‹åˆ°è¿™é‡Œï¼Œæ”¶è·ä¸€å®šå¾ˆå¤šï¼Œå¦‚æœè§‰å¾—æˆ‘å†™å¾—è¿˜ä¸é”™ï¼Œè¯·ç»™æˆ‘ç‚¹ä¸ªèµå§ğŸ¤ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºä¸€èµ·è®¨è®º</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Kotlin</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Kotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlin ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šKotlinå…¥é—¨</title>
    <link href="/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AKotlin%E5%85%A5%E9%97%A8/"/>
    <url>/2022/10/11/Kotlin%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AKotlin%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/448dcf3e2a204e2d8ec6643313775c5c~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Google åœ¨2017å¹´ I&#x2F;O å¤§ä¼šä¸Šå®£å¸ƒï¼ŒKotlin æ­£å¼æˆä¸º Android çš„ä¸€çº§å¼€å‘è¯­è¨€ï¼Œå’Œ Java å¹³èµ·å¹³åï¼ŒAndroidStudio ä¹Ÿå¯¹ Kotlin è¿›è¡Œäº†å…¨é¢çš„æ”¯æŒï¼Œä¸¤å¹´åï¼ŒGoogle åˆåœ¨2019å¹´ I&#x2F;O å¤§ä¼šä¸Šå®£å¸ƒï¼ŒKotlin å·²ç»æˆä¸º Android çš„ç¬¬ä¸€å¼€å‘è¯­è¨€ï¼Œè™½ç„¶è¯´ Java ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½† Google æ›´åŠ æ¨èæˆ‘ä»¬ä½¿ç”¨ Kotlin æ¥å¼€å‘ Android åº”ç”¨ç¨‹åºï¼Œåç»­æä¾›çš„å®˜æ–¹ Api ä¹Ÿä¼šä¼˜å…ˆè€ƒè™‘ Kotlin ç‰ˆæœ¬ï¼Œè€Œä¸”ç°åœ¨çš„å¼€å‘è€…æ— è®ºæ˜¯å†™æŠ€æœ¯åšå®¢ï¼Œè¿˜æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼ŒåŸºæœ¬ä¸Šéƒ½ç”¨çš„Kotlinï¼Œå¤–åŠ å…¬å¸æŠ€æœ¯æ¼”è¿›éœ€è¦ä½¿ç”¨åˆ° Kotlinï¼Œå› æ­¤å­¦ä¹  Kotlin ç¼–ç¨‹æ˜¯éå¸¸é‡è¦å’Œç´§æ€¥çš„ä¸€ä»¶äº‹æƒ…ã€‚</p><h2 id="Kotlin-ä»‹ç»"><a href="#Kotlin-ä»‹ç»" class="headerlink" title="Kotlin ä»‹ç»"></a>Kotlin ä»‹ç»</h2><p>å®˜ç½‘å¯¹ Kotlin çš„ä»‹ç»ï¼šA modern programming languagethat makes developers happier. ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š<strong>Kotlin æ˜¯ä¸€é—¨è®©å¼€å‘è€…æ›´å¼€å¿ƒçš„ç°ä»£ç¨‹åºè®¾è®¡è¯­è¨€ ã€‚</strong> ç”± JetBrains å…¬å¸å¼€å‘å’Œè®¾è®¡ï¼Œå®ƒä¹Ÿæ˜¯ä¸€é—¨åŸºäº JVM çš„é™æ€è¯­è¨€ã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>åœ¨å­¦ä¹  Kotlin çš„æ—¶å€™æˆ‘å¿ƒé‡Œä¼šæœ‰ä¸€äº›ç–‘é—®ğŸ¤”ï¸ ï¼Ÿ</p><p>1ã€Android æ“ä½œç³»ç»Ÿæ˜¯ç”± Google å¼€å‘å‡ºæ¥çš„ï¼Œä¸ºå•¥ JetBrains ä½œä¸ºä¸€ä¸ªç¬¬ä¸‰æ–¹å…¬å¸ï¼Œå´èƒ½è®¾è®¡å‡ºä¸€é—¨è¯­è¨€æ¥å¼€å‘ Android åº”ç”¨ç¨‹åºï¼Ÿ</p><p>å› ä¸º Java è™šæ‹Ÿæœºï¼ˆAndroid ä¸­å« ARTï¼Œä¸€ç§åŸºäº Java è™šæ‹Ÿæœºä¼˜åŒ–çš„è™šæ‹Ÿæœºï¼‰å¹¶ä¸ç›´æ¥å’Œä½ ç¼–å†™çš„è¿™é—¨è¯­è¨€çš„æºä»£ç æ‰“äº¤é“ï¼Œè€Œæ˜¯å’Œä½ ç¼–è¯‘ä¹‹åçš„ class å­—èŠ‚ç æ–‡ä»¶æ‰“äº¤é“ã€‚åŸºäº JVM çš„è¯­è¨€ï¼Œå¦‚ Kotlinï¼ŒGroovyç­‰ï¼Œå®ƒä»¬éƒ½ä¼šæœ‰å„è‡ªçš„ç¼–è¯‘å™¨ï¼ŒæŠŠæºæ–‡ä»¶ç¼–è¯‘æˆ class å­—èŠ‚ç æ–‡ä»¶ï¼ŒJava è™šæ‹Ÿæœºä¸å…³å¿ƒ class å­—èŠ‚ç æ–‡ä»¶æ˜¯ä»å“ªé‡Œç¼–è¯‘è€Œæ¥ï¼Œåªè¦ç¬¦åˆè§„æ ¼çš„ class å­—èŠ‚ç æ–‡ä»¶ï¼Œå®ƒéƒ½èƒ½è¯†åˆ«ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼ŒJetBrains æ‰èƒ½ä»¥ä¸€ä¸ªç¬¬ä¸‰æ–¹å…¬å¸è®¾è®¡å‡ºä¸€é—¨æ¥å¼€å‘ Android åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹è¯­è¨€</p><p>2ã€ä¸ºå•¥æœ‰äº† Java æ¥å¼€å‘ Android åº”ç”¨ç¨‹åºï¼ŒGoogle è¿˜è¦æ¨èä½¿ç”¨ Kotlin æ¥å¼€å‘ï¼Ÿ</p><p>åŸå› æœ‰å¾ˆå¤šï¼Œåˆ—ä¸¾ä¸»è¦çš„å‡ ç‚¹ï¼š</p><ul><li>1ï¼‰ã€Kotlin è¯­æ³•æ›´åŠ ç®€æ´ï¼Œä½¿ç”¨ Kotlin å¼€å‘çš„ä»£ç é‡å¯èƒ½ä¼šæ¯” Java å¼€å‘çš„å‡å°‘ 50% ç”šè‡³æ›´å¤š</li><li>2ï¼‰ã€Kotlin çš„è¯­æ³•æ›´åŠ é«˜çº§ï¼Œç›¸æ¯”äº Java è€æ—§çš„è¯­æ³•ï¼ŒKotlin å¢åŠ äº†å¾ˆå¤šç°ä»£é«˜çº§è¯­è¨€çš„è¯­æ³•ç‰¹æ€§ï¼Œå¤§å¤§æå‡äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</li><li>3ï¼‰ã€Kotlin å’Œ Java æ˜¯ 100% å…¼å®¹çš„ï¼ŒKotlin å¯ä»¥ç›´æ¥è°ƒç”¨ Java ç¼–å†™çš„ä»£ç ï¼Œä¹Ÿå¯ä»¥æ— ç¼ä½¿ç”¨ Java ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼Œè¿™ä½¿å¾— Kotlin åœ¨åŠ å…¥äº†è¯¸å¤šæ–°ç‰¹æ€§çš„åŒæ—¶ï¼Œè¿˜ç»§æ‰¿äº† Java çš„å…¨éƒ¨è´¢å¯Œ</li></ul><p>3ã€ä¸ºå•¥ Kotlin ä¸­è¦æ˜¾ç¤ºçš„å»å£°æ˜ä¸€ä¸ªéæŠ½è±¡ç±»å¯ç»§æ‰¿ï¼Œè€Œä¸åƒ Java é‚£æ ·å®šä¹‰çš„ç±»é»˜è®¤å¯ç»§æ‰¿ï¼Ÿ</p><p>å› ä¸ºä¸€ä¸ªç±»é»˜è®¤å¯è¢«ç»§æ‰¿çš„è¯ï¼Œå®ƒæ— æ³•é¢„çŸ¥å­ç±»ä¼šå¦‚ä½•å»å®ç°ï¼Œå› æ­¤å­˜åœ¨ä¸€äº›æœªçŸ¥çš„é£é™©ã€‚ç±»æ¯” val å…³é”®å­—æ˜¯åŒæ ·çš„é“ç†ï¼Œåœ¨ Java ä¸­ï¼Œé™¤éä½ ä¸»åŠ¨ç»™å˜é‡å£°æ˜ final å…³é”®å­—ï¼Œå¦åˆ™è¿™ä¸ªå˜é‡å°±æ˜¯å¯å˜çš„ï¼Œéšç€é¡¹ç›®å¤æ‚åº¦å¢åŠ ï¼Œå¤šäººåä½œå¼€å‘ï¼Œä½ æ°¸è¿œä¸çŸ¥é“ä¸€ä¸ªå¯å˜çš„å˜é‡ä¼šåœ¨ä»€ä¹ˆæ—¶å€™è¢«è°ä¿®æ”¹äº†ï¼Œå³ä½¿å®ƒåŸæœ¬ä¸åº”è¯¥ä¿®æ”¹ï¼Œä¹Ÿå¾ˆéš¾å»æ’æŸ¥é—®é¢˜ã€‚å› æ­¤ Kotlin è¿™æ ·çš„è®¾è®¡æ˜¯ä¸ºäº†è®©ç¨‹åºæ›´åŠ çš„å¥å£®ï¼Œä¹Ÿæ›´ç¬¦åˆé«˜è´¨é‡ç¼–ç çš„è§„èŒƒ</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ­£å¼è¿›å…¥åˆ° Kotlin çš„å­¦ä¹ </p><p><strong>é™„ä¸Šä¸€å¼ å­¦ä¹  Kotlin çš„æ€ç»´å¯¼å›¾</strong></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c02ae1fd55784c0593e53afa00fd1fec~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210116114509401"></p><p><strong>æ³¨æ„ï¼š Kotlin ç°ä½œä¸º Android ç¬¬ä¸€å¼€å‘è¯­è¨€ï¼ŒAndroidStudio ä½œä¸º Google çš„äº²å„¿å­ï¼Œå¯¹ Kotlin è¿›è¡Œäº†å®Œç¾çš„æ”¯æŒï¼Œå¼€å‘æç¤ºåº”æœ‰å°½æœ‰ï¼Œå› æ­¤ä¸‹é¢æ‰€æœ‰çš„æ¼”ç¤ºä»£ç éƒ½æ˜¯è·‘åœ¨ AndroidStudio ä¸Šçš„</strong></p><h2 id="ä¸€ã€å˜é‡å’Œå‡½æ•°"><a href="#ä¸€ã€å˜é‡å’Œå‡½æ•°" class="headerlink" title="ä¸€ã€å˜é‡å’Œå‡½æ•°"></a>ä¸€ã€å˜é‡å’Œå‡½æ•°</h2><h3 id="1ã€å˜é‡"><a href="#1ã€å˜é‡" class="headerlink" title="1ã€å˜é‡"></a>1ã€å˜é‡</h3><p>1ï¼‰ã€ä½¿ç”¨ valï¼ˆvalue çš„ç®€å†™ï¼‰å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯åªè¯»å˜é‡ï¼Œè¿™ç§å˜é‡åˆå§‹èµ‹å€¼åå°±ä¸èƒ½é‡æ–°èµ‹å€¼äº†ï¼Œå¯¹åº” Java ä¸­çš„ final å˜é‡</p><p>2ï¼‰ã€ä½¿ç”¨ var ï¼ˆvariable çš„ç®€å†™ï¼‰å…³é”®å­—ç”¨æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯è¯»å†™å˜é‡ï¼Œè¿™ç§å˜é‡åˆå§‹èµ‹åˆå€¼åä»ç„¶å¯ä»¥é‡æ–°è¢«èµ‹å€¼ï¼Œå¯¹åº” Java ä¸­çš„é final å˜é‡</p><p>3ï¼‰ã€Kotlin ä¸­çš„æ¯ä¸€è¡Œä»£ç éƒ½ä¸ç”¨åŠ  ï¼›</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå®šä¹‰</span><br>int a = <span class="hljs-number">10</span>;<br>boolean b = <span class="hljs-literal">true</span><br><br><span class="hljs-comment">//åœ¨ Kotlin ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®šä¹‰ï¼Œå½“ç»™å˜é‡èµ‹å€¼åï¼ŒKotlin ç¼–è¯‘å™¨ä¼šè¿›è¡Œç±»å‹æ¨å¯¼</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ a </span><br><span class="hljs-keyword">val</span> a = <span class="hljs-number">10</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯å˜çš„å˜é‡ b</span><br><span class="hljs-keyword">var</span> b = <span class="hljs-literal">true</span><br><br><span class="hljs-comment">//å¦‚æœæˆ‘ä»¬æ˜¾ç¤ºçš„ç»™å˜é‡æŒ‡å®šç±»å‹ï¼ŒKotlin å°±ä¸ä¼šè¿›è¡Œç±»å‹æ¨å¯¼äº†</span><br><span class="hljs-keyword">val</span> a: <span class="hljs-built_in">Int</span> = <span class="hljs-number">10</span><br><span class="hljs-keyword">var</span> b: <span class="hljs-built_in">Boolean</span> = <span class="hljs-string">&quot;erdai&quot;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä½ è§‚å¯Ÿçš„ä»”ç»†ä¼šå‘ç°ï¼Œä¸Šè¿°ä»£ç  Kotlin å®šä¹‰å˜é‡ç»™å˜é‡æ˜¾ç¤ºçš„æŒ‡å®šç±»å‹æ—¶ï¼Œä½¿ç”¨çš„éƒ½æ˜¯é¦–å­—æ¯å¤§å°çš„ Intï¼ŒBooleanï¼Œè€Œåœ¨ Java ä¸­éƒ½æ˜¯å°å†™çš„ intï¼Œbooleanï¼Œè¿™è¡¨æ˜ï¼š <strong>Kotlin å®Œå…¨æŠ›å¼ƒäº† Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¨éƒ¨éƒ½æ˜¯å¯¹è±¡æ•°æ®ç±»å‹ã€‚</strong> ä¸‹é¢ç»™å‡ºä¸€ä¸ª Java å’Œ Kotlin æ•°æ®ç±»å‹å¯¹ç…§è¡¨ï¼š</p><table><thead><tr><th>Java åŸºæœ¬æ•°æ®ç±»å‹</th><th>Kotlin å¯¹è±¡æ•°æ®ç±»å‹</th><th>æ•°æ®ç±»å‹è¯´æ˜</th></tr></thead><tbody><tr><td>byte</td><td>Byte</td><td>å­—èŠ‚å‹</td></tr><tr><td>short</td><td>Short</td><td>çŸ­æ•´å‹</td></tr><tr><td>int</td><td>Int</td><td>æ•´å‹</td></tr><tr><td>long</td><td>Long</td><td>é•¿æ•´å‹</td></tr><tr><td>float</td><td>Float</td><td>å•ç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td>double</td><td>Double</td><td>åŒç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td>char</td><td>Char</td><td>å­—ç¬¦å‹</td></tr><tr><td>boolean</td><td>Boolean</td><td>å¸ƒå°”å‹</td></tr></tbody></table><h3 id="2ã€å¸¸é‡"><a href="#2ã€å¸¸é‡" class="headerlink" title="2ã€å¸¸é‡"></a>2ã€å¸¸é‡</h3><p>Kotlin ä¸­å®šä¹‰ä¸€ä¸ªå¸¸é‡éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶</p><p>1ï¼‰ã€ä½¿ç”¨ const val æ¥ä¿®é¥°ï¼Œå¹¶åˆå§‹åŒ–</p><p>2ï¼‰ã€ä¿®é¥°çš„ç±»å‹åªèƒ½æ˜¯å­—ç¬¦ä¸²å’ŒåŸºç¡€å¯¹è±¡ç±»å‹</p><p>3ï¼‰ã€åªèƒ½ä¿®é¥°é¡¶å±‚çš„å¸¸é‡ï¼Œobject ä¿®é¥°çš„æˆå‘˜ï¼Œcompanion object çš„æˆå‘˜ï¼Œè¿™äº›æ¦‚å¿µåé¢è¿˜ä¼šè®²åˆ°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé¡¶å±‚çš„å¸¸é‡ï¼Œè¿™ä¸ªå¸¸é‡ä¸æ”¾åœ¨ä»»ä½•çš„ç±»ä¸­</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> CONSTANT = <span class="hljs-string">&quot;This is a constant&quot;</span><br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª object ä¿®é¥°çš„å•ä¾‹ç±»ï¼Œç±»ä¸­å®šä¹‰ä¸€ä¸ªå¸¸é‡</span><br><span class="hljs-keyword">object</span> SingeTon &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> CONSTANT = <span class="hljs-string">&quot;This is a constant&quot;</span><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">KotlinPractice</span> &#123;<br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª companion object ä¿®é¥°çš„ä¼´ç”Ÿå¯¹è±¡ï¼Œé‡Œé¢å®šä¹‰ä¸€ä¸ªå¸¸é‡</span><br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> CONSTANT = <span class="hljs-string">&quot;This is a constant&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€å‡½æ•°"><a href="#3ã€å‡½æ•°" class="headerlink" title="3ã€å‡½æ•°"></a>3ã€å‡½æ•°</h3><p>1ï¼‰ã€å‡½æ•°å’Œæ–¹æ³•æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼Œåœ¨ Java ä¸­æˆ‘ä»¬ä¹ æƒ¯å«æ–¹æ³• (method)ï¼Œä½†æ˜¯ Kotlin ä¸­å°±éœ€è¦å«å‡½æ•° (function)</p><p>2ï¼‰ã€å‡½æ•°æ˜¯è¿è¡Œä»£ç çš„è½½ä½“,åƒæˆ‘ä»¬ä½¿ç”¨è¿‡çš„ main å‡½æ•°å°±æ˜¯ä¸€ä¸ªå‡½æ•°</p><p>Kotlin ä¸­å®šä¹‰è¯­æ³•çš„è§„åˆ™ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">methodName</span><span class="hljs-params">(param1: <span class="hljs-type">Int</span>, param2: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-comment">//ä¸‹é¢è¿™ä¸¤ä¸ªæ–¹æ³•æ•ˆæœæ˜¯ä¸€æ ·çš„</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">methodName1</span><span class="hljs-params">(params: <span class="hljs-type">Int</span>,params2: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Unit</span>&#123;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">methodName1</span><span class="hljs-params">(params: <span class="hljs-type">Int</span>,params2: <span class="hljs-type">Int</span>)</span></span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å‡½æ•°è¯­æ³•è§£é‡Šï¼š</p><ul><li>fun ( function çš„ç¼©å†™ ) æ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•°çš„å…³é”®å­—ï¼Œæ— è®ºä½ å®šä¹‰ä»€ä¹ˆå‡½æ•°ï¼Œéƒ½è¦ç”¨ fun æ¥å£°æ˜</li><li>å‡½æ•°åç§°å¯ä»¥éšä¾¿å–ï¼Œå°±åƒ Java é‡Œé¢å®šä¹‰å‡½æ•°åä¸€æ ·</li><li>å‡½æ•°åé‡Œé¢çš„å‚æ•°å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼Œå‚æ•°çš„å£°æ˜æ ¼å¼ä¸ºï¼šâ€å‚æ•°åâ€ï¼šâ€å‚æ•°ç±»å‹â€</li><li>å‚æ•°ååé¢è¿™éƒ¨åˆ†ä»£è¡¨è¿”å›å€¼ï¼Œæˆ‘ä»¬è¿™è¿”å›çš„æ˜¯ä¸€ä¸ª Int ç±»å‹çš„å€¼ï¼Œè¿™éƒ¨åˆ†æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸å®šä¹‰ï¼Œé»˜è®¤è¿”å›å€¼ä¸º Unitï¼Œä¸” Unit å¯çœç•¥</li></ul><p>å®è·µä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> number1 = <span class="hljs-number">15</span><br>    <span class="hljs-keyword">val</span> number2 = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> maxNumber = largeNumber(number1,number2)<br>    println(maxNumber)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largeNumber</span><span class="hljs-params">(number1: <span class="hljs-type">Int</span>,number2: <span class="hljs-type">Int</span>)</span></span> : <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-comment">//è°ƒç”¨é¡¶å±‚ max å‡½æ•°è®¡ç®—ä¸¤è€…ä¸­çš„æœ€å¤§å€¼</span><br>    <span class="hljs-keyword">return</span> max(number1,number2)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><strong>Kotlin è¯­æ³•ç³–ï¼šå½“ä¸€ä¸ªå‡½æ•°ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç¼–å†™å‡½æ•°ä½“ï¼Œå¯ä»¥å°†å”¯ä¸€çš„ä¸€è¡Œä»£ç å†™åœ¨å‡½æ•°å®šä¹‰çš„å°¾éƒ¨ï¼Œä¸­é—´ç”¨ &#x3D; è¿æ¥å³å¯</strong></p><p>é‚£ä¹ˆä¸Šè¿° largeNumber è¿™ä¸ªå‡½æ•°æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æ ¹æ®ä¸Šè¿°è¯­æ³•ç³–ï¼Œæˆ‘ä»¬çœç•¥äº†å‡½æ•°ä½“çš„ &#123;&#125; å’Œ return å…³é”®å­—ï¼Œå¢å‡çš„ = è¿æ¥</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largeNumber</span><span class="hljs-params">(number1: <span class="hljs-type">Int</span>,number2: <span class="hljs-type">Int</span>)</span></span> : <span class="hljs-built_in">Int</span> = max(number1,number2)<br><span class="hljs-comment">//æ ¹æ® Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠå‡½æ•°çš„è¿”å›å€¼ç»™çœç•¥ï¼Œæœ€ç»ˆå˜æˆäº†è¿™æ ·</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largeNumber</span><span class="hljs-params">(number1: <span class="hljs-type">Int</span>,number2: <span class="hljs-type">Int</span>)</span></span> = max(number1,number2)<br></code></pre></td></tr></table></figure><h2 id="äºŒã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶"><a href="#äºŒã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶" class="headerlink" title="äºŒã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶"></a>äºŒã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶</h2><h3 id="1ã€if-æ¡ä»¶è¯­å¥"><a href="#1ã€if-æ¡ä»¶è¯­å¥" class="headerlink" title="1ã€if æ¡ä»¶è¯­å¥"></a>1ã€if æ¡ä»¶è¯­å¥</h3><p>1ï¼‰ã€Kotlin ä¸­çš„ if æ¡ä»¶è¯­å¥é™¤äº†ç»§æ‰¿äº† Java ä¸­ if æ¡ä»¶è¯­å¥çš„æ‰€æœ‰ç‰¹æ€§ï¼Œä¸”å¯ä»¥æŠŠæ¯ä¸€ä¸ªæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</p><p>æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ä¸Šè¿° largeNumber å‡½æ•°çš„å†…éƒ¨å®ç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//Kotlin ä¸­æŠŠæ¯ä¸€ä¸ªæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largeNumber</span><span class="hljs-params">(number1: <span class="hljs-type">Int</span>,number2: <span class="hljs-type">Int</span>)</span></span> : <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span>(number1 &gt; number2)&#123;<br>      number1<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>      number2<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ ¹æ®ä¸Šé¢å­¦ä¹ çš„è¯­æ³•ç³–å’Œ Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç®€å†™ largeNumber å‡½æ•°ï¼Œæœ€ç»ˆå˜æˆäº†è¿™æ ·</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largeNumber</span><span class="hljs-params">(number1: <span class="hljs-type">Int</span>,number2: <span class="hljs-type">Int</span>)</span></span> = <span class="hljs-keyword">if</span>(number1 &gt; number2) number1 <span class="hljs-keyword">else</span> number <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="2ã€when-æ¡ä»¶è¯­å¥"><a href="#2ã€when-æ¡ä»¶è¯­å¥" class="headerlink" title="2ã€when æ¡ä»¶è¯­å¥"></a>2ã€when æ¡ä»¶è¯­å¥</h3><p>ç±»æ¯” Java ä¸­çš„ Switch è¯­å¥å­¦ä¹ ï¼ŒJava ä¸­çš„ Switch å¹¶ä¸æ€ä¹ˆå¥½ç”¨ï¼š</p><p>1ï¼‰ã€Switch è¯­å¥åªèƒ½æ”¯æŒä¸€äº›ç‰¹å®šçš„ç±»å‹ï¼Œå¦‚æ•´å‹ï¼ŒçŸ­äºæ•´å‹ï¼Œå­—ç¬¦ä¸²ï¼Œæšä¸¾ç±»å‹ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„å¹¶éè¿™å‡ ç§ç±»å‹ï¼ŒSwitch å¹¶ä¸å¯ç”¨</p><p>2ï¼‰ã€Switch è¯­å¥çš„ case æ¡ä»¶éƒ½è¦åœ¨æœ€ååŠ ä¸Šä¸€ä¸ª break</p><p>è¿™äº›é—®é¢˜åœ¨ Kotlin ä¸­éƒ½å¾—åˆ°äº†è§£å†³ï¼Œè€Œä¸” Kotlin è¿˜åŠ å…¥äº†è®¸å¤šå¼ºå¤§çš„æ–°ç‰¹æ€§ï¼š</p><p>1ï¼‰ã€when æ¡ä»¶è¯­å¥ä¹Ÿæ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå’Œ if æ¡ä»¶è¯­å¥ç±»ä¼¼ï¼Œæ¡ä»¶ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</p><p>2ï¼‰ã€when æ¡ä»¶è¯­å¥å…è®¸ä¼ å…¥ä»»æ„ç±»å‹çš„å‚æ•°</p><p>3ï¼‰ã€when æ¡ä»¶ä½“ä¸­æ¡ä»¶æ ¼å¼ï¼šåŒ¹é…å€¼ -&gt; { æ‰§è¡Œé€»è¾‘ }</p><p>4ï¼‰ã€when æ¡ä»¶è¯­å¥å’Œ if æ¡ä»¶è¯­å¥ä¸€æ ·ï¼Œå½“æ¡ä»¶ä½“é‡Œé¢åªæœ‰ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œæ¡ä»¶ä½“çš„ {} å¯çœç•¥</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//when ä¸­æœ‰å‚æ•°çš„æƒ…å†µ</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScore</span><span class="hljs-params">(name: <span class="hljs-type">String</span>)</span></span> = <span class="hljs-keyword">when</span> (name) &#123;<br>    <span class="hljs-string">&quot;tom&quot;</span> -&gt; <span class="hljs-number">99</span><br>    <span class="hljs-string">&quot;jim&quot;</span> -&gt; <span class="hljs-number">80</span><br>    <span class="hljs-string">&quot;lucy&quot;</span> -&gt; <span class="hljs-number">70</span><br>    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-comment">//when ä¸­æ— å‚æ•°çš„æƒ…å†µï¼ŒKotin ä¸­åˆ¤æ–­å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œç›´æ¥ä½¿ç”¨ == æ“ä½œç¬¦å³å¯</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScore</span><span class="hljs-params">(name: <span class="hljs-type">String</span>)</span></span> = <span class="hljs-keyword">when</span> &#123;<br>    name == <span class="hljs-string">&quot;tom&quot;</span> -&gt; <span class="hljs-number">99</span><br>    name == <span class="hljs-string">&quot;jim&quot;</span> -&gt; <span class="hljs-number">80</span><br>    name ==<span class="hljs-string">&quot;lucy&quot;</span> -&gt; <span class="hljs-number">70</span><br>    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€å¾ªç¯è¯­å¥"><a href="#3ã€å¾ªç¯è¯­å¥" class="headerlink" title="3ã€å¾ªç¯è¯­å¥"></a>3ã€å¾ªç¯è¯­å¥</h3><p>ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§å¾ªç¯ï¼š</p><p>1ï¼‰ã€while å¾ªç¯ï¼Œè¿™ç§å¾ªç¯å’Œ Java æ²¡æœ‰ä»»ä½•åŒºåˆ«</p><p>2ï¼‰ã€for å¾ªç¯ï¼ŒJava ä¸­å¸¸ç”¨çš„å¾ªç¯æœ‰ï¼šfor-iï¼Œfor-eachï¼ŒKotlin ä¸­ä¸»è¦æ˜¯ï¼šfor-in</p><p><strong>åŒºé—´</strong></p><p>1ï¼‰ã€ä½¿ç”¨ .. è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„å‡åºåŒºé—´</p><p>2ï¼‰ã€ä½¿ç”¨ until è¡¨ç¤ºåˆ›å»ºå·¦ç«¯æ˜¯é—­åŒºé—´å³ç«¯æ˜¯å¼€åŒºé—´çš„å‡åºåŒºé—´</p><p>3ï¼‰ã€ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´</p><p>4ï¼‰ã€åœ¨åŒºé—´çš„åé¢åŠ ä¸Š step ï¼Œè¡¨ç¤ºè·³è¿‡å‡ ä¸ªå…ƒç´ </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æ³¨æ„: Kotlin ä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­å¯ä»¥å¼•ç”¨å˜é‡ï¼Œåç»­è¿˜ä¼šè®²åˆ°</span><br><span class="hljs-comment">//æƒ…å†µ1</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ .. è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„å‡åºåŒºé—´</span><br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span><span class="hljs-number">.10</span>)&#123;<br>        print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">10</span><br><br><span class="hljs-comment">//æƒ…å†µ2</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ until è¡¨ç¤ºåˆ›å»ºå·¦ç«¯æ˜¯é—­åŒºé—´å³ç«¯æ˜¯å¼€åŒºé—´çš„å‡åºåŒºé—´</span><br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until <span class="hljs-number">10</span>)&#123;<br>        print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span><br><br><span class="hljs-comment">//æƒ…å†µ3</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´</span><br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">10</span> downTo <span class="hljs-number">0</span>)&#123;<br>        print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10</span> <span class="hljs-number">9</span> <span class="hljs-number">8</span> <span class="hljs-number">7</span> <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span><br><br><span class="hljs-comment">//æƒ…å†µ4</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ downTo è¡¨ç¤ºåˆ›å»ºä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„é™åºåŒºé—´,æ¯æ¬¡åœ¨è·³è¿‡3ä¸ªå…ƒç´ </span><br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">10</span> downTo <span class="hljs-number">0</span> step <span class="hljs-number">3</span>)&#123;<br>        print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10</span> <span class="hljs-number">7</span> <span class="hljs-number">4</span> <span class="hljs-number">1</span> <br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#ä¸‰ã€é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="ä¸‰ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>ä¸‰ã€é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>å¯¹äºé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç†è§£ï¼šé¢å‘å¯¹è±¡çš„è¯­è¨€æ˜¯å¯ä»¥åˆ›å»ºç±»çš„ï¼Œç±»æ˜¯å¯¹äº‹ç‰©ä¸€ç§çš„å°è£…ï¼Œä¾‹å¦‚äººï¼Œæ±½è½¦æˆ‘ä»¬éƒ½å¯ä»¥æŠŠä»–ä»¬å°è£…æˆç±»ï¼Œç±»åé€šå¸¸æ˜¯åè¯ï¼Œç±»ä¸­æœ‰è‡ªå·±çš„å­—æ®µå’Œå‡½æ•°ï¼Œå­—æ®µè¡¨ç¤ºè¯¥ç±»æ‹¥æœ‰çš„å±æ€§ï¼Œé€šå¸¸ä¹Ÿæ˜¯åè¯ï¼Œå°±åƒäººå¯ä»¥æ‹¥æœ‰å§“åå’Œå¹´é¾„ï¼Œæ±½è½¦å¯ä»¥æ‹¥æœ‰å“ç‰Œå’Œä»·æ ¼ï¼Œå‡½æ•°è¡¨ç¤ºè¯¥ç±»æ‹¥æœ‰é‚£äº›è¡Œä¸ºï¼Œä¸€èˆ¬ä¸ºåŠ¨è¯ï¼Œå°±åƒäººéœ€è¦åƒé¥­ç¡è§‰ï¼Œæ±½è½¦å¯ä»¥é©¾é©¶å’Œä¿å…»ï¼Œé€šè¿‡è¿™ç§ç±»çš„å°è£…ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨é€‚å½“çš„åœ°æ–¹åˆ›å»ºè¿™äº›ç±»ï¼Œç„¶åè°ƒç”¨ä»–ä»¬çš„å­—æ®µå’Œå‡½æ•°æ¥æ»¡è¶³å®é™…çš„ç¼–ç¨‹éœ€æ±‚ï¼Œè¿™å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹æœ€åŸºæœ¬çš„æ€æƒ³</p><h3 id="1ã€ç±»ä¸å¯¹è±¡"><a href="#1ã€ç±»ä¸å¯¹è±¡" class="headerlink" title="1ã€ç±»ä¸å¯¹è±¡"></a>1ã€ç±»ä¸å¯¹è±¡</h3><p>æˆ‘ä»¬ä½¿ç”¨ AndroidStudio åˆ›å»ºä¸€ä¸ª Person ç±»ï¼Œåœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­è¾“å…¥ Person ï¼Œé€‰æ‹©Classï¼Œå¯¹è¯æ¡†é»˜è®¤æƒ…å†µä¸‹è‡ªåŠ¨é€‰ä¸­çš„æ˜¯åˆ›å»ºä¸€ä¸ªFileï¼ŒFile é€šå¸¸æ˜¯ç”¨äºç¼–å†™ Kotlin é¡¶å±‚å‡½æ•°å’Œæ‰©å±•å‡½æ•°ç­‰ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/71d1af4be3224b1c8bc6e8b0264aa18b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210316190225365"></p><p>1ï¼‰ã€å½“æˆ‘ä»¬åœ¨ç±»ä¸­åˆ›å»ºå±æ€§çš„æ—¶å€™ï¼ŒKotlin ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º get å’Œ set æ–¹æ³•</p><p>2ï¼‰ã€Kotlin ä¸­å®ä¾‹åŒ–å¯¹è±¡å’Œ Java ç±»ä¼¼ï¼Œä½†æ˜¯æŠŠ new å…³é”®å­—ç»™å»æ‰äº†</p><p>3ï¼‰ã€ä¸€èˆ¬åœ¨ç±»ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨ var å…³é”®å­—å»å®šä¹‰ä¸€ä¸ªå±æ€§ï¼Œå› ä¸ºå±æ€§ä¸€èˆ¬æ˜¯å¯å˜çš„ï¼Œå¦‚æœä½ ç¡®å®šæŸä¸ªå±æ€§ä¸éœ€è¦æ”¹å˜ï¼Œåˆ™ç”¨ val</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">var</span> age = <span class="hljs-number">0</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sleep</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is sleep, He is <span class="hljs-variable">$age</span> years old.&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> person = Person()<br>    person.name = <span class="hljs-string">&quot;erdai&quot;</span><br>    person.age = <span class="hljs-number">20</span><br>    person.sleep()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-keyword">is</span> sleep, He <span class="hljs-keyword">is</span> <span class="hljs-number">20</span> years old.<br></code></pre></td></tr></table></figure><h3 id="2ã€ç»§æ‰¿ä¸æ„é€ å‡½æ•°"><a href="#2ã€ç»§æ‰¿ä¸æ„é€ å‡½æ•°" class="headerlink" title="2ã€ç»§æ‰¿ä¸æ„é€ å‡½æ•°"></a>2ã€ç»§æ‰¿ä¸æ„é€ å‡½æ•°</h3><h4 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h4><p>1ï¼‰ã€Kotlin ä¸­è§„å®šï¼Œå¦‚æœè¦å£°æ˜ä¸€ä¸ªéæŠ½è±¡ç±»å¯ç»§æ‰¿ï¼Œå¿…é¡»åŠ ä¸Š open å…³é”®å­—ï¼Œå¦åˆ™ä¸å¯ç»§æ‰¿ï¼Œè¿™ç‚¹å’Œ Java ä¸­ä¸åŒï¼ŒJava ä¸­çš„ç±»é»˜è®¤æ˜¯å¯è¢«ç»§æ‰¿çš„ï¼ŒEffective Java è¿™æœ¬ä¹¦ä¸­æåˆ°ï¼šå¦‚æœä¸€ä¸ªç±»ä¸æ˜¯ä¸“é—¨ä¸ºç»§æ‰¿è€Œè®¾è®¡çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä¸»åŠ¨å°†å®ƒåŠ ä¸Š final å£°æ˜ï¼Œç¦æ­¢ä»–å¯ä»¥è¢«ç»§æ‰¿</p><p>2ï¼‰ã€Kotlinä¸­çš„ç»§æ‰¿å’Œå®ç°éƒ½æ˜¯ç”¨ : è¡¨ç¤º</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å£°æ˜ Person ç±»å¯ä»¥è¢«ç»§æ‰¿</span><br><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">var</span> age = <span class="hljs-number">0</span><br>  <br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sleep</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is sleep, He is <span class="hljs-variable">$age</span> years old.&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ Student ç»§æ‰¿ Person ç±»</span><br><span class="hljs-comment">//ä¸ºå•¥ Person åé¢ä¼šæœ‰ä¸€ä¸ªæ‹¬å·å‘¢ï¼Ÿå› ä¸ºå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨çˆ¶ç±»ä¸­çš„æ„é€ å‡½æ•°ï¼Œåœ¨ Java ä¸­ï¼Œå­ç±»çš„æ„é€ å‡½æ•°ä¼šéšå¼çš„å»è°ƒç”¨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> : <span class="hljs-type">Person</span>()&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p>1ï¼‰ã€ä¸»æ„é€ å‡½æ•°çš„ç‰¹ç‚¹æ˜¯æ²¡æœ‰å‡½æ•°ä½“ï¼Œç›´æ¥è·Ÿåœ¨ç±»åçš„åé¢å³å¯ï¼Œå¦‚æœéœ€è¦åœ¨ä¸»æ„é€ å‡½æ•°é‡Œé¢åšé€»è¾‘ï¼Œå¤å†™ init å‡½æ•°å³å¯</p><p>2ï¼‰ã€ä¸»æ„é€ å‡½æ•°ä¸­å£°æ˜æˆ val æˆ–è€… var çš„å‚æ•°å°†è‡ªåŠ¨æˆä¸ºè¯¥ç±»çš„å­—æ®µï¼Œå¦‚æœä¸åŠ ï¼Œé‚£ä¹ˆè¯¥å­—æ®µçš„ä½œç”¨åŸŸä»…é™å®šåœ¨ä¸»æ„é€ å‡½æ•°ä¸­</p><p>3ï¼‰ã€æ¬¡æ„é€ å‡½æ•°æ˜¯é€šè¿‡ constructor å…³é”®å­—æ¥å®šä¹‰çš„</p><p>4ï¼‰ã€å½“ä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºçš„å®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å®šä¹‰äº†æ¬¡æ„é€ å‡½æ•°æ—¶ï¼Œé‚£ä¹ˆè¢«ç»§æ‰¿çš„ç±»åé¢ä¸éœ€è¦åŠ  ()</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ Student ç±»ï¼Œå®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œå®šä¹‰å±æ€§ sno å’Œ grade, ç»§æ‰¿ Person ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>(<span class="hljs-keyword">var</span> sno: String, <span class="hljs-keyword">var</span> grade: <span class="hljs-built_in">Int</span>) : Person() &#123;<br>        <span class="hljs-comment">//åšä¸€äº›åˆå§‹åŒ–çš„é€»è¾‘</span><br>  <span class="hljs-keyword">init</span> &#123;<br>        name = <span class="hljs-string">&quot;erdai&quot;</span><br>        age = <span class="hljs-number">20</span><br>    &#125;<br>    <br>    <span class="hljs-comment">//å£°æ˜å¸¦ä¸€ä¸ªå‚æ•°çš„æ¬¡æ„é€ å‡½æ•°</span><br>    <span class="hljs-keyword">constructor</span>(sno: String): <span class="hljs-keyword">this</span>(sno,<span class="hljs-number">8</span>)&#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªæ— å‚çš„æ¬¡æ„é€ å‡½æ•°</span><br>    <span class="hljs-keyword">constructor</span>(): <span class="hljs-keyword">this</span>(<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-number">7</span>)&#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printInfo</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;I am <span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span> yeas old, sno: <span class="hljs-variable">$sno</span>, grade: <span class="hljs-variable">$grade</span>&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> student1 = Student()<br>    <span class="hljs-keyword">val</span> student2 = Student(<span class="hljs-string">&quot;456&quot;</span>)<br>    <span class="hljs-keyword">val</span> student3 = Student(<span class="hljs-string">&quot;789&quot;</span>,<span class="hljs-number">9</span>)<br>    student1.printInfo()<br>    student2.printInfo()<br>    student3.printInfo()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>I am erdai, <span class="hljs-number">20</span> yeas old, sno: <span class="hljs-number">123</span>, grade: <span class="hljs-number">7</span><br>I am erdai, <span class="hljs-number">20</span> yeas old, sno: <span class="hljs-number">456</span>, grade: <span class="hljs-number">8</span><br>I am erdai, <span class="hljs-number">20</span> yeas old, sno: <span class="hljs-number">789</span>, grade: <span class="hljs-number">9</span><br><br><span class="hljs-comment">//ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå½“ä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºçš„å®šä¹‰ä¸»æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å®šä¹‰äº†æ¬¡æ„é€ å‡½æ•°æ—¶ï¼Œé‚£ä¹ˆè¢«ç»§æ‰¿çš„ç±»åé¢ä¸éœ€è¦åŠ  ()</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> : <span class="hljs-type">Person</span>&#123;<br>    <span class="hljs-keyword">constructor</span>() : <span class="hljs-keyword">super</span>()&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€æ¥å£"><a href="#3ã€æ¥å£" class="headerlink" title="3ã€æ¥å£"></a>3ã€æ¥å£</h3><p>1ï¼‰ã€Kotlin å’Œ Java ä¸­å®šä¹‰æ¥å£æ²¡æœ‰ä»»ä½•åŒºåˆ«</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰æ¥å£ä¸­çš„ä¸€ç³»åˆ—çš„æŠ½è±¡è¡Œä¸º Kotlin ä¸­å¢åŠ äº†æ¥å£ä¸­å®šä¹‰çš„å‡½æ•°å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼Œå…¶å® Java åœ¨ JDK1.8 ä¹‹åä¹Ÿå¼€å§‹æ”¯æŒè¿™ä¸ªåŠŸèƒ½</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Study</span>&#123;<br>     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readBooks</span><span class="hljs-params">()</span></span><br>     <span class="hljs-comment">//å¦‚æœå­ç±»æ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•,é‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„é»˜è®¤å®ç°</span><br>     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doHomework</span><span class="hljs-params">()</span></span>&#123;<br>         println(<span class="hljs-string">&quot;do homework default implementation&quot;</span>)<br>     &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯è¢«ç»§æ‰¿çš„ People ç±»ï¼Œæœ‰ name å’Œ age ä¸¤ä¸ªå±æ€§</span><br><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>(<span class="hljs-keyword">val</span> name: String,<span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>)&#123;<br><br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª Student ç±»ï¼Œç»§æ‰¿ People ç±»ï¼Œå®ç° Study æ¥å£</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>(name: String, age: <span class="hljs-built_in">Int</span>) : People(name, age),Study&#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readBooks</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is read book&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰çš„ä¸€ä¸ªæ–¹æ³• ç„¶ååœ¨mainå‡½æ•°è°ƒç”¨</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>)</span></span>&#123;<br>    study.readBooks()<br>    study.doHomework()<br>&#125;<br><br><span class="hljs-comment">//mainå‡½æ•°è°ƒç”¨</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> student = Student(<span class="hljs-string">&quot;erdai&quot;</span>,<span class="hljs-number">20</span>)<br>    <span class="hljs-comment">//è¿™é‡Œstudentå®ç°äº†Studyæ¥å£,è¿™ç§å«åšé¢å‘æ¥å£ç¼–ç¨‹,ä¹Ÿå¯ä»¥ç§°ä¸ºå¤šæ€</span><br>    doStydy(student)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-keyword">is</span> read book<br><span class="hljs-keyword">do</span> homework default implementation<br><br></code></pre></td></tr></table></figure><h3 id="4ã€å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦"><a href="#4ã€å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦" class="headerlink" title="4ã€å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦"></a>4ã€å‡½æ•°çš„å¯è§æ€§ä¿®é¥°ç¬¦</h3><table><thead><tr><th>ä¿®é¥°ç¬¦</th><th>Java</th><th>Kotlin</th></tr></thead><tbody><tr><td>public</td><td>æ‰€æœ‰ç±»å¯è§</td><td>æ‰€æœ‰ç±»å¯è§(é»˜è®¤)</td></tr><tr><td>private</td><td>å½“å‰ç±»å¯è§</td><td>å½“å‰ç±»å¯è§</td></tr><tr><td>protected</td><td>å½“å‰ç±»,å­ç±»,åŒä¸€ä¸ªåŒ…ä¸‹çš„å¯è§</td><td>å½“å‰ç±»å’Œå­ç±»å¯è§</td></tr><tr><td>default</td><td>åŒä¸€ä¸ªåŒ…ä¸‹çš„å¯è§(é»˜è®¤)</td><td>æ— </td></tr><tr><td>internal</td><td>æ— </td><td>åŒä¸€ä¸ªæ¨¡å—ä¸­çš„ç±»å¯è§</td></tr></tbody></table><h3 id="5ã€æ•°æ®ç±»ä¸å•ä¾‹ç±»"><a href="#5ã€æ•°æ®ç±»ä¸å•ä¾‹ç±»" class="headerlink" title="5ã€æ•°æ®ç±»ä¸å•ä¾‹ç±»"></a>5ã€æ•°æ®ç±»ä¸å•ä¾‹ç±»</h3><h4 id="æ•°æ®ç±»"><a href="#æ•°æ®ç±»" class="headerlink" title="æ•°æ®ç±»"></a>æ•°æ®ç±»</h4><p>1ï¼‰ã€åœ¨ Java ä¸­ï¼Œæ•°æ®ç±»é€šå¸¸éœ€è¦é‡å†™ equals( )ï¼ŒhashCode( )ï¼ŒtoString( ) è¿™å‡ ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ equals( ) æ–¹æ³•ç”¨äºåˆ¤æ–­ä¸¤ä¸ªæ•°æ®ç±»æ˜¯å¦ç›¸ç­‰ã€‚hashCode( ) æ–¹æ³•ä½œä¸º equals( ) çš„é…å¥—æ–¹æ³•ï¼Œä¹Ÿéœ€è¦ä¸€èµ·é‡å†™ï¼Œå¦åˆ™ä¼šå¯¼è‡´ hash ç›¸å…³çš„ç³»ç»Ÿç±»æ— æ³•æ­£å¸¸å·¥ä½œï¼ŒtoString( ) æ–¹æ³•åˆ™ç”¨äºæä¾›æ›´æ¸…æ™°çš„è¾“å…¥æ—¥å¿—ï¼Œå¦åˆ™ä¸€ä¸ªæ•°æ®ç±»é»˜è®¤æ‰“å°å‡ºæ¥çš„æ˜¯ä¸€è¡Œå†…å­˜åœ°å€</p><p>2ï¼‰ã€åœ¨ Kotlin ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ data å…³é”®å­—å»ä¿®é¥°ä¸€ä¸ªç±»ï¼ŒKotlin å°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆ Java éœ€è¦é‡å†™çš„é‚£äº›æ–¹æ³•</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå†™</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cellphone</span> &#123;<br>    <br>    String brand;<br>    double price;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> boolean equals(Object o) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">if</span> (o == <span class="hljs-literal">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        Cellphone cellphone = (Cellphone) o;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Double</span>.compare(cellphone.price, price) == <span class="hljs-number">0</span> &amp;&amp;<br>                Objects.equals(brand, cellphone.brand);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> int hashCode() &#123;<br>        <span class="hljs-keyword">return</span> Objects.hash(brand, price);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String toString() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Cellphone&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;brand=&#x27;&quot;</span> + brand + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, price=&quot;</span> + price +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//åœ¨ Kotlin ä¸­ï¼Œä½ ä¼šå‘ç°æ˜¯å¦‚æ­¤çš„ç®€æ´</span><br><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cellphone</span>(<span class="hljs-keyword">val</span> brand: String, <span class="hljs-keyword">val</span> price: <span class="hljs-built_in">Double</span>)<br></code></pre></td></tr></table></figure><h4 id="å•ä¾‹ç±»"><a href="#å•ä¾‹ç±»" class="headerlink" title="å•ä¾‹ç±»"></a>å•ä¾‹ç±»</h4><p>1ï¼‰ã€Kotlin ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ object å…³é”®å­—å»æ›¿æ¢ class å…³é”®å­—å°±å¯ä»¥å»å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»äº†</p><p>2ï¼‰ã€è°ƒç”¨å•ä¾‹ç±»ä¸­çš„æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ç±»å . ä¸Šæ–¹æ³•å°±å¯ä»¥äº†ï¼Œç±»ä¼¼äº Java ä¸­çš„é™æ€æ–¹æ³•è°ƒç”¨æ–¹å¼</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//javaä¸­å•ä¾‹ æ‡’æ±‰å¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span>&#123;<br>  <span class="hljs-keyword">private</span> static Singleton instance;<br>  <br>  <span class="hljs-keyword">public</span> synchronized static Singleton getInstace() &#123;<br>      <span class="hljs-keyword">if</span>(instance == <span class="hljs-literal">null</span>)&#123;<br>            instance = new Singleton();<br>          &#125;<br>      <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>  <br>  <span class="hljs-keyword">public</span> void singleonTest()&#123;<br>      System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;singletonTest in Java is called.&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//Kotlinä¸­çš„å•ä¾‹</span><br><span class="hljs-keyword">object</span> Singleton&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">singletonTest</span><span class="hljs-params">()</span></span>&#123;<br>      println(<span class="hljs-string">&quot;singletonTest in Kotlin is called.&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    Singleton.singletonTest()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>singletonTest <span class="hljs-keyword">in</span> Kotlin <span class="hljs-keyword">is</span> called.<br></code></pre></td></tr></table></figure><h2 id="Lambda-ç¼–ç¨‹"><a href="#Lambda-ç¼–ç¨‹" class="headerlink" title="Lambda ç¼–ç¨‹"></a>Lambda ç¼–ç¨‹</h2><p>Kotlin ä»ç¬¬ä¸€ä¸ªç‰ˆæœ¬å°±å¼€å§‹æ”¯æŒäº† Lambda ç¼–ç¨‹ï¼Œå¹¶ä¸” Kotlin ä¸­çš„ Lambda è¡¨è¾¾å¼æä¸ºå¼ºå¤§ï¼Œæœ¬ç« æˆ‘ä»¬å­¦ä¹  Lambda ç¼–ç¨‹çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼š</p><p>1ï¼‰ã€ç®€å•æ¥è¯´ï¼ŒLambda å°±æ˜¯ä¸€æ®µå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’çš„ä»£ç ï¼Œå®ƒå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</p><p>2ï¼‰ã€Lambda å®Œæ•´çš„è¡¨è¾¾å¼çš„è¯­æ³•ç»“æ„ï¼š{ å‚æ•°å1ï¼šå‚æ•°ç±»å‹ï¼Œå‚æ•°å2ï¼šå‚æ•°ç±»å‹ -&gt; å‡½æ•°ä½“ }</p><p>3ï¼‰ã€å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç®€åŒ–å½¢å¼çš„è¯­æ³•ç»“æ„ï¼Œç›´æ¥å°±æ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼š{å‡½æ•°ä½“}ï¼Œè¿™ç§æƒ…å†µæ˜¯å½“ Lambda è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‚æ•°ç»™çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°</p><p>4ï¼‰ã€Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢</p><p>5ï¼‰ã€Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥</p><h3 id="1ã€é›†åˆçš„åˆ›å»ºå’Œéå†"><a href="#1ã€é›†åˆçš„åˆ›å»ºå’Œéå†" class="headerlink" title="1ã€é›†åˆçš„åˆ›å»ºå’Œéå†"></a>1ã€é›†åˆçš„åˆ›å»ºå’Œéå†</h3><p>1ï¼‰ã€ä¸å¯å˜é›†åˆï¼šåœ¨é›†åˆåˆå§‹åŒ–ä¹‹åï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹å…¶è¿›è¡Œå¢åˆ æ”¹æ“ä½œ</p><p>2ï¼‰ã€å¯å˜é›†åˆï¼šåœ¨é›†åˆåˆå§‹åŒ–ä¹‹åï¼Œæˆ‘ä»¬è¿˜èƒ½å¯¹å…¶è¿›è¡Œå¢åˆ æ”¹æ“ä½œ</p><table><thead><tr><th>ä¸å¯å˜é›†åˆ</th><th>å¯å˜é›†åˆ</th></tr></thead><tbody><tr><td>listOf</td><td>mutableListOf</td></tr><tr><td>setOf</td><td>mutableSetOf</td></tr><tr><td>mapOf</td><td>mutableMapOf</td></tr></tbody></table><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//List é›†åˆ </span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ List é›†åˆ</span><br><span class="hljs-keyword">val</span> list1 = listOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>)<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯å˜ List é›†åˆ</span><br><span class="hljs-keyword">val</span> list2 = mutableListOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>)<br><span class="hljs-comment">//æ·»åŠ å…ƒç´ </span><br>list2.add(<span class="hljs-string">&quot;Watermelon&quot;</span>)<br><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> list2) &#123;<br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Apple Banana Orange Pear Grape Watermelon<br><br><span class="hljs-comment">//Set é›†åˆå’Œ List é›†åˆç”¨æ³•å®Œå…¨ä¸€æ ·</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Set é›†åˆ</span><br><span class="hljs-keyword">val</span> set1 = setOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>)<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯å˜ Set é›†åˆ</span><br><span class="hljs-keyword">val</span> set2 = mutableSetOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>)<br><span class="hljs-comment">//æ·»åŠ å…ƒç´ </span><br>set2.add(<span class="hljs-string">&quot;Watermelon&quot;</span>)<br><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> set2) &#123;<br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$i</span> &quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Apple Banana Orange Pear Grape Watermelon<br><br><span class="hljs-comment">//Map é›†åˆ</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Map é›†åˆ</span><br><span class="hljs-keyword">val</span> map1 = mapOf(<span class="hljs-string">&quot;Apple&quot;</span> to <span class="hljs-number">1</span>,<span class="hljs-string">&quot;Banana&quot;</span> to <span class="hljs-number">2</span>,<span class="hljs-string">&quot;Orange&quot;</span> to <span class="hljs-number">3</span>, <span class="hljs-string">&quot;Pear&quot;</span> to <span class="hljs-number">4</span>,<span class="hljs-string">&quot;Grape&quot;</span> to <span class="hljs-number">5</span>)<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯å˜ Map é›†åˆ</span><br><span class="hljs-keyword">val</span> map2 = mutableMapOf(<span class="hljs-string">&quot;Apple&quot;</span> to <span class="hljs-number">1</span>,<span class="hljs-string">&quot;Banana&quot;</span> to <span class="hljs-number">2</span>,<span class="hljs-string">&quot;Orange&quot;</span> to <span class="hljs-number">3</span>, <span class="hljs-string">&quot;Pear&quot;</span> to <span class="hljs-number">4</span>,<span class="hljs-string">&quot;Grape&quot;</span> to <span class="hljs-number">5</span>)<br><span class="hljs-comment">//å½“å‰ key å­˜åœ¨åˆ™ä¿®æ”¹å…ƒç´ ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ å…ƒç´ </span><br>map2[<span class="hljs-string">&quot;Watermelon&quot;</span>] = <span class="hljs-number">6</span><br><span class="hljs-keyword">for</span> ((key,value) <span class="hljs-keyword">in</span> map2) &#123;<br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$key</span>: <span class="hljs-variable">$value</span> &quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Apple: <span class="hljs-number">1</span> Banana: <span class="hljs-number">2</span> Orange: <span class="hljs-number">3</span> Pear: <span class="hljs-number">4</span> Grape: <span class="hljs-number">5</span> Watermelon: <span class="hljs-number">6</span> <br></code></pre></td></tr></table></figure><h3 id="2ã€é›†åˆçš„å‡½æ•°å¼-API"><a href="#2ã€é›†åˆçš„å‡½æ•°å¼-API" class="headerlink" title="2ã€é›†åˆçš„å‡½æ•°å¼ API"></a>2ã€é›†åˆçš„å‡½æ•°å¼ API</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ List é›†åˆ</span><br><span class="hljs-keyword">val</span> list1 = listOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>,<span class="hljs-string">&quot;Watermelon&quot;</span>)<br><span class="hljs-comment">//ç°åœ¨æˆ‘æƒ³æ‰“å°é›†åˆä¸­è‹±æ–‡åå­—æœ€é•¿çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåš</span><br><span class="hljs-comment">//æ–¹å¼1</span><br><span class="hljs-keyword">var</span> maxLengthFruit = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list1) &#123;<br>    <span class="hljs-keyword">if</span>(fruit.length &gt; maxLengthFruit.length)&#123;<br>        maxLengthFruit = fruit<br>    &#125;<br>&#125;<br>print(maxLengthFruit)<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Watermelon<br><br><span class="hljs-comment">//ä½†æ˜¯å¦‚æœä½¿ç”¨å‡½æ•°å¼ Api å°†ä¼šå˜å¾—æ›´åŠ ç®€å•, maxBy å‡½æ•°ä¼šæ ¹æ®ä½ çš„æ¡ä»¶éå†å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„æœ€å¤§å€¼</span><br><span class="hljs-comment">//æ–¹å¼2</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy &#123;<br>    it.length<br>&#125;<br>print(maxLengthFruit)<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Watermelon<br><br><span class="hljs-comment">//é€šè¿‡ maxBy å‡½æ•°ç»“åˆ Lambda è¡¨è¾¾å¼è¯­æ³•ç»“æ„ï¼Œæˆ‘ä»¬æ¥å‰–ææ–¹å¼2è¿™ç§å†™æ³•çš„åŸç†, å¦‚ä¸‹æ‰€ç¤º</span><br><span class="hljs-comment">//1</span><br><span class="hljs-keyword">val</span> list1 = listOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>,<span class="hljs-string">&quot;Watermelon&quot;</span>)<br><span class="hljs-keyword">val</span> lambda = &#123;fruit: String -&gt; fruit.length&#125;<br><span class="hljs-comment">//maxBy å‡½æ•°å®é™…ä¸Šæ¥æ”¶çš„æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œåç»­è®²é«˜é˜¶å‡½æ•°çš„æ—¶å€™ä¼šè®²åˆ°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª Lambda è¡¨è¾¾å¼</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy(lambda)<br><br><span class="hljs-comment">//2 æ›¿æ¢ lambda</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy(&#123;fruit: String -&gt; fruit.length&#125;)<br><br><span class="hljs-comment">//3 Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy()&#123;fruit: String -&gt; fruit.length&#125;<br><br><span class="hljs-comment">//4 Kotlin ä¸­è§„å®šï¼Œå½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy&#123;fruit: String -&gt; fruit.length&#125;<br><br><span class="hljs-comment">//5 å½“ Lambda è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‚æ•°ç»™çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°</span><br><span class="hljs-keyword">val</span> maxLengthFruit = list1.maxBy&#123; it.length &#125;<br><br><span class="hljs-comment">//ç»è¿‡ä¸Šé¢ 1-&gt;2-&gt;3-&gt;4-&gt;5 è¿™å‡ ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº† 5 çš„è¿™ç§å†™æ³•</span><br></code></pre></td></tr></table></figure><p>é›†åˆä¸­è¿˜æœ‰å¾ˆå¤šè¿™æ ·çš„å‡½æ•°å¼ Apiï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ list é›†åˆæ¥å®è·µä¸€ä¸‹å…¶ä»–çš„ä¸€äº›å‡½æ•°å¼ Apiï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> list = listOf(<span class="hljs-string">&quot;Apple&quot;</span>,<span class="hljs-string">&quot;Banana&quot;</span>,<span class="hljs-string">&quot;Orange&quot;</span>,<span class="hljs-string">&quot;Pear&quot;</span>,<span class="hljs-string">&quot;Grape&quot;</span>,<span class="hljs-string">&quot;Watermelon&quot;</span>)<br><span class="hljs-comment">//1</span><br><span class="hljs-comment">//é€šè¿‡ map æ“ä½œï¼ŒæŠŠä¸€ä¸ªå…ƒç´ æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ </span><br><span class="hljs-keyword">val</span> newList = list.map&#123;<br>  it.toUpperCase()<br>&#125;<br><span class="hljs-keyword">for</span> (s <span class="hljs-keyword">in</span> newList) &#123;<br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$s</span> &quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>APPLE BANANA ORANGE PEAR GRAPE WATERMELON <br><br><span class="hljs-comment">//2</span><br><span class="hljs-comment">//é€šè¿‡ filter ç­›é€‰æ“ä½œï¼Œç­›é€‰é•¿åº¦å°äºç­‰äº5çš„å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">val</span> newList = list.filter &#123;<br>    it.length &lt;= <span class="hljs-number">5</span><br>&#125;<br><span class="hljs-keyword">for</span> (s <span class="hljs-keyword">in</span> newList) &#123;<br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$s</span> &quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Apple Pear Grape<br></code></pre></td></tr></table></figure><h3 id="3ã€Java-å‡½æ•°å¼-API-çš„ä½¿ç”¨"><a href="#3ã€Java-å‡½æ•°å¼-API-çš„ä½¿ç”¨" class="headerlink" title="3ã€Java å‡½æ•°å¼ API çš„ä½¿ç”¨"></a>3ã€Java å‡½æ•°å¼ API çš„ä½¿ç”¨</h3><p>1ï¼‰ã€Kotlin ä¸­è°ƒç”¨ Java æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°å¼ Api ,ä½†å¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š1ã€å¾—æ˜¯ç”¨ Java ç¼–å†™çš„æ¥å£ 2ã€æ¥å£ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•</p><p>2)ã€Kotlin ä¸­å†™åŒ¿åå†…éƒ¨ç±»å’Œ Java æœ‰ä¸€ç‚¹åŒºåˆ«ï¼ŒKotlin ä¸­å› ä¸ºæŠ›å¼ƒäº† new å…³é”®å­—ï¼Œæ”¹ç”¨ object å…³é”®å­—å°±å¯ä»¥äº†</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//java ä¸­çš„åŒ¿åå†…éƒ¨ç±»</span><br>new Thread(new Runnable() &#123;<br>     <span class="hljs-meta">@Override</span><br>     <span class="hljs-keyword">public</span> void run() &#123;<br><br>     &#125;<br>&#125;).start();<br><br><span class="hljs-comment">//Kotlin ä¸­å¯ä»¥è¿™ä¹ˆå†™</span><br>Thread(<span class="hljs-keyword">object</span> : Runnable&#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> &#123;<br>            <br>    &#125;<br>&#125;).start()<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æˆ‘ä»¬æ¥ç€æ¥ç®€åŒ– Kotlin ä¸­çš„å†™æ³•</span><br><span class="hljs-comment"> * å› ä¸º Runnable ç±»ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°æ–¹æ³•ï¼Œå³ä½¿è¿™é‡Œæ²¡æœ‰æ˜¾ç¤ºçš„é‡å†™ run() æ–¹æ³•ï¼Œ</span><br><span class="hljs-comment"> * Kotlin ä¹Ÿèƒ½æ˜ç™½åé¢çš„ Lambda è¡¨è¾¾å¼å°±æ˜¯è¦åœ¨ run() æ–¹æ³•ä¸­å®ç°çš„å†…å®¹</span><br><span class="hljs-comment"> */</span><br>Thread(Runnable&#123;<br>  <br>&#125;).start()<br><br><span class="hljs-comment">//å› ä¸ºæ˜¯å•æŠ½è±¡æ–¹æ³•æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¥å£åè¿›è¡Œçœç•¥</span><br>Thread(&#123;<br>  <br>&#125;).start()<br><br><span class="hljs-comment">//å½“ Lambda è¡¨è¾¾å¼ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Lambda è¡¨è¾¾å¼ç§»åˆ°å‡½æ•°æ‹¬å·çš„å¤–é¢</span><br>Thread()&#123;<br>  <br>&#125;.start()<br><br><span class="hljs-comment">//å½“ Lambda è¡¨è¾¾å¼æ˜¯å‡½æ•°çš„å”¯ä¸€å‚æ•°çš„æ—¶å€™ï¼Œå‡½æ•°çš„æ‹¬å·å¯ä»¥çœç•¥</span><br>Thread&#123;<br>  <br>&#125;.start()<br></code></pre></td></tr></table></figure><h2 id="å››ã€ç©ºæŒ‡é’ˆæ£€æŸ¥"><a href="#å››ã€ç©ºæŒ‡é’ˆæ£€æŸ¥" class="headerlink" title="å››ã€ç©ºæŒ‡é’ˆæ£€æŸ¥"></a>å››ã€ç©ºæŒ‡é’ˆæ£€æŸ¥</h2><p>Android ç³»ç»Ÿä¸Šå¥”æºƒæœ€é«˜çš„å¼‚å¸¸å°±æ˜¯ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆNullPointerExceptionï¼‰ï¼Œé€ æˆè¿™ç§ç°è±¡çš„ä¸»è¦åŸå› æ˜¯å› ä¸ºç©ºæŒ‡é’ˆæ˜¯ä¸€ç§ä¸å—ç¼–ç¨‹è¯­è¨€æ£€æŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸ï¼Œåªèƒ½ç”±ç¨‹åºå‘˜ä¸»åŠ¨é€šè¿‡é€»è¾‘åˆ¤æ–­æ¥é¿å…ï¼Œä½†å³ä½¿åœ¨å‡ºè‰²çš„ç¨‹åºå‘˜ï¼Œä¹Ÿä¸å¯èƒ½å°†æ‰€æœ‰æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸éƒ½è€ƒè™‘åˆ°ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µåœ¨ Kotlin ä¸Šå¾—åˆ°äº†å¾ˆå¥½çš„è§£å†³ï¼ŒKotlin æŠŠç©ºæŒ‡é’ˆå¼‚å¸¸æå‰åˆ°äº†ç¼–è¯‘æœŸå»æ£€æŸ¥ï¼Œè¿™æ ·çš„åšæ³•å‡ ä¹æœç»äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œä½†æ˜¯è¿™æ ·å­ä¼šå¯¼è‡´ä»£ç å˜å¾—æ¯”è¾ƒéš¾å†™ï¼Œä¸è¿‡ Kotlin æä¾›äº†ä¸€ç³»åˆ—çš„è¾…åŠ©å·¥å…·ï¼Œè®©æˆ‘ä»¬èƒ½è½»æ¾çš„å¤„ç†å„ç§åˆ¤ç©ºçš„æƒ…å†µï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å­¦ä¹ å®ƒ</p><h3 id="1ã€å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·"><a href="#1ã€å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·" class="headerlink" title="1ã€å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·"></a>1ã€å¯ç©ºç±»å‹ç³»ç»Ÿå’Œåˆ¤ç©ºè¾…åŠ©å·¥å…·</h3><p>1ï¼‰ã€åœ¨ç±»å‹åé¢åŠ ä¸Š ? ï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹ï¼ŒKotlin é»˜è®¤æ‰€æœ‰çš„å‚æ•°å’Œå˜é‡ä¸å¯ä¸ºç©º</p><p>2ï¼‰ã€åœ¨å¯¹è±¡è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸ºç©ºåˆ™è°ƒç”¨ï¼Œä¸ºç©ºåˆ™ä»€ä¹ˆéƒ½ä¸åš</p><p>3ï¼‰ã€?: æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå·¦è¾¹çš„ç»“æœä¸ä¸ºç©ºï¼Œè¿”å›å·¦è¾¹çš„ç»“æœï¼Œå¦åˆ™è¿”å›å³è¾¹çš„ç»“æœ</p><p>4ï¼‰ã€åœ¨å¯¹è±¡åé¢åŠ  !! æ“ä½œç¬¦è¡¨ç¤ºå‘Šè¯‰Kotlinæˆ‘è¿™é‡Œä¸€å®šä¸ä¼šä¸ºç©º,ä½ ä¸ç”¨è¿›è¡Œæ£€æµ‹äº†ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸</p><p>5ï¼‰ã€let å‡½æ•°ï¼Œæä¾›å‡½æ•°å¼ Apiï¼Œå¹¶æŠŠå½“å‰è°ƒç”¨çš„å¯¹è±¡å½“ä½œå‚æ•°ä¼ é€’åˆ° Lambda è¡¨è¾¾å¼ä¸­</p><p><strong>æƒ…å†µ1ï¼š</strong> åœ¨ç±»å‹åé¢åŠ ä¸Š ? ï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹ï¼ŒKotlin é»˜è®¤æ‰€æœ‰çš„å‚æ•°å’Œå˜é‡ä¸å¯ä¸ºç©º</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Study</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readBooks</span><span class="hljs-params">()</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">domeHomework</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;do homework default implementation&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>)</span></span>&#123;<br>    study.readBooks()<br>    study.domeHomework()<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç æ˜¯ä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸çš„ï¼Œå¦‚æœä½ å°è¯•å‘ doStudy è¿™ä¸ªæ–¹æ³•ä¼ é€’ä¸€ä¸ª null ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d3e0d4640674c8cbfb70c4cb81b0ef0~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210317101826003"></p><p>å› æ­¤è¿™ç§æƒ…å†µæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¯ç©ºç±»å‹ï¼ŒæŠŠ Study æ”¹æˆ Studyï¼Ÿï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0aeed15a301b4de1b3c6b3f5c43eed42~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210317104058401"></p><p>ä½ ä¼šå‘ç°è™½ç„¶è°ƒç”¨ doStudy æ–¹æ³•ä¸æŠ¥é”™äº†ï¼Œä½†æ˜¯ doStudy å†…éƒ¨çš„è°ƒç”¨å´æŠ¥é”™äº†ï¼Œå› ä¸ºæ­¤æ—¶ doStudy æ¥å—ä¸€ä¸ªå¯ç©ºçš„ç±»å‹å‚æ•°ï¼Œå¯èƒ½ä¼šé€ æˆå†…éƒ¨çš„ç©ºæŒ‡é’ˆï¼Œ Kotlin ç¼–è¯‘å™¨ä¸å…è®¸è¿™ç§æƒ…å†µå­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹æ”¹é€ å°±å¥½äº†ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>?)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(study != <span class="hljs-literal">null</span>)&#123;<br>        study.readBooks()<br>        study.domeHomework()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æƒ…å†µ2ï¼š</strong> åœ¨å¯¹è±¡è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸ºç©ºåˆ™è°ƒç”¨ï¼Œä¸ºç©ºåˆ™ä»€ä¹ˆéƒ½ä¸åš</p><p>é’ˆå¯¹ä¸Šé¢çš„ doStudy æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™ä¹ˆåšï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>?)</span></span>&#123;<br>    study?.readBooks()<br>    study?.domeHomework()<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æƒ…å†µ3ï¼š</strong> ?: æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå·¦è¾¹çš„ç»“æœä¸ä¸ºç©ºï¼Œè¿”å›å·¦è¾¹çš„ç»“æœï¼Œå¦åˆ™è¿”å›å³è¾¹çš„ç»“æœ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å¹³æ—¶æˆ‘ä»¬å¯èƒ½å†™è¿™æ ·çš„ä»£ç </span><br><span class="hljs-keyword">val</span> a = <span class="hljs-keyword">if</span> (b != <span class="hljs-literal">null</span>) &#123;<br>    b<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    c<br>&#125;<br><br><span class="hljs-comment">//ä½¿ç”¨ ?: æ“ä½œç¬¦å¯ä»¥ç®€åŒ–æˆè¿™æ ·</span><br><span class="hljs-keyword">val</span> a = b ?: c<br></code></pre></td></tr></table></figure><p><strong>æƒ…å†µ4ï¼š</strong> åœ¨å¯¹è±¡åé¢åŠ  !! æ“ä½œç¬¦è¡¨ç¤ºå‘Šè¯‰Kotlinæˆ‘è¿™é‡Œä¸€å®šä¸ä¼šä¸ºç©º,ä½ ä¸ç”¨è¿›è¡Œæ£€æµ‹äº†ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//ä¸‹é¢è¿™æ®µä»£ç ç¼–è¯‘é€šä¸è¿‡ï¼Œå› ä¸º printName æ–¹æ³•é‡Œçš„ name å¹¶ä¸çŸ¥é“ä½ åœ¨å¤–é¢åšäº†éç©ºåˆ¤æ–­</span><br><span class="hljs-keyword">val</span> name: String? = <span class="hljs-string">&quot;erdai&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printName</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> upperCaseName = name.toUpperCase()<br>    print(upperCaseName)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">if</span>(name != <span class="hljs-literal">null</span>)&#123;<br>       printName()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å› æ­¤åœ¨ä¸Šé¢è¿™ç§æ˜ç¡®ä¸ä¼šä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ !! æ“ä½œç¬¦ï¼Œæ”¹é€ ä¸€ä¸‹ printName æ–¹æ³•</span><br><span class="hljs-comment">//åŒæ—¶è¦æé†’ä¸€ä¸‹è‡ªå·±ï¼Œæ˜¯å¦å­˜åœ¨æ›´å¥½çš„å®ç°æ–¹å¼ï¼Œå› ä¸ºä½¿ç”¨è¿™ç§æ“ä½œç¬¦ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printName</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">val</span> upperCaseName = name!!.toUpperCase()<br>    print(upperCaseName)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ERDAI<br></code></pre></td></tr></table></figure><p><strong>æƒ…å†µ5ï¼š</strong> let å‡½æ•°ï¼Œæä¾›å‡½æ•°å¼ Apiï¼Œå¹¶æŠŠå½“å‰è°ƒç”¨çš„å¯¹è±¡å½“ä½œå‚æ•°ä¼ é€’åˆ° Lambda è¡¨è¾¾å¼ä¸­</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//è¿™æ˜¯æˆ‘ä»¬æƒ…å†µ2 å®ç°çš„æ–¹å¼ï¼Œä½†æ˜¯å¦‚æœè¿™ç§è°ƒç”¨æ–¹å¼ä¸€å¤šï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«å•°å—¦ï¼Œä¾‹å¦‚ï¼š</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>?)</span></span>&#123;<br>    study?.readBooks()<br>    study?.domeHomework()<br>    study?.a()<br>    study?.b()<br>&#125;<br><span class="hljs-comment">//ä¸Šé¢è¿™ç§æƒ…å†µç­‰åŒäºå¦‚ä¸‹ä»£ç :</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>?)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(study != <span class="hljs-literal">null</span>)&#123;<br>      study?.readBooks()<br>    &#125;<br>  <br>    <span class="hljs-keyword">if</span>(study != <span class="hljs-literal">null</span>)&#123;<br>     study?.domeHomework()<br>    &#125;<br>  <br>    <span class="hljs-keyword">if</span>(study != <span class="hljs-literal">null</span>)&#123;<br>     study?.a()<br>    &#125;<br>  <br>    <span class="hljs-keyword">if</span>(study != <span class="hljs-literal">null</span>)&#123;<br>      study?.b()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ let å‡½æ•°æ¥æ“ä½œäº†</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study: <span class="hljs-type">Study</span>?)</span></span>&#123;<br>    study?.let&#123;<br>      it.readBooks()<br>      it.domeHomework()<br>      it.a()<br>      it.b()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€Kotlinä¸­çš„å°é­”æœ¯"><a href="#äº”ã€Kotlinä¸­çš„å°é­”æœ¯" class="headerlink" title="äº”ã€Kotlinä¸­çš„å°é­”æœ¯"></a>äº”ã€Kotlinä¸­çš„å°é­”æœ¯</h2><h3 id="1ã€å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼"><a href="#1ã€å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼" class="headerlink" title="1ã€å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼"></a>1ã€å­—ç¬¦ä¸²çš„å†…åµŒè¡¨è¾¾å¼</h3><p>1ï¼‰ã€Kotlin ä¸­ï¼Œå­—ç¬¦ä¸²é‡Œé¢å¯ä»¥ä½¿ç”¨ ${} å¼•ç”¨å˜é‡å€¼å’Œè¡¨è¾¾å¼ï¼Œå½“ {} é‡Œé¢åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œéè¡¨è¾¾å¼æ—¶ï¼Œ{}ä¹Ÿå¯ä»¥å»æ‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> a = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> b = <span class="hljs-string">&quot;666&quot;</span><br>    print(<span class="hljs-string">&quot;<span class="hljs-variable">$a</span> <span class="hljs-subst">$&#123;a + b&#125;</span>&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai erdai666<br></code></pre></td></tr></table></figure><h3 id="2ã€å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼"><a href="#2ã€å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼" class="headerlink" title="2ã€å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼"></a>2ã€å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼</h3><p>1ï¼‰ã€å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡½æ•°çš„å‚æ•°æ·»åŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±ä¸éœ€è¦å»ä¼ é‚£ä¸ªå‚æ•°</p><p>2ï¼‰ã€åœ¨æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ key value çš„å½¢å¼æ¥ä¼ å‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æƒ…å†µ1ï¼šå®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡½æ•°çš„å‚æ•°æ·»åŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±ä¸éœ€è¦å»ä¼ é‚£ä¸ªå‚æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printParams</span><span class="hljs-params">(name: <span class="hljs-type">String</span>,age: <span class="hljs-type">Int</span> = <span class="hljs-number">20</span>)</span></span>&#123;<br>    print(<span class="hljs-string">&quot;I am <span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span> years old.&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    printParams(<span class="hljs-string">&quot;erdai&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>I am erdai, <span class="hljs-number">20</span> years old.<br><br><span class="hljs-comment">//å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©è¦†ç›–é»˜è®¤å‚æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    printParams(<span class="hljs-string">&quot;erdai&quot;</span>,<span class="hljs-number">25</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>I am erdai, <span class="hljs-number">25</span> years old.<br><br><span class="hljs-comment">//æƒ…å†µ2ï¼šåœ¨æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ key value çš„å½¢å¼æ¥ä¼ å‚</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//æ³¨æ„ printParams æ–¹æ³•çš„ä¸€ä¸ªå‚æ•°æ˜¯ name ,ç¬¬äºŒä¸ªæ‰æ˜¯ age, ä½†æ˜¯é€šè¿‡ key value çš„å½¢å¼æ¥ä¼ å‚å°±ä¸ä¼šå‡ºç°å‚æ•°é¡ºåºé—®é¢˜</span><br>    printParams(age = <span class="hljs-number">19</span>,name = <span class="hljs-string">&quot;erdai666&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>I am erdai666, <span class="hljs-number">19</span> years old.<br></code></pre></td></tr></table></figure><p><strong>å°æŠ€å·§ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼æ¥ä»£æ›¿æ¬¡æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ä¸»æ„é€ å‡½æ•°å°±å¥½äº†</strong></p><h2 id="å…­ã€æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•"><a href="#å…­ã€æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•" class="headerlink" title="å…­ã€æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•"></a>å…­ã€æ ‡å‡†å‡½æ•°å’Œé™æ€æ–¹æ³•</h2><h3 id="1ã€æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun-å’Œ-apply"><a href="#1ã€æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun-å’Œ-apply" class="headerlink" title="1ã€æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun å’Œ apply"></a>1ã€æ ‡å‡†å‡½æ•°letï¼Œalsoï¼Œwithï¼Œrun å’Œ apply</h3><p>1ï¼‰ã€let å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸ºå½“å‰è°ƒç”¨è€…ï¼Œä¸”æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</p><p>2ï¼‰ã€also å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸ºå½“å‰è°ƒç”¨è€…ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯å½“å‰è°ƒç”¨å¯¹è±¡æœ¬èº«</p><p>3ï¼‰ã€with å‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºä»»æ„ç±»å‹å‚æ•°ï¼Œç¬¬äºŒä¸ªä¸º Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ç¬¬ä¸€ä¸ªå‚æ•°çš„ä¸Šä¸‹æ–‡ this ï¼Œä¸”æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</p><p>4ï¼‰ã€run å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰å½“å‰è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this ï¼Œä¸”æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼</p><p>5ï¼‰ã€apply å‡½æ•°ï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ª Lambda è¡¨è¾¾å¼å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰å½“å‰è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯å½“å‰è°ƒç”¨å¯¹è±¡æœ¬èº«</p><p><strong>æ³¨æ„ï¼šåœ¨Lambda è¡¨è¾¾å¼ä¸­ï¼Œæ‹¥æœ‰å¯¹è±¡çš„ä¸Šä¸‹æ–‡ thisï¼Œå’Œæ‹¥æœ‰è¯¥å¯¹è±¡æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ this å¯çœç•¥ï¼Œè€Œæ‹¥æœ‰è¯¥å¯¹è±¡æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å‚æ•°åï¼Œå¦‚æœä¸å†™è¯¥å‚æ•°ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it å‚æ•°</strong></p><p>ä¸‹é¢é€šè¿‡ä»£ç æ¥æ„Ÿå—ä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒ…å†µ1ï¼šlet å‡½æ•°</span><br><span class="hljs-comment"> * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ let å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸º StringBuilder å¯¹è±¡</span><br><span class="hljs-comment"> * 2ã€å½“ Lambda è¡¨è¾¾å¼ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it çš„å‚æ•°ï¼Œè¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­æœ€åä¸€è¡Œä»£ç </span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> age = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> returnValue = StringBuilder().let &#123;<br>        it.append(name).append(<span class="hljs-string">&quot; &quot;</span>).append(age)<br>    &#125;<br>    println(returnValue)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">20</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒ…å†µ2ï¼šalso å‡½æ•°</span><br><span class="hljs-comment"> * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ also å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ä¸º StringBuilder å¯¹è±¡</span><br><span class="hljs-comment"> * 2ã€å½“ Lambda è¡¨è¾¾å¼ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯çœç•¥ï¼Œé»˜è®¤ä¼šæœ‰ä¸ª it çš„å‚æ•°ï¼Œæ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿”å›è°ƒç”¨å¯¹è±¡æœ¬èº«</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> age = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> stringBuilder = StringBuilder().also &#123;<br>        it.append(name).append(<span class="hljs-string">&quot; &quot;</span>).append(age)<br>    &#125;<br>    println(stringBuilder.toString())<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">20</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒ…å†µ3ï¼šwith å‡½æ•°</span><br><span class="hljs-comment"> * 1ã€æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º StringBuilder å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º Lambda è¡¨è¾¾å¼ï¼Œ</span><br><span class="hljs-comment"> * 2ã€Lambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this, è¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç </span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> age = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> returnValue = with(StringBuilder()) &#123;<br>        append(name).append(<span class="hljs-string">&quot; &quot;</span>).append(age)<br>    &#125;<br>    println(returnValue)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">20</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒ…å†µ4ï¼šrun å‡½æ•°</span><br><span class="hljs-comment"> * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ also å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this</span><br><span class="hljs-comment"> * 2ã€è¿”å›å€¼å³ä¸º Lambda è¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç </span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> age = <span class="hljs-number">20</span><br><br>    <span class="hljs-keyword">val</span> returnValue = StringBuilder().run &#123;<br>        append(name).append(<span class="hljs-string">&quot; &quot;</span>).append(age)<br>    &#125;<br>    println(returnValue)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">20</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒ…å†µ5ï¼šapply å‡½æ•°</span><br><span class="hljs-comment"> * 1ã€åˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡è°ƒç”¨ apply å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¸­æ‹¥æœ‰ StringBuilder å¯¹è±¡çš„ä¸Šä¸‹æ–‡ this</span><br><span class="hljs-comment"> * 2ã€æ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè¿”å›è°ƒç”¨å¯¹è±¡æœ¬èº«</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    <span class="hljs-keyword">val</span> age = <span class="hljs-number">20</span><br><br>    <span class="hljs-keyword">val</span> stringBuilder = StringBuilder().apply &#123;<br>        append(name).append(<span class="hljs-string">&quot; &quot;</span>).append(age)<br>    &#125;<br>    println(stringBuilder.toString())<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>å…¶å®ä¸Šé¢ 5 ä¸ªæ ‡å‡†å‡½æ•°æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œæˆ‘ä»¬éœ€ææ¸…æ¥šå®ƒä»¬å·®å¼‚ä¹‹å¤„ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå›¾è¡¨æ¥æ€»ç»“ä¸€ä¸‹ï¼š</p><table><thead><tr><th align="left">æ ‡å‡†å‡½æ•°</th><th>å‡½æ•°å‚æ•°</th><th>æ˜¯å¦æ˜¯æ‰©å±•å‡½æ•°</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td align="left">T.let</td><td>it</td><td>æ˜¯</td><td>æœ€åä¸€è¡Œä»£ç </td></tr><tr><td align="left">T.also</td><td>it</td><td>æ˜¯</td><td>å¯¹è±¡æœ¬èº«</td></tr><tr><td align="left">with</td><td>this</td><td>å¦</td><td>æœ€åä¸€è¡Œä»£ç </td></tr><tr><td align="left">T.run</td><td>this</td><td>æ˜¯</td><td>æœ€åä¸€è¡Œä»£ç </td></tr><tr><td align="left">T.apply</td><td>this</td><td>æ˜¯</td><td>å¯¹è±¡æœ¬èº«</td></tr></tbody></table><h3 id="2ã€å®šä¹‰é™æ€æ–¹æ³•"><a href="#2ã€å®šä¹‰é™æ€æ–¹æ³•" class="headerlink" title="2ã€å®šä¹‰é™æ€æ–¹æ³•"></a>2ã€å®šä¹‰é™æ€æ–¹æ³•</h3><p>Kotlin ä¸­æ²¡æœ‰ç›´æ¥æä¾›å®šä¹‰ä¸ºé™æ€æ–¹æ³•çš„å…³é”®å­—ï¼Œä½†æ˜¯æä¾›äº†ä¸€äº›ç±»ä¼¼çš„è¯­æ³•ç‰¹æ€§æ¥æ”¯æŒé™æ€æ–¹æ³•è°ƒç”¨çš„å†™æ³•</p><p>1ï¼‰ã€ä½¿ç”¨ companion object ä¸ºä¸€ä¸ªç±»åˆ›å»ºä¸€ä¸ªä¼´ç”Ÿç±»ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªä¼´ç”Ÿç±»çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸å«é™æ€æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥å½“ä½œé™æ€æ–¹æ³•è°ƒç”¨</p><p>2ï¼‰ã€ä½¿ç”¨ object å…³é”®å­—å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»ï¼Œé€šè¿‡å•ä¾‹ç±»ï¼Œå»è°ƒç”¨æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿä¸å«é™æ€æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥å½“ä½œé™æ€æ–¹æ³•è°ƒç”¨</p><p>3ï¼‰ã€å¦‚æœæƒ³å®šä¹‰çœŸæ­£çš„é™æ€æ–¹æ³•ï¼ŒKotlin ä¸­ä¹Ÿæä¾›äº†ä¸¤ç§æ–¹å¼ï¼š1ã€ä½¿ç”¨ @JvmStatic æ³¨è§£ï¼Œä¸”æ³¨è§£åªèƒ½åŠ åœ¨ä¼´ç”Ÿç±»å’Œå•ä¾‹ç±»ä¸Šçš„æ–¹æ³•ä¸Šé¢  2ã€å®šä¹‰é¡¶å±‚æ–¹æ³•</p><p>4ï¼‰ã€é¡¶å±‚æ–¹æ³•å°±æ˜¯ä¸å®šä¹‰åœ¨ä»»ä½•ç±»ä¸­çš„æ–¹æ³•ï¼Œé¡¶å±‚æ–¹æ³•åœ¨ä»»ä½•ä½ç½®éƒ½èƒ½è¢«è°ƒç”¨åˆ°ï¼ŒKotlin ç¼–è¯‘å™¨ä¼šæŠŠæ‰€æœ‰çš„é¡¶å±‚æ–¹æ³•ç¼–è¯‘æˆé™æ€æ–¹æ³•</p><p>5ï¼‰ã€å¦‚æœåœ¨ Java ä¸­è°ƒç”¨é¡¶å±‚æ–¹æ³•ï¼ŒJava é»˜è®¤æ˜¯æ²¡æœ‰é¡¶å±‚æ–¹æ³•çš„æ¦‚å¿µçš„ï¼ŒKotlin ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªæˆ‘ä»¬å®šä¹‰è¿™ä¸ªæ–‡ä»¶çš„ Java ç±»ï¼Œä¾‹å¦‚æˆ‘åœ¨ Kotlin ä¸­çš„ Util.kt æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªé¡¶å±‚æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆä¸€ä¸ª UtilKt çš„ Java ç±»ä¾›åœ¨ Java ä¸­è°ƒç”¨</p><p>6ï¼‰ã€åœ¨ Kotlin ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ å•ä¾‹ï¼Œä¼´ç”Ÿç±»å’Œé¡¶å±‚æ–¹æ³•ï¼Œ@JvmStatic æ³¨è§£ç”¨çš„æ¯”è¾ƒå°‘</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//åœ¨ Java ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Util</span> &#123;<br>  <br>    <span class="hljs-keyword">public</span> static void doAction()&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;do something&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//Kotlin ä¸­ç±»ä¼¼è¿™æ ·é™æ€è°ƒç”¨å¤šç§å¤šæ ·</span><br><span class="hljs-comment">//æƒ…å†µ1ï¼šä½¿ç”¨ companion object ä¸ºä¸€ä¸ªç±»åˆ›å»ºä¸€ä¸ªä¼´ç”Ÿç±»</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   Util.doAction()<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Util</span>&#123;<br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doAction</span><span class="hljs-params">()</span></span>&#123;<br>            println(<span class="hljs-string">&quot;do something&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-keyword">do</span> something<br><br><span class="hljs-comment">//æƒ…å†µ2ï¼šä½¿ç”¨ object å…³é”®å­—å®šä¹‰ä¸€ä¸ªå•ä¾‹ç±»</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   Util.doAction()<br>&#125;<br><br><span class="hljs-keyword">object</span> Util &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doAction</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;do something&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-keyword">do</span> something<br><br><span class="hljs-comment">//æƒ…å†µ3ï¼š1ã€ä½¿ç”¨ @JvmStatic æ³¨è§£ 2ã€å®šä¹‰é¡¶å±‚æ–¹æ³•</span><br><span class="hljs-comment">//1</span><br><span class="hljs-comment">//å•ä¾‹ç±»</span><br><span class="hljs-keyword">object</span> Util &#123;<br>  <br>    <span class="hljs-meta">@JvmStatic</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doAction</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;do something&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¼´ç”Ÿç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Util</span> &#123;<br>  <br>    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doAction</span><span class="hljs-params">()</span></span> &#123;<br>            println(<span class="hljs-string">&quot;do something&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2 ä½¿ç”¨ AndroidStudio æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å¼¹æ¡†ä¸­é€‰æ‹© File å³å¯ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ª File ä¸­ç¼–å†™ä¸€ä¸ªé¡¶å±‚æ–¹æ³•</span><br><span class="hljs-comment">//é¡¶å±‚æ–¹æ³•åœ¨ä»»ä½•ä½ç½®éƒ½èƒ½è°ƒç”¨åˆ°</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doAction</span><span class="hljs-params">()</span></span>&#123;<br>    println(<span class="hljs-string">&quot;do something&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¤§å®¶å¯ä»¥å°† Kotlin æ–‡ä»¶è½¬æ¢æˆ Java æ–‡ä»¶çœ‹ä¸€ä¸‹ï¼Œä½ å°±ä¼šå‘ç°å®šä¹‰çœŸæ­£çš„é™æ€æ–¹æ³•å’Œéé™æ€æ–¹æ³•çš„åŒºåˆ«</p><h2 id="ä¸ƒã€å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»"><a href="#ä¸ƒã€å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»" class="headerlink" title="ä¸ƒã€å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»"></a>ä¸ƒã€å»¶è¿Ÿåˆå§‹åŒ–å’Œå¯†å°ç±»</h2><h3 id="1ã€å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–"><a href="#1ã€å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–" class="headerlink" title="1ã€å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–"></a>1ã€å¯¹å˜é‡å»¶è¿Ÿåˆå§‹åŒ–</h3><p>1ï¼‰ã€ä½¿ç”¨ lateinit å…³é”®å­—å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–</p><p>ä½¿ç”¨  lateinit å…³é”®å­—æ³¨æ„äº‹é¡¹ï¼š</p><p>1ã€åªèƒ½ä½œç”¨äº var å±æ€§ï¼Œä¸”è¯¥å±æ€§æ²¡æœ‰è‡ªå®šä¹‰ get å’Œ set æ–¹æ³•</p><p>2ã€è¯¥å±æ€§å¿…é¡»æ˜¯éç©ºç±»å‹ï¼Œä¸”ä¸èƒ½æ˜¯åŸç”Ÿç±»å‹</p><p>2ï¼‰ã€å½“ä½ å¯¹ä¸€ä¸ªå˜é‡ä½¿ç”¨äº† lateinit å…³é”®å­—ï¼ŒKotlin ç¼–è¯‘å™¨å°±ä¸ä¼šåœ¨å»æ£€æŸ¥è¿™ä¸ªå˜é‡æ˜¯å¦ä¼šä¸ºç©ºäº†ï¼Œæ­¤æ—¶ä½ è¦ç¡®ä¿å®ƒåœ¨è¢«è°ƒç”¨ä¹‹å‰å·²ç»åˆå§‹åŒ–äº†ï¼Œå¦åˆ™ç¨‹åºè¿è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå¯ä»¥ä½¿ç”¨ ::object.isInitialized è¿™ç§å›ºå®šçš„è¯­æ³•ç»“æ„åˆ¤æ–­å˜é‡æ˜¯å¦å·²ç»åˆå§‹åŒ–</p><p>3ï¼‰ã€ä½¿ç”¨ by lazy å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–</p><p>ä½¿ç”¨ by lazy æ³¨æ„äº‹é¡¹ï¼š</p><p>1ã€åªèƒ½ä½œç”¨äº val å±æ€§</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æƒ…å†µ1ï¼šä½¿ç”¨ lateinit å…³é”®å­—å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–</span><br><span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> name: String<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   name = <span class="hljs-string">&quot;erdai&quot;</span><br>   println(name)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br><br><span class="hljs-comment">//æƒ…å†µ2: ä½¿ç”¨ ::object.isInitialized è¿™ç§å›ºå®šçš„è¯­æ³•ç»“æ„åˆ¤æ–­å˜é‡æ˜¯å¦å·²ç»åˆå§‹åŒ–</span><br><span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> name: String<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">if</span>(::name.isInitialized)&#123;<br>        println(name)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        println(<span class="hljs-string">&quot;name not been initialized&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>name not been initialized<br><br><span class="hljs-comment">//æƒ…å†µ3: ä½¿ç”¨ by lazy å¯¹ä¸€ä¸ªå˜é‡å»¶è¿Ÿåˆå§‹åŒ–</span><br><span class="hljs-comment">//ç‰¹ç‚¹ï¼šè¯¥å±æ€§è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼Œä¸” lazy åé¢çš„ Lambda è¡¨è¾¾å¼åªä¼šæ‰§è¡Œä¸€æ¬¡</span><br><span class="hljs-keyword">val</span> name: String <span class="hljs-keyword">by</span> lazy &#123;<br>    <span class="hljs-string">&quot;erdai&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(name)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br></code></pre></td></tr></table></figure><h3 id="2ã€ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç "><a href="#2ã€ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç " class="headerlink" title="2ã€ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç "></a>2ã€ä½¿ç”¨å¯†å°ç±»ä¼˜åŒ–ä»£ç </h3><p>å¯†å°ç±»èƒ½ä½¿æˆ‘ä»¬å†™å‡ºæ›´åŠ è§„èŒƒå’Œå®‰å…¨çš„ä»£ç </p><p>1ï¼‰ã€ä½¿ç”¨ sealed class å®šä¹‰ä¸€ä¸ªå¯†å°ç±»</p><p>2ï¼‰ã€å¯†å°ç±»åŠå…¶å­ç±»ï¼Œåªèƒ½å®šä¹‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶çš„é¡¶å±‚ä½ç½®</p><p>3ï¼‰ã€å¯†å°ç±»å¯è¢«ç»§æ‰¿</p><p>4ï¼‰ã€å½“æˆ‘ä»¬ä½¿ç”¨æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼Œéœ€è¦å®ç°å¯†å°ç±»æ‰€æœ‰å­ç±»çš„æƒ…å†µï¼Œé¿å…å†™å‡ºæ°¸è¿œä¸ä¼šæ‰§è¡Œçš„ä»£ç </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//åœ¨ä½¿ç”¨å¯†å°ç±»ä¹‹å‰æˆ‘ä»¬å¯èƒ½ä¼šå†™å‡ºè¿™ç§ä»£ç </span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Result</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span> : <span class="hljs-type">Result</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Failure</span> : <span class="hljs-type">Result</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * é‚£ä¹ˆæ­¤æ—¶å¦‚æœæˆ‘æ–°å¢ä¸€ä¸ªç±»å®ç° Result æ¥å£ï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šæç¤ºæˆ‘ä»¬å»æ–°å¢æ–°çš„æ¡ä»¶åˆ†æ”¯</span><br><span class="hljs-comment"> * å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ–°å¢ç›¸åº”çš„æ¡ä»¶åˆ†æ”¯ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ‰§è¡Œ else çš„æƒ…å†µ</span><br><span class="hljs-comment"> * å…¶å®è¿™ä¸ª else å°±æ˜¯ä¸€ä¸ªæ— ç”¨åˆ†æ”¯ï¼Œè¿™ä»…ä»…æ˜¯ä¸ºäº†æ»¡è¶³ç¼–è¯‘å™¨çš„è¦æ±‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getResultMsg</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>)</span></span> = <span class="hljs-keyword">when</span> (result)&#123;<br>    <span class="hljs-keyword">is</span> Success -&gt; <span class="hljs-string">&quot;Success&quot;</span><br>    <span class="hljs-keyword">is</span> Failure -&gt; <span class="hljs-string">&quot;Failure&quot;</span><br>    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">throw</span> RuntimeException()<br>&#125;<br><br><span class="hljs-comment">//åœ¨ä½¿ç”¨å¯†å°ç±»ä¹‹å</span><br><span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span> : <span class="hljs-type">Result</span>()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Failure</span> : <span class="hljs-type">Result</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ­¤æ—¶æˆ‘ä»¬å°±é¿å…äº†å†™ else åˆ†æ”¯ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘æ–°å¢ä¸€ä¸ªç±»å®ç° Result å¯†å°ç±»</span><br><span class="hljs-comment"> * ç¼–è¯‘å™¨å°±ä¼šæç¤ºå¼‚å¸¸ï¼Œéœ€è¦ when å»æ–°å¢ç›¸åº”çš„æ¡ä»¶åˆ†æ”¯</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getResultMsg</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>)</span></span> = <span class="hljs-keyword">when</span> (result)&#123;<br>    <span class="hljs-keyword">is</span> Success -&gt; <span class="hljs-string">&quot;Success&quot;</span><br>    <span class="hljs-keyword">is</span> Failure -&gt; <span class="hljs-string">&quot;Failure&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…«ã€æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦"><a href="#å…«ã€æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦" class="headerlink" title="å…«ã€æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦"></a>å…«ã€æ‰©å±•å‡½æ•°å’Œè¿ç®—ç¬¦</h2><h3 id="1ã€å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°"><a href="#1ã€å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°" class="headerlink" title="1ã€å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°"></a>1ã€å¤§æœ‰ç”¨é€”çš„æ‰©å±•å‡½æ•°</h3><p>æ‰©å±•å‡½æ•°å…è®¸æˆ‘ä»¬å»æ‰©å±•ä¸€ä¸ªç±»çš„å‡½æ•°ï¼Œè¿™ç§ç‰¹æ€§æ˜¯ Java ä¸­æ‰€æ²¡æœ‰çš„</p><p>1ï¼‰ã€æ‰©å±•å‡½æ•°çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> ClassName.<span class="hljs-title">methodName</span><span class="hljs-params">(params1: <span class="hljs-type">Int</span>, params2: <span class="hljs-type">Int</span>)</span></span> : <span class="hljs-built_in">Int</span>&#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>ç›¸æ¯”äºæ™®é€šçš„å‡½æ•°ï¼Œæ‰©å±•å‡½æ•°åªéœ€è¦åœ¨å‡½æ•°å‰é¢åŠ ä¸Šä¸€ä¸ª ClassName. çš„è¯­æ³•ç»“æ„ï¼Œå°±è¡¨ç¤ºæŠŠè¯¥å‡½æ•°æ·»åŠ åˆ°æŒ‡å®šçš„ç±»ä¸­</p><p>2ï¼‰ã€ä¸€èˆ¬æˆ‘ä»¬è¦å®šä¹‰å“ªä¸ªç±»çš„æ‰©å±•å‡½æ•°ï¼Œæˆ‘ä»¬å°±å®šä¹‰ä¸€ä¸ªåŒåçš„ Kotlin æ–‡ä»¶ï¼Œä¾¿äºåç»­æŸ¥æ‰¾ï¼Œè™½ç„¶è¯´ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ä»»ä½•ä¸€ä¸ªç±»ä¸­ï¼Œä½†æ˜¯æ›´æ¨èå°†å®ƒå®šä¹‰æˆé¡¶å±‚æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥è®©æ‰©å±•æ–¹æ³•æ‹¥æœ‰å…¨å±€çš„è®¿é—®åŸŸ</p><p>3ï¼‰ã€æ‰©å±•å‡½æ•°é»˜è®¤æ‹¥æœ‰è¿™ä¸ªç±»çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ</p><p>ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨è¦ç»™ String è¿™ä¸ªç±»æ‰©å±•ä¸€ä¸ª printString æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–°å»ºä¸€ä¸ª String.kt çš„æ–‡ä»¶ï¼Œç„¶ååœ¨è¿™ä¸ªæ–‡ä»¶ä¸‹é¢ç¼–å†™æ‰©å±•å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">printString</span><span class="hljs-params">()</span></span>&#123;<br>    println(<span class="hljs-keyword">this</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    name.printString()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br></code></pre></td></tr></table></figure><h3 id="2ã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½"><a href="#2ã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½" class="headerlink" title="2ã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½"></a>2ã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½</h3><p>Kotlin çš„è¿ç®—ç¬¦é‡è½½å…è®¸æˆ‘ä»¬è®©ä»»æ„ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œç›¸åŠ ï¼Œæˆ–è€…æ˜¯è¿›è¡Œå…¶ä»–æ›´å¤šçš„è¿ç®—æ“ä½œ</p><p>1ï¼‰è¿ç®—ç¬¦é‡è½½ä½¿ç”¨çš„æ˜¯ operator å…³é”®å­—ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡å®šå‡½æ•°å‰é¢åŠ ä¸Š operator å…³é”®å­—ï¼Œå°±å¯ä»¥å®ç°è¿ç®—ç¬¦é‡è½½çš„åŠŸèƒ½äº†ã€‚</p><p>ä¸Šé¢æ‰€è¯´çš„æŒ‡å®šå‡½æ•°æœ‰ä¸‹é¢è¿™äº›ï¼Œå¦‚å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df8ae50fc7cf4799bebe405014069ddd~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210319102601471"></p><p>2ï¼‰ä¾‹å¦‚æˆ‘ç°åœ¨è¦å®ç°ä¸¤ä¸ªå¯¹è±¡ç›¸åŠ çš„åŠŸèƒ½ï¼Œå®ƒçš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Obj</span> &#123;<br>   <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">plus</span><span class="hljs-params">(obj: <span class="hljs-type">Obj</span>)</span></span>: Obj&#123;<br>     <span class="hljs-comment">//do something</span><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªé‡‘é’±ç›¸åŠ çš„ä¾‹å­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Money</span>(<span class="hljs-keyword">val</span> value: <span class="hljs-built_in">Int</span>) &#123;<br><br>    <span class="hljs-comment">//å®ç°è¿ç®—ç¬¦é‡è½½ Money + Money</span><br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">plus</span><span class="hljs-params">(money: <span class="hljs-type">Money</span>)</span></span>: Money &#123;<br>        <span class="hljs-keyword">val</span> sum = value + money.value<br>        <span class="hljs-keyword">return</span> Money(sum)<br>    &#125;<br><br>    <span class="hljs-comment">//å®ç°è¿ç®—ç¬¦é‡è½½ Money + Int</span><br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">plus</span><span class="hljs-params">(money: <span class="hljs-type">Int</span>)</span></span>: Money&#123;<br>        <span class="hljs-keyword">val</span> sum = value + money<br>        <span class="hljs-keyword">return</span> Money(sum)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> money1 = Money(<span class="hljs-number">15</span>)<br>    <span class="hljs-keyword">val</span> money2 = Money(<span class="hljs-number">20</span>)<br>    <span class="hljs-keyword">val</span> money3 = money1 + money2<br>    <span class="hljs-keyword">val</span> money4 = money3 + <span class="hljs-number">15</span><br>    println(money3.value)<br>    print(money4.value)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">35</span><br><span class="hljs-number">50</span><br></code></pre></td></tr></table></figure><h2 id="ä¹ã€é«˜é˜¶å‡½æ•°è¯¦è§£"><a href="#ä¹ã€é«˜é˜¶å‡½æ•°è¯¦è§£" class="headerlink" title="ä¹ã€é«˜é˜¶å‡½æ•°è¯¦è§£"></a>ä¹ã€é«˜é˜¶å‡½æ•°è¯¦è§£</h2><p>é«˜é˜¶å‡½æ•°å’Œ Lambda è¡¨è¾¾å¼æ˜¯å¯†ä¸å¯åˆ†çš„ï¼Œåœ¨ä¹‹å‰çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸€äº› å‡½æ•°å¼ Api çš„ç”¨æ³•ï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒä»¬éƒ½ä¼šæœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼šéœ€è¦ä¼ å…¥ä¸€ä¸ª Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚åƒè¿™ç§æ¥æ”¶ Lambda è¡¨è¾¾å¼çš„å‡½æ•°æˆ‘ä»¬å°±å¯ä»¥ç§°ä¹‹ä¸ºå…·æœ‰å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„ Apiï¼Œè€Œå¦‚æœä½ è¦å®šä¹‰è‡ªå·±çš„å‡½æ•°å¼ Apiï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥å®ç°äº†</p><h3 id="1ã€å®šä¹‰é«˜é˜¶å‡½æ•°"><a href="#1ã€å®šä¹‰é«˜é˜¶å‡½æ•°" class="headerlink" title="1ã€å®šä¹‰é«˜é˜¶å‡½æ•°"></a>1ã€å®šä¹‰é«˜é˜¶å‡½æ•°</h3><p>1ï¼‰é«˜é˜¶å‡½æ•°çš„å®šä¹‰ï¼šä¸€ä¸ªå‡½æ•°æ¥æ”¶å¦å¤–ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…è¿”å›å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°</p><p>Kotlin ä¸­æ–°å¢äº†å‡½æ•°ç±»å‹ï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™ç§å‡½æ•°ç±»å‹æ·»åŠ åˆ°ä¸€ä¸ªå‡½æ•°çš„å‚æ•°å£°æ˜æˆ–è€…è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°</p><p>2ï¼‰å‡½æ•°ç±»å‹çš„è¯­æ³•è§„åˆ™å¦‚ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">(String,<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Unit</span><br><span class="hljs-comment">//æˆ–è€…å¦‚ä¸‹</span><br>() -&gt; <span class="hljs-built_in">Unit</span><br></code></pre></td></tr></table></figure><p>-&gt; çš„å·¦è¾¹å£°æ˜å‡½æ•°æ¥æ”¶ä»€ä¹ˆç±»å‹çš„å‚æ•°ï¼Œ-&gt; çš„å³è¾¹å£°æ˜çš„æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œç°åœ¨æˆ‘ä»¬æ¥å£°æ˜ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">example</span><span class="hljs-params">(func: (<span class="hljs-type">String</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>    <span class="hljs-comment">//do something</span><br>&#125;<br></code></pre></td></tr></table></figure><p>3ï¼‰é«˜é˜¶å‡½æ•°çš„è°ƒç”¨ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å‚æ•°ååé¢åŠ ä¸Šä¸€å¯¹æ‹¬å·ï¼Œä¼ å…¥å¯¹åº”ç±»å‹çš„å‚æ•°å³å¯ï¼Œä¾‹å¦‚ä»¥ä¸Šé¢å®šä¹‰çš„è¿™ä¸ªé«˜é˜¶å‡½æ•°ä¸ºä¾‹å­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">example</span><span class="hljs-params">(func: (<span class="hljs-type">String</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>    <span class="hljs-comment">//å‡½æ•°ç±»å‹è°ƒç”¨</span><br>    func(<span class="hljs-string">&quot;erdai&quot;</span>,<span class="hljs-number">666</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥å®è·µä¸€ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æˆ‘ä»¬ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥è·å–ä¸¤ä¸ªæ•°ç›¸åŠ çš„å’Œ</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = func(num1,num2)<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">plus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">return</span> num1 + num2<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">minus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">return</span> num1 - num2<br>&#125;<br><br><span class="hljs-comment">//è°ƒç”¨é«˜é˜¶å‡½æ•°çš„ä¸¤ç§æ–¹å¼</span><br><span class="hljs-comment">//æ–¹å¼1ï¼šæˆå‘˜å¼•ç”¨ï¼Œä½¿ç”¨ ::plusï¼Œ::minusè¿™ç§å†™æ³•å¼•ç”¨ä¸€ä¸ªå‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, ::plus)<br>    <span class="hljs-keyword">val</span> numberMinus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, ::minus)<br>    println(numberPlus)<br>    println(numberMinus)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">30</span><br>-<span class="hljs-number">10</span><br><br><span class="hljs-comment">//æ–¹å¼2ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„å†™æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)&#123; num1,num2 -&gt;<br>        num1 + num2<br>    &#125;<br>    <span class="hljs-keyword">val</span> numberMinus = numberPlus(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)&#123; num1,num2 -&gt;<br>        num1 - num2<br>    &#125;<br>    println(numberPlus)<br>    println(numberMinus)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">30</span><br>-<span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„å†™æ³•æ˜¯é«˜é˜¶å‡½æ•°ä¸­æœ€æ™®éçš„è°ƒç”¨æ–¹å¼</p><h3 id="2ã€å†…è”å‡½æ•°çš„ä½œç”¨"><a href="#2ã€å†…è”å‡½æ•°çš„ä½œç”¨" class="headerlink" title="2ã€å†…è”å‡½æ•°çš„ä½œç”¨"></a>2ã€å†…è”å‡½æ•°çš„ä½œç”¨</h3><p>1ï¼‰å†…è”å‡½æ•°å¯ä»¥æ¶ˆé™¤ Lambda è¡¨è¾¾å¼è¿è¡Œæ—¶å¸¦æ¥çš„å¼€é”€</p><p>Kotlin ä»£ç æœ€ç»ˆè¿˜æ˜¯ä¼šè½¬æ¢æˆ Java å­—èŠ‚ç æ–‡ä»¶ï¼Œä¸¾ä¸ªğŸŒ°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = func(num1,num2)<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-keyword">val</span> num1 = <span class="hljs-number">10</span><br>  <span class="hljs-keyword">val</span> num2 = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(num1, num2)&#123; num1,num2 -&gt;<br>        num1 + num2<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¸Šé¢è¿™äº›ä»£ç æœ€ç»ˆè½¬æ¢æˆ Java ä»£ç å¤§æ¦‚ä¼šå˜æˆè¿™æ ·ï¼š</span><br><span class="hljs-keyword">public</span> static int numberPlus(int num1, int num2, Function operation)&#123;<br>  int sum = (int) operation.invoke(num1,num2);<br>  <span class="hljs-keyword">return</span> sum;<br>&#125;<br><br><span class="hljs-keyword">public</span> static void main()&#123;<br>  int num1 = <span class="hljs-number">10</span>;<br>  int num2 = <span class="hljs-number">20</span>;<br>  int sum = numberPlus(num1,num2,new Function()&#123;<br>      <span class="hljs-meta">@Override</span><br>      <span class="hljs-keyword">public</span> Integer invoke(Integer num1,Integer num2)&#123;<br>          <span class="hljs-keyword">return</span> num1 + num2;<br>        &#125;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè½¬æ¢ä¹‹åï¼ŒnumberPlus å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å˜æˆäº†ä¸€ä¸ª Function æ¥å£ï¼Œè¿™æ˜¯ä¸€ç§ Kotlin çš„å†…ç½®æ¥å£ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå¾…å®ç°çš„ invoke å‡½æ•°ï¼Œè€Œ numberPlus å‡½æ•°å…¶å®å°±æ˜¯è°ƒç”¨äº† Function æ¥å£çš„ invoke å‡½æ•°ï¼Œå¹¶æŠŠ num1 å’Œ num2 ä¼ äº†è¿›å»ã€‚ä¹‹å‰çš„ Lambda è¡¨è¾¾å¼åœ¨è¿™é‡Œå˜æˆäº† Function æ¥å£çš„åŒ¿åç±»å®ç°ï¼Œè¿™å°±æ˜¯ Lambda è¡¨è¾¾å¼çš„åº•å±‚è½¬æ¢é€»è¾‘ï¼Œå› æ­¤æˆ‘ä»¬æ¯è°ƒç”¨ä¸€æ¬¡ Lambda è¡¨è¾¾å¼ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ¿åç±»å®ä¾‹ï¼Œè¿™æ ·å°±ä¼šé€ æˆé¢å¤–çš„å†…å­˜å’Œæ€§èƒ½å¼€é”€ã€‚ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨å†…è”å‡½æ•°ï¼Œå°±å¯ä»¥å¾ˆå¥½çš„å»è§£å†³è¿™ä¸ªé—®é¢˜</p><p>2ï¼‰å®šä¹‰é«˜é˜¶å‡½æ•°æ—¶åŠ ä¸Š inline å…³é”®å­—ä¿®é¥°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°ç§°ä¹‹ä¸ºå†…è”å‡½æ•°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå†…è”å‡½æ•°</span><br><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = func(num1,num2)<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é‚£è¿™é‡Œæˆ‘å°±ä¼šæœ‰ä¸ªç–‘é—®ï¼Œä¸ºå•¥å†…è”å‡½æ•°èƒ½æ¶ˆé™¤ Lambda è¡¨è¾¾å¼è¿è¡Œæ—¶å¸¦æ¥çš„å¼€é”€å‘¢ï¼Ÿ</strong></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å»å‰–æä¸€ä¸‹å†…è”å‡½æ•°çš„å·¥ä½œåŸç†äº†ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = func(num1,num2)<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> num1 = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">val</span> num2 = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(num1, num2)&#123; num1,num2 -&gt;<br>        num1 + num2<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸€æ­¥æ›¿æ¢è¿‡ç¨‹ï¼šKotlin ç¼–è¯‘å™¨ä¼šæŠŠ Lambda è¡¨è¾¾å¼ä¸­çš„ä»£ç æ›¿æ¢åˆ°å‡½æ•°ç±»å‹å‚æ•°è°ƒç”¨çš„åœ°æ–¹</strong> ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d72c3b1f9004f1f8fbea4f3f8353a3b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210318103738396"></p><p>æ›¿æ¢åä»£ç å˜æˆäº†è¿™æ ·ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">numberPlus</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>,num2: <span class="hljs-type">Int</span>,func: (<span class="hljs-type">Int</span>,<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">val</span> sum = num1 + num2<br>    <span class="hljs-keyword">return</span> sum<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> num1 = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">val</span> num2 = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> numberPlus = numberPlus(num1, num2);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç¬¬äºŒæ­¥æ›¿æ¢è¿‡ç¨‹ï¼šKotlin ç¼–è¯‘å™¨ä¼šæŠŠå†…è”å‡½æ•°ä¸­çš„å…¨éƒ¨ä»£ç æ›¿æ¢åˆ°å‡½æ•°è°ƒç”¨çš„åœ°æ–¹</strong> ï¼Œå¦‚ä¸‹å›¾ï¼š </p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ed6033ee5354e8e8752ac4255fbb2ce~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210318104214303"></p><p>æ›¿æ¢åä»£ç å˜æˆäº†è¿™æ ·ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> num1 = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">val</span> num2 = <span class="hljs-number">20</span><br>    <span class="hljs-keyword">val</span> numberPlus = num1 + num2<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æ­¥éª¤å°±æ˜¯å†…è”å‡½æ•°çš„ä¸€ä¸ªå·¥ä½œæµç¨‹ï¼š<strong>Kotlin ç¼–è¯‘å™¨ä¼šæŠŠå†…è”å‡½æ•°ä¸­çš„ä»£ç åœ¨ç¼–è¯‘çš„æ—¶å€™è‡ªåŠ¨æ›¿æ¢åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹</strong> ï¼Œè¿™æ ·ä¹Ÿå°±ä¸å­˜åœ¨è¿è¡Œæ—¶çš„å¼€é”€äº†</p><p>3ï¼‰ä½¿ç”¨ noinline å…³é”®å­—ä¿®é¥°çš„å‡½æ•°ç±»å‹å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ç±»å‹å‚æ•°ä¸éœ€è¦è¿›è¡Œå†…è”</p><p>ä¸€èˆ¬ä½¿ç”¨ noinline å…³é”®å­—ï¼Œæ˜¯åœ¨ä¸€ä¸ªå†…è”å‡½æ•°ä¸­å­˜åœ¨å¤šä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//ä½¿ç”¨å†…è”å‡½æ•°å®šä¹‰çš„é«˜é˜¶å‡½æ•°ï¼Œå…¶é‡Œé¢çš„å‡½æ•°ç±»å‹å‚æ•°éƒ½ä¼šè¿›è¡Œå†…è”ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨ noinline è¡¨ç¤ºæˆ‘è¿™ä¸ªå‡½æ•°ç±»å‹å‚æ•°ä¸éœ€è¦å†…è”</span><br><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">inlineTest</span><span class="hljs-params">(block1: () -&gt; <span class="hljs-type">Unit</span>, <span class="hljs-keyword">noinline</span> block2: () -&gt; <span class="hljs-type">Unit</span>)</span></span>&#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>å‰é¢æˆ‘ä»¬è®²åˆ°ï¼Œä½¿ç”¨å†…è”å‡½æ•°èƒ½å‡å°‘è¿è¡Œæ—¶å¼€é”€ï¼Œä¸ºå•¥ç°åœ¨åˆè¦å‡ºæ¥ä¸ª noinline å…³é”®å­—å®šä¹‰ä¸éœ€è¦å†…è”å‘¢ï¼ŸåŸå› å¦‚ä¸‹ï¼š</p><p>1ã€å†…è”å‡½æ•°åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¿›è¡Œä»£ç æ›¿æ¢ï¼Œå› æ­¤å®ƒæ²¡æœ‰çœŸæ­£çš„å‚æ•°å±æ€§ï¼Œå®ƒçš„å‡½æ•°ç±»å‹å‚æ•°åªèƒ½ä¼ é€’ç»™å¦å¤–ä¸€ä¸ªå†…è”å‡½æ•°ï¼Œè€Œéå†…è”å‡½æ•°çš„å‡½æ•°ç±»å‹å‚æ•°å¯ä»¥è‡ªç”±çš„ä¼ é€’ç»™å…¶ä»–ä»»ä½•å‡½æ•°</p><p>2ã€å†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå‡½æ•°è¿”å›ï¼Œéå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return@Method è¯­æ³•ç»“æ„æ¥è¿›è¡Œå±€éƒ¨è¿”å›</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æƒ…å†µ1ï¼šéå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå±€éƒ¨è¿”å›</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªéå†…è”çš„é«˜é˜¶å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printString</span><span class="hljs-params">(str: <span class="hljs-type">String</span>, block: (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span>&#123;<br>    println(<span class="hljs-string">&quot;printString start...&quot;</span>)<br>    block(str)<br>    println(<span class="hljs-string">&quot;printString end...&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;main start...&quot;</span>)<br>    <span class="hljs-keyword">val</span> str = <span class="hljs-string">&quot;&quot;</span><br>    printString(str)&#123;<br>        println(<span class="hljs-string">&quot;lambda start...&quot;</span>)<br>      <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 1ï¼Œéå†…è”å‡½æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨ return å…³é”®å­—è¿›è¡Œå±€éƒ¨è¿”å›</span><br><span class="hljs-comment"> * 2ï¼Œéœ€è¦ä½¿ç”¨ return<span class="hljs-doctag">@printString</span> è¿›è¡Œå±€éƒ¨è¿”å›</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">if</span> (str.isEmpty())<span class="hljs-keyword">return</span><span class="hljs-symbol">@printString</span><br>        println(it)<br>        println(<span class="hljs-string">&quot;lambda end...&quot;</span>)<br>    &#125;<br>    println(<span class="hljs-string">&quot;main end...&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>main start...<br>printString start...<br>lambda start...<br>printString end...<br>main end...<br><br><span class="hljs-comment">//æƒ…å†µ2ï¼šå†…è”å‡½æ•°æ‰€å¼•ç”¨çš„ Lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æ¥è¿›è¡Œå‡½æ•°è¿”å›</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªéå†…è”çš„é«˜é˜¶å‡½æ•°</span><br><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printString</span><span class="hljs-params">(str: <span class="hljs-type">String</span>, block: (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span>&#123;<br>    println(<span class="hljs-string">&quot;printString start...&quot;</span>)<br>    block(str)<br>    println(<span class="hljs-string">&quot;printString end...&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;main start...&quot;</span>)<br>    <span class="hljs-keyword">val</span> str = <span class="hljs-string">&quot;&quot;</span><br>    printString(str)&#123;<br>        println(<span class="hljs-string">&quot;lambda start...&quot;</span>)<br>        <span class="hljs-keyword">if</span> (str.isEmpty())<span class="hljs-keyword">return</span><br>        println(it)<br>        println(<span class="hljs-string">&quot;lambda end...&quot;</span>)<br>    &#125;<br>    println(<span class="hljs-string">&quot;main end...&quot;</span>)<br>&#125;<br><span class="hljs-comment">//å› ä¸ºå†…è”å‡½æ•°ä¼šè¿›è¡Œä»£ç æ›¿æ¢ï¼Œå› æ­¤è¿™ä¸ª return å°±ç›¸å½“äºå¤–å±‚å‡½æ•°è°ƒç”¨çš„ä¸€ä¸ªè¿”å›ï¼Œå¦‚ä¸‹ä»£ç ï¼š</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;main start...&quot;</span>)<br>    <span class="hljs-keyword">val</span> str = <span class="hljs-string">&quot;&quot;</span><br>    println(<span class="hljs-string">&quot;printString start...&quot;</span>)<br>    println(<span class="hljs-string">&quot;lambda start...&quot;</span>)<br>    <span class="hljs-keyword">if</span> (str.isEmpty())<span class="hljs-keyword">return</span><br>    println(str)<br>    println(<span class="hljs-string">&quot;lambda end...&quot;</span>)<br>    println(<span class="hljs-string">&quot;printString end...&quot;</span>)<br>    println(<span class="hljs-string">&quot;main end...&quot;</span>)<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>main start...<br>printString start...<br>lambda start...<br></code></pre></td></tr></table></figure><p>4ï¼‰ã€ä½¿ç”¨ crossinline å…³é”®å­—ä¿è¯å†…è”å‡½æ•°çš„ Lambda è¡¨è¾¾å¼ä¸­ä¸€å®šä¸ä¼šä½¿ç”¨ return å…³é”®å­—ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ return@Method è¯­æ³•ç»“æ„è¿›è¡Œå±€éƒ¨è¿”å›ï¼Œå…¶ä»–æ–¹é¢å’Œå†…è”å‡½æ•°ç‰¹æ€§ä¸€è‡´</p><p>ä¸¾ä¸ªä½¿ç”¨ crossinline åœºæ™¯çš„ğŸŒ° ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c7beec9bdbb4e789d1814381accc36f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210318115342264"></p><p>ä¸Šé¢å›¾ç‰‡ä¸­çš„ä»£ç æŠ¥é”™äº†ï¼Œç¼–è¯‘å™¨æç¤ºæˆ‘ä»¬çš„å¤§è‡´åŸå› æ˜¯ï¼šè¿™ä¸ªåœ°æ–¹ä¸èƒ½ä½¿ç”¨ inline ,å› ä¸ºå®ƒå¯èƒ½åŒ…å«éå±€éƒ¨çš„ return è¿”å›ï¼Œæ·»åŠ  crossinline ä¿®é¥°ç¬¦å»ä¿®é¥°è¿™ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ã€‚</p><p>ä¸ºå•¥å‘¢ï¼Ÿæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š</p><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Runnable å¯¹è±¡ï¼Œåœ¨ Runnable ä¸­çš„ Lambda è¡¨è¾¾å¼ä¸­è°ƒç”¨äº†å‡½æ•°ç±»å‹å‚æ•°ï¼ŒLambda è¡¨è¾¾å¼åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¢«è½¬æ¢æˆåŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œå†…è”å‡½æ•°å…è®¸æˆ‘ä»¬åœ¨ Lambda è¡¨è¾¾å¼ä¸­ä½¿ç”¨ return å…³é”®å­—è¿›è¡Œå‡½æ•°è¿”å›ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ˜¯åœ¨åŒ¿åç±»ä¸­è°ƒç”¨çš„å‡½æ•°ç±»å‹å‚æ•°ï¼Œæ­¤æ—¶æ˜¯ä¸å¯èƒ½è¿›è¡Œå¤–å±‚è°ƒç”¨å‡½æ•°è¿”å›çš„ï¼Œæœ€å¤šæ˜¯åœ¨åŒ¿åå‡½æ•°ä¸­è¿›è¡Œè¿”å›ï¼Œå› æ­¤è¿™é‡Œå°±æç¤ºäº†é”™è¯¯ï¼ŒçŸ¥é“äº†åŸå› é‚£æˆ‘ä»¬ä½¿ç”¨ crossinline å…³é”®å­—æ¥ä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">runRunnable</span><span class="hljs-params">(<span class="hljs-keyword">crossinline</span> block: () -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>    println(<span class="hljs-string">&quot;runRunnable start...&quot;</span>)<br>    <span class="hljs-keyword">val</span> runnable = Runnable &#123;<br>        block()<br>    &#125;<br>    runnable.run()<br>    println(<span class="hljs-string">&quot;runRunnable end...&quot;</span>)<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;main start...&quot;</span>)<br>    runRunnable &#123;<br>        println(<span class="hljs-string">&quot;lambda start...&quot;</span>)<br>        <span class="hljs-keyword">return</span><span class="hljs-symbol">@runRunnable</span><br>        println(<span class="hljs-string">&quot;lambda end...&quot;</span>)<br>    &#125;<br>    println(<span class="hljs-string">&quot;main end...&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>main start...<br>runRunnable start...<br>lambda start...<br>runRunnable end...<br>main end...<br></code></pre></td></tr></table></figure><h2 id="åã€æ³›å‹å’Œå§”æ‰˜"><a href="#åã€æ³›å‹å’Œå§”æ‰˜" class="headerlink" title="åã€æ³›å‹å’Œå§”æ‰˜"></a>åã€æ³›å‹å’Œå§”æ‰˜</h2><h3 id="1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•"><a href="#1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•"></a>1ã€æ³›å‹çš„åŸºæœ¬ç”¨æ³•</h3><p>1ï¼‰ã€é¦–å…ˆæˆ‘ä»¬è§£é‡Šä¸‹ä»€ä¹ˆæ˜¯æ³›å‹ï¼Œæ³›å‹å°±æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ä¸æŒ‡å®šå…·ä½“ç±»å‹çš„æƒ…å†µä¸‹è¿›è¡Œç¼–ç¨‹ã€‚æˆ‘ä»¬åœ¨å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ–¹æ³•ï¼Œæˆ–è€…æ¥å£çš„æ—¶å€™ï¼Œç»™ä»–ä»¬åŠ ä¸Šä¸€ä¸ªç±»å‹å‚æ•°ï¼Œå°±æ˜¯ä¸ºè¿™ä¸ªç±»ï¼Œæ–¹æ³•ï¼Œæˆ–è€…æ¥å£æ·»åŠ äº†ä¸€ä¸ªæ³›å‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»ï¼Œåœ¨ç±»ååé¢ä½¿ç”¨ &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªç±»å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&lt;<span class="hljs-type">T</span>&gt;&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span> &#123;<br>      <br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ³›å‹è°ƒç”¨</span><br><span class="hljs-keyword">val</span> myClass = MyClass&lt;<span class="hljs-built_in">Int</span>&gt;()<br>myClass.method(<span class="hljs-number">12</span>)<br><br><span class="hljs-comment">//2ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•åçš„å‰é¢åŠ ä¸Š &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ–¹æ³•å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span>&#123;<br><br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ³›å‹è°ƒç”¨</span><br><span class="hljs-keyword">val</span> myClass = MyClass()<br>myClass.method&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-number">12</span>)<br><span class="hljs-comment">//æ ¹æ® Kotlin ç±»å‹æ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ³›å‹ç»™çœç•¥</span><br>myClass.method(<span class="hljs-number">12</span>)<br><br><span class="hljs-comment">//3ã€å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œåœ¨æ¥å£ååé¢åŠ ä¸Š &lt;T&gt; è¿™ç§è¯­æ³•ç»“æ„å°±æ˜¯ä¸ºè¿™ä¸ªæ¥å£å®šä¹‰ä¸€ä¸ªæ³›å‹</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyInterface</span>&lt;<span class="hljs-type">T</span>&gt;&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">interfaceMethod</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ T ä¸æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥æ˜¯ä»»æ„å•è¯å’Œå­—æ¯ï¼Œä½†æ˜¯å®šä¹‰çš„æ³›å‹å°½é‡åšåˆ°è§åçŸ¥ä¹‰</p><p>2ï¼‰ã€ä¸ºæ³›å‹æŒ‡å®šä¸Šç•Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>&lt;T : Class&gt;</code> è¿™ç§è¯­æ³•ç»“æ„ï¼Œå¦‚æœä¸æŒ‡å®šæ³›å‹çš„ä¸Šç•Œï¼Œé»˜è®¤ä¸º Any? ç±»å‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>  <span class="hljs-comment">//æˆ‘ä»¬æŒ‡å®šäº†æ³›å‹çš„ä¸Šç•Œä¸º Number, é‚£ä¹ˆæˆ‘ä»¬å°±åªèƒ½ä¼ å…¥æ•°å­—ç±»å‹çš„å‚æ•°äº†</span><br>  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">method</span><span class="hljs-params">(params: <span class="hljs-type">T</span>)</span></span> &#123;<br>      <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§"><a href="#2ã€ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§" class="headerlink" title="2ã€ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§"></a>2ã€ç±»å§”æ‰˜å’Œå§”æ‰˜å±æ€§</h3><p>å§”æ‰˜æ¨¡å¼çš„æ„ä¹‰ï¼š<strong>åœ¨äºæˆ‘ä»¬å¤§éƒ¨åˆ†æ–¹æ³•å®ç°å¯ä»¥è°ƒç”¨è¾…åŠ©å¯¹è±¡å»å®ç°ï¼Œå°‘éƒ¨åˆ†æ–¹æ³•çš„å®ç°ç”±è‡ªå·±æ¥é‡å†™ï¼Œç”šè‡³åŠ å…¥ä¸€äº›è‡ªå·±ç‹¬æœ‰çš„æ–¹æ³•ï¼Œä½¿æˆ‘ä»¬è¿™ä¸ªç±»å˜æˆä¸€ä¸ªå…¨æ–°æ•°æ®ç»“æ„çš„ç±»</strong></p><p>1ï¼‰ã€ç±»å§”æ‰˜æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠä¸€ä¸ªç±»çš„å…·ä½“å®ç°å§”æ‰˜ç»™å¦å¤–ä¸€ä¸ªç±»ï¼Œä½¿ç”¨ by å…³é”®å­—è¿›è¡Œå§”æ‰˜</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª MySet ç±»ï¼Œå®ƒé‡Œé¢çš„å…·ä½“å®ç°éƒ½å§”æ‰˜ç»™äº† HashSet è¿™ä¸ªç±»ï¼Œè¿™æ˜¯æ˜¯ç±»å§”æ‰˜</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MySet</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">val</span> helperSet: HashSet&lt;T&gt;) : Set&lt;T&gt;&#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> size: <span class="hljs-built_in">Int</span> <span class="hljs-keyword">get</span>() = helperSet.size<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">contains</span><span class="hljs-params">(element: <span class="hljs-type">T</span>)</span></span> = helperSet.contains(element)<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">containsAll</span><span class="hljs-params">(elements: <span class="hljs-type">Collection</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> = helperSet.containsAll(elements)<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span></span> = helperSet.isEmpty()<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">iterator</span><span class="hljs-params">()</span></span> = helperSet.iterator()<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¦‚æœæˆ‘ä»¬ä½¿ç”¨ by å…³é”®å­—ï¼Œä¸Šé¢çš„ä»£ç å°†ä¼šå˜å¾—éå¸¸æ•´æ´ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å¯¹æŸä¸ªæ–¹æ³•è¿›è¡Œé‡å†™æˆ–è€…æ–°å¢æ–¹æ³•</span><br><span class="hljs-comment"> * é‚£ä¹ˆ MySet å°±å˜æˆäº†ä¸€ä¸ªå…¨æ–°çš„æ•°æ®ç»“æ„ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MySet</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">val</span> helperSet: HashSet&lt;T&gt;) : Set&lt;T&gt; <span class="hljs-keyword">by</span> helperSet&#123;<br>     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">helloWord</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;Hello World&quot;</span>)<br>    &#125;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span></span> = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€å±æ€§å§”æ‰˜çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ä¸€ä¸ªå±æ€§çš„å…·ä½“å®ç°å§”æ‰˜ç»™å¦ä¸€ä¸ªç±»å»å®Œæˆ</p><p>å±æ€§å§”æ‰˜çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p> <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä½¿ç”¨ by å…³é”®å­—è¿æ¥äº†å·¦è¾¹çš„ p å±æ€§å’Œå³è¾¹çš„ Delegate å®ä¾‹</span><br><span class="hljs-comment"> * è¿™ç§å†™æ³•å°±ä»£è¡¨ç€å°† p å±æ€§çš„å…·ä½“å®ç°å§”æ‰˜ç»™äº† Delegate å»å®Œæˆ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br><br>    <span class="hljs-keyword">var</span> p <span class="hljs-keyword">by</span> Delegate()<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä¸‹é¢æ˜¯ä¸€ä¸ªè¢«å§”æ‰˜ç±»çš„ä»£ç å®ç°æ¨¡ç‰ˆ</span><br><span class="hljs-comment"> * ä¸€ã€getValue æ–¹æ³•å’ŒsetValue æ–¹æ³•å¿…é¡»ä½¿ç”¨ operator å…³é”®å­—ä¿®é¥°</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * äºŒã€getValue æ–¹æ³•ä¸»è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š</span><br><span class="hljs-comment"> * 1ã€ç¬¬ä¸€ä¸ªå‚æ•°è¡¨æ˜ Delegate ç±»çš„å§”æ‰˜åŠŸèƒ½å¯ä»¥åœ¨ä»€ä¹ˆç±»ä¸­ä½¿ç”¨</span><br><span class="hljs-comment"> * 2ã€ç¬¬äºŒä¸ªå‚æ•° KProperty&lt;*&gt; æ˜¯ Kotlin ä¸­çš„ä¸€ä¸ªå±æ€§æ“ä½œç±»ï¼Œ</span><br><span class="hljs-comment"> *    å¯ç”¨äºè·å–å„ç§å±æ€§çš„ç›¸å…³å€¼ï¼Œ&lt;*&gt;è¿™ç§æ³›å‹çš„å†™æ³•ç±»ä¼¼ Java çš„</span><br><span class="hljs-comment"> *    &lt;?&gt;ï¼Œè¡¨ç¤ºæˆ‘ä¸å…³å¿ƒæ³›å‹çš„å…·ä½“ç±»å‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ä¸‰ã€setValue æ–¹æ³•ä¹Ÿæ˜¯ç›¸ä¼¼çš„ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š</span><br><span class="hljs-comment"> * 1ã€å‰é¢ä¸¤ä¸ªå‚æ•°å’Œ getValue æ˜¯ä¸€æ ·çš„</span><br><span class="hljs-comment"> * 2ã€ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºå…·ä½“è¦èµ‹å€¼ç»™å§”æ‰˜å±æ€§çš„å€¼ï¼Œè¿™ä¸ªå‚æ•°çš„ç±»å‹å¿…é¡»å’Œ</span><br><span class="hljs-comment"> *    getValue æ–¹æ³•è¿”å›å€¼çš„ç±»å‹ä¿æŒä¸€è‡´</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šç”¨ val å®šä¹‰çš„å˜é‡ä¸éœ€è¦å®ç° setValue æ–¹æ³•ï¼Œå› ä¸º val</span><br><span class="hljs-comment"> *             å…³é”®å­—å£°æ˜çš„å±æ€§åªå¯è¯»ï¼Œèµ‹å€¼ä¹‹åå°±ä¸èƒ½æ›´æ”¹äº†</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Delegate</span>&#123;<br>    <br>    <span class="hljs-keyword">var</span> propValue: Any? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getValue</span><span class="hljs-params">(any: <span class="hljs-type">Any</span>?,prop: <span class="hljs-type">KProperty</span>&lt;*&gt;)</span></span>: Any?&#123;<br>        <span class="hljs-keyword">return</span> propValue<br>    &#125;<br><br>    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setValue</span><span class="hljs-params">(any: <span class="hljs-type">Any</span>?,prop: <span class="hljs-type">KProperty</span>&lt;*&gt;,value: <span class="hljs-type">Any</span>?)</span></span>&#123;<br>        propValue = value<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åä¸€ã€ä½¿ç”¨-infix-å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•"><a href="#åä¸€ã€ä½¿ç”¨-infix-å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•" class="headerlink" title="åä¸€ã€ä½¿ç”¨ infix å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•"></a>åä¸€ã€ä½¿ç”¨ infix å‡½æ•°æ„å»ºæ›´å¯è¯»çš„è¯­æ³•</h2><p>infix å‡½æ•°è¯­æ³•ç»“æ„å¯è¯»æ€§é«˜ï¼Œç›¸æ¯”äºè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ›´æ¥è¿‘äºä½¿ç”¨è‹±è¯­ A to B è¿™æ ·çš„è¯­æ³•ç»“æ„</p><p>ä¾‹å¦‚æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¼šä½¿ç”¨ï¼š A.to(B) è¿™ç§ç»“æ„ï¼Œä½†æ˜¯ä½¿ç”¨ infix å‡½æ•°æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼šA to Bï¼Œè¿™ç§è¯­æ³•æˆ‘ä»¬åœ¨è®² Map çš„æ—¶å€™ç”¨è¿‡</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯å˜ Map é›†åˆ</span><br><span class="hljs-keyword">val</span> map1 = mapOf(<span class="hljs-string">&quot;Apple&quot;</span> to <span class="hljs-number">1</span>,<span class="hljs-string">&quot;Banana&quot;</span> to <span class="hljs-number">2</span>,<span class="hljs-string">&quot;Orange&quot;</span> to <span class="hljs-number">3</span>, <span class="hljs-string">&quot;Pear&quot;</span> to <span class="hljs-number">4</span>,<span class="hljs-string">&quot;Grape&quot;</span> to <span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p>1ï¼‰ã€åœ¨å‡½æ•°å‰é¢åŠ ä¸Š infix å…³é”®å­—ï¼Œå°±å¯ä»¥å£°æ˜è¿™æ˜¯ä¸€ä¸ª infix å‡½æ•°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å¯¹ String å¢åŠ ä¸€ä¸ªæ‰©å±•çš„ infix å‡½æ•°ï¼Œæœ€ç»ˆè°ƒç”¨çš„è¿˜æ˜¯ String çš„ startsWith å‡½æ•°</span><br><span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">beginWith</span><span class="hljs-params">(string: <span class="hljs-type">String</span>)</span></span> = startsWith(string)<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;erdai&quot;</span><br>    println(name beginWith <span class="hljs-string">&quot;er&quot;</span>)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¥å®ç°ä¸€ä¸ªåˆå§‹åŒ– Map æ—¶é‡Œé¢ä¼ å…¥ A to B è¿™ç§ infix å‡½æ•°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//è¿™æ˜¯ A to B çš„æºç å®ç°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;A, B&gt;</span> A.<span class="hljs-title">to</span><span class="hljs-params">(that: <span class="hljs-type">B</span>)</span></span>: Pair&lt;A, B&gt; = Pair(<span class="hljs-keyword">this</span>, that)<br><br><span class="hljs-comment">//æˆ‘ä»¬ä»¿ç…§å®ƒå†™ä¸€ä¸ª</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;A,B&gt;</span> A.<span class="hljs-title">with</span><span class="hljs-params">(that: <span class="hljs-type">B</span>)</span></span>: Pair&lt;A,B&gt; = Pair(<span class="hljs-keyword">this</span>,that)<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> map = mapOf(<span class="hljs-string">&quot;Apple&quot;</span> with <span class="hljs-number">1</span>,<span class="hljs-string">&quot;Banana&quot;</span> with <span class="hljs-number">2</span>,<span class="hljs-string">&quot;Orange&quot;</span> with <span class="hljs-number">3</span>,<span class="hljs-string">&quot;Pear&quot;</span> with <span class="hljs-number">4</span>,<span class="hljs-string">&quot;Grape&quot;</span> with <span class="hljs-number">5</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åäºŒã€ä½¿ç”¨-DSL-æ„å»ºä¸“æœ‰çš„è¯­æ³•ç»“æ„"><a href="#åäºŒã€ä½¿ç”¨-DSL-æ„å»ºä¸“æœ‰çš„è¯­æ³•ç»“æ„" class="headerlink" title="åäºŒã€ä½¿ç”¨ DSL æ„å»ºä¸“æœ‰çš„è¯­æ³•ç»“æ„"></a>åäºŒã€ä½¿ç”¨ DSL æ„å»ºä¸“æœ‰çš„è¯­æ³•ç»“æ„</h2><p>1ï¼‰ã€DSL ä»‹ç»</p><p>DSLè‹±æ–‡å…¨ç§°ï¼š<strong>domain specific language</strong>ï¼Œä¸­æ–‡ç¿»è¯‘å³é¢†åŸŸç‰¹å®šè¯­è¨€ï¼Œä¾‹å¦‚ï¼šHTMLï¼ŒXMLç­‰ DSL è¯­è¨€</p><p><strong>ç‰¹ç‚¹</strong></p><ul><li>è§£å†³ç‰¹å®šé¢†åŸŸçš„ä¸“æœ‰é—®é¢˜</li><li>å®ƒä¸ç³»ç»Ÿç¼–ç¨‹è¯­è¨€èµ°çš„æ˜¯ä¸¤ä¸ªæç«¯ï¼Œç³»ç»Ÿç¼–ç¨‹è¯­è¨€æ˜¯å¸Œæœ›è§£å†³æ‰€æœ‰çš„é—®é¢˜ï¼Œæ¯”å¦‚ Java è¯­è¨€å¸Œæœ›èƒ½åš Android å¼€å‘ï¼Œåˆå¸Œæœ›èƒ½åšåå°å¼€å‘ï¼Œå®ƒå…·æœ‰æ¨ªå‘æ‰©å±•çš„ç‰¹æ€§ã€‚è€Œ DSL å…·æœ‰çºµå‘æ·±å…¥è§£å†³ç‰¹å®šé¢†åŸŸä¸“æœ‰é—®é¢˜çš„ç‰¹æ€§ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼ŒDSL çš„<strong>æ ¸å¿ƒæ€æƒ³</strong>å°±æ˜¯ï¼šâ€œæ±‚ä¸“ä¸æ±‚å…¨ï¼Œè§£å†³ç‰¹å®šé¢†åŸŸçš„é—®é¢˜â€ã€‚</p><p>2ï¼‰Kotin DSL </p><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹Gradleï¼šGradle æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œæ˜¯ä¸€ç§åŸºäº Groovy æˆ– Kotin çš„ DSLã€‚æˆ‘ä»¬çš„ Android åº”ç”¨å°±æ˜¯ä½¿ç”¨ Gradle æ„å»ºçš„ï¼Œå› æ­¤åç»­å†™è„šæœ¬ï¼Œå†™æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Kotlin å»ç¼–å†™ï¼Œè€Œä¸” AndroidStudio å¯¹ Kotlin çš„æ”¯æŒå¾ˆå‹å¥½ï¼Œå„ç§æç¤ºï¼Œå†™èµ·æ¥å¾ˆçˆ½ã€‚</p><p>å¯¹äºæˆ‘ä»¬ Android å¼€å‘ï¼Œåœ¨ build.gradle æ–‡ä»¶é‡Œé¢æ·»åŠ ä¾èµ–çš„æ–¹å¼å¾ˆå¸¸è§ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">dependencies &#123;<br>    implementation <span class="hljs-string">&#x27;androidx.core:core-ktx:1.3.2&#x27;</span><br>    implementation <span class="hljs-string">&#x27;androidx.appcompat:appcompat:1.2.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ç§å†™æ³•æ˜¯ä¸€ç§åŸºäº Groovy çš„ DSLï¼Œä¸‹é¢æˆ‘ä»¬å°±ä½¿ç”¨ Kotlin æ¥å®ç°ä¸€ä¸ªç±»ä¼¼çš„ DSLï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dependency</span> &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">implementation</span><span class="hljs-params">(lib: <span class="hljs-type">String</span>)</span></span>&#123;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dependencies</span><span class="hljs-params">(block: <span class="hljs-type">Dependency</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>&#123;<br>    <span class="hljs-keyword">val</span> dependency = Dependency()<br>    dependency.block()<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//å› ä¸º Groovy å’Œ Kotlin è¯­æ³•ä¸åŒï¼Œå› æ­¤å†™æ³•ä¼šæœ‰ä¸€ç‚¹åŒºåˆ«</span><br>    dependencies &#123;<br>        implementation (<span class="hljs-string">&quot;androidx.core:core-ktx:1.3.2&quot;</span>)<br>        implementation (<span class="hljs-string">&quot;androidx.appcompat:appcompat:1.2.0&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åä¸‰ã€Java-ä¸-Kotlin-ä»£ç ä¹‹é—´çš„è½¬æ¢"><a href="#åä¸‰ã€Java-ä¸-Kotlin-ä»£ç ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="åä¸‰ã€Java ä¸ Kotlin ä»£ç ä¹‹é—´çš„è½¬æ¢"></a>åä¸‰ã€Java ä¸ Kotlin ä»£ç ä¹‹é—´çš„è½¬æ¢</h2><h3 id="Java-ä»£ç è½¬-Kotlin-ä»£ç "><a href="#Java-ä»£ç è½¬-Kotlin-ä»£ç " class="headerlink" title="Java ä»£ç è½¬ Kotlin ä»£ç "></a>Java ä»£ç è½¬ Kotlin ä»£ç </h3><p>æ–¹å¼æœ‰2ï¼š</p><p>1ï¼‰ã€ç›´æ¥å°† Java ä»£ç å¤åˆ¶åˆ° Kotlin æ–‡ä»¶ä¸­ï¼ŒAndroidStudio ä¼šå‡ºæ¥æç¤ºæ¡†è¯¢é—®ä½ æ˜¯å¦è½¬æ¢</p><p>2ï¼‰ã€æ‰“å¼€è¦è½¬æ¢çš„ Java æ–‡ä»¶ï¼Œåœ¨å¯¼èˆªæ ç‚¹å‡» Code -&gt; Convert Java File to Kotlin File</p><h3 id="Kotlin-ä»£ç è½¬-Java-ä»£ç "><a href="#Kotlin-ä»£ç è½¬-Java-ä»£ç " class="headerlink" title="Kotlin ä»£ç è½¬ Java ä»£ç "></a>Kotlin ä»£ç è½¬ Java ä»£ç </h3><p>æ‰“å¼€å½“å‰éœ€è¦è½¬æ¢çš„ Kotlin æ–‡ä»¶ï¼Œåœ¨å¯¼èˆªæ ç‚¹å‡» Tools -&gt; Kotlin -&gt;Show Kotlin Bytecode ï¼Œä¼šå‡ºæ¥å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0008a17b27f4c8990ad726501654dbd~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210318152946177"></p><p>ç‚¹å‡» Decompile å°±å¯ä»¥æŠŠ Kotlin å­—èŠ‚ç æ–‡ä»¶åç¼–è¯‘æˆ Java ä»£ç äº†</p><h2 id="åå››ã€æ€»ç»“"><a href="#åå››ã€æ€»ç»“" class="headerlink" title="åå››ã€æ€»ç»“"></a>åå››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« å¾ˆé•¿ï¼Œæˆ‘ä»¬ä»‹ç»äº† Kotlin å¤§éƒ¨åˆ†çŸ¥è¯†ç‚¹ï¼ŒæŒ‰ç…§æ–‡ç« å¼€å¤´çš„æ€ç»´å¯¼å›¾ï¼Œæˆ‘ä»¬å°±åªå‰©ä¸‹ Kotlin æ³›å‹é«˜çº§ç‰¹æ€§å’Œ Kotlin æºç¨‹æ²¡æœ‰è®²äº†ï¼Œè¿™ä¸¤éƒ¨åˆ†ç›¸å¯¹æ¥è¯´æ¯”è¾ƒéš¾ï¼Œå’‹ä»¬åç»­åœ¨æ¥ä»”ç»†åˆ†æã€‚ç›¸ä¿¡ä½ å¦‚æœä»å¤´çœ‹åˆ°è¿™é‡Œï¼Œæ”¶è·ä¸€å®šå¾ˆå¤šï¼Œå¦‚æœè§‰å¾—æˆ‘å†™å¾—è¿˜ä¸é”™ï¼Œè¯·ç»™æˆ‘ç‚¹ä¸ªèµå§ğŸ¤</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p>[ç¬¬ä¸€è¡Œä»£ç  Android ç¬¬3ç‰ˆ] ï¼šéƒ­ç¥å‡ºå“ï¼Œå¿…å±ç²¾å“ï¼Œå¯¹ Kotlin çš„è®²è§£å†™å¾—é€šä¿—æ˜“æ‡‚</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Kotlin</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Kotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå­—ä½“ç³»åˆ— ï¼ˆå››ï¼‰ï¼šå…¨å±€æ›¿æ¢å­—ä½“æ–¹å¼</title>
    <link href="/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9A%E5%85%A8%E5%B1%80%E6%9B%BF%E6%8D%A2%E5%AD%97%E4%BD%93%E6%96%B9%E5%BC%8F/"/>
    <url>/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9A%E5%85%A8%E5%B1%80%E6%9B%BF%E6%8D%A2%E5%AD%97%E4%BD%93%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a81428b3b57d46fd953022835fecb19e~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† Xml ä¸­çš„å­—ä½“ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6974388756275019812">Androidå­—ä½“ç³»åˆ— ï¼ˆä¸‰ï¼‰ï¼šXmlä¸­çš„å­—ä½“</a>ï¼Œæœ‰äº†å‰é¢çš„åŸºç¡€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹ä¸‹ Android ä¸­å…¨å±€æ›¿æ¢å­—ä½“çš„å‡ ç§æ–¹å¼</p><p><strong>æ³¨æ„ï¼šæœ¬æ–‡æ‰€å±•ç¤ºçš„ç³»ç»Ÿæºç éƒ½æ˜¯åŸºäºAndroid-30 ï¼Œå¹¶æå–æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œåˆ†æ</strong></p><p> <a href="https://github.com/sweetying520/ChangeDefaultFontDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥çœ‹ Demo è·Ÿéšæˆ‘çš„æ€è·¯ä¸€èµ·åˆ†æ</p><h2 id="ä¸€ã€æ–¹å¼ä¸€ï¼šé€šè¿‡éå†-ViewTreeï¼Œå…¨å±€æ›¿æ¢å­—ä½“"><a href="#ä¸€ã€æ–¹å¼ä¸€ï¼šé€šè¿‡éå†-ViewTreeï¼Œå…¨å±€æ›¿æ¢å­—ä½“" class="headerlink" title="ä¸€ã€æ–¹å¼ä¸€ï¼šé€šè¿‡éå† ViewTreeï¼Œå…¨å±€æ›¿æ¢å­—ä½“"></a>ä¸€ã€æ–¹å¼ä¸€ï¼šé€šè¿‡éå† ViewTreeï¼Œå…¨å±€æ›¿æ¢å­—ä½“</h2><p>ä¹‹å‰æˆ‘è®²è¿‡ï¼šåœ¨ Android ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šç›´æ¥æˆ–é—´æ¥çš„é€šè¿‡ TextView æ§ä»¶å»æ‰¿è½½å­—ä½“çš„æ˜¾ç¤ºï¼Œå› ä¸ºå…³äº Android æä¾›çš„æ‰¿è½½å­—ä½“æ˜¾ç¤ºçš„æ§ä»¶éƒ½ä¼šç›´æ¥æˆ–é—´æ¥ç»§æ‰¿ TextViewã€‚ </p><p>é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªçªç ´å£ï¼š<strong>æˆ‘ä»¬å¯ä»¥åœ¨ Activity æˆ– Fragment çš„åŸºç±»é‡Œé¢è·å–å½“å‰å¸ƒå±€çš„ ViewTreeï¼Œéå† ViewTree ï¼Œè·å– TextView åŠå…¶å­ç±»ï¼Œæ‰¹é‡ä¿®æ”¹å®ƒä»¬çš„å­—ä½“ï¼Œä»è€Œè¾¾åˆ°å…¨å±€æ›¿æ¢å­—ä½“çš„æ•ˆæœã€‚</strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//å…¨å±€æ›¿æ¢å­—ä½“å·¥å…·ç±»</span><br><span class="hljs-keyword">object</span> ChangeDefaultFontUtils &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NOTO_SANS_BOLD = R.font.noto_sans_bold<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹å¼ä¸€: éå†å¸ƒå±€çš„ ViewTree, æ‰¾åˆ° TextView åŠå…¶å­ç±»è¿›è¡Œæ‰¹é‡æ›¿æ¢</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> mContext ä¸Šä¸‹æ–‡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> rootView æ ¹View</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">changeDefaultFont</span><span class="hljs-params">(mContext: <span class="hljs-type">Context</span>?, rootView: <span class="hljs-type">View</span>?)</span></span>&#123;<br>        <span class="hljs-keyword">when</span>(rootView)&#123;<br>            <span class="hljs-keyword">is</span> ViewGroup -&gt; &#123;<br>                rootView.forEach &#123;<br>                    changeDefaultFont(mContext,it)<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">is</span> TextView -&gt; &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">val</span> typeface = ResourcesCompat.getFont(mContext!!, NOTO_SANS_BOLD)<br>                    <span class="hljs-keyword">val</span> fontStyle = rootView.typeface?.style ?: Typeface.NORMAL<br>                    rootView.setTypeface(typeface,fontStyle)<br>                &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>                    e.printStackTrace()<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//Activity åŸºç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseActivity</span>: <span class="hljs-type">AppCompatActivity</span>()&#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        <span class="hljs-keyword">val</span> mRootView = LayoutInflater.from(<span class="hljs-keyword">this</span>).inflate(getLayoutId(), <span class="hljs-literal">null</span>)<br>        setContentView(mRootView)<br>        ChangeDefaultFontUtils.changeDefaultFont(<span class="hljs-keyword">this</span>,mRootView)<br>        initView()<br>    &#125;<br><br>    <span class="hljs-comment">/**è·å–å¸ƒå±€Id*/</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span><br><br>    <span class="hljs-comment">/**åˆå§‹åŒ–*/</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span><br>&#125;<br><br><span class="hljs-comment">//MainActivity</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">BaseActivity</span>() &#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>        <span class="hljs-keyword">return</span> R.layout.activity_main<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€æ›¿æ¢å­—ä½“çš„å·¥å…·ç±»ï¼Œä¸»è¦é€»è¾‘ï¼š</p><p>åˆ¤æ–­å½“å‰ rootView æ˜¯å¦æ˜¯ä¸€ä¸ª ViewGroupï¼Œå¦‚æœæ˜¯ï¼Œéå†å–å‡ºå…¶æ‰€æœ‰çš„å­ Viewï¼Œç„¶åé€’å½’è°ƒç”¨ changeDefaultFont æ–¹æ³•ã€‚å†åˆ¤æ–­æ˜¯å¦æ˜¯ TextView æˆ–å…¶å­ç±»ï¼Œå¦‚æœæ˜¯å°±æ›¿æ¢å­—ä½“</p><p>2ã€åˆ›å»ºäº†ä¸€ä¸ª Activity åŸºç±»ï¼Œå¹¶åœ¨å…¶ä¸­å†™å…¥å­—ä½“æ›¿æ¢çš„é€»è¾‘</p><p>3ã€æœ€åè®©ä¸Šå±‚ Activity ç»§æ‰¿åŸºç±» Activity</p><p>é€»è¾‘å¾ˆç®€å•ï¼Œåœ¨çœ‹ä¸‹æˆ‘ä»¬ç¼–å†™çš„ Xml çš„ä¸€ä¸ªæ•ˆæœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92b45198f4a6491f9be4eeb275ac4461~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616144417422"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿è¡Œçœ‹ä¸‹å®é™…æ›¿æ¢åçš„ä¸€ä¸ªæ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7879ac4a76214c1bad6841f20cd0bf04~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616144927196" style="zoom:50%;" /><p>å¯ä»¥çœ‹åˆ°ï¼Œå­—ä½“è¢«æ›¿æ¢äº†ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹è¿™ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼š</p><p><strong>ä¼˜ç‚¹</strong>ï¼šæˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹ Xml å¸ƒå±€ï¼Œä¸éœ€è¦é‡å†™å¤šä¸ªæ§ä»¶ï¼Œåªéœ€è¦åœ¨ <strong>inflate View</strong> ä¹‹åè°ƒä¸€ä¸‹å°±å¯ä»¥äº†</p><p><strong>ç¼ºç‚¹</strong>ï¼šä¸éš¾å‘ç°è¿™ç§æ–¹å¼ä¼šéå† Xml æ–‡ä»¶ä¸­çš„æ‰€æœ‰ View å’Œ ViewGroupï¼Œä½†æ˜¯å¦‚æœå‡ºç° RecyclerView , ListViewï¼Œæˆ–è€…å…¶ä»– ViewGroup é‡Œé¢åŠ¨æ€æ·»åŠ  Viewï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯éœ€è¦å»æ‰‹åŠ¨æ·»åŠ æ›¿æ¢çš„é€»è¾‘ï¼Œå¦åˆ™å­—ä½“ä¸ä¼šç”Ÿæ•ˆã€‚è€Œä¸”å®ƒæ¯æ¬¡é€’å½’éå† ViewTreeï¼Œæ€§èƒ½ä¸Šå¤šå°‘ä¼šæœ‰ç‚¹å½±å“</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ç¬¬äºŒç§æ–¹å¼</p><h2 id="äºŒã€æ–¹å¼äºŒï¼šé€šè¿‡-LayoutInflaterï¼Œå…¨å±€æ›¿æ¢å­—ä½“"><a href="#äºŒã€æ–¹å¼äºŒï¼šé€šè¿‡-LayoutInflaterï¼Œå…¨å±€æ›¿æ¢å­—ä½“" class="headerlink" title="äºŒã€æ–¹å¼äºŒï¼šé€šè¿‡ LayoutInflaterï¼Œå…¨å±€æ›¿æ¢å­—ä½“"></a>äºŒã€æ–¹å¼äºŒï¼šé€šè¿‡ LayoutInflaterï¼Œå…¨å±€æ›¿æ¢å­—ä½“</h2><p>è®²è¿™ç§æ–¹å¼å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹ LayoutInflater çš„ inflate è¿‡ç¨‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œä»¥ AppCompatActivity çš„ setContentView ä¸ºä¾‹å¤§è‡´è¯´ä¸‹æµç¨‹ï¼š</p><p><strong>æˆ‘ä»¬åœ¨ Activity çš„ setContentView ä¸­ä¼ å…¥ä¸€ä¸ªå¸ƒå±€ Xmlï¼ŒActivity ä¼šé€šè¿‡ä»£ç†ç±» AppCompatDelegateImpl æŠŠå®ƒäº¤ç”± LayoutInflater è¿›è¡Œè§£æï¼Œè§£æå‡ºæ¥åï¼Œä¼šäº¤ç”±è‡ªå·±çš„ 3 ä¸ªå·¥å‚å»åˆ›å»º Viewï¼Œä¼˜å…ˆçº§åˆ†åˆ«æ˜¯mFactory2ã€mFactoryã€mPrivateFactory</strong></p><p>æµç¨‹å¤§æ¦‚å°±è¯´åˆ°è¿™é‡Œï¼Œå…·ä½“è¿‡ç¨‹æˆ‘åç»­ä¼šå†™ä¸€ç¯‡æ–‡ç« ä¸“é—¨å»è®²ã€‚</p><p>mFactory2ã€mFactory ï¼Œç³»ç»Ÿæä¾›äº†å¼€æ”¾çš„ Api ç»™æˆ‘ä»¬å»è®¾ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•åœ¨ LayoutInflaterCompat.java æ–‡ä»¶ä¸­</span><br><span class="hljs-meta">@Deprecated</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFactory</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> LayoutInflater inflater, <span class="hljs-meta">@NonNull</span> LayoutInflaterFactory factory)</span> &#123;<br>    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="hljs-number">21</span>) &#123;<br>        inflater.setFactory2(factory != <span class="hljs-literal">null</span> ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">Factory2Wrapper</span>(factory) : <span class="hljs-literal">null</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">final</span> LayoutInflater.<span class="hljs-type">Factory2</span> <span class="hljs-variable">factory2</span> <span class="hljs-operator">=</span> factory != <span class="hljs-literal">null</span><br>                ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">Factory2Wrapper</span>(factory) : <span class="hljs-literal">null</span>;<br>        inflater.setFactory2(factory2);<br><br>        <span class="hljs-keyword">final</span> LayoutInflater.<span class="hljs-type">Factory</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> inflater.getFactory();<br>        <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> LayoutInflater.Factory2) &#123;<br>            forceSetFactory2(inflater, (LayoutInflater.Factory2) f);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            forceSetFactory2(inflater, factory2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFactory2</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> LayoutInflater inflater, <span class="hljs-meta">@NonNull</span> LayoutInflater.Factory2 factory)</span> &#123;<br>    inflater.setFactory2(factory);<br>  <br>    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &lt; <span class="hljs-number">21</span>) &#123;<br>        <span class="hljs-keyword">final</span> LayoutInflater.<span class="hljs-type">Factory</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> inflater.getFactory();<br>        <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> LayoutInflater.Factory2) &#123;<br>            forceSetFactory2(inflater, (LayoutInflater.Factory2) f);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            forceSetFactory2(inflater, factory);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨ LayoutInflaterCompat è¿™ä¸ªç±»ä¸­ï¼ŒLayoutInflaterCompat æ˜¯ LayoutInflater ä¸€ä¸ªè¾…åŠ©ç±»ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€setFactory æ–¹æ³•ä½¿ç”¨äº† @Deprecated æ³¨è§£è¡¨ç¤ºè¿™ä¸ª Api è¢«å¼ƒç”¨</p><p>2ã€setFactory2 æ˜¯ Android 3.0 å¼•å…¥çš„ï¼Œå®ƒå’Œ setFactory åŠŸèƒ½æ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«å°±åœ¨äºä¼ å…¥çš„æ¥å£å‚æ•°ä¸ä¸€æ ·ï¼ŒsetFactory2 çš„æ¥å£å‚æ•°è¦å¤šå®ç°ä¸€ä¸ªæ–¹æ³•</p><p>åˆ©ç”¨ setFactory ç³»åˆ—æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><p><strong>1ï¼‰ã€æ‹¿åˆ° LayoutInflater inflate è¿‡ç¨‹ä¸­ Xml æ§ä»¶å¯¹åº”çš„åç§°å’Œå±æ€§</strong></p><p><strong>2ï¼‰ã€æˆ‘ä»¬å¯ä»¥å¯¹æ§ä»¶è¿›è¡Œæ›¿æ¢æˆ–è€…åšç›¸å…³çš„é€»è¾‘å¤„ç†</strong></p><p>çœ‹ä¸ªå®é™…ä¾‹å­ï¼šè¿˜æ˜¯æ–¹å¼ä¸€çš„ä»£ç ï¼Œæˆ‘ä»¬åœ¨ BaseActivity ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//Activity åŸºç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseActivity</span>: <span class="hljs-type">AppCompatActivity</span>()&#123;<br><br>   <span class="hljs-comment">//æ–°å¢éƒ¨åˆ†</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> TAG: String? = javaClass.simpleName<br>  <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>      <span class="hljs-comment">//...</span><br>      <span class="hljs-comment">//æ–°å¢éƒ¨åˆ†ï¼Œå…¶ä½™ä»£ç çœç•¥</span><br>      LayoutInflaterCompat.setFactory2(layoutInflater,<span class="hljs-keyword">object</span> : LayoutInflater.Factory2&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(parent: <span class="hljs-type">View</span>?, name: <span class="hljs-type">String</span>, context: <span class="hljs-type">Context</span>, attrs: <span class="hljs-type">AttributeSet</span></span></span><br><span class="hljs-params"><span class="hljs-function">            )</span></span>: View? &#123;<br>                Log.d(TAG, <span class="hljs-string">&quot;name: <span class="hljs-variable">$name</span>&quot;</span> )<br>                <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until attrs.attributeCount)&#123;<br>                    Log.d(TAG, <span class="hljs-string">&quot;attr: <span class="hljs-subst">$&#123;attrs.getAttributeName(i)&#125;</span> <span class="hljs-subst">$&#123;attrs.getAttributeValue(i)&#125;</span>&quot;</span>)<br>                &#125;<br>              <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, context: <span class="hljs-type">Context</span>, attrs: <span class="hljs-type">AttributeSet</span>)</span></span>: View? &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>            &#125;<br><br>        &#125;)<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>       <span class="hljs-comment">//...</span><br>    &#125;<br><br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢ LayoutInflaterCompat.setFactory2 æ–¹æ³•å¿…é¡»æ”¾åœ¨ super.onCreate(savedInstanceState) çš„å‰é¢ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºç³»ç»Ÿä¼šåœ¨ AppCompatActivity çš„ oncreate æ–¹æ³•ç»™ LayoutInflater è®¾ç½®ä¸€ä¸ª Factoryï¼Œè€Œå¦‚æœåœ¨å·²ç»è®¾ç½®çš„æƒ…å†µä¸‹å†å»è®¾ç½®ï¼ŒLayoutInflater çš„ setFactory ç³»åˆ—æ–¹æ³•å°±ä¼šæŠ›å¼‚å¸¸ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//AppCompatActivity çš„ oncreate</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">AppCompatDelegate</span> <span class="hljs-variable">delegate</span> <span class="hljs-operator">=</span> getDelegate();<br>    <span class="hljs-comment">//è°ƒç”¨ AppCompatDelegateImpl çš„ installViewFactory è®¾ç½® Factory</span><br>    delegate.installViewFactory();<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//AppCompatDelegateImpl çš„ installViewFactory</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">installViewFactory</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">LayoutInflater</span> <span class="hljs-variable">layoutInflater</span> <span class="hljs-operator">=</span> LayoutInflater.from(mContext);<br>    <span class="hljs-keyword">if</span> (layoutInflater.getFactory() == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-comment">//å¦‚æœå½“å‰ LayoutInflater çš„ Factory ä¸ºç©ºï¼Œåˆ™è¿›è¡Œè®¾ç½®</span><br>        LayoutInflaterCompat.setFactory2(layoutInflater, <span class="hljs-built_in">this</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">//å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™è¿›è¡Œ Log æ—¥å¿—æ‰“å°</span><br>        <span class="hljs-keyword">if</span> (!(layoutInflater.getFactory2() <span class="hljs-keyword">instanceof</span> AppCompatDelegateImpl)) &#123;<br>            Log.i(TAG, <span class="hljs-string">&quot;The Activity&#x27;s LayoutInflater already has a Factory installed&quot;</span><br>                    + <span class="hljs-string">&quot; so we can not install AppCompat&#x27;s&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//LayoutInflater çš„ setFactory2</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFactory2</span><span class="hljs-params">(Factory2 factory)</span> &#123;<br>    <span class="hljs-comment">//å¦‚æœå·²ç»è®¾ç½®ï¼Œåˆ™æŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (mFactorySet) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;A factory has already been set on this LayoutInflater&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (factory == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(<span class="hljs-string">&quot;Given factory can not be null&quot;</span>);<br>    &#125;<br>    mFactorySet = <span class="hljs-literal">true</span>;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢ AppCompatActivity ä¸­è®¾ç½® Factory æ˜¯ android.appcompat  1.1.0 ç‰ˆæœ¬ï¼Œè€Œå¦‚æœæ˜¯æ›´é«˜çš„ç‰ˆæœ¬ï¼Œå¦‚ 1.3.0ï¼Œå¯èƒ½è®¾ç½®çš„åœ°æ–¹ä¼šæœ‰ç‚¹å˜åŒ–ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬è®¾ç½®ä½ç½®çš„å˜åŒ–ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹ä¸‹æºç ï¼Œè¿™é‡Œä½ åªè¦çŸ¥é“æˆ‘ä»¬å¿…é¡»åœ¨ Activity çš„ super.onCreate(savedInstanceState) ä¹‹å‰è®¾ç½® Factory å°±å¯ä»¥äº†</p><p>è¿è¡Œåº”ç”¨ç¨‹åºï¼Œçœ‹ä¸‹å‡ ä¸ªä¸»è¦æ§ä»¶çš„æˆªå›¾æ‰“å°ä¿¡æ¯ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d11def9507f94b05bfd95556137142ee~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616150016885" style="zoom:50%;" /><p>ä» Log è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œä½ æ‰€æœ‰çš„ Xml æ§ä»¶ï¼Œéƒ½ä¼šç»è¿‡ LayoutInflaterFactory.onCreateView æ–¹æ³•èµ°ä¸€éå»å®ç°åˆå§‹åŒ–çš„è¿‡ç¨‹ï¼Œåœ¨å…¶ä¸­å¯ä»¥æœ‰æ•ˆçš„åˆ†è¾¨å‡ºæ˜¯ä»€ä¹ˆæ§ä»¶ï¼Œä»¥åŠå®ƒæœ‰ä»€ä¹ˆå±æ€§ã€‚å¹¶ä¸” onCreateView æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯ä¸€ä¸ª Viewï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ­¤å¤„å¯ä»¥å¯¹æ§ä»¶è¿›è¡Œæ›¿æ¢æˆ–è€…åšç›¸å…³çš„é€»è¾‘å¤„ç†</p><p>åˆ°è¿™é‡Œï¼Œä½ æ˜¯å¦æœ‰äº†å…¨ä½“æ›¿æ¢å­—ä½“çš„æ€è·¯äº†å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆå·²ç»å¾ˆæ˜äº†ï¼š<strong>åˆ©ç”¨è‡ªå®šä¹‰çš„ Factory è¿›è¡Œå­—ä½“çš„æ›¿æ¢</strong></p><p>è¿™ç§æ–¹å¼æˆ‘ä»¬åªéœ€è¦åœ¨ BaseActivity é‡Œé¢æ“ä½œå°±å¯ä»¥äº†ï¼Œè€Œä¸”æœ‰æ•ˆçš„è§£å†³äº†æ–¹å¼ä¸€å¸¦æ¥çš„é—®é¢˜ï¼Œæé«˜äº†æ•ˆç‡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseActivity</span>: <span class="hljs-type">AppCompatActivity</span>()&#123;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        LayoutInflaterCompat.setFactory2(layoutInflater,<span class="hljs-keyword">object</span> : LayoutInflater.Factory2&#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(parent: <span class="hljs-type">View</span>?, name: <span class="hljs-type">String</span>, context: <span class="hljs-type">Context</span>, attrs: <span class="hljs-type">AttributeSet</span></span></span><br><span class="hljs-params"><span class="hljs-function">            )</span></span>: View? &#123;<br>                <span class="hljs-keyword">var</span> view: View? = <span class="hljs-literal">null</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span> == name.indexOf(<span class="hljs-string">&quot;.&quot;</span>))&#123;<br>                    <span class="hljs-comment">//è¡¨ç¤ºè‡ªå®šä¹‰ View</span><br>                    <span class="hljs-comment">//é€šè¿‡åå°„åˆ›å»º</span><br>                    view = layoutInflater.createView(name,<span class="hljs-literal">null</span>,attrs)<br>                &#125;<br><br>                <span class="hljs-keyword">if</span>(view == <span class="hljs-literal">null</span>)&#123;<br>                    <span class="hljs-comment">//é€šè¿‡ç³»ç»Ÿåˆ›å»ºä¸€ç³»åˆ— appcompat çš„ View</span><br>                    view = delegate.createView(parent, name, context, attrs)<br>                &#125;<br><br>                <span class="hljs-keyword">if</span>(view <span class="hljs-keyword">is</span> TextView)&#123;<br>                    <span class="hljs-comment">//å¦‚æœæ˜¯ TextView æˆ–å…¶å­ç±»ï¼Œåˆ™è¿›è¡Œå­—ä½“çš„æ›¿æ¢</span><br>                    ChangeDefaultFontUtils.changeDefaultFont(<span class="hljs-keyword">this</span><span class="hljs-symbol">@BaseActivity</span>,view)<br>                &#125;<br><br>                <span class="hljs-keyword">return</span> view<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, context: <span class="hljs-type">Context</span>, attrs: <span class="hljs-type">AttributeSet</span>)</span></span>: View? &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>            &#125;<br><br>        &#125;)<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(getLayoutId())<br>        initView()<br>    &#125;<br><br>    <span class="hljs-comment">/**è·å–å¸ƒå±€Id*/</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLayoutId</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span><br><br>    <span class="hljs-comment">/**åˆå§‹åŒ–*/</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬åšäº†ï¼š</p><p>1ã€åˆ¤æ–­æ˜¯è‡ªå®šä¹‰ View ï¼Œé€šè¿‡åå°„åˆ›å»º</p><p>2ã€åˆ¤æ–­æ˜¯ç³»ç»Ÿæä¾›çš„ä¸€äº›æ§ä»¶ï¼Œä½¿ç”¨ appcompat ç³»åˆ— View è¿›è¡Œæ›¿æ¢</p><p>3ã€åˆ¤æ–­æ˜¯ TextView æˆ–å…¶å­ç±»ï¼Œè¿›è¡Œå­—ä½“çš„æ›¿æ¢</p><p>è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆå®ç°äº†å’Œæ–¹å¼ä¸€ä¸€æ ·çš„æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f36137458d145c3a1847624f1db2c4b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616144927196" style="zoom:50%;" /><h2 id="ä¸‰ã€æ–¹å¼ä¸‰ï¼šé€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“"><a href="#ä¸‰ã€æ–¹å¼ä¸‰ï¼šé€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“" class="headerlink" title="ä¸‰ã€æ–¹å¼ä¸‰ï¼šé€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“"></a>ä¸‰ã€æ–¹å¼ä¸‰ï¼šé€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“</h2><p>è¿™ç§æ–¹å¼æŒºç®€å•çš„ï¼Œåœ¨ application ä¸­ï¼Œé€šè¿‡ android:theme æ¥é…ç½®ä¸€ä¸ª App çš„ä¸»é¢˜ã€‚ä¸€èˆ¬æ–°åˆ›å»ºçš„é¡¹ç›®ï¼Œéƒ½æ˜¯ä¼šæœ‰ä¸€ä¸ªé»˜è®¤åŸºç¡€ä¸»é¢˜ã€‚åœ¨å…¶ä¸­è¿½åŠ å…³äºå­—ä½“çš„å±æ€§ï¼Œå°±å¯ä»¥å®Œæˆå…¨å±€é»˜è®¤å­—ä½“çš„æ›¿æ¢ï¼Œåœ¨ä¸»é¢˜ä¸­æˆ‘ä»¬å¯ä»¥å¯¹ä»¥ä¸‹ä¸‰ä¸ªå±æ€§è¿›è¡Œé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:typeface&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:fontFamily&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:textStyle&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸‰è€…çš„è®¾ç½®å’Œå…³ç³»æˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»è®²è¿‡ï¼Œè¿˜ä¸æ¸…æ¥šçš„å¯ä»¥å»çœ‹ä¸‹ <a href="https://juejin.cn/post/6973064546420260878#heading-5">ä¼ é€é—¨</a></p><p>å…³äº Xml ä¸­ä½¿ç”¨å­—ä½“çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¸Šç¯‡æ–‡ç« ä¹Ÿå·²ç»è®²è¿‡ï¼Œè¿˜ä¸æ¸…æ¥šçš„å¯ä»¥å»çœ‹ä¸‹ <a href="https://juejin.cn/post/6974388756275019812">ä¼ é€é—¨</a></p><p>å› ä¸ºæˆ‘ä»¬åªéœ€è¦é…ç½®é»˜è®¤å­—ä½“ï¼Œæ‰€ä»¥æ–°å¢ä¸€è¡Œå¦‚ä¸‹é…ç½®ï¼Œå°±å¯ä»¥å®ç°å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“çš„æ•ˆæœäº†ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Theme.ChangeDefaultFontDemo&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;Theme.MaterialComponents.DayNight.DarkActionBar.Bridge&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">//...</span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:fontFamily&quot;</span>&gt;</span>@font/noto_sans_bold<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">  //...</span><br><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå‡¡äº‹éƒ½æœ‰æ„å¤–ï¼Œå‡å¦‚ä½ çš„ Activity å¼•ç”¨äº†è‡ªå®šä¹‰ä¸»é¢˜ï¼Œä¸”è‡ªå®šä¹‰ä¸»é¢˜æ²¡æœ‰ç»§æ‰¿åŸºç¡€ä¸»é¢˜ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦è¡¥ä¸Šè¿™ä¸€è¡Œé…ç½®ï¼Œä¸ç„¶é…ç½®çš„é»˜è®¤å­—ä½“ä¸ä¼šç”Ÿæ•ˆ</p><h2 id="å››ã€æ–¹å¼å››ï¼šé€šè¿‡åå°„ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“"><a href="#å››ã€æ–¹å¼å››ï¼šé€šè¿‡åå°„ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“" class="headerlink" title="å››ã€æ–¹å¼å››ï¼šé€šè¿‡åå°„ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“"></a>å››ã€æ–¹å¼å››ï¼šé€šè¿‡åå°„ï¼Œå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“</h2><p>é€šè¿‡åå°„ä¿®æ”¹ï¼Œå…¶å®å’Œæ–¹å¼ä¸‰æœ‰ç‚¹ç±»ä¼¼ã€‚å› ä¸ºåœ¨  Android Support Library 26 ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ Xml ä¸­è®¾ç½®ç¬¬ä¸‰æ–¹å­—ä½“ï¼Œè€Œåªèƒ½è®¾ç½®ç³»ç»Ÿæä¾›çš„ä¸€äº›é»˜è®¤å­—ä½“ï¼Œæ‰€ä»¥é€šè¿‡åå°„è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æŠŠç³»ç»Ÿé»˜è®¤çš„å­—ä½“æ›¿æ¢ä¸ºç¬¬ä¸‰æ–¹çš„å­—ä½“ã€‚è€Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨çš„ç‰ˆæœ¬åŸºæœ¬ä¸Šéƒ½ä¼šå¤§äºç­‰äº 26ï¼Œå› æ­¤é€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜çš„æ–¹å¼å°±å¯ä»¥å®ç°å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“çš„æ•ˆæœã€‚ä½†æ˜¯è¿™é‡Œå¹¶ä¸å¦¨ç¢æˆ‘ä»¬è®²åå°„ä¿®æ”¹é»˜è®¤å­—ä½“ã€‚</p><h3 id="1ã€æ­¥éª¤ä¸€ï¼šåœ¨-App-çš„ä¸»é¢˜é…ç½®é»˜è®¤å­—ä½“"><a href="#1ã€æ­¥éª¤ä¸€ï¼šåœ¨-App-çš„ä¸»é¢˜é…ç½®é»˜è®¤å­—ä½“" class="headerlink" title="1ã€æ­¥éª¤ä¸€ï¼šåœ¨  App çš„ä¸»é¢˜é…ç½®é»˜è®¤å­—ä½“"></a>1ã€æ­¥éª¤ä¸€ï¼šåœ¨  App çš„ä¸»é¢˜é…ç½®é»˜è®¤å­—ä½“</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Theme.ChangeDefaultFontDemo&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;Theme.MaterialComponents.DayNight.DarkActionBar.Bridge&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">//...</span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:typeface&quot;</span>&gt;</span>serif<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">  //...</span><br><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œéšä¾¿é€‰ä¸€ä¸ªé»˜è®¤å­—ä½“ï¼Œåç»­æˆ‘ä»¬åå°„çš„æ—¶å€™éœ€è¦æ‹¿åˆ°ä½ è¿™ä¸ªé€‰çš„é»˜è®¤å­—ä½“ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªæ›¿æ¢</p><p><strong>æ³¨æ„</strong>: è¿™é‡Œå¿…é¡»é…ç½® <strong>android:typeface</strong> ï¼Œå…¶ä»–ä¸¤ä¸ªä¸è¡Œï¼Œåœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ä¸­ï¼Œå…³äº typefaceï¼ŒtextStyle å’Œ fontFamily å±æ€§ä¸‰è€…çš„å…³ç³»æˆ‘ä»¬åˆ†æè¿‡ï¼Œè¿˜ä¸æ¸…æ¥šçš„å¯ä»¥å»çœ‹çœ‹ <a href="https://juejin.cn/post/6973064546420260878#heading-5">ä¼ é€é—¨</a>ï¼š</p><p>setTypefaceFromAttrs æ–¹æ³•æ˜¯ TextView æœ€ç»ˆè®¾ç½®å­—ä½“çš„æ–¹æ³•ï¼Œ<strong>å½“ typeface å’Œ familyName éƒ½ä¸ºç©ºï¼Œåˆ™ä¼šæ ¹æ® typefaceIndex çš„å€¼å–ç›¸åº”çš„ç³»ç»Ÿé»˜è®¤å­—ä½“</strong>ã€‚å½“æˆ‘ä»¬è®¾ç½®  <strong>android:typeface</strong>  å±æ€§æ—¶ï¼Œä¼šå°†å¯¹åº”çš„å±æ€§å€¼èµ‹ç»™ typefaceIndex ï¼Œå¹¶æŠŠ familyName ç½®ä¸º nullï¼Œè€Œ typeface é»˜è®¤ä¸º nullï¼Œå› æ­¤æ»¡è¶³æ¡ä»¶</p><h3 id="2ã€é€šè¿‡åå°„ä¿®æ”¹-Typeface-é»˜è®¤å­—ä½“"><a href="#2ã€é€šè¿‡åå°„ä¿®æ”¹-Typeface-é»˜è®¤å­—ä½“" class="headerlink" title="2ã€é€šè¿‡åå°„ä¿®æ”¹ Typeface é»˜è®¤å­—ä½“"></a>2ã€é€šè¿‡åå°„ä¿®æ”¹ Typeface é»˜è®¤å­—ä½“</h3><p><strong>æ³¨æ„</strong>ï¼šGoogle åœ¨ Android 9.0 åŠä¹‹åå¯¹åå°„åšäº†é™åˆ¶ï¼Œè¢«ä½¿ç”¨ <code>@hide</code> æ ‡è®°çš„å±æ€§å’Œæ–¹æ³•é€šè¿‡åå°„æ‹¿ä¸åˆ°</p><p>åœ¨ Typeface ä¸­ï¼Œè‡ªå¸¦çš„ä¸€äº›é»˜è®¤å­—ä½“è¢«æ ‡è®°çš„æ˜¯ <strong>public static final</strong>ï¼Œå› æ­¤è¿™é‡Œæ— éœ€æ‹…å¿ƒåå°„çš„é™åˆ¶</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae1c4453f9f94bc08754628b525bd687~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210618174439624"></p><p>å› ä¸ºåœ¨ä¸Šä¸€æ­¥é…ç½®çš„ä¸»é¢˜ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®çš„æ˜¯ serif ï¼Œæ‰€ä»¥è¿™é‡Œæ›¿æ¢å®ƒå°±å¥½äº†ï¼Œå®Œæ•´çš„æ–¹æ³•å°±æ˜¯é€šè¿‡åå°„æ‹¿åˆ° Typeface çš„é»˜è®¤å­—ä½“ SERIFï¼Œç„¶åä½¿ç”¨åå°„å°†å®ƒä¿®æ”¹æˆæˆ‘ä»¬éœ€è¦çš„å­—ä½“å³å¯ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> ChangeDefaultFontUtils &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NOTO_SANS_BOLD = R.font.noto_sans_bold<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">changeDefaultFont</span><span class="hljs-params">(mContext: <span class="hljs-type">Context</span>)</span></span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">val</span> typeface = ResourcesCompat.getFont(mContext, NOTO_SANS_BOLD)<br>            <span class="hljs-keyword">val</span> defaultField = Typeface::<span class="hljs-keyword">class</span>.java.getDeclaredField(<span class="hljs-string">&quot;SERIF&quot;</span>)<br>            defaultField.isAccessible = <span class="hljs-literal">true</span><br>            defaultField[<span class="hljs-literal">null</span>] = typeface<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€åœ¨-Application-é‡Œé¢ï¼Œè°ƒç”¨æ›¿æ¢çš„æ–¹æ³•"><a href="#3ã€åœ¨-Application-é‡Œé¢ï¼Œè°ƒç”¨æ›¿æ¢çš„æ–¹æ³•" class="headerlink" title="3ã€åœ¨ Application é‡Œé¢ï¼Œè°ƒç”¨æ›¿æ¢çš„æ–¹æ³•"></a>3ã€åœ¨ Application é‡Œé¢ï¼Œè°ƒç”¨æ›¿æ¢çš„æ–¹æ³•</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() &#123;<br>    <br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate()<br>        ChangeDefaultFontUtils.changeDefaultFont(<span class="hljs-keyword">this</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆç»è¿‡ä¸Šé¢çš„ä¸‰ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å®ç°å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“çš„æ•ˆæœ</p><h2 id="äº”ã€é¡¹ç›®å®è·µ"><a href="#äº”ã€é¡¹ç›®å®è·µ" class="headerlink" title="äº”ã€é¡¹ç›®å®è·µ"></a>äº”ã€é¡¹ç›®å®è·µ</h2><p>å›åˆ°æˆ‘ä»¬å‰©ä¸‹çš„éœ€æ±‚ï¼š<strong>å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“</strong></p><p>1ã€æ–¹å¼ä¸€å’Œæ–¹å¼äºŒéƒ½æ˜¯å…¨å±€æ›¿æ¢å­—ä½“ï¼Œä¼šå°†æˆ‘ä»¬ä¹‹å‰å·²ç»è®¾ç½®å¥½çš„å­—ä½“ç»™è¦†ç›–ï¼Œå› æ­¤å¹¶ä¸é€‚åˆ</p><p>2ã€æ–¹å¼ä¸‰å’Œæ–¹å¼å››éƒ½æ˜¯å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»è®¾ç½®å¥½çš„å­—ä½“ä¸ä¼šè¢«è¦†ç›–ï¼Œæ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼Œä½†æ˜¯æ–¹å¼å››é€šè¿‡åå°„ï¼Œæ˜¯å› ä¸ºä¹‹å‰æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ Xml é‡Œé¢è®¾ç½®ç¬¬ä¸‰æ–¹å­—ä½“ã€‚ä» Android Support Library 26 åŠä¹‹åæ”¯æŒåœ¨ Xml é‡Œé¢è®¾ç½®é»˜è®¤å­—ä½“äº†ï¼Œå› æ­¤æˆ‘åœ¨é¡¹ç›®å®è·µä¸­ï¼Œæœ€ç»ˆé€‰æ‹©äº†æ–¹å¼ä¸‰å®ç°äº†å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“çš„æ•ˆæœï¼Œéœ€æ±‚å®Œç»“ ğŸ‰</p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ€åå›é¡¾ä¸€ä¸‹æˆ‘ä»¬è®²çš„é‡ç‚¹çŸ¥è¯†ï¼š</p><p>1ã€é€šè¿‡éå† ViewTreeï¼Œå…¨å±€æ›¿æ¢å­—ä½“ï¼Œè¿™ç§æ–¹å¼æ¯æ¬¡éƒ½éœ€è¦é€’å½’éå†ï¼Œæœ‰æ€§èƒ½é—®é¢˜</p><p>2ã€é€šè¿‡ LayoutInflater è®¾ç½®è‡ªå®šä¹‰ Factory å…¨å±€æ›¿æ¢å­—ä½“ï¼Œæ•ˆç‡é«˜</p><p>3ã€é€šè¿‡é…ç½®åº”ç”¨ä¸»é¢˜å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“ï¼Œç®€å•é«˜æ•ˆ</p><p>4ã€é€šè¿‡åå°„å…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“ï¼Œç›¸å¯¹äº 3ï¼Œæ€§èƒ½ä¼šå·®ç‚¹ï¼Œä½¿ç”¨æ­¥éª¤ä¹Ÿç›¸å¯¹å¤æ‚</p><p>5ã€æˆ‘åœ¨é¡¹ç›®å®è·µè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé€‰æ‹©</p><p>å¥½äº†ï¼Œæœ¬ç³»åˆ—æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://segmentfault.com/a/1190000011401796">å…¨å±€ä¿®æ”¹é»˜è®¤å­—ä½“ï¼Œé€šè¿‡åå°„ä¹Ÿèƒ½åšåˆ°</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Font</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android Font</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå­—ä½“ç³»åˆ— ï¼ˆä¸‰ï¼‰ï¼šXmlä¸­çš„å­—ä½“</title>
    <link href="/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AXml%E4%B8%AD%E7%9A%84%E5%AD%97%E4%BD%93/"/>
    <url>/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AXml%E4%B8%AD%E7%9A%84%E5%AD%97%E4%BD%93/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/36399f41828345aeab208b30e8556362~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹ Typeface è¿›è¡Œäº†æ·±å…¥çš„è§£æï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6973553157326503943">Androidå­—ä½“ç³»åˆ— ï¼ˆäºŒï¼‰ï¼šTypefaceå®Œå…¨è§£æ</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹ Google æ¨å‡ºçš„ Xml ä¸­ä½¿ç”¨å­—ä½“</p><h2 id="ä¸€ã€Xml-ä¸­å­—ä½“ä»‹ç»"><a href="#ä¸€ã€Xml-ä¸­å­—ä½“ä»‹ç»" class="headerlink" title="ä¸€ã€Xml ä¸­å­—ä½“ä»‹ç»"></a>ä¸€ã€Xml ä¸­å­—ä½“ä»‹ç»</h2><p>Google åœ¨ Android Support Library 26 å¼•å…¥äº† Xml ä¸­è®¾ç½®å­—ä½“è¿™é¡¹æ–°åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®©ä½ å°†å­—ä½“å½“æˆèµ„æºå»ä½¿ç”¨ï¼Œä½ å¯ä»¥åœ¨ res&#x2F;font&#x2F; æ–‡ä»¶å¤¹ä¸­æ·»åŠ  font æ–‡ä»¶ï¼Œå°†å­—ä½“æ†ç»‘ä¸ºèµ„æºã€‚è¿™äº›å­—ä½“ä¼šåœ¨ R æ–‡ä»¶ä¸­ç¼–è¯‘ï¼Œå¯ç›´æ¥åœ¨ Android Studio ä¸­ä½¿ç”¨ï¼Œå¦‚:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">@font/myfont <br>R.font.myfont<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šè¦ä½¿ç”¨ Xml å­—ä½“åŠŸèƒ½ï¼Œéœ€å¼•å…¥ Android Support Library 26 åŠæ›´é«˜ç‰ˆæœ¬ä¸”è¦åœ¨ Android 4.1 åŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡</p><h2 id="äºŒã€ä½¿ç”¨æ­¥éª¤"><a href="#äºŒã€ä½¿ç”¨æ­¥éª¤" class="headerlink" title="äºŒã€ä½¿ç”¨æ­¥éª¤"></a>äºŒã€ä½¿ç”¨æ­¥éª¤</h2><p>1ã€å³é”®ç‚¹å‡» <strong>res</strong> æ–‡ä»¶å¤¹ï¼Œç„¶åè½¬åˆ° <strong>New &gt; Android resource directory</strong></p><p>2ã€åœ¨ <strong>Resource type</strong> åˆ—è¡¨ä¸­ï¼Œé€‰æ‹© <strong>font</strong>ï¼Œç„¶åç‚¹å‡» <strong>OK</strong></p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd62460948db4b58890928b39f79f5d1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616203615018" style="zoom:50%;" /><p>3ã€åœ¨ <strong>font</strong> æ–‡ä»¶å¤¹ä¸­æ·»åŠ å­—ä½“æ–‡ä»¶</p><blockquote><p>å…³äºå­—ä½“ï¼Œæ¨èä¸¤ä¸ªå…è´¹ä¸‹è½½çš„ç½‘ç«™</p><p><a href="https://fonts.google.com/">https://fonts.google.com/</a></p><p><a href="https://www.1001freefonts.com/">https://www.1001freefonts.com/</a></p></blockquote><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/569d3b8d750e4d3ebf07598940d2523f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616203940427" style="zoom:50%;" /><p>æ·»åŠ ä¹‹åå°±ä¼šç”Ÿæˆ R.font.ma_shan_zhenng_regular å’Œ R.font.noto_sans_bold</p><p>4ã€åŒå‡»å­—ä½“æ–‡ä»¶å¯é¢„è§ˆå½“å‰å­—ä½“</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5da14193f7c94277a54a15e39832c291~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616204148155"></p><p>ä»¥ä¸Š 4 ä¸ªæ­¥éª¤å®Œæˆåæˆ‘ä»¬å°±å¯ä»¥åœ¨ Xml ä¸­ä½¿ç”¨å­—ä½“äº†</p><p>5ã€åˆ›å»º font family</p><p>1ï¼‰ã€å³é”®ç‚¹å‡» font æ–‡ä»¶å¤¹ï¼Œç„¶åè½¬åˆ° <strong>New &gt; Font resource file</strong>ã€‚æ­¤æ—¶å°†æ˜¾ç¤º <strong>New Resource File</strong> çª—å£ã€‚</p><p>2ï¼‰ã€è¾“å…¥æ–‡ä»¶åï¼Œç„¶åç‚¹å‡» <strong>OK</strong>ã€‚æ–°çš„å­—ä½“èµ„æº Xml ä¼šåœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ã€‚</p><p>3ï¼‰ã€å°†å„ä¸ªå­—ä½“æ–‡ä»¶ã€æ ·å¼å’Œç²—ç»†å±æ€§éƒ½å°è£…åœ¨ <code>&lt;font&gt;</code> å…ƒç´ ä¸­ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">font-family</span> <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;UnusedAttribute&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">font</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:fontStyle</span>=<span class="hljs-string">&quot;normal&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:fontWeight</span>=<span class="hljs-string">&quot;400&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:font</span>=<span class="hljs-string">&quot;@font/ma_shan_zheng_regular&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;UnusedAttribute&quot;</span> /&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">font</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:fontStyle</span>=<span class="hljs-string">&quot;normal&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:fontWeight</span>=<span class="hljs-string">&quot;400&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:font</span>=<span class="hljs-string">&quot;@font/noto_sans_bold&quot;</span></span><br><span class="hljs-tag">         /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">font-family</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å®è·µå‘ç°ä½¿ç”¨ font family å­˜åœ¨ä¸€äº›å‘ï¼š</p><p>1ã€ä¾‹å¦‚æˆ‘ä¸Šé¢æ·»åŠ äº†ä¸¤ä¸ª font æ ‡ç­¾ï¼Œè¿™ä¸ªæ—¶å€™åœ¨ Xml é‡Œé¢å¼•ç”¨å°†ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœï¼Œè€Œä¸”è®¾ç½®çš„ fontStyle ç­‰å±æ€§ä¸ä¼šç”Ÿæ•ˆã€‚</p><p>2ã€å½“åªæ·»åŠ äº†ä¸€ä¸ª font æ ‡ç­¾ï¼Œæ­¤æ—¶å­—ä½“ä¼šç”Ÿæ•ˆï¼Œä½†æ˜¯è®¾ç½®çš„ fontStyle ç­‰å±æ€§è¿˜æ˜¯ä¸ä¼šç”Ÿæ•ˆ</p><p>å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™å»ºè®®ç›´æ¥å¯¹å­—ä½“èµ„æºè¿›è¡Œå¼•ç”¨ï¼Œæ ·å¼ç²—ç»†è¿™äº›åœ¨è¿›è¡Œå•ç‹¬çš„è®¾ç½®</p><h2 id="ä¸‰ã€åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“"><a href="#ä¸‰ã€åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“" class="headerlink" title="ä¸‰ã€åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“"></a>ä¸‰ã€åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“</h2><p>ç›´æ¥åœ¨å¸ƒå±€ Xml ä¸­ä½¿ç”¨ fontFamily å±æ€§è¿›è¡Œå¼•ç”¨ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81fe6df932464ebaa318c945c2cf8a82~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616205129045"></p><h2 id="å››ã€åœ¨æ ·å¼ä¸­æ·»åŠ å¹¶ä½¿ç”¨å­—ä½“"><a href="#å››ã€åœ¨æ ·å¼ä¸­æ·»åŠ å¹¶ä½¿ç”¨å­—ä½“" class="headerlink" title="å››ã€åœ¨æ ·å¼ä¸­æ·»åŠ å¹¶ä½¿ç”¨å­—ä½“"></a>å››ã€åœ¨æ ·å¼ä¸­æ·»åŠ å¹¶ä½¿ç”¨å­—ä½“</h2><p>1ã€åœ¨ style.xml ä¸­æ·»åŠ æ ·å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;customfontstyle&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;Theme.ChangeDefaultFontDemo&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:fontFamily&quot;</span>&gt;</span>@font/noto_sans_bold<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€åœ¨å¸ƒå±€ Xml ä¸­ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/294f76797cd44994a3a753eb7327c6ae~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210616205611588"></p><h2 id="äº”ã€åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ä½“"><a href="#äº”ã€åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ä½“" class="headerlink" title="äº”ã€åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ä½“"></a>äº”ã€åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ä½“</h2><p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ResourcesCompat æˆ– Resource çš„ gontFont æ–¹æ³•æ‹¿åˆ° Typeface å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ç›¸å…³çš„ Api å»è®¾ç½®å°±è¡Œäº†ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æ–¹å¼1</span><br><span class="hljs-keyword">val</span> typeface = ResourcesCompat.getFont(context, R.font.myfont)<br><span class="hljs-comment">//æ–¹å¼2</span><br><span class="hljs-keyword">val</span> typeface = resources.getFont(R.font.myfont)<br><span class="hljs-comment">//è®¾ç½®å­—ä½“</span><br>textView.typeface = typeface<br></code></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œåˆç†çš„å°è£…ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> FontUtil &#123;<br><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NOTO_SANS_BOLD = R.font.noto_sans_bold<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> MA_SHAN_ZHENG_REGULAR = R.font.ma_shan_zheng_regular<br><br>    <span class="hljs-comment">/**ç¼“å­˜å­—ä½“ Map*/</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> cacheTypeFaceMap: HashMap&lt;<span class="hljs-built_in">Int</span>,Typeface&gt; = HashMap()<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¾ç½® NotoSanUIBold å­—ä½“</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setNotoSanUIBold</span><span class="hljs-params">(mTextView: <span class="hljs-type">TextView</span>)</span></span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mTextView.typeface = getTypeface(NOTO_SANS_BOLD)<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¾ç½® MaShanZhengRegular å­—ä½“</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setMaShanZhengRegular</span><span class="hljs-params">(mTextView: <span class="hljs-type">TextView</span>)</span></span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mTextView.typeface = getTypeface(MA_SHAN_ZHENG_REGULAR)<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å­—ä½“ Typeface å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getTypeface</span><span class="hljs-params">(fontResName: <span class="hljs-type">Int</span>)</span></span>: Typeface? &#123;<br>        <span class="hljs-keyword">val</span> cacheTypeface = cacheTypeFaceMap[fontResName]<br>        <span class="hljs-keyword">if</span> (cacheTypeface != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> cacheTypeface<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">val</span> typeface: Typeface? = ResourcesCompat.getFont(MyApplication.mApplication, fontResName)<br>            cacheTypeFaceMap[fontResName] = typeface!!<br>            typeface<br>        &#125; <span class="hljs-keyword">catch</span> (e: Exception) &#123;<br>            e.printStackTrace()<br>            Typeface.DEFAULT<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆåç»­æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ä½“ï¼Œå°±åªéœ€è°ƒä¸€è¡Œä»£ç å°± Ok äº†</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">FontUtil.setMaShanZhengRegular(mTextView1)<br>FontUtil.setNotoSanUIBold(mTextView2)<br></code></pre></td></tr></table></figure><h2 id="å…­ã€é¡¹ç›®éœ€æ±‚å®è·µ"><a href="#å…­ã€é¡¹ç›®éœ€æ±‚å®è·µ" class="headerlink" title="å…­ã€é¡¹ç›®éœ€æ±‚å®è·µ"></a>å…­ã€é¡¹ç›®éœ€æ±‚å®è·µ</h2><p>å›é¡¾ä¸€ä¸‹æˆ‘æ¥åˆ°çš„é¡¹ç›®éœ€æ±‚ï¼š<strong>å…¨å±€æ›¿æ¢å½“å‰é¡¹ç›®ä¸­çš„é»˜è®¤å­—ä½“ï¼Œå¹¶å¼•å…¥ UI è®¾è®¡å¸ˆæä¾›çš„ä¸€äº›æ–°å­—ä½“</strong></p><p>åœ¨å­¦ä¹ æœ¬ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘ä»¬å¼•å…¥å­—ä½“éƒ½æ˜¯æ”¾åœ¨ assets æ–‡ä»¶ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„å­—ä½“æ–‡ä»¶ï¼Œæˆ‘ä»¬åªèƒ½åœ¨ä»£ç ä¸­è·å–å¹¶ä½¿ç”¨ã€‚é‚£ä¹ˆé€šè¿‡æœ¬ç¯‡æ–‡ç« çš„è®²è§£ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥åœ¨ä»£ç ä¸­è¿›è¡Œä½¿ç”¨ï¼Œè¿˜å¯ä»¥åœ¨ Xml ä¸­è¿›è¡Œä½¿ç”¨ã€‚ç°åœ¨æˆ‘ä»¬è§£å†³äº†ä¸€åŠçš„éœ€æ±‚ï¼Œå…³äºå…¨å±€æ›¿æ¢é»˜è®¤å­—ä½“è¿˜éœ€ç­‰åˆ°ä¸‹ä¸€ç¯‡æ–‡ç« ğŸ˜„</p><h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><p>å›é¡¾ä¸‹æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€å°†å­—ä½“æ”¾åœ¨ res çš„ font ç›®å½•ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ Xml ä¸­ä½¿ç”¨å­—ä½“äº†</p><p>2ã€é€šè¿‡å­—ä½“ R èµ„æºç´¢å¼•è·å–å­—ä½“æ–‡ä»¶ï¼Œå°è£…ç›¸åº”çš„å­—ä½“å·¥å…·ç±»ï¼Œåœ¨ä»£ç ä¸­ä¼˜é›…çš„ä½¿ç”¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><a href="https://github.com/sweetying520/ChangeDefaultFontDemo">Github Demo åœ°å€</a></p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®² Android å…¨å±€æ›¿æ¢å­—ä½“çš„å‡ ç§æ–¹å¼ï¼Œæ•¬è¯·æœŸå¾…å§ ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://developer.android.com/guide/topics/ui/look-and-feel/fonts-in-xml#kotlin">XML ä¸­çš„å­—ä½“</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Font</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android Font</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå­—ä½“ç³»åˆ— ï¼ˆäºŒï¼‰ï¼šTypefaceå®Œå…¨è§£æ</title>
    <link href="/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9ATypeface%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9ATypeface%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdb4cdd562d9482db27894476dea9ac9~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å…³äº Android å­—ä½“çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6973064546420260878">Androidå­—ä½“ç³»åˆ— ï¼ˆä¸€ï¼‰ï¼šAndroidå­—ä½“åŸºç¡€</a>ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬è®¾ç½®çš„é‚£ä¸‰ä¸ªå±æ€§æœ€ç»ˆéƒ½ä¼šå»æ„å»ºä¸€ä¸ª Typeface å¯¹è±¡ï¼Œä»Šå¤©æˆ‘ä»¬å°±å¥½å¥½çš„æ¥è®²è®²å®ƒ</p><p><strong>æ³¨æ„ï¼šæœ¬æ–‡æ‰€å±•ç¤ºçš„ç³»ç»Ÿæºç éƒ½æ˜¯åŸºäºAndroid-30 ï¼Œå¹¶æå–æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œåˆ†æ</strong></p><h2 id="ä¸€ã€Typeface-ä»‹ç»"><a href="#ä¸€ã€Typeface-ä»‹ç»" class="headerlink" title="ä¸€ã€Typeface ä»‹ç»"></a>ä¸€ã€Typeface ä»‹ç»</h2><p><strong>Typeface è´Ÿè´£ Android å­—ä½“çš„åŠ è½½ä»¥åŠå¯¹ä¸Šå±‚æä¾›ç›¸å…³å­—ä½“ API çš„è°ƒç”¨</strong></p><p>å¦‚æœä½ æƒ³è¦æ“ä½œå­—ä½“ï¼Œæ— è®ºæ˜¯ä½¿ç”¨ Android ç³»ç»Ÿè‡ªå¸¦çš„å­—ä½“ï¼Œè¿˜æ˜¯åŠ è½½è‡ªå·±å†…ç½®çš„ .ttf(TureType) æˆ–è€… .otf(OpenType) æ ¼å¼çš„å­—ä½“æ–‡ä»¶ï¼Œä½ éƒ½éœ€è¦ä½¿ç”¨åˆ° Typeface è¿™ä¸ªç±»ã€‚å› æ­¤æˆ‘ä»¬è¦å…¨å±€ä¿®æ”¹å­—ä½“ï¼Œé¦–å…ˆå°±è¦æŠŠ Typeface ç»™å¼„æ˜ç™½</p><h2 id="äºŒã€Typeface-æºç åˆ†æ"><a href="#äºŒã€Typeface-æºç åˆ†æ" class="headerlink" title="äºŒã€Typeface æºç åˆ†æ"></a>äºŒã€Typeface æºç åˆ†æ</h2><p>æºç åˆ†æç¯èŠ‚å¯èƒ½æ¯”è¾ƒæ¯ç‡¥ï¼ŒåšæŒå°±æ˜¯èƒœåˆ© â›½ï¸</p><h3 id="1ã€Typeface-åˆå§‹åŒ–"><a href="#1ã€Typeface-åˆå§‹åŒ–" class="headerlink" title="1ã€Typeface åˆå§‹åŒ–"></a>1ã€Typeface åˆå§‹åŒ–</h3><p>Typeface è¿™ä¸ªç±»ä¼šåœ¨ Android åº”ç”¨ç¨‹åºå¯åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡åå°„çš„æ–¹å¼è¢«åŠ è½½ã€‚ç‚¹å‡»æºç å¯ä»¥çœ‹åˆ°å®ƒé‡Œé¢æœ‰ä¸€ä¸ª static ä»£ç å—ï¼Œå®ƒä¼šéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼Œå¹¶ä¸”åªä¼šåŠ è½½ä¸€æ¬¡ï¼ŒTypeface å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¥è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå­˜æ”¾å­—ä½“çš„ Map</span><br>    <span class="hljs-keyword">final</span> HashMap&lt;String, Typeface&gt; systemFontMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    <span class="hljs-comment">//å°†ç³»ç»Ÿçš„ä¸€äº›é»˜è®¤å­—ä½“æ”¾å…¥ Map ä¸­</span><br>    initSystemDefaultTypefaces(systemFontMap,SystemFonts.getRawSystemFallbackMap(),SystemFonts.getAliases());<br>    <span class="hljs-comment">//unmodifiableMap æ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°†å½“å‰ Map è¿›è¡ŒåŒ…è£…ï¼Œè¿”å›ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„Mapï¼Œå¦‚æœè°ƒç”¨ä¿®æ”¹æ–¹æ³•å°±ä¼šæŠ›å¼‚å¸¸</span><br>  sSystemFontMap = Collections.unmodifiableMap(systemFontMap);<br><br>    <span class="hljs-comment">// We can&#x27;t assume DEFAULT_FAMILY available on Roboletric.</span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¾ç½®ç³»ç»Ÿé»˜è®¤å­—ä½“  DEFAULT_FAMILY = &quot;sans-serif&quot;;</span><br><span class="hljs-comment">     * å› æ­¤ç³»ç»Ÿé»˜è®¤çš„å­—ä½“å°±æ˜¯ sans-serif</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">if</span> (sSystemFontMap.containsKey(DEFAULT_FAMILY)) &#123;<br>        setDefault(sSystemFontMap.get(DEFAULT_FAMILY));<br>    &#125;<br><br>    <span class="hljs-comment">// Set up defaults and typefaces exposed in public API</span><br>    <span class="hljs-comment">//ä¸€äº›ç³»ç»Ÿé»˜è®¤çš„å­—ä½“</span><br>    DEFAULT         = create((String) <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>);<br>    DEFAULT_BOLD    = create((String) <span class="hljs-literal">null</span>, Typeface.BOLD);<br>    SANS_SERIF      = create(<span class="hljs-string">&quot;sans-serif&quot;</span>, <span class="hljs-number">0</span>);<br>    SERIF           = create(<span class="hljs-string">&quot;serif&quot;</span>, <span class="hljs-number">0</span>);<br>    MONOSPACE       = create(<span class="hljs-string">&quot;monospace&quot;</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ª sDefaults æ•°ç»„ï¼Œå¹¶é¢„åŠ è½½å¥½ç²—ä½“ã€æ–œä½“ç­‰ä¸€äº›å¸¸ç”¨çš„ Style</span><br>    sDefaults = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Typeface</span>[] &#123;<br>        DEFAULT,<br>        DEFAULT_BOLD,<br>        create((String) <span class="hljs-literal">null</span>, Typeface.ITALIC),<br>        create((String) <span class="hljs-literal">null</span>, Typeface.BOLD_ITALIC),<br>    &#125;;<br><br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å†™äº†è¯¦ç»†çš„æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒTypeface åˆå§‹åŒ–ä¸»è¦åšäº†ï¼š</p><p>1ã€å°†ç³»ç»Ÿçš„ä¸€äº›é»˜è®¤å­—ä½“æ”¾å…¥ä¸€ä¸ª Map ä¸­</p><p>2ã€è®¾ç½®é»˜è®¤çš„å­—ä½“</p><p>3ã€åˆå§‹åŒ–ä¸€äº›é»˜è®¤å­—ä½“</p><p>4ã€åˆå§‹åŒ–ä¸€ä¸ª sDefaults æ•°ç»„ï¼Œå­˜æ”¾ä¸€äº›å¸¸ç”¨çš„ Style</p><p>å®Œæˆäº† Typeface çš„åˆå§‹åŒ–ï¼Œæ¥ä¸‹æ¥çœ‹ Typeface æä¾›äº†ä¸€ç³»åˆ—åˆ›å»ºå­—ä½“çš„ API ï¼Œå…¶ä¸­å¯¹ä¸Šå±‚å¼€æ”¾è°ƒç”¨çš„æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/837f18d801a1409fa99f4e3ba024f981~tplv-k3u1fbpfcp-watermark.image" alt="image-20210614130149262.png"></p><p>ä¸‹é¢æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æè¿™å‡ ä¸ªæ–¹æ³•</p><h3 id="2ã€é€šè¿‡-Typeface-å’Œ-Style-è·å–æ–°çš„-Typeface"><a href="#2ã€é€šè¿‡-Typeface-å’Œ-Style-è·å–æ–°çš„-Typeface" class="headerlink" title="2ã€é€šè¿‡ Typeface å’Œ Style è·å–æ–°çš„ Typeface"></a>2ã€é€šè¿‡ Typeface å’Œ Style è·å–æ–°çš„ Typeface</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬ä¸€ä¸ª API , çœ‹ä¸‹å®ƒçš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">create</span><span class="hljs-params">(Typeface family, <span class="hljs-meta">@Style</span> <span class="hljs-type">int</span> style)</span> &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­å½“å‰æ˜¯å¦è®¾ç½®äº† style , å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œç½®ä¸º NORMAL</span><br>    <span class="hljs-keyword">if</span> ((style &amp; ~STYLE_MASK) != <span class="hljs-number">0</span>) &#123;<br>        style = NORMAL;<br>    &#125;<br>    <span class="hljs-comment">//åˆ¤æ–­å½“å‰ä¼ å…¥çš„ Typeface æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæ˜¯ï¼Œç½®ä¸ºé»˜è®¤å­—ä½“</span><br>    <span class="hljs-keyword">if</span> (family == <span class="hljs-literal">null</span>) &#123;<br>        family = sDefaultTypeface;<br>    &#125;<br><br>    <span class="hljs-comment">// Return early if we&#x27;re asked for the same face/style</span><br>    <span class="hljs-comment">//å¦‚æœå½“å‰ Typeface çš„ mStyle å±æ€§å’Œä¼ å…¥çš„ style ç›¸åŒï¼Œç›´æ¥è¿”å› Typeface å¯¹è±¡</span><br>    <span class="hljs-keyword">if</span> (family.mStyle == style) &#123;<br>        <span class="hljs-keyword">return</span> family;<br>    &#125;<br><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">ni</span> <span class="hljs-operator">=</span> family.native_instance;<br><br>    Typeface typeface;<br>    <span class="hljs-comment">//ä½¿ç”¨ sStyledCacheLock ä¿è¯çº¿ç¨‹å®‰å…¨</span><br>    <span class="hljs-keyword">synchronized</span> (sStyledCacheLock) &#123;<br>      <span class="hljs-comment">//ä»ç¼“å­˜ä¸­è·å–å­˜æ”¾ Typeface çš„ SparseArray</span><br>        SparseArray&lt;Typeface&gt; styles = sStyledTypefaceCache.get(ni);<br>        <span class="hljs-keyword">if</span> (styles == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">//å­˜æ”¾ Typeface çš„ SparseArray ä¸ºç©ºï¼Œæ–°åˆ›å»ºä¸€ä¸ªï¼Œå®¹é‡ä¸º 4</span><br>            styles = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparseArray</span>&lt;Typeface&gt;(<span class="hljs-number">4</span>);<br>            <span class="hljs-comment">//å°†å½“å‰ å­˜æ”¾ Typeface çš„ SparseArray æ”¾å…¥ç¼“å­˜ä¸­</span><br>            sStyledTypefaceCache.put(ni, styles);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//å­˜æ”¾ Typeface çš„ SparseArray ä¸ä¸ºç©ºï¼Œç›´æ¥è·å– Typeface å¹¶è¿”å›</span><br>            typeface = styles.get(style);<br>            <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> typeface;<br>            &#125;<br>        &#125;<br><br>      <span class="hljs-comment">//é€šè¿‡ native å±‚æ„å»ºåˆ›å»º Typeface çš„å‚æ•°å¹¶åˆ›å»º Typeface å¯¹è±¡</span><br>        typeface = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Typeface</span>(nativeCreateFromTypeface(ni, style));<br>      <span class="hljs-comment">//å°†æ–°åˆ›å»ºçš„  Typeface å¯¹è±¡æ”¾å…¥ SparseArray ä¸­ç¼“å­˜èµ·æ¥</span><br>        styles.put(style, typeface);<br>    &#125;<br>    <span class="hljs-keyword">return</span> typeface;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>1ã€å½“ä½ è®¾ç½®çš„ Typeface å’Œ Style ä¸º null å’Œ 0 æ—¶ï¼Œä¼šç»™å®ƒä»¬è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼</p><p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œçš„ Style ï¼Œå¯¹åº”ä¸Šä¸€ç¯‡ä¸­è®²çš„ android:textStyle å±æ€§ä¼ é€’çš„å€¼ï¼Œç”¨äºè®¾å®šå­—ä½“çš„ç²—ä½“ã€æ–œä½“ç­‰å‚æ•°</p><p>2ã€å¦‚æœå½“å‰è®¾ç½®çš„ Typeface çš„ mStyle å±æ€§å’Œä¼ å…¥çš„ Style ç›¸åŒï¼Œç›´æ¥å°† Typeface ç»™è¿”å›</p><p>3ã€ä»ç¼“å­˜ä¸­è·å–å­˜æ”¾ Typeface çš„å®¹å™¨ï¼Œå¦‚æœç¼“å­˜ä¸­å­˜åœ¨ï¼Œåˆ™ä»å®¹å™¨ä¸­å–å‡ºè¯¥ Typeface å¹¶è¿”å›</p><p>4ã€å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°çš„å®¹å™¨å¹¶åŠ å…¥ç¼“å­˜ï¼Œç„¶åé€šè¿‡ native å±‚åˆ›å»º Typefaceï¼Œå¹¶æŠŠå½“å‰ Typeface æ”¾å…¥åˆ°å®¹å™¨ä¸­</p><p><strong>å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™æ— éœ€æ‹…å¿ƒæ•ˆç‡é—®é¢˜ï¼Œå®ƒä¼šæŠŠæˆ‘ä»¬ä¼ å…¥çš„å­—ä½“è¿›è¡Œä¸€ä¸ªç¼“å­˜ï¼Œåç»­éƒ½æ˜¯ä»ç¼“å­˜ä¸­å»æ‹¿çš„</strong></p><h3 id="3ã€é€šè¿‡å­—ä½“åç§°å’Œ-Style-è·å–å­—ä½“"><a href="#3ã€é€šè¿‡å­—ä½“åç§°å’Œ-Style-è·å–å­—ä½“" class="headerlink" title="3ã€é€šè¿‡å­—ä½“åç§°å’Œ Style è·å–å­—ä½“"></a>3ã€é€šè¿‡å­—ä½“åç§°å’Œ Style è·å–å­—ä½“</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬äºŒä¸ª APIï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">create</span><span class="hljs-params">(String familyName, <span class="hljs-meta">@Style</span> <span class="hljs-type">int</span> style)</span> &#123;<br>    <span class="hljs-comment">//è°ƒç”¨æˆªå›¾çš„ç¬¬ä¸€ä¸ª API</span><br>    <span class="hljs-keyword">return</span> create(getSystemDefaultTypeface(familyName), style);<br>&#125;<br><br><span class="hljs-comment">//è·å–ç³»ç»Ÿæä¾›çš„ä¸€äº›é»˜è®¤å­—ä½“ï¼Œå¦‚æœè·å–ä¸åˆ°åˆ™è¿”å›ç³»ç»Ÿçš„é»˜è®¤å­—ä½“</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">getSystemDefaultTypeface</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String familyName)</span> &#123;<br>    <span class="hljs-type">Typeface</span> <span class="hljs-variable">tf</span> <span class="hljs-operator">=</span> sSystemFontMap.get(familyName);<br>    <span class="hljs-keyword">return</span> tf == <span class="hljs-literal">null</span> ? Typeface.DEFAULT : tf;<br>&#125;<br></code></pre></td></tr></table></figure><p>1ã€è¿™ä¸ªåˆ›å»º Typeface çš„ API å¾ˆç®€å•ï¼Œå°±æ˜¯è°ƒç”¨å®ƒçš„ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬å·²ç»åˆ†æè¿‡</p><p>2ã€getSystemDefaultTypeface ä¸»è¦æ˜¯é€šè¿‡ sSystemFontMap è·å–å­—ä½“ï¼Œè€Œè¿™ä¸ª sSystemFontMap åœ¨ Typeface åˆå§‹åŒ–çš„æ—¶å€™ä¼šå­˜æ”¾ç³»ç»Ÿæä¾›çš„ä¸€äº›é»˜è®¤å­—ä½“ï¼Œå› æ­¤è¿™é‡Œç›´æ¥å–å°±å¯ä»¥äº†</p><h3 id="4ã€é€šè¿‡-Typeface-ã€weight-ç²—ä½“-å’Œ-italic-æ–œä½“-è·å–æ–°çš„-Typeface"><a href="#4ã€é€šè¿‡-Typeface-ã€weight-ç²—ä½“-å’Œ-italic-æ–œä½“-è·å–æ–°çš„-Typeface" class="headerlink" title="4ã€é€šè¿‡ Typeface ã€weight(ç²—ä½“) å’Œ italic(æ–œä½“) è·å–æ–°çš„ Typeface"></a>4ã€é€šè¿‡ Typeface ã€weight(ç²—ä½“) å’Œ italic(æ–œä½“) è·å–æ–°çš„ Typeface</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬ä¸‰ä¸ª API</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-meta">@NonNull</span> Typeface <span class="hljs-title function_">create</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Typeface family,</span><br><span class="hljs-params">            <span class="hljs-meta">@IntRange(from = 1, to = 1000)</span> <span class="hljs-type">int</span> weight, <span class="hljs-type">boolean</span> italic)</span> &#123;<br>    <span class="hljs-comment">//æ ¡éªŒä¼ å…¥çš„ weight å±æ€§æ˜¯å¦åœ¨èŒƒå›´å†…</span><br>    Preconditions.checkArgumentInRange(weight, <span class="hljs-number">0</span>, <span class="hljs-number">1000</span>, <span class="hljs-string">&quot;weight&quot;</span>);<br>    <span class="hljs-keyword">if</span> (family == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-comment">//å¦‚æœå½“å‰ä¼ å…¥çš„ Typeface ä¸º null, åˆ™ç½®ä¸ºé»˜è®¤å€¼</span><br>        family = sDefaultTypeface;<br>    &#125;<br>    <span class="hljs-comment">//è°ƒç”¨ createWeightStyle æ–¹æ³•åˆ›å»º Typeface</span><br>    <span class="hljs-keyword">return</span> createWeightStyle(family, weight, italic);<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-meta">@NonNull</span> Typeface <span class="hljs-title function_">createWeightStyle</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Typeface base,</span><br><span class="hljs-params">            <span class="hljs-meta">@IntRange(from = 1, to = 1000)</span> <span class="hljs-type">int</span> weight, <span class="hljs-type">boolean</span> italic)</span> &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> (weight &lt;&lt; <span class="hljs-number">1</span>) | (italic ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);<br><br>    Typeface typeface;<br>    <span class="hljs-comment">//ä½¿ç”¨ sWeightCacheLock ä¿è¯çº¿ç¨‹å®‰å…¨</span><br>    <span class="hljs-keyword">synchronized</span>(sWeightCacheLock) &#123;<br>        SparseArray&lt;Typeface&gt; innerCache = sWeightTypefaceCache.get(base.native_instance);<br>        <span class="hljs-keyword">if</span> (innerCache == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">//ç¼“å­˜ Typeface çš„ SparseArray ä¸º null, æ–°å»ºå¹¶ç¼“å­˜</span><br>            innerCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparseArray</span>&lt;&gt;(<span class="hljs-number">4</span>);<br>            sWeightTypefaceCache.put(base.native_instance, innerCache);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//ä»ç¼“å­˜ä¸­æ‹¿å– typeface å¹¶è¿”å›</span><br>            typeface = innerCache.get(key);<br>            <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> typeface;<br>            &#125;<br>        &#125;<br><span class="hljs-comment">//é€šè¿‡ native åˆ›å»º Typeface å¯¹è±¡</span><br>        typeface = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Typeface</span>(<br>                nativeCreateFromTypefaceWithExactStyle(base.native_instance, weight, italic));<br>        <span class="hljs-comment">//å°† Typeface åŠ å…¥ç¼“å­˜</span><br>      innerCache.put(key, typeface);<br>    &#125;<br>    <span class="hljs-keyword">return</span> typeface;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šè¿°ä»£ç å¯ä»¥çŸ¥é“ï¼Œä»–ä¸æˆªå›¾ä¸€ API çš„æºç å¾ˆç±»ä¼¼ï¼Œæ— éå°±æ˜¯å°†ä¹‹å‰éœ€è¦è®¾ç½®çš„ Style æ¢æˆäº† weight å’Œ italicï¼Œé‡Œé¢çš„å®ç°æœºåˆ¶æ˜¯ç±»ä¼¼çš„</p><h3 id="5ã€é€šè¿‡-AssetManager-å’Œå¯¹åº”å­—ä½“è·¯å¾„è·å–å­—ä½“"><a href="#5ã€é€šè¿‡-AssetManager-å’Œå¯¹åº”å­—ä½“è·¯å¾„è·å–å­—ä½“" class="headerlink" title="5ã€é€šè¿‡ AssetManager å’Œå¯¹åº”å­—ä½“è·¯å¾„è·å–å­—ä½“"></a>5ã€é€šè¿‡ AssetManager å’Œå¯¹åº”å­—ä½“è·¯å¾„è·å–å­—ä½“</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬å››ä¸ª API</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">createFromAsset</span><span class="hljs-params">(AssetManager mgr, String path)</span> &#123;<br>    <span class="hljs-comment">//å‚æ•°æ£€æŸ¥</span><br>    Preconditions.checkNotNull(path); <span class="hljs-comment">// for backward compatibility</span><br>    Preconditions.checkNotNull(mgr);<br><br>    <span class="hljs-comment">//é€šè¿‡ Typeface çš„ Builder æ¨¡å¼æ„å»º typeface</span><br>    <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>(mgr, path).build();<br>    <span class="hljs-comment">//å¦‚æœæ„å»ºçš„ typeface ä¸ä¸ºç©ºåˆ™è¿”å›</span><br>    <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> typeface;<br>    <span class="hljs-comment">// check if the file exists, and throw an exception for backward compatibility</span><br>    <span class="hljs-comment">//çœ‹å½“å‰å­—ä½“è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥æŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> mgr.open(path)) &#123;<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Font asset not found &quot;</span> + path);<br>    &#125;<br>    <span class="hljs-comment">//å¦‚æœæ„å»ºçš„å­—ä½“ä¸º null åˆ™è¿”å›é»˜è®¤å­—ä½“</span><br>    <span class="hljs-keyword">return</span> Typeface.DEFAULT;<br>&#125;<br><br><span class="hljs-comment">//æ¥ç€çœ‹ Typeface çš„ Builder æ¨¡å¼æ„å»º typeface</span><br><span class="hljs-comment">//Builder æ„é€ æ–¹æ³• ä¸»è¦å°±æ˜¯åˆå§‹åŒ– mFontBuilder å’Œä¸€äº›å‚æ•°</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Builder</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> AssetManager assetManager, <span class="hljs-meta">@NonNull</span> String path, <span class="hljs-type">boolean</span> isAsset,</span><br><span class="hljs-params">                <span class="hljs-type">int</span> cookie)</span> &#123;<br>    mFontBuilder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Font</span>.Builder(assetManager, path, isAsset, cookie);<br>    mAssetManager = assetManager;<br>    mPath = path;<br>&#125;<br><br><span class="hljs-comment">//build æ–¹æ³•</span><br><span class="hljs-keyword">public</span> Typeface <span class="hljs-title function_">build</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-comment">//å¦‚æœ mFontBuilder ä¸º nullï¼Œåˆ™ä¼šè°ƒç”¨ resolveFallbackTypeface æ–¹æ³•</span><br>  <span class="hljs-comment">//resolveFallbackTypeface å†…éƒ¨ä¼šè°ƒç”¨ createWeightStyle åˆ›å»º Typeface å¹¶è¿”å›</span><br>    <span class="hljs-keyword">if</span> (mFontBuilder == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> resolveFallbackTypeface();<br>    &#125;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-comment">//é€šè¿‡ mFontBuilder æ„å»º Font</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Font</span> <span class="hljs-variable">font</span> <span class="hljs-operator">=</span> mFontBuilder.build();<br>      <span class="hljs-comment">//ä½¿ç”¨ createAssetUid æ–¹æ³•è·å–åˆ°è¿™ä¸ªå­—ä½“çš„å”¯ä¸€ key</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> mAssetManager == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : createAssetUid(<br>                mAssetManager, mPath, font.getTtcIndex(), font.getAxes(),<br>                mWeight, mItalic,<br>                mFallbackFamilyName == <span class="hljs-literal">null</span> ? DEFAULT_FAMILY : mFallbackFamilyName);<br>        <span class="hljs-keyword">if</span> (key != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// Dynamic cache lookup is only for assets.</span><br>            <span class="hljs-comment">//ä½¿ç”¨ sDynamicCacheLock ä¿è¯çº¿ç¨‹å®‰å…¨</span><br>            <span class="hljs-keyword">synchronized</span> (sDynamicCacheLock) &#123;<br>              <span class="hljs-comment">//é€šè¿‡ key ä»ç¼“å­˜ä¸­æ‹¿å­—ä½“</span><br>                <span class="hljs-keyword">final</span> <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> sDynamicTypefaceCache.get(key);<br>              <span class="hljs-comment">//å¦‚æœå½“å‰å­—ä½“ä¸ä¸º null ç›´æ¥è¿”å›</span><br>                <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-keyword">return</span> typeface;<br>                &#125;<br>            &#125;<br>        &#125;<br>      <span class="hljs-comment">//å¦‚æœå½“å‰å­—ä½“ä¸å­˜åœ¨ï¼Œé€šè¿‡ Builder æ¨¡å¼æ„å»º FontFamily å¯¹è±¡</span><br>      <span class="hljs-comment">//é€šè¿‡ FontFamily æ„å»º CustomFallbackBuilder å¯¹è±¡</span><br>     <span class="hljs-comment">//æœ€ç»ˆé€šè¿‡ CustomFallbackBuilder æ„å»º Typeface å¯¹è±¡</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">FontFamily</span> <span class="hljs-variable">family</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontFamily</span>.Builder(font).build();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> mWeight == RESOLVE_BY_FONT_TABLE<br>                ? font.getStyle().getWeight() : mWeight;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">slant</span> <span class="hljs-operator">=</span> mItalic == RESOLVE_BY_FONT_TABLE<br>                ? font.getStyle().getSlant() : mItalic;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">CustomFallbackBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomFallbackBuilder</span>(family)<br>                .setStyle(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FontStyle</span>(weight, slant));<br>        <span class="hljs-keyword">if</span> (mFallbackFamilyName != <span class="hljs-literal">null</span>) &#123;<br>            builder.setSystemFallback(mFallbackFamilyName);<br>        &#125;<br>      <span class="hljs-comment">//builder.build æ–¹æ³•å†…éƒ¨æœ€ç»ˆä¼šé€šè¿‡è°ƒç”¨ native å±‚åˆ›å»º Typeface å¯¹è±¡</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> builder.build();<br>      <span class="hljs-comment">//ç¼“å­˜ Typeface å¯¹è±¡å¹¶è¿”å›</span><br>        <span class="hljs-keyword">if</span> (key != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">synchronized</span> (sDynamicCacheLock) &#123;<br>                sDynamicTypefaceCache.put(key, typeface);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> typeface;<br>    &#125; <span class="hljs-keyword">catch</span> (IOException | IllegalArgumentException e) &#123;<br>      <span class="hljs-comment">//å¦‚æœæµç¨‹æœ‰ä»»ä½•å¼‚å¸¸ï¼Œåˆ™å†…éƒ¨ä¼šè°ƒç”¨ createWeightStyle åˆ›å»º Typeface å¹¶è¿”å›</span><br>        <span class="hljs-keyword">return</span> resolveFallbackTypeface();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€å¤§é‡è¿ç”¨äº† Builder æ¨¡å¼å»æ„å»ºç›¸å…³å¯¹è±¡</p><p>2ã€å…·ä½“é€»è¾‘å°±æ˜¯ä½¿ç”¨ createAssetUid æ–¹æ³•è·å–åˆ°å½“å‰å­—ä½“çš„å”¯ä¸€ key ï¼Œé€šè¿‡è¿™ä¸ªå”¯ä¸€ key ï¼Œä»ç¼“å­˜ä¸­è·å–å·²ç»è¢«åŠ è½½è¿‡çš„å­—ä½“ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ª FontFamily å¯¹è±¡ï¼Œç»è¿‡ä¸€ç³»åˆ— Builder æ¨¡å¼ï¼Œæœ€ç»ˆè°ƒç”¨ native å±‚åˆ›å»º Typeface å¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ª Typeface å¯¹è±¡åŠ å…¥ç¼“å­˜å¹¶è¿”å›</p><p>3ã€å¦‚æœæµç¨‹æœ‰ä»»ä½•å¼‚å¸¸ï¼Œå†…éƒ¨ä¼šè°ƒç”¨ createWeightStyle åˆ›å»º Typeface å¹¶è¿”å›</p><h3 id="6ã€é€šè¿‡å­—ä½“æ–‡ä»¶è·å–å­—ä½“"><a href="#6ã€é€šè¿‡å­—ä½“æ–‡ä»¶è·å–å­—ä½“" class="headerlink" title="6ã€é€šè¿‡å­—ä½“æ–‡ä»¶è·å–å­—ä½“"></a>6ã€é€šè¿‡å­—ä½“æ–‡ä»¶è·å–å­—ä½“</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬äº”ä¸ª API</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">createFromFile</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> File file)</span> &#123;<br>    <span class="hljs-comment">// For the compatibility reasons, leaving possible NPE here.</span><br>    <span class="hljs-comment">// See android.graphics.cts.TypefaceTest#testCreateFromFileByFileReferenceNull</span><br>    <span class="hljs-comment">//é€šè¿‡ Typeface çš„ Builder æ¨¡å¼æ„å»º typeface</span><br>    <span class="hljs-type">Typeface</span> <span class="hljs-variable">typeface</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>(file).build();<br>    <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> typeface;<br><br>    <span class="hljs-comment">// check if the file exists, and throw an exception for backward compatibility</span><br>    <span class="hljs-comment">//æ–‡ä»¶ä¸å­˜åœ¨ï¼ŒæŠ›å¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (!file.exists()) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Font asset not found &quot;</span> + file.getAbsolutePath());<br>    &#125;<br>    <span class="hljs-comment">//å¦‚æœæ„å»ºçš„å­—ä½“ä¸º null åˆ™è¿”å›é»˜è®¤å­—ä½“</span><br>    <span class="hljs-keyword">return</span> Typeface.DEFAULT;<br>&#125;<br><br><span class="hljs-comment">//Builder å¦å¤–ä¸€ä¸ªæ„é€ æ–¹æ³• ä¸»è¦æ˜¯åˆå§‹åŒ– mFontBuilder</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Builder</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> File path)</span> &#123;<br>    mFontBuilder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Font</span>.Builder(path);<br>    mAssetManager = <span class="hljs-literal">null</span>;<br>    mPath = <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç å¯ä»¥çŸ¥é“ï¼Œè¿™ç§æ–¹å¼ä¸»è¦ä¹Ÿæ˜¯é€šè¿‡ Builder æ¨¡å¼å»æ„å»º Typeface å¯¹è±¡ï¼Œå…·ä½“é€»è¾‘æˆ‘ä»¬åˆšæ‰å·²ç»åˆ†æè¿‡</p><h3 id="7ã€é€šè¿‡å­—ä½“è·¯å¾„è·å–å­—ä½“"><a href="#7ã€é€šè¿‡å­—ä½“è·¯å¾„è·å–å­—ä½“" class="headerlink" title="7ã€é€šè¿‡å­—ä½“è·¯å¾„è·å–å­—ä½“"></a>7ã€é€šè¿‡å­—ä½“è·¯å¾„è·å–å­—ä½“</h3><p>å¯¹åº”ä¸Šé¢æˆªå›¾çš„ç¬¬å…­ä¸ª API</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">createFromFile</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String path)</span> &#123;<br>    Preconditions.checkNotNull(path); <span class="hljs-comment">// for backward compatibility</span><br>    <span class="hljs-keyword">return</span> createFromFile(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path));<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ›´ç®€å•äº†ï¼Œä¸»è¦å°±æ˜¯åˆ›å»ºæ–‡ä»¶å¯¹è±¡ç„¶åè°ƒç”¨å¦å¤–ä¸€ä¸ªé‡è½½æ–¹æ³•</p><h3 id="8ã€Typeface-ç›¸å…³-Native-æ–¹æ³•"><a href="#8ã€Typeface-ç›¸å…³-Native-æ–¹æ³•" class="headerlink" title="8ã€Typeface ç›¸å…³ Native æ–¹æ³•"></a>8ã€Typeface ç›¸å…³ Native æ–¹æ³•</h3><p>åœ¨ Typeface ä¸­ï¼Œæ‰€æœ‰æœ€ç»ˆæ“ä½œåˆ°åŠ è½½å­—ä½“çš„éƒ¨åˆ†ï¼Œå…¨éƒ¨éƒ½æ˜¯ native çš„æ–¹æ³•ã€‚è€Œ native æ–¹æ³•å°±æ˜¯ä»¥æ•ˆç‡è‘—ç§°çš„ï¼Œè¿™é‡Œåªéœ€è¦ä¿è¯ä¸é¢‘ç¹çš„è°ƒç”¨ï¼ˆTypeface å·²ç»åšå¥½äº†ç¼“å­˜ï¼Œä¸ä¼šé¢‘ç¹çš„è°ƒç”¨ï¼‰ï¼ŒåŸºæœ¬ä¸Šä¹Ÿä¸ä¼šå­˜åœ¨æ•ˆç‡çš„é—®é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeCreateFromTypeface</span><span class="hljs-params">(<span class="hljs-type">long</span> native_instance, <span class="hljs-type">int</span> style)</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeCreateFromTypefaceWithExactStyle</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-type">long</span> native_instance, <span class="hljs-type">int</span> weight, <span class="hljs-type">boolean</span> italic)</span>;<br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> clean up: change List&lt;FontVariationAxis&gt; to FontVariationAxis[]</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeCreateFromTypefaceWithVariation</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-type">long</span> native_instance, List&lt;FontVariationAxis&gt; axes)</span>;<br><span class="hljs-meta">@UnsupportedAppUsage</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeCreateWeightAlias</span><span class="hljs-params">(<span class="hljs-type">long</span> native_instance, <span class="hljs-type">int</span> weight)</span>;<br><span class="hljs-meta">@UnsupportedAppUsage</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeCreateFromArray</span><span class="hljs-params">(<span class="hljs-type">long</span>[] familyArray, <span class="hljs-type">int</span> weight, <span class="hljs-type">int</span> italic)</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span>[] nativeGetSupportedAxes(<span class="hljs-type">long</span> native_instance);<br><br><span class="hljs-meta">@CriticalNative</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nativeSetDefault</span><span class="hljs-params">(<span class="hljs-type">long</span> nativePtr)</span>;<br><br><span class="hljs-meta">@CriticalNative</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span>  <span class="hljs-title function_">nativeGetStyle</span><span class="hljs-params">(<span class="hljs-type">long</span> nativePtr)</span>;<br><br><span class="hljs-meta">@CriticalNative</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span>  <span class="hljs-title function_">nativeGetWeight</span><span class="hljs-params">(<span class="hljs-type">long</span> nativePtr)</span>;<br><br><span class="hljs-meta">@CriticalNative</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nativeGetReleaseFunc</span><span class="hljs-params">()</span>;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nativeRegisterGenericFamily</span><span class="hljs-params">(String str, <span class="hljs-type">long</span> nativePtr)</span>;<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œå…³äº Typeface æºç éƒ¨åˆ†æˆ‘ä»¬å°±ä»‹ç»å®Œäº†ï¼Œä¸‹é¢çœ‹ä¸‹å®ƒçš„ä¸€äº›å…¶ä»–ç»†èŠ‚</p><h2 id="ä¸‰ã€Typeface-å…¶å®ƒç»†èŠ‚"><a href="#ä¸‰ã€Typeface-å…¶å®ƒç»†èŠ‚" class="headerlink" title="ä¸‰ã€Typeface å…¶å®ƒç»†èŠ‚"></a>ä¸‰ã€Typeface å…¶å®ƒç»†èŠ‚</h2><h3 id="1ã€é»˜è®¤ä½¿ç”¨"><a href="#1ã€é»˜è®¤ä½¿ç”¨" class="headerlink" title="1ã€é»˜è®¤ä½¿ç”¨"></a>1ã€é»˜è®¤ä½¿ç”¨</h3><p>åœ¨åˆå§‹åŒ–é‚£éƒ¨åˆ†ï¼ŒTypeface å¯¹å­—ä½“å’Œ Style æœ‰ä¸€äº›é»˜è®¤å®ç°</p><p>å¦‚æœæˆ‘ä»¬åªæƒ³ç”¨ç³»ç»Ÿé»˜è®¤çš„å­—ä½“ï¼Œç›´æ¥æ‹¿ä¸Šé¢çš„å¸¸é‡ç”¨å°± ok äº†ï¼Œå¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Typeface.DEFAULT<br>Typeface.DEFAULT_BOLD<br>Typeface.SANS_SERIF<br>Typeface.SERIF<br>Typeface.MONOSPACE<br></code></pre></td></tr></table></figure><p>è€Œå¦‚æœæƒ³è¦è®¾ç½® Style ï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡ sDefaults ç›´æ¥å»æ‹¿ï¼Œå› ä¸ºä¸Šå±‚è°ƒç”¨ä¸åˆ° sDefaultsï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ Typeface æä¾›çš„ API è·å–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Typeface <span class="hljs-title function_">defaultFromStyle</span><span class="hljs-params">(<span class="hljs-meta">@Style</span> <span class="hljs-type">int</span> style)</span> &#123;<br>    <span class="hljs-keyword">return</span> sDefaults[style];<br>&#125;<br><br><span class="hljs-comment">//å…·ä½“è°ƒç”¨</span><br>Typeface.defaultFromStyle(Typeface.NORMAL)<br>Typeface.defaultFromStyle(Typeface.BOLD)<br>Typeface.defaultFromStyle(Typeface.ITALIC)<br>Typeface.defaultFromStyle(Typeface.BOLD_ITALIC)<br></code></pre></td></tr></table></figure><h3 id="2ã€Typeface-ä¸­çš„-Style"><a href="#2ã€Typeface-ä¸­çš„-Style" class="headerlink" title="2ã€Typeface ä¸­çš„ Style"></a>2ã€Typeface ä¸­çš„ Style</h3><p>1ï¼‰ã€Typeface ä¸­çš„ Style å¯ä»¥é€šè¿‡ android:textStyle å±æ€§å»è®¾ç½®ç²—ä½“ã€æ–œä½“ç­‰æ ·å¼</p><p>2ï¼‰ã€åœ¨ Typeface ä¸­ï¼Œè¿™äº›æ ·å¼ä¹Ÿå¯¹åº”äº†ä¸€ä¸ªä¸ªçš„å¸¸é‡ï¼Œå¹¶ä¸” Typeface ä¹Ÿæä¾›äº†å¯¹åº”çš„ Apiï¼Œè®©æˆ‘ä»¬è·å–åˆ°å½“å‰å­—ä½“çš„æ ·å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Style</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NORMAL</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">ITALIC</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BOLD_ITALIC</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br><br><span class="hljs-comment">/** Returns the typeface&#x27;s intrinsic style attributes */</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@Style</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getStyle</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> mStyle;<br>&#125;<br><br><span class="hljs-comment">/** Returns true if getStyle() has the BOLD bit set. */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBold</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> (mStyle &amp; BOLD) != <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">/** Returns true if getStyle() has the ITALIC bit set. */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isItalic</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> (mStyle &amp; ITALIC) != <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€FontFamily-ä»‹ç»"><a href="#3ã€FontFamily-ä»‹ç»" class="headerlink" title="3ã€FontFamily ä»‹ç»"></a>3ã€FontFamily ä»‹ç»</h3><p><strong>FontFamily</strong> ä¸»è¦å°±æ˜¯ç”¨æ¥æ„å»º Typeface çš„ä¸€ä¸ªç±»ï¼Œæ³¨æ„å’Œåœ¨ Xml å±æ€§ä¸­è®¾ç½®çš„ android:fontFamily åŒºåˆ†å¼€æ¥å°±å¥½äº†</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æ€»ç»“ä¸‹æœ¬ç¯‡æ–‡ç« æ‰€è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€Typeface åˆå§‹åŒ–å¯¹å­—ä½“å’Œ Style ä¼šæœ‰ä¸€äº›é»˜è®¤å®ç°</p><p>2ã€Typeface create ç³»åˆ—æ–¹æ³•æ”¯æŒä»ç³»ç»Ÿé»˜è®¤å­—ä½“ã€ assets ç›®å½•ã€å­—ä½“æ–‡ä»¶ä»¥åŠå­—ä½“è·¯å¾„å»è·å–å­—ä½“</p><p>3ã€Typeface æœ¬èº«æ”¯æŒç¼“å­˜ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™æ— éœ€æ³¨æ„æ•ˆç‡é—®é¢˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²åœ¨ Xml ä¸­ä½¿ç”¨å­—ä½“ï¼Œæ•¬è¯·æœŸå¾…å§ ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://segmentfault.com/a/1190000011299442">Android ä¿®æ”¹å­—ä½“ï¼Œè·³ä¸è¿‡çš„ Typeface</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Font</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android Font</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå­—ä½“ç³»åˆ— ï¼ˆä¸€ï¼‰ï¼šAndroidå­—ä½“åŸºç¡€</title>
    <link href="/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AAndroid%E5%AD%97%E4%BD%93%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/10/11/Android%E5%AD%97%E4%BD%93%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AAndroid%E5%AD%97%E4%BD%93%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/860547fcae1c47e5ab8d633d991a54db~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æœ€è¿‘æ¥åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œå¤§è‡´å†…å®¹æ˜¯ï¼šå…¨å±€æ›¿æ¢å½“å‰é¡¹ç›®ä¸­çš„é»˜è®¤å­—ä½“ï¼Œå¹¶å¼•å…¥ UI è®¾è®¡å¸ˆæä¾›çš„ä¸€äº›æ–°å­—ä½“ã€‚äºæ˜¯å¯¹å­—ä½“åšäº†äº›ç ”ç©¶ï¼ŒæŠŠè‡ªå·±çš„ä¸€äº›å¿ƒå¾—åˆ†äº«ç»™å¤§å®¶ã€‚</p><p><strong>æ³¨æ„ï¼šæœ¬æ–‡æ‰€å±•ç¤ºçš„ç³»ç»Ÿæºç éƒ½æ˜¯åŸºäºAndroid-30 ï¼Œå¹¶æå–æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œåˆ†æ</strong></p><h2 id="ä¸€ã€Android-é»˜è®¤å­—ä½“ä»‹ç»"><a href="#ä¸€ã€Android-é»˜è®¤å­—ä½“ä»‹ç»" class="headerlink" title="ä¸€ã€Android é»˜è®¤å­—ä½“ä»‹ç»"></a>ä¸€ã€Android é»˜è®¤å­—ä½“ä»‹ç»</h2><p>1ã€Android ç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„æ˜¯ä¸€æ¬¾å«åš <strong>Roboto</strong> çš„å­—ä½“ï¼Œè¿™ä¹Ÿæ˜¯ Google æ¨èä½¿ç”¨çš„ä¸€æ¬¾å­—ä½“ <a href="https://fonts.google.com/specimen/Roboto">ä¼ é€é—¨</a>ã€‚å®ƒæä¾›äº†å¤šç§å­—ä½“å½¢å¼çš„é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šç²—ä½“ï¼Œæ–œä½“ç­‰ç­‰ã€‚</p><p>2ã€åœ¨ Android ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šç›´æ¥æˆ–é—´æ¥çš„é€šè¿‡ TextView æ§ä»¶å»æ‰¿è½½å­—ä½“çš„æ˜¾ç¤ºï¼Œå› ä¸ºå…³äº Android æä¾›çš„æ‰¿è½½å­—ä½“æ˜¾ç¤ºçš„æ§ä»¶éƒ½ä¼šç›´æ¥æˆ–é—´æ¥ç»§æ‰¿ TextViewï¼Œä¾‹å¦‚ï¼šEditTextï¼ŒButton ç­‰ç­‰ï¼Œä¸‹é¢ç»™å‡ºä¸€å¼  TextView ç»§æ‰¿å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d39161a73f724a768e1eabde15b04c4e~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210612124458481"></p><p>3ã€TextView ä¸­æœ‰ä¸‰ä¸ªå±æ€§å¯ä»¥è®¾ç½®å­—ä½“çš„æ˜¾ç¤ºï¼š</p><p>1ï¼‰ã€textStyle</p><p>2ï¼‰ã€typeface</p><p>3ï¼‰ã€fontFamily</p><p>ä¸‹é¢æˆ‘ä»¬é‡ç‚¹ä»‹ç»ä¸‹è¿™ä¸‰ä¸ªå±æ€§</p><h2 id="äºŒã€textStyle"><a href="#äºŒã€textStyle" class="headerlink" title="äºŒã€textStyle"></a>äºŒã€textStyle</h2><p><strong>textStyle</strong> ä¸»è¦ç”¨æ¥è®¾ç½®å­—ä½“çš„æ ·å¼ï¼Œæˆ‘ä»¬çœ‹ä¸‹å®ƒåœ¨ TextView çš„è‡ªå®šä¹‰å±æ€§ä¸­çš„ä¸€ä¸ªä½“ç°ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">//TextView çš„è‡ªå®šä¹‰å±æ€§ textStyle<br><span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;textStyle&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">flag</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;normal&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">flag</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bold&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">flag</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;italic&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">attr</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°è‡ªå®šä¹‰å±æ€§ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>1ã€textStyle ä¸»è¦æœ‰ 3 ç§æ ·å¼ï¼š</p><ul><li>normalï¼šé»˜è®¤å­—ä½“ </li><li>boldï¼šç²—ä½“</li><li>italicï¼šæ–œä½“</li></ul><p>2ã€textStyle æ˜¯ç”¨ flag æ¥æ‰¿è½½çš„ï¼Œflag è¡¨ç¤ºçš„å€¼å¯ä»¥åšæˆ–è¿ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è®¾ç½®å¤šç§å­—ä½“æ ·å¼è¿›è¡Œå åŠ </p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ xml ä¸­è®¾ç½®ä¸€ä¸‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e2f6c4a7ba141e0b05c0c45bd802b0a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210612205549971"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç»™ TextView çš„ textStyle å±æ€§è®¾ç½®äº†<strong>ç²—ä½“å’Œæ–œä½“</strong>ä¸¤ç§æ ·å¼å åŠ ï¼Œå³è¾¹å¯ä»¥çœ‹åˆ°é¢„è§ˆæ•ˆæœ</p><p>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­å¯¹å…¶è¿›è¡Œè®¾ç½®ï¼Œä½†æ˜¯åœ¨ä»£ç ä¸­è®¾ç½®å­—ä½“æ ·å¼åªèƒ½è®¾ç½®ä¸€ç§ï¼Œä¸èƒ½å åŠ ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">mTextView.setTypeface(<span class="hljs-literal">null</span>, Typeface.BOLD)<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€typeface"><a href="#ä¸‰ã€typeface" class="headerlink" title="ä¸‰ã€typeface"></a>ä¸‰ã€typeface</h2><p><strong>typeface</strong> ä¸»è¦ç”¨äºè®¾ç½® TextView çš„å­—ä½“ï¼Œæˆ‘ä»¬çœ‹ä¸‹å®ƒåœ¨ TextView çš„è‡ªå®šä¹‰å±æ€§ä¸­çš„ä¸€ä¸ªä½“ç°ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">//TextView çš„è‡ªå®šä¹‰å±æ€§ typeface<br><span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;typeface&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;normal&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sans&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;serif&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;monospace&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">attr</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°è‡ªå®šä¹‰å±æ€§ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>1ã€typeface æä¾›äº† 4 ç§å­—ä½“:</p><ul><li>noramlï¼šæ™®é€šå­—ä½“ï¼Œç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„å­—ä½“</li><li>sansï¼šéè¡¬çº¿å­—ä½“</li><li>serifï¼šè¡¬çº¿å­—ä½“</li><li>monospaceï¼šç­‰å®½å­—ä½“</li></ul><p>2ã€typeface æ˜¯ç”¨ enum æ¥æ‰¿è½½çš„ï¼Œenum è¡¨ç¤ºæšä¸¾ç±»å‹ï¼Œæ¯æ¬¡åªèƒ½é€‰æ‹©ä¸€ä¸ªï¼Œå› æ­¤æˆ‘ä»¬æ¯æ¬¡åªèƒ½è®¾ç½®ä¸€ç§å­—ä½“ï¼Œä¸èƒ½å åŠ </p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ xml ä¸­è®¾ç½®ä¸€ä¸‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af5a02a649b74a8b8ca9eb05eeb7bbff~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210612133722082"></p><p>ç®€å•ä»‹ç»è¿™å‡ ç§å­—ä½“çš„åŒºåˆ«ï¼š</p><p>serif (è¡¬çº¿å­—ä½“)ï¼šåœ¨å­—çš„ç¬”åˆ’å¼€å§‹åŠç»“æŸçš„åœ°æ–¹æœ‰é¢å¤–çš„è£…é¥°ï¼Œè€Œä¸”ç¬”åˆ’çš„ç²—ç»†ä¼šå› ç›´æ¨ªçš„ä¸åŒè€Œæœ‰ä¸åŒç›¸</p><p>sans (éè¡¬çº¿å­—ä½“)ï¼šæ²¡æœ‰ serif å­—ä½“è¿™äº›é¢å¤–çš„è£…é¥°ï¼Œå’Œ noraml å­—ä½“æ˜¯ä¸€æ ·çš„</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cdccfc3d87ec4fc29d5e8459f6a0972d~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210612134441993"></p><p>monospace (ç­‰å®½å­—ä½“)ï¼šé™åˆ¶æ¯ä¸ªå­—ç¬¦çš„å®½åº¦ï¼Œè®©å®ƒä»¬è¾¾åˆ°ä¸€ä¸ªç­‰å®½çš„æ•ˆæœ</p><p>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­è¿›è¡Œè®¾ç½®ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">mTv.setTypeface(Typeface.SERIF)<br></code></pre></td></tr></table></figure><h2 id="å››ã€fontFamily"><a href="#å››ã€fontFamily" class="headerlink" title="å››ã€fontFamily"></a>å››ã€fontFamily</h2><p>fontFamily ç›¸å½“äºæ˜¯åŠ å¼ºç‰ˆçš„ typefaceï¼Œå®ƒè¡¨ç¤º android ç³»ç»Ÿæ”¯æŒçš„ä¸€ç³»åˆ—å­—ä½“ï¼Œæ¯ä¸ªå­—ä½“éƒ½æœ‰ä¸€ä¸ªåˆ«åï¼Œæˆ‘ä»¬é€šè¿‡åˆ«åå°±èƒ½è®¾ç½®è¿™ç§å­—ä½“ï¼Œçœ‹ä¸‹å®ƒåœ¨ TextView çš„è‡ªå®šä¹‰å±æ€§ä¸­çš„ä¸€ä¸ªä½“ç°ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">//TextView çš„è‡ªå®šä¹‰å±æ€§ fontFamily<br><span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fontFamily&quot;</span> <span class="hljs-attr">format</span>=<span class="hljs-string">&quot;string&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°è‡ªå®šä¹‰å±æ€§ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p>fontFamily æ¥æ”¶çš„æ˜¯ä¸€ä¸ª String ç±»å‹çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ä½“åˆ«åè®¾ç½®è¿™ç§å­—ä½“ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb550779d94c4e2d9765e9e965a64239~tplv-k3u1fbpfcp-zoom-1.image" alt="fontFamily"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒç»†è‡´çš„åŒºåˆ†äº†æ¯ä¸ªç³»åˆ—å­—ä½“çš„æ ·å¼ï¼ŒåŒæ ·æˆ‘ä»¬åœ¨ xml ä¸­å¯¹å®ƒè¿›è¡Œä¸€ä¸ªè®¾ç½®ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58193c885a64490aaf7d5f2f77b50348~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210612212209243"><br>æˆ‘ä»¬åœ¨ä»£ç ä¸­åœ¨å¯¹ä»–è¿›è¡Œä¸€ä¸ªè®¾ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">mTv.setTypeface(Typeface.create(<span class="hljs-string">&quot;sans-serif-medium&quot;</span>,Typeface.NORMAL))<br></code></pre></td></tr></table></figure><p><strong>å€¼çš„æ³¨æ„çš„æ˜¯</strong>ï¼šfontFamily è®¾ç½®çš„æŸäº›å­—ä½“æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œå¦‚æˆ‘ä¸Šé¢è®¾ç½®çš„ sans-serif-medium å­—ä½“ï¼Œå®ƒåœ¨ Android ç³»ç»Ÿç‰ˆæœ¬å¤§äºç­‰äº 21 æ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœå°äº 21 ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤å­—ä½“ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨ fontFamily<br>å±æ€§æ—¶ï¼Œéœ€è¦æ³¨æ„è¿™ä¸ªé—®é¢˜</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æŠŠå½±å“ Android å­—ä½“çš„ 3 ä¸ªå±æ€§ç»™è®²å®Œäº†ï¼Œä½†æ˜¯æˆ‘å¿ƒé‡Œæœ‰ä¸ªç–‘é—®ğŸ¤”ï¸ ï¼Ÿå‡è®¾æˆ‘è¿™ä¸‰ä¸ªå±æ€§åŒæ—¶è®¾ç½®ï¼Œä¼šä¸€èµ·ç”Ÿæ•ˆå—ï¼Ÿ</p><p>å¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¢ç´¢ä¸€ä¸‹æºç </p><h2 id="äº”ã€textStyleï¼Œtypefaceï¼ŒfontFamily-ä¸‰è€…å…³ç³»åˆ†æ"><a href="#äº”ã€textStyleï¼Œtypefaceï¼ŒfontFamily-ä¸‰è€…å…³ç³»åˆ†æ" class="headerlink" title="äº”ã€textStyleï¼Œtypefaceï¼ŒfontFamily ä¸‰è€…å…³ç³»åˆ†æ"></a>äº”ã€textStyleï¼Œtypefaceï¼ŒfontFamily ä¸‰è€…å…³ç³»åˆ†æ</h2><p>TextView åœ¨æˆ‘ä»¬ä½¿ç”¨å®ƒä¹‹å‰éœ€è¿›è¡Œä¸€ä¸ªåˆå§‹åŒ–ï¼Œæœ€ç»ˆä¼šè°ƒç”¨å®ƒå‚æ•°æœ€å¤šçš„é‚£ä¸ªæ„é€ æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">TextView</span><span class="hljs-params">(Context context, <span class="hljs-meta">@Nullable</span> AttributeSet attrs, <span class="hljs-type">int</span> defStyleAttr, <span class="hljs-type">int</span> defStyleRes)</span> &#123;<br>    <span class="hljs-built_in">super</span>(context, attrs, defStyleAttr, defStyleRes);<br>  <span class="hljs-comment">//çœç•¥æˆå¨ä»£ç .....</span><br>  <span class="hljs-comment">//è¯»å–è®¾ç½®çš„å±æ€§</span><br>  readTextAppearance(context, appearance, attributes, <span class="hljs-literal">false</span> <span class="hljs-comment">/* styleArray */</span>);<br>  <span class="hljs-comment">//è®¾ç½®å­—ä½“</span><br>  applyTextAppearance(attributes);<br> &#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">applyTextAppearance</span><span class="hljs-params">(TextAppearanceAttributes attributes)</span> &#123;<br>   <span class="hljs-comment">//çœç•¥æˆå¨ä»£ç .....</span><br>  setTypefaceFromAttrs(attributes.mFontTypeface, attributes.mFontFamily,<br>                attributes.mTypefaceIndex, attributes.mTextStyle, attributes.mFontWeight);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ¡è°ƒç”¨é“¾ï¼Œé¦–å…ˆä¼šè¯»å– TextView è®¾ç½®çš„ç›¸å…³å±æ€§ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸å­—ä½“ç›¸å…³çš„å‡ ä¸ªï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readTextAppearance</span><span class="hljs-params">(Context context, TypedArray appearance,</span><br><span class="hljs-params">            TextAppearanceAttributes attributes, <span class="hljs-type">boolean</span> styleArray)</span> &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-keyword">switch</span> (index) &#123;<br>     <span class="hljs-keyword">case</span> com.android.internal.R.styleable.TextAppearance_typeface:<br>                attributes.mTypefaceIndex = appearance.getInt(attr, attributes.mTypefaceIndex);<br>                <span class="hljs-keyword">if</span> (attributes.mTypefaceIndex != -<span class="hljs-number">1</span> &amp;&amp; !attributes.mFontFamilyExplicit) &#123;<br>                    attributes.mFontFamily = <span class="hljs-literal">null</span>;<br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> com.android.internal.R.styleable.TextAppearance_fontFamily:<br>                <span class="hljs-keyword">if</span> (!context.isRestricted() &amp;&amp; context.canLoadUnsafeResources()) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        attributes.mFontTypeface = appearance.getFont(attr);<br>                    &#125; <span class="hljs-keyword">catch</span> (UnsupportedOperationException | Resources.NotFoundException e) &#123;<br>                        <span class="hljs-comment">// Expected if it is not a font resource.</span><br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (attributes.mFontTypeface == <span class="hljs-literal">null</span>) &#123;<br>                    attributes.mFontFamily = appearance.getString(attr);<br>                &#125;<br>                attributes.mFontFamilyExplicit = <span class="hljs-literal">true</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> com.android.internal.R.styleable.TextAppearance_textStyle:<br>                attributes.mTextStyle = appearance.getInt(attr, attributes.mTextStyle);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//...</span><br>       <span class="hljs-keyword">default</span>:<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€å½“æˆ‘ä»¬è®¾ç½® typeface å±æ€§æ—¶ï¼Œä¼šå°†å¯¹åº”çš„å±æ€§å€¼èµ‹ç»™ mTypefaceIndex ï¼Œå¹¶æŠŠ mFontFamily ç½®ä¸º null</p><p>2ã€å½“æˆ‘ä»¬è®¾ç½® fontFamily å±æ€§æ—¶ï¼Œé¦–å…ˆä¼šé€šè¿‡ appearance.getFont() æ–¹æ³•å»è·å–å­—ä½“æ–‡ä»¶ï¼Œå¦‚æœèƒ½è·å–åˆ°ï¼Œåˆ™èµ‹å€¼ç»™ mFontTypefaceï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œåˆ™é€šè¿‡ appearance.getString() æ–¹æ³•å–è·å–å½“å‰å­—ä½“åˆ«åå¹¶èµ‹å€¼ç»™ mFontFamily</p><p><strong>æ³¨æ„</strong>ï¼šå½“æˆ‘ä»¬ç»™ fontFamily è®¾ç½®äº†ä¸€äº›ç¬¬ä¸‰æ–¹å­—ä½“ï¼Œé‚£ä¹ˆæ­¤æ—¶  appearance.getFont() æ–¹æ³•å°±è·å–ä¸åˆ°å­—ä½“</p><p>3ã€å½“æˆ‘ä»¬è®¾ç½® textStyle å±æ€§æ—¶ï¼Œä¼šå°†è·å–çš„å±æ€§å€¼èµ‹ç»™ mTextStyle </p><p>ä¸Šè¿°æ–¹æ³•èµ°å®Œäº†ï¼Œä¼šè°ƒ setTypefaceFromAttrs() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯æœ€ç»ˆ TextView è®¾ç½®å­—ä½“çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥è§£æä¸‹è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTypefaceFromAttrs</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Typeface typeface, <span class="hljs-meta">@Nullable</span> String familyName,</span><br><span class="hljs-params">            <span class="hljs-meta">@XMLTypefaceAttr</span> <span class="hljs-type">int</span> typefaceIndex, <span class="hljs-meta">@Typeface</span>.Style <span class="hljs-type">int</span> style,</span><br><span class="hljs-params">            <span class="hljs-meta">@IntRange(from = -1, to = FontStyle.FONT_WEIGHT_MAX)</span> <span class="hljs-type">int</span> weight)</span> &#123;<br>    <span class="hljs-keyword">if</span> (typeface == <span class="hljs-literal">null</span> &amp;&amp; familyName != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// Lookup normal Typeface from system font map.</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Typeface</span> <span class="hljs-variable">normalTypeface</span> <span class="hljs-operator">=</span> Typeface.create(familyName, Typeface.NORMAL);<br>        resolveStyleAndSetTypeface(normalTypeface, style, weight);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeface != <span class="hljs-literal">null</span>) &#123;<br>        resolveStyleAndSetTypeface(typeface, style, weight);<br>    &#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// both typeface and familyName is null.</span><br>        <span class="hljs-keyword">switch</span> (typefaceIndex) &#123;<br>            <span class="hljs-keyword">case</span> SANS:<br>                resolveStyleAndSetTypeface(Typeface.SANS_SERIF, style, weight);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SERIF:<br>                resolveStyleAndSetTypeface(Typeface.SERIF, style, weight);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> MONOSPACE:<br>                resolveStyleAndSetTypeface(Typeface.MONOSPACE, style, weight);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> DEFAULT_TYPEFACE:<br>            <span class="hljs-keyword">default</span>:<br>                resolveStyleAndSetTypeface(<span class="hljs-literal">null</span>, style, weight);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ­¥éª¤ï¼š</p><p>1ã€å½“ typeface ä¸ºç©ºå¹¶ä¸” familyName ä¸ä¸ºç©ºæ—¶ï¼Œå– familyName çš„å­—ä½“</p><p>2ã€å½“ typeface ä¸ä¸ºç©ºå¹¶ä¸” familyName ä¸ºç©ºæ—¶ï¼Œå– typeface çš„å­—ä½“</p><p>3ã€å½“ typeface å’Œ familyName éƒ½ä¸ºç©ºï¼Œåˆ™æ ¹æ® typefaceIndex çš„å€¼å–ç›¸åº”çš„å­—ä½“</p><p>4ã€typeface ï¼ŒfamilyName å’Œ typefaceIndex åœ¨æˆ‘ä»¬åˆ†æçš„ readTextAppearance æ–¹æ³•ä¼šè¢«èµ‹å€¼</p><p>5ã€resolveStyleAndSetTypefce æ–¹æ³•ä¼šè¿›è¡Œå­—ä½“å’Œå­—ä½“æ ·å¼çš„è®¾ç½®</p><p>6ã€style æ˜¯åœ¨ readTextAppearance æ–¹æ³•ä¸­èµ‹å€¼çš„ï¼Œä»–å’Œè®¾ç½®å­—ä½“å¹¶ä¸å†²çª</p><p>å¥½ï¼Œç°åœ¨ä»£ç åˆ†æçš„å·®ä¸å¤šäº†ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ä¸Šé¢é‚£ä¸ªç–‘é—®ï¼Ÿæˆ‘ä»¬ä½¿ç”¨å‡è®¾æ³•æ¥è¿›è¡Œæ¨å¯¼ï¼š</p><p>å‡è®¾åœ¨ Xml ä¸­ï¼Œ typefaceï¼ŒfamilyName å’Œ textStyle æˆ‘éƒ½è®¾ç½®äº†ï¼Œé‚£ä¹ˆæ ¹æ®ä¸Šé¢åˆ†æï¼š</p><p>1ã€textStyle è‚¯å®šä¼šç”Ÿæ•ˆ</p><p>2ã€å½“è®¾ç½®äº† typeface å±æ€§ï¼ŒtypefaceIndex ä¼šè¢«èµ‹å€¼ï¼ŒåŒæ—¶ familyName ä¼šç½®ä¸ºç©º</p><p>3ã€å½“è®¾ç½®äº† familyName å±æ€§ï¼Œåˆ†æƒ…å†µï¼š1ã€å¦‚æœè®¾ç½®çš„æ˜¯ç³»ç»Ÿå­—ä½“ï¼Œtypeface ä¼šè¢«èµ‹å€¼ï¼ŒfamilyName è¿˜æ˜¯ä¸ºç©ºã€‚2ã€å¦‚æœè®¾ç½®çš„æ˜¯ç¬¬ä¸‰æ–¹å­—ä½“ï¼Œtypeface ä¸ºç©ºï¼ŒfamilyName è¢«èµ‹å€¼</p><p>å› æ­¤ï¼Œå½“æˆ‘ä»¬è®¾ç½®äº†è¿™ä¸ªä¸‰ä¸ªå±æ€§ï¼Œtypeface å’Œ familyName æ€»æœ‰ä¸€ä¸ªä¸ä¼šä¸ºç©ºï¼Œå› æ­¤ä¸ä¼šèµ°ç¬¬ä¸‰ä¸ªæ¡ä»¶ä½“ï¼Œé‚£ä¹ˆ typeface è®¾ç½®çš„å±æ€§å°±ä¸ä¼šç”Ÿæ•ˆäº†ï¼Œè€Œå‰©ä¸‹çš„ä¸¤ä¸ªå±æ€§éƒ½èƒ½å¤Ÿç”Ÿæ•ˆ</p><p>æœ€åå¯¹è¿™ä¸‰ä¸ªå±æ€§åšä¸€ä¸ªæ€»ç»“ï¼š</p><p><strong>1ã€fontFamilyã€typeface å±æ€§ç”¨äºå­—ä½“è®¾ç½®ï¼Œå¦‚æœéƒ½è®¾ç½®äº†ï¼Œä¼˜å…ˆä½¿ç”¨ fontFamily å±æ€§ï¼Œtypeface å±æ€§ä¸ä¼šç”Ÿæ•ˆ</strong></p><p><strong>2ã€textStyle ç”¨äºå­—ä½“æ ·å¼è®¾ç½®ï¼Œä¸å­—ä½“è®¾ç½®ä¸ä¼šäº§ç”Ÿå†²çª</strong></p><p>ä¸Šé¢è¿™æ®µæºç åˆ†æå¯èƒ½æœ‰ç‚¹ç»•ï¼Œå¦‚æœæœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹ï¼Œæ¬¢è¿è¯„è®ºåŒºç»™æˆ‘ç•™è¨€æé—®</p><h2 id="å…­ã€TextView-è®¾ç½®å­—ä½“å±æ€§æºç åˆ†æ"><a href="#å…­ã€TextView-è®¾ç½®å­—ä½“å±æ€§æºç åˆ†æ" class="headerlink" title="å…­ã€TextView è®¾ç½®å­—ä½“å±æ€§æºç åˆ†æ"></a>å…­ã€TextView è®¾ç½®å­—ä½“å±æ€§æºç åˆ†æ</h2><p>é€šè¿‡ä¸Šé¢æºç çš„åˆ†æï¼Œæˆ‘ä»¬æ¸…æ¥šäº† fontFamilyï¼Œtypeface å’Œ textStyle è¿™ä¸‰è€…çš„å…³ç³»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ï¼Œæˆ‘ä»¬è®¾ç½®çš„è¿™äº›å±æ€§æ˜¯æ€ä¹ˆå®ç°è¿™äº›æ•ˆæœçš„å‘¢ï¼Ÿåˆåˆ°äº†æºç åˆ†æç¯èŠ‚ğŸ˜‚ï¼Œå¯èƒ½ä¼šæœ‰ç‚¹æ¯ç‡¥ï¼Œä½†æ˜¯å¦‚æœä½ èƒ½å¤Ÿè®¤çœŸçœ‹å®Œï¼Œä¸€å®šä¼šæ”¶è·å¾ˆå¤šï¼Œå¹²å°±å®Œäº†</p><p>æˆ‘ä»¬ä¸Šé¢ç”¨ Xml æˆ–ä»£ç è®¾ç½®çš„å­—ä½“å±æ€§ï¼Œæœ€ç»ˆéƒ½ä¼šèµ°åˆ° TextView çš„ setTypeface é‡è½½æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é‡è½½æ–¹æ³•ä¸€</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTypeface</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Typeface tf)</span> &#123;<br>    <span class="hljs-keyword">if</span> (mTextPaint.getTypeface() != tf) &#123;<br>      <span class="hljs-comment">//é€šè¿‡ mTextPaint è®¾ç½®å­—ä½“</span><br>        mTextPaint.setTypeface(tf);<br>      <br>      <span class="hljs-comment">//åˆ·æ–°é‡ç»˜</span><br>        <span class="hljs-keyword">if</span> (mLayout != <span class="hljs-literal">null</span>) &#123;<br>            nullLayouts();<br>            requestLayout();<br>            invalidate();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//é‡è½½æ–¹æ³•äºŒ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTypeface</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Typeface tf, <span class="hljs-meta">@Typeface</span>.Style <span class="hljs-type">int</span> style)</span> &#123;<br>  <span class="hljs-keyword">if</span> (style &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (tf == <span class="hljs-literal">null</span>) &#123;<br>            tf = Typeface.defaultFromStyle(style);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tf = Typeface.create(tf, style);<br>        &#125;<br><span class="hljs-comment">//è°ƒç”¨é‡è½½æ–¹æ³•ä¸€ï¼Œè®¾ç½®å­—ä½“</span><br>        setTypeface(tf);<br>      <span class="hljs-comment">//ç»è¿‡ä¸€äº›ç®—æ³•</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">typefaceStyle</span> <span class="hljs-operator">=</span> tf != <span class="hljs-literal">null</span> ? tf.getStyle() : <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">need</span> <span class="hljs-operator">=</span> style &amp; ~typefaceStyle;<br>      <span class="hljs-comment">//æ‰“å¼€ç”»ç¬”çš„ç²—ä½“å’Œæ–œä½“</span><br>        mTextPaint.setFakeBoldText((need &amp; Typeface.BOLD) != <span class="hljs-number">0</span>);<br>        mTextPaint.setTextSkewX((need &amp; Typeface.ITALIC) != <span class="hljs-number">0</span> ? -<span class="hljs-number">0.25f</span> : <span class="hljs-number">0</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        mTextPaint.setFakeBoldText(<span class="hljs-literal">false</span>);<br>        mTextPaint.setTextSkewX(<span class="hljs-number">0</span>);<br>        setTypeface(tf);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ†æä¸‹ä¸Šè¿°ä»£ç ï¼š</p><p>é‡è½½æ–¹æ³•ä¸€ï¼š</p><p>TextView è®¾ç½®å­—ä½“å®é™…ä¸Šå°±æ˜¯æ“ä½œ mTextPaintï¼ŒmTextPaint æ˜¯ TextPaint çš„ç±»å¯¹è±¡ï¼Œç»§æ‰¿è‡ª Paint å³ç”»ç¬”ï¼Œå› æ­¤æˆ‘ä»¬è®¾ç½®çš„å­—ä½“å®é™…ä¸Šä¼šé€šè¿‡è°ƒç”¨ç”»ç¬”çš„æ–¹æ³•æ¥è¿›è¡Œç»˜åˆ¶</p><p>é‡è½½æ–¹æ³•äºŒï¼š</p><p>ç›¸å¯¹äºé‡è½½æ–¹æ³•ä¸€ï¼Œæ³•äºŒå¤šä¼ é€’äº†ä¸€ä¸ª textStyle å‚æ•°ï¼Œä¸»è¦ç”¨æ¥æ ‡è®°ç²—ä½“å’Œæ–œä½“çš„ï¼š</p><p>1ï¼‰ã€å¦‚æœè®¾ç½®äº† textStyle ï¼Œè¿›å…¥ç¬¬ä¸€ä¸ªæ¡ä»¶ä½“ï¼Œåˆ†æƒ…å†µï¼š1ã€å¦‚æœä¼ è¿›æ¥çš„ tf ä¸º null ï¼Œåˆ™ä¼šæ ¹æ®ä¼ å…¥çš„ style å»è·å– Typeface å­—ä½“ï¼Œ2ã€å¦‚æœä¸ä¸º null ï¼Œåˆ™ä¼šæ ¹æ®ä¼ å…¥çš„ tf å’Œ style å»è·å– Typeface å­—ä½“ã€‚è®¾ç½®å¥½å­—ä½“åï¼Œæ¥ä¸‹æ¥è¿˜ä¼šæ‰“å¼€ç”»ç¬”çš„ç²—ä½“å’Œæ–œä½“è®¾ç½®</p><p>2ï¼‰ã€å¦‚æœæ²¡æœ‰è®¾ç½® textStyleï¼Œåˆ™åªä¼šè®¾ç½®å­—ä½“ï¼Œå¹¶æŠŠç”»ç¬”çš„ç²—æ–œä½“è®¾ç½®ç½®ä¸º false å’Œ 0</p><p>ä»ä¸Šè¿°åˆ†ææˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼š<strong>TextView è®¾ç½®å­—ä½“å’Œå­—ä½“æ ·å¼æœ€ç»ˆéƒ½æ˜¯é€šè¿‡ç”»ç¬”æ¥å®Œæˆçš„</strong></p><h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦è®²äº†ï¼š</p><p>1ã€Android å­—ä½“å¤§æ¦‚çš„ä¸€ä¸ªä»‹ç»</p><p>2ã€å…³äºå½±å“ Android å­—ä½“æ˜¾ç¤ºçš„ä¸‰ä¸ªå±æ€§</p><p>3ã€textStyleï¼Œtypefaceï¼ŒfontFamily ä¸‰è€…çš„ä¸€ä¸ªå…³ç³»</p><p>4ã€è®¾ç½®çš„è¿™ä¸‰ä¸ªå±æ€§æ˜¯æ€ä¹ˆå®ç°è¿™äº›æ•ˆæœçš„ï¼Ÿ</p><p>å¯èƒ½å¤§å®¶ä¼šé—®ï¼Œä½ ä¸Šé¢é‚£ä¸ªéœ€æ±‚è¿˜æ²¡è®²æ€ä¹ˆå°±è¦ç»“æŸäº†å‘¢ï¼Ÿæˆ‘ä¸Šé¢é‚£ä¸ªéœ€æ±‚ï¼Œä»¥ä»Šå¤©æ‰€è®²çš„çŸ¥è¯†å¯èƒ½è¿˜å®ç°ä¸äº†ï¼Œåˆ«ç€æ€¥ï¼Œå…³äº Android å­—ä½“æˆ‘å‡†å¤‡å†™ä¸ªç³»åˆ—ï¼Œå› ä¸ºå†…å®¹å®åœ¨æ˜¯å¤ªå¤šäº†ã€‚è¿™ä¸ªç³»åˆ—æ–‡ç« ä¸ä¼šè®©å¤§å®¶ç­‰å¤ªä¹…ï¼Œå› ä¸ºåœ¨å‚åŠ æ˜é‡‘ 6 æœˆæ›´æ–‡æŒ‘æˆ˜ï¼Œå‡†å¤‡çˆ†è‚ 9 ç¯‡ğŸ˜„</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘ä»¬è¯„è®ºåŒºä¸€èµ·è®¨è®ºğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Font</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android Font</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆå››ï¼‰ã€Gradle æ’ä»¶å®æˆ˜åº”ç”¨</title>
    <link href="/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%E3%80%81Gradle%20%E6%8F%92%E4%BB%B6%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/"/>
    <url>/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%E3%80%81Gradle%20%E6%8F%92%E4%BB%B6%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e23167cf69c4ce5b86bd8ddf3640aec~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>å…³äº Gradle å­¦ä¹ ï¼Œæˆ‘æ‰€ç†è§£çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e010cee57604e179607243e027608d4~tplv-k3u1fbpfcp-zoom-1.image" alt="Gradle_learning"></p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²äº†è‡ªå®šä¹‰ Gradle æ’ä»¶ç›¸å…³çš„å†…å®¹ï¼Œå®Œæˆäº†ç¬¬ä¸‰ä¸ªç¯èŠ‚ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6988051489306443789">Gradle ç³»åˆ— ï¼ˆä¸‰ï¼‰ã€Gradle æ’ä»¶å¼€å‘</a>ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä»‹ç»çš„è¿˜æ˜¯ç¯èŠ‚ä¸‰ï¼šGradle æ’ä»¶å®æˆ˜åº”ç”¨</p><p><a href="https://github.com/sweetying520/GradleDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥ç»“åˆ demo ä¸€èµ·çœ‹ï¼Œæ•ˆæœæ æ æ»´ğŸº</p><h2 id="ä¸€ã€å›é¡¾"><a href="#ä¸€ã€å›é¡¾" class="headerlink" title="ä¸€ã€å›é¡¾"></a>ä¸€ã€å›é¡¾</h2><p>ä¹‹å‰åœ¨è®² <a href="https://juejin.cn/post/6979191724983713805">Android APT ç³»åˆ— ï¼ˆå››ï¼‰ï¼šAPT å®æˆ˜åº”ç”¨</a> çš„æ—¶å€™ï¼Œæˆ‘ä»¬åšäº†ä¸€æ¬¡å¸ƒå±€ä¼˜åŒ–ï¼ŒAndroid ä¸­å°‘é‡çš„ç³»ç»Ÿæ§ä»¶æ˜¯é€šè¿‡ <code>new</code> çš„æ–¹å¼åˆ›å»ºå‡ºæ¥çš„ï¼Œè€Œå¤§éƒ¨åˆ†æ§ä»¶å¦‚ <code>androidx.appcompat.widget</code> ä¸‹çš„æ§ä»¶ï¼Œè‡ªå®šä¹‰æ§ä»¶ï¼Œç¬¬ä¸‰æ–¹æ§ä»¶ç­‰ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡åå°„åˆ›å»ºçš„ã€‚å¤§é‡çš„åå°„åˆ›å»ºå¤šå¤šå°‘å°‘ä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å»è§£å†³åå°„åˆ›å»ºçš„é—®é¢˜ï¼Œæˆ‘çš„è§£å†³æ€è·¯æ˜¯ï¼š</p><blockquote><p>1ã€é€šè¿‡ç¼–å†™ Android æ’ä»¶è·å– Xml å¸ƒå±€ä¸­çš„æ‰€æœ‰æ§ä»¶</p><p>2ã€æ‹¿åˆ°æ§ä»¶åï¼Œé€šè¿‡ APT ç”Ÿæˆç”¨ <code>new</code> çš„æ–¹å¼åˆ›å»º View çš„ç±»</p><p>3ã€æœ€åé€šè¿‡åå°„è·å–å½“å‰ç±»å¹¶åœ¨åŸºç±»é‡Œé¢å®Œæˆæ›¿æ¢</p></blockquote><p>å…¶ä¸­ 1 çš„å…·ä½“æµç¨‹æ˜¯ï¼šé€šè¿‡ Android æ’ä»¶è·å–æ‰€æœ‰ Xml å¸ƒå±€ä¸­çš„æ§ä»¶åç§°ï¼Œå¹¶å†™å…¥åˆ°ä¸€ä¸ª<code>.txt</code>æ–‡ä»¶ä¸­ã€‚å›  Gradle ç³»åˆ—è¿˜æ²¡è®²ï¼Œå½“æ—¶åªæ˜¯å‡è®¾è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å·²ç»ä¼šäº†å¦‚ä½•è‡ªå®šä¹‰ Gradle æ’ä»¶ï¼Œæˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹å®ƒã€‚</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ Extension å’Œ Variants ï¼Œåç»­ä¼šç”¨åˆ°</p><h2 id="äºŒã€Extension-ä»‹ç»"><a href="#äºŒã€Extension-ä»‹ç»" class="headerlink" title="äºŒã€Extension ä»‹ç»"></a>äºŒã€Extension ä»‹ç»</h2><h3 id="1ï¼‰ã€ä»€ä¹ˆæ˜¯-Extension-ï¼Ÿ"><a href="#1ï¼‰ã€ä»€ä¹ˆæ˜¯-Extension-ï¼Ÿ" class="headerlink" title="1ï¼‰ã€ä»€ä¹ˆæ˜¯ Extension ï¼Ÿ"></a>1ï¼‰ã€ä»€ä¹ˆæ˜¯ Extension ï¼Ÿ</h3><p>Extension ä¸­æ–‡æ„æ€å³æ‰©å±•ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯é€šè¿‡å®ç°è‡ªå®šä¹‰çš„ Extensionï¼Œå¯ä»¥åœ¨ Gradle è„šæœ¬æ–‡ä»¶ä¸­å¢åŠ ç±»ä¼¼ android è¿™æ ·å‘½åçš„ç©ºé—´é…ç½®ï¼ŒGradle å¯ä»¥è¯†åˆ«è¿™ç§é…ç½®ï¼Œå¹¶è¯»å–é‡Œé¢çš„é…ç½®å†…å®¹ã€‚ä»¥ä¸€æ®µæˆ‘ä»¬ç†Ÿæ‚‰çš„ Android é…ç½®ä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    compileSdkVersion <span class="hljs-number">30</span><br><br>    defaultConfig &#123;<br>        applicationId <span class="hljs-string">&#x27;com.dream.gradledemo&#x27;</span><br>        minSdkVersion <span class="hljs-number">19</span><br>        targetSdkVersion <span class="hljs-number">30</span><br>        versionCode <span class="hljs-number">1</span><br>        versionName <span class="hljs-string">&#x27;1.0&#x27;</span><br><br>        testInstrumentationRunner <span class="hljs-string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span><br>    &#125;<br><br>    buildTypes &#123;<br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">false</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¹‹æ‰€ä»¥èƒ½å¤Ÿè¿™æ ·é…ç½®ï¼Œæ˜¯å› ä¸º Android Gradle Plugin å®šä¹‰äº†è¿™äº› Extension </p><p>é‚£ä¹ˆå¦‚ä½•å»è‡ªå®šä¹‰ Extension å‘¢ï¼Ÿ</p><p>ç­”ï¼šé€šè¿‡ ExtensionContainer</p><h3 id="2ï¼‰ã€é€šè¿‡-ExtensionContainer-è‡ªå®šä¹‰-Extension"><a href="#2ï¼‰ã€é€šè¿‡-ExtensionContainer-è‡ªå®šä¹‰-Extension" class="headerlink" title="2ï¼‰ã€é€šè¿‡ ExtensionContainer è‡ªå®šä¹‰ Extension"></a>2ï¼‰ã€é€šè¿‡ ExtensionContainer è‡ªå®šä¹‰ Extension</h3><p>ExtensionContainer å’Œ TaskContainer å¾ˆç±»ä¼¼ï¼Œä¸Šç¯‡æ–‡ç« æˆ‘ä»¬è®²åˆ° TaskContainer å°±æ˜¯ç®¡ç† Task çš„ä¸€ä¸ªå®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ TaskContainer å»å¯¹ Task è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚åŒç†ï¼ŒExtensionContainer æ˜¯ç®¡ç† Extension çš„ä¸€ä¸ªå®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ExtensionContainer å»å¯¹ Extension è¿›è¡Œç›¸åº”çš„æ“ä½œï¼ŒExtensionContainer åŒæ ·å¯ä»¥é€šè¿‡ Project å¯¹è±¡è·å–åˆ°ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><br><span class="hljs-comment">//ä¸‹é¢è¿™ 4 ç§æ–¹å¼æ‹¿åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹</span><br><span class="hljs-comment">//æ–¹å¼1</span><br>extensions<br><span class="hljs-comment">//æ–¹å¼2</span><br>project.extensions<br><span class="hljs-comment">//æ–¹å¼3</span><br>getExtensions()<br><span class="hljs-comment">//æ–¹å¼4</span><br>project.getExtensions()<br></code></pre></td></tr></table></figure><p>é€šè¿‡ ExtensionContainer åˆ›å»ºæ‰©å±•çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><p>1ã€é€šè¿‡ ExtensionContainer çš„ create ç³»åˆ—æ–¹æ³•åˆ›å»º Extension</p><p>2ã€é€šè¿‡ ExtensionContainer çš„ add ç³»åˆ—æ–¹æ³•åˆ›å»º Extension</p><h3 id="3ï¼‰ã€é€šè¿‡-ExtensionContainer-çš„-create-ç³»åˆ—æ–¹æ³•åˆ›å»º-Extension"><a href="#3ï¼‰ã€é€šè¿‡-ExtensionContainer-çš„-create-ç³»åˆ—æ–¹æ³•åˆ›å»º-Extension" class="headerlink" title="3ï¼‰ã€é€šè¿‡ ExtensionContainer çš„ create ç³»åˆ—æ–¹æ³•åˆ›å»º Extension"></a>3ï¼‰ã€é€šè¿‡ ExtensionContainer çš„ create ç³»åˆ—æ–¹æ³•åˆ›å»º Extension</h3><p>é¦–å…ˆçœ‹ä¸€çœ¼ ExtensionContainer æä¾›çš„ create ç³»åˆ—æ–¹æ³•ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b025403581ff4f5fad2a4f888e786500~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210725182159725"></p><p>ä¸Šè¿°æˆªå›¾å¯ä»¥çœ‹åˆ°å®ƒæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€ä¸€ä»‹ç»ä¸‹</p><h4 id="1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•"><a href="#1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•" class="headerlink" title="1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•"></a>1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>aClassï¼šè¯¥ Extension çš„ Class ç±»å‹å¯¹è±¡</p><p>objectsï¼šå½“å‰ç±»çš„æ„é€ å‡½æ•°å‚æ•°å€¼ï¼Œè¯¥å‚æ•°ä¸ºå¯é€‰é¡¹ï¼Œä¸å¡«åˆ™å–é»˜è®¤å€¼</p></blockquote><h4 id="2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•"><a href="#2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•" class="headerlink" title="2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•"></a>2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>aClassï¼šåˆ›å»ºçš„ Extension å®ä¾‹æš´éœ²å‡ºæ¥çš„ Class ç±»å‹å¯¹è±¡ï¼Œä¸€èˆ¬è¿™é‡Œæˆ‘ä»¬ä¼šæŒ‡å®šçˆ¶ç±»çš„ Class ç±»å‹å¯¹è±¡</p><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>aClass1ï¼šè¯¥ Extension å…·ä½“çš„å®ç° Class ç±»å‹å¯¹è±¡</p><p>objectsï¼šå…·ä½“å®ç°ç±»çš„æ„é€ å‡½æ•°å‚æ•°å€¼ï¼Œè¯¥å‚æ•°ä¸ºå¯é€‰é¡¹ï¼Œä¸å¡«åˆ™å–é»˜è®¤å€¼</p></blockquote><h4 id="3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•"><a href="#3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•" class="headerlink" title="3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•"></a>3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>typeOfï¼šåˆ›å»ºçš„ Extension å®ä¾‹æš´éœ²å‡ºæ¥çš„ TypeOf ç±»å‹å¯¹è±¡ï¼Œä¸€èˆ¬è¿™é‡Œæˆ‘ä»¬ä¼šæŒ‡å®šçˆ¶ç±»çš„ TypeOf ç±»å‹å¯¹è±¡</p><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>aClassï¼šè¯¥ Extension å…·ä½“çš„å®ç° Class ç±»å‹å¯¹è±¡</p><p>objectsï¼šå…·ä½“å®ç°ç±»çš„æ„é€ å‡½æ•°å‚æ•°å€¼ï¼Œè¯¥å‚æ•°ä¸ºå¯é€‰é¡¹ï¼Œä¸å¡«åˆ™å–é»˜è®¤å€¼</p></blockquote><h4 id="4ã€å…·ä½“ä½¿ç”¨"><a href="#4ã€å…·ä½“ä½¿ç”¨" class="headerlink" title="4ã€å…·ä½“ä½¿ç”¨"></a>4ã€å…·ä½“ä½¿ç”¨</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><br><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šå¢åŠ å®ä½“ç±»é…ç½®</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br><br>    String animalName<br>    <span class="hljs-type">int</span> legs<br><br>    Animal()&#123;<br><br>    &#125;<br><br>    Animal(String animalName) &#123;<br>        <span class="hljs-variable language_">this</span>.animalName = animalName<br>    &#125;<br><br>    String toString() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;This animal is $animalName, it has $legs legs.&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span>&#123;<br>    <span class="hljs-type">int</span> age = <span class="hljs-number">5</span><br><br>    Dog()&#123;<br>      <br>    &#125;<br><br>    Dog(<span class="hljs-type">int</span> age) &#123;<br>        <span class="hljs-variable language_">this</span>.age = age<br>    &#125;<br><br>    String toString() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.toString() + <span class="hljs-string">&quot; Its age is $age.&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šåˆ›å»º Extension</span><br><span class="hljs-comment">//=================== ExtensionContainer create ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.create(<span class="hljs-string">&#x27;animal1&#x27;</span>,Dog)<br><br><span class="hljs-comment">//=================== ExtensionContainer create ç¬¬äºŒä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.create(Animal,<span class="hljs-string">&#x27;animal2&#x27;</span>,Dog,<span class="hljs-number">10</span>)<br><br><span class="hljs-comment">//=================== ExtensionContainer create ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.create(TypeOf.typeOf(Animal),<span class="hljs-string">&#x27;animal3&#x27;</span>,Dog,<span class="hljs-number">15</span>)<br><br><span class="hljs-comment">//ç¬¬ä¸‰æ­¥ï¼šè¿›è¡Œè¯­å¥å—é…ç½®</span><br>animal1&#123;<br>    animalName <span class="hljs-string">&#x27;å¤§é»„&#x27;</span><br>    legs <span class="hljs-number">4</span><br>&#125;<br><br>animal2&#123;<br>    animalName <span class="hljs-string">&#x27;äºŒé»„&#x27;</span><br>    legs <span class="hljs-number">4</span><br>&#125;<br><br>animal3&#123;<br>    animalName <span class="hljs-string">&#x27;ä¸‰é»„&#x27;</span><br>    legs <span class="hljs-number">4</span><br>&#125;<br><br><span class="hljs-comment">//ç¬¬å››æ­¥ï¼šç¼–å†™ Task è¿›è¡Œæµ‹è¯•</span><br>project.task(<span class="hljs-string">&#x27;testTask&#x27;</span>)&#123;<br>    doLast &#123;<br>        println project.animal1<br>        println project.animal2<br>        println project.animal3<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ testTask</span><br>./gradlew testTask<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>testTask<br>This animal is å¤§é»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">5.</span><br>This animal is äºŒé»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">10.</span><br>This animal is ä¸‰é»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">15.</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> Groovy è¯­æ³•è§„å®šï¼Œå½“ä¼ å…¥ Class å¯¹è±¡ä½œä¸ºå‚æ•°çš„æ—¶å€™ï¼Œ<code>.class</code> åç¼€å¯çœç•¥ï¼Œå¦‚ï¼š<code>Animal.class</code> å¯ä»¥å†™æˆ <code>Animal</code>ï¼Œå¯¹ Groovy è¯­æ³•è¿˜ä¸ç†Ÿçš„å¯ä»¥æŸ¥çœ‹æˆ‘è¿™ç¯‡æ–‡ç«  <a href="https://juejin.cn/post/6939662617224937503">ä¼ é€é—¨</a></p><h3 id="4ï¼‰ã€é€šè¿‡-ExtensionContainer-çš„-add-ç³»åˆ—æ–¹æ³•åˆ›å»º-Extension"><a href="#4ï¼‰ã€é€šè¿‡-ExtensionContainer-çš„-add-ç³»åˆ—æ–¹æ³•åˆ›å»º-Extension" class="headerlink" title="4ï¼‰ã€é€šè¿‡ ExtensionContainer çš„ add ç³»åˆ—æ–¹æ³•åˆ›å»º Extension"></a>4ï¼‰ã€é€šè¿‡ ExtensionContainer çš„ add ç³»åˆ—æ–¹æ³•åˆ›å»º Extension</h3><p>é¦–å…ˆè¿˜æ˜¯å…ˆçœ‹ä¸€çœ¼ ExtensionContainer æä¾›çš„ add ç³»åˆ—æ–¹æ³•ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee01092e480f4907803dcec035daf77a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210725181835083"></p><p>å¯ä»¥çœ‹åˆ°å®ƒä¹Ÿæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€ä¸€ä»‹ç»ä¸‹</p><h4 id="1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•-1"><a href="#1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•-1" class="headerlink" title="1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•"></a>1ã€ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>oï¼šObject ç±»å‹ï¼Œå¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡æˆ– Class å¯¹è±¡</p></blockquote><h4 id="2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•-1"><a href="#2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•-1" class="headerlink" title="2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•"></a>2ã€ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>aClassï¼šåˆ›å»ºçš„ Extension å®ä¾‹æš´éœ²å‡ºæ¥çš„ Class ç±»å‹å¯¹è±¡ï¼Œä¸€èˆ¬è¿™é‡Œæˆ‘ä»¬ä¼šæŒ‡å®šçˆ¶ç±»çš„ Class ç±»å‹å¯¹è±¡</p><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>tï¼šObject ç±»å‹ï¼Œå…·ä½“çš„ Class å¯¹è±¡æˆ–å®ä¾‹å¯¹è±¡</p></blockquote><h4 id="3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•-1"><a href="#3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•-1" class="headerlink" title="3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•"></a>3ã€ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•</h4><p><strong>å‚æ•°ä»‹ç»ï¼š</strong></p><blockquote><p>typeOfï¼šåˆ›å»ºçš„ Extension å®ä¾‹æš´éœ²å‡ºæ¥çš„ TypeOf ç±»å‹å¯¹è±¡ï¼Œä¸€èˆ¬è¿™é‡Œæˆ‘ä»¬ä¼šæŒ‡å®šçˆ¶ç±»çš„ TypeOf ç±»å‹å¯¹è±¡</p><p>sï¼šè¦åˆ›å»ºçš„ Extension çš„åå­—ï¼Œå¯ä»¥æ˜¯ä»»æ„ç¬¦åˆå‘½åè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸å·²æœ‰çš„é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</p><p>tï¼šObject ç±»å‹ï¼Œå…·ä½“çš„ Class å¯¹è±¡æˆ–å®ä¾‹å¯¹è±¡</p></blockquote><h4 id="4ã€å…·ä½“ä½¿ç”¨-1"><a href="#4ã€å…·ä½“ä½¿ç”¨-1" class="headerlink" title="4ã€å…·ä½“ä½¿ç”¨"></a>4ã€å…·ä½“ä½¿ç”¨</h4><p>æˆ‘ä»¬ä¿®æ”¹ä¸Šè¿°ä»£ç çš„ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥å®ç°ä¸ä¹‹å‰ä¸€æ ·çš„æ‰“å°æ•ˆæœ</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><br><span class="hljs-comment">//=================== ExtensionContainer add ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.add(<span class="hljs-string">&#x27;animal1&#x27;</span>,Dog)<br><br><span class="hljs-comment">//=================== ExtensionContainer add ç¬¬äºŒä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.add(Animal,<span class="hljs-string">&#x27;animal2&#x27;</span>,<span class="hljs-keyword">new</span> Dog(<span class="hljs-number">10</span>))<br><br><span class="hljs-comment">//=================== ExtensionContainer add ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³• =========================</span><br>project.extensions.add(TypeOf.typeOf(Animal),<span class="hljs-string">&#x27;animal3&#x27;</span>,<span class="hljs-keyword">new</span> Dog(<span class="hljs-number">15</span>))<br><br>animal1&#123;<br>    animalName <span class="hljs-string">&#x27;å¤§é»„&#x27;</span><br>    legs <span class="hljs-number">4</span><br>&#125;<br><br><span class="hljs-comment">//æ³¨æ„è¿™é‡Œä½¿ç”¨äº† = å·</span><br>animal2&#123;<br>    animalName = <span class="hljs-string">&#x27;äºŒé»„&#x27;</span><br>    legs = <span class="hljs-number">4</span><br>&#125;<br><br><span class="hljs-comment">//æ³¨æ„è¿™é‡Œä½¿ç”¨äº† = å·</span><br>animal3&#123;<br>    animalName = <span class="hljs-string">&#x27;ä¸‰é»„&#x27;</span><br>    legs = <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> ä¸Šè¿° add ç³»åˆ—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œå½“æˆ‘ä»¬æ˜¾ç¤ºçš„åˆ›å»ºäº†ç±»å®ä¾‹ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œ Extension é…ç½®çš„æ—¶å€™ï¼Œéœ€è¦åŠ ä¸Š <strong>&#x3D;</strong> å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><h3 id="5ï¼‰ã€å®šä¹‰å±æ€§åŒåçš„æ–¹æ³•å»æ‰-x3D-å·"><a href="#5ï¼‰ã€å®šä¹‰å±æ€§åŒåçš„æ–¹æ³•å»æ‰-x3D-å·" class="headerlink" title="5ï¼‰ã€å®šä¹‰å±æ€§åŒåçš„æ–¹æ³•å»æ‰ &#x3D; å·"></a>5ï¼‰ã€å®šä¹‰å±æ€§åŒåçš„æ–¹æ³•å»æ‰ &#x3D; å·</h3><p>å¦‚æœæƒ³å»æ‰ä¸Šè¿°ä½¿ç”¨ add ç³»åˆ—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•é…ç½®è¯­å¥çš„ <strong>&#x3D;</strong> å·ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å’Œå±æ€§åŒåçš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br><br>    String animalName<br>    <span class="hljs-type">int</span> legs<br><br>    <span class="hljs-type">void</span> animalName(String animalName)&#123;<br>        <span class="hljs-variable language_">this</span>.animalName = animalName<br>    &#125;<br><br>    <span class="hljs-type">void</span> legs(<span class="hljs-type">int</span> legs)&#123;<br>        <span class="hljs-variable language_">this</span>.legs = legs<br>    &#125;<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¿™æ ·å†™äº†</span><br>animal2&#123;<br>    animalName <span class="hljs-string">&#x27;äºŒé»„&#x27;</span><br>    legs <span class="hljs-number">4</span><br>&#125;<br><br>animal3&#123;<br>    animalName = <span class="hljs-string">&#x27;ä¸‰é»„&#x27;</span><br>    legs = <span class="hljs-number">4</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ï¼‰ã€create-ç³»åˆ—æ–¹æ³•å’Œ-add-ç³»åˆ—æ–¹æ³•æ¯”è¾ƒ"><a href="#6ï¼‰ã€create-ç³»åˆ—æ–¹æ³•å’Œ-add-ç³»åˆ—æ–¹æ³•æ¯”è¾ƒ" class="headerlink" title="6ï¼‰ã€create ç³»åˆ—æ–¹æ³•å’Œ add ç³»åˆ—æ–¹æ³•æ¯”è¾ƒ"></a>6ï¼‰ã€create ç³»åˆ—æ–¹æ³•å’Œ add ç³»åˆ—æ–¹æ³•æ¯”è¾ƒ</h3><h4 id="ç›¸åŒç‚¹ï¼š"><a href="#ç›¸åŒç‚¹ï¼š" class="headerlink" title="ç›¸åŒç‚¹ï¼š"></a>ç›¸åŒç‚¹ï¼š</h4><blockquote><p>1ã€éƒ½å¯ä»¥é€šè¿‡é”®å€¼å¯¹çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>&#x3D;</strong> è¿›è¡Œé…ç½®ï¼Œæœ€ç»ˆè°ƒç”¨çš„éƒ½æ˜¯å±æ€§çš„ setter æ–¹æ³•</p><p>2ã€éƒ½ä¼šæŠ›å¼‚å¸¸ï¼šå½“éœ€è¦åˆ›å»ºçš„ Extension å·²ç»å­˜åœ¨çš„æ—¶å€™ï¼Œå³ Extension é‡å¤ï¼Œåˆ™ä¼šæŠ›å¼‚å¸¸</p></blockquote><h4 id="ä¸åŒç‚¹ï¼š"><a href="#ä¸åŒç‚¹ï¼š" class="headerlink" title="ä¸åŒç‚¹ï¼š"></a>ä¸åŒç‚¹ï¼š</h4><blockquote><p>1ã€create ç³»åˆ—æ–¹æ³•ä¼šå°†ä¼ å…¥çš„æ³›å‹ T ä½œä¸ºè¿”å›å€¼ã€‚add ç³»åˆ—æ–¹æ³•å¹¶ä¸ä¼š</p><p>2ã€add ç³»åˆ—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œå½“æˆ‘ä»¬æ˜¾ç¤ºçš„åˆ›å»ºäº†ç±»å®ä¾‹ï¼Œåœ¨è¿›è¡Œ Extension é…ç½®çš„æ—¶å€™éœ€åŠ ä¸Š <strong>&#x3D;</strong> ï¼Œcreate ç³»åˆ—æ–¹æ³•ä¸éœ€è¦</p></blockquote><h3 id="7ï¼‰ã€é€šè¿‡-ExtensionContainer-getByName-å’Œ-findByName-ç³»åˆ—æ–¹æ³•æŸ¥æ‰¾-Extension"><a href="#7ï¼‰ã€é€šè¿‡-ExtensionContainer-getByName-å’Œ-findByName-ç³»åˆ—æ–¹æ³•æŸ¥æ‰¾-Extension" class="headerlink" title="7ï¼‰ã€é€šè¿‡ ExtensionContainer getByName å’Œ findByName ç³»åˆ—æ–¹æ³•æŸ¥æ‰¾ Extension"></a>7ï¼‰ã€é€šè¿‡ ExtensionContainer getByName å’Œ findByName ç³»åˆ—æ–¹æ³•æŸ¥æ‰¾ Extension</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€find ç³»åˆ—æ–¹æ³•</span><br>Object findByName(String name)<br>&lt;T&gt; T findByType(Class&lt;T&gt; type)<br><br><span class="hljs-comment">//2ã€get ç³»åˆ—æ–¹æ³•</span><br>Object getByName(String name)<br>&lt;T&gt; T getByType(Class&lt;T&gt; type)<br><br><span class="hljs-comment">//3ã€find ç³»åˆ—æ–¹æ³•å’Œ get ç³»åˆ—æ–¹æ³•åŒºåˆ«</span><br><span class="hljs-comment">//get ç³»åˆ—æ–¹æ³•æ‰¾ä¸åˆ°ä¼šæŠ›å¼‚å¸¸ï¼Œfind ç³»åˆ—æ–¹æ³•ä¸ä¼š</span><br><br><span class="hljs-comment">//4ã€å…·ä½“ä½¿ç”¨</span><br>println project.extensions.getByName(<span class="hljs-string">&quot;animal1&quot;</span>)<br>println project.extensions.getByName(<span class="hljs-string">&quot;animal2&quot;</span>)<br>println project.extensions.getByName(<span class="hljs-string">&quot;animal3&quot;</span>)<br><br>println project.extensions.findByName(<span class="hljs-string">&quot;animal1&quot;</span>)<br>println project.extensions.findByName(<span class="hljs-string">&quot;animal2&quot;</span>)<br>println project.extensions.findByName(<span class="hljs-string">&quot;animal3&quot;</span>)<br><br><span class="hljs-comment">//æ‰“å°ç»“æœå‡ä¸º</span><br>This animal is å¤§é»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">5.</span><br>This animal is äºŒé»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">10.</span><br>This animal is ä¸‰é»„, it has <span class="hljs-number">4</span> legs. Its age is <span class="hljs-number">15.</span><br></code></pre></td></tr></table></figure><h3 id="8ï¼‰ã€é…ç½®åµŒå¥—-Extension"><a href="#8ï¼‰ã€é…ç½®åµŒå¥—-Extension" class="headerlink" title="8ï¼‰ã€é…ç½®åµŒå¥— Extension"></a>8ï¼‰ã€é…ç½®åµŒå¥— Extension</h3><h5 id="1ã€é€šè¿‡å®šä¹‰æ–¹æ³•é…ç½®åµŒå¥—-Extension"><a href="#1ã€é€šè¿‡å®šä¹‰æ–¹æ³•é…ç½®åµŒå¥—-Extension" class="headerlink" title="1ã€é€šè¿‡å®šä¹‰æ–¹æ³•é…ç½®åµŒå¥— Extension"></a>1ã€é€šè¿‡å®šä¹‰æ–¹æ³•é…ç½®åµŒå¥— Extension</h5><p>æˆ‘ä»¬ç»å¸¸åœ¨ android é…ç½®å—çœ‹åˆ°è¿™ç§åµŒå¥— Extension ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    compileSdkVersion <span class="hljs-number">30</span><br>    defaultConfig &#123;<br>        applicationId <span class="hljs-string">&#x27;com.dream.gradledemo&#x27;</span><br>        minSdkVersion <span class="hljs-number">19</span><br>        targetSdkVersion <span class="hljs-number">30</span><br>        versionCode <span class="hljs-number">1</span><br>        versionName <span class="hljs-string">&#x27;1.0&#x27;</span><br>    &#125;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å®ç°ä¸€ä¸ªç±»ä¼¼çš„ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><br><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šå¢åŠ å®ä½“ç±»é…ç½®</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidExt</span>&#123;<br>    <span class="hljs-type">int</span> compileSdkVersionExt<br><br>    DefaultConfigExt defaultConfigExt = <span class="hljs-keyword">new</span> DefaultConfigExt()<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹å¼1:</span><br><span class="hljs-comment">     * é€šè¿‡ Action åˆ›å»ºå†…éƒ¨ Extensionï¼Œåç§°ä¸ºæ–¹æ³•å defaultConfig</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param action å¯æ‰§è¡Œçš„åŠ¨ä½œï¼Œå®è´¨ä¸Šæ˜¯ä¸€ä¸ªä»£ç å—</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">void</span> defaultConfigExt(Action&lt;DefaultConfigExt&gt; action) &#123;<br>        action.execute(defaultConfigExt)<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹å¼2:</span><br><span class="hljs-comment">     * é€šè¿‡ ConfigureUtil åˆ›å»ºå†…éƒ¨ Extensionï¼Œåç§°ä¸ºæ–¹æ³•å defaultConfig</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param closure é—­åŒ…ï¼Œå®è´¨ä¸Šæ˜¯ä¸€ä¸ªä»£ç å—</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">void</span> defaultConfigExt(Closure&lt;DefaultConfigExt&gt; closure) &#123;<br>        org.gradle.util.ConfigureUtil.configure(closure, defaultConfigExt)<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultConfigExt</span>&#123;<br>    String applicationIdExt<br>    <span class="hljs-type">int</span> minSdkVersionExt<br>    <span class="hljs-type">int</span> targetSdkVersionExt<br>    <span class="hljs-type">int</span> versionCodeExt<br>    String versionNameExt<br>&#125;<br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šåˆ›å»º Extension</span><br>project.extensions.create(<span class="hljs-string">&#x27;androidExt&#x27;</span>,AndroidExt)<br><br><span class="hljs-comment">//ç¬¬ä¸‰æ­¥ï¼šè¿›è¡Œè¯­å¥å—é…ç½®</span><br>androidExt &#123;<br>    compileSdkVersionExt <span class="hljs-number">30</span><br>    defaultConfigExt &#123;<br>        applicationIdExt = <span class="hljs-string">&#x27;com.dream.gradledemo&#x27;</span><br>        minSdkVersionExt = <span class="hljs-number">19</span><br>        targetSdkVersionExt = <span class="hljs-number">30</span><br>        versionCodeExt = <span class="hljs-number">1</span><br>        versionNameExt = <span class="hljs-string">&#x27;1.0&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬å››æ­¥ï¼šç¼–å†™ Task è¿›è¡Œæµ‹è¯•</span><br>project.tasks.create(<span class="hljs-string">&#x27;extensionNested&#x27;</span>)&#123;<br>    doLast &#123;<br>        println project.androidExt.compileSdkVersionExt<br>        println project.androidExt.defaultConfigExt.applicationIdExt<br>        println project.androidExt.defaultConfigExt.minSdkVersionExt<br>        println project.androidExt.defaultConfigExt.targetSdkVersionExt<br>        println project.androidExt.defaultConfigExt.versionCodeExt<br>        println project.androidExt.defaultConfigExt.versionNameExt<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ extensionNested</span><br>./gradlew extensionNested<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>extensionNested<br><span class="hljs-number">30</span><br>com.dream.gradledemo<br><span class="hljs-number">19</span><br><span class="hljs-number">30</span><br><span class="hljs-number">1</span><br><span class="hljs-number">1.0</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªå’Œ android é…ç½®å—ç±»ä¼¼çš„é…ç½®ï¼Œå…³é”®ä»£ç åœ¨äºï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs groovy">DefaultConfigExt defaultConfigExt = <span class="hljs-keyword">new</span> DefaultConfigExt()<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ–¹å¼1:</span><br><span class="hljs-comment"> * é€šè¿‡ Action åˆ›å»ºå†…éƒ¨ Extensionï¼Œåç§°ä¸ºæ–¹æ³•å defaultConfig</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * @param action å¯æ‰§è¡Œçš„åŠ¨ä½œï¼Œå®è´¨ä¸Šæ˜¯ä¸€ä¸ªä»£ç å—</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">void</span> defaultConfigExt(Action&lt;DefaultConfigExt&gt; action) &#123;<br>    action.execute(defaultConfigExt)<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ–¹å¼2:</span><br><span class="hljs-comment"> * é€šè¿‡ ConfigureUtil åˆ›å»ºå†…éƒ¨ Extensionï¼Œåç§°ä¸ºæ–¹æ³•å defaultConfig</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * @param closure é—­åŒ…ï¼Œå®è´¨ä¸Šæ˜¯ä¸€ä¸ªä»£ç å—</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">void</span> defaultConfigExt(Closure&lt;DefaultConfigExt&gt; closure) &#123;<br>    org.gradle.util.ConfigureUtil.configure(closure, defaultConfigExt)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä¿©ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥åˆ›å»ºå†…éƒ¨ Extensionï¼Œå®é™…ä½¿ç”¨åªéœ€è¦å…¶ä¸­ä¸€ä¸ªæ–¹æ³•å°±è¡Œï¼Œ<strong>éœ€è¦æ³¨æ„çš„æ˜¯æ–¹æ³•çš„åå­—å°½é‡å’Œå±æ€§çš„åå­—ä¿æŒä¸€è‡´</strong></p><p>ä¸çŸ¥ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šè¿°æˆ‘çš„ defaultConfigExt é…ç½®å—ä¸­éƒ½åŠ äº† <strong>&#x3D;</strong> å·ï¼Œå®ƒå’Œæˆ‘ä»¬å®é™…çš„ android é…ç½®å—è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«ï¼Œå¯èƒ½ä½ ä¼šé—®ï¼Œæˆ‘èƒ½ä¸èƒ½æŠŠ <strong>&#x3D;</strong> å·ç»™å»æ‰å‘¢ï¼Ÿ</p><p>ç­”ï¼šä¸èƒ½ã€‚å¦‚æœæƒ³å»æ‰ï¼š</p><p>1ã€ä½¿ç”¨ ExtensionContainer ç³»åˆ— API åˆ›å»ºåµŒå¥— Extension</p><p>2ã€åˆ›å»ºä¸å±æ€§åŒåçš„æ–¹æ³•</p><p>åˆ›å»ºä¸å±æ€§åŒåçš„æ–¹æ³•å·²ç»æ¼”ç¤ºè¿‡ï¼Œæˆ‘ä»¬ä¸»è¦æ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨ ExtensionContainer ç³»åˆ— API åˆ›å»ºåµŒå¥— Extension</p><h5 id="2ã€é€šè¿‡-ExtensionContainer-ç³»åˆ—åˆ›å»º-Extension-API-é…ç½®åµŒå¥—-Extension"><a href="#2ã€é€šè¿‡-ExtensionContainer-ç³»åˆ—åˆ›å»º-Extension-API-é…ç½®åµŒå¥—-Extension" class="headerlink" title="2ã€é€šè¿‡ ExtensionContainer ç³»åˆ—åˆ›å»º Extension API é…ç½®åµŒå¥— Extension"></a>2ã€é€šè¿‡ ExtensionContainer ç³»åˆ—åˆ›å»º Extension API é…ç½®åµŒå¥— Extension</h5><p>é€šè¿‡ ExtensionContainer åˆ›å»º Extension æˆ‘ä»¬éƒ½è®²è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥ä¸Šä»£ç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidExt</span>&#123;<br>    <span class="hljs-type">int</span> compileSdkVersionExt<br>  <br>    AndroidExt()&#123;<br>      <span class="hljs-comment">//æ³¨æ„ï¼šè¿™é‡Œçš„ extensions æ˜¯å±äº AndroidExt çš„ï¼Œå¹¶ä¸æ˜¯ project å¯¹è±¡çš„</span><br>        extensions.create(<span class="hljs-string">&#x27;defaultConfigExt&#x27;</span>,DefaultConfigExt)<br>    &#125;<br>&#125;<br><br><br>extensions.create(<span class="hljs-string">&#x27;defaultConfigExt&#x27;</span>,DefaultConfigExt)<br><span class="hljs-comment">//ä¸Šé¢è¿™å¥é…ç½®ç­‰åŒäºä¸‹é¢</span><br>project.extensions.create(<span class="hljs-string">&#x27;androidExt&#x27;</span>,AndroidExt)<br>project.androidExt.extensions.create(<span class="hljs-string">&#x27;defaultConfigExt&#x27;</span>,DefaultConfigExt)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç åœ¨ AndroidExt çš„æ„é€ æ–¹æ³•é‡Œé¢åˆ›å»ºäº†ä¸€ä¸ª DefaultConfigExt çš„æ‰©å±•ï¼Œè¿™æ ·å°±èƒ½å®ç°æŠŠ defaultConfigExt é…ç½®å—ä¸­çš„ <strong>&#x3D;</strong> ç»™å»æ‰</p><h3 id="9ï¼‰ã€é…ç½®ä¸å›ºå®šæ•°é‡-Extension"><a href="#9ï¼‰ã€é…ç½®ä¸å›ºå®šæ•°é‡-Extension" class="headerlink" title="9ï¼‰ã€é…ç½®ä¸å›ºå®šæ•°é‡ Extension"></a>9ï¼‰ã€é…ç½®ä¸å›ºå®šæ•°é‡ Extension</h3><p>æˆ‘ä»¬ç»å¸¸åœ¨ android é…ç½®å—çœ‹åˆ°è¿™ç§ä¸å›ºå®šæ•°é‡çš„ Extension ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildTypes &#123;<br>    release &#123;<br>        <span class="hljs-comment">//å¼€å¯æ··æ·†</span><br>        minifyEnabled <span class="hljs-literal">true</span><br>        <span class="hljs-comment">//èµ„æºå¯¹é½</span><br>        zipAlignEnabled <span class="hljs-literal">true</span><br>        <span class="hljs-comment">//æ˜¯å¦å¼€å¯ debug æ¨¡å¼</span><br>        debuggable <span class="hljs-literal">false</span><br>        <span class="hljs-comment">//...</span><br>    &#125;<br>    debug &#123;<br>        minifyEnabled <span class="hljs-literal">false</span><br>        zipAlignEnabled <span class="hljs-literal">false</span><br>        debuggable <span class="hljs-literal">true</span><br>        <span class="hljs-comment">//...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§ç±»å‹å¯ä»¥ç”¨äºåœ¨ä»£ç å—ä¸­åˆ›å»ºæ–°çš„æŒ‡å®šç±»å‹çš„å¯¹è±¡ã€‚</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹ buildTypes å¯¹åº”çš„æºç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> buildTypes(Action&lt;? super NamedDomainObjectContainer&lt;BuildType&gt;&gt; action) &#123;<br>    this.checkWritability();<br>    action.execute(this.buildTypes);<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒä¼ å…¥çš„æ˜¯ä¸€ä¸ª BuildType ç±»å‹åˆ—è¡¨çš„ Actionï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ° NamedDomainObjectContainer ï¼Œè¿™ä¸ªä¸œè¥¿å¾ˆé‡è¦ï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹å®ƒ</p><h5 id="1ã€NamedDomainObjectContainer-ä»‹ç»"><a href="#1ã€NamedDomainObjectContainer-ä»‹ç»" class="headerlink" title="1ã€NamedDomainObjectContainer ä»‹ç»"></a>1ã€NamedDomainObjectContainer ä»‹ç»</h5><p>NamedDomainObjectContainer ä¸­æ–‡ç¿»è¯‘å³å‘½åé¢†åŸŸå¯¹è±¡å®¹å™¨ï¼Œè¿½æ ¹æº¯æºå®ƒç»§æ‰¿è‡ª <code>Collection&lt;T&gt;</code>ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨è„šæœ¬æ–‡ä»¶ä¸­åˆ›å»ºå¯¹è±¡ï¼Œä¸”åˆ›å»ºçš„å¯¹è±¡å¿…é¡»è¦æœ‰ name è¿™ä¸ªå±æ€§ä½œä¸ºå®¹å™¨å†…å…ƒç´ çš„æ ‡è¯†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Project å¯¹è±¡çš„ container ç³»åˆ—æ–¹æ³•è·å– NamedDomainObjectContainer å¯¹è±¡ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32c3f85769ec493789feddcd96990ea4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210725223142994"></p><p>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ª buildTypes é…ç½®å—ç±»ä¼¼çš„é…ç½®</p><h5 id="2ã€ç±»ä¼¼-buildTypes-é…ç½®å—å¤š-Extension-å®ç°"><a href="#2ã€ç±»ä¼¼-buildTypes-é…ç½®å—å¤š-Extension-å®ç°" class="headerlink" title="2ã€ç±»ä¼¼ buildTypes é…ç½®å—å¤š Extension å®ç°"></a>2ã€ç±»ä¼¼ buildTypes é…ç½®å—å¤š Extension å®ç°</h5><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸­</span><br><br><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šå¢åŠ å®ä½“ç±»é…ç½®</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BuildTypesConfigExt</span>&#123;<br>    <span class="hljs-comment">//æ³¨æ„ï¼šå¿…é¡»è¦æœ‰ name å±æ€§è¿›è¡Œæ ‡è¯†</span><br>    String name<br>    <span class="hljs-type">boolean</span> minifyEnabledExt<br>    <span class="hljs-type">boolean</span> zipAlignEnabled<br>    <span class="hljs-type">boolean</span> debuggableExt<br><br>    BuildTypesConfigExt(String name) &#123;<br>        <span class="hljs-variable language_">this</span>.name = name<br>    &#125;<br><br>    <span class="hljs-comment">//=====================é…ç½®ä¸å±æ€§åŒåçš„æ–¹æ³•================</span><br>    <span class="hljs-type">void</span> minifyEnabledExt(<span class="hljs-type">boolean</span> minifyEnabledExt) &#123;<br>        <span class="hljs-variable language_">this</span>.minifyEnabledExt = minifyEnabledExt<br>    &#125;<br><br>    <span class="hljs-type">void</span> zipAlignEnabled(<span class="hljs-type">boolean</span> zipAlignEnabled) &#123;<br>        <span class="hljs-variable language_">this</span>.zipAlignEnabled = zipAlignEnabled<br>    &#125;<br><br>    <span class="hljs-type">void</span> debuggableExt(<span class="hljs-type">boolean</span> debuggableExt) &#123;<br>        <span class="hljs-variable language_">this</span>.debuggableExt = debuggableExt<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šæ„å»ºå‘½åé¢†åŸŸå¯¹è±¡å®¹å™¨ï¼Œå¹¶æ·»åŠ åˆ° Extension</span><br>NamedDomainObjectContainer&lt;BuildTypesConfigExt&gt; container = project.container(BuildTypesConfigExt)<br>project.extensions.add(<span class="hljs-string">&#x27;buildTypesExt&#x27;</span>,container)<br><br><span class="hljs-comment">//ç¬¬ä¸‰æ­¥ï¼šè¿›è¡Œè¯­å¥å—é…ç½®</span><br>buildTypesExt &#123;<br>    release &#123;<br>        minifyEnabledExt <span class="hljs-literal">true</span><br>        zipAlignEnabled <span class="hljs-literal">true</span><br>        debuggableExt <span class="hljs-literal">false</span><br>    &#125;<br><br>    debug &#123;<br>        minifyEnabledExt <span class="hljs-literal">false</span><br>        zipAlignEnabled <span class="hljs-literal">false</span><br>        debuggableExt <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ç¬¬å››æ­¥ï¼šç¼–å†™ Task è¿›è¡Œæµ‹è¯•</span><br>project.tasks.create(<span class="hljs-string">&quot;buildTypesTask&quot;</span>)&#123;<br>    doLast &#123;<br>        project.buildTypesExt.each&#123;<br>            println <span class="hljs-string">&quot;$it.name: $it.minifyEnabledExt $it.zipAlignEnabled $it.debuggableExt&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ buildTypesTask</span><br>./gradlew buildTypesTask<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>buildTypesTask<br><span class="hljs-attr">debug:</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">release:</span> <span class="hljs-literal">true</span> <span class="hljs-literal">true</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œå…³äº Extension æˆ‘ä»¬å°±ä»‹ç»å®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å˜ä½“ï¼ˆVariantsï¼‰</p><h2 id="ä¸‰ã€å˜ä½“-Variants-ä»‹ç»"><a href="#ä¸‰ã€å˜ä½“-Variants-ä»‹ç»" class="headerlink" title="ä¸‰ã€å˜ä½“ (Variants) ä»‹ç»"></a>ä¸‰ã€å˜ä½“ (Variants) ä»‹ç»</h2><p>å˜ä½“å±äº Android Gradle Pluginï¼ˆåç»­ç»Ÿç§° AGPï¼‰ é‡Œé¢éœ€è¦ä»‹ç»çš„çŸ¥è¯†ç‚¹ï¼Œåç»­ç­‰æˆ‘ä»¬è®²åˆ°  AGP çš„æ—¶å€™åœ¨åšè¯¦ç»†ä»‹ç»ã€‚è¿™é‡Œæš‚æ—¶å…ˆä»‹ç»ä¸€äº›æ¥ä¸‹æ¥ä¼šç”¨åˆ°çš„</p><p> AGP ç»™ android å¯¹è±¡æä¾›äº†ä¸‰ç§ç±»å‹å˜ä½“ï¼ˆVariantsï¼‰ï¼š</p><blockquote><p>1ã€applicationVariantsï¼šåªé€‚ç”¨äº app plugin</p><p>2ã€libraryVariantsï¼šåªé€‚ç”¨äº library plugin</p><p>3ã€testVariantsï¼šåœ¨ app plugin ä¸ libarary plugin ä¸­éƒ½é€‚ç”¨ï¼Œè¿™ä¸ªä¸€èˆ¬å¾ˆå°‘ç”¨</p></blockquote><p>å…¶ä¸­æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¾¿æ˜¯ applicationVariantsï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹å®ƒ</p><h3 id="1ï¼‰ã€applicationVariants-ä½¿ç”¨"><a href="#1ï¼‰ã€applicationVariants-ä½¿ç”¨" class="headerlink" title="1ï¼‰ã€applicationVariants ä½¿ç”¨"></a>1ï¼‰ã€applicationVariants ä½¿ç”¨</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Project å¯¹è±¡è·å– android è¿™ä¸ªå±æ€§ï¼Œç„¶åé€šè¿‡ android åœ¨å»è·å–å˜ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><span class="hljs-comment">//æ–¹å¼1</span><br>android.applicationVariants<br><span class="hljs-comment">//æ–¹å¼2</span><br>project.android.applicationVariants<br><span class="hljs-comment">//æ–¹å¼3</span><br>project.property(<span class="hljs-string">&#x27;android&#x27;</span>).applicationVariants<br></code></pre></td></tr></table></figure><p>ä¸Šè¿° 3 ç§æ–¹å¼è·å–çš„éƒ½æ˜¯åŒä¸€ä¸ªå˜ä½“</p><p>ä¸ºäº†æ›´å¥½çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬åœ¨ app çš„ build.gradle å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    <span class="hljs-comment">//...</span><br><br>    buildTypes &#123;<br>        debug&#123;<br><br>        &#125;<br><br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">false</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br><br><br><br>    productFlavors&#123;<br><br>        flavorDimensions <span class="hljs-string">&#x27;isFree&#x27;</span><br><br>        baidu&#123;<br>            dimension <span class="hljs-string">&#x27;isFree&#x27;</span><br>        &#125;<br><br>        google&#123;<br>            dimension <span class="hljs-string">&#x27;isFree&#x27;</span><br>        &#125;<br><br>        winxin&#123;<br>            dimension <span class="hljs-string">&#x27;isFree&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°é…ç½®ä¼šäº§ç”Ÿ 6 ä¸ªå˜ä½“ï¼Œ<strong>å®é™…ä¸Šå˜ä½“æ˜¯é€šè¿‡ buildTypes å’Œ productFlavors çš„æ’åˆ—ç»„åˆæ‰€äº§ç”Ÿçš„</strong>ï¼Œæˆ‘ä»¬éå†æ‰“å°ä¸€ä¸‹æ¯ä¸ªå˜ä½“çš„ name å’Œ baseName</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€ä» AGP 3.0 å¼€å§‹ï¼Œå¿…é¡»è‡³å°‘æ˜ç¡®æŒ‡å®šä¸€ä¸ª flavor dimension</p><p>2ã€é€šè¿‡ android å¯¹è±¡è·å–çš„ applicationVariants æˆ– libraryVariants æ˜¯æ‰€æœ‰çš„å˜ä½“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éå†å–å‡ºæ¯ä¸€ä¸ªå˜ä½“</p><p>3ã€å…³äºå˜ä½“èƒ½å¤Ÿæ“ä½œçš„å±æ€§å’Œæ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥å»æŸ¥é˜… AGP å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªä¸­æ–‡ç‰ˆçš„ï¼Œ<a href="https://chaosleong.gitbooks.io/gradle-for-android/content/advanced_build_customization/manipulating_tasks.html">ä¼ é€é—¨</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br>afterEvaluate &#123;<br>    project.android.applicationVariants.all&#123; variant -&gt;<br>        println <span class="hljs-string">&quot;$variant.name $variant.baseName&quot;</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>baiduDebug baidu-debug<br>googleDebug google-debug<br>winxinDebug winxin-debug<br>baiduRelease baidu-release<br>googleRelease google-release<br>winxinRelease winxin-release<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢æˆ‘ä»¬å°±èƒ½çœ‹åˆ° name å’Œ baseName çš„ä¸€ä¸ªåŒºåˆ«</p><h3 id="2ï¼‰ã€å¯¹-applicationVariants-ä¸­çš„-Task-è¿›è¡Œ-Hook"><a href="#2ï¼‰ã€å¯¹-applicationVariants-ä¸­çš„-Task-è¿›è¡Œ-Hook" class="headerlink" title="2ï¼‰ã€å¯¹ applicationVariants ä¸­çš„ Task è¿›è¡Œ Hook"></a>2ï¼‰ã€å¯¹ applicationVariants ä¸­çš„ Task è¿›è¡Œ Hook</h3><p>é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨å˜ä½“æ¥å¯¹æ„å»ºè¿‡ç¨‹ä¸­çš„ Task è¿›è¡Œ hookï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br>afterEvaluate &#123;<br>    project.android.applicationVariants.all&#123; variant -&gt;<br>        <span class="hljs-keyword">def</span> task = variant.mergeResources<br>        println <span class="hljs-string">&quot;$task.name&quot;</span><br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>mergeBaiduDebugResources<br>mergeGoogleDebugResources<br>mergeWinxinDebugResources<br>mergeBaiduReleaseResources<br>mergeGoogleReleaseResources<br>mergeWinxinReleaseResources<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æ“ä½œæˆ‘ä»¬æ‹¿åˆ°äº†æ‰€æœ‰å˜ä½“å¯¹åº”çš„ mergeResources Task å¹¶æ‰“å°äº†å®ƒçš„åç§°</p><h3 id="3ï¼‰ã€ä½¿ç”¨-applicationVariants-å¯¹-APK-è¿›è¡Œé‡å‘½å"><a href="#3ï¼‰ã€ä½¿ç”¨-applicationVariants-å¯¹-APK-è¿›è¡Œé‡å‘½å" class="headerlink" title="3ï¼‰ã€ä½¿ç”¨ applicationVariants å¯¹ APK è¿›è¡Œé‡å‘½å"></a>3ï¼‰ã€ä½¿ç”¨ applicationVariants å¯¹ APK è¿›è¡Œé‡å‘½å</h3><p>applicationVariants ä¸­æ¯ä¸€ä¸ªå˜ä½“å¯¹åº”çš„è¾“å‡ºæ–‡ä»¶ä¾¿æ˜¯ä¸€ä¸ª APKï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ applicationVariants å¯¹ APK è¿›è¡Œé‡å‘½åï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸­</span><br><br>project.android.applicationVariants.all&#123; variant -&gt;<br>    variant.outputs.all&#123;<br>        outputFileName = <span class="hljs-string">&quot;$&#123;variant.baseName&#125;&quot;</span> + <span class="hljs-string">&quot;.apk&quot;</span><br>        println outputFileName<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>baidu-debug.apk<br>google-debug.apk<br>winxin-debug.apk<br>baidu-release.apk<br>google-release.apk<br>winxin-release.apk<br></code></pre></td></tr></table></figure><p>å…³äºå˜ä½“æˆ‘ä»¬æš‚æ—¶å°±ä»‹ç»åˆ°è¿™</p><h2 id="å››ã€è·å–-App-ä¸­æ‰€æœ‰-Xml-æ§ä»¶å®æˆ˜åº”ç”¨"><a href="#å››ã€è·å–-App-ä¸­æ‰€æœ‰-Xml-æ§ä»¶å®æˆ˜åº”ç”¨" class="headerlink" title="å››ã€è·å– App ä¸­æ‰€æœ‰ Xml æ§ä»¶å®æˆ˜åº”ç”¨"></a>å››ã€è·å– App ä¸­æ‰€æœ‰ Xml æ§ä»¶å®æˆ˜åº”ç”¨</h2><p>Okï¼Œäº†è§£äº† Extension å’Œ Variants ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ­£å¼è¿›å…¥ Gradle æ’ä»¶å®æˆ˜åº”ç”¨ï¼Œå…³äºå¦‚ä½•è‡ªå®šä¹‰ Gradle æ’ä»¶ï¼Œå‚è€ƒæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6988051489306443789">ä¼ é€é—¨</a>ï¼Œä¸€äº›ç»†èŠ‚æˆ‘ä»¬å°±ç•¥è¿‡äº†</p><h3 id="1ï¼‰ã€æ€è·¯åˆ†æ"><a href="#1ï¼‰ã€æ€è·¯åˆ†æ" class="headerlink" title="1ï¼‰ã€æ€è·¯åˆ†æ"></a>1ï¼‰ã€æ€è·¯åˆ†æ</h3><p>åœ¨ Android æ‰“åŒ…æ„å»ºæµç¨‹ä¸­ï¼Œ<code>merge...Resources</code> è¿™ä¸ª Task ä¼šå¯¹æ‰€æœ‰çš„èµ„æºæ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œè€Œ <code>merge...Resources</code> ä¸­é—´çš„ <code>...</code> ä¼šæ ¹æ®å˜ä½“çš„ä¸åŒè€Œå˜åŒ–ï¼ŒåŒæ—¶å¯¹è¾“å‡ºçš„æ–‡ä»¶ç›®å½•ä¹Ÿæœ‰ä¸€å®šçš„å½±å“ï¼Œä¾‹å¦‚ï¼š</p><p>1ã€å¦‚æœå½“å‰è¿è¡Œçš„æ˜¯ debug ç¯å¢ƒï¼Œé‚£ä¹ˆå˜ä½“å³ debugï¼Œåœ¨ Android æ‰“åŒ…æ„å»ºæµç¨‹ä¸­ï¼Œå°±ä¼šé€šè¿‡ <strong>mergeDebugResources</strong> è¿™ä¸ª Task å¯¹æ‰€æœ‰çš„èµ„æºè¿›è¡Œåˆå¹¶ï¼Œå¹¶å°†åˆå¹¶çš„æ–‡ä»¶è¾“å‡ºåˆ°ï¼š&#x2F;build&#x2F;intermediates&#x2F;incremental&#x2F;mergeDebugResources&#x2F;merger.xml</p><p>2ã€å¦‚æœå½“å‰è¿è¡Œçš„æ˜¯ release ç¯å¢ƒï¼Œé‚£ä¹ˆå˜ä½“å³ releaseï¼Œåœ¨ Android æ‰“åŒ…æ„å»ºæµç¨‹ä¸­ï¼Œå°±ä¼šé€šè¿‡ <strong>mergeReleaseResources</strong> è¿™ä¸ª Task å¯¹æ‰€æœ‰çš„èµ„æºè¿›è¡Œåˆå¹¶ï¼Œå¹¶å°†åˆå¹¶çš„æ–‡ä»¶è¾“å‡ºåˆ°ï¼š&#x2F;build&#x2F;intermediates&#x2F;incremental&#x2F;mergeReleaseResources&#x2F;merger.xml</p><p>é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥ï¼š<strong>è‡ªå®šä¹‰ Gradle æ’ä»¶ï¼Œå°†è‡ªå·±ç¼–å†™çš„ Task æŒ‚æ¥åˆ° mergeâ€¦Resources åé¢ï¼Œç„¶åéå† merger.xml è¿™ä¸ªæ–‡ä»¶ï¼ŒæŠŠå®ƒé‡Œé¢æ‰€æœ‰ Xml ä¸­çš„ View è¾“å‡ºåˆ°ä¸€ä¸ª .txt æ–‡ä»¶ä¸­</strong></p><p>å—¯ï¼Œæ„Ÿè§‰å¯è¡Œï¼Œå¹²å°±å®Œäº†</p><h3 id="2ï¼‰ã€å®æˆ˜åº”ç”¨"><a href="#2ï¼‰ã€å®æˆ˜åº”ç”¨" class="headerlink" title="2ï¼‰ã€å®æˆ˜åº”ç”¨"></a>2ï¼‰ã€å®æˆ˜åº”ç”¨</h3><p>é¦–å…ˆçœ‹ä¸€çœ¼åˆå§‹çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be848f2ca214433790596d648237e3e7~tplv-k3u1fbpfcp-zoom-1.image" alt="init_plugin_constructor"></p><h4 id="1ã€ç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ’ä»¶ï¼Œå°†è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-mergeâ€¦Resources"><a href="#1ã€ç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ’ä»¶ï¼Œå°†è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-mergeâ€¦Resources" class="headerlink" title="1ã€ç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ’ä»¶ï¼Œå°†è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ°  mergeâ€¦Resources"></a>1ã€ç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ’ä»¶ï¼Œå°†è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ°  mergeâ€¦Resources</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">package</span> com.dream.xmlviewscanplugin<br><br><span class="hljs-keyword">import</span> org.gradle.api.Plugin<br><span class="hljs-keyword">import</span> org.gradle.api.Project<br><span class="hljs-keyword">import</span> org.gradle.api.Task<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ‰«æ Xml Plugin</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">XmlViewScanPlugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Plugin</span>&lt;Project&gt;&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-type">void</span> apply(Project project) &#123;<br>        println <span class="hljs-string">&#x27;Hello XmlViewScanPlugin&#x27;</span><br>        <span class="hljs-comment">//æ·»åŠ é»‘åå•æ‰©å±•é…ç½®</span><br>        project.extensions.create(<span class="hljs-string">&#x27;ignore&#x27;</span>,IgnoreViewExtension)<br><br>        project.afterEvaluate &#123;<br>            <span class="hljs-comment">//æ˜¯å¦æ˜¯ Android æ’ä»¶</span><br>            <span class="hljs-keyword">def</span> isAppPlugin = project.plugins.hasPlugin(<span class="hljs-string">&#x27;com.android.application&#x27;</span>)<br><br>            <span class="hljs-comment">//è·å–å˜ä½“</span><br>            <span class="hljs-keyword">def</span> variants<br>            <span class="hljs-keyword">if</span>(isAppPlugin)&#123;<br>                variants = project.android.applicationVariants<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                variants = project.android.libraryVariants<br>            &#125;<br><br>            variants.each&#123; variant -&gt;<br>                <span class="hljs-comment">//é€šè¿‡å˜ä½“è·å–å¯¹åº”çš„ merge...Resources</span><br>                Task mergeResourcesTask = variant.mergeResources<br><br>                <span class="hljs-comment">//å®šä¹‰è‡ªå®šä¹‰ Task æ‰©å±•å‰ç¼€</span><br>                <span class="hljs-keyword">def</span> prefix = variant.name<br>                <span class="hljs-comment">//è·å–æˆ‘ä»¬è‡ªå®šä¹‰çš„ Task</span><br>                Task xmlViewScanTask = project.tasks.create(<span class="hljs-string">&quot;$&#123;prefix&#125;XmlViewScanTask&quot;</span>, XmlViewScanTask,variant)<br><br>                <span class="hljs-comment">//å°†æˆ‘ä»¬è‡ªå®šä¹‰çš„ Task æŒ‚æ¥åˆ° mergeResourcesTask</span><br>                mergeResourcesTask.finalizedBy(xmlViewScanTask)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€ç¬¬äºŒæ­¥ï¼šç¼–å†™è‡ªå®šä¹‰-Task-ï¼Œå°†æ‰«æå‡ºæ¥çš„æ§ä»¶å†™å…¥åˆ°æ–‡ä»¶ä¸­"><a href="#2ã€ç¬¬äºŒæ­¥ï¼šç¼–å†™è‡ªå®šä¹‰-Task-ï¼Œå°†æ‰«æå‡ºæ¥çš„æ§ä»¶å†™å…¥åˆ°æ–‡ä»¶ä¸­" class="headerlink" title="2ã€ç¬¬äºŒæ­¥ï¼šç¼–å†™è‡ªå®šä¹‰ Task ï¼Œå°†æ‰«æå‡ºæ¥çš„æ§ä»¶å†™å…¥åˆ°æ–‡ä»¶ä¸­"></a>2ã€ç¬¬äºŒæ­¥ï¼šç¼–å†™è‡ªå®šä¹‰ Task ï¼Œå°†æ‰«æå‡ºæ¥çš„æ§ä»¶å†™å…¥åˆ°æ–‡ä»¶ä¸­</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">package</span> com.dream.xmlviewscanplugin<br><br><span class="hljs-keyword">import</span> com.android.build.gradle.api.BaseVariant<br><span class="hljs-keyword">import</span> groovy.util.slurpersupport.GPathResult<br><span class="hljs-keyword">import</span> groovy.util.slurpersupport.Node<br><span class="hljs-keyword">import</span> org.gradle.api.DefaultTask<br><span class="hljs-keyword">import</span> org.gradle.api.Task<br><span class="hljs-keyword">import</span> org.gradle.api.tasks.TaskAction<br><span class="hljs-keyword">import</span> javax.inject.Inject<br><span class="hljs-keyword">import</span> java.util.function.Consumer<br><span class="hljs-keyword">import</span> java.util.function.Predicate<br><span class="hljs-keyword">import</span> java.util.stream.Stream<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ‰«æ Xml Task</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">XmlViewScanTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DefaultTask</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Xml å¸ƒå±€ä¸­è¢«æ·»åŠ è¿›æ¥çš„ View</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Set&lt;String&gt; mXmlScanViewSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;()<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“å‰å˜ä½“</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> BaseVariant variant<br><br>    <span class="hljs-meta">@Inject</span><br>    XmlViewScanTask(BaseVariant variant) &#123;<br>        <span class="hljs-variable language_">this</span>.variant = variant<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‰§è¡Œ xml æ‰«æ Task</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TaskAction</span><br>    <span class="hljs-type">void</span> performXmlScanTask() &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            println <span class="hljs-string">&#x27;performXmlScanTask start...&#x27;</span><br><br>            <span class="hljs-comment">//åˆ›å»ºéœ€è¦è¾“å‡º View çš„æ–‡ä»¶è·¯å¾„</span><br>            File outputFile = <span class="hljs-keyword">new</span> File(project.buildDir.path + <span class="hljs-string">&quot;/$&#123;variant.name&#125;_xml_scan_view/xml_scan_view.txt&quot;</span>)<br>            <span class="hljs-keyword">if</span> (!outputFile.parentFile.exists()) &#123;<br>                outputFile.parentFile.mkdirs()<br>            &#125;<br>            <span class="hljs-keyword">if</span> (outputFile.exists()) &#123;<br>                outputFile.delete()<br>            &#125;<br>            outputFile.createNewFile()<br>            println <span class="hljs-string">&#x27;file create success...&#x27;</span><br>            mXmlScanViewSet.clear()<br><br>            <span class="hljs-comment">//è·å– merger.xml æ–‡ä»¶</span><br>            Task mergeResourcesTask = variant.mergeResources<br>            String mergerPath = <span class="hljs-string">&quot;$&#123;project.buildDir.path&#125;/intermediates/incremental/$&#123;mergeResourcesTask.name&#125;/merger.xml&quot;</span><br>            File mergerFile = <span class="hljs-keyword">new</span> File(mergerPath)<br><br>            <span class="hljs-comment">//å¼€å§‹è§£æ  merger.xml</span><br>            XmlSlurper xmlSlurper = <span class="hljs-keyword">new</span> XmlSlurper()<br>            GPathResult result = xmlSlurper.parse(mergerFile)<br>            <span class="hljs-keyword">if</span> (result.children()) &#123;<br>                result.childNodes().forEachRemaining(<span class="hljs-keyword">new</span> Consumer() &#123;<br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-type">void</span> accept(Object o) &#123;<br>                        parseNode(o)<br>                    &#125;<br>                &#125;)<br>            &#125;<br>            println <span class="hljs-string">&#x27;merger.xml parsing success...&#x27;</span><br><br><br>            <span class="hljs-comment">//åˆ°è¿™é‡Œï¼Œæ‰€æœ‰çš„ xml æ§ä»¶éƒ½è¢«æ·»åŠ åˆ°äº†mXmScanViewSet</span><br>            <span class="hljs-comment">//æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦è¯»å–é»‘åå•ä¸­çš„ View å¹¶ç»™è¿‡æ»¤æ‰</span><br>            Stream&lt;String&gt; viewNameStream<br>            <span class="hljs-comment">//æ˜¯å¦å¼€å¯é»‘åå•è¿‡æ»¤åŠŸèƒ½</span><br>            <span class="hljs-keyword">if</span>(project.ignore.isEnable)&#123;<br>                println <span class="hljs-string">&#x27;blacklist enable...&#x27;</span><br>                viewNameStream = filterXmlScanViewSet()<br><br>                <span class="hljs-comment">//å¦‚æœæ­¤æ—¶æ²¡æœ‰é…ç½®é»‘åå• viewNameStream è¿˜æ˜¯ä¼šä¸º null</span><br>                <span class="hljs-keyword">if</span>(viewNameStream == <span class="hljs-literal">null</span>)&#123;<br>                    viewNameStream = mXmlScanViewSet.stream()<br>                &#125;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                println <span class="hljs-string">&#x27;blacklist disable...&#x27;</span><br>                viewNameStream = mXmlScanViewSet.stream()<br>            &#125;<br><br>            <span class="hljs-comment">//å°† viewName å†™å…¥æ–‡ä»¶ä¸­</span><br>            PrintWriter printWriter = <span class="hljs-keyword">new</span> PrintWriter(<span class="hljs-keyword">new</span> FileWriter(outputFile))<br>            viewNameStream.forEach(<span class="hljs-keyword">new</span> Consumer&lt;String&gt;() &#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-type">void</span> accept(String viewName) &#123;<br>                    printWriter.println(viewName)<br>                &#125;<br>            &#125;)<br>            printWriter.flush()<br>            printWriter.close()<br>            println <span class="hljs-string">&#x27;write all viewName to file success...&#x27;</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿‡æ»¤é»‘åå•ä¸­çš„ viewName</span><br><span class="hljs-comment">     * @return Stream&lt;String&gt;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Stream&lt;String&gt; filterXmlScanViewSet() &#123;<br>        List&lt;String&gt; ignoreViewList = project.ignore.ignoreViewList<br>        Stream&lt;String&gt; viewNameStream = <span class="hljs-literal">null</span><br>        <span class="hljs-keyword">if</span> (ignoreViewList) &#123;<br>            println <span class="hljs-string">&quot;ignoreViewList: $ignoreViewList&quot;</span><br>            viewNameStream = mXmlScanViewSet.stream().filter(<span class="hljs-keyword">new</span> Predicate&lt;String&gt;() &#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-type">boolean</span> test(String viewName) &#123;<br>                    <span class="hljs-keyword">for</span> (String <span class="hljs-attr">ignoreViewName :</span> ignoreViewList) &#123;<br>                        <span class="hljs-keyword">if</span> (viewName == ignoreViewName) &#123;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>                        &#125;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>                &#125;<br>            &#125;)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            println <span class="hljs-string">&#x27;ignoreViewList is null, no filter...&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> viewNameStream<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€’å½’è§£æ merger.xml ä¸­çš„ Node èŠ‚ç‚¹</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * merger.xml æ–‡ä»¶ä¸­çš„å¸ƒå±€æ–‡ä»¶æ ‡ç­¾å¦‚ä¸‹ï¼š</span><br><span class="hljs-comment">     * &lt;file name=&quot;activity_main&quot;</span><br><span class="hljs-comment">     *       path=&quot;/Users/zhouying/learning/GradleDemo/app/src/main/res/layout/activity_main.xml&quot;</span><br><span class="hljs-comment">     *       qualifiers=&quot;&quot;</span><br><span class="hljs-comment">     *       type=&quot;layout&quot;/&gt;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">void</span> parseNode(Object obj) &#123;<br>        <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Node) &#123;<br>            Node node = obj<br><br>            <span class="hljs-keyword">if</span> (node) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;file&quot;</span> == node.name() &amp;&amp; <span class="hljs-string">&quot;layout&quot;</span> == node.attributes().get(<span class="hljs-string">&quot;type&quot;</span>)) &#123;<br>                    <span class="hljs-comment">//è·å–å¸ƒå±€æ–‡ä»¶</span><br>                    String layoutPath = node.attributes().get(<span class="hljs-string">&quot;path&quot;</span>)<br>                    File layoutFile = <span class="hljs-keyword">new</span> File(layoutPath)<br><br>                    <span class="hljs-comment">//å¼€å§‹è§£æå¸ƒå±€æ–‡ä»¶</span><br>                    XmlSlurper xmlSlurper = <span class="hljs-keyword">new</span> XmlSlurper()<br>                    GPathResult result = xmlSlurper.parse(layoutFile)<br>                    String viewName = result.name()<br>                    mXmlScanViewSet.add(viewName)<br><br>                    <span class="hljs-keyword">if</span> (result.children()) &#123;<br>                        result.childNodes().forEachRemaining(<span class="hljs-keyword">new</span> Consumer() &#123;<br>                            <span class="hljs-meta">@Override</span><br>                            <span class="hljs-type">void</span> accept(Object o) &#123;<br>                              <span class="hljs-comment">//é€’å½’è§£æå­èŠ‚ç‚¹</span><br>                                parseLayoutNode(o)<br>                            &#125;<br>                        &#125;)<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">//å¦‚æœä¸æ˜¯å¸ƒå±€æ–‡ä»¶ï¼Œé€’å½’è°ƒç”¨</span><br>                    node.childNodes().forEachRemaining(<span class="hljs-keyword">new</span> Consumer() &#123;<br>                        <span class="hljs-meta">@Override</span><br>                        <span class="hljs-type">void</span> accept(Object o) &#123;<br>                            parseNode(o)<br>                        &#125;<br>                    &#125;)<br><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€’å½’è§£æ layout å¸ƒå±€å­èŠ‚ç‚¹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">void</span> parseLayoutNode(Object obj) &#123;<br>        <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Node) &#123;<br>            Node node = obj<br>            <span class="hljs-keyword">if</span> (node) &#123;<br>                mXmlScanViewSet.add(node.name())<br>                node.childNodes().findAll &#123;<br>                    parseLayoutNode(it)<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> </p><p>1ã€ä¸Šè¿°è¿™ç§é€šè¿‡åˆ›å»ºä¸€ä¸ªç±»è‡ªå®šä¹‰ Task æ–¹å¼ï¼Œæ„é€ æ–¹æ³•å¿…é¡»ä½¿ç”¨ <code> @javax.inject.Inject</code> æ³¨è§£æ ‡è¯†ï¼Œå¦‚æœå±æ€§æ²¡æœ‰ä½¿ç”¨ <code>private</code>ä¿®é¥°ç¬¦ä¿®é¥°ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨ <code> @javax.inject.Inject</code> æ³¨è§£æ ‡è¯†ï¼Œå¦åˆ™ Gradle ä¼šæŠ¥é”™</p><p>2ã€è‡ªå®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•åéšæ„å–ï¼Œç„¶åä½¿ç”¨ <code>@TaskAction</code> æ³¨è§£æ ‡è¯†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¼šåœ¨ Gradle çš„æ‰§è¡Œé˜¶æ®µå»æ‰§è¡Œ</p><p>3ã€ä½¿ç”¨ä¸€äº›ç±»æ—¶ï¼Œæ³¨æ„åŒ…ååˆ«å¯¼é”™äº†</p><h4 id="3ã€ç¬¬ä¸‰æ­¥ï¼šå°†æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°ä»“åº“è¿›è¡Œå¼•ç”¨"><a href="#3ã€ç¬¬ä¸‰æ­¥ï¼šå°†æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°ä»“åº“è¿›è¡Œå¼•ç”¨" class="headerlink" title="3ã€ç¬¬ä¸‰æ­¥ï¼šå°†æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°ä»“åº“è¿›è¡Œå¼•ç”¨"></a>3ã€ç¬¬ä¸‰æ­¥ï¼šå°†æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°ä»“åº“è¿›è¡Œå¼•ç”¨</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€æ‰§è¡Œå‘å¸ƒæ’ä»¶çš„ Task æˆ–é€šè¿‡ Gradle å¯è§†åŒ–ç•Œé¢è¿›è¡Œå‘å¸ƒ</span><br><br><span class="hljs-comment">//2ã€æ’ä»¶ä¾èµ–å¼•ç”¨</span><br><span class="hljs-comment">//æ ¹ build.gradle ä¸­</span><br>buildscript &#123;<br>    repositories &#123;<br>      <span class="hljs-comment">//...</span><br>        <span class="hljs-comment">//æœ¬åœ° Maven ä»“åº“</span><br>        maven&#123;<br>            url uri(<span class="hljs-string">&#x27;XmlViewScanPlugin&#x27;</span>)<br>        &#125;<br>    &#125;<br>    dependencies &#123;<br>      <span class="hljs-comment">//...</span><br>        <span class="hljs-comment">//å¼•å…¥æ’ä»¶ä¾èµ–</span><br>        classpath <span class="hljs-string">&#x27;com.dream:xmlviewscanplugin:1.0.2&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//app build.gradle ä¸­</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;XmlViewScanPlugin&#x27;</span><br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢ 3 æ­¥ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸€ä¸ªæ•ˆæœéªŒè¯äº†</p><h4 id="4ã€æ•ˆæœéªŒè¯"><a href="#4ã€æ•ˆæœéªŒè¯" class="headerlink" title="4ã€æ•ˆæœéªŒè¯"></a>4ã€æ•ˆæœéªŒè¯</h4><p>1ã€å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„å¸ƒå±€æ–‡ä»¶ activity_main.xmlï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a612bddf8241459a8d662586ccaaf741~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210728130458228"></p><p>2ã€æ¥ä¸‹æ¥è¿è¡Œé¡¹ç›®çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ view æ˜¯å¦è¢«è¾“å‡ºåˆ° <code>.txt</code>æ–‡ä»¶ä¸­</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/200b0daa1c4e4668b9de44215a993c04~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210728130807224" style="zoom:50%;" /><p>ä¸Šè¿°æˆªå›¾å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„ View è¢«è¾“å‡ºåˆ°äº†<code>.txt</code>æ–‡ä»¶ä¸­ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨éªŒè¯ä¸€ä¸‹é»‘åå•åŠŸèƒ½</p><p>3ã€åœ¨ app çš„ build.gradle æ·»åŠ é»‘åå•é…ç½®</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ignore &#123;<br>    ignoreViewList = [<br>            <span class="hljs-string">&#x27;TextView&#x27;</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠ TextView åŠ å…¥äº†é»‘åå•ï¼Œè¿è¡Œé¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç”Ÿæˆçš„ <code>.txt</code>æ–‡ä»¶æ²¡æœ‰ TextView äº†</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79e53b707f3e401c86b28831704e7edb~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210728141118681" style="zoom:50%;" /><p>è‡³æ­¤ï¼Œå…³äº Gradle æ’ä»¶å®æˆ˜åº”ç”¨å°±è®²å®Œäº†</p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€Extension çš„è¯¦ç»†ä»‹ç»ï¼Œé‡ç‚¹æŒæ¡ï¼š</p><blockquote><p>1ã€å®šä¹‰ Extension çš„å‡ ç§æ–¹æ³•ï¼Œå‚æ•°åŒºåˆ«</p><p>2ã€å¦‚ä½•å®šä¹‰ Extension èƒ½å¤Ÿå»æ‰ &#x3D; å·</p><p>3ã€å¦‚ä½•å®šä¹‰åµŒå¥— Extension å’Œ å¤šä¸ªä¸å›ºå®šæ•°é‡çš„ Extension</p></blockquote><p>2ã€é€šè¿‡å˜ä½“å¯¹æ„å»ºæµç¨‹ä¸­çš„ Task è¿›è¡Œ Hook</p><p>3ã€è‡ªå®šä¹‰ Gradle æ’ä»¶å°†æ‰€æœ‰ Xml ä¸­çš„ View è¾“å‡ºåˆ°ä¸€ä¸ª<code>.txt</code>æ–‡ä»¶ä¸­</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²è‡ªå®šä¹‰ Gradle Transformï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6844904135314128903">æ·±åº¦æ¢ç´¢ Gradle è‡ªåŠ¨åŒ–æ„å»ºæŠ€æœ¯ï¼ˆå››ã€è‡ªå®šä¹‰ Gradle æ’ä»¶)</a></p><p><a href="https://www.jianshu.com/p/58d86b4c0ee5">Android Gradleå­¦ä¹ (äº”)ï¼šExtensionè¯¦è§£</a></p><p><a href="https://juejin.cn/post/6986806041618939917">Gradle åˆ›å»ºæ‰©å±•å±æ€§è¯¦è§£</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆä¸‰ï¼‰ã€Gradle æ’ä»¶å¼€å‘</title>
    <link href="/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81Gradle%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"/>
    <url>/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81Gradle%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/88e8b68394d54c0c958f093127b3ce96~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>å…³äº Gradle å­¦ä¹ ï¼Œæˆ‘æ‰€ç†è§£çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c09f872b2165474f81381f51f996cde5~tplv-k3u1fbpfcp-zoom-1.image" alt="Gradle_learning"></p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²äº† Gradle çš„ç”Ÿå‘½å‘¨æœŸåŠä¸€äº›å¸¸ç”¨ APIï¼Œäº†è§£äº† Settingsï¼ŒProjectï¼ŒTask ç­‰ç­‰ï¼Œå®Œæˆäº†ç¬¬äºŒä¸ªç¯èŠ‚ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6986191903888769032">Gradle ç³»åˆ— ï¼ˆäºŒï¼‰ã€Gradle æŠ€æœ¯æ¢ç´¢</a>ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»ç¯èŠ‚ä¸‰ï¼šç†Ÿæ‚‰è‡ªå®šä¹‰ Gradle æ’ä»¶</p><p>Gradle ç»™æˆ‘ä»¬æä¾›äº†æ„å»ºåº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æ˜¯å¦‚æœè¦ç¼–è¯‘æ„å»º Android å·¥ç¨‹ï¼Œå°±éœ€è¦é€šè¿‡ Gradle æ’ä»¶æ¥å®ç°äº†ï¼ŒGoogle å¼€å‘äº†ä¸€å¥— Android Gradle Plugin æ’ä»¶ä¸“é—¨æ¥ç¼–è¯‘æ„å»º Android å·¥ç¨‹ã€‚æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ Gradle æ’ä»¶å»å®Œæˆä¸€äº›ç‰¹å®šçš„åŠŸèƒ½</p><p><a href="https://github.com/sweetying520/GradleDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥ç»“åˆ demo ä¸€èµ·çœ‹ï¼Œæ•ˆæœæ æ æ»´ğŸº</p><h2 id="ä¸€ã€Gradle-æ’ä»¶ä»‹ç»"><a href="#ä¸€ã€Gradle-æ’ä»¶ä»‹ç»" class="headerlink" title="ä¸€ã€Gradle æ’ä»¶ä»‹ç»"></a>ä¸€ã€Gradle æ’ä»¶ä»‹ç»</h2><h3 id="1ï¼‰ã€ä»€ä¹ˆæ˜¯-Gradle-æ’ä»¶ï¼Ÿ"><a href="#1ï¼‰ã€ä»€ä¹ˆæ˜¯-Gradle-æ’ä»¶ï¼Ÿ" class="headerlink" title="1ï¼‰ã€ä»€ä¹ˆæ˜¯ Gradle æ’ä»¶ï¼Ÿ"></a>1ï¼‰ã€ä»€ä¹ˆæ˜¯ Gradle æ’ä»¶ï¼Ÿ</h3><p>ç®€å•çš„ç†è§£ï¼šGradle æ’ä»¶å°±æ˜¯å°è£…äº†ä¸€ç³»åˆ— Task å¹¶æ‰§è¡Œ</p><h3 id="2ï¼‰ã€æ’ä»¶åˆ†ç±»"><a href="#2ï¼‰ã€æ’ä»¶åˆ†ç±»" class="headerlink" title="2ï¼‰ã€æ’ä»¶åˆ†ç±»"></a>2ï¼‰ã€æ’ä»¶åˆ†ç±»</h3><p>Android ä¸‹çš„ Gradle æ’ä»¶åˆ†ä¸ºä¸¤ç§ï¼š</p><p>1)ã€è„šæœ¬æ’ä»¶</p><p>è„šæœ¬æ’ä»¶å°±æ˜¯åœ¨ Android å·¥ç¨‹ä¸­åˆ›å»ºä¸€ä¸ª <code>.gradle</code>ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ <code>apply from</code> çš„æ–¹å¼å»å¼•ç”¨è¿™ä¸ªæ’ä»¶</p><p>2)ã€å¯¹è±¡æ’ä»¶</p><p>å¯¹è±¡æ’ä»¶å°±æ˜¯å®ç°äº†  <code>org.gradle.api.plugins</code> æ¥å£çš„æ’ä»¶ï¼ŒGradle æœ¬èº«å°±ç»™æˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—å¯¹è±¡æ’ä»¶ï¼Œå¦‚ï¼š<code>java</code> ï¼Œ<code>groovy</code> ï¼Œ<code>maven-publish</code> ç­‰ç­‰ã€‚è€Œå¦‚æœæˆ‘ä»¬è¦è‡ªå®šä¹‰å¯¹è±¡æ’ä»¶ï¼Œåˆ™æœ‰ä»¥ä¸‹ä¸‰ç§ç¼–å†™å½¢å¼ï¼š</p><p>1ã€åœ¨ build.gradle æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™</p><p>2ã€åœ¨ buildSrc é»˜è®¤æ’ä»¶ç›®å½•ä¸‹ç¼–å†™</p><p>3ã€åœ¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™</p><p>ç„¶åé€šè¿‡ <code>apply plugin</code> çš„æ–¹å¼å»å¼•ç”¨è¿™ä¸ªæ’ä»¶</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€ä¸€æ¼”ç¤ºä¸€ä¸‹</p><h2 id="äºŒã€è„šæœ¬æ’ä»¶"><a href="#äºŒã€è„šæœ¬æ’ä»¶" class="headerlink" title="äºŒã€è„šæœ¬æ’ä»¶"></a>äºŒã€è„šæœ¬æ’ä»¶</h2><p>1ï¼‰ã€åˆ›å»ºä¸€ä¸ªä»¥ <code>.gradle</code> ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œåå­—éšæ„å–ã€‚è¿™é‡Œæˆ‘åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ª script.gradle çš„æ–‡ä»¶å¹¶éšæ„ç¼–å†™äº†ä¸€äº›é€»è¾‘</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fea94ae1d3d04696960ef930ad82a052~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210721213439960"></p><p>2ï¼‰ã€åœ¨ build.gradle ä¸­é€šè¿‡ <code>apply from</code> è¿›è¡Œæ’ä»¶çš„å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸­</span><br><br><span class="hljs-comment">//ç›¸å¯¹è·¯å¾„</span><br>apply <span class="hljs-attr">from:</span> <span class="hljs-string">&#x27;../script.gradle&#x27;</span><br><br><span class="hljs-comment">//ç»å¯¹è·¯å¾„</span><br>apply <span class="hljs-attr">from:</span> rootDir.path + <span class="hljs-string">&#x27;/script.gradle&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸Šè¿°æ–¹å¼çš„å¼•ç”¨å®é™…ä¸Šæ˜¯è°ƒç”¨äº†project å¯¹è±¡çš„ apply æ–¹æ³•ï¼Œæ–¹æ³•ä¸­ä¼ å…¥ä¸€ä¸ª mapã€‚map çš„ key æ˜¯ <code>from</code>ï¼Œvalue æ˜¯ <code>../script.gradle</code> ã€‚<code>apply plugin: &#39;...&#39;</code> ä¹Ÿæ˜¯åŒæ ·çš„é“ç†</p><p>3ï¼‰ã€ä½¿ç”¨æ’ä»¶æä¾›çš„åŠŸèƒ½</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸­</span><br><br><span class="hljs-comment">//1ã€æ‰“å°æ‰©å±•å±æ€§</span><br>println property1<br>println property2<br><br><span class="hljs-comment">//2ã€æ‰§è¡Œ scriptTask</span><br>./gradlew scriptTask<br><br><span class="hljs-comment">//æ‰§è¡Œç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>erdai<br><span class="hljs-number">666</span><br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>scriptTask<br>Hello, I am Script Plugin<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€å¯¹è±¡æ’ä»¶"><a href="#ä¸‰ã€å¯¹è±¡æ’ä»¶" class="headerlink" title="ä¸‰ã€å¯¹è±¡æ’ä»¶"></a>ä¸‰ã€å¯¹è±¡æ’ä»¶</h2><p>ä¸Šé¢è®²åˆ°å¯¹è±¡æ’ä»¶å°±æ˜¯å®ç°äº† <code>org.gradle.api.plugin</code> æ¥å£çš„æ’ä»¶ï¼Œè‡ªå®šä¹‰å¯¹è±¡æ’ä»¶ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ç¼–å†™å½¢å¼ï¼š</p><p><strong>æ³¨æ„ï¼š</strong> ä¸‹é¢æ¼”ç¤ºçš„æ’ä»¶éƒ½æ˜¯é€šè¿‡ groovy è¯­æ³•ç¼–å†™çš„</p><h3 id="1ï¼‰ã€build-gradle-æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™"><a href="#1ï¼‰ã€build-gradle-æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™" class="headerlink" title="1ï¼‰ã€build.gradle æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™"></a>1ï¼‰ã€build.gradle æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸­</span><br><br><span class="hljs-comment">//1ã€é€šè¿‡ apply plugin å¼•ç”¨å½“å‰æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> Method1Plugin<br><br><span class="hljs-comment">//2ã€è‡ªå®šä¹‰å¯¹è±¡æ’ä»¶</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Method1Plugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Plugin</span>&lt;Project&gt; &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-type">void</span> apply(Project project) &#123;<br>        println <span class="hljs-string">&#x27;æˆ‘æ˜¯è‡ªå®šä¹‰ Method1Plugin &#x27;</span><br><br>        project.task(<span class="hljs-string">&quot;Method1PluginTask&quot;</span>)&#123;<br>            doLast &#123;<br>                println <span class="hljs-string">&#x27;Method1PluginTask exec success...&#x27;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æ‰§è¡Œ Method1PluginTask</span><br>./gradlew Method1PluginTask<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>I am Method1Plugin <br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>Method1PluginTask<br>Method1PluginTask exec success...<br></code></pre></td></tr></table></figure><p>ä½†è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼š<strong>åªèƒ½åœ¨å½“å‰ build.gradle è„šæœ¬æ–‡ä»¶ä¸‹ä½¿ç”¨ï¼Œå…¶ä»–çš„  build.gradle ç”¨ä¸äº†ï¼Œå±€é™æ€§å¾ˆå¼º</strong></p><p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ buildSrc çš„æ–¹å¼æ¥ç¼–å†™æ’ä»¶</p><h3 id="2ï¼‰ã€buildSrc-é»˜è®¤æ’ä»¶ç›®å½•ä¸‹ç¼–å†™"><a href="#2ï¼‰ã€buildSrc-é»˜è®¤æ’ä»¶ç›®å½•ä¸‹ç¼–å†™" class="headerlink" title="2ï¼‰ã€buildSrc é»˜è®¤æ’ä»¶ç›®å½•ä¸‹ç¼–å†™"></a>2ï¼‰ã€buildSrc é»˜è®¤æ’ä»¶ç›®å½•ä¸‹ç¼–å†™</h3><p>åœ¨ Android å·¥ç¨‹ä¸­ï¼ŒbuildSrc æ˜¯ Gradle é»˜è®¤çš„æ’ä»¶ç›®å½•ï¼Œç¼–è¯‘ Gradle çš„æ—¶å€™ä¼šè‡ªåŠ¨è¯†åˆ«è¿™ä¸ªç›®å½•ï¼Œå› æ­¤åœ¨ buildSrc ä¸‹ç¼–å†™çš„æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œå¼•ç”¨ã€‚<strong>é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨è¿™ç§æ–¹å¼è¿›è¡Œæ’ä»¶çš„è°ƒè¯•</strong></p><p>buildSrc æ–¹å¼å…·ä½“ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><h4 id="1ã€æ­¥éª¤ä¸€"><a href="#1ã€æ­¥éª¤ä¸€" class="headerlink" title="1ã€æ­¥éª¤ä¸€"></a>1ã€æ­¥éª¤ä¸€</h4><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º <strong>buildSrc</strong> çš„ Java Module (å»ºç«‹ Android Module ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯åˆ é™¤çš„ä¸œè¥¿å¤šğŸ˜‚)ï¼Œåªä¿ç•™ <strong>build.gradle</strong> æ–‡ä»¶å’Œ <strong>src&#x2F;main</strong> ç›®å½•ï¼Œå…¶ä½™çš„å…¨éƒ¨åˆ é™¤</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€åˆ›å»ºçš„ Module åå­—ä¸€å®šè¦æ˜¯ buildSrc , ä¸ç„¶ä¼šæ‰¾ä¸åˆ°æ’ä»¶</p><p>2ã€buildSrc çš„æ‰§è¡Œæ—¶æœºä¸ä»…æ—©äºä»»ä½•â¼€ä¸ª projectï¼ˆbuild.gradleï¼‰ï¼Œè€Œä¸”ä¹Ÿæ—©äº settings.gradle</p><p>3ã€å½“ä½ åˆ›å»ºä¸€ä¸ª buildSrc Module åï¼ˆæ— è®ºæ˜¯ Java Module è¿˜æ˜¯ Android Moduleï¼‰ï¼ŒGradle æ„å»ºçš„æ—¶å€™ä¼šåœ¨ settings.gradle æ–‡ä»¶ä¸­å¼•å…¥å½“å‰ moduleï¼Œ å› æ­¤å®ƒä¼šè¢«æ‰§è¡Œä¸¤éï¼Œè¿™ä¸ªæ—¶å€™ Gradle ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48731dd12c4d4829940395f69a83e7fa~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722104436027"></p><p>å¤§è‡´æ„æ€æ˜¯ï¼šâ€™buildSrcâ€™ ä¸èƒ½ç”¨ä½œé¡¹ç›®åï¼Œå› ä¸ºå®ƒæ˜¯ä¿ç•™åã€‚å› æ­¤æˆ‘ä»¬éœ€è¦åˆ é™¤ settings.gradle æ–‡ä»¶ä¸­å¼•å…¥çš„ buildSrc é…ç½®</p><h4 id="2ã€æ­¥éª¤äºŒ"><a href="#2ã€æ­¥éª¤äºŒ" class="headerlink" title="2ã€æ­¥éª¤äºŒ"></a>2ã€æ­¥éª¤äºŒ</h4><p>ä¿®æ”¹ build.gradle æ–‡ä»¶ä¸­çš„å†…å®¹</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//ä¾èµ– groovy æ’ä»¶ï¼Œè¿™ä¸ªæ˜¯ Gradle å†…ç½®çš„æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;groovy&#x27;</span><br><br><span class="hljs-comment">//å¼•å…¥ç›¸å…³çš„ä¾èµ–</span><br>dependencies &#123;<br>    <span class="hljs-comment">//Groovy DSL</span><br>    implementation gradleApi()<br>    <span class="hljs-comment">//Gradle DSL</span><br>    implementation localGroovy()<br>&#125;<br><br><span class="hljs-comment">//å¼•å…¥ç›¸å…³çš„ä»“åº“</span><br>repositories &#123;<br>    mavenCentral()<br>&#125;<br><br><span class="hljs-comment">//æŒ‡å®šå¥½ç›¸å…³èµ„æºç›®å½•ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥ä¸ç”¨æŒ‡å®šï¼ŒAndroidStudio èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å‡ºæ¥</span><br>sourceSets &#123;<br>    main &#123;<br>        groovy &#123;<br>            srcDir <span class="hljs-string">&#x27;src/main/groovy&#x27;</span><br>        &#125;<br>      <br>      resources &#123;<br>            srcDir <span class="hljs-string">&#x27;src/main/resources&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹å¥½åï¼Œ build ä¸€ä¸‹é¡¹ç›®ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±èƒ½çœ‹åˆ° Gradle æŠŠå®ƒè¯†åˆ«ä¸ºä¸€ä¸ªæ’ä»¶ç›®å½•äº†</p><h4 id="3ã€æ­¥éª¤ä¸‰"><a href="#3ã€æ­¥éª¤ä¸‰" class="headerlink" title="3ã€æ­¥éª¤ä¸‰"></a>3ã€æ­¥éª¤ä¸‰</h4><p>åœ¨ src&#x2F;main ä¸‹åˆ›å»º groovy ç›®å½•ï¼Œç„¶åæ ¹æ®è‡ªå·±å–œå¥½åˆ›å»ºæ’ä»¶ä»£ç å­˜æ”¾çš„åŒ…è·¯å¾„ï¼Œç¼–å†™æ’ä»¶å³å¯ï¼Œæˆ‘ç¼–å†™çš„æ’ä»¶ä»£ç å¦‚ä¸‹æˆªå›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7ad37d5e82334a7298b3b764a4eb78f4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722160741350"></p><p><strong>æ³¨æ„ï¼š</strong></p><p>1ã€æˆ‘è¿™é‡Œæ˜¯ç”¨ groovy è¯­æ³•å†™çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª <code>.groovy</code> ä¸ºåç¼€çš„æ–‡ä»¶ç¼–å†™æ’ä»¶ä»£ç ï¼Œæˆ‘åˆ›å»ºçš„æ˜¯ï¼š BuildSrcPlugin.groovy</p><p>2ã€åˆ›å»ºçš„ groovy æ–‡ä»¶é‡Œé¢å•¥éƒ½æ²¡æœ‰ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼•å…¥åŒ…è·¯å¾„ï¼Œç„¶åè¿›è¡Œç›¸å…³é€»è¾‘ç¼–å†™</p><h4 id="4ã€æ­¥éª¤å››"><a href="#4ã€æ­¥éª¤å››" class="headerlink" title="4ã€æ­¥éª¤å››"></a>4ã€æ­¥éª¤å››</h4><p>è¿™ä¸€æ­¥å®é™…ä¸Šå°±æ˜¯æ³¨å†Œæˆ‘ä»¬ç¼–å†™çš„æ’ä»¶ç±»ï¼Œæ–¹ä¾¿å¤–éƒ¨å¼•ç”¨ï¼Œä»‹ç»ä¸¤ç§æ³¨å†Œæ–¹å¼ï¼š</p><p>1ã€åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶å¤¹è¿›è¡Œæ’ä»¶æ³¨å†Œ</p><p>2ã€é€šè¿‡ Gradle é…ç½®è¿›è¡Œæ’ä»¶æ³¨å†Œ</p><h5 id="1ã€åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶å¤¹è¿›è¡Œæ’ä»¶æ³¨å†Œ"><a href="#1ã€åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶å¤¹è¿›è¡Œæ’ä»¶æ³¨å†Œ" class="headerlink" title="1ã€åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶å¤¹è¿›è¡Œæ’ä»¶æ³¨å†Œ"></a>1ã€åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶å¤¹è¿›è¡Œæ’ä»¶æ³¨å†Œ</h5><p>åœ¨  src&#x2F;main ä¸‹åˆ›å»º resources ç›®å½•ï¼Œåœ¨  resources ç›®å½•ä¸‹åˆ›å»º META-INF ç›®å½•ï¼Œåœ¨ META-INF ç›®å½•ä¸‹åˆ›å»º gradle-plugins ç›®å½•ï¼Œåœ¨ gradle-plugins ç›®å½•ä¸‹åˆ›å»º <code>.properties</code> ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œåå­—å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½å–ï¼Œæœ€ååœ¨åˆ›å»ºçš„ properties æ–‡ä»¶ä¸‹æ ‡è¯†è¯¥æ’ä»¶å¯¹åº”çš„ç±»è·¯å¾„å³å¯å®Œæˆæ’ä»¶çš„æ³¨å†Œï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation-<span class="hljs-keyword">class</span>=com.dream.plugin.BuildSrcPlugin<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€ä¸Šé¢çš„ç›®å½•åç§°éƒ½æ˜¯å›ºå®šçš„ï¼Œåˆ«å†™é”™äº†ï¼Œä¸ç„¶å¼•ç”¨çš„æ—¶å€™ä¼šæ‰¾ä¸åˆ°æ’ä»¶</p><p>2ã€ä½ åˆ›å»ºçš„è¿™ä¸ª properties æ–‡ä»¶çš„åå­—å¾ˆé‡è¦ï¼Œåç»­å¼•ç”¨æ’ä»¶å°±æ˜¯æ ¹æ®è¿™ä¸ªåç§°æ¥çš„ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºçš„åç§°ä¸º <strong>BuildSrcPlugin.properties</strong> , é‚£ä¹ˆå¼•ç”¨æ’ä»¶çš„æ—¶å€™å°±æ˜¯è¿™æ ·ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;BuildSrcPlugin&#x27;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä¸‰ï¼Œå››æ­¥éª¤å®Œæˆåï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2cd9b620154744b5882de52ccd4aae62~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722143609118"></p><p>è¿™ç§æ³¨å†Œæ–¹å¼æ¯”è¾ƒå›ºå®šï¼Œå®¹æ˜“å‡ºé”™ï¼Œä¸æ¨èä½¿ç”¨ï¼Œä¸‹é¢ä»‹ç»å¦å¤–ä¸€ç§æ³¨å†Œæ–¹å¼</p><h5 id="2ã€é€šè¿‡-Gradle-é…ç½®è¿›è¡Œæ’ä»¶æ³¨å†Œ"><a href="#2ã€é€šè¿‡-Gradle-é…ç½®è¿›è¡Œæ’ä»¶æ³¨å†Œ" class="headerlink" title="2ã€é€šè¿‡ Gradle é…ç½®è¿›è¡Œæ’ä»¶æ³¨å†Œ"></a>2ã€é€šè¿‡ Gradle é…ç½®è¿›è¡Œæ’ä»¶æ³¨å†Œ</h5><p>åœ¨æ’ä»¶çš„ build.gradle ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//...</span><br><span class="hljs-comment">//1ã€å¼•å…¥ java-gradle-plugin æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;java-gradle-plugin&#x27;</span><br><br><br><span class="hljs-comment">//2ã€è¿›è¡Œæ’ä»¶æ³¨å†Œç›¸å…³çš„é…ç½®</span><br>gradlePlugin &#123;<br>    plugins &#123;<br>        greeting &#123;<br>            <span class="hljs-comment">// æ’ä»¶id</span><br>            id = <span class="hljs-string">&#x27;BuildSrcPlugin&#x27;</span><br>            <span class="hljs-comment">// æ’ä»¶å®ç°ç±»</span><br>            implementationClass = <span class="hljs-string">&#x27;com.dream.plugin.BuildSrcPlugin&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä¸å®¹æ˜“å‡ºé”™ï¼Œæ¨èä½¿ç”¨</p><p>ok, ç»è¿‡ä¸Šé¢ 4 ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬çš„æ’ä»¶å°±ç¼–å†™å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥ç›´æ¥å¼•ç”¨å³å¯ï¼Œåœ¨éœ€è¦çš„ build.gradle è¿›è¡Œå¼•ç”¨ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸‹</span><br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;BuildSrcPlugin&#x27;</span><br><br><span class="hljs-comment">//å› ä¸ºå½“å‰æ’ä»¶ä¸­çš„ Task æŒ‚æ¥åˆ°äº†æ„å»ºæµç¨‹ä¸­çš„ Taskï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œé¡¹ç›®å°±å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœï¼Œå¦‚ä¸‹æˆªå›¾</span><br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/534911a6b92e463588a32874ec3f3548~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722142743405"></p><p>buildSrc æ–¹å¼çš„ç¼ºç‚¹ï¼š<strong>åªèƒ½åœ¨å½“å‰å·¥ç¨‹ä¸­ä½¿ç”¨ï¼Œå…¶ä»–çš„é¡¹ç›®å·¥ç¨‹ä½¿ç”¨ä¸äº†ï¼Œé‚£å¦‚æœæˆ‘å¸Œæœ›ç¼–å†™çš„æ’ä»¶å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ç”¨ï¼Œè¿™ç§æ–¹å¼å°±åšä¸åˆ°äº†</strong></p><h3 id="3ï¼‰ã€åœ¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™"><a href="#3ï¼‰ã€åœ¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™" class="headerlink" title="3ï¼‰ã€åœ¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™"></a>3ï¼‰ã€åœ¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™</h3><p>å‰é¢æˆ‘ä»¬è®²åˆ°ï¼ŒbuildSrc æ–¹å¼çš„ç¼ºç‚¹å°±æ˜¯åªèƒ½åœ¨å½“å‰é¡¹ç›®å·¥ç¨‹ä¸‹ä½¿ç”¨ï¼Œå¦‚æœè¦åœ¨å…¶ä»–çš„å·¥ç¨‹ä½¿ç”¨ï¼Œåˆ™ä½¿ç”¨ä¸äº†ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨è‡ªå®šä¹‰é¡¹ç›®ä¸‹ç¼–å†™æ’ä»¶ï¼Œç„¶åæŠŠå½“å‰æ’ä»¶å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ï¼Œæœ€åå¯¹æ’ä»¶è¿›è¡Œå¼•ç”¨å³å¯</p><p>ç±»ä¼¼äº Android Gradle Plugin çš„æ’ä»¶å¼•ç”¨ï¼Œå¦‚ä¸‹ï¼š</p><p>1ã€åœ¨æ ¹ build.gradle ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>    <span class="hljs-comment">//é…ç½®æ’ä»¶çš„ä»“åº“åœ°å€</span><br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>    &#125;<br>    <span class="hljs-comment">//é…ç½®æ’ä»¶çš„ä¾èµ–</span><br>    dependencies &#123;<br>        classpath <span class="hljs-string">&quot;com.android.tools.build:gradle:4.2.1&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨å­ build.gradle ä¸­å¼•ç”¨æ’ä»¶</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€å¦‚æœæ˜¯ Android åº”ç”¨å·¥ç¨‹</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.application&#x27;</span><br><br><span class="hljs-comment">//2ã€å¦‚æœæ˜¯ Android åº“å·¥ç¨‹</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.library&#x27;</span><br></code></pre></td></tr></table></figure><p>ä¾è‘«èŠ¦ç”»ç“¢ï¼Œæˆ‘ä»¬ä¹Ÿæ¥å®ç°ä¸€ä¸ªç±»ä¼¼äº Android Gradle Plugin çš„æ’ä»¶å¼•ç”¨</p><p><strong>æ³¨æ„ï¼š</strong> è¿™ç§æ–¹å¼ç¼–å†™æ’ä»¶å’Œ buildSrc æ–¹å¼éå¸¸çš„ç±»ä¼¼ï¼ŒåŒºåˆ«å°±åœ¨äºï¼š</p><blockquote><p>1ã€è‡ªå®šä¹‰äº†é¡¹ç›®åç§°</p><p>2ã€å¢åŠ äº†ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“çš„é…ç½®</p></blockquote><p>å› æ­¤å¦‚æœä½ ä¸æƒ³é€šè¿‡è‡ªå®šä¹‰é¡¹ç›®çš„æ–¹å¼ç¼–å†™æ’ä»¶ï¼Œä½ å¯ä»¥æŠŠä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“çš„é…ç½®å†™åœ¨ buildSrc çš„ build.gradle é‡Œé¢ï¼Œç„¶åè¿›è¡Œä¸Šä¼ </p><p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡è‡ªå®šä¹‰é¡¹ç›®çš„æ–¹å¼å»ç¼–å†™ä¸€ä¸ªæ’ä»¶</p><h4 id="1ã€è‡ªå®šä¹‰ä¸€ä¸ª-Java-Moduleï¼Œåå­—ä»»æ„å–"><a href="#1ã€è‡ªå®šä¹‰ä¸€ä¸ª-Java-Moduleï¼Œåå­—ä»»æ„å–" class="headerlink" title="1ã€è‡ªå®šä¹‰ä¸€ä¸ª Java Moduleï¼Œåå­—ä»»æ„å–"></a>1ã€è‡ªå®šä¹‰ä¸€ä¸ª Java Moduleï¼Œåå­—ä»»æ„å–</h4><p>æˆ‘è¿™é‡Œè‡ªå®šä¹‰äº†ä¸€ä¸ª customplugin çš„ Java Moduleï¼Œå…¶ä½™æ­¥éª¤å’Œ buildSrc æ–¹å¼åŸºæœ¬ä¸€æ ·ï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ build.gradle è¿™ä¸ªæ–‡ä»¶ä¸­æ–°å¢äº†ä¸Šä¼ åˆ° Maven çš„é…ç½®ï¼Œè¿™é‡Œæˆ‘æ˜¯ä¸Šä¼ åˆ°æœ¬åœ° Maven</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/842ac9d4e76e4cadb1481ffca307aeeb~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210723155621390"></p><p>çœ‹ä¸€çœ¼æˆ‘ä»¬çš„ build.gradle æ–‡ä»¶ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;groovy&#x27;</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;java-gradle-plugin&#x27;</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;maven&#x27;</span><br><br><br><span class="hljs-comment">//å¼•å…¥ç›¸å…³çš„ä¾èµ–</span><br>dependencies &#123;<br>    <span class="hljs-comment">//Groovy DSL</span><br>    implementation gradleApi()<br>    <span class="hljs-comment">//Gradle DSL</span><br>    implementation localGroovy()<br>&#125;<br><br><span class="hljs-comment">//å¼•å…¥ç›¸å…³çš„ä»“åº“</span><br>repositories &#123;<br>    mavenCentral()<br>&#125;<br><br><span class="hljs-comment">//Gradle é…ç½®çš„æ–¹å¼æ³¨å†Œæ’ä»¶</span><br>gradlePlugin &#123;<br>    plugins &#123;<br>        greeting &#123;<br>            <span class="hljs-comment">// æ’ä»¶id</span><br>            id = <span class="hljs-string">&#x27;CustomPlugin&#x27;</span><br>            <span class="hljs-comment">// æ’ä»¶å®ç°ç±»</span><br>            implementationClass = <span class="hljs-string">&#x27;com.dream.plugin.CustomPlugin&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//å°†æ’ä»¶æ‰“åŒ…ä¸Šä¼ åˆ°æœ¬åœ°mavenä»“åº“</span><br>uploadArchives &#123;<br>    repositories &#123;<br>        mavenDeployer &#123;<br>            <span class="hljs-comment">//æŒ‡å®š maven å‘å¸ƒä¸‰å‰‘å®¢</span><br>            pom.groupId = <span class="hljs-string">&#x27;com.dream&#x27;</span><br>            pom.artifactId = <span class="hljs-string">&#x27;customplugin&#x27;</span><br>            pom.version = <span class="hljs-string">&#x27;1.0.0&#x27;</span><br>            <span class="hljs-comment">//æŒ‡å®šæœ¬åœ° maven ä»“åº“çš„è·¯å¾„ï¼Œè¿™é‡Œæˆ‘æŒ‡å®šçš„å°±æ˜¯å½“å‰ Module ç›®å½•ä¸‹</span><br>            repository(<span class="hljs-attr">url:</span> uri(<span class="hljs-string">&#x27;../customplugin&#x27;</span>))<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°é…ç½®æ–‡ä»¶æ–°å¢çš„å†…å®¹ï¼š</p><p>1ã€é‡‡ç”¨äº† Gradle é…ç½®çš„æ–¹å¼è¿›è¡Œæ’ä»¶çš„æ³¨å†Œ</p><p>2ã€å¢åŠ äº†ä¸Šä¼ åˆ° maven æœ¬åœ°ä»“åº“çš„é…ç½®</p><p>æ¥ç€çœ‹ä¸€çœ¼æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å’Œç¼–å†™çš„æ’ä»¶ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3d5d3e543dd4b58851958448fe435e4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722201238241"></p><h4 id="2ã€å°†å½“å‰æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°-Maven-ä»“åº“"><a href="#2ã€å°†å½“å‰æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ°-Maven-ä»“åº“" class="headerlink" title="2ã€å°†å½“å‰æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ° Maven ä»“åº“"></a>2ã€å°†å½“å‰æ’ä»¶å‘å¸ƒåˆ°æœ¬åœ° Maven ä»“åº“</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å»æ“ä½œï¼š</p><blockquote><p>1ã€æ‰§è¡Œ <code>./gradlew uploadArchives</code> å‘½ä»¤</p><p>2ã€åœ¨ AndroidStudio æ‰¾åˆ° Gradle å¯è§†åŒ–ç•Œé¢çš„ uploadArchives Task ç‚¹å‡»å‘å¸ƒ</p></blockquote><p>å¦‚æœä¸Šä¼ æˆåŠŸï¼Œä½ å°†çœ‹åˆ°å¦‚ä¸‹ä¸€äº›æ–‡ä»¶ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b1ee1594cad4394be3515a825a4ade6~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722203228840"  /><p>ä¸Šä¼ åˆ°æœ¬åœ° Maven ä»“åº“æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä½¿ç”¨ Android Gradle Plugin é‚£æ ·ä½¿ç”¨æ’ä»¶äº†</p><h4 id="3ã€æ’ä»¶ä¾èµ–é…ç½®"><a href="#3ã€æ’ä»¶ä¾èµ–é…ç½®" class="headerlink" title="3ã€æ’ä»¶ä¾èµ–é…ç½®"></a>3ã€æ’ä»¶ä¾èµ–é…ç½®</h4><p><strong>æ³¨æ„</strong>ï¼šæ’ä»¶ä¾èµ–å°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¼ åˆ° Maven ä»“åº“é…ç½®çš„é‚£ä¸‰å‰‘å®¢ï¼Œæ ¼å¼ä¸ºï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">classpath <span class="hljs-string">&#x27;[groupId]:[artifactId]:[version]&#x27;</span> <br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨æ ¹ build.gradle ä¸­å¼•å…¥æœ¬åœ°ä»“åº“å’Œæ’ä»¶ä¾èµ–</span><br>buildscript &#123;<br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>        jcenter()<br>      <span class="hljs-comment">//å¼•å…¥æœ¬åœ° Maven ä»“åº“</span><br>        maven&#123;<br>            url uri(<span class="hljs-string">&#x27;customplugin&#x27;</span>)<br>        &#125;<br>    &#125;<br>    dependencies &#123;<br>        classpath <span class="hljs-string">&quot;com.android.tools.build:gradle:4.2.1&quot;</span><br>      <span class="hljs-comment">//å¼•å…¥æ’ä»¶ä¾èµ–</span><br>        classpath <span class="hljs-string">&quot;com.dream:customplugin:1.0.0&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æ­¥éª¤å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ’ä»¶äº†ï¼Œåœ¨éœ€è¦çš„ build.gradle è¿›è¡Œå¼•ç”¨ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨ app çš„ build.gradle ä¸‹</span><br><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;CustomPlugin&#x27;</span><br><br><span class="hljs-comment">//å› ä¸ºå½“å‰æ’ä»¶ä¸­çš„ Task æŒ‚æ¥åˆ°äº†æ„å»ºæµç¨‹ä¸­çš„ Taskï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œé¡¹ç›®å°±å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœï¼Œå¦‚ä¸‹æˆªå›¾</span><br></code></pre></td></tr></table></figure><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/75c517e03ea14ed9812d78d9b867dd32~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722204535977"  /><p>è‡³æ­¤ï¼Œå…³äºå¯¹è±¡æ’ä»¶çš„ç¼–å†™åŠåº”ç”¨å°±è®²çš„å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹æ¥è®²ä¸‹å¦‚ä½•å‘å¸ƒæ’ä»¶åˆ°è¿œç¨‹ä»“åº“</p><h2 id="å››ã€å‘å¸ƒæ’ä»¶åˆ°è¿œç¨‹ä»“åº“"><a href="#å››ã€å‘å¸ƒæ’ä»¶åˆ°è¿œç¨‹ä»“åº“" class="headerlink" title="å››ã€å‘å¸ƒæ’ä»¶åˆ°è¿œç¨‹ä»“åº“"></a>å››ã€å‘å¸ƒæ’ä»¶åˆ°è¿œç¨‹ä»“åº“</h2><p>æˆ‘ä»¬å¸¸ç”¨çš„è¿œç¨‹ä»“åº“æœ‰ï¼šJcenterï¼ŒmavenCentralï¼ŒMaven ç§æœä»“åº“ï¼ŒJitPackç­‰ç­‰</p><p><strong>å…³äº Jcenter</strong></p><p>Jcenter å®˜æ–¹åœ¨ 2021.2.3 å‘å¸ƒå£°æ˜å³å°†åœæ­¢ Jcenter çš„è¿è¥</p><blockquote><p>è‡ª 2021.3.31åä¸åœ¨æ¥å—ä»»ä½•æ–°çš„æäº¤ï¼Œåœ¨2022.2.1å‰ï¼Œä½ è¿˜æ˜¯å¯ä»¥æ­£å¸¸æ‹‰å–2021.3.31å‰æäº¤çš„åº“</p></blockquote><p>å› æ­¤è¿™é‡Œå°±ä¸è®²å¦‚ä½•å‘å¸ƒæ’ä»¶åˆ° Jcenter</p><p><strong>å…³äº mavenCentral</strong></p><p>è‡ª Jcenter å®£å¸ƒå³å°†åœæ­¢æœåŠ¡åï¼Œå¾ˆå¤šç¬¬ä¸‰æ–¹åº“å’Œæ’ä»¶éƒ½è¿ç§»åˆ°äº† mavenCentral ï¼Œä½†æ˜¯å‘å¸ƒ mavenCentral æµç¨‹ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œä¸åšè¿‡å¤šèµ˜è¿°ï¼Œåç»­æˆ‘ä¼šä¸“é—¨å†™ä¸€éæ–‡ç« æ•™å¤§å®¶å¦‚ä½•ä¸Šä¼ åˆ° mavenCentral</p><h3 id="1ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ°-Maven-ç§æœä»“åº“"><a href="#1ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ°-Maven-ç§æœä»“åº“" class="headerlink" title="1ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ° Maven ç§æœä»“åº“"></a>1ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ° Maven ç§æœä»“åº“</h3><p>å¦‚æœæœ‰ Maven ç§æœä»“åº“ï¼Œé‚£å‘å¸ƒæ’ä»¶å°†ä¼šå˜å¾—å¼‚å¸¸ç®€å•ï¼Œä½ åªéœ€è¦å°† build.gradle é‡Œé¢çš„æœ¬åœ°ä»“åº“æ”¹æˆè¿œç¨‹ä»“åº“åœ°å€ï¼Œå¹¶éªŒè¯ç”¨æˆ·åå¯†ç å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å¼•å…¥ maven æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;maven&#x27;</span><br><br><span class="hljs-comment">//å°†æ’ä»¶æ‰“åŒ…ä¸Šä¼ åˆ°è¿œç¨‹ maven ä»“åº“</span><br>uploadArchives &#123;<br>    repositories &#123;<br>        mavenDeployer &#123;<br>            <span class="hljs-comment">//æŒ‡å®š maven å‘å¸ƒä¸‰å‰‘å®¢</span><br>            pom.groupId = <span class="hljs-string">&#x27;com.dream&#x27;</span><br>            pom.artifactId = <span class="hljs-string">&#x27;customplugin&#x27;</span><br>            pom.version = <span class="hljs-string">&#x27;1.0.0&#x27;</span><br>            <span class="hljs-comment">//æŒ‡å®šè¿œç¨‹ä»“åº“</span><br>            repository(<span class="hljs-attr">url:</span> <span class="hljs-string">&#x27;ä½ çš„è¿œç¨‹ä»“åº“åœ°å€&#x27;</span>)&#123;<br>              authentication(<span class="hljs-attr">userName:</span> <span class="hljs-string">&#x27;ç”¨æˆ·å&#x27;</span>, <span class="hljs-attr">password:</span> <span class="hljs-string">&quot;å¯†ç &quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> ä¸€èˆ¬å…¬å¸éƒ½ä¼šæ­å»ºè‡ªå·±çš„ Maven ä»“åº“</p><h3 id="2ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ°-JitPack"><a href="#2ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ°-JitPack" class="headerlink" title="2ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ° JitPack"></a>2ï¼‰ã€å‘å¸ƒæ’ä»¶åˆ° JitPack</h3><p>ä¹‹å‰æˆ‘å†™è¿‡ä¸€ç¯‡æ–‡ç« æ•™å¤§å®¶å¦‚ä½•ä¸Šä¼ ç¬¬ä¸‰æ–¹åº“åˆ° JitPack <a href="https://juejin.cn/post/6916061679079915528#heading-9">ä¼ é€é—¨</a> ï¼Œå®é™…ä¸Šä¸Šä¼ æ’ä»¶ä¹Ÿæ˜¯åŒæ ·çš„æ“ä½œ</p><h4 id="1ã€åˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™-Gradle-æ’ä»¶"><a href="#1ã€åˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™-Gradle-æ’ä»¶" class="headerlink" title="1ã€åˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™ Gradle æ’ä»¶"></a>1ã€åˆ›å»ºå¥½é¡¹ç›®å¹¶ç¼–å†™ Gradle æ’ä»¶</h4><p>è¿™ä¸€æ­¥æˆ‘ä»¬å·²ç»å®Œæˆï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p><p><strong>ä½ çš„é¡¹ç›®åç§°ï¼ˆæ ¹å·¥ç¨‹çš„åç§°ï¼‰å°†ä¼šä½œä¸ºæ’ä»¶ä¾èµ–çš„ artifactIdï¼Œå› æ­¤æˆ‘ä»¬åœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™å°½é‡å–ä¸€ä¸ªå¥½ç‚¹çš„åå­—</strong></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8064a27b3f004af3a40b2f0b99d236c1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210723155739473"></p><h4 id="2ã€é…ç½®å¥½ä¸Šä¼ æ’ä»¶å¹¶å°†é¡¹ç›®ä¸Šä¼ è‡³-Github"><a href="#2ã€é…ç½®å¥½ä¸Šä¼ æ’ä»¶å¹¶å°†é¡¹ç›®ä¸Šä¼ è‡³-Github" class="headerlink" title="2ã€é…ç½®å¥½ä¸Šä¼ æ’ä»¶å¹¶å°†é¡¹ç›®ä¸Šä¼ è‡³ Github"></a>2ã€é…ç½®å¥½ä¸Šä¼ æ’ä»¶å¹¶å°†é¡¹ç›®ä¸Šä¼ è‡³ Github</h4><p>ä¸Šä¼  JitPack æ’ä»¶ <a href="https://github.com/dcendents/android-maven-gradle-plugin">ä¼ é€é—¨</a></p><p>åœ¨æ ¹ build.gradle æ–‡ä»¶ä¸‹æ·»åŠ å¦‚ä¸‹æ’ä»¶ä¾èµ–ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>    <span class="hljs-comment">//...</span><br>    dependencies &#123;<br>      <span class="hljs-comment">//...</span><br>        <span class="hljs-comment">//ä¸Šä¼  JitPack æ’ä»¶ä¾èµ–</span><br>        classpath <span class="hljs-string">&#x27;com.github.dcendents:android-maven-gradle-plugin:2.1&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æ’ä»¶çš„ build.gradle è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.github.dcendents.android-maven&#x27;</span><br><span class="hljs-comment">//ç»„å com.github æ˜¯å›ºå®šçš„ï¼Œåé¢çš„ sweetying520 æ˜¯æˆ‘ Github çš„ç”¨æˆ·åï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„å°±å¯ä»¥äº†</span><br>group = <span class="hljs-string">&#x27;com.github.sweetying520&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> </p><p>1ã€å®é™…æµ‹è¯•å‘ç°ï¼Œä¸Šé¢çš„ group ä½ é…ç½®æˆå…¶ä»–çš„æˆ–ä¸å†™å‡ºæ¥éƒ½æ— æ‰€è°“ï¼Œæœ€ç»ˆçš„ groupId éƒ½ä¼šæ˜¯ï¼š<code>com.github.sweetying520</code></p><p>2ã€å¦å¤–æˆ‘ä»¬ä¸Šä¼ çš„æ’ä»¶åœ¨ Github è¢«è¯´æ˜ä¸ºåºŸå¼ƒäº†ï¼Œå¹¶æ¨èæˆ‘ä»¬ä½¿ç”¨ <code>maven-publish</code> æ’ä»¶ <a href="https://developer.android.com/studio/build/maven-publish-plugin">ä¼ é€é—¨</a> å»ä¸Šä¼ ï¼Œä½†åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°ä½¿ç”¨  <code>maven-publish</code> æ’ä»¶ä¸Šä¼ åˆ° JitPack ä¼šä½¿å¾—æ’ä»¶çš„ä¾èµ–åœ°å€ç‰¹åˆ«é•¿ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚è™½ç„¶ä¹‹å‰çš„æ’ä»¶è¢«æ ‡è¯†ä¸ºåºŸå¼ƒï¼Œä½†æ˜¯å¹¶ä¸å¦¨ç¢æˆ‘ä»¬ä½¿ç”¨</p><p>ç»è¿‡ä¸Šé¢çš„ä¸¤æ­¥ï¼Œæˆ‘ä»¬å°±æœ‰äº† groupId å’Œ artifactIdï¼Œå› ä¸ºæˆ‘çš„é¡¹ç›®åç§°å«ï¼šGradleDemoï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ä¾èµ–å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">com.github.<span class="hljs-attr">sweetying520:</span>GradleDemo<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆç°åœ¨å°±è¿˜å·® version äº†ï¼Œè¦è·å– version ï¼Œæˆ‘ä»¬å°±å…ˆè¦æŠŠé¡¹ç›®ä¸Šä¼ è‡³ Githubï¼Œä¸Šä¼ æˆåŠŸåï¼Œæ¥ç€è¿›è¡Œä¸‹ä¸€æ­¥</p><h4 id="3ã€æ‰“å¼€é¡¹ç›®çš„-Github-ä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ª-Release-æˆ–-Tag"><a href="#3ã€æ‰“å¼€é¡¹ç›®çš„-Github-ä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ª-Release-æˆ–-Tag" class="headerlink" title="3ã€æ‰“å¼€é¡¹ç›®çš„ Github ä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ª Release æˆ– Tag"></a>3ã€æ‰“å¼€é¡¹ç›®çš„ Github ä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ª Release æˆ– Tag</h4><p>è¿™ä¸€æ­¥å»ºè®®å‚è€ƒæˆ‘ä¹‹å‰å†™çš„é‚£ç¯‡æ–‡ç«   <a href="https://juejin.cn/post/6916061679079915528#heading-9">ä¼ é€é—¨</a> </p><h4 id="4ã€å°†é¡¹ç›®ä»“åº“-Github-åœ°å€æäº¤åˆ°-JitPack"><a href="#4ã€å°†é¡¹ç›®ä»“åº“-Github-åœ°å€æäº¤åˆ°-JitPack" class="headerlink" title="4ã€å°†é¡¹ç›®ä»“åº“ Github åœ°å€æäº¤åˆ° JitPack"></a>4ã€å°†é¡¹ç›®ä»“åº“ Github åœ°å€æäº¤åˆ° <a href="https://link.juejin.cn/?target=https://jitpack.io/">JitPack</a></h4><blockquote><p>1ã€æ‰“å¼€ <a href="https://link.juejin.cn/?target=https://jitpack.io/">JitPack</a> ï¼Œå¹¶ç™»é™†ï¼ˆä½¿ç”¨ä½ è‡ªå·±çš„ Github è´¦å·ç™»é™†å³å¯ï¼‰</p><p>2ã€å°†ä½ é¡¹ç›®ä»“åº“ Github åœ°å€æ”¾å…¥æœç´¢æ ï¼Œç‚¹å‡»look upï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœç¼–è¯‘æˆåŠŸï¼Œé‚£ä¹ˆå°±è¯æ˜ä½ æˆåŠŸçš„å°†æ’ä»¶ä¸Šä¼ åˆ° JitPack äº†</p></blockquote><p>ä¸‹é¢çš„ Version æ˜¯æˆ‘ä¹‹å‰ç”Ÿæˆçš„ä¸€äº›ç‰ˆæœ¬</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48b574c3c1174a9098bafd64fc3a3af1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210723115443338"></p><p>ç¼–è¯‘å®Œæˆå JitPack ä¼šè‡ªåŠ¨ç»™ä½ ç”Ÿæˆç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼ŒæŒ‰ç…§å¦‚ä¸‹é…ç½®ï¼Œé…ç½®ä½ çš„é¡¹ç›®å³å¯</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/33197a69700d4b1fa42086d21956e364~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210723115812720"></p><p><strong>æ³¨æ„ï¼š</strong> ä¸Šè¿°æˆªå›¾æ˜¯æ•™æˆ‘ä»¬å¦‚ä½•å¼•ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œè€Œæˆ‘ä»¬ä¸Šä¼ çš„æ˜¯æ’ä»¶ï¼Œå› æ­¤æŒ‰ç…§æ’ä»¶çš„ä¾èµ–å¼•å…¥è§„åˆ™å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨æ ¹ build.gradle ä¸‹</span><br><br>buildscript &#123;<br>    repositories &#123;<br>      <span class="hljs-comment">//...</span><br><br>        <span class="hljs-comment">//è¿œç¨‹ JitPack ä»“åº“åœ°å€</span><br>        maven &#123;<br>            url <span class="hljs-string">&#x27;https://jitpack.io&#x27;</span><br>        &#125;<br>    &#125;<br>    dependencies &#123;<br>      <span class="hljs-comment">//...</span><br>      <br>        <span class="hljs-comment">//å¼•å…¥æ’ä»¶ä¾èµ–</span><br>        classpath <span class="hljs-string">&#x27;com.github.sweetying520:GradleDemo:1.0.1&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨æ’ä»¶äº†</p><h4 id="5ã€å…³äºåç»­ç‰ˆæœ¬æ›´æ–°"><a href="#5ã€å…³äºåç»­ç‰ˆæœ¬æ›´æ–°" class="headerlink" title="5ã€å…³äºåç»­ç‰ˆæœ¬æ›´æ–°"></a>5ã€å…³äºåç»­ç‰ˆæœ¬æ›´æ–°</h4><p>1ã€å°†ä¿®æ”¹å¥½çš„ä¸œè¥¿ä¸Šä¼ åˆ° Github</p><p>2ã€æ‰“å¼€é¡¹ç›®çš„ Github ä¸»é¡µï¼Œåˆ›å»ºä¸€ä¸ª Release æˆ– Tagï¼ˆè¿™ä¸ªæ­¥éª¤å°±æ˜¯é‡å¤æ­¥éª¤3ï¼‰</p><p>3ã€å°†é¡¹ç›®çš„ä»“åº“æäº¤åˆ° <a href="https://link.juejin.cn/?target=https://jitpack.io/">JitPack</a>ï¼ˆè¿™ä¸ªæ­¥éª¤å°±æ˜¯é‡å¤æ­¥éª¤4ï¼‰</p><h2 id="äº”ã€æ’ä»¶è°ƒè¯•"><a href="#äº”ã€æ’ä»¶è°ƒè¯•" class="headerlink" title="äº”ã€æ’ä»¶è°ƒè¯•"></a>äº”ã€æ’ä»¶è°ƒè¯•</h2><p>æˆ‘ä»¬åœ¨å¼€å‘æ’ä»¶çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°å„ç§é—®é¢˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯¹æ’ä»¶è°ƒè¯•å°±æ˜¾å¾—å°¤ä¸ºé‡è¦äº†ã€‚<strong>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ‰“å° Log æ—¥å¿—</strong>ï¼Œä½†æ˜¯æ‰“å° Log æ—¥å¿—åŠŸèƒ½æ¯”è¾ƒæœ‰é™ï¼Œæ»¡è¶³ä¸äº†æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ã€‚æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹å¼ºå¤§çš„ debug æ–¹å¼</p><p>ä»¥ä¸Šé¢ç¼–å†™çš„ buildSrc æ–¹å¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯¹å®ƒè¿›è¡Œä¸€ä¸ª debugï¼Œæ’ä»¶çš„è°ƒè¯•åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§ï¼š</p><p>1ã€ç®€å•ç‰ˆè°ƒè¯•ï¼šç›´æ¥åœ¨ AndroidStudio æä¾›çš„ Gradle å¯è§†åŒ–ç•Œé¢ï¼Œæ‰¾åˆ°éœ€è¦è°ƒè¯•çš„ Taskï¼Œæ‰“å¼€å¯é€‰é¡¹ï¼Œé€‰æ‹© debug å³å¯</p><p>2ã€å¤æ‚ç‰ˆè°ƒè¯•ï¼šé€šè¿‡ Gradle å‘½ä»¤ç»“åˆä¸€äº›ç›¸å…³çš„é…ç½®å¼€å¯è°ƒè¯•åŠŸèƒ½</p><h3 id="1ï¼‰ã€ç®€å•ç‰ˆè°ƒè¯•"><a href="#1ï¼‰ã€ç®€å•ç‰ˆè°ƒè¯•" class="headerlink" title="1ï¼‰ã€ç®€å•ç‰ˆè°ƒè¯•"></a>1ï¼‰ã€ç®€å•ç‰ˆè°ƒè¯•</h3><p>ç›´æ¥åœ¨ AndroidStudio æä¾›çš„ Gradle å¯è§†åŒ–ç•Œé¢ï¼Œæ‰¾åˆ°éœ€è¦è°ƒè¯•çš„ Taskï¼Œæ‰“å¼€å¯é€‰é¡¹ï¼Œé€‰æ‹© debug å³å¯</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/beca96f53fb541ad946361f986bd4a6c~tplv-k3u1fbpfcp-watermark.image" alt="debug_gradle_simple_use.png"></p><p>æ¥ä¸‹æ¥çš„æ­¥éª¤å°±å’Œæˆ‘ä»¬è°ƒè¯• Java ä»£ç æ˜¯ä¸€æ ·çš„</p><p><strong>æ³¨æ„ï¼š</strong> æå‰æ‰“å¥½æ–­ç‚¹</p><p>è¿™ç§æ–¹å¼ä½¿ç”¨æå…¶ç®€å•ï¼Œæ¨èä½¿ç”¨</p><h3 id="2ï¼‰ã€å¤æ‚ç‰ˆè°ƒè¯•"><a href="#2ï¼‰ã€å¤æ‚ç‰ˆè°ƒè¯•" class="headerlink" title="2ï¼‰ã€å¤æ‚ç‰ˆè°ƒè¯•"></a>2ï¼‰ã€å¤æ‚ç‰ˆè°ƒè¯•</h3><p>é€šè¿‡ Gradle å‘½ä»¤ç»“åˆä¸€äº›ç›¸å…³çš„é…ç½®å¼€å¯è°ƒè¯•åŠŸèƒ½</p><h4 id="1ã€æ–°å¢ä¸€ä¸ª-Remote-ç±»å‹çš„-Configuration"><a href="#1ã€æ–°å¢ä¸€ä¸ª-Remote-ç±»å‹çš„-Configuration" class="headerlink" title="1ã€æ–°å¢ä¸€ä¸ª Remote ç±»å‹çš„ Configuration"></a>1ã€æ–°å¢ä¸€ä¸ª Remote ç±»å‹çš„ Configuration</h4><p>ç¬¬ä¸€æ­¥ï¼šç‚¹å‡»å›¾ä¸­çš„ Edit Configurationsâ€¦</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5eb33347e0b4da49759f67c43601410~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722150428439" style="zoom:50%;" /><p>ç¬¬äºŒæ­¥ï¼šç‚¹å‡»å›¾ä¸­ 1 çš„ + å·ï¼Œé€‰æ‹© 2 </p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2272681c45044c77b9d67f62fd628372~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722150750481" style="zoom:50%;" /><p>ç¬¬ä¸‰æ­¥ï¼š1 ä¸­çš„åå­—éšæ„å–ï¼Œç„¶åç‚¹å‡» 2 ï¼Œå³å¯å®Œæˆ  Remote ç±»å‹ Configuration çš„åˆ›å»º</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/84ede40ea66c4915808bbc3b436742cc~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722151029556" style="zoom:50%;" /><p>ç¬¬å››æ­¥ï¼šåˆ‡æ¢åˆ°åˆšæ‰åˆ›å»ºçš„ erdai Configuration</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ff3fe29e49142bba44e9b949598b00a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722151407226" style="zoom:50%;" /><h4 id="2ã€æ‰§è¡Œ-Gradle-å‘½ä»¤ï¼š-gradlew-éœ€è¦æ‰§è¡Œçš„Task-Dorg-gradle-debug-true-no-daemon"><a href="#2ã€æ‰§è¡Œ-Gradle-å‘½ä»¤ï¼š-gradlew-éœ€è¦æ‰§è¡Œçš„Task-Dorg-gradle-debug-true-no-daemon" class="headerlink" title="2ã€æ‰§è¡Œ Gradle å‘½ä»¤ï¼š./gradlew éœ€è¦æ‰§è¡Œçš„Task -Dorg.gradle.debug=true --no-daemon"></a>2ã€æ‰§è¡Œ Gradle å‘½ä»¤ï¼š<code>./gradlew éœ€è¦æ‰§è¡Œçš„Task -Dorg.gradle.debug=true --no-daemon</code></h4><p>ä»¥æ‰§è¡Œ assembleDebug è¿™ä¸ª task ä¸ºä¾‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">./gradlew assembleDebug -Dorg.gradle.debug=<span class="hljs-literal">true</span> --no-daemon<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬çš„å‘½ä»¤ä¼šè¿›å…¥ä¸€ä¸ªé”å®šçŠ¶æ€ï¼Œç­‰å¾…æˆ‘ä»¬è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8cd10b40fc3943b49ca49e382be442aa~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722152335257"></p><h4 id="3ã€æ‰“å¥½å›¾ä¸­-1-çš„æ–­ç‚¹ï¼Œç‚¹å‡»-2-çš„-debug-æŒ‰é’®ï¼Œå°±å¯ä»¥è¿›è¡Œæ„‰å¿«çš„è°ƒè¯•äº†"><a href="#3ã€æ‰“å¥½å›¾ä¸­-1-çš„æ–­ç‚¹ï¼Œç‚¹å‡»-2-çš„-debug-æŒ‰é’®ï¼Œå°±å¯ä»¥è¿›è¡Œæ„‰å¿«çš„è°ƒè¯•äº†" class="headerlink" title="3ã€æ‰“å¥½å›¾ä¸­ 1 çš„æ–­ç‚¹ï¼Œç‚¹å‡» 2 çš„ debug æŒ‰é’®ï¼Œå°±å¯ä»¥è¿›è¡Œæ„‰å¿«çš„è°ƒè¯•äº†"></a>3ã€æ‰“å¥½å›¾ä¸­ 1 çš„æ–­ç‚¹ï¼Œç‚¹å‡» 2 çš„ debug æŒ‰é’®ï¼Œå°±å¯ä»¥è¿›è¡Œæ„‰å¿«çš„è°ƒè¯•äº†</h4><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/379fcb2762e949beaab3dbe0f65e0204~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210722152553072"></p><p>æ¥ä¸‹æ¥çš„æ­¥éª¤å°±å’Œæˆ‘ä»¬è°ƒè¯• Java ä»£ç æ˜¯ä¸€æ ·çš„ã€‚è¿™ç§æ–¹å¼ç¨å¾®å¤æ‚ä¸€ç‚¹</p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€è„šæœ¬æ’ä»¶çš„å®šä¹‰ä¸ä½¿ç”¨</p><p>2ã€å¯¹è±¡æ’ä»¶å®šä¹‰çš„ä¸‰ç§æ–¹å¼åŠå…·ä½“ä½¿ç”¨ï¼Œæ³¨æ„æ–‡ä¸­æåˆ°çš„ä¸€äº›ç»†èŠ‚ç‚¹</p><p>3ã€å‘å¸ƒ Gradle æ’ä»¶åˆ°è¿œç¨‹ä»“åº“ï¼šå…·ä½“ä»‹ç»äº†å¦‚ä½•å‘å¸ƒ Gradle æ’ä»¶åˆ° JitPack</p><p>4ã€å¦‚ä½•è°ƒè¯•æ’ä»¶ï¼Œç®€å•ç‰ˆè°ƒè¯•æ•ˆç‡é«˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²è‡ªå®šä¹‰ç¬¬ä¸‰æ–¹æ’ä»¶å®æˆ˜åº”ç”¨ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6844904135314128903">æ·±åº¦æ¢ç´¢ Gradle è‡ªåŠ¨åŒ–æ„å»ºæŠ€æœ¯ï¼ˆå››ã€è‡ªå®šä¹‰ Gradle æ’ä»¶)</a></p><p><a href="https://juejin.cn/post/6937940389496094751">Gradleå­¦ä¹ ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šGradleæ’ä»¶</a></p><p><a href="https://juejin.cn/post/6956517422606057479#heading-1">è¡¥é½AndroidæŠ€èƒ½æ ‘ - ç©è½¬Gradleæ’ä»¶ </a></p><p><a href="https://juejin.cn/post/6985188709356273701">æˆ‘æƒ³è°ƒè¯•ä¸‹build.gradle | Gradle è°ƒè¯•</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆäºŒï¼‰ã€Gradle æŠ€æœ¯æ¢ç´¢</title>
    <link href="/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81Gradle%20%E6%8A%80%E6%9C%AF%E6%8E%A2%E7%B4%A2/"/>
    <url>/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81Gradle%20%E6%8A%80%E6%9C%AF%E6%8E%A2%E7%B4%A2/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53d3bd66723741b5a9f491bdde66be50~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>è¿™åˆæ˜¯ä¸€ä¸ªæ–°çš„ç³»åˆ—ï¼Œå…³äº Gradle å­¦ä¹ ï¼Œæˆ‘æ‰€ç†è§£çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f65d4a418c9f4c209d6eb3d26a452fba~tplv-k3u1fbpfcp-zoom-1.image" alt="Gradle_learning"></p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹ Gradle çš„ä¸€äº›åŸºç¡€æ¦‚å¿µåŠ Groovy è¯­æ³•è¿›è¡Œäº†è®²è§£ï¼Œå®Œæˆäº†ç¬¬ä¸€ä¸ªç¯èŠ‚ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6939662617224937503">Gradle ç³»åˆ— ï¼ˆä¸€ï¼‰ã€Gradleç›¸å…³æ¦‚å¿µç†è§£ï¼ŒGroovyåŸºç¡€</a>ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»ç¯èŠ‚äºŒï¼šç†Ÿæ‚‰ Gradle å¸¸ç”¨ APIï¼Œäº†è§£ Settingsï¼ŒProjectï¼ŒTask ç­‰ç­‰ã€‚</p><p><a href="https://github.com/sweetying520/GradleDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥ç»“åˆ demo ä¸€èµ·çœ‹ï¼Œæ•ˆæœæ æ æ»´ğŸº</p><p>ä¸‹é¢å°±æ­£å¼è¿›å…¥ Gradle çš„å­¦ä¹ </p><h2 id="ä¸€ã€Gradle-æ„å»ºæµç¨‹"><a href="#ä¸€ã€Gradle-æ„å»ºæµç¨‹" class="headerlink" title="ä¸€ã€Gradle æ„å»ºæµç¨‹"></a>ä¸€ã€Gradle æ„å»ºæµç¨‹</h2><h3 id="1ï¼‰ã€Gradle-æ„å»ºé˜¶æ®µ"><a href="#1ï¼‰ã€Gradle-æ„å»ºé˜¶æ®µ" class="headerlink" title="1ï¼‰ã€Gradle æ„å»ºé˜¶æ®µ"></a>1ï¼‰ã€Gradle æ„å»ºé˜¶æ®µ</h3><p>Gradle æ„å»ºæµç¨‹ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><p>1ã€åˆå§‹åŒ–é˜¶æ®µ</p><p>2ã€é…ç½®é˜¶æ®µ</p><p>3ã€æ‰§è¡Œé˜¶æ®µ</p><h4 id="1ã€åˆå§‹åŒ–é˜¶æ®µ"><a href="#1ã€åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="1ã€åˆå§‹åŒ–é˜¶æ®µ"></a>1ã€åˆå§‹åŒ–é˜¶æ®µ</h4><p>Gradle åˆå§‹åŒ–é˜¶æ®µä¸»è¦å°±æ˜¯æ‰§è¡Œ settings.gradle è„šæœ¬ï¼Œæ„å»º Project å¯¹è±¡</p><p>æˆ‘ä»¬ä½¿ç”¨ AndroidStudio æ–°å»ºä¸€ä¸ª Android é¡¹ç›®çš„æ—¶å€™ä¼šè‡ªåŠ¨ç”Ÿæˆ settings.gradle æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy">rootProject.name = <span class="hljs-string">&quot;GradleDemo&quot;</span><br>include <span class="hljs-string">&#x27;:app&#x27;</span><br></code></pre></td></tr></table></figure><p>1ã€æŒ‡å®šé¡¹ç›®æ ¹ Project çš„åç§°</p><p>2ã€ä½¿ç”¨ include å¯¼å…¥ app å·¥ç¨‹</p><p>å®é™…ä¸Š settings.gradle å¯¹åº”ä¸€ä¸ª Settings å¯¹è±¡ï¼Œinclude å°±æ˜¯ Settings å¯¹è±¡ä¸‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å¼•ç”¨å“ªäº›å·¥ç¨‹éœ€è¦åŠ å…¥æ„å»ºã€‚ç„¶å Gradle ä¼šä¸ºæ¯ä¸ªå¸¦æœ‰ build.gradle è„šæœ¬æ–‡ä»¶çš„å·¥ç¨‹æ„å»ºä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ Project å¯¹è±¡</p><h5 id="1ã€include-æ‰©å±•"><a href="#1ã€include-æ‰©å±•" class="headerlink" title="1ã€include æ‰©å±•"></a>1ã€include æ‰©å±•</h5><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ include + project æ–¹æ³•å¼•ç”¨ä»»ä½•ä½ç½®ä¸‹çš„å·¥ç¨‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy">include <span class="hljs-string">&#x27;:test&#x27;</span><br>project(<span class="hljs-string">&#x27;:test&#x27;</span>).projectDir = file(<span class="hljs-string">&#x27;å½“å‰å·¥ç¨‹çš„ç»å¯¹è·¯å¾„&#x27;</span>)<br></code></pre></td></tr></table></figure><p>é€šå¸¸æˆ‘ä¼šä½¿ç”¨è¿™ç§æ–¹å¼å¼•ç”¨è‡ªå·±å†™çš„åº“è¿›è¡Œè°ƒè¯•ï¼Œéå¸¸çš„æ–¹ä¾¿</p><p>ä½†æœ‰çš„æ—¶å€™ä¼šé‡åˆ°åŒæ—¶å¼•å…¥äº† AAR å’Œæºç çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ include + projectï¼Œç»“åˆä¸€äº›å…¶ä»–çš„é…ç½®ï¼Œæ¥å®ç° AAR å’Œæºç çš„å¿«é€Ÿåˆ‡æ¢ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ­¥éª¤ä¸€ï¼šåœ¨ settings.gradle ä¸­å¼•å…¥æºç å·¥ç¨‹</span><br>include <span class="hljs-string">&#x27;:test&#x27;</span><br>project(<span class="hljs-string">&#x27;:test&#x27;</span>).projectDir = file(<span class="hljs-string">&#x27;å½“å‰å·¥ç¨‹çš„ç»å¯¹è·¯å¾„&#x27;</span>)<br><br><span class="hljs-comment">//æ­¥éª¤äºŒï¼šåœ¨æ ¹ build.gradle ä¸‹è¿›è¡Œå¦‚ä¸‹é…ç½®</span><br>allprojects &#123;<br>    configurations.all &#123;<br>        resolutionStrategy &#123;<br>            dependencySubstitution &#123;<br>                substitute module(<span class="hljs-string">&quot;com.dream:test&quot;</span>) with project(<span class="hljs-string">&#x27;:test&#x27;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2ã€Settings"><a href="#2ã€Settings" class="headerlink" title="2ã€Settings"></a>2ã€Settings</h5><p>å…³äº Settings çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/353d7348729c4e50bd3ebb0ed107c623~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210707215114352" style="zoom:50%;" /><p>ç»“åˆå®˜ç½‘æä¾›çš„æ–‡æ¡£ <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/initialization/Settings.html">ä¼ é€é—¨</a> å»æŸ¥çœ‹ï¼Œæ•ˆæœæ æ çš„ğŸ˜„</p><h4 id="2ã€é…ç½®é˜¶æ®µ"><a href="#2ã€é…ç½®é˜¶æ®µ" class="headerlink" title="2ã€é…ç½®é˜¶æ®µ"></a>2ã€é…ç½®é˜¶æ®µ</h4><p>Gradle é…ç½®é˜¶æ®µä¸»è¦å°±æ˜¯è§£æ Project å¯¹è±¡(build.gradle è„šæœ¬æ–‡ä»¶)ï¼Œæ„å»º Task æœ‰å‘æ— ç¯å›¾</p><p>é…ç½®é˜¶æ®µä¼šæ‰§è¡Œçš„ä»£ç ï¼š<strong>é™¤ Task çš„ Action ä¸­ç¼–å†™çš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ</strong>ï¼Œä¸æ‡‚ Action çš„ç»§ç»­å¾€ä¸‹çœ‹ï¼Œåé¢ä¼šè®²åˆ°ã€‚å¦‚ï¼š</p><p>1ã€build.gradle ä¸­çš„å„ç§è¯­å¥</p><p>2ã€Task é…ç½®æ®µè¯­å¥</p><p>é…ç½®é˜¶æ®µå®Œæˆåï¼Œæ•´ä¸ªå·¥ç¨‹çš„ Task ä¾èµ–å…³ç³»éƒ½ç¡®å®šäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Gradle  å¯¹è±¡çš„ getTaskGraph æ–¹æ³•è®¿é—® Task ,å¯¹åº”çš„ç±»ä¸º TaskExecutionGraph ï¼Œå…³äº TaskExecutionGraph API æ–‡æ¡£ <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/execution/TaskExecutionGraph.html">ä¼ é€é—¨</a></p><p><strong>æ³¨æ„ï¼š</strong> æ‰§è¡Œä»»ä½• Gradle å‘½ä»¤ï¼Œåœ¨åˆå§‹åŒ–é˜¶æ®µå’Œé…ç½®é˜¶æ®µçš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ</p><h4 id="3ã€æ‰§è¡Œé˜¶æ®µ"><a href="#3ã€æ‰§è¡Œé˜¶æ®µ" class="headerlink" title="3ã€æ‰§è¡Œé˜¶æ®µ"></a>3ã€æ‰§è¡Œé˜¶æ®µ</h4><p>Gradle æ‰§è¡Œé˜¶æ®µä¸»è¦å°±æ˜¯æ‰§è¡Œ Task åŠå…¶ä¾èµ–çš„ Task</p><h3 id="2ï¼‰ã€Gradle-ç”Ÿå‘½å‘¨æœŸ-Hook-ç‚¹"><a href="#2ï¼‰ã€Gradle-ç”Ÿå‘½å‘¨æœŸ-Hook-ç‚¹" class="headerlink" title="2ï¼‰ã€Gradle ç”Ÿå‘½å‘¨æœŸ Hook ç‚¹"></a>2ï¼‰ã€Gradle ç”Ÿå‘½å‘¨æœŸ Hook ç‚¹</h3><p>å¼•ç”¨ joe_H ä¸€å¼ å®Œæ•´çš„ Gradle ç”Ÿå‘½å‘¨æœŸå›¾ï¼Œå¦‚ä¸‹ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/403a1114a8ad4d8bb725224a70dedc5a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210704212912830" style="zoom:50%;" /><p>ä¸Šå›¾å¯¹ Gradle ç”Ÿå‘½å‘¨æœŸæ€»ç»“çš„å¾ˆåˆ°ä½ï¼Œæˆ‘ä»¬è§£æä¸€æ³¢ï¼š</p><p><strong>æ³¨æ„</strong>ï¼šGradle æ‰§è¡Œè„šæœ¬æ–‡ä»¶çš„æ—¶å€™ä¼šç”Ÿæˆå¯¹åº”çš„å®ä¾‹ï¼Œä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ç§å¯¹è±¡ï¼š</p><blockquote><p>1ã€Gradle å¯¹è±¡ï¼šåœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶æ„å»ºï¼Œå…¨å±€å•ä¾‹å­˜åœ¨ï¼Œåªæœ‰è¿™ä¸€ä¸ªå¯¹è±¡</p><p>2ã€Project å¯¹è±¡ï¼šæ¯ä¸€ä¸ª build.gradle éƒ½ä¼šè½¬æ¢æˆä¸€ä¸ª Project å¯¹è±¡</p><p>3ã€Settings å¯¹è±¡ï¼šSeetings.gradle ä¼šè½¬å˜æˆä¸€ä¸ª Seetings å¯¹è±¡</p></blockquote><p>1ã€Gradle åœ¨å„ä¸ªé˜¶æ®µéƒ½æä¾›äº†ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œåœ¨æ·»åŠ ç›‘å¬å™¨çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼š<strong>ç›‘å¬å™¨è¦åœ¨ç”Ÿå‘½å‘¨æœŸå›è°ƒä¹‹å‰æ·»åŠ ï¼Œå¦åˆ™ä¼šå¯¼è‡´æœ‰äº›å›è°ƒæ”¶ä¸åˆ°</strong></p><p>2ã€Gradle åˆå§‹åŒ–é˜¶æ®µ</p><ul><li>åœ¨ settings.gradle æ‰§è¡Œå®Œåï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ settingsEvaluated æ–¹æ³•</li><li>åœ¨æ„å»ºæ‰€æœ‰å·¥ç¨‹ build.gradle å¯¹åº”çš„ Project å¯¹è±¡åï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–é˜¶æ®µå®Œæ¯•ï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ projectsLoaded æ–¹æ³•</li></ul><p>3ã€Gradle é…ç½®é˜¶æ®µï¼š</p><ul><li>Gradle ä¼šå¾ªç¯æ‰§è¡Œæ¯ä¸ªå·¥ç¨‹çš„ build.gradle è„šæœ¬æ–‡ä»¶</li><li>åœ¨æ‰§è¡Œå½“å‰å·¥ç¨‹ build.gradle å‰ï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ beforeProject æ–¹æ³•å’Œå½“å‰ Project å¯¹è±¡çš„ beforeEvaluate æ–¹æ³•</li><li>åœ¨æ‰§è¡Œå½“å‰å·¥ç¨‹ build.gradle åï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ afterProject æ–¹æ³•å’Œå½“å‰ Project å¯¹è±¡çš„ afterEvaluate æ–¹æ³•</li><li>åœ¨æ‰€æœ‰å·¥ç¨‹çš„ build.gradle æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ projectsEvaluated æ–¹æ³•</li><li>åœ¨æ„å»º Task ä¾èµ–æœ‰å‘æ— ç¯å›¾åï¼Œä¹Ÿå°±æ˜¯é…ç½®é˜¶æ®µå®Œæ¯•ï¼Œä¼šå›è°ƒ TaskExecutionGraph å¯¹è±¡çš„ whenReady æ–¹æ³•</li></ul><p><strong>æ³¨æ„</strong>ï¼š Gradle å¯¹è±¡çš„ beforeProjectï¼ŒafterProject æ–¹æ³•å’Œ Project å¯¹è±¡çš„ beforeEvaluate ï¼ŒafterEvaluate æ–¹æ³•å›è°ƒæ—¶æœºæ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«åœ¨äºï¼š</p><blockquote><p>1ã€Gradle å¯¹è±¡çš„ beforeProjectï¼ŒafterProject æ–¹æ³•é’ˆå¯¹é¡¹ç›®ä¸‹çš„æ‰€æœ‰å·¥ç¨‹ï¼Œå³æ¯ä¸ªå·¥ç¨‹çš„ build.gradle æ‰§è¡Œå‰åéƒ½ä¼šæ”¶åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•çš„å›è°ƒ</p><p>2ã€ Project å¯¹è±¡çš„ beforeEvaluate ï¼ŒafterEvaluate æ–¹æ³•é’ˆå¯¹å½“å‰å·¥ç¨‹ï¼Œå³å½“å‰å·¥ç¨‹çš„ build.gradle æ‰§è¡Œå‰åä¼šæ”¶åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•çš„å›è°ƒ</p></blockquote><p>4ã€æ‰§è¡Œé˜¶æ®µï¼š</p><ul><li>Gradle ä¼šå¾ªç¯æ‰§è¡Œ Task åŠå…¶ä¾èµ–çš„ Task</li><li>åœ¨å½“å‰ Task æ‰§è¡Œä¹‹å‰ï¼Œä¼šå›è°ƒ TaskExecutionGraph å¯¹è±¡çš„ beforeTask æ–¹æ³•</li><li>åœ¨å½“å‰ Task æ‰§è¡Œä¹‹åï¼Œä¼šå›è°ƒ TaskExecutionGraph å¯¹è±¡çš„ afterTask æ–¹æ³•</li></ul><p>5ã€å½“æ‰€æœ‰çš„ Task æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå›è°ƒ Gradle å¯¹è±¡çš„ buildFinish æ–¹æ³•</p><p>äº†è§£äº† Gradle ç”Ÿå‘½å‘¨æœŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ·»åŠ  Hookã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯ä»¥æ‰“å° Gradle æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå„ä¸ªé˜¶æ®µåŠå„ä¸ª Task çš„è€—æ—¶</p><h3 id="3ï¼‰ã€æ‰“å°-Gradle-æ„å»ºå„ä¸ªé˜¶æ®µåŠå„ä¸ªä»»åŠ¡çš„è€—æ—¶"><a href="#3ï¼‰ã€æ‰“å°-Gradle-æ„å»ºå„ä¸ªé˜¶æ®µåŠå„ä¸ªä»»åŠ¡çš„è€—æ—¶" class="headerlink" title="3ï¼‰ã€æ‰“å° Gradle æ„å»ºå„ä¸ªé˜¶æ®µåŠå„ä¸ªä»»åŠ¡çš„è€—æ—¶"></a>3ï¼‰ã€æ‰“å° Gradle æ„å»ºå„ä¸ªé˜¶æ®µåŠå„ä¸ªä»»åŠ¡çš„è€—æ—¶</h3><p>åœ¨ settings.gradle æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åˆå§‹åŒ–é˜¶æ®µå¼€å§‹æ—¶é—´</span><br><span class="hljs-type">long</span> beginOfSetting = System.currentTimeMillis()<br><span class="hljs-comment">//é…ç½®é˜¶æ®µå¼€å§‹æ—¶é—´</span><br><span class="hljs-keyword">def</span> beginOfConfig<br><span class="hljs-comment">//é…ç½®é˜¶æ®µæ˜¯å¦å¼€å§‹äº†ï¼Œåªæ‰§è¡Œä¸€æ¬¡</span><br><span class="hljs-keyword">def</span> configHasBegin = <span class="hljs-literal">false</span><br><span class="hljs-comment">//å­˜æ”¾æ¯ä¸ª build.gradle æ‰§è¡Œä¹‹å‰çš„æ—¶é—´</span><br><span class="hljs-keyword">def</span> beginOfProjectConfig = <span class="hljs-keyword">new</span> HashMap()<br><span class="hljs-comment">//æ‰§è¡Œé˜¶æ®µå¼€å§‹æ—¶é—´</span><br><span class="hljs-keyword">def</span> beginOfTaskExecute<br><span class="hljs-comment">//åˆå§‹åŒ–é˜¶æ®µæ‰§è¡Œå®Œæ¯•</span><br>gradle.projectsLoaded &#123;<br>    println <span class="hljs-string">&quot;åˆå§‹åŒ–æ€»è€—æ—¶ $&#123;System.currentTimeMillis() - beginOfSetting&#125; ms&quot;</span><br>&#125;<br><br><span class="hljs-comment">//build.gradle æ‰§è¡Œå‰</span><br>gradle.beforeProject &#123;Project project -&gt;<br>    <span class="hljs-keyword">if</span>(!configHasBegin)&#123;<br>        configHasBegin = <span class="hljs-literal">true</span><br>        beginOfConfig = System.currentTimeMillis()<br>    &#125;<br>    beginOfProjectConfig.put(project,System.currentTimeMillis())<br>&#125;<br><br><span class="hljs-comment">//build.gradle æ‰§è¡Œå</span><br>gradle.afterProject &#123;Project project -&gt;<br>    <span class="hljs-keyword">def</span> begin = beginOfProjectConfig.get(project)<br>    println <span class="hljs-string">&quot;é…ç½®é˜¶æ®µï¼Œ$project è€—æ—¶ï¼š$&#123;System.currentTimeMillis() - begin&#125; ms&quot;</span><br>&#125;<br><br><span class="hljs-comment">//é…ç½®é˜¶æ®µå®Œæ¯•</span><br>gradle.taskGraph.whenReady &#123;<br>    println <span class="hljs-string">&quot;é…ç½®é˜¶æ®µæ€»è€—æ—¶ï¼š$&#123;System.currentTimeMillis() - beginOfConfig&#125; ms&quot;</span><br>    beginOfTaskExecute = System.currentTimeMillis()<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œé˜¶æ®µ</span><br>gradle.taskGraph.beforeTask &#123;Task task -&gt;<br>    task.doFirst &#123;<br>        task.ext.beginOfTask = System.currentTimeMillis()<br>    &#125;<br><br>    task.doLast &#123;<br>        println <span class="hljs-string">&quot;æ‰§è¡Œé˜¶æ®µï¼Œ$task è€—æ—¶ï¼š$&#123;System.currentTimeMillis() - task.ext.beginOfTask&#125; ms&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œé˜¶æ®µå®Œæ¯•</span><br>gradle.buildFinished &#123;<br>    println <span class="hljs-string">&quot;æ‰§è¡Œé˜¶æ®µæ€»è€—æ—¶ï¼š$&#123;System.currentTimeMillis() - beginOfTaskExecute&#125;&quot;</span><br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ Gradle å‘½ä»¤</span><br>./gradlew clean<br><br><span class="hljs-comment">//æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</span><br>åˆå§‹åŒ–æ€»è€—æ—¶ <span class="hljs-number">140</span> ms<br><br>&gt; Configure <span class="hljs-attr">project :</span><br>é…ç½®é˜¶æ®µï¼Œroot project <span class="hljs-string">&#x27;GradleDemo&#x27;</span> è€—æ—¶ï¼š<span class="hljs-number">1181</span> ms<br><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>é…ç½®é˜¶æ®µï¼Œproject <span class="hljs-string">&#x27;:app&#x27;</span> è€—æ—¶ï¼š<span class="hljs-number">1122</span> ms<br>é…ç½®é˜¶æ®µæ€»è€—æ—¶ï¼š<span class="hljs-number">2735</span> ms<br><br>&gt; <span class="hljs-attr">Task :</span>clean<br>æ‰§è¡Œé˜¶æ®µï¼Œtask <span class="hljs-string">&#x27;:clean&#x27;</span> è€—æ—¶ï¼š<span class="hljs-number">0</span> ms<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>clean<br>æ‰§è¡Œé˜¶æ®µï¼Œtask <span class="hljs-string">&#x27;:app:clean&#x27;</span> è€—æ—¶ï¼š<span class="hljs-number">1</span> ms<br>æ‰§è¡Œé˜¶æ®µæ€»è€—æ—¶ï¼š<span class="hljs-number">325</span><br></code></pre></td></tr></table></figure><p>äº†è§£äº† Gradle çš„ä¸‰ä¸ªé˜¶æ®µåŠç”Ÿå‘½å‘¨æœŸï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å­¦ä¹  Gradle çš„ä¸€äº›æ ¸å¿ƒ API</p><h2 id="äºŒã€Project-ä»‹ç»"><a href="#äºŒã€Project-ä»‹ç»" class="headerlink" title="äºŒã€Project ä»‹ç»"></a>äºŒã€Project ä»‹ç»</h2><p>å¯¹äºä¸€ä¸ª Android é¡¹ç›®ï¼Œbuild.gradle è„šæœ¬æ–‡ä»¶æ˜¯æˆ‘ä»¬ç»å¸¸æ“ä½œçš„æ–‡ä»¶ä¹‹ä¸€ï¼Œè€Œæ¯ä¸ª build.gradle å°±å¯¹åº”äº†ä¸€ä¸ª Project å¯¹è±¡ï¼Œå› æ­¤å­¦ä¹ å¥½   Project å¯¹åº”çš„ API èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„å»æ“ä½œ build.gradle è„šæœ¬æ–‡ä»¶, åŒæ—¶ä¹Ÿèƒ½çœ‹æ‡‚å¤§ä½¬ä»¬æ‰€å†™çš„ä¸€äº›é…ç½®è¯­å¥ã€‚</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9bc9ab568af4fb2af66bcb398926898~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210718164127432" style="zoom:50%;" /><p>é¦–å…ˆçœ‹ä¸€çœ¼æˆ‘çš„é¡¹ç›®ç»“æ„ï¼Œåç»­å°±æ˜¯åŸºäºå®ƒæ¥åšæ¼”ç¤º</p><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€ä¸‹é¢æ‰€æ¼”ç¤ºçš„ API éƒ½æ˜¯ä¸€äº›å¸¸ç”¨çš„ APIï¼Œå¯¹ API ä½¿ç”¨æœ‰ç–‘é—®çš„å¯ä»¥å»æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£</p><p>2ã€API çš„æ¼”ç¤ºå¦‚æœæ²¡åšç‰¹æ®Šè¯´æ˜ï¼Œåˆ™æ˜¯åœ¨ app çš„ build.gradle æ–‡ä»¶ä¸‹æ“ä½œçš„</p><h3 id="1ï¼‰ã€Project-API"><a href="#1ï¼‰ã€Project-API" class="headerlink" title="1ï¼‰ã€Project API"></a>1ï¼‰ã€Project API</h3><p><a href="https://docs.gradle.org/current/javadoc/org/gradle/api/Project.html">Project API æ–‡æ¡£</a>ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ API</p><h4 id="1ã€getRootProject-æ–¹æ³•"><a href="#1ã€getRootProject-æ–¹æ³•" class="headerlink" title="1ã€getRootProject æ–¹æ³•"></a>1ã€getRootProject æ–¹æ³•</h4><p>è·å–æ ¹ Project å¯¹è±¡</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">println getRootProject()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>root project <span class="hljs-string">&#x27;GradleDemo&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="2ã€getRootDir-æ–¹æ³•"><a href="#2ã€getRootDir-æ–¹æ³•" class="headerlink" title="2ã€getRootDir æ–¹æ³•"></a>2ã€getRootDir æ–¹æ³•</h4><p>è·å–æ ¹ç›®å½•æ–‡ä»¶å¤¹è·¯å¾„</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">println getRootDir()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br><span class="hljs-regexp">/Users/</span>zhouying<span class="hljs-regexp">/learning/</span>GradleDemo<br></code></pre></td></tr></table></figure><h4 id="3ã€getBuildDir-æ–¹æ³•"><a href="#3ã€getBuildDir-æ–¹æ³•" class="headerlink" title="3ã€getBuildDir æ–¹æ³•"></a>3ã€getBuildDir æ–¹æ³•</h4><p>è·å–å½“å‰ Project çš„ build æ–‡ä»¶å¤¹è·¯å¾„</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">println getBuildDir()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br><span class="hljs-regexp">/Users/</span>zhouying<span class="hljs-regexp">/learning/</span>GradleDemo<span class="hljs-regexp">/app/</span>build<br></code></pre></td></tr></table></figure><h4 id="4ã€getParent-æ–¹æ³•"><a href="#4ã€getParent-æ–¹æ³•" class="headerlink" title="4ã€getParent æ–¹æ³•"></a>4ã€getParent æ–¹æ³•</h4><p>è·å–å½“å‰çˆ¶ Project å¯¹è±¡</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">println getParent()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>root project <span class="hljs-string">&#x27;GradleDemo&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="5ã€getAllprojects-æ–¹æ³•"><a href="#5ã€getAllprojects-æ–¹æ³•" class="headerlink" title="5ã€getAllprojects æ–¹æ³•"></a>5ã€getAllprojects æ–¹æ³•</h4><p>è·å–å½“å‰ Project åŠå…¶å­ Project å¯¹è±¡ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª Set é›†åˆ</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨æ ¹å·¥ç¨‹çš„ build.gradle æ–‡ä»¶ä¸‹</span><br>println getAllprojects()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span><br>[root project <span class="hljs-string">&#x27;GradleDemo&#x27;</span>, project <span class="hljs-string">&#x27;:app&#x27;</span>]<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å…¶é—­åŒ…çš„å½¢å¼</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy">allprojects &#123;<br>    println it<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span><br>root project <span class="hljs-string">&#x27;GradleDemo&#x27;</span><br>project <span class="hljs-string">&#x27;:app&#x27;</span><br><br><span class="hljs-comment">//æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨é—­åŒ…çš„è¯­æ³•åœ¨æ ¹ build.gradle ä¸‹è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œå¦‚ä¸‹ï¼š</span><br>allprojects &#123;<br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šæ ¹ Project ä¸å…¶å­ Project ç»„æˆäº†ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œä½†è¿™é¢—æ ‘çš„é«˜åº¦ä¹Ÿä»…ä»…è¢«é™å®šä¸ºäº†ä¸¤å±‚</p><h4 id="6ã€getSubprojects-æ–¹æ³•"><a href="#6ã€getSubprojects-æ–¹æ³•" class="headerlink" title="6ã€getSubprojects æ–¹æ³•"></a>6ã€getSubprojects æ–¹æ³•</h4><p>è·å–å½“å‰ Project ä¸‹çš„æ‰€æœ‰å­ Project å¯¹è±¡ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª Set é›†åˆ</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨æ ¹å·¥ç¨‹çš„ build.gradle æ–‡ä»¶ä¸‹</span><br>println getSubprojects()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span><br>[project <span class="hljs-string">&#x27;:app&#x27;</span>]<br></code></pre></td></tr></table></figure><p>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶é—­åŒ…çš„å½¢å¼</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy">subprojects &#123;<br>    println it<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span><br>project <span class="hljs-string">&#x27;:app&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="7ã€apply-ç³»åˆ—æ–¹æ³•"><a href="#7ã€apply-ç³»åˆ—æ–¹æ³•" class="headerlink" title="7ã€apply ç³»åˆ—æ–¹æ³•"></a>7ã€apply ç³»åˆ—æ–¹æ³•</h4><p>å¼•ç”¨æ’ä»¶</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å¼•ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.application&#x27;</span><br><br><span class="hljs-comment">//å¼•ç”¨è„šæœ¬æ–‡ä»¶æ’ä»¶</span><br>apply <span class="hljs-attr">from:</span> <span class="hljs-string">&#x27;config.gradle&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="8ã€configurations-é—­åŒ…"><a href="#8ã€configurations-é—­åŒ…" class="headerlink" title="8ã€configurations é—­åŒ…"></a>8ã€configurations é—­åŒ…</h4><p>ç¼–å†™ Project ä¸€äº›ç›¸å…³çš„é…ç½®ï¼Œå¦‚å…¨å±€ç§»é™¤æŸä¸ªä¾èµ–</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations &#123;<br>    all*.exclude <span class="hljs-attr">group:</span> <span class="hljs-string">&#x27;ç»„å&#x27;</span>, <span class="hljs-attr">module:</span> <span class="hljs-string">&#x27;æ¨¡å—å&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="9ã€project-ç³»åˆ—æ–¹æ³•"><a href="#9ã€project-ç³»åˆ—æ–¹æ³•" class="headerlink" title="9ã€project ç³»åˆ—æ–¹æ³•"></a>9ã€project ç³»åˆ—æ–¹æ³•</h4><p>æŒ‡å®šå·¥ç¨‹å®ä¾‹ï¼Œç„¶ååœ¨é—­åŒ…ä¸­å¯¹å…¶è¿›è¡Œç›¸å…³çš„é…ç½®</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">project(<span class="hljs-string">&quot;app&quot;</span>) &#123;<br>    apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.application&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€æ‰©å±•å±æ€§"><a href="#2ï¼‰ã€æ‰©å±•å±æ€§" class="headerlink" title="2ï¼‰ã€æ‰©å±•å±æ€§"></a>2ï¼‰ã€æ‰©å±•å±æ€§</h3><p>æ‰©å±•å±æ€§ä½œç”¨ï¼šæ–¹ä¾¿æˆ‘ä»¬å…¨å±€çš„ä¸€ä¸ªä½¿ç”¨ã€‚ç±»ä¼¼ Java ä¸­ï¼Œåœ¨å·¥å…·ç±»é‡Œé¢å®šä¹‰é™æ€æ–¹æ³•</p><h4 id="1ã€æ‰©å±•å±æ€§å®šä¹‰"><a href="#1ã€æ‰©å±•å±æ€§å®šä¹‰" class="headerlink" title="1ã€æ‰©å±•å±æ€§å®šä¹‰"></a>1ã€æ‰©å±•å±æ€§å®šä¹‰</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥å®šä¹‰æ‰©å±•å±æ€§ï¼š</p><p>1ã€é€šè¿‡ <strong>ext</strong> å…³é”®å­—å®šä¹‰æ‰©å±•å±æ€§</p><p>2ã€åœ¨ <strong>gradle.properties</strong> ä¸‹å®šä¹‰æ‰©å±•å±æ€§</p><h5 id="1ã€é€šè¿‡-ext-å…³é”®å­—å®šä¹‰æ‰©å±•å±æ€§"><a href="#1ã€é€šè¿‡-ext-å…³é”®å­—å®šä¹‰æ‰©å±•å±æ€§" class="headerlink" title="1ã€é€šè¿‡ ext å…³é”®å­—å®šä¹‰æ‰©å±•å±æ€§"></a>1ã€é€šè¿‡ ext å…³é”®å­—å®šä¹‰æ‰©å±•å±æ€§</h5><p>é€šè¿‡ ext å®šä¹‰æ‰©å±•å±æ€§çš„è¯­æ³•æœ‰ä¸¤ç§ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å½“å‰åœ¨æ ¹ build.gradle ä¸‹</span><br><span class="hljs-comment">//æ–¹å¼1ï¼šext.å±æ€§å</span><br>ext.test = <span class="hljs-string">&#x27;erdai666&#x27;</span><br><br><span class="hljs-comment">//æ–¹å¼2ï¼šext åé¢æ¥ä¸Šä¸€ä¸ªé—­åŒ…</span><br>ext&#123;<br>  test1 = <span class="hljs-string">&#x27;erdai777&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2ã€åœ¨-gradle-properties-ä¸‹å®šä¹‰æ‰©å±•å±æ€§"><a href="#2ã€åœ¨-gradle-properties-ä¸‹å®šä¹‰æ‰©å±•å±æ€§" class="headerlink" title="2ã€åœ¨ gradle.properties ä¸‹å®šä¹‰æ‰©å±•å±æ€§"></a>2ã€åœ¨ gradle.properties ä¸‹å®šä¹‰æ‰©å±•å±æ€§</h5><p>é€šè¿‡ gradle.properties å®šä¹‰æ‰©å±•å±æ€§ï¼Œç›´æ¥ä½¿ç”¨ <strong>key&#x3D;value</strong> çš„å½¢å¼å³å¯ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">test2=erdai888<br></code></pre></td></tr></table></figure><h4 id="2ã€æ‰©å±•å±æ€§è°ƒç”¨"><a href="#2ã€æ‰©å±•å±æ€§è°ƒç”¨" class="headerlink" title="2ã€æ‰©å±•å±æ€§è°ƒç”¨"></a>2ã€æ‰©å±•å±æ€§è°ƒç”¨</h4><p>1ã€ext å®šä¹‰çš„æ‰©å±•å±æ€§è°ƒç”¨çš„æ—¶å€™å¯ä»¥å»æ‰ ext å‰ç¼€ç›´æ¥è°ƒç”¨</p><p>2ã€ext å®šä¹‰çš„æ‰©å±•å±æ€§ä¹Ÿå¯ä»¥é€šè¿‡ <strong>å½“å‰å®šä¹‰æ‰©å±•å±æ€§çš„ Project å¯¹è±¡.ext.å±æ€§å</strong> è¿›è¡Œè°ƒç”¨</p><p>3ã€gradle.properties å®šä¹‰çš„æ‰©å±•å±æ€§ç›´æ¥é€šè¿‡å±æ€§åè°ƒç”¨å³å¯</p><p>ä¸‹é¢æˆ‘ä»¬åœ¨ app çš„ build.gradle ä¸‹è¿›è¡Œæ¼”ç¤ºï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ä¸‹é¢è¿™ç§å†™æ³•ä¹‹æ‰€ä»¥èƒ½è¿™ä¹ˆå†™</span><br><span class="hljs-comment"> * 1ã€ext å®šä¹‰çš„æ‰©å±•å±æ€§è°ƒç”¨çš„æ—¶å€™å¯ä»¥å»æ‰ ext å‰ç¼€ç›´æ¥è°ƒç”¨</span><br><span class="hljs-comment"> * 2ã€å­ Project èƒ½æ‹¿åˆ°æ ¹ Project ä¸­çš„å±æ€§å’Œæ–¹æ³•</span><br><span class="hljs-comment"> */</span><br>println test<br>println test1<br>println test2<br><br><span class="hljs-comment">//2ã€ext å®šä¹‰çš„æ‰©å±•å±æ€§ä¹Ÿå¯ä»¥é€šè¿‡ å½“å‰å®šä¹‰æ‰©å±•å±æ€§çš„ Project å¯¹è±¡.ext.å±æ€§å è°ƒç”¨</span><br>println rootProject.ext.test<br>println rootProject.ext.test1<br>println test2<br><br><span class="hljs-comment">//ä¸Šè¿°ä¸¤ç§æ–¹å¼æ‰“å°ç»“æœå‡ä¸º</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>erdai666<br>erdai777<br>erdai888<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> å­ Project å’Œæ ¹ Project å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œå› æ­¤æ ¹ Project ä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•å­ Project èƒ½è·å–åˆ°</p><h4 id="3ã€æ‰©å±•å±æ€§åº”ç”¨"><a href="#3ã€æ‰©å±•å±æ€§åº”ç”¨" class="headerlink" title="3ã€æ‰©å±•å±æ€§åº”ç”¨"></a>3ã€æ‰©å±•å±æ€§åº”ç”¨</h4><p>é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨æ‰©å±•å±æ€§æ¥ä¼˜åŒ– build.gradle è„šæœ¬æ–‡ä»¶ï¼Œä¾‹å¦‚æˆ‘ä»¬ä»¥ä¼˜åŒ– app ä¸‹çš„ build.gradle ä¸ºä¾‹ï¼š</p><p>é¦–å…ˆçœ‹ä¸€çœ¼ä¼˜åŒ–ä¹‹å‰ app çš„ build.gradle é•¿å•¥æ ·ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.application&#x27;</span><br><br>android &#123;<br>    compileSdkVersion <span class="hljs-number">30</span><br><br>    defaultConfig &#123;<br>        applicationId <span class="hljs-string">&quot;com.dream.gradledemo&quot;</span><br>        minSdkVersion <span class="hljs-number">19</span><br>        targetSdkVersion <span class="hljs-number">30</span><br>        versionCode <span class="hljs-number">1</span><br>        versionName <span class="hljs-string">&quot;1.0&quot;</span><br><br>        testInstrumentationRunner <span class="hljs-string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span><br>    &#125;<br><br>    buildTypes &#123;<br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">false</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>dependencies &#123;<br>    implementation <span class="hljs-string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span><br>    implementation <span class="hljs-string">&#x27;com.google.android.material:material:1.4.0&#x27;</span><br>    implementation <span class="hljs-string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span><br>    testImplementation <span class="hljs-string">&#x27;junit:junit:4.13.2&#x27;</span><br>    androidTestImplementation <span class="hljs-string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span><br>    androidTestImplementation <span class="hljs-string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥è¿›è¡Œæ”¹é€ </p><p><strong>æ­¥éª¤1ï¼š</strong> åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶ config.gradle ï¼Œç”¨æ¥å­˜æ”¾æ‰©å±•å±æ€§</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ext&#123;<br><br>    androidConfig = [<br>            <span class="hljs-attr">compileSdkVersion :</span> <span class="hljs-number">30</span>,<br>            <span class="hljs-attr">applicationId :</span> <span class="hljs-string">&#x27;com.dream.gradledemo&#x27;</span>,<br>            <span class="hljs-attr">minSdkVersion :</span> <span class="hljs-number">19</span>,<br>            <span class="hljs-attr">targetSdkVersion :</span> <span class="hljs-number">30</span>,<br>            <span class="hljs-attr">versionCode :</span> <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">versionName :</span> <span class="hljs-string">&#x27;1.0&#x27;</span><br>    ]<br><br><br>    implementationLib = [<br>            <span class="hljs-attr">appcompat :</span> <span class="hljs-string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span>,<br>            <span class="hljs-attr">material  :</span> <span class="hljs-string">&#x27;com.google.android.material:material:1.4.0&#x27;</span>,<br>            <span class="hljs-attr">constraintlayout :</span> <span class="hljs-string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span><br>    ]<br><br>    testImplementationLib = [<br>            <span class="hljs-attr">junit :</span> <span class="hljs-string">&#x27;junit:junit:4.13.2&#x27;</span><br>    ]<br><br><br>    androidTestImplementationLib = [<br>            <span class="hljs-attr">junit :</span> <span class="hljs-string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span>,<br>            <span class="hljs-string">&#x27;espresso-core&#x27;</span> : <span class="hljs-string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ­¥éª¤2ï¼š</strong> åœ¨æ ¹ build.gradle å¯¹ config.gradle è¿›è¡Œå¼•ç”¨</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">from:</span> <span class="hljs-string">&#x27;config.gradle&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> åœ¨æ ¹ build.gradle è¿›è¡Œå¼•ç”¨çš„å¥½å¤„å°±æ˜¯æ‰€æœ‰çš„å­ build.gradle éƒ½èƒ½å¤Ÿè·å–åˆ°è¿™äº›æ‰©å±•å±æ€§</p><p><strong>æ­¥éª¤3:</strong>  åœ¨ app çš„ build.gradle é‡Œé¢è¿›è¡Œæ‰©å±•å±æ€§çš„è°ƒç”¨</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&#x27;com.android.application&#x27;</span><br><br>android &#123;<br>    compileSdkVersion androidConfig.compileSdkVersion<br><br>    defaultConfig &#123;<br>        applicationId androidConfig.applicationId<br>        minSdkVersion androidConfig.minSdkVersion<br>        targetSdkVersion androidConfig.targetSdkVersion<br>        versionCode androidConfig.versionCode<br>        versionName androidConfig.versionName<br><br>        testInstrumentationRunner <span class="hljs-string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span><br>    &#125;<br><br>    buildTypes &#123;<br>        release &#123;<br>            minifyEnabled <span class="hljs-literal">false</span><br>            proguardFiles getDefaultProguardFile(<span class="hljs-string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="hljs-string">&#x27;proguard-rules.pro&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">def</span> implementationLibMap = implementationLib<br><span class="hljs-keyword">def</span> testImplementationLibMap = testImplementationLib<br><span class="hljs-keyword">def</span> androidTestImplementationLibMap = androidTestImplementationLib<br><br>dependencies &#123;<br>    implementationLibMap.each&#123;k,v -&gt;<br>        implementation v<br>    &#125;<br><br>    testImplementationLibMap.each&#123;k,v -&gt;<br>        testImplementation v<br>    &#125;<br><br>    androidTestImplementationLibMap.each&#123;k,v -&gt;<br>        androidTestImplementation v<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€æ–‡ä»¶æ“ä½œ-API"><a href="#3ï¼‰ã€æ–‡ä»¶æ“ä½œ-API" class="headerlink" title="3ï¼‰ã€æ–‡ä»¶æ“ä½œ API"></a>3ï¼‰ã€æ–‡ä»¶æ“ä½œ API</h3><h4 id="1ã€file-x2F-files-ç³»åˆ—æ–‡ä»¶å®šä½"><a href="#1ã€file-x2F-files-ç³»åˆ—æ–‡ä»¶å®šä½" class="headerlink" title="1ã€file&#x2F;files ç³»åˆ—æ–‡ä»¶å®šä½"></a>1ã€file&#x2F;files ç³»åˆ—æ–‡ä»¶å®šä½</h4><p>Project å¯¹è±¡æä¾›çš„ file&#x2F;files ç³»åˆ—æ–¹æ³•ä¸»è¦ç”¨æ¥å®šä½ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶ï¼Œå€¼çš„æ³¨æ„çš„æ˜¯ï¼š<strong>å®ƒä»¬æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œä»å½“å‰ project å·¥ç¨‹å¼€å§‹æŸ¥æ‰¾</strong>ï¼Œè€Œæˆ‘ä»¬é€šè¿‡ new File çš„æ–¹å¼éœ€è¦ä¼ å…¥ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œä¸‹é¢é€šè¿‡ä»£ç æ¼”ç¤ºæ„Ÿå—ä¸€ä¸‹ä»–ä»¬çš„åŒºåˆ«ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//============================== 1ã€file æ–¹æ³•åº”ç”¨============================</span><br><span class="hljs-comment">//é€šè¿‡ file æ–¹æ³•ä¼ å…¥ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª file å¯¹è±¡</span><br>println file(<span class="hljs-string">&#x27;../config.gradle&#x27;</span>).text<br><br><span class="hljs-comment">//é€šè¿‡ new File æ–¹å¼ä¼ å…¥ä¸€ä¸ªç»å¯¹è·¯å¾„</span><br><span class="hljs-keyword">def</span> file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&#x27;/Users/zhouying/learning/GradleDemo/config.gradle&#x27;</span>)<br>println file.text<br><br><span class="hljs-comment">//ä¸Šè¿°ä¸¤è€…æ‰“å°ç»“æœç›¸åŒï¼Œå¦‚ä¸‹æˆªå›¾</span><br><br><span class="hljs-comment">//============================== 2ã€files æ–¹æ³•åº”ç”¨============================</span><br><span class="hljs-comment">//é€šè¿‡ files æ–¹æ³•ä¼ å…¥å¤šä¸ªç›¸å¯¹è·¯å¾„ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª ConfigurableFileCollection å³æ–‡ä»¶é›†åˆ</span><br>files(<span class="hljs-string">&#x27;../config.gradle&#x27;</span>,<span class="hljs-string">&#x27;../build.gradle&#x27;</span>).each &#123;<br>    println it.name<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>config.gradle<br>build.gradle<br></code></pre></td></tr></table></figure><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/152c811c766440cd857b72a8b8c1542c~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717121715148"  /><h4 id="2ã€copy-æ–‡ä»¶æ‹·è´"><a href="#2ã€copy-æ–‡ä»¶æ‹·è´" class="headerlink" title="2ã€copy æ–‡ä»¶æ‹·è´"></a>2ã€copy æ–‡ä»¶æ‹·è´</h4><blockquote><p>1ã€Project å¯¹è±¡æä¾›äº† copy æ–¹æ³•ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬æ‹·è´ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å˜å¾—ååˆ†ç®€å•</p><p>2ã€copy æ–¹æ³•èƒ½å¤Ÿæ¥æ”¶ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…çš„å‚æ•° CopySpec ï¼ŒCopySpec æä¾›äº†å¾ˆå¤šæ–‡ä»¶æ“ä½œçš„ APIï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/file/CopySpec.html">ä¼ é€é—¨</a></p></blockquote><p>ä¸‹é¢ä¼šä½¿ç”¨åˆ° CopySpec çš„ from å’Œ into æ–¹æ³•</p><p><strong>æ³¨æ„ï¼š</strong> from å’Œ into æ¥æ”¶çš„å‚æ•°æ˜¯ Object ç±»å‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªè·¯å¾„æˆ–æ–‡ä»¶</p><p>1ã€æ–‡ä»¶æ‹·è´</p><p>ä¾‹å¦‚æˆ‘ä»¬å®ç°ï¼š<strong>å°†æ ¹ç›®å½•ä¸‹çš„ config.gradle æ–‡ä»¶æ‹·è´æ‹·è´åˆ° app ç›®å½•ä¸‹ã€‚</strong> å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€ä¼ å…¥è·¯å¾„</span><br>copy &#123;<br>    from getRootDir().path + <span class="hljs-string">&quot;/config.gradle&quot;</span><br>    into getProjectDir().path<br>&#125;<br><br><span class="hljs-comment">//2ã€ä¼ å…¥æ–‡ä»¶</span><br>copy &#123;<br>    from file(<span class="hljs-string">&#x27;../config.gradle&#x27;</span>)<br>    into getProjectDir()<br>&#125;<br><br><span class="hljs-comment">//æœ€ç»ˆç»“æœæ˜¯è¿™ä¸¤ç§æ–¹å¼éƒ½èƒ½æ‹·è´æˆåŠŸ</span><br></code></pre></td></tr></table></figure><p>2ã€æ–‡ä»¶å¤¹æ‹·è´</p><p>ä¾‹å¦‚æˆ‘ä»¬å®ç°ï¼š<strong>å°†æ ¹ç›®å½•ä¸‹çš„ gradle æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‹·è´åˆ° app ç›®å½•ä¸‹çš„ gradle æ–‡ä»¶å¤¹</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy">copy &#123;<br>    from file(<span class="hljs-string">&#x27;../gradle/&#x27;</span>)<br>    into getProjectDir().path + <span class="hljs-string">&quot;/gradle/&quot;</span><br>&#125;<br><br><span class="hljs-comment">//æœ€ç»ˆç»“æœæ‹·è´æˆåŠŸ</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœ app ç›®å½•ä¸‹æ²¡æœ‰ gradle æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆ copy æ–¹æ³•ä¼šç»™æˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºï¼Œéå¸¸çš„æ–¹ä¾¿</p><h4 id="3ã€fileTree-æ–‡ä»¶æ ‘æ˜ å°„"><a href="#3ã€fileTree-æ–‡ä»¶æ ‘æ˜ å°„" class="headerlink" title="3ã€fileTree æ–‡ä»¶æ ‘æ˜ å°„"></a>3ã€fileTree æ–‡ä»¶æ ‘æ˜ å°„</h4><p>Project å¯¹è±¡æä¾›äº† fileTree æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬å°†ä¸€ä¸ªç›®å½•è½¬æ¢ä¸ºæ–‡ä»¶æ ‘ï¼Œç„¶åå¯¹æ–‡ä»¶æ ‘è¿›è¡Œç›¸å…³çš„é€»è¾‘å¤„ç†ï¼Œå®ƒæ¥æ”¶çš„å‚æ•°å’Œ file&#x2F;files ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„</p><p>ä¾‹å¦‚æˆ‘ä»¬å®ç°ï¼š<strong>éå†æ ¹ç›®å½•ä¸‹çš„ gradle æ–‡ä»¶å¤¹ï¼Œå¹¶æ‰“å°æ–‡ä»¶åŠæ–‡ä»¶å¤¹çš„åç§°</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy">fileTree(<span class="hljs-string">&#x27;../gradle/&#x27;</span>)&#123; FileTree fileTree -&gt;<br>    fileTree.visit &#123; FileTreeElement fileTreeElement -&gt;<br>        println fileTreeElement.name<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>wrapper<br>gradle-wrapper.jar<br>gradle-wrapper.properties<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šå¸¸ä¼šåœ¨ app çš„ build.gradle ä¸‹çœ‹åˆ°è¿™ä¹ˆä¸€ä¸ªé…ç½®è¯­å¥ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">implementation fileTree(<span class="hljs-attr">include:</span> [<span class="hljs-string">&#x27;*.jar&#x27;</span>], <span class="hljs-attr">dir:</span> <span class="hljs-string">&#x27;libs&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä»–å®é™…ä¸Šæ˜¯è°ƒç”¨äº† fileTree æ¥æ”¶ Map å‚æ•°çš„é‡è½½æ–¹æ³•ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ConfigurableFileTree fileTree(Map&lt;String, ?&gt; var1);<br></code></pre></td></tr></table></figure><p>è¿™å¥é…ç½®è¯­å¥çš„æ„æ€å°±æ˜¯ï¼š<strong>å¼•å…¥å½“å‰ project ç›®å½•ä¸‹çš„ libs æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ jar åŒ…</strong></p><h3 id="4ï¼‰ã€buildscript-è§£è¯»"><a href="#4ï¼‰ã€buildscript-è§£è¯»" class="headerlink" title="4ï¼‰ã€buildscript è§£è¯»"></a>4ï¼‰ã€buildscript è§£è¯»</h3><p>æˆ‘ä»¬é€šå¸¸åœ¨æ–°å»ºä¸€ä¸ª Android é¡¹ç›®çš„æ—¶å€™å¯ä»¥çœ‹åˆ°æ ¹ build.gradle æœ‰è¿™ä¹ˆä¸€æ®µé…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>    <span class="hljs-comment">//æ’ä»¶ä»“åº“åœ°å€</span><br>    repositories &#123;<br>        google()<br>        mavenCentral()<br>    &#125;<br>  <br>    <span class="hljs-comment">//æ’ä»¶ä¾èµ–</span><br>    dependencies &#123;<br>        classpath <span class="hljs-string">&quot;com.android.tools.build:gradle:4.2.1&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒçš„ä½œç”¨æ˜¯ï¼š<strong>å¼•å…¥ Gradle æ„å»ºè¿‡ç¨‹ä¸­çš„ä¸€äº›æ’ä»¶</strong></p><p>å®é™…ä¸Šä¸Šé¢è¿™æ®µä»£ç çš„å®Œæ•´å†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs groovy">buildscript &#123; ScriptHandler scriptHandler -&gt;<br>    scriptHandler.repositories &#123; RepositoryHandler repositoryHandler -&gt;<br>        repositoryHandler.google()<br>        repositoryHandler.mavenCentral()<br>    &#125;<br>  <br>    scriptHandler.dependencies &#123; DependencyHandler dependencyHandler -&gt;<br>        dependencyHandler.classpath <span class="hljs-string">&quot;com.android.tools.build:gradle:4.2.1&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½ æ˜¯å¦ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªç–‘é—®ï¼šä¸ºå•¥è¿™äº›å‚æ•°éƒ½èƒ½å¤Ÿå»æ‰ï¼Œç®€åŒ–æˆä¸Šé¢é‚£æ ·ï¼ŸğŸ¤”ï¸</p><p>è¦æ˜ç™½ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬å¾—å¯¹é—­åŒ…æœ‰ä¸€å®šçš„äº†è§£ï¼š</p><p>1ã€é¦–å…ˆé—­åŒ…ä¸­æœ‰ owenr this delegate ä¸‰ä¸ªå¯¹è±¡ï¼Œè¿™ä¸‰ä¸ªå¯¹è±¡æ‹¥æœ‰çš„å±æ€§å’Œæ–¹æ³•æˆ‘ä»¬éƒ½å¯ä»¥è°ƒç”¨ï¼Œå¹¶ä¸”æ— éœ€å†™å‡ºæ¥</p><p>2ã€è¿™ä¸‰ä¸ªå¯¹è±¡è°ƒç”¨çš„å…ˆåé¡ºåºå–å†³äºé—­åŒ…çš„å§”æ‰˜ç­–ç•¥ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šå¯¹ delegate è¿›è¡Œæ“ä½œå¹¶ä¿®æ”¹å®ƒçš„å§”æ‰˜ç­–ç•¥</p><p>å®é™…ä¸Šï¼ŒGradle å¯¹ä¸Šé¢çš„è¿™äº›é—­åŒ…çš„ delegate ä¿®æ”¹ä¸ºäº†ä¼ å…¥é—­åŒ…çš„å‚æ•°ï¼Œå¹¶æŠŠå§”æ‰˜ç­–ç•¥è®¾ç½®ä¸ºäº† DELEGATE_FIRST ï¼Œå› æ­¤æˆ‘ä»¬è°ƒç”¨çš„æ—¶å€™æ‰èƒ½æŠŠè¿™äº›å‚æ•°ç»™å»æ‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡» buildscript è¿›å»çœ‹ä¸‹æºç ï¼Œè¿™é‡Œå°±ä¸å¯¹æºç è¿›è¡Œåˆ†æäº†</p><h3 id="5ï¼‰ã€exec-å¤–éƒ¨å‘½ä»¤æ‰§è¡Œ"><a href="#5ï¼‰ã€exec-å¤–éƒ¨å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="5ï¼‰ã€exec å¤–éƒ¨å‘½ä»¤æ‰§è¡Œ"></a>5ï¼‰ã€exec å¤–éƒ¨å‘½ä»¤æ‰§è¡Œ</h3><p>Project å¯¹è±¡æä¾›äº† exec æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ‰§è¡Œå¤–éƒ¨çš„å‘½ä»¤</p><p>æˆ‘ä»¬å¯ä»¥åœ¨ linux ä¸‹é€šè¿‡å¦‚ä¸‹å‘½ä»¤å»ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">mv -f æºæ–‡ä»¶è·¯å¾„ ç›®æ ‡æ–‡ä»¶è·¯å¾„<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬åœ¨ Gradle ä¸‹å»è¿›è¡Œè¿™ä¸€æ“ä½œ</p><p>ä¾‹å¦‚æˆ‘ä»¬å®ç°ï¼š<strong>ä½¿ç”¨å¤–éƒ¨å‘½ä»¤ï¼Œå°†æˆ‘ä»¬å­˜æ”¾çš„ apk ç›®å½•ç§»åŠ¨åˆ°é¡¹ç›®çš„æ ¹ç›®å½•</strong> ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task taskMove() &#123;<br>    doLast &#123;<br>        <span class="hljs-comment">// åœ¨ gradle çš„æ‰§è¡Œé˜¶æ®µå»æ‰§è¡Œ</span><br>        <span class="hljs-keyword">def</span> sourcePath = buildDir.path + <span class="hljs-string">&quot;/outputs/apk&quot;</span><br>        <span class="hljs-keyword">def</span> destinationPath = getRootDir().path<br>        <span class="hljs-keyword">def</span> command = <span class="hljs-string">&quot;mv -f $sourcePath $destinationPath&quot;</span><br>        exec &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                executable <span class="hljs-string">&quot;bash&quot;</span><br>                args <span class="hljs-string">&quot;-c&quot;</span>, command<br>                println <span class="hljs-string">&quot;The command execute is success&quot;</span><br>            &#125; <span class="hljs-keyword">catch</span> (GradleException e) &#123;<br>                e.printStackTrace()<br>                println <span class="hljs-string">&quot;The command execute is failed&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€Task-ä»‹ç»"><a href="#ä¸‰ã€Task-ä»‹ç»" class="headerlink" title="ä¸‰ã€Task ä»‹ç»"></a>ä¸‰ã€Task ä»‹ç»</h2><p>Task ä¸­æ–‡ç¿»è¯‘å³ä»»åŠ¡ï¼Œå®ƒæ˜¯ Gradle ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œä»£è¡¨äº†è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¸åŒçš„æ’ä»¶å¯ä»¥æ·»åŠ ä¸åŒçš„ Taskï¼Œæ¯ä¸€ä¸ª Task éƒ½è¦å’Œ Projectå…³è”ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œçº¿ç¨‹æ˜¯ cpu æ‰§è¡Œçš„æœ€å°å•å…ƒã€‚åŒç†ï¼ŒTask æ˜¯ Gradle æ‰§è¡Œçš„æœ€å°å•å…ƒï¼ŒGradle å°†ä¸€ä¸ªä¸ª Task ä¸²è”èµ·æ¥ï¼Œå®Œæˆä¸€ä¸ªå…·ä½“çš„æ„å»ºä»»åŠ¡</p><h3 id="1ï¼‰ã€doFirstã€doLast-ä»‹ç»"><a href="#1ï¼‰ã€doFirstã€doLast-ä»‹ç»" class="headerlink" title="1ï¼‰ã€doFirstã€doLast ä»‹ç»"></a>1ï¼‰ã€doFirstã€doLast ä»‹ç»</h3><p>é¦–å…ˆæˆ‘ä»¬è¦ææ‡‚ Action è¿™ä¸ªæ¦‚å¿µï¼ŒAction æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ‰§è¡ŒåŠ¨ä½œï¼Œå®ƒåªæœ‰åœ¨æˆ‘ä»¬æ‰§è¡Œå½“å‰ Task æ—¶æ‰ä¼šè¢«æ‰§è¡Œï¼ŒGradle æ‰§è¡Œé˜¶æ®µæœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ‰§è¡Œæ¯ä¸ª Task ä¸­çš„ä¸€ç³»åˆ— Action</p><p>doFirstï¼ŒdoLast æ˜¯ Task ç»™æˆ‘ä»¬æä¾›çš„ä¸¤ä¸ª Action</p><p><strong>doFirst</strong> è¡¨ç¤ºï¼šTask æ‰§è¡Œæœ€å¼€å§‹æ—¶è¢«è°ƒç”¨çš„ Action</p><p><strong>doLast</strong> è¡¨ç¤ºï¼š task æ‰§è¡Œå®Œæ—¶è¢«è°ƒç”¨çš„ Action</p><p>å€¼çš„æ³¨æ„çš„æ˜¯ï¼š<strong>doFirst å’Œ doLast å¯è¢«å¤šæ¬¡æ·»åŠ æ‰§è¡Œ</strong> ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task erdai&#123;<br>    println <span class="hljs-string">&#x27;task start...&#x27;</span><br><br>    doFirst &#123;<br>        println <span class="hljs-string">&#x27;doFirst1&#x27;</span><br>    &#125;<br><br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;doLast1&#x27;</span><br>    &#125;<br><br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;doLast2&#x27;</span><br>    &#125;<br><br>    println <span class="hljs-string">&#x27;task end...&#x27;</span><br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œå½“å‰ task</span><br>./gradlew erdai<br><br><span class="hljs-comment">//æ‰“å°ç»“æœå¦‚ä¸‹</span><br>&gt; Configure <span class="hljs-attr">project :</span>app<br>task start...<br>task end...<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>erdai<br>doFirst1<br>doLast1<br>doLast2<br></code></pre></td></tr></table></figure><p>ä»ä¸Šè¿°æ‰“å°ç»“æœæˆ‘ä»¬å¯ä»¥å‘ç°</p><p>1ã€<code>println &#39;task start...&#39;</code>ï¼Œ<code> println &#39;task end...&#39;</code>è¿™ä¸¤å¥çš„ä»£ç åœ¨ Gradle é…ç½®é˜¶æ®µå°±è¢«æ‰§è¡Œäº†</p><p>2ã€doFirstï¼ŒdoLast ä¸­çš„ä»£ç æ˜¯åœ¨ Gradle æ‰§è¡Œé˜¶æ®µï¼Œæ‰§è¡Œ erdai è¿™ä¸ª task æ—¶è¢«æ‰§è¡Œçš„</p><p>å› æ­¤ä¹ŸéªŒè¯äº†ä¸€å¼€å§‹æˆ‘è¯´çš„é‚£ä¸ªç»“è®ºï¼š <strong>Gradle é…ç½®é˜¶æ®µï¼Œé™¤ Task çš„ Action ä¸­ç¼–å†™çš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ</strong></p><h3 id="2ï¼‰ã€Task-å±æ€§ä»‹ç»"><a href="#2ï¼‰ã€Task-å±æ€§ä»‹ç»" class="headerlink" title="2ï¼‰ã€Task å±æ€§ä»‹ç»"></a>2ï¼‰ã€Task å±æ€§ä»‹ç»</h3><table><thead><tr><th>å±æ€§</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>name</td><td>task åå­—</td><td>æ— ï¼Œå¿…é¡»æŒ‡å®š</td></tr><tr><td>type</td><td>Task çš„çˆ¶ç±»</td><td>DefaultTask</td></tr><tr><td>action</td><td>å½“ Task æ‰§è¡Œçš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œçš„é—­åŒ…æˆ– Action</td><td>null</td></tr><tr><td>overwrite</td><td>æ›¿æ¢ä¸€ä¸ªå·²å­˜åœ¨çš„ Task</td><td>false</td></tr><tr><td>dependsOn</td><td>è¯¥ Task æ‰€ä¾èµ–çš„ Task é›†åˆ</td><td>[]</td></tr><tr><td>group</td><td>è¯¥ task æ‰€å±åˆ†ç»„</td><td>null</td></tr><tr><td>description</td><td>è¯¥ Task çš„æè¿°ä¿¡æ¯</td><td>null</td></tr><tr><td>constructorArgs</td><td>ä¼ é€’åˆ° Task Class æ„é€ å™¨ä¸­çš„å‚æ•°</td><td>null</td></tr></tbody></table><h3 id="3ï¼‰ã€Task-ç±»å‹ä»‹ç»"><a href="#3ï¼‰ã€Task-ç±»å‹ä»‹ç»" class="headerlink" title="3ï¼‰ã€Task ç±»å‹ä»‹ç»"></a>3ï¼‰ã€Task ç±»å‹ä»‹ç»</h3><p>ä¸€èˆ¬æˆ‘ä»¬åˆ›å»ºçš„ Task é»˜è®¤æ˜¯ç»§æ‰¿ DefaultTaskï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ type å±æ€§è®©ä»–ç»§æ‰¿å…¶ä»–çš„ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ extends å…³é”®å­—ç›´æ¥æŒ‡å®šï¼ŒGradle è‡ªå¸¦çš„æœ‰  Copyã€Delete ç­‰ç­‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">// 1ã€ç»§æ‰¿ Delete è¿™ä¸ªç±»ï¼Œåˆ é™¤æ ¹ç›®å½•ä¸‹çš„ build æ–‡ä»¶</span><br>task deleteTask(<span class="hljs-attr">type:</span> Delete) &#123;<br>    delete rootProject.buildDir<br>&#125;<br><br><span class="hljs-comment">//é€šè¿‡ extends å…³é”®å­—æŒ‡å®š</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DeleteTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Delete</span>&#123;<br><br>&#125;<br>DeleteTask deleteTask = tasks.create(<span class="hljs-string">&quot;deleteTask&quot;</span>,DeleteTask)<br>deleteTask.delete(rootProject.buildDir)<br><br><br><span class="hljs-comment">// 2ã€ç»§æ‰¿ Copy è¿™ä¸ªç±»</span><br>task copyTask(<span class="hljs-attr">type:</span> Copy) &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">//é€šè¿‡ extends å…³é”®å­—æŒ‡å®š</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CopyTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Copy</span>&#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ï¼‰ã€TaskContainer-ä»‹ç»"><a href="#4ï¼‰ã€TaskContainer-ä»‹ç»" class="headerlink" title="4ï¼‰ã€TaskContainer ä»‹ç»"></a>4ï¼‰ã€TaskContainer ä»‹ç»</h3><p>TaskContainer ä½ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª Task å®¹å™¨ï¼ŒProject å¯¹è±¡å°±æ˜¯é€šè¿‡ TaskContainer æ¥ç®¡ç† Taskï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ TaskContainerï¼Œå¯¹ Task è¿›è¡Œç›¸å…³çš„æ“ä½œï¼Œä¸€äº›å¸¸ç”¨çš„ API å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æŸ¥æ‰¾task</span><br>findByPath(<span class="hljs-attr">path:</span> String): Task <br>getByPath(<span class="hljs-attr">path:</span> String): Task<br>getByName(<span class="hljs-attr">name:</span> String): Task<br><br><span class="hljs-comment">//åˆ›å»ºtask</span><br>create(<span class="hljs-attr">name:</span> String): Task<br>create(<span class="hljs-attr">name:</span> String, <span class="hljs-attr">configure:</span> Closure): Task <br>create(<span class="hljs-attr">name:</span> String, <span class="hljs-attr">type:</span> Class): Task<br>create(<span class="hljs-attr">options:</span> Map&lt;String, ?&gt;): Task<br>create(<span class="hljs-attr">options:</span> Map&lt;String, ?&gt;, configure: Closure): Task<br><br><span class="hljs-comment">//å½“ task è¢«åŠ å…¥åˆ° TaskContainer æ—¶çš„ç›‘å¬</span><br>whenTaskAdded(<span class="hljs-attr">action:</span> Closure)<br></code></pre></td></tr></table></figure><h3 id="5ï¼‰ã€Task-å®šä¹‰åŠé…ç½®"><a href="#5ï¼‰ã€Task-å®šä¹‰åŠé…ç½®" class="headerlink" title="5ï¼‰ã€Task å®šä¹‰åŠé…ç½®"></a>5ï¼‰ã€Task å®šä¹‰åŠé…ç½®</h3><p>å› ä¸º Task å’Œ Project æ˜¯ç›¸äº’å…³è”çš„ï¼ŒProject ä¸­æä¾›äº†ä¸€ç³»åˆ—åˆ›å»º Task çš„æ–¹æ³•ï¼Œä¸‹é¢ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªåä¸º task1 çš„ Task</span><br>task task1<br><br><span class="hljs-comment">//2ã€åˆ›å»ºä¸€ä¸ªåä¸º task2 çš„ Taskï¼Œå¹¶é€šè¿‡é—­åŒ…è¿›è¡Œç›¸åº”çš„é…ç½®</span><br>task task2&#123;<br>    <span class="hljs-comment">//æŒ‡å®š task çš„åˆ†ç»„</span><br>    group <span class="hljs-string">&#x27;erdai666&#x27;</span><br>  <br>    doFirst&#123;<br>    <br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€åˆ›å»ºä¸€ä¸ªåä¸º task3 çš„ Taskï¼Œè¯¥ Task ç»§æ‰¿è‡ª Copy è¿™ä¸ª Taskï¼Œä¾èµ– task2</span><br>task task3(<span class="hljs-attr">type:</span> Copy)&#123;<br>    dependsOn <span class="hljs-string">&quot;task2&quot;</span><br>    doLast&#123;<br>    <br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//4ã€åˆ›å»ºä¸€ä¸ªåä¸º task4 çš„ Task å¹¶æŒ‡å®šäº†åˆ†ç»„å’Œæè¿°</span><br>task task4(<span class="hljs-attr">group:</span> <span class="hljs-string">&quot;erdai666&quot;</span>, <span class="hljs-attr">description:</span> <span class="hljs-string">&quot;task4&quot;</span>) &#123;<br>    doFirst &#123;<br>        <br>    &#125;<br>    <br>    doLast &#123;<br>        <br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//5ã€é€šè¿‡ Project å¯¹è±¡çš„ TaskContainer åˆ›å»ºåä¸º task5 çš„ Task</span><br>tasks.create(<span class="hljs-string">&quot;task5&quot;</span>)&#123;<br><br>&#125;<br><br><span class="hljs-comment">//6ã€é€šè¿‡ Project å¯¹è±¡çš„ TaskContainer åˆ›å»ºåä¸º task6 çš„ Task</span><br><span class="hljs-comment">//ç›¸å¯¹äº 5 ï¼Œåªæ˜¯è°ƒç”¨äº†ä¸åŒçš„é‡è½½æ–¹æ³•è€Œå·²</span><br>tasks.create(<span class="hljs-attr">name:</span> <span class="hljs-string">&quot;task6&quot;</span>)&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ï¼‰ã€Task-æ‰§è¡Œå®æˆ˜"><a href="#6ï¼‰ã€Task-æ‰§è¡Œå®æˆ˜" class="headerlink" title="6ï¼‰ã€Task æ‰§è¡Œå®æˆ˜"></a>6ï¼‰ã€Task æ‰§è¡Œå®æˆ˜</h3><p>é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ doFirst ä¸ doLast åœ¨ Task æ‰§è¡ŒæœŸé—´è¿›è¡Œç›¸å…³æ“ä½œï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å®ç° <strong>build ä»»åŠ¡æ‰§è¡ŒæœŸé—´è€—æ—¶</strong>ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">// Task æ‰§è¡Œå®æˆ˜ï¼šè®¡ç®— build æ‰§è¡ŒæœŸé—´çš„è€—æ—¶</span><br><span class="hljs-keyword">def</span> startBuildTime, endBuildTime<br><span class="hljs-comment">// 1ã€åœ¨ Gradle é…ç½®é˜¶æ®µå®Œæˆä¹‹åè¿›è¡Œæ“ä½œï¼Œ</span><br><span class="hljs-comment">// ä»¥æ­¤ä¿è¯è¦æ‰§è¡Œçš„ task é…ç½®å®Œæ¯•</span><br><span class="hljs-variable language_">this</span>.afterEvaluate &#123; Project project -&gt;<br>    <span class="hljs-comment">// 2ã€æ‰¾åˆ°å½“å‰ project ä¸‹ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„ taskï¼Œå³ preBuild task</span><br>    <span class="hljs-keyword">def</span> preBuildTask = project.tasks.getByName(<span class="hljs-string">&quot;preBuild&quot;</span>)<br>    preBuildTask.doFirst &#123;<br>        <span class="hljs-comment">// 3ã€è·å–ç¬¬ä¸€ä¸ª task å¼€å§‹æ‰§è¡Œæ—¶åˆ»çš„æ—¶é—´æˆ³</span><br>        startBuildTime = System.currentTimeMillis()<br>    &#125;<br>    <span class="hljs-comment">// 4ã€æ‰¾åˆ°å½“å‰ project ä¸‹æœ€åä¸€ä¸ªæ‰§è¡Œçš„ taskï¼Œå³ build task</span><br>    <span class="hljs-keyword">def</span> buildTask = project.tasks.getByName(<span class="hljs-string">&quot;build&quot;</span>)<br>    buildTask.doLast &#123;<br>        <span class="hljs-comment">// 5ã€è·å–æœ€åä¸€ä¸ª task æ‰§è¡Œå®Œæˆå‰ä¸€ç¬é—´çš„æ—¶é—´æˆ³</span><br>        endBuildTime = System.currentTimeMillis()<br>        <span class="hljs-comment">// 6ã€è¾“å‡º build æ‰§è¡ŒæœŸé—´çš„è€—æ—¶</span><br>        println <span class="hljs-string">&quot;Current project execute time is $&#123;endBuildTime - startBuildTime&#125;&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ build ä»»åŠ¡</span><br>./gradlew build<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Current project execute time is <span class="hljs-number">21052</span><br></code></pre></td></tr></table></figure><h3 id="7ï¼‰ã€æŒ‡å®š-Task-æ‰§è¡Œé¡ºåº"><a href="#7ï¼‰ã€æŒ‡å®š-Task-æ‰§è¡Œé¡ºåº" class="headerlink" title="7ï¼‰ã€æŒ‡å®š Task æ‰§è¡Œé¡ºåº"></a>7ï¼‰ã€æŒ‡å®š Task æ‰§è¡Œé¡ºåº</h3><p>åœ¨ Gradle ä¸­ï¼Œæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥æŒ‡å®š Task æ‰§è¡Œé¡ºåºï¼š</p><p>1ã€dependsOn å¼ºä¾èµ–æ–¹å¼</p><p>2ã€é€šè¿‡ Task è¾“å…¥è¾“å‡º</p><p>3ã€é€šè¿‡ API æŒ‡å®šæ‰§è¡Œé¡ºåº</p><h4 id="1ã€dependsOn-å¼ºä¾èµ–æ–¹å¼"><a href="#1ã€dependsOn-å¼ºä¾èµ–æ–¹å¼" class="headerlink" title="1ã€dependsOn å¼ºä¾èµ–æ–¹å¼"></a>1ã€dependsOn å¼ºä¾èµ–æ–¹å¼</h4><p>dependsOn å¼ºä¾èµ–æ–¹å¼å¯ç»†åˆ†ä¸º<strong>é™æ€ä¾èµ–</strong>å’Œ<strong>åŠ¨æ€ä¾èµ–</strong></p><ul><li>é™æ€ä¾èµ–ï¼šåœ¨åˆ›å»º Task çš„æ—¶å€™ï¼Œç›´æ¥é€šè¿‡ dependsOn æŒ‡å®šéœ€è¦ä¾èµ–çš„ Task</li><li>åŠ¨æ€ä¾èµ–ï¼šåœ¨åˆ›å»º Task çš„æ—¶å€™ï¼Œä¸çŸ¥é“éœ€è¦ä¾èµ–å“ªäº› Taskï¼Œéœ€é€šè¿‡ dependsOn åŠ¨æ€ä¾èµ–ç¬¦åˆæ¡ä»¶çš„ Task</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//=================================é™æ€ä¾èµ–=============================</span><br>task taskA&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskA&#x27;</span><br>    &#125;<br>&#125;<br><br>task taskB&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskB&#x27;</span><br>    &#125;<br>&#125;<br><br>task taskC(<span class="hljs-attr">dependsOn:</span> taskA)&#123;<span class="hljs-comment">//å¤šä¾èµ–æ–¹å¼ dependsOn:[taskA,taskB]</span><br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskC&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ taskC</span><br>./gradlew taskC<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskA<br>taskA<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskC<br>taskC<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ taskC çš„æ—¶å€™ï¼Œå› ä¸ºä¾èµ–äº† taskAï¼Œå› æ­¤ taskA ä¼šå…ˆæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œ taskC</p><p><strong>æ³¨æ„</strong>ï¼šå½“ä¸€ä¸ª Task ä¾èµ–å¤šä¸ª Task çš„æ—¶å€™ï¼Œè¢«ä¾èµ–çš„ Task ä¹‹é—´å¦‚æœæ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯éšæœºçš„ï¼Œå¹¶æ— å½±å“ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task taskC(<span class="hljs-attr">dependsOn:</span>[taskA,taskB])&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskC&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>taskA å’Œ taskB çš„æ‰§è¡Œé¡ºåºæ˜¯éšæœºçš„</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//=================================åŠ¨æ€ä¾èµ–=============================</span><br><span class="hljs-comment">// Task åŠ¨æ€ä¾èµ–æ–¹å¼</span><br>task lib1 &#123;<br>    doLast&#123;<br>        println <span class="hljs-string">&#x27;lib1&#x27;</span><br>    &#125;<br>&#125;<br>task lib2 &#123;<br>    doLast&#123;<br>        println <span class="hljs-string">&#x27;lib2&#x27;</span><br>    &#125;<br>&#125;<br>task lib3 &#123;<br>    doLast&#123;<br>        println <span class="hljs-string">&#x27;lib3&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åŠ¨æ€æŒ‡å®štaskXä¾èµ–æ‰€æœ‰ä»¥libå¼€å¤´çš„task</span><br>task taskDynamic&#123;<br>    <span class="hljs-comment">// åŠ¨æ€æŒ‡å®šä¾èµ–</span><br>    dependsOn tasks.findAll&#123; Task task -&gt;<br>        <span class="hljs-keyword">return</span> task.name.startsWith(<span class="hljs-string">&#x27;lib&#x27;</span>)<br>    &#125;<br><br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskDynamic&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ taskDynamic</span><br>./gradlew taskDynamic<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>lib1<br>lib1<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>lib2<br>lib2<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>lib3<br>lib3<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskDynamic<br>taskDynamic<br></code></pre></td></tr></table></figure><h4 id="2ã€é€šè¿‡-Task-è¾“å…¥è¾“å‡ºæŒ‡å®šæ‰§è¡Œé¡ºåº"><a href="#2ã€é€šè¿‡-Task-è¾“å…¥è¾“å‡ºæŒ‡å®šæ‰§è¡Œé¡ºåº" class="headerlink" title="2ã€é€šè¿‡ Task è¾“å…¥è¾“å‡ºæŒ‡å®šæ‰§è¡Œé¡ºåº"></a>2ã€é€šè¿‡ Task è¾“å…¥è¾“å‡ºæŒ‡å®šæ‰§è¡Œé¡ºåº</h4><p>å½“ä¸€ä¸ªå‚æ•°ï¼Œä½œä¸º TaskA çš„è¾“å…¥å‚æ•°ï¼ŒåŒæ—¶åˆä½œä¸º TaskB çš„è¾“å‡ºå‚æ•°ï¼Œé‚£ä¹ˆ TaskA æ‰§è¡Œçš„æ—¶å€™å…ˆè¦æ‰§è¡Œ TaskBã€‚å³è¾“å‡ºçš„ Task å…ˆäºè¾“å…¥çš„ Task æ‰§è¡Œ</p><p>ä½†æ˜¯æˆ‘åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ï¼š<strong>è¾“å…¥çš„ Task ä¼šå…ˆæ‰§è¡Œï¼Œç„¶ååœ¨æ‰§è¡Œè¾“å‡ºçš„ Task</strong>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ext &#123;<br>    testFile = file(<span class="hljs-string">&quot;$&#123;projectDir.path&#125;/test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span>(testFile != <span class="hljs-literal">null</span> || !testFile.exists())&#123;<br>        testFile.createNewFile()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¾“å‡º Task</span><br>task outputTask &#123;<br>    outputs.file testFile<br>    doLast &#123;<br>        outputs.getFiles().singleFile.withWriter &#123; writer -&gt;<br>            writer.append(<span class="hljs-string">&quot;erdai666&quot;</span>)<br>        &#125;<br>        println <span class="hljs-string">&quot;outputTask æ‰§è¡Œç»“æŸ&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è¾“å…¥ Task</span><br>task inputTask &#123;<br>    inputs.file testFile<br>    doLast &#123;<br>        println <span class="hljs-string">&quot;è¯»å–æ–‡ä»¶å†…å®¹ï¼š$&#123;inputs.files.singleFile.text&#125;&quot;</span><br>        println <span class="hljs-string">&quot;inputTask æ‰§è¡Œç»“æŸ&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯• Task</span><br>task testTask(<span class="hljs-attr">dependsOn:</span> [outputTask, inputTask]) &#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&quot;testTask1 æ‰§è¡Œç»“æŸ&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ testTask</span><br>./gradlew testTask<br><br><span class="hljs-comment">//ç†è®ºä¸Šä¼šå…ˆæ‰§è¡Œ outputTaskï¼Œåœ¨æ‰§è¡Œ inputTaskï¼Œæœ€åæ‰§è¡Œ testTask</span><br><span class="hljs-comment">//ä½†å®é™…æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>inputTask<br>è¯»å–æ–‡ä»¶å†…å®¹ï¼š<br>inputTask æ‰§è¡Œç»“æŸ<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>outputTask<br>outputTask æ‰§è¡Œç»“æŸ<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>testTask<br>testTask1 æ‰§è¡Œç»“æŸ<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæˆ‘å¯¹ inputTask æŒ‡å®šäº†å…·ä½“ä¾èµ–æ‰è¾¾åˆ°äº†é¢„æœŸæ•ˆæœï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task inputTask(<span class="hljs-attr">dependsOn:</span> outputTask) &#123;<br>    inputs.file testFile<br>    doLast &#123;<br>        println <span class="hljs-string">&quot;è¯»å–æ–‡ä»¶å†…å®¹ï¼š$&#123;inputs.files.singleFile.text&#125;&quot;</span><br>        println <span class="hljs-string">&quot;inputTask æ‰§è¡Œç»“æŸ&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¿®æ”¹ä¹‹åçš„æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>outputTask<br>outputTask æ‰§è¡Œç»“æŸ<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>inputTask<br>è¯»å–æ–‡ä»¶å†…å®¹ï¼šerdai666<br>inputTask æ‰§è¡Œç»“æŸ<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>testTask<br>testTask1 æ‰§è¡Œç»“æŸ<br></code></pre></td></tr></table></figure><h4 id="3ã€é€šè¿‡-API-æŒ‡å®šæ‰§è¡Œé¡ºåº"><a href="#3ã€é€šè¿‡-API-æŒ‡å®šæ‰§è¡Œé¡ºåº" class="headerlink" title="3ã€é€šè¿‡ API æŒ‡å®šæ‰§è¡Œé¡ºåº"></a>3ã€é€šè¿‡ API æŒ‡å®šæ‰§è¡Œé¡ºåº</h4><p>å¯ä»¥æŒ‡å®š Task æ‰§è¡Œé¡ºåºçš„ API æœ‰ï¼š</p><p><strong>mustRunAfter</strong>ï¼šæŒ‡å®šå¿…é¡»åœ¨å“ªä¸ª Task æ‰§è¡Œå®Œæˆä¹‹åæ‰§è¡Œ</p><p><strong>shouldRunAfter</strong>ï¼šè·Ÿ mustRunAfter ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºä¸å¼ºåˆ¶ï¼Œä¸å¸¸ç”¨</p><p><strong>finalizeBy</strong>ï¼šåœ¨å½“å‰ Task æ‰§è¡Œå®Œæˆä¹‹åï¼ŒæŒ‡å®šæ‰§è¡Œçš„ Task</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç æ¥æ¼”ç¤ºä¸€ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//======================================= mustRunAfter ===========================</span><br>task taskX&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskX&#x27;</span><br>    &#125;<br>&#125;<br><br>task taskY&#123;<br>    mustRunAfter taskX<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskY&#x27;</span><br>    &#125;<br>&#125;<br><br>task taskXY(<span class="hljs-attr">dependsOn:</span> [taskX,taskY])&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskXY&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ taskXY</span><br>./gradlew taskXY<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskX<br>taskX<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskY<br>taskY<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskXY<br>taskXY<br><br><span class="hljs-comment">//======================================= finalizeBy ===========================</span><br>task taskI&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskI&#x27;</span><br>    &#125;<br>&#125;<br><br>task taskJ&#123;<br>    finalizedBy taskI<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskJ&#x27;</span><br>    &#125;<br>&#125;<br><br><br>task taskIJ(<span class="hljs-attr">dependsOn:</span> [taskI,taskJ])&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;taskIJ&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰§è¡Œ taskIJ</span><br>./gradlew taskIJ<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskJ<br>taskJ<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskI<br>taskI<br><br>&gt; <span class="hljs-attr">Task :</span><span class="hljs-attr">app:</span>taskIJ<br>taskIJ<br></code></pre></td></tr></table></figure><h2 id="å››ã€è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-Android-åº”ç”¨æ„å»ºæµç¨‹"><a href="#å››ã€è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-Android-åº”ç”¨æ„å»ºæµç¨‹" class="headerlink" title="å››ã€è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ° Android åº”ç”¨æ„å»ºæµç¨‹"></a>å››ã€è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ° Android åº”ç”¨æ„å»ºæµç¨‹</h2><h3 id="1ï¼‰ã€Task-ä¾èµ–å…³ç³»æ’ä»¶ä»‹ç»"><a href="#1ï¼‰ã€Task-ä¾èµ–å…³ç³»æ’ä»¶ä»‹ç»" class="headerlink" title="1ï¼‰ã€Task ä¾èµ–å…³ç³»æ’ä»¶ä»‹ç»"></a>1ï¼‰ã€Task ä¾èµ–å…³ç³»æ’ä»¶ä»‹ç»</h3><p>æˆ‘ä»¬å¯ä»¥å¼•å…¥å¦‚ä¸‹æ’ä»¶æ¥æŸ¥çœ‹ Task çš„ä¸€ä¸ªä¾èµ–å…³ç³»ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1ã€åœ¨æ ¹ build.gradle æ·»åŠ å¦‚ä¸‹ä»£ç </span><br>buildscript &#123;<br>    repositories &#123;<br>      <span class="hljs-comment">//...</span><br>        maven&#123;<br>           url <span class="hljs-string">&quot;https://plugins.gradle.org/m2/&quot;</span><br>        &#125;<br>    &#125;<br>    dependencies &#123;<br>      <span class="hljs-comment">//..</span><br>        classpath <span class="hljs-string">&quot;gradle.plugin.com.dorongold.plugins:task-tree:1.5&quot;</span><br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">// 2ã€åœ¨ app çš„ build.gradle ä¸­åº”ç”¨æ’ä»¶</span><br>apply <span class="hljs-attr">plugin:</span> com.dorongold.gradle.tasktree.TaskTreePlugin<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 3ã€åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š./gradlew &lt;ä»»åŠ¡å&gt; taskTree --no-repeat å‘½ä»¤å³å¯æŸ¥çœ‹</span><br><span class="hljs-comment"> * è¿™é‡Œä»¥æ‰§è¡Œ build è¿™ä¸ª task ä¸ºä¾‹</span><br><span class="hljs-comment"> */</span><br>./gradlew build taskTree --no-repeat<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢ 3 æ­¥ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¾èµ–å…³ç³»å›¾ï¼Œä»…æˆªå–éƒ¨åˆ†ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86c516a5a77b459da8395072715338d8~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210718114010544" style="zoom:50%;" /><h3 id="2ï¼‰ã€è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-Android-æ„å»ºæµç¨‹"><a href="#2ï¼‰ã€è‡ªå®šä¹‰-Task-æŒ‚æ¥åˆ°-Android-æ„å»ºæµç¨‹" class="headerlink" title="2ï¼‰ã€è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ° Android æ„å»ºæµç¨‹"></a>2ï¼‰ã€è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ° Android æ„å»ºæµç¨‹</h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒGradle åœ¨æ‰§è¡Œé˜¶æ®µå°±æ˜¯æ‰§è¡Œ Task åŠå…¶ä¾èµ–çš„ Taskï¼Œå°±æ¯”å¦‚ä¸Šé¢æˆªå›¾çš„ build Task çš„å…³ç³»ä¾èµ–å›¾ï¼Œå®ƒä¼šæŒ‰ç…§è¿™ä¸ªä¾èµ–å›¾æœ‰æ¡ä¸ç´Šçš„å»æ‰§è¡Œã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘æƒ³æŠŠè‡ªå·±è‡ªå®šä¹‰çš„ Task æŒ‚æ¥åˆ°è¿™ä¸ªæ„å»ºæµç¨‹ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h5 id="1ã€é€šè¿‡-dependsOn-æŒ‡å®š"><a href="#1ã€é€šè¿‡-dependsOn-æŒ‡å®š" class="headerlink" title="1ã€é€šè¿‡ dependsOn æŒ‡å®š"></a>1ã€é€šè¿‡ dependsOn æŒ‡å®š</h5><p><strong>æ³¨æ„ï¼š</strong> å•ç‹¬ä½¿ç”¨ dependsOn ï¼Œå¿…é¡»è®©æ„å»ºæµç¨‹ä¸­çš„ Task ä¾èµ–æˆ‘ä»¬è‡ªå®šä¹‰çš„ Taskï¼Œå¦åˆ™æˆ‘ä»¬çš„ Task ä¸ä¼šç”Ÿæ•ˆ</p><p>å¦‚ä¸‹ä»£ç æ¼”ç¤ºä¸€ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task myCustomTask&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;This is myCustomTask&#x27;</span><br>    &#125;<br>&#125;<br><br>afterEvaluate &#123;<br>    <span class="hljs-comment">//1ã€æ‰¾åˆ°éœ€è¦çš„æ„å»ºæµç¨‹ Task</span><br>    <span class="hljs-keyword">def</span> mergeDebugResources = tasks.findByName(<span class="hljs-string">&quot;mergeDebugResources&quot;</span>)<br>    <span class="hljs-comment">//2ã€é€šè¿‡ dependsOn æŒ‡å®š</span><br>    mergeDebugResources.dependsOn(myCustomTask)<br>  <br>    <span class="hljs-comment">//å¦‚æœæ¢æˆä¸‹é¢è¿™ç§å†™æ³•åˆ™è‡ªå®šä¹‰ Task ä¸ä¼šç”Ÿæ•ˆ</span><br>    <span class="hljs-comment">//myCustomTask.dependsOn(mergeDebugResources)</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬éªŒè¯ä¸€ä¸‹</p><p>é¦–å…ˆçœ‹ä¸€çœ¼ Task ä¾èµ–å…³ç³»å›¾ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abf5fd86aaed4ecd818e9df7b0aa8ba1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210718130023237" style="zoom:50%;" /><p>æˆ‘ä»¬è‡ªå®šä¹‰çš„ Task æŒ‚æ¥åˆ°äº† mergeDebugResources ä¸Š</p><p>æ‰§è¡Œä¸‹ build è¿™ä¸ª Taskï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬çš„ Task è¢«æ‰§è¡Œäº†ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d4a4b36ece04058ba2430def0685a72~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210718130303391" style="zoom:50%;" /><h5 id="2ã€é€šè¿‡-finalizedBy-æŒ‡å®š"><a href="#2ã€é€šè¿‡-finalizedBy-æŒ‡å®š" class="headerlink" title="2ã€é€šè¿‡ finalizedBy æŒ‡å®š"></a>2ã€é€šè¿‡ finalizedBy æŒ‡å®š</h5><p>åœ¨æŸä¸ª Task æ‰§è¡Œå®Œæˆåï¼ŒæŒ‡å®šéœ€è¦æ‰§è¡Œçš„ Task</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task myCustomTask&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;This is myCustomTask&#x27;</span><br>    &#125;<br>&#125;<br><br>afterEvaluate &#123;<br>    <span class="hljs-keyword">def</span> mergeDebugResources = tasks.findByName(<span class="hljs-string">&quot;mergeDebugResources&quot;</span>)<br>    <span class="hljs-comment">//å°† myCustomTask æŒ‚æ¥åœ¨ mergeDebugResources åé¢æ‰§è¡Œ</span><br>    mergeDebugResources.finalizedBy(myCustomTask)<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3ã€é€šè¿‡-mustRunAfter-é…åˆ-dependsOn-æŒ‡å®š"><a href="#3ã€é€šè¿‡-mustRunAfter-é…åˆ-dependsOn-æŒ‡å®š" class="headerlink" title="3ã€é€šè¿‡ mustRunAfter é…åˆ dependsOn æŒ‡å®š"></a>3ã€é€šè¿‡ mustRunAfter é…åˆ dependsOn æŒ‡å®š</h5><p>åœ¨ä¸¤ä¸ª Task ä¹‹é—´ï¼Œæ’å…¥è‡ªå®šä¹‰çš„ Task </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task myCustomTask&#123;<br>    doLast &#123;<br>        println <span class="hljs-string">&#x27;This is myCustomTask&#x27;</span><br>    &#125;<br>&#125;<br><br>afterEvaluate &#123;<br>    <span class="hljs-comment">//åœ¨ mergeDebugResources å’Œ processDebugResources ä¹‹é—´æ’å…¥ myCustomTask</span><br>    <span class="hljs-keyword">def</span> processDebugResources = tasks.findByName(<span class="hljs-string">&quot;processDebugResources&quot;</span>)<br>    <span class="hljs-keyword">def</span> mergeDebugResources = tasks.findByName(<span class="hljs-string">&quot;mergeDebugResources&quot;</span>)<br>    myCustomTask.mustRunAfter(mergeDebugResources)<br>    processDebugResources.dependsOn(myCustomTask)<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿° Task ä¾èµ–å˜åŒ–è¿‡ç¨‹ï¼š</p><p>processDebugResources -&gt; mergeDebugResources &#x3D;&#x3D;&#x3D;&gt; processDebugResources -&gt; myCustomTask -&gt; mergeDebugResources</p><h2 id="äº”ã€Gradle-ç›¸å…³å‘½ä»¤ä»‹ç»"><a href="#äº”ã€Gradle-ç›¸å…³å‘½ä»¤ä»‹ç»" class="headerlink" title="äº”ã€Gradle ç›¸å…³å‘½ä»¤ä»‹ç»"></a>äº”ã€Gradle ç›¸å…³å‘½ä»¤ä»‹ç»</h2><h3 id="1ï¼‰ã€æŸ¥çœ‹é¡¹ç›®æ‰€æœ‰çš„-Project-å¯¹è±¡"><a href="#1ï¼‰ã€æŸ¥çœ‹é¡¹ç›®æ‰€æœ‰çš„-Project-å¯¹è±¡" class="headerlink" title="1ï¼‰ã€æŸ¥çœ‹é¡¹ç›®æ‰€æœ‰çš„ Project å¯¹è±¡"></a>1ï¼‰ã€æŸ¥çœ‹é¡¹ç›®æ‰€æœ‰çš„ Project å¯¹è±¡</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">./gradlew project<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€æŸ¥çœ‹-module-ä¸‹æ‰€æœ‰çš„-task"><a href="#2ï¼‰ã€æŸ¥çœ‹-module-ä¸‹æ‰€æœ‰çš„-task" class="headerlink" title="2ï¼‰ã€æŸ¥çœ‹ module ä¸‹æ‰€æœ‰çš„ task"></a>2ï¼‰ã€æŸ¥çœ‹ module ä¸‹æ‰€æœ‰çš„ task</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs groovy">./gradlew <span class="hljs-attr">$moduleName:</span>tasks<br><br><span class="hljs-comment">//æ¼”ç¤º</span><br><span class="hljs-comment">//æŸ¥çœ‹ app ä¸‹çš„æ‰€æœ‰ Task</span><br>./gradlew <span class="hljs-attr">app:</span>tasks<br><br><span class="hljs-comment">//æŸ¥çœ‹æ ¹ Project çš„æ‰€æœ‰ Task</span><br>./gradlew tasks<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€æ‰§è¡Œä¸€ä¸ª-Task"><a href="#3ï¼‰ã€æ‰§è¡Œä¸€ä¸ª-Task" class="headerlink" title="3ï¼‰ã€æ‰§è¡Œä¸€ä¸ª Task"></a>3ï¼‰ã€æ‰§è¡Œä¸€ä¸ª Task</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">./gradlew $taskName<br><br><span class="hljs-comment">//æ‰§è¡Œ build Task</span><br>./gradlew build<br></code></pre></td></tr></table></figure><h3 id="4ï¼‰ã€æŸ¥çœ‹-module-ä¸‹çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–å…³ç³»"><a href="#4ï¼‰ã€æŸ¥çœ‹-module-ä¸‹çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–å…³ç³»" class="headerlink" title="4ï¼‰ã€æŸ¥çœ‹ module ä¸‹çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–å…³ç³»"></a>4ï¼‰ã€æŸ¥çœ‹ module ä¸‹çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–å…³ç³»</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">./gradlew <span class="hljs-attr">$moduleName:</span>dependencies<br><br><span class="hljs-comment">//æŸ¥çœ‹ app ä¸‹çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–å…³ç³»</span><br>./gradlew <span class="hljs-attr">app:</span>dependencies<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€Gradle ä¸‰ä¸ªé˜¶æ®µåŠç”Ÿå‘½å‘¨æœŸ Hook ç‚¹</p><p>2ã€Project å¯¹è±¡å¸¸ç”¨ API ä»‹ç»ï¼Œæ‰©å±•å±æ€§çš„åº”ç”¨ä¸å®æˆ˜</p><p>3ã€Task å¸¸ç”¨é…ç½®ä»‹ç»ï¼Œå…¶ä¸­é€šè¿‡ Task è¾“å…¥è¾“å‡ºæŒ‡å®šæ‰§è¡Œé¡ºåºé‡åˆ°äº†å‘ï¼šä¼šå…ˆæ‰§è¡Œè¾“å…¥çš„ Taskã€‚æœ€ç»ˆè¿˜æ˜¯é€šè¿‡ä½¿ç”¨ dependsOn æŒ‡å®šå…·ä½“ä¾èµ–æ‰è¾¾åˆ°é¢„æœŸæ•ˆæœ</p><p>4ã€è‡ªå®šä¹‰ Task æŒ‚æ¥åˆ° Android åº”ç”¨æ„å»ºæµç¨‹çš„ä¸‰ç§æ–¹å¼ï¼š</p><blockquote><p>1ã€å•ç‹¬ä½¿ç”¨ dependsOn ï¼ˆæ³¨æ„å¿…é¡»ä½¿ç”¨æ„å»ºæµç¨‹ä¸­çš„ Task ä¾èµ–æˆ‘ä»¬è‡ªå®šä¹‰çš„ Taskï¼‰</p><p>2ã€ä½¿ç”¨ finalizedBy</p><p>3ã€mustRunAfter é…åˆ dependsOn</p></blockquote><p>5ã€Gradle ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ä»‹ç»</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²å¦‚ä½•è‡ªå®šä¹‰ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6950643579643494431#heading-14">è¡¥é½AndroidæŠ€èƒ½æ ‘ - ç©è½¬Gradle</a></p><p><a href="https://juejin.cn/post/6937208620337610766/#heading-31">Gradleå­¦ä¹ ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šGradleæ ¸å¿ƒæ¢ç´¢</a></p><p><a href="https://juejin.cn/post/6844904122492125198#heading-26">æ·±åº¦æ¢ç´¢ Gradle è‡ªåŠ¨åŒ–æ„å»ºæŠ€æœ¯ï¼ˆä¸‰ã€Gradle æ ¸å¿ƒè§£å¯†ï¼‰</a></p><p><a href="https://juejin.cn/post/6982379643311489032#heading-15">ä»Gradleç”Ÿå‘½å‘¨æœŸåˆ°è‡ªå®šä¹‰TaskæŒ‚æ¥åˆ°Buildæ„å»ºæµç¨‹å…¨è§£</a></p><p><a href="https://juejin.cn/post/6947675376835362846#heading-1">7ä¸ªä½ åº”è¯¥çŸ¥é“çš„Gradleå®ç”¨æŠ€å·§</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gradle ç³»åˆ— ï¼ˆä¸€ï¼‰ã€Gradleç›¸å…³æ¦‚å¿µç†è§£ï¼ŒGroovyåŸºç¡€</title>
    <link href="/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81Gradle%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E7%90%86%E8%A7%A3%EF%BC%8CGroovy%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/10/11/Gradle%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81Gradle%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E7%90%86%E8%A7%A3%EF%BC%8CGroovy%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f912f1dfdee430ab27ecd69901ee77b~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¼•ç”¨ Gradle å®˜æ–¹ä¸€æ®µå¯¹Gradleçš„ä»‹ç»ï¼šGradle is an open-source build automation tool focused on flexibility and performance. Gradle build scripts are written using a Groovy or Kotlin DSL.ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š<strong>Gradle æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œä¸“æ³¨äºçµæ´»æ€§å’Œæ€§èƒ½ã€‚Gradle æ„å»ºè„šæœ¬æ˜¯ä½¿ç”¨ Groovy æˆ– Kotlin DSL ç¼–å†™çš„ã€‚</strong> ä¹‹å‰å®˜ç½‘çš„ä»‹ç»æ˜¯è¯´ Gradle æ˜¯åŸºäº Groovy çš„ DSLï¼Œä¸ºå•¥ç°åœ¨åˆå¤šäº†ä¸ª Kotlin  å‘¢ï¼Ÿå› ä¸º Gradle ä»5.0å¼€å§‹ï¼Œå¼€å§‹æ”¯æŒäº† Kotlin DSLï¼Œç°åœ¨å·²ç»å‘å±•åˆ°äº†6.8.3ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Groovy æˆ–è€… Kotlin æ¥ç¼–å†™ Gradleè„šæœ¬ã€‚Kotlin ç°ä½œä¸º Android ç¬¬ä¸€å¼€å‘è¯­è¨€ï¼Œé‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œä½œä¸ºä¸€ä¸ª Androidå¼€å‘è€…ï¼ŒKotlin æ˜¯å¿…å­¦çš„ï¼Œåç»­æˆ‘ä¹Ÿä¼šå‡ºä¸ª Kotlin ç³»åˆ—æ–‡ç« ã€‚ä»Šå¤©æˆ‘ä»¬çš„é‡ç‚¹æ˜¯ä»‹ç»ä¸€äº› Gradle çš„ç›¸å…³æ¦‚å¿µï¼Œä»¥åŠå¯¹ Groovy è¯­è¨€çš„å­¦ä¹ </p><h2 id="ä¸€ã€é—®é¢˜"><a href="#ä¸€ã€é—®é¢˜" class="headerlink" title="ä¸€ã€é—®é¢˜"></a>ä¸€ã€é—®é¢˜</h2><p>æˆ‘å­¦ä¹ çŸ¥è¯†å–œæ¬¢ä»¥é—®é¢˜ä¸ºå¯¼å‘ï¼Œè¿™æ ·å¯ä»¥è®©æˆ‘æ˜ç¡®å­¦ä¹ çš„ç›®çš„ï¼Œæé«˜å­¦ä¹ æ•ˆç‡ï¼Œä¸‹é¢ä¹Ÿæ˜¯æˆ‘åœ¨å­¦ä¹  Gradle çš„è¿‡ç¨‹ä¸­ï¼Œç”±æµ…å…¥æ·±æ‰€äº§ç”Ÿçš„ä¸€äº›ç–‘é—®ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒAndroid åº”ç”¨æ˜¯ç”¨ Gradle æ„å»ºçš„ï¼Œåœ¨åˆšå¼€å‘ Android çš„æ—¶å€™æˆ‘ä¼šæƒ³ï¼š</p><p>1ã€ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Ÿ</p><p>2ã€Gradle æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>3ã€ä»€ä¹ˆæ˜¯ DSLï¼Ÿ</p><p>4ã€ä»€ä¹ˆæ˜¯ Groovyï¼Ÿ</p><p>5ã€Gradle å’Œ Groovy æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>6ã€é™æ€ç¼–ç¨‹è¯­è¨€å’ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>å¸¦ç€è¿™äº›ç–‘é—®ï¼Œæˆ‘ä»¬ç»§ç»­å­¦ä¹ </p><h3 id="1ã€è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·"><a href="#1ã€è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·" class="headerlink" title="1ã€è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·"></a>1ã€è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·</h3><p>åœ¨ Android ä¸Šçš„ä½“ç°ï¼Œç®€å•çš„è¯´å°±æ˜¯è‡ªåŠ¨åŒ–çš„ç¼–è¯‘ã€æ‰“åŒ…ç¨‹åº</p><p>åœ¨ä¸Šå¤§å­¦å­¦ä¹  Java é‚£ä¼šï¼Œè€å¸ˆä¸ºäº†è®©æˆ‘ä»¬æ·±åˆ»çš„ä½“éªŒæ’¸ç çš„é­…åŠ›ï¼Œéƒ½æ˜¯é€šè¿‡æ–‡æœ¬ç›´æ¥æ•²ä»£ç çš„ï¼Œæ•²å®Œä¹‹åæŠŠæ‰©å±•åæ”¹æˆ<code>.java</code>åç¼€ï¼Œç„¶åé€šè¿‡<code>javac</code>å‘½ä»¤ç¼–è¯‘ï¼Œç¼–è¯‘é€šè¿‡åï¼Œåœ¨æ‰§è¡Œ<code>java</code>å‘½ä»¤å»è¿è¡Œï¼Œé‚£ä¹ˆè¿™ç§æ–‡ä»¶ä¸€å¤šï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½å¾—æ‰‹åŠ¨å»æ“ä½œï¼Œæ•ˆç‡ä¼šå¤§å¤§çš„é™ä½ï¼Œè¿™ä¸ªæ—¶å€™å°±å‡ºç°äº†è‡ªåŠ¨åŒ–ç¼–è¯‘å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç¼–è¯‘å·¥å…·ä¸­ï¼Œç‚¹å‡»ç¼–è¯‘æŒ‰é’®ï¼Œç¼–è¯‘å®Œæˆåï¼Œæ— éœ€å…¶ä»–æ‰‹åŠ¨æ“ä½œï¼Œç¨‹åºå°±å¯ä»¥ç›´æ¥è¿è¡Œäº†ï¼Œè‡ªåŠ¨åŒ–ç¼–è¯‘å·¥å…·å°±æ˜¯æœ€æ—©çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚é‚£ä¹ˆéšç€ä¸šåŠ¡åŠŸèƒ½çš„ä¸æ–­æ‰©å±•ï¼Œæˆ‘ä»¬çš„äº§å“éœ€è¦åŠ å…¥å¤šåª’ä½“èµ„æºï¼Œéœ€è¦æ‰“ä¸åŒçš„æ¸ é“åŒ…å‘å¸ƒåˆ°ä¸åŒçš„æ¸ é“ï¼Œé‚£å°±å¿…é¡»ä¾é è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œè¦èƒ½æ”¯æŒå¹³å°ã€éœ€æ±‚ç­‰æ–¹é¢çš„å·®å¼‚ã€èƒ½æ·»åŠ è‡ªå®šä¹‰ä»»åŠ¡ã€ä¸“é—¨çš„ç”¨æ¥æ‰“åŒ…ç”Ÿæˆæœ€ç»ˆäº§å“çš„ä¸€ä¸ªç¨‹åºã€å·¥å…·ï¼Œè¿™ä¸ªå°±æ˜¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€æ®µä»£ç ç¨‹åºã€‚è¿™å°±æ˜¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·çš„ä¸€ä¸ªå‘å±•å†ç¨‹ï¼Œè‡ªåŠ¨åŒ–æ„å»ºå·¥å…·åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸æ–­çš„å‘å±•å’Œä¼˜åŒ–</p><h3 id="2ã€Gradle-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2ã€Gradle-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2ã€Gradle æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2ã€Gradle æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ç†è§£äº†è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œé‚£ä¹ˆç†è§£ Gradle å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¿˜æ˜¯å¼•ç”¨å®˜æ–¹çš„é‚£ä¸€æ®µè¯ï¼š</p><p><strong>Gradle æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œä¸“æ³¨äºçµæ´»æ€§å’Œæ€§èƒ½ã€‚Gradle æ„å»ºè„šæœ¬æ˜¯ä½¿ç”¨ Groovy æˆ– Kotlin DSL ç¼–å†™çš„ã€‚</strong></p><p>Gradle æ˜¯ Android çš„é»˜è®¤æ„å»ºå·¥å…·ï¼ŒAndroid é¡¹ç›®è¿™ä¹ˆå¤šä¸œè¥¿ï¼Œæ—¢æœ‰æˆ‘ä»¬è‡ªå·±å†™çš„ javaã€kotlinã€C++ã€Dart ä»£ç ï¼Œä¹Ÿæœ‰ç³»ç»Ÿè‡ªå·±çš„ javaã€Cï¼ŒC++ ä»£ç ï¼Œè¿˜æœ‰å¼•å…¥çš„ç¬¬ä¸‰æ–¹ä»£ç ï¼Œè¿˜æœ‰å¤šåª’ä½“èµ„æºï¼Œè¿™ä¹ˆå¤šä»£ç ã€èµ„æºæ‰“åŒ…æˆ APK æ–‡ä»¶è‚¯å®šè¦æœ‰ä¸€ä¸ªè§„èŒƒï¼Œå¹²è¿™ä¸ªæ´»çš„å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ gradle äº†ï¼Œæ€»è€Œè¨€ä¹‹ï¼ŒGradleå°±æ˜¯ä¸€ä¸ªå¸®æˆ‘ä»¬æ‰“åŒ… APK çš„å·¥å…·</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/249405f870924185987c118985a4cc69~tplv-k3u1fbpfcp-zoom-1.image" alt="gradle"></p><h3 id="3ã€ä»€ä¹ˆæ˜¯DSLï¼Ÿ"><a href="#3ã€ä»€ä¹ˆæ˜¯DSLï¼Ÿ" class="headerlink" title="3ã€ä»€ä¹ˆæ˜¯DSLï¼Ÿ"></a>3ã€ä»€ä¹ˆæ˜¯DSLï¼Ÿ</h3><p>DSLè‹±æ–‡å…¨ç§°ï¼š<strong>domain specific language</strong>ï¼Œä¸­æ–‡ç¿»è¯‘å³é¢†åŸŸç‰¹å®šè¯­è¨€ï¼Œä¾‹å¦‚ï¼šHTMLï¼ŒXMLç­‰ DSL è¯­è¨€</p><p><strong>ç‰¹ç‚¹</strong></p><ul><li>è§£å†³ç‰¹å®šé¢†åŸŸçš„ä¸“æœ‰é—®é¢˜</li><li>å®ƒä¸ç³»ç»Ÿç¼–ç¨‹è¯­è¨€èµ°çš„æ˜¯ä¸¤ä¸ªæç«¯ï¼Œç³»ç»Ÿç¼–ç¨‹è¯­è¨€æ˜¯å¸Œæœ›è§£å†³æ‰€æœ‰çš„é—®é¢˜ï¼Œæ¯”å¦‚ Java è¯­è¨€å¸Œæœ›èƒ½åš Android å¼€å‘ï¼Œåˆå¸Œæœ›èƒ½åšåå°å¼€å‘ï¼Œå®ƒå…·æœ‰æ¨ªå‘æ‰©å±•çš„ç‰¹æ€§ã€‚è€Œ DSL å…·æœ‰çºµå‘æ·±å…¥è§£å†³ç‰¹å®šé¢†åŸŸä¸“æœ‰é—®é¢˜çš„ç‰¹æ€§ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼ŒDSL çš„<strong>æ ¸å¿ƒæ€æƒ³</strong>å°±æ˜¯ï¼šâ€œæ±‚ä¸“ä¸æ±‚å…¨ï¼Œè§£å†³ç‰¹å®šé¢†åŸŸçš„é—®é¢˜â€ã€‚</p><h3 id="4ã€ä»€ä¹ˆæ˜¯-Groovyï¼Ÿ"><a href="#4ã€ä»€ä¹ˆæ˜¯-Groovyï¼Ÿ" class="headerlink" title="4ã€ä»€ä¹ˆæ˜¯ Groovyï¼Ÿ"></a>4ã€ä»€ä¹ˆæ˜¯ Groovyï¼Ÿ</h3><p><strong>Groovy æ˜¯åŸºäº JVM çš„è„šæœ¬è¯­è¨€ï¼Œå®ƒæ˜¯åŸºäºJavaæ‰©å±•çš„åŠ¨æ€è¯­è¨€</strong></p><p>åŸºäº JVM çš„è¯­è¨€æœ‰å¾ˆå¤šç§ï¼Œå¦‚ï¼šGroovyï¼ŒKotlinï¼ŒJavaï¼ŒScalaç­‰ç­‰ï¼Œä»–ä»¬éƒ½æ‹¥æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹æ€§ï¼šæœ€ç»ˆéƒ½ä¼šç¼–è¯‘ç”Ÿæˆ Java å­—èŠ‚ç æ–‡ä»¶å¹¶åœ¨ JVM ä¸Šè¿è¡Œã€‚</p><p>å› ä¸º Groovy å°±æ˜¯å¯¹ Java çš„æ‰©å±•ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å­¦ä¹  Java çš„æ–¹å¼å»å­¦ä¹  Groovy ã€‚ å­¦ä¹ æˆæœ¬ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒä½çš„ï¼Œå³ä½¿å¼€å‘è¿‡ç¨‹ä¸­å¿˜è®° Groovy è¯­æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨ Java è¯­æ³•ç»§ç»­ç¼–ç </p><h3 id="5ã€Gradle-å’Œ-Groovy-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5ã€Gradle-å’Œ-Groovy-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5ã€Gradle å’Œ Groovy æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5ã€Gradle å’Œ Groovy æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Gradle æ˜¯åŸºäº Groovy çš„ä¸€ç§è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œæ˜¯è¿è¡Œåœ¨JVMä¸Šçš„ä¸€ä¸ªç¨‹åºï¼ŒGroovyæ˜¯åŸºäºJVMçš„ä¸€ç§è¯­è¨€ï¼ŒGradle å’Œ Groovy çš„å…³ç³»å°±åƒ Android å’Œ Java çš„å…³ç³»ä¸€æ ·</p><h3 id="6ã€é™æ€ç¼–ç¨‹è¯­è¨€å’ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#6ã€é™æ€ç¼–ç¨‹è¯­è¨€å’ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="6ã€é™æ€ç¼–ç¨‹è¯­è¨€å’ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>6ã€é™æ€ç¼–ç¨‹è¯­è¨€å’ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>é™æ€ç¼–ç¨‹è¯­è¨€æ˜¯åœ¨ç¼–è¯‘æœŸå°±è¦ç¡®å®šå˜é‡çš„æ•°æ®ç±»å‹ï¼Œè€ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€åˆ™æ˜¯åœ¨è¿è¡ŒæœŸç¡®å®šå˜é‡çš„æ•°æ®ç±»å‹ã€‚å°±åƒé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œä¸€ä¸ªå¼ºè°ƒçš„æ˜¯ç¼–è¯‘æœŸï¼Œä¸€ä¸ªå¼ºè°ƒçš„æ˜¯è¿è¡ŒæœŸï¼Œå¸¸è§çš„é™æ€ç¼–ç¨‹è¯­è¨€æœ‰Javaï¼ŒKotlinç­‰ç­‰ï¼ŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€æœ‰Groovyï¼ŒPythonç­‰è¯­è¨€ã€‚</p><h2 id="äºŒã€Groovy-å¼€å‘ç¯å¢ƒæ­å»ºä¸å·¥ç¨‹åˆ›å»º"><a href="#äºŒã€Groovy-å¼€å‘ç¯å¢ƒæ­å»ºä¸å·¥ç¨‹åˆ›å»º" class="headerlink" title="äºŒã€Groovy å¼€å‘ç¯å¢ƒæ­å»ºä¸å·¥ç¨‹åˆ›å»º"></a>äºŒã€Groovy å¼€å‘ç¯å¢ƒæ­å»ºä¸å·¥ç¨‹åˆ›å»º</h2><h3 id="1ã€åˆ°å®˜ç½‘ä¸‹è½½JDKå®‰è£…-å¹¶é…ç½®å¥½-JDK-ç¯å¢ƒ"><a href="#1ã€åˆ°å®˜ç½‘ä¸‹è½½JDKå®‰è£…-å¹¶é…ç½®å¥½-JDK-ç¯å¢ƒ" class="headerlink" title="1ã€åˆ°å®˜ç½‘ä¸‹è½½JDKå®‰è£…,å¹¶é…ç½®å¥½ JDK ç¯å¢ƒ"></a>1ã€åˆ°å®˜ç½‘ä¸‹è½½JDKå®‰è£…,å¹¶é…ç½®å¥½ JDK ç¯å¢ƒ</h3><ul><li><a href="https://www.oracle.com/hk/java/technologies/javase-downloads.html">JDKä¸‹è½½</a></li><li><a href="https://juejin.cn/post/6844903895504797710">JDKç¯å¢ƒå˜é‡æ­å»º</a></li></ul><h3 id="2ã€åˆ°å®˜ç½‘ä¸‹è½½å¥½-Groovy-SDKï¼Œå¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®"><a href="#2ã€åˆ°å®˜ç½‘ä¸‹è½½å¥½-Groovy-SDKï¼Œå¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®" class="headerlink" title="2ã€åˆ°å®˜ç½‘ä¸‹è½½å¥½ Groovy SDKï¼Œå¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®"></a>2ã€åˆ°å®˜ç½‘ä¸‹è½½å¥½ Groovy SDKï¼Œå¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®</h3><ul><li><a href="https://groovy.apache.org/download.html">Groovy SDK ä¸‹è½½é“¾æ¥</a></li></ul><h3 id="3ã€é…ç½®-Groovy-ç¯å¢ƒå˜é‡"><a href="#3ã€é…ç½®-Groovy-ç¯å¢ƒå˜é‡" class="headerlink" title="3ã€é…ç½® Groovy ç¯å¢ƒå˜é‡"></a>3ã€é…ç½® Groovy ç¯å¢ƒå˜é‡</h3><ul><li><a href="https://www.jianshu.com/p/b5f4b33c7c24">Groovy ç¯å¢ƒå˜é‡</a></li></ul><h3 id="4ã€åˆ°å®˜ç½‘ä¸‹è½½-IntelliJ-IDEA-å¼€å‘å·¥å…·å¹¶å®‰è£…"><a href="#4ã€åˆ°å®˜ç½‘ä¸‹è½½-IntelliJ-IDEA-å¼€å‘å·¥å…·å¹¶å®‰è£…" class="headerlink" title="4ã€åˆ°å®˜ç½‘ä¸‹è½½ IntelliJ IDEA å¼€å‘å·¥å…·å¹¶å®‰è£…"></a>4ã€åˆ°å®˜ç½‘ä¸‹è½½ IntelliJ IDEA å¼€å‘å·¥å…·å¹¶å®‰è£…</h3><ul><li><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA å¼€å‘å·¥å…·ä¸‹è½½</a></li></ul><h3 id="5ã€åˆ›å»º-Groovy-å·¥ç¨‹å³å¯"><a href="#5ã€åˆ›å»º-Groovy-å·¥ç¨‹å³å¯" class="headerlink" title="5ã€åˆ›å»º Groovy å·¥ç¨‹å³å¯"></a>5ã€åˆ›å»º Groovy å·¥ç¨‹å³å¯</h3><p>å®Œæˆäº†ä¸Šè¿°4ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å¼€å§‹åˆ›å»ºä¸€ä¸ª Groovy å·¥ç¨‹ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5212e2c5be0b40d1948d0e4d0c4dd58a~tplv-k3u1fbpfcp-watermark.image" alt="image-20210314155550728 (1).png"></p><p>æŒ‰ç…§ä¸Šè¿°å›¾ç‰‡ä¸­æ­¥éª¤å³å¯å®Œæˆä¸€ä¸ª Groovy å·¥ç¨‹åˆ›å»ºï¼Œä¸‹é¢å°±å¯ä»¥ä½¿ç”¨ IntelliJ IDEA è¿™ä¸ªå·¥å…·æ¥å­¦ä¹  Groovy äº†ï¼Œæˆ‘ä¸‹é¢æ‰€æœ‰ä»£ç éƒ½æ˜¯åœ¨ IntelliJ IDEA ä¸Šè·‘çš„</p><p><strong>å°æŠ€å·§ï¼š</strong> ä½œä¸º Android å¼€å‘è€…ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨ AndroidStudio è¿›è¡Œå¼€å‘çš„ï¼Œä½†æ˜¯ AndroidStudio å¯¹äº Groovy æ”¯æŒä¸æ˜¯å¾ˆå‹å¥½ï¼Œå„ç§æ²¡æœ‰æç¤ºï¼Œæ¶‰åŠåˆ°é—­åŒ…ï¼Œä½ ä¹Ÿä¸çŸ¥é“é—­åŒ…çš„å‚æ•°æ˜¯å•¥ï¼Ÿå› æ­¤è¿™ä¸ªæ—¶å€™ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ IntelliJ IDEA å…ˆå¼„å¥½ï¼Œåœ¨å¤åˆ¶è¿‡å»ï¼ŒIntelliJ IDEA å¯¹Groovy çš„æ”¯æŒè¿˜æ˜¯å¾ˆå‹å¥½çš„</p><h2 id="ä¸‰ã€Groovy-åŸºç¡€è¯­æ³•"><a href="#ä¸‰ã€Groovy-åŸºç¡€è¯­æ³•" class="headerlink" title="ä¸‰ã€Groovy åŸºç¡€è¯­æ³•"></a>ä¸‰ã€Groovy åŸºç¡€è¯­æ³•</h2><p>å†æ¬¡å¼ºè°ƒ Groovy æ˜¯åŸºäº java æ‰©å±•çš„åŠ¨æ€è¯­è¨€ï¼Œç›´æ¥å†™ java ä»£ç æ˜¯æ²¡é—®é¢˜çš„ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼ŒGroovy çš„ä¼˜åŠ¿åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>åœ¨äº Groovy æä¾›äº†æ›´åŠ çµæ´»ç®€å•çš„è¯­æ³•ï¼Œå¤§é‡çš„è¯­æ³•ç³–ä»¥åŠé—­åŒ…ç‰¹æ€§å¯ä»¥è®©ä½ ç”¨æ›´å°‘çš„ä»£ç æ¥å®ç°å’Œ Java åŒæ ·çš„åŠŸèƒ½ã€‚æ¯”å¦‚è§£æxmlæ–‡ä»¶ï¼ŒGroovy å°±éå¸¸æ–¹ä¾¿ï¼Œåªéœ€è¦å‡ è¡Œä»£ç å°±èƒ½æå®šï¼Œè€Œå¦‚æœç”¨ Java åˆ™éœ€è¦å‡ åè¡Œä»£ç ã€‚</p><h3 id="1ã€æ”¯æŒåŠ¨æ€ç±»å‹ï¼Œä½¿ç”¨-def-å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå˜é‡"><a href="#1ã€æ”¯æŒåŠ¨æ€ç±»å‹ï¼Œä½¿ç”¨-def-å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå˜é‡" class="headerlink" title="1ã€æ”¯æŒåŠ¨æ€ç±»å‹ï¼Œä½¿ç”¨ def å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå˜é‡"></a>1ã€æ”¯æŒåŠ¨æ€ç±»å‹ï¼Œä½¿ç”¨ def å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå˜é‡</h3><p>åœ¨ Groovy ä¸­å¯ä»¥ä½¿ç”¨ def å…³é”®å­—å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œå½“ç„¶ Java é‡Œé¢å®šä¹‰æ•°æ®ç±»å‹çš„æ–¹å¼ï¼Œåœ¨ Groovy ä¸­éƒ½èƒ½ç”¨</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//Java ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šè¿™ä¹ˆå®šä¹‰</span><br><span class="hljs-type">int</span> age = <span class="hljs-number">16</span><br>String name = <span class="hljs-string">&quot;erdai&quot;</span><br><br><span class="hljs-comment">//Groovy ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ï¼Œåœ¨å˜é‡èµ‹å€¼åï¼ŒGroovy ç¼–è¯‘å™¨ä¼šæ¨æ–­å‡ºå˜é‡çš„å®é™…ç±»å‹</span><br><span class="hljs-keyword">def</span> age = <span class="hljs-number">16</span><br><span class="hljs-keyword">def</span> name = <span class="hljs-string">&#x27;erdai&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€ä¸ç”¨å†™-å·"><a href="#2ã€ä¸ç”¨å†™-å·" class="headerlink" title="2ã€ä¸ç”¨å†™ ; å·"></a>2ã€ä¸ç”¨å†™ ; å·</h3><p>ç°åœ¨æ¯”è¾ƒæ–°çš„è¯­è¨€éƒ½ä¸ç”¨å†™ï¼Œå¦‚ Kotlin</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> age = <span class="hljs-number">16</span><br><span class="hljs-keyword">def</span> name = <span class="hljs-string">&#x27;erdai&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="3ã€æ²¡æœ‰åŸºæœ¬æ•°æ®ç±»å‹äº†ï¼Œå…¨æ˜¯å¼•ç”¨ç±»å‹"><a href="#3ã€æ²¡æœ‰åŸºæœ¬æ•°æ®ç±»å‹äº†ï¼Œå…¨æ˜¯å¼•ç”¨ç±»å‹" class="headerlink" title="3ã€æ²¡æœ‰åŸºæœ¬æ•°æ®ç±»å‹äº†ï¼Œå…¨æ˜¯å¼•ç”¨ç±»å‹"></a>3ã€æ²¡æœ‰åŸºæœ¬æ•°æ®ç±»å‹äº†ï¼Œå…¨æ˜¯å¼•ç”¨ç±»å‹</h3><p>ä¸Šé¢è¯´åˆ°ï¼Œå®šä¹‰ä¸€ä¸ªå˜é‡ä½¿ç”¨ def å…³é”®å­—ï¼Œä½†æ˜¯ Groovy æ˜¯åŸºäº Java æ‰©å±•çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Java é‡Œé¢çš„ç±»å‹ï¼Œå¦‚ Java ä¸­8å¤§åŸºæœ¬ç±»å‹ï¼šbyte , short , int , long , float , double ï¼Œcharï¼Œboolean</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs gas">//å®šä¹‰8å¤§åŸºæœ¬ç±»å‹<br>byte mByte = 1<br>short mShort = 2<br>int mInt = 3<br>long mLong = 4<br>float mFloat = 5<br>double mDouble = 6<br>char mChar = &#x27;a&#x27;<br>boolean mBoolean = true<br>//å¯¹ç±»å‹è¿›è¡Œæ‰“å°<br>println(mByte.class)<br>println(mShort.class)<br>println(mInt.class)<br>println(mLong.class)<br>println(mFloat.class)<br>println(mDouble.class)<br>println(mChar.class)<br>println(mBoolean.class)<br><br>//æ‰“å°ç»“æœå¦‚ä¸‹:<br>class java.lang.Byte<br>class java.lang.Short<br>class java.lang.Integer<br>class java.lang.Long<br>class java.lang.Float<br>class java.lang.Double<br>class java.lang.Character<br>class java.lang.Boolean<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š<strong>Groovyä¸­æ²¡æœ‰åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¨æ˜¯å¼•ç”¨ç±»å‹ï¼Œå³ä½¿å®šä¹‰äº†åŸºç¡€ç±»å‹ï¼Œä¹Ÿä¼šè¢«è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»</strong></p><h3 id="4ã€æ–¹æ³•å˜åŒ–"><a href="#4ã€æ–¹æ³•å˜åŒ–" class="headerlink" title="4ã€æ–¹æ³•å˜åŒ–"></a>4ã€æ–¹æ³•å˜åŒ–</h3><p>1ã€ä½¿ç”¨ def å…³é”®å­—å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•ä¸éœ€è¦æŒ‡å®šè¿”å›å€¼ç±»å‹ï¼Œå‚æ•°ç±»å‹ï¼Œæ–¹æ³•ä½“å†…çš„æœ€åä¸€è¡Œä¼šè‡ªåŠ¨ä½œä¸ºè¿”å›å€¼ï¼Œè€Œä¸éœ€è¦returnå…³é”®å­—</p><p>2ã€æ–¹æ³•è°ƒç”¨å¯ä»¥ä¸å†™ () ï¼Œæœ€å¥½è¿˜æ˜¯åŠ ä¸Š () çš„å¥½ï¼Œä¸ç„¶å¯è¯»æ€§ä¸å¥½</p><p>3ã€å®šä¹‰æ–¹æ³•æ—¶ï¼Œå¦‚æœå‚æ•°æ²¡æœ‰è¿”å›å€¼ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥ defï¼Œä½¿ç”¨ void å³å¯</p><p>4ã€å®é™…ä¸Šä¸ç®¡æœ‰æ²¡æœ‰è¿”å›å€¼ï¼ŒGroovy ä¸­è¿”å›çš„éƒ½æ˜¯ Object ç±»å‹</p><p>5ã€ç±»çš„æ„é€ æ–¹æ³•ï¼Œé¿å…æ·»åŠ  def å…³é”®å­—</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> sum(a,b)&#123;<br>    a + b<br>&#125;<br><span class="hljs-keyword">def</span> sum = sum(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>) <span class="hljs-comment">//è¿˜å¯ä»¥å†™æˆè¿™æ ·ï¼Œä½†æ˜¯å¯è¯»æ€§ä¸å¥½ def sum = sum 1,2 </span><br>println(sum)<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">3</span><br><br><span class="hljs-comment">//å¦‚æœæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</span><br><span class="hljs-type">void</span> doSomething(param1, param2) &#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//ç±»çš„æ„é€ æ–¹æ³•ï¼Œé¿å…æ·»åŠ  def å…³é”®å­—</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>    MyClass() &#123;<br>      <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€å­—ç¬¦ä¸²å˜åŒ–"><a href="#5ã€å­—ç¬¦ä¸²å˜åŒ–" class="headerlink" title="5ã€å­—ç¬¦ä¸²å˜åŒ–"></a>5ã€å­—ç¬¦ä¸²å˜åŒ–</h3><p>åœ¨ Groovy ä¸­æœ‰ä¸‰ç§å¸¸ç”¨çš„å­—ç¬¦ä¸²å®šä¹‰æ–¹å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>è¿™é‡Œå…ˆè§£é‡Šä¸€ä¸‹å¯æ‰©å±•å­—ç¬¦ä¸²çš„å«ä¹‰ï¼Œå¯æ‰©å±•å­—ç¬¦ä¸²å°±æ˜¯<strong>å­—ç¬¦ä¸²é‡Œé¢å¯ä»¥å¼•ç”¨å˜é‡ï¼Œè¡¨è¾¾å¼ç­‰ç­‰</strong></p><p>1 ã€å•å¼•å· â€˜â€™ å®šä¹‰çš„å­—ç¬¦ä¸²ä¸ºä¸å¯æ‰©å±•å­—ç¬¦ä¸²</p><p>2 ã€åŒå¼•å· â€œâ€ å®šä¹‰çš„å­—ç¬¦ä¸²ä¸ºå¯æ‰©å±•å­—ç¬¦ä¸²ï¼Œå¯æ‰©å±•å­—ç¬¦ä¸²é‡Œé¢å¯ä»¥ä½¿ç”¨ ${} å¼•ç”¨å˜é‡å€¼ï¼Œå½“ {} é‡Œé¢åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œéè¡¨è¾¾å¼æ—¶ï¼Œ{}ä¹Ÿå¯ä»¥å»æ‰</p><p>3 ã€ä¸‰å¼•å· â€˜â€™â€™ â€˜â€™â€™ å®šä¹‰çš„å­—ç¬¦ä¸²ä¸ºè¾“å‡ºå¸¦æ ¼å¼çš„ä¸å¯æ‰©å±•å­—ç¬¦ä¸²</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> age = <span class="hljs-number">16</span><br><span class="hljs-keyword">def</span> name = <span class="hljs-string">&#x27;erdai&#x27;</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸å¯æ‰©å±•å­—ç¬¦ä¸²ï¼Œå’Œæˆ‘é—¨åœ¨Javaä¸­ä½¿ç”¨å·®ä¸å¤š</span><br><span class="hljs-keyword">def</span> str1 = <span class="hljs-string">&#x27;hello &#x27;</span> + name<br><span class="hljs-comment">//å®šä¹‰å¯æ‰©å±•å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²é‡Œé¢å¯ä»¥å¼•ç”¨å˜é‡å€¼ï¼Œå½“ &#123;&#125; é‡Œé¢åªæœ‰ä¸€ä¸ªå˜é‡æ—¶ï¼Œ&#123;&#125;ä¹Ÿå¯ä»¥å»æ‰</span><br><span class="hljs-keyword">def</span> str2 = <span class="hljs-string">&quot;hello $name $&#123;name + age&#125;&quot;</span><br><span class="hljs-comment">//å®šä¹‰å¸¦è¾“å‡ºæ ¼å¼çš„ä¸å¯æ‰©å±•å­—ç¬¦ä¸² ä½¿ç”¨ \ å­—ç¬¦æ¥åˆ†è¡Œ</span><br><span class="hljs-keyword">def</span> str3 = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">\</span><br><span class="hljs-string">hello</span><br><span class="hljs-string">name</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment">//æ‰“å°ç±»å‹å’Œå€¼ ä¸‹é¢ä»£ç æˆ‘çœç•¥äº† println æ–¹æ³•çš„ï¼ˆï¼‰ï¼Œä¸Šé¢æœ‰è®²åˆ°è¿™ç§è¯­æ³•ä¹Ÿæ˜¯å…è®¸çš„</span><br>println <span class="hljs-string">&#x27;str1ç±»å‹: &#x27;</span> + str1.<span class="hljs-keyword">class</span><br><span class="hljs-title class_">println</span> <span class="hljs-string">&#x27;str1è¾“å‡ºå€¼: &#x27;</span> + str1<br>println <span class="hljs-string">&#x27;str2ç±»å‹: &#x27;</span> + str2.<span class="hljs-keyword">class</span><br><span class="hljs-title class_">println</span> <span class="hljs-string">&#x27;str2è¾“å‡ºå€¼: &#x27;</span> + str2<br>println <span class="hljs-string">&#x27;str3ç±»å‹: &#x27;</span> + str3.<span class="hljs-keyword">class</span><br><span class="hljs-title class_">println</span> <span class="hljs-string">&#x27;str3è¾“å‡ºå€¼: &#x27;</span> + str3<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>str1ç±»å‹: <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.String<br>str1è¾“å‡ºå€¼: hello erdai<br>str2ç±»å‹: <span class="hljs-keyword">class</span> <span class="hljs-title class_">org</span>.codehaus.groovy.runtime.GStringImpl<br>str2è¾“å‡ºå€¼: hello erdai erdai16<br>str3ç±»å‹: <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.String<br>str3è¾“å‡ºå€¼: <br>hello<br>name<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œstr2 æ˜¯ GStringImpl ç±»å‹çš„ï¼Œè€Œ str1 å’Œ str3 æ˜¯ String ç±»å‹çš„ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘å°±ä¼šæœ‰ä¸ªç–‘é—®ï¼Œè¿™ä¸¤ç§ç±»å‹åœ¨ç›¸äº’èµ‹å€¼çš„æƒ…å†µä¸‹æ˜¯å¦éœ€è¦å¼ºè½¬å‘¢ï¼Ÿæˆ‘ä»¬åšä¸ªå®éªŒåœ¨æµ‹è¯•ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª String ç±»å‹çš„å˜é‡æ¥æ”¶ GStringImpl ç±»å‹çš„å˜é‡ï¼Œå¹¶æ²¡æœ‰å¼ºè½¬</span><br>String str4 = str2<br>println <span class="hljs-string">&#x27;str4ç±»å‹: &#x27;</span> + str4.<span class="hljs-keyword">class</span><br><span class="hljs-title class_">println</span> <span class="hljs-string">&#x27;str4è¾“å‡ºå€¼: &#x27;</span> + str4<br><br><span class="hljs-comment">//æ‰“å°ç±»å‹å’Œå€¼</span><br>str4ç±»å‹: <span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.lang.String<br>str4è¾“å‡ºå€¼: hello erdai erdai16<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š<strong>ç¼–ç çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦ç‰¹åˆ«å…³æ³¨ String å’Œ GString çš„åŒºåˆ«ï¼Œç¼–è¯‘å™¨ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨è½¬æ¢ç±»å‹</strong>ã€‚</p><h3 id="6-ä¸ç”¨å†™-get-å’Œ-set-æ–¹æ³•"><a href="#6-ä¸ç”¨å†™-get-å’Œ-set-æ–¹æ³•" class="headerlink" title="6. ä¸ç”¨å†™ get å’Œ set æ–¹æ³•"></a>6. ä¸ç”¨å†™ get å’Œ set æ–¹æ³•</h3><p>1ã€åœ¨æˆ‘ä»¬åˆ›å»ºå±æ€§çš„æ—¶å€™ï¼ŒGroovyä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åˆ›å»º get å’Œ set æ–¹æ³•</p><p>2ã€å½“æˆ‘ä»¬åªå®šä¹‰äº†ä¸€ä¸ªå±æ€§çš„ get æ–¹æ³•ï¼Œè€Œæ²¡æœ‰å®šä¹‰è¿™ä¸ªå±æ€§ï¼Œé»˜è®¤è¿™ä¸ªå±æ€§åªè¯»</p><p>3ã€æˆ‘ä»¬åœ¨ä½¿â½¤å¯¹è±¡ object.field æ¥è·å–å€¼æˆ–è€…ä½¿ç”¨ object.field &#x3D; value æ¥èµ‹å€¼çš„æ—¶å€™ï¼Œå®é™…ä¸Šä¼šè‡ªåŠ¨è½¬è€Œè°ƒâ½¤ object.getField() å’Œ object.setField(value) æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³è°ƒç”¨è¿™ä¸ªç‰¹æ®Šçš„ get æ–¹æ³•æ—¶åˆ™å¯ä»¥ä½¿ç”¨ .@ ç›´æ¥åŸŸè®¿é—®æ“ä½œç¬¦è®¿é—®å±æ€§æœ¬èº«</p><p>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿ1ï¼Œ2ï¼Œ3è¿™ä¸‰ç§æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æƒ…å†µ1ï¼šåœ¨æˆ‘ä»¬åˆ›å»ºå±æ€§çš„æ—¶å€™ï¼ŒGroovyä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åˆ›å»º get å’Œ set æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    def name<br>    def age<br>&#125;<br><br><span class="hljs-type">def</span> <span class="hljs-variable">people</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>()<br>people.name = <span class="hljs-string">&#x27;erdai&#x27;</span><br>people.age = <span class="hljs-number">19</span><br>println <span class="hljs-string">&quot;å§“å: $people.name å¹´é¾„: $people.age&quot;</span><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å§“å: erdai å¹´é¾„: <span class="hljs-number">19</span><br>  <br><span class="hljs-comment">//æƒ…å†µ2 å½“æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå±æ€§çš„ get æ–¹æ³•ï¼Œè€Œæ²¡æœ‰å®šä¹‰è¿™ä¸ªå±æ€§ï¼Œé»˜è®¤è¿™ä¸ªå±æ€§åªè¯»</span><br><span class="hljs-comment">//æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹Peopleç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    def name<br>    def <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-number">12</span><br>    &#125;<br>&#125;<br><br><span class="hljs-type">def</span> <span class="hljs-variable">people</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>()<br>people.name = <span class="hljs-string">&#x27;erdai&#x27;</span><br>people.age = <span class="hljs-number">19</span><br>println <span class="hljs-string">&quot;å§“å: $people.name å¹´é¾„: $people.age&quot;</span><br><span class="hljs-comment">//è¿è¡Œä¸€ä¸‹ä»£ç  æ‰“å°ç»“æœæŠ¥é”™äº†ï¼Œå¦‚ä¸‹ï¼š</span><br>Caught: groovy.lang.ReadOnlyPropertyException: Cannot set readonly property: age <span class="hljs-keyword">for</span> class: variable.People<br><span class="hljs-comment">//å¤§æ¦‚é”™è¯¯æ„æ€å°±æ˜¯æˆ‘ä»¬ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåªè¯»çš„å±æ€§</span><br>  <br><span class="hljs-comment">//æƒ…å†µ3: å¦‚æœæˆ‘ä»¬ä¸æƒ³è°ƒç”¨è¿™ä¸ªç‰¹æ®Šçš„ get æ–¹æ³•æ—¶åˆ™å¯ä»¥ä½¿ç”¨ .@ ç›´æ¥åŸŸè®¿é—®æ“ä½œç¬¦è®¿é—®å±æ€§æœ¬èº«</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    def name<br>    def age<br>    <br>    def <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-string">&quot;My name is $name&quot;</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//è¿™é‡Œä½¿ç”¨äº†å‘½åçš„å‚æ•°åˆå§‹åŒ–å’Œé»˜è®¤çš„æ„é€ å™¨åˆ›å»ºpeopleå¯¹è±¡ï¼Œåé¢ä¼šè®²åˆ°</span><br><span class="hljs-type">def</span> <span class="hljs-variable">people</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>(name: <span class="hljs-string">&#x27;erdai666&#x27;</span>)<br>people.age = <span class="hljs-number">19</span><br><span class="hljs-type">def</span> <span class="hljs-variable">myName</span> <span class="hljs-operator">=</span> people.<span class="hljs-meta">@name</span><br><br><span class="hljs-comment">//æ‰“å°å€¼</span><br>println myName<br>println <span class="hljs-string">&quot;å§“å: $people.name å¹´é¾„: $people.age&quot;</span><br>  <br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br>å§“å: My name is erdai666 å¹´é¾„: <span class="hljs-number">19</span><br><span class="hljs-comment">//çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿä½¿ç”¨ people.name åˆ™ä¼šå»è°ƒç”¨è¿™ä¸ªå±æ€§çš„getæ–¹æ³•ï¼Œè€Œ people.@name åˆ™ä¼šè®¿é—®è¿™ä¸ªå±æ€§æœ¬èº«</span><br></code></pre></td></tr></table></figure><h3 id="7ã€Class-æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œæ‰€æœ‰çš„-Class-ç±»å‹å¯ä»¥çœç•¥-Class"><a href="#7ã€Class-æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œæ‰€æœ‰çš„-Class-ç±»å‹å¯ä»¥çœç•¥-Class" class="headerlink" title="7ã€Class æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œæ‰€æœ‰çš„ Class ç±»å‹å¯ä»¥çœç•¥ .Class"></a>7ã€Class æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œæ‰€æœ‰çš„ Class ç±»å‹å¯ä»¥çœç•¥ .Class</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªTestç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123; <br><br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæµ‹è¯•classçš„æ–¹æ³•ï¼Œä»å‰é¢çš„è¯­æ³•æˆ‘ä»¬çŸ¥é“ï¼Œæ–¹æ³•çš„å‚æ•°ç±»å‹æ˜¯å¯ä»¥çœç•¥çš„</span><br><span class="hljs-keyword">def</span> testClass(myClass)&#123;<br>    <br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•</span><br>testClass(Test.<span class="hljs-keyword">class</span>)<br>testClass(Test)<br></code></pre></td></tr></table></figure><h3 id="8ã€-x3D-x3D-å’Œ-equals"><a href="#8ã€-x3D-x3D-å’Œ-equals" class="headerlink" title="8ã€&#x3D;&#x3D; å’Œ equals"></a>8ã€&#x3D;&#x3D; å’Œ equals</h3><p>åœ¨ Groovy ä¸­ï¼Œ&#x3D;&#x3D; å°±ç›¸å½“äº Java çš„ equalsï¼Œå¦‚æœéœ€è¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªï¼Œéœ€è¦ä½¿ç”¨ .is()</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    <span class="hljs-keyword">def</span> name<br>    <span class="hljs-keyword">def</span> age<br>&#125;<br><br><span class="hljs-keyword">def</span> people1 = <span class="hljs-keyword">new</span> People(<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;erdai666&#x27;</span>)<br><span class="hljs-keyword">def</span> people2 = <span class="hljs-keyword">new</span> People(<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;erdai666&#x27;</span>)<br><br>println(<span class="hljs-string">&quot;people1.name == people2.name is: &quot;</span> + (people1.name == people2.name))<br>println(<span class="hljs-string">&quot;people1 is people2 is: &quot;</span> + people1.is(people2))<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>people1.name == people2.name <span class="hljs-attr">is:</span> <span class="hljs-literal">true</span><br>people1 is people2 <span class="hljs-attr">is:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h3 id="9ã€ä½¿ç”¨-assert-æ¥è®¾ç½®æ–­è¨€ï¼Œå½“æ–­è¨€çš„æ¡ä»¶ä¸º-false-æ—¶ï¼Œç¨‹åºå°†ä¼šæŠ›å‡ºå¼‚å¸¸"><a href="#9ã€ä½¿ç”¨-assert-æ¥è®¾ç½®æ–­è¨€ï¼Œå½“æ–­è¨€çš„æ¡ä»¶ä¸º-false-æ—¶ï¼Œç¨‹åºå°†ä¼šæŠ›å‡ºå¼‚å¸¸" class="headerlink" title="9ã€ä½¿ç”¨ assert æ¥è®¾ç½®æ–­è¨€ï¼Œå½“æ–­è¨€çš„æ¡ä»¶ä¸º false æ—¶ï¼Œç¨‹åºå°†ä¼šæŠ›å‡ºå¼‚å¸¸"></a>9ã€ä½¿ç”¨ assert æ¥è®¾ç½®æ–­è¨€ï¼Œå½“æ–­è¨€çš„æ¡ä»¶ä¸º false æ—¶ï¼Œç¨‹åºå°†ä¼šæŠ›å‡ºå¼‚å¸¸</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">assert</span>  <span class="hljs-number">2</span> ** <span class="hljs-number">4</span> == <span class="hljs-number">15</span><br><span class="hljs-comment">//è¿è¡Œç¨‹åºï¼ŒæŠ¥é”™äº†ï¼Œç»“æœå¦‚ä¸‹ï¼š</span><br><span class="hljs-attr">Caught:</span> Assertion <span class="hljs-attr">failed:</span> <br><span class="hljs-keyword">assert</span>  <span class="hljs-number">2</span> ** <span class="hljs-number">4</span> == <span class="hljs-number">15</span><br>          |    |<br>          <span class="hljs-number">16</span>   <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h3 id="10ã€æ”¯æŒ-æ¬¡æ–¹è¿ç®—ç¬¦"><a href="#10ã€æ”¯æŒ-æ¬¡æ–¹è¿ç®—ç¬¦" class="headerlink" title="10ã€æ”¯æŒ ** æ¬¡æ–¹è¿ç®—ç¬¦"></a>10ã€æ”¯æŒ ** æ¬¡æ–¹è¿ç®—ç¬¦</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">assert</span>  <span class="hljs-number">2</span> ** <span class="hljs-number">4</span> == <span class="hljs-number">16</span><br></code></pre></td></tr></table></figure><h3 id="11ã€ç®€æ´çš„ä¸‰å…ƒè¡¨è¾¾å¼"><a href="#11ã€ç®€æ´çš„ä¸‰å…ƒè¡¨è¾¾å¼" class="headerlink" title="11ã€ç®€æ´çš„ä¸‰å…ƒè¡¨è¾¾å¼"></a>11ã€ç®€æ´çš„ä¸‰å…ƒè¡¨è¾¾å¼</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨javaä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆå†™</span><br>String str = obj != <span class="hljs-literal">null</span> ? obj : <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment">//åœ¨Groovyä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼Œ?: æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå·¦è¾¹ç»“æœä¸ä¸ºç©ºåˆ™å–å·¦è¾¹çš„å€¼ï¼Œå¦åˆ™å–å³è¾¹çš„å€¼</span><br>String str = obj ?: <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="12ã€ç®€æ´çš„éç©ºåˆ¤æ–­"><a href="#12ã€ç®€æ´çš„éç©ºåˆ¤æ–­" class="headerlink" title="12ã€ç®€æ´çš„éç©ºåˆ¤æ–­"></a>12ã€ç®€æ´çš„éç©ºåˆ¤æ–­</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨javaä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™ä¹ˆå†™</span><br><span class="hljs-keyword">if</span>(obj != <span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-keyword">if</span>(obj.group != <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-keyword">if</span>(obj.group.artifact != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-comment">//do something</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//åœ¨Groovyä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ ?. æ“ä½œç¬¦è¡¨ç¤ºå¦‚æœå½“å‰è°ƒç”¨å¯¹è±¡ä¸ºç©ºå°±ä¸æ‰§è¡Œäº†</span><br>obj?.group?.artifact<br><br></code></pre></td></tr></table></figure><h3 id="13ã€å¼ºå¤§çš„-Switch"><a href="#13ã€å¼ºå¤§çš„-Switch" class="headerlink" title="13ã€å¼ºå¤§çš„ Switch"></a>13ã€å¼ºå¤§çš„ Switch</h3><p>åœ¨ Groovy ä¸­ï¼Œswitch æ–¹æ³•å˜å¾—æ›´åŠ çµæ´»ï¼Œå¼ºå¤§ï¼Œå¯ä»¥åŒæ—¶æ”¯æŒæ›´å¤šçš„å‚æ•°ç±»å‹ï¼Œæ¯”åœ¨ Java ä¸­å¢å¼ºäº†å¾ˆå¤š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> result = <span class="hljs-string">&#x27;erdai666&#x27;</span><br><span class="hljs-keyword">switch</span> (result)&#123;<br>    <span class="hljs-keyword">case</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;erdai666&#x27;</span>]:<br>        println <span class="hljs-string">&quot;åŒ¹é…åˆ°äº†result&quot;</span><br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-symbol">default:</span><br>        println <span class="hljs-string">&#x27;default&#x27;</span><br>        <span class="hljs-keyword">break</span><br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>åŒ¹é…åˆ°äº†result<br></code></pre></td></tr></table></figure><h3 id="14ã€åˆ¤æ–­æ˜¯å¦ä¸º-null-å’Œ-éè¿ç®—ç¬¦"><a href="#14ã€åˆ¤æ–­æ˜¯å¦ä¸º-null-å’Œ-éè¿ç®—ç¬¦" class="headerlink" title="14ã€åˆ¤æ–­æ˜¯å¦ä¸º null å’Œ éè¿ç®—ç¬¦"></a>14ã€åˆ¤æ–­æ˜¯å¦ä¸º null å’Œ éè¿ç®—ç¬¦</h3><p>åœ¨ Groovy ä¸­ï¼Œæ‰€æœ‰ç±»å‹éƒ½èƒ½è½¬æˆå¸ƒå°”å€¼ï¼Œæ¯”å¦‚ null å°±ç›¸å½“äº0æˆ–è€…ç›¸å½“äº<code>false</code>ï¼Œå…¶ä»–åˆ™ç›¸å½“äº<code>true</code></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆç”¨</span><br><span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; name.length &gt; <span class="hljs-number">0</span>) &#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//åœ¨ Groovy ä¸­ï¼Œå¯ä»¥è¿™ä¹ˆç”¨ï¼Œå¦‚æœnameä¸º null æˆ– 0 åˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å›true</span><br><span class="hljs-keyword">if</span>(name)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//éè¿ç®—ç¬¦ erdai è¿™ä¸ªå­—ç¬¦ä¸²ä¸ºé null ï¼Œå› æ­¤ä¸ºtrueï¼Œè€Œ !erdai åˆ™ä¸ºfalse</span><br><span class="hljs-keyword">assert</span> (!<span class="hljs-string">&#x27;erdai&#x27;</span>) = <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h3 id="15ã€å¯ä»¥ä½¿ç”¨-Number-ç±»å»æ›¿ä»£-floatã€double-ç­‰ç±»å‹ï¼Œçœå»è€ƒè™‘ç²¾åº¦çš„éº»çƒ¦"><a href="#15ã€å¯ä»¥ä½¿ç”¨-Number-ç±»å»æ›¿ä»£-floatã€double-ç­‰ç±»å‹ï¼Œçœå»è€ƒè™‘ç²¾åº¦çš„éº»çƒ¦" class="headerlink" title="15ã€å¯ä»¥ä½¿ç”¨ Number ç±»å»æ›¿ä»£ floatã€double ç­‰ç±»å‹ï¼Œçœå»è€ƒè™‘ç²¾åº¦çš„éº»çƒ¦"></a>15ã€å¯ä»¥ä½¿ç”¨ Number ç±»å»æ›¿ä»£ floatã€double ç­‰ç±»å‹ï¼Œçœå»è€ƒè™‘ç²¾åº¦çš„éº»çƒ¦</h3><h3 id="16ã€é»˜è®¤æ˜¯-public-æƒé™"><a href="#16ã€é»˜è®¤æ˜¯-public-æƒé™" class="headerlink" title="16ã€é»˜è®¤æ˜¯ public æƒé™"></a>16ã€é»˜è®¤æ˜¯ public æƒé™</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGroovy çš„ class å’Œ æ–¹æ³•éƒ½æ˜¯ public æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœç•¥ public å…³é”®å­—ï¼Œé™¤éæˆ‘ä»¬æƒ³ä½¿ç”¨ private ä¿®é¥°ç¬¦</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Server</span> &#123; <br>   String toString() &#123; <span class="hljs-string">&quot;a server&quot;</span> &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="17ã€ä½¿ç”¨å‘½åçš„å‚æ•°åˆå§‹åŒ–å’Œé»˜è®¤çš„æ„é€ å™¨"><a href="#17ã€ä½¿ç”¨å‘½åçš„å‚æ•°åˆå§‹åŒ–å’Œé»˜è®¤çš„æ„é€ å™¨" class="headerlink" title="17ã€ä½¿ç”¨å‘½åçš„å‚æ•°åˆå§‹åŒ–å’Œé»˜è®¤çš„æ„é€ å™¨"></a>17ã€ä½¿ç”¨å‘½åçš„å‚æ•°åˆå§‹åŒ–å’Œé»˜è®¤çš„æ„é€ å™¨</h3><p>Groovyä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥åœ¨æ„é€ æ–¹æ³•ä¸­é€šè¿‡ key value çš„å½¢å¼ç»™å±æ€§èµ‹å€¼ï¼Œè€Œä¸éœ€è¦å»å†™æ„é€ æ–¹æ³•ï¼Œè¯´çš„æœ‰ç‚¹æŠ½è±¡ï¼Œä¸Šä»£ç æ„Ÿå—ä¸€ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªpeople</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    <span class="hljs-keyword">def</span> name<br>    <span class="hljs-keyword">def</span> age<br>&#125;<br><br><span class="hljs-comment">//æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å»å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œæ³¨æ„æˆ‘ä»¬Peopleç±»é‡Œé¢æ²¡æœ‰å†™ä»»ä½•ä¸€ä¸ªæ„é€ æ–¹æ³•å“¦</span><br><span class="hljs-keyword">def</span> people1 = <span class="hljs-keyword">new</span> People()<br><span class="hljs-keyword">def</span> people1 = <span class="hljs-keyword">new</span> People(<span class="hljs-attr">age:</span> <span class="hljs-number">15</span>)<br><span class="hljs-keyword">def</span> people2 = <span class="hljs-keyword">new</span> People(<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;erdai&#x27;</span>)<br><span class="hljs-keyword">def</span> people3 = <span class="hljs-keyword">new</span> People(<span class="hljs-attr">age:</span> <span class="hljs-number">15</span>,<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;erdai&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="18ã€ä½¿ç”¨-with-å‡½æ•°æ“ä½œåŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§å’Œæ–¹æ³•"><a href="#18ã€ä½¿ç”¨-with-å‡½æ•°æ“ä½œåŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§å’Œæ–¹æ³•" class="headerlink" title="18ã€ä½¿ç”¨ with å‡½æ•°æ“ä½œåŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§å’Œæ–¹æ³•"></a>18ã€ä½¿ç”¨ with å‡½æ•°æ“ä½œåŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§å’Œæ–¹æ³•</h3><p>with å‡½æ•°æ¥æ”¶ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…ä¸‹é¢ä¼šè®²ï¼Œé—­åŒ…çš„å‚æ•°å°±æ˜¯å½“å‰è°ƒç”¨çš„å¯¹è±¡</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">People</span>&#123;<br>    <span class="hljs-keyword">def</span> name<br>    <span class="hljs-keyword">def</span> age<br>    <br>    <span class="hljs-type">void</span> running()&#123;<br>        println <span class="hljs-string">&#x27;è·‘æ­¥&#x27;</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª people å¯¹è±¡</span><br><span class="hljs-keyword">def</span> people = <span class="hljs-keyword">new</span> People()<br><span class="hljs-comment">//è°ƒç”¨ with å‡½æ•° é—­åŒ…å‚æ•°å³ä¸ºpeopeo å¦‚æœé—­åŒ…ä¸å†™å‚æ•°ï¼Œé»˜è®¤ä¼šæœ‰ä¸€ä¸ª it å‚æ•°</span><br>people.with&#123;<br>    name = <span class="hljs-string">&quot;erdai&quot;</span><br>    age = <span class="hljs-number">19</span><br>    println <span class="hljs-string">&quot;$name $age&quot;</span><br>    running()<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">19</span><br>è·‘æ­¥<br></code></pre></td></tr></table></figure><h3 id="19ã€å¼‚å¸¸æ•è·"><a href="#19ã€å¼‚å¸¸æ•è·" class="headerlink" title="19ã€å¼‚å¸¸æ•è·"></a>19ã€å¼‚å¸¸æ•è·</h3><p>å¦‚æœä½ å®åœ¨ä¸æƒ³å…³å¿ƒ try å—é‡ŒæŠ›å‡ºä½•ç§å¼‚å¸¸ï¼Œä½ å¯ä»¥ç®€å•çš„æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶ä¸”å¯ä»¥çœç•¥å¼‚å¸¸ç±»å‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨ java ä¸­æˆ‘ä»¬ä¼šè¿™æ ·å†™</span><br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    <span class="hljs-comment">// do something</span><br>&#125;<br><br><span class="hljs-comment">//åœ¨ Groovy ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™</span><br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125; <span class="hljs-keyword">catch</span> (any) &#123;<br>    <span class="hljs-comment">// do something</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ Groovy çš„å†™æ³•å…¶å®å°±æ˜¯çœç•¥äº†å‚æ•°ç±»å‹ï¼Œå®é™…ä¸Š any çš„å‚æ•°ç±»å‹ä¹Ÿæ˜¯ Exceptionï¼Œ å¹¶ä¸åŒ…æ‹¬ Throwable ï¼Œå¦‚æœä½ æƒ³æ•è·æ‰€æœ‰çš„å¼‚å¸¸ï¼Œä½ å¯ä»¥æ˜ç¡®æ•è·å¼‚å¸¸çš„å‚æ•°ç±»å‹</p><h2 id="å››ã€Groovy-é—­åŒ…"><a href="#å››ã€Groovy-é—­åŒ…" class="headerlink" title="å››ã€Groovy é—­åŒ…"></a>å››ã€Groovy é—­åŒ…</h2><p>åœ¨ Groovy ä¸­ï¼Œé—­åŒ…éå¸¸çš„é‡è¦ï¼Œå› æ­¤å•ç‹¬ç”¨ä¸€ä¸ªæ¨¡å—æ¥è®²</p><h3 id="1ã€é—­åŒ…å®šä¹‰"><a href="#1ã€é—­åŒ…å®šä¹‰" class="headerlink" title="1ã€é—­åŒ…å®šä¹‰"></a>1ã€é—­åŒ…å®šä¹‰</h3><p>å¼•ç”¨ Groovy å®˜æ–¹å¯¹é—­åŒ…çš„å®šä¹‰ï¼šA closure in Groovy is an open, anonymous, block of code that can take arguments, return a value and be assigned to a variable. ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š<strong>Groovy ä¸­çš„é—­åŒ…æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ã€åŒ¿åçš„ä»£ç å—ï¼Œå®ƒå¯ä»¥æ¥å—å‚æ•°ã€è¿”å›å€¼å¹¶å°†å€¼èµ‹ç»™å˜é‡ã€‚</strong> é€šä¿—çš„è®²ï¼Œé—­åŒ…å¯ä»¥ä½œä¸ºæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå˜é‡è€Œå­˜åœ¨ï¼Œé—­åŒ…æœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ®µä»£ç å—ï¼Œä¸‹é¢æˆ‘ä»¬å°±ç”±æµ…å…¥æ·±çš„æ¥å­¦ä¹ é—­åŒ…</p><h3 id="2ã€é—­åŒ…å£°æ˜"><a href="#2ã€é—­åŒ…å£°æ˜" class="headerlink" title="2ã€é—­åŒ…å£°æ˜"></a>2ã€é—­åŒ…å£°æ˜</h3><p>1ã€é—­åŒ…åŸºæœ¬çš„è¯­æ³•ç»“æ„ï¼šå¤–é¢ä¸€å¯¹å¤§æ‹¬å·ï¼Œæ¥ç€æ˜¯ç”³æ˜å‚æ•°ï¼Œå‚æ•°ç±»å‹å¯çœç•¥ï¼Œåœ¨æ˜¯ä¸€ä¸ª -&gt; ç®­å¤´å·ï¼Œæœ€åå°±æ˜¯é—­åŒ…ä½“é‡Œé¢çš„å†…å®¹</p><p>2ã€é—­åŒ…ä¹Ÿå¯ä»¥ä¸å®šä¹‰å‚æ•°ï¼Œå¦‚æœé—­åŒ…æ²¡å®šä¹‰å‚æ•°çš„è¯ï¼Œåˆ™éšå«æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°åå­—å« it</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//1</span><br>&#123; params -&gt;<br>   <span class="hljs-comment">//do something</span><br>&#125;<br><br><span class="hljs-comment">//2</span><br>&#123; <br>   <span class="hljs-comment">//do something</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€é—­åŒ…è°ƒç”¨"><a href="#3ã€é—­åŒ…è°ƒç”¨" class="headerlink" title="3ã€é—­åŒ…è°ƒç”¨"></a>3ã€é—­åŒ…è°ƒç”¨</h3><p>1ã€é—­åŒ…å¯ä»¥é€šè¿‡ .call æ–¹æ³•æ¥è°ƒç”¨</p><p>2ã€é—­åŒ…å¯ä»¥ç›´æ¥ç”¨æ‹¬å·+å‚æ•°æ¥è°ƒç”¨</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé—­åŒ…èµ‹å€¼ç»™ closure å˜é‡</span><br><span class="hljs-keyword">def</span> closure = &#123; params1,params2 -&gt;<br>    params1 + params2<br>&#125;<br><br><span class="hljs-comment">//é—­åŒ…è°ƒç”¨æ–¹å¼1: é—­åŒ…å¯ä»¥é€šè¿‡ .call æ–¹æ³•æ¥è°ƒç”¨</span><br><span class="hljs-keyword">def</span> result1 = closure(<span class="hljs-string">&#x27;erdai &#x27;</span>,<span class="hljs-string">&#x27;666&#x27;</span>)<br><span class="hljs-comment">//é—­åŒ…è°ƒç”¨æ–¹å¼2: é—­åŒ…å¯ä»¥ç›´æ¥ç”¨æ‹¬å·+å‚æ•°æ¥è°ƒç”¨</span><br><span class="hljs-keyword">def</span> result2 = closure.call(<span class="hljs-string">&#x27;erdai &#x27;</span>,<span class="hljs-string">&#x27;777&#x27;</span>)<br><span class="hljs-comment">//æ‰“å°å€¼</span><br>println result1<br>println result2<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">666</span><br>erdai <span class="hljs-number">777</span><br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæ— å‚é—­åŒ…</span><br><span class="hljs-keyword">def</span> closure1 = &#123;<br>    println(<span class="hljs-string">&#x27;æ— å®šä¹‰å‚æ•°é—­åŒ…&#x27;</span>)<br>&#125;<br>closure1() <span class="hljs-comment">//æˆ–è€…è°ƒç”¨ closure1.call()</span><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ— å®šä¹‰å‚æ•°é—­åŒ…<br></code></pre></td></tr></table></figure><h3 id="4ã€é—­åŒ…è¿›é˜¶"><a href="#4ã€é—­åŒ…è¿›é˜¶" class="headerlink" title="4ã€é—­åŒ…è¿›é˜¶"></a>4ã€é—­åŒ…è¿›é˜¶</h3><h4 id="1ï¼‰ã€é—­åŒ…ä¸­çš„å…³é”®å˜é‡"><a href="#1ï¼‰ã€é—­åŒ…ä¸­çš„å…³é”®å˜é‡" class="headerlink" title="1ï¼‰ã€é—­åŒ…ä¸­çš„å…³é”®å˜é‡"></a>1ï¼‰ã€é—­åŒ…ä¸­çš„å…³é”®å˜é‡</h4><p>æ¯ä¸ªé—­åŒ…ä¸­éƒ½å«æœ‰ <strong>thisã€owner å’Œ delegate</strong> è¿™ä¸‰ä¸ªå†…ç½®å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªä¸‰ä¸ªå†…ç½®å¯¹è±¡æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿæˆ‘ä»¬ç”¨ä»£ç å»éªŒè¯ä¸€ä¸‹</p><p><strong>æ³¨æ„</strong>ï¼š</p><p><strong>1ã€getThisObject() æ–¹æ³• å’Œ thisObject å±æ€§ç­‰åŒäº this</strong></p><p><strong>2ã€getOwner() æ–¹æ³• ç­‰åŒäº owner</strong></p><p><strong>3ã€getDelegate() æ–¹æ³• ç­‰åŒäº delegate</strong></p><p>è¿™äº›å»çœ‹é—­åŒ…çš„æºç ä½ å°±ä¼šæœ‰æ·±åˆ»çš„ä½“ä¼š</p><p>1ã€æˆ‘ä»¬åœ¨ GroovyGrammar.groovy è¿™ä¸ªè„šæœ¬ç±»ä¸­å®šä¹‰ä¸€ä¸ªé—­åŒ…æ‰“å°è¿™ä¸‰è€…çš„å€¼çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé—­åŒ…</span><br><span class="hljs-keyword">def</span> outerClosure = &#123;<br>    println <span class="hljs-string">&quot;this: &quot;</span> + <span class="hljs-variable language_">this</span><br>    println <span class="hljs-string">&quot;owner: &quot;</span> + owner<br>    println <span class="hljs-string">&quot;delegate: &quot;</span> + delegate<br>&#125;<br><span class="hljs-comment">//è°ƒç”¨é—­åŒ…</span><br>outerClosure.call()<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-attr">this:</span> variable.GroovyGrammar@<span class="hljs-number">39</span>dcf4b0<br><span class="hljs-attr">owner:</span> variable.GroovyGrammar@<span class="hljs-number">39</span>dcf4b0<br><span class="hljs-attr">delegate:</span> variable.GroovyGrammar@<span class="hljs-number">39</span>dcf4b0<br><span class="hljs-comment">//è¯æ˜å½“å‰ä¸‰è€…éƒ½æŒ‡å‘äº†GroovyGrammarè¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡</span><br></code></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬åœ¨è¿™ä¸ª GroovyGrammar.groovy è¿™ä¸ªè„šæœ¬ç±»ä¸­å®šä¹‰ä¸€ä¸ªç±»ï¼Œç±»ä¸­å®šä¹‰ä¸€ä¸ªé—­åŒ…ï¼Œæ‰“å°çœ‹ä¸‹ç»“æœï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª OuterClass ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OuterClass</span> &#123;<br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé—­åŒ…</span><br>    <span class="hljs-keyword">def</span> outerClosure = &#123;<br>        println <span class="hljs-string">&quot;this: &quot;</span> + <span class="hljs-variable language_">this</span><br>        println <span class="hljs-string">&quot;owner: &quot;</span> + owner<br>        println <span class="hljs-string">&quot;delegate: &quot;</span> + delegate<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">def</span> outerClass = <span class="hljs-keyword">new</span> OuterClass()<br>outerClass.outerClosure.call()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</span><br><span class="hljs-attr">this:</span> variable.OuterClass@<span class="hljs-number">1992</span>eaf4<br><span class="hljs-attr">owner:</span> variable.OuterClass@<span class="hljs-number">1992</span>eaf4<br><span class="hljs-attr">delegate:</span> variable.OuterClass@<span class="hljs-number">1992</span>eaf4<br><span class="hljs-comment">//ç»“æœè¯æ˜è¿™ä¸‰è€…éƒ½æŒ‡å‘äº†å½“å‰ OuterClass ç±»å¯¹è±¡</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬åœ¨ GroovyGrammar.groovy è¿™ä¸ªè„šæœ¬ç±»ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…ä¸­åœ¨å®šä¹‰ä¸€ä¸ªé—­åŒ…ï¼Œæ‰“å°çœ‹ä¸‹ç»“æœï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> outerClosure = &#123;<br>    <span class="hljs-keyword">def</span> innerClosure = &#123;<br>        println <span class="hljs-string">&quot;this: &quot;</span> + <span class="hljs-variable language_">this</span><br>        println <span class="hljs-string">&quot;owner: &quot;</span> + owner<br>        println <span class="hljs-string">&quot;delegate: &quot;</span> + delegate<br>    &#125;<br>    innerClosure.call()<br>  <br>&#125;<br>println outerClosure<br>outerClosure.call()<br><br><span class="hljs-comment">//æ‰“å°ç»“æœå¦‚ä¸‹</span><br>variable.GroovyGrammar$_run_closure4@<span class="hljs-number">64</span>beebb7<br><span class="hljs-attr">this:</span> variable.GroovyGrammar@<span class="hljs-number">5</span>b58ed3c<br><span class="hljs-attr">owner:</span> variable.GroovyGrammar$_run_closure4@<span class="hljs-number">64</span>beebb7<br><span class="hljs-attr">delegate:</span> variable.GroovyGrammar$_run_closure4@<span class="hljs-number">64</span>beebb7<br><span class="hljs-comment">//ç»“æœè¯æ˜ this æŒ‡å‘äº†å½“å‰GroovyGrammarè¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡ owner å’Œ delegate éƒ½æŒ‡å‘äº† outerClosure é—­åŒ…å¯¹è±¡</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¢³ç†ä¸€ä¸‹ä¸Šé¢çš„ä¸‰ç§æƒ…å†µ: </p><p>1ã€é—­åŒ…å®šä¹‰åœ¨GroovyGrammar.groovy è¿™ä¸ªè„šæœ¬ç±»ä¸­ this owner delegate å°±æŒ‡å‘è¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡</p><p>2ã€æˆ‘åœ¨è¿™ä¸ªè„šæœ¬ç±»ä¸­åˆ›å»ºäº†ä¸€ä¸ª OuterClass ç±»ï¼Œå¹¶åœ¨ä»–é‡Œé¢å®šä¹‰äº†ä¸€ä¸ªé—­åŒ…ï¼Œé‚£ä¹ˆæ­¤æ—¶ this owner delegate å°±æŒ‡å‘äº† OuterClass è¿™ä¸ªç±»å¯¹è±¡</p><p>3ã€æˆ‘åœ¨ GroovyGrammar.groovy è¿™ä¸ªè„šæœ¬ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…ä¸­åˆå®šä¹‰äº†ä¸€ä¸ªé—­åŒ…ï¼Œthis æŒ‡å‘äº†å½“å‰GroovyGrammarè¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡ï¼Œ owner å’Œ delegate éƒ½æŒ‡å‘äº† outerClosure é—­åŒ…å¯¹è±¡</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç»“è®ºï¼š</p><p><strong>1ã€this æ°¸è¿œæŒ‡å‘å®šä¹‰è¯¥é—­åŒ…æœ€è¿‘çš„ç±»å¯¹è±¡ï¼Œå°±è¿‘åŸåˆ™ï¼Œå®šä¹‰é—­åŒ…æ—¶ï¼Œå“ªä¸ªç±»ç¦»çš„æœ€è¿‘å°±æŒ‡å‘å“ªä¸ªï¼Œæˆ‘è¿™é‡Œçš„ç¦»å¾—è¿‘æ˜¯æŒ‡å®šä¹‰é—­åŒ…çš„è¿™ä¸ªç±»ï¼ŒåŒ…å«å†…éƒ¨ç±»</strong></p><p><strong>2ã€owner æ°¸è¿œæŒ‡å‘å®šä¹‰è¯¥é—­åŒ…çš„ç±»å¯¹è±¡æˆ–è€…é—­åŒ…å¯¹è±¡ï¼Œé¡¾åæ€ä¹‰ï¼Œé—­åŒ…åªèƒ½å®šä¹‰åœ¨ç±»ä¸­æˆ–è€…é—­åŒ…ä¸­</strong></p><p><strong>3ã€delegate å’Œ owner æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åœ¨é—­åŒ…çš„æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œowner ä¼šæŠŠè‡ªå·±çš„å€¼èµ‹ç»™ delegateï¼Œä½†åŒæ—¶ delegate ä¹Ÿå¯ä»¥èµ‹å…¶ä»–å€¼</strong></p><p><strong>æ³¨æ„ï¼šåœ¨æˆ‘ä»¬ä½¿ç”¨ this , owner , å’Œ delegate çš„æ—¶å€™ï¼Œ this å’Œ owner é»˜è®¤æ˜¯åªè¯»çš„ï¼Œæˆ‘ä»¬å¤–éƒ¨ä¿®æ”¹ä¸äº†å®ƒï¼Œè¿™ç‚¹åœ¨æºç ä¸­ä¹Ÿæœ‰ä½“ç°ï¼Œä½†æ˜¯å¯ä»¥å¯¹ delegate è¿›è¡Œæ“ä½œ</strong></p><h4 id="2ï¼‰ã€é—­åŒ…å§”æ‰˜ç­–ç•¥"><a href="#2ï¼‰ã€é—­åŒ…å§”æ‰˜ç­–ç•¥" class="headerlink" title="2ï¼‰ã€é—­åŒ…å§”æ‰˜ç­–ç•¥"></a>2ï¼‰ã€é—­åŒ…å§”æ‰˜ç­–ç•¥</h4><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥å¯¹ä¿®æ”¹é—­åŒ…çš„ delegate è¿›è¡Œå®æ“ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªé¦™è•‰ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Banana</span>&#123;<br>    <span class="hljs-keyword">def</span> name<br>&#125;<br><br><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ©˜å­ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Orange</span>&#123;<br>    <span class="hljs-keyword">def</span> name<br>&#125;<br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé¦™è•‰å¯¹è±¡</span><br><span class="hljs-keyword">def</span> banana = <span class="hljs-keyword">new</span> Orange(<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;é¦™è•‰&#x27;</span>)<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæ©˜å­å¯¹è±¡</span><br><span class="hljs-keyword">def</span> orange = <span class="hljs-keyword">new</span> Orange(<span class="hljs-attr">name:</span> <span class="hljs-string">&#x27;æ©˜å­&#x27;</span>)<br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé—­åŒ…å¯¹è±¡</span><br><span class="hljs-keyword">def</span> closure = &#123;<br>    <span class="hljs-comment">//æ‰“å°å€¼</span><br>    println delegate.name<br>&#125;<br><span class="hljs-comment">//è°ƒç”¨é—­åŒ…</span><br>closure.call()<br><br><span class="hljs-comment">//è¿è¡Œä¸€ä¸‹ï¼Œå‘ç°ç»“æœæŠ¥é”™äº†ï¼Œå¦‚ä¸‹</span><br><span class="hljs-attr">Caught:</span> groovy.lang.<span class="hljs-attr">MissingPropertyException:</span> No such <span class="hljs-attr">property:</span> name <span class="hljs-keyword">for</span> <span class="hljs-attr">class:</span> variable.GroovyGrammar<br><span class="hljs-comment">//å¤§è‡´æ„æ€å°±æ˜¯GroovyGrammarè¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡æ²¡æœ‰è¿™ä¸ª name å¯¹è±¡</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥åˆ†æä¸‹æŠ¥é”™çš„åŸå› åŸå› ï¼Œåˆ†æä¹‹å‰æˆ‘ä»¬è¦æ˜ç™½ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><p><strong>é—­åŒ…çš„é»˜è®¤å§”æ‰˜ç­–ç•¥æ˜¯ OWNER_FIRSTï¼Œä¹Ÿå°±æ˜¯é—­åŒ…ä¼šå…ˆä» owner ä¸Šå¯»æ‰¾å±æ€§æˆ–æ–¹æ³•ï¼Œæ‰¾ä¸åˆ°åˆ™åœ¨ delegate ä¸Šå¯»æ‰¾</strong></p><p>1ã€closure è¿™ä¸ªé—­åŒ…æ˜¯ç”Ÿæ˜åœ¨ GroovyGrammar è¿™ä¸ªè„šæœ¬ç±»å½“ä¸­</p><p>2ã€æ ¹æ®æˆ‘ä»¬ä¹‹å‰å­¦çš„çŸ¥è¯†ï¼Œåœ¨ä¸æ”¹å˜ delegate çš„æƒ…å†µä¸‹ delegate å’Œ owner æ˜¯ä¸€æ ·çš„ï¼Œéƒ½ä¼šæŒ‡å‘ GroovyGrammar è¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡</p><p>3ã€GroovyGrammar è¿™ä¸ªè„šæœ¬ç±»å¯¹è±¡ï¼Œæ ¹æ®é—­åŒ…é»˜è®¤å§”æ‰˜ç­–ç•¥ï¼Œæ‰¾ä¸åˆ° name è¿™ä¸ªå±æ€§</p><p>å› æ­¤æŠ¥é”™äº†ï¼ŒçŸ¥é“äº†æŠ¥é”™åŸå› ï¼Œé‚£æˆ‘ä»¬å°±ä¿®æ”¹ä¸€ä¸‹é—­åŒ…çš„ delegate , è¿˜æ˜¯ä¸Šé¢é‚£æ®µä»£ç ï¼Œæ·»åŠ å¦‚ä¸‹è¿™å¥ä»£ç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//ä¿®æ”¹é—­åŒ…çš„delegate</span><br>closure.delegate = orange<br><span class="hljs-comment">//æˆ‘ä»¬åœ¨è¿è¡Œä¸€ä¸‹ï¼Œæ‰“å°ç»“æœ:</span><br>æ©˜å­<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶é—­åŒ…çš„ delegate æŒ‡å‘äº† orange ï¼Œå› æ­¤ä¼šæ‰“å° orange è¿™ä¸ªå¯¹è±¡çš„ name ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ closure çš„ delegate æ”¹ä¸º bananaï¼Œè‚¯å®šå°±ä¼šæ‰“å°é¦™è•‰äº†</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//ä¿®æ”¹é—­åŒ…çš„delegate</span><br>closure.delegate = banana<br><span class="hljs-comment">//æˆ‘ä»¬åœ¨è¿è¡Œä¸€ä¸‹ï¼Œæ‰“å°ç»“æœ:</span><br>é¦™è•‰<br></code></pre></td></tr></table></figure><h4 id="3ï¼‰ã€æ·±å…¥é—­åŒ…å§”æ‰˜ç­–ç•¥"><a href="#3ï¼‰ã€æ·±å…¥é—­åŒ…å§”æ‰˜ç­–ç•¥" class="headerlink" title="3ï¼‰ã€æ·±å…¥é—­åŒ…å§”æ‰˜ç­–ç•¥"></a>3ï¼‰ã€æ·±å…¥é—­åŒ…å§”æ‰˜ç­–ç•¥</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª ClosureDepth ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClosureDepth</span>&#123;<br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå˜é‡ str1 èµ‹å€¼ä¸º erdai666</span><br>    <span class="hljs-keyword">def</span> str1 = <span class="hljs-string">&#x27;erdai666&#x27;</span><br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé—­åŒ…</span><br>    <span class="hljs-keyword">def</span> outerClosure = &#123;<br>      <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå˜é‡ str2 èµ‹å€¼ä¸º erdai777</span><br>        <span class="hljs-keyword">def</span> str2 = <span class="hljs-string">&#x27;erdai777&#x27;</span><br>      <span class="hljs-comment">//æ‰“å°str1 åˆ†æ1</span><br>        println str1<br><br>      <span class="hljs-comment">//é—­åŒ…ä¸­åœ¨å®šä¹‰ä¸€ä¸ªé—­åŒ…</span><br>        <span class="hljs-keyword">def</span> innerClosure = &#123;<br>            <span class="hljs-comment">//åˆ†æ2</span><br>            println str1<br>            println str2<br>        &#125;<br>        <span class="hljs-comment">//è°ƒç”¨å†…éƒ¨è¿™ä¸ªé—­åŒ…</span><br>        innerClosure.call()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//åˆ›å»º ClosureDepth å¯¹è±¡</span><br><span class="hljs-keyword">def</span> closureDepth = <span class="hljs-keyword">new</span> ClosureDepth()<br><span class="hljs-comment">//è°ƒç”¨å¤–éƒ¨é—­åŒ…</span><br>closureDepth.outerClosure.call()<br><span class="hljs-comment">//è¿è¡Œç¨‹åºï¼Œæ‰“å°ç»“æœå¦‚ä¸‹</span><br>erdai666<br>erdai666<br>erdai777<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æ³¨é‡Šå†™çš„å¾ˆæ¸…æ¥šï¼Œç°åœ¨æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æä¸‹åˆ†æ1å’Œåˆ†æ2å¤„çš„æ‰“å°å€¼ï¼š</p><p>åˆ†æ1ï¼š</p><p>åˆ†æ1å¤„æ‰“å°äº† str1 , å®ƒå¤„äº outerClosure è¿™ä¸ªé—­åŒ…ä¸­ï¼Œæ­¤æ—¶ outerClosure è¿™ä¸ªé—­åŒ…çš„ owner , delegate éƒ½æŒ‡å‘äº† ClosureDepth è¿™ä¸ªç±»å¯¹è±¡ï¼Œå› æ­¤ ClosureDepth è¿™ä¸ªç±»å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•æˆ‘ä»¬å°±éƒ½èƒ½è°ƒç”¨åˆ°ï¼Œå› æ­¤åˆ†æ1å¤„ä¼šæ‰“å° erdai666</p><p>åˆ†æ2ï¼š</p><p>åˆ†æ2å¤„æ‰“å°äº† str1å’Œ str2ï¼Œå®ƒå¤„äº innerClosure è¿™ä¸ªé—­åŒ…ä¸­ï¼Œæ­¤æ—¶ innerClosure è¿™ä¸ªé—­åŒ…çš„ owner å’Œ delegate ä¼šæŒ‡å‘ outerClosure è¿™ä¸ªé—­åŒ…å¯¹è±¡ï¼Œæˆ‘ä»¬ä¼šå‘ç° outerClosure æœ‰ str2 è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ str1 è¿™ä¸ªå±æ€§ï¼Œå› æ­¤ outerClosure è¿™ä¸ªé—­åŒ…ä¼šå‘å®ƒçš„ owner å»å¯»æ‰¾ï¼Œå› æ­¤ä¼šæ‰¾åˆ° ClosureDepth è¿™ä¸ªç±»å¯¹è±¡çš„ str1 å±æ€§ï¼Œå› æ­¤æ‰“å°çš„ str1 æ˜¯ClosureDepth è¿™ä¸ªç±»å¯¹è±¡ä¸­çš„å±æ€§ï¼Œæ‰“å°çš„ str2 æ˜¯outerClosure è¿™ä¸ªé—­åŒ…ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥åˆ†æ2å¤„çš„æ‰“å°ç»“æœåˆ†åˆ«æ˜¯ erdai666 erdai777</p><p>ä¸Šé¢çš„ä¾‹å­ä¸­æ²¡æœ‰æ˜¾å¼çš„ç»™ delegate è®¾ç½®ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä½†æ˜¯æ— è®ºå“ªå±‚é—­åŒ…éƒ½èƒ½æˆåŠŸè®¿é—®åˆ° str1ã€str2 å€¼ï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤çš„è§£æå§”æ‰˜ç­–ç•¥åœ¨å‘æŒ¥ä½œç”¨ï¼ŒGroovy é—­åŒ…çš„å§”æ‰˜ç­–ç•¥æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ol><li><strong>OWNER_FIRST</strong>ï¼šé»˜è®¤ç­–ç•¥ï¼Œé¦–å…ˆä» owner ä¸Šå¯»æ‰¾å±æ€§æˆ–æ–¹æ³•ï¼Œæ‰¾ä¸åˆ°åˆ™åœ¨ delegate ä¸Šå¯»æ‰¾</li><li><strong>DELEGATE_FIRST</strong>ï¼šå’Œä¸Šé¢ç›¸åï¼Œé¦–å…ˆä» delegate ä¸Šå¯»æ‰¾å±æ€§æˆ–è€…æ–¹æ³•ï¼Œæ‰¾ä¸åˆ°åˆ™åœ¨ owner ä¸Šå¯»æ‰¾</li><li><strong>OWNER_ONLY</strong>ï¼šåªåœ¨ owner ä¸Šå¯»æ‰¾ï¼Œdelegate è¢«å¿½ç•¥</li><li><strong>DELEGATE_ONLY</strong>ï¼šå’Œä¸Šé¢ç›¸åï¼Œåªåœ¨ delegate ä¸Šå¯»æ‰¾ï¼Œowner è¢«å¿½ç•¥</li><li><strong>TO_SELF</strong>ï¼šé«˜çº§é€‰é¡¹ï¼Œè®©å¼€å‘è€…è‡ªå®šä¹‰ç­–ç•¥ï¼Œå¿…é¡»è¦è‡ªå®šä¹‰å®ç°ä¸€ä¸ª Closure ç±»ï¼Œä¸€èˆ¬æˆ‘ä»¬è¿™ç§ç©å®¶ç”¨ä¸åˆ°</li></ol><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä¿®æ”¹ä¸€ä¸‹é—­åŒ…çš„å§”æ‰˜ç­–ç•¥ï¼ŒåŠ æ·±ç†è§£ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">class</span> <span class="hljs-title class_">People1</span>&#123;<br>    <span class="hljs-keyword">def</span> name = <span class="hljs-string">&#x27;æˆ‘æ˜¯People1&#x27;</span><br><br>    <span class="hljs-keyword">def</span> action()&#123;<br>        println <span class="hljs-string">&#x27;åƒé¥­&#x27;</span><br>    &#125;<br><br>    <span class="hljs-keyword">def</span> closure = &#123;<br>        println name<br>        action()<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">People2</span>&#123;<br>    <span class="hljs-keyword">def</span> name = <span class="hljs-string">&#x27;æˆ‘æ˜¯People2&#x27;</span><br><br>    <span class="hljs-keyword">def</span> action()&#123;<br>        println <span class="hljs-string">&#x27;ç¡è§‰&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">def</span> people1 = <span class="hljs-keyword">new</span> People1()<br><span class="hljs-keyword">def</span> people2 = <span class="hljs-keyword">new</span> People2()<br>people1.closure.delegate = people2<br>people1.closure.call()<br><span class="hljs-comment">//è¿è¡Œä¸‹ç¨‹åºï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š</span><br>æˆ‘æ˜¯People1<br>åƒé¥­<br></code></pre></td></tr></table></figure><p>what? è¿™æ˜¯å•¥æƒ…å†µï¼Œæˆ‘ä¸æ˜¯ä¿®æ”¹äº† delegate ä¸º people2 äº†ï¼Œæ€ä¹ˆæ‰“å°ç»“æœè¿˜æ˜¯ people1 çš„ï¼Ÿé‚£æ˜¯å› ä¸ºæˆ‘ä»¬å¿½ç•¥äº†ä¸€ä¸ªç‚¹ï¼Œæ²¡æœ‰ä¿®æ”¹é—­åŒ…å§”æ‰˜ç­–ç•¥ï¼Œä»–é»˜è®¤æ˜¯ OWNER_FIRST ï¼Œå› æ­¤æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å°±å¥½äº†ï¼Œè¿˜æ˜¯ä¸Šé¢è¿™æ®µä»£ç ï¼Œæ·»åŠ ä¸€å¥ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">people1.closure.resolveStrategy = Closure.DELEGATE_FIRST<br><span class="hljs-comment">//è¿è¡Œä¸‹ç¨‹åºï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š</span><br>æˆ‘æ˜¯People2<br>ç¡è§‰<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹é—­åŒ…äº†è§£çš„å·®ä¸å¤šäº†ï¼Œä¸‹é¢æˆ‘ä»¬åœ¨çœ‹ä¸‹é—­åŒ…çš„æºç å°±å®Œç¾äº†</p><h4 id="4ï¼‰ã€é—­åŒ…-Closure-ç±»æºç "><a href="#4ï¼‰ã€é—­åŒ…-Closure-ç±»æºç " class="headerlink" title="4ï¼‰ã€é—­åŒ… Closure ç±»æºç "></a>4ï¼‰ã€é—­åŒ… Closure ç±»æºç </h4><p>ä»…è´´å‡ºå…³é”®æºç </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Closure</span>&lt;V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">GroovyObjectSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cloneable</span>, Runnable, GroovyCallable&lt;V&gt;, Serializable &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç†Ÿæ‚‰çš„ä¸€å †é—­åŒ…å§”æ‰˜ä»£ç†ç­–ç•¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> OWNER_FIRST = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> DELEGATE_FIRST = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> OWNER_ONLY = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> DELEGATE_ONLY = <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> TO_SELF = <span class="hljs-number">4</span>;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é—­åŒ…å¯¹åº”çš„ä¸‰ä¸ªå§”æ‰˜å¯¹è±¡ thisObject å¯¹åº”çš„å°±æ˜¯ this å±æ€§ï¼Œéƒ½æ˜¯ç”¨ private ä¿®é¥°çš„ï¼Œå¤–ç•Œè®¿é—®ä¸åˆ°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Object delegate;<br>    <span class="hljs-keyword">private</span> Object owner;<br>    <span class="hljs-keyword">private</span> Object thisObject;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é—­åŒ…å§”æ‰˜ç­–ç•¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> resolveStrategy;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åœ¨é—­åŒ…çš„æ„é€ æ–¹æ³•ä¸­ï¼š</span><br><span class="hljs-comment">     * 1ã€å°† resolveStrategy èµ‹å€¼ä¸º0ï¼Œä¹Ÿæ˜¯å°±é»˜è®¤å§”æ‰˜ç­–ç•¥OWNER_FIRST</span><br><span class="hljs-comment">     * 2ã€thisObject ï¼Œowner ï¼Œdelegateéƒ½ä¼šè¢«èµ‹å€¼ï¼Œdelegate èµ‹çš„æ˜¯ ownerçš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Closure(Object owner, Object thisObject) &#123;<br>        <span class="hljs-variable language_">this</span>.resolveStrategy = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable language_">this</span>.owner = owner;<br>        <span class="hljs-variable language_">this</span>.delegate = owner;<br>        <span class="hljs-variable language_">this</span>.thisObject = thisObject;<br>        CachedClosureClass cachedClass = (CachedClosureClass)ReflectionCache.getCachedClass(<span class="hljs-variable language_">this</span>.getClass());<br>        <span class="hljs-variable language_">this</span>.parameterTypes = cachedClass.getParameterTypes();<br>        <span class="hljs-variable language_">this</span>.maximumNumberOfParameters = cachedClass.getMaximumNumberOfParameters();<br>    &#125;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * thisObject åªæä¾›äº† get æ–¹æ³•ï¼Œä¸” thisObject æ˜¯ç”¨ private ä¿®é¥°çš„ï¼Œå› æ­¤ thisObject å³ this åªè¯»</span><br><span class="hljs-comment">     */</span><br>  <span class="hljs-keyword">public</span> Object getThisObject() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.thisObject;<br>    &#125;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * owner åªæä¾›äº† get æ–¹æ³•ï¼Œä¸” owner æ˜¯ç”¨ private ä¿®é¥°çš„ï¼Œå› æ­¤ owner åªè¯»</span><br><span class="hljs-comment">     */</span><br>  <span class="hljs-keyword">public</span> Object getOwner() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.owner;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * delegate æä¾›äº† get å’Œ set æ–¹æ³•ï¼Œå› æ­¤ delegate å¯è¯»å†™</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Object getDelegate() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.delegate;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">void</span> setDelegate(Object delegate) &#123;<br>        <span class="hljs-variable language_">this</span>.delegate = delegate;<br>    &#125;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç†Ÿæ‚‰çš„å§”æ‰˜ç­–ç•¥è®¾ç½®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">void</span> setResolveStrategy(<span class="hljs-type">int</span> resolveStrategy) &#123;<br>        <span class="hljs-variable language_">this</span>.resolveStrategy = resolveStrategy;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> getResolveStrategy() &#123;<br>        <span class="hljs-keyword">return</span> resolveStrategy;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œé—­åŒ…ç›¸å…³çš„çŸ¥è¯†ç‚¹å°±éƒ½è®²å®Œäº†ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼š<strong>æˆ‘ä»¬ä½¿ç”¨é—­åŒ…çš„æ—¶å€™ï¼Œå¦‚ä½•å»ç¡®å®šé—­åŒ…çš„å‚æ•°å‘¢ï¼Ÿ</strong>ï¼Œè¿™ä¸ªçœŸçš„å¾ˆè›‹ç–¼ï¼Œä½œä¸º Android å¼€å‘è€…ï¼Œåœ¨ä½¿ç”¨ AndroidStudio è¿›è¡Œ Gradle è„šæœ¬ç¼–å†™çš„æ—¶å€™ï¼ŒçœŸçš„æ˜¯éå¸¸ä¸å‹å¥½ï¼Œä¸Šé¢æˆ‘è®²äº†å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°æŠ€å·§å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µæ˜¯åœ¨ä½ çŸ¥é“è¦ä½¿ç”¨ä¸€ä¸ª Api çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ä½ çŸ¥é“ Map çš„ each æ–¹æ³•å¯ä»¥éå†ï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“å‚æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å»ä½¿ç”¨ã€‚é‚£å¦‚æœä½ è¿ Api éƒ½ä¸çŸ¥é“ï¼Œé‚£å°±æ›´åŠ ä¸çŸ¥é“é—­åŒ…çš„å‚æ•°äº†ï¼Œå› æ­¤è¦è§£å†³è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±å¿…é¡»å»æŸ¥é˜… Groovy å®˜æ–¹æ–‡æ¡£ï¼š</p><p><a href="http://link.zhihu.com/?target=http://www.groovy-lang.org/api.html">http://www.groovy-lang.org/api.html</a></p><p><a href="http://link.zhihu.com/?target=http://docs.groovy-lang.org/latest/html/groovy-jdk/index-all.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/index-all.html</a></p><h2 id="äº”ã€Groovyæ•°æ®ç»“æ„"><a href="#äº”ã€Groovyæ•°æ®ç»“æ„" class="headerlink" title="äº”ã€Groovyæ•°æ®ç»“æ„"></a>äº”ã€Groovyæ•°æ®ç»“æ„</h2><p>é€šè¿‡è¿™ä¸ªæ¨¡å—çš„å­¦ä¹ ï¼Œæˆ‘ä¼šç»“åˆå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•æŸ¥é˜…æ–‡æ¡£æ¥ç¡®å®šé—­åŒ…ä¸­çš„å‚æ•°ï¼Œåœ¨è®² Map çš„æ—¶å€™æˆ‘ä¼šè®²åˆ°</p><p>Groovy å¸¸ç”¨çš„æ•°æ®ç»“æ„æœ‰å¦‚ä¸‹ å››ç§ï¼š</p><ul><li>1ï¼‰ã€æ•°ç»„</li><li>2ï¼‰ã€List</li><li>3ï¼‰ã€Map</li><li>4ï¼‰ã€Range</li></ul><h3 id="1ã€æ•°ç»„"><a href="#1ã€æ•°ç»„" class="headerlink" title="1ã€æ•°ç»„"></a>1ã€æ•°ç»„</h3><p>åœ¨ Groovy ä¸­ä½¿ç”¨ [ ] è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª List é›†åˆï¼Œå¦‚æœè¦å®šä¹‰ Array æ•°ç»„ï¼Œæˆ‘ä»¬å°±å¿…é¡»å¼ºåˆ¶æŒ‡å®šä¸ºä¸€ä¸ªæ•°ç»„çš„ç±»å‹</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šè¿™æ ·å»å®šä¹‰ä¸€ä¸ªæ•°ç»„</span><br>String[] javaArray = [<span class="hljs-string">&quot;Java&quot;</span>, <span class="hljs-string">&quot;Groovy&quot;</span>, <span class="hljs-string">&quot;Android&quot;</span>]<br><br><span class="hljs-comment">//åœ¨ Groovy ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨ as å…³é”®å­—å®šä¹‰æ•°ç»„</span><br><span class="hljs-keyword">def</span> groovyArray = [<span class="hljs-string">&quot;Java&quot;</span>, <span class="hljs-string">&quot;Groovy&quot;</span>, <span class="hljs-string">&quot;Android&quot;</span>] <span class="hljs-keyword">as</span> String[]<br></code></pre></td></tr></table></figure><h3 id="2ã€List"><a href="#2ã€List" class="headerlink" title="2ã€List"></a>2ã€List</h3><h4 id="1ï¼‰ã€åˆ—è¡¨é›†åˆå®šä¹‰"><a href="#1ï¼‰ã€åˆ—è¡¨é›†åˆå®šä¹‰" class="headerlink" title="1ï¼‰ã€åˆ—è¡¨é›†åˆå®šä¹‰"></a>1ï¼‰ã€åˆ—è¡¨é›†åˆå®šä¹‰</h4><p>1ã€List å³åˆ—è¡¨é›†åˆï¼Œå¯¹åº” Java ä¸­çš„ List æ¥å£ï¼Œä¸€èˆ¬ç”¨ ArrayList ä½œä¸ºçœŸæ­£çš„å®ç°ç±»</p><p>2ã€å®šä¹‰ä¸€ä¸ªåˆ—è¡¨é›†åˆçš„æ–¹å¼æœ‰ç‚¹åƒ Java ä¸­å®šä¹‰æ•°ç»„ä¸€æ ·</p><p>3ã€é›†åˆå…ƒç´ å¯ä»¥æ¥æ”¶ä»»æ„çš„æ•°æ®ç±»å‹</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//åœ¨ Groovy ä¸­å®šä¹‰çš„é›†åˆé»˜è®¤å°±æ˜¯å¯¹åº”äº Java ä¸­ ArrayList é›†åˆ</span><br><span class="hljs-keyword">def</span> list1 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br><span class="hljs-comment">//æ‰“å° list ç±»å‹</span><br>print list1.<span class="hljs-keyword">class</span><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">java</span>.util.ArrayList<br><br><span class="hljs-comment">//é›†åˆå…ƒç´ å¯ä»¥æ¥æ”¶ä»»æ„çš„æ•°æ®ç±»å‹</span><br><span class="hljs-keyword">def</span> list2 = [<span class="hljs-string">&#x27;erdai666&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>]<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘æƒ³å®šä¹‰ä¸€ä¸ª LinkedList é›†åˆï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ã€é€šè¿‡ Java çš„å¼ºç±»å‹æ–¹å¼å»å®šä¹‰</p><p>2ã€é€šè¿‡ as å…³é”®å­—æ¥æŒ‡å®š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//æ–¹å¼1ï¼šé€šè¿‡ Java çš„å¼ºç±»å‹æ–¹å¼å»å®šä¹‰</span><br>LinkedList list3 = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br><br><span class="hljs-comment">//æ–¹å¼2ï¼šé€šè¿‡ as å…³é”®å­—æ¥æŒ‡å®š</span><br><span class="hljs-keyword">def</span> list4 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] <span class="hljs-keyword">as</span> LinkedList<br></code></pre></td></tr></table></figure><h4 id="2ï¼‰ã€åˆ—è¡¨é›†åˆå¢åˆ æ”¹æŸ¥"><a href="#2ï¼‰ã€åˆ—è¡¨é›†åˆå¢åˆ æ”¹æŸ¥" class="headerlink" title="2ï¼‰ã€åˆ—è¡¨é›†åˆå¢åˆ æ”¹æŸ¥"></a>2ï¼‰ã€åˆ—è¡¨é›†åˆå¢åˆ æ”¹æŸ¥</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> list = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br><span class="hljs-comment">//-------------------------- å¢åŠ å…ƒç´  ---------------------------------</span><br><span class="hljs-comment">//æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼</span><br>list.add(<span class="hljs-number">20</span>)<br>list.leftShift(<span class="hljs-number">20</span>)<br>list &lt;&lt; <span class="hljs-number">20</span><br><br><span class="hljs-comment">//-------------------------- åˆ é™¤å…ƒç´  ---------------------------------</span><br><span class="hljs-comment">//æ ¹æ®ä¸‹æ ‡ç§»é™¤å…ƒç´ </span><br>list.remove(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment">//-------------------------- ä¿®æ”¹å…ƒç´  ---------------------------------</span><br><span class="hljs-comment">//æ ¹æ®ä¸‹æ ‡ä¿®æ”¹å…ƒç´ </span><br>list[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span><br><br><span class="hljs-comment">//-------------------------- æŸ¥è¯¢å…ƒç´  ---------------------------------</span><br><span class="hljs-comment">//è°ƒç”¨é—­åŒ…çš„ find æ–¹æ³•ï¼Œæ–¹æ³•ä¸­æ¥æ”¶ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…çš„å‚æ•°å°±æ˜¯ list ä¸­çš„å…ƒç´ </span><br>list.find &#123;<br>    println it<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ—è¡¨é›†åˆ Api æŒºå¤šçš„ï¼Œå¯¹äºä¸€äº›å…¶ä»–Apiï¼Œä½¿ç”¨åˆ°çš„æ—¶å€™è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£å°±å¥½äº†ï¼Œæˆ‘ä¼šåœ¨ä¸‹é¢è®² Map çš„æ—¶å€™æ¼”ç¤ºæŸ¥é˜… Api æ–‡æ¡£ç¡®å®šé—­åŒ…çš„å‚æ•°</p><h3 id="3ã€Map"><a href="#3ã€Map" class="headerlink" title="3ã€Map"></a>3ã€Map</h3><h4 id="1ï¼‰ã€å®šä¹‰"><a href="#1ï¼‰ã€å®šä¹‰" class="headerlink" title="1ï¼‰ã€å®šä¹‰"></a>1ï¼‰ã€å®šä¹‰</h4><p>1ã€Map è¡¨ç¤ºé”®-å€¼è¡¨ï¼Œå…¶åº•å±‚å¯¹åº” Java ä¸­çš„ LinkedHashMap</p><p>2ã€Map å˜é‡ç”±[:]å®šä¹‰ï¼Œå†’å·å·¦è¾¹æ˜¯ keyï¼Œå³è¾¹æ˜¯ Valueã€‚key å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œvalue å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡</p><p>3ã€Map çš„ key å¯ä»¥ç”¨ â€˜â€™ æˆ– â€œâ€ æˆ– â€˜â€™â€™ â€˜â€™â€™åŒ…èµ·æ¥ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·åŒ…èµ·æ¥</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> map = [<span class="hljs-attr">a:</span> <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;c&quot;</span> : <span class="hljs-string">&quot;Groovy&quot;</span>, <span class="hljs-string">&#x27;&#x27;&#x27;d&#x27;&#x27;&#x27;</span> : <span class="hljs-string">&#x27;&#x27;&#x27;ddd&#x27;&#x27;&#x27;</span>]<br></code></pre></td></tr></table></figure><h4 id="2ï¼‰ã€Map-å¸¸ç”¨æ“ä½œ"><a href="#2ï¼‰ã€Map-å¸¸ç”¨æ“ä½œ" class="headerlink" title="2ï¼‰ã€Map å¸¸ç”¨æ“ä½œ"></a>2ï¼‰ã€Map å¸¸ç”¨æ“ä½œ</h4><p>è¿™é‡Œåˆ—ä¸¾ä¸€äº› Map çš„å¸¸ç”¨æ“ä½œï¼Œä¸€äº›å…¶ä»–çš„ Api ä½¿ç”¨åˆ°çš„æ—¶å€™è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£å°±å¥½äº†</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//---------------------------- Map ä¸­å…ƒç´ è®¿é—®æ“ä½œ ----------------</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹å¼ï¼š</span><br><span class="hljs-comment"> * 1ã€map.key</span><br><span class="hljs-comment"> * 2ã€map[key]</span><br><span class="hljs-comment"> * 3ã€map.get(ket)</span><br><span class="hljs-comment"> */</span><br>println map.a<br>println map[<span class="hljs-string">&#x27;b&#x27;</span>]<br>println map.get(<span class="hljs-string">&#x27;c&#x27;</span>)<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span><br><span class="hljs-literal">true</span><br>Groovy<br><br><span class="hljs-comment">//---------------------------- Map ä¸­æ·»åŠ å’Œä¿®æ”¹å…ƒç´  -------------------</span><br><span class="hljs-comment">//å¦‚æœå½“å‰ key åœ¨ map ä¸­ä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ è¯¥å…ƒç´ ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹è¯¥å…ƒç´ </span><br>map.put(<span class="hljs-string">&#x27;key&#x27;</span>,<span class="hljs-string">&#x27;value&#x27;</span>)<br>map[<span class="hljs-string">&#x27;key&#x27;</span>] = <span class="hljs-string">&quot;value&quot;</span><br></code></pre></td></tr></table></figure><h4 id="3ï¼‰ã€Map-éå†ï¼Œæ¼”ç¤ºæŸ¥é˜…å®˜æ–¹æ–‡æ¡£"><a href="#3ï¼‰ã€Map-éå†ï¼Œæ¼”ç¤ºæŸ¥é˜…å®˜æ–¹æ–‡æ¡£" class="headerlink" title="3ï¼‰ã€Map éå†ï¼Œæ¼”ç¤ºæŸ¥é˜…å®˜æ–¹æ–‡æ¡£"></a>3ï¼‰ã€Map éå†ï¼Œæ¼”ç¤ºæŸ¥é˜…å®˜æ–¹æ–‡æ¡£</h4><p>ç°åœ¨æˆ‘è¦å»éå† map ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“å®ƒçš„ Api æ˜¯å•¥ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±è¦å»æŸ¥å®˜æ–¹ Api æ–‡æ¡£äº†ï¼š</p><p><a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Map.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Map.html</a></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4464fad1d3cc40ab976f7be47d3817e4~tplv-k3u1fbpfcp-zoom-1.image" alt="each"></p><p>æˆ‘ä»¬æŸ¥åˆ° Map æœ‰ each å’Œ eachWithIndex è¿™ä¸¤ä¸ª Api å¯ä»¥å»æ‰§è¡Œéå†æ“ä½œï¼Œæ¥ç€ç‚¹è¿›å»çœ‹ä¸€çœ¼</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e387d37247c04f09873546c4199e8297~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210312113131770"></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6055f46014fc48b0a0f2193db6d9e92b~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210312113208713"></p><p>é€šè¿‡å®˜æ–¹æ–‡æ¡£æˆ‘ä»¬å¯ä»¥å‘ç°: <strong>each å’Œ eachWithIndex çš„é—­åŒ…å‚æ•°è¿˜æ˜¯ä¸ç¡®å®šçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ each æ–¹æ³•ï¼Œå¦‚æœä¼ é€’ç»™é—­åŒ…æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå®ƒå°±æŠŠ entry ä½œä¸ºå‚æ•°ï¼Œå¦‚æœæˆ‘ä»¬ä¼ é€’ç»™é—­åŒ…æ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå®ƒå°±æŠŠ key å’Œ value ä½œä¸ºå‚æ•°ï¼ŒeachWithIndex æ¯” each å¤šäº†ä¸ª index ä¸‹æ ‡è€Œå·².</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±ä½¿ç”¨ä»¥ä¸‹è¿™ä¸¤ä¸ª Api ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//ä¸‹é¢ä¸ºäº†æ‰“å°è¾“å‡ºçš„æ ¼å¼æ¸…æ™°ï¼Œåšäº†ä¸€äº›é¢å¤–çš„æ“ä½œ</span><br><span class="hljs-keyword">def</span> map = [<span class="hljs-attr">a:</span> <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;c&quot;</span> : <span class="hljs-string">&quot;Groovy&quot;</span>, <span class="hljs-string">&#x27;&#x27;&#x27;d&#x27;&#x27;&#x27;</span> : <span class="hljs-string">&#x27;&#x27;&#x27;ddd&#x27;&#x27;&#x27;</span>]<br><br>map.each &#123;<br>    print <span class="hljs-string">&quot;$it.key $it.value \t&quot;</span><br>&#125;<br>println()<br><br>map.each &#123;key,value -&gt;<br>    print <span class="hljs-string">&quot;$key $value \t&quot;</span><br>&#125;<br>println()<br><br>map.eachWithIndex &#123;entry,index -&gt;<br>    print <span class="hljs-string">&quot;$entry.key $entry.value $index \t&quot;</span><br>&#125;<br>println()<br><br>map.eachWithIndex &#123; key,value,index -&gt;<br>    print <span class="hljs-string">&quot;$key $value $index \t&quot;</span><br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>a <span class="hljs-number">1</span> b <span class="hljs-literal">true</span> c Groovy d ddd <br>a <span class="hljs-number">1</span> b <span class="hljs-literal">true</span> c Groovy d ddd <br>a <span class="hljs-number">1</span> <span class="hljs-number">0</span> b <span class="hljs-literal">true</span> <span class="hljs-number">1</span> c Groovy <span class="hljs-number">2</span> d ddd <span class="hljs-number">3</span> <br>a <span class="hljs-number">1</span> <span class="hljs-number">0</span> b <span class="hljs-literal">true</span> <span class="hljs-number">1</span> c Groovy <span class="hljs-number">2</span> d ddd <span class="hljs-number">3</span> <br></code></pre></td></tr></table></figure><h3 id="4ã€Range"><a href="#4ã€Range" class="headerlink" title="4ã€Range"></a>4ã€Range</h3><p>Range è¡¨ç¤ºèŒƒå›´ï¼Œå®ƒå…¶å®æ˜¯ <strong>List çš„ä¸€ç§æ‹“å±•ã€‚å…¶ç”± begin å€¼ + ä¸¤ä¸ªç‚¹ + end å€¼è¡¨ç¤ºã€‚å¦‚æœä¸æƒ³åŒ…å«æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ begin å€¼ + ä¸¤ä¸ªç‚¹ + &lt; + end è¡¨ç¤ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ aRange.from ä¸ aRange.to æ¥è·å¯¹åº”çš„è¾¹ç•Œå…ƒç´ </strong>ï¼Œå®é™…æ“ä½œæ„Ÿå—ä¸€ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªä¸¤ç«¯éƒ½æ˜¯é—­åŒºé—´çš„èŒƒå›´</span><br><span class="hljs-keyword">def</span> range = <span class="hljs-number">1.</span><span class="hljs-number">.10</span><br>range.each &#123;<br>    print it + <span class="hljs-string">&quot; &quot;</span><br>&#125;<br><span class="hljs-comment">//æ‰“å°å€¼</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">10</span><br><br><span class="hljs-comment">//å¦‚æœä¸æƒ³åŒ…å«æœ€åä¸€ä¸ªå…ƒç´ </span><br><span class="hljs-keyword">def</span> range1 = <span class="hljs-number">1.</span>.&lt;<span class="hljs-number">10</span><br>range1.each &#123;<br>    print it + <span class="hljs-string">&quot; &quot;</span><br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span><br><br><span class="hljs-comment">//æ‰“å°å¤´å°¾è¾¹ç•Œå…ƒç´ </span><br>println <span class="hljs-string">&quot;$range1.from $range1.to&quot;</span><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">9</span><br></code></pre></td></tr></table></figure><h2 id="å…­ã€Groovy-æ–‡ä»¶å¤„ç†"><a href="#å…­ã€Groovy-æ–‡ä»¶å¤„ç†" class="headerlink" title="å…­ã€Groovy æ–‡ä»¶å¤„ç†"></a>å…­ã€Groovy æ–‡ä»¶å¤„ç†</h2><h3 id="1ã€IO"><a href="#1ã€IO" class="headerlink" title="1ã€IO"></a>1ã€IO</h3><p>ä¸€äº› IO å¸¸ç”¨çš„ Api æ“ä½œï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šä»£ç çœ‹æ•ˆæœï¼Œä»£ç ä¼šå†™ä¸Šæ¸…æ™°çš„æ³¨é‡Šï¼š</p><p>å‡†å¤‡å·¥ä½œï¼šæˆ‘åœ¨å½“å‰è„šæœ¬æ–‡ä»¶çš„åŒçº§ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª testFile.txt æ–‡ä»¶ï¼Œé‡Œé¢éšä¾¿å…ˆå†™å…¥ä¸€äº›å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e0faeb77e2cc4e6eb42d3810dadf6d82~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210312144116084"></p><p>ä¸‹é¢æˆ‘ä»¬å¼€å§‹æ¥æ“ä½œè¿™ä¸ªæ–‡ä»¶ï¼Œä¸ºäº†é—­åŒ…çš„å¯è¯»æ€§ï¼Œæˆ‘ä¼šåœ¨é—­åŒ…ä¸ŠåŠ ä¸Šç±»å‹å’Œå‚æ•°ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//-------------------------------1ã€æ–‡ä»¶å®šä½ --------------------------------</span><br><span class="hljs-keyword">def</span> file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&#x27;testFile.txt&#x27;</span>)<br><br><span class="hljs-comment">//-----------------------2ã€ä½¿ç”¨ eachLine Api æ¯æ¬¡è¯»å–ä¸€è¡Œ, é—­åŒ…å‚æ•°æ˜¯æ¯ä¸€è¡Œçš„å­—ç¬¦ä¸²------------</span><br>file.eachLine &#123; String line -&gt;<br>    println line<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br>erdai777<br>erdai888<br><br><span class="hljs-comment">//------------------------3ã€è·å–è¾“å…¥æµ,è¾“å‡ºæµè¯»æ–‡ä»¶å’Œå†™æ–‡ä»¶---------------------------------</span><br><span class="hljs-comment">//è·å–è¾“å…¥æµè¯»å–æ–‡ä»¶çš„æ¯ä¸€è¡Œ</span><br><span class="hljs-comment">//1</span><br>file.withInputStream &#123; InputStream inputStream -&gt;<br>    inputStream.eachLine &#123; String it -&gt;<br>        println it<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2</span><br>file.withReader &#123; BufferedReader it -&gt;<br>    it.readLines().each &#123; String it -&gt;<br>        println it<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br>erdai777<br>erdai888<br><br><span class="hljs-comment">//è·å–è¾“å‡ºæµå°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ ä¸‹é¢è¿™ä¸¤ç§æ–¹å¼å†™å…¥çš„æ–‡ä»¶å†…å®¹ä¼šæŠŠä¹‹å‰çš„å†…å®¹ç»™è¦†ç›–</span><br><span class="hljs-comment">//1</span><br>file.withOutputStream &#123; OutputStream outputStream -&gt;<br>    outputStream.write(<span class="hljs-string">&quot;erdai999&quot;</span>.getBytes())<br>&#125;<br><br><span class="hljs-comment">//2</span><br>file.withWriter &#123; BufferedWriter it -&gt;<br>    it.write(<span class="hljs-string">&#x27;erdai999&#x27;</span>)<br>&#125;<br><br><span class="hljs-comment">//------------------------4ã€é€šè¿‡è¾“å…¥è¾“å‡ºæµå®ç°æ–‡ä»¶æ‹·è´åŠŸèƒ½---------------------------------</span><br><span class="hljs-comment">//1ã€é€šè¿‡ withOutputStream withInputStream å®ç°æ–‡ä»¶æ‹·è´</span><br><span class="hljs-keyword">def</span> targetFile = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&#x27;testFile1.txt&#x27;</span>)<br>targetFile.withOutputStream &#123; OutputStream outputStream -&gt;<br>    file.withInputStream &#123; InputStream inputStream -&gt;<br>        outputStream &lt;&lt; inputStream<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€é€šè¿‡ withReaderã€withWriter å®ç°æ–‡ä»¶æ‹·è´</span><br>targetFile.withWriter &#123;BufferedWriter bufferedWriter -&gt;<br>    file.withReader &#123;BufferedReader bufferedReader -&gt;<br>        bufferedReader.eachLine &#123;String line -&gt;<br>            bufferedWriter.write(line + <span class="hljs-string">&quot;\r\n&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€XML-æ–‡ä»¶æ“ä½œ"><a href="#2ã€XML-æ–‡ä»¶æ“ä½œ" class="headerlink" title="2ã€XML æ–‡ä»¶æ“ä½œ"></a>2ã€XML æ–‡ä»¶æ“ä½œ</h3><h4 id="1ï¼‰ã€è§£æ-XML-æ–‡ä»¶"><a href="#1ï¼‰ã€è§£æ-XML-æ–‡ä»¶" class="headerlink" title="1ï¼‰ã€è§£æ XML æ–‡ä»¶"></a>1ï¼‰ã€è§£æ XML æ–‡ä»¶</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¸¦æ ¼å¼çš„ xml å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">def</span> xml = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    &lt;response&gt;</span><br><span class="hljs-string">        &lt;value&gt;</span><br><span class="hljs-string">            &lt;books id=&quot;1&quot; classification=&quot;android&quot;&gt;</span><br><span class="hljs-string">                &lt;book available=&quot;14&quot; id=&quot;2&quot;&gt;</span><br><span class="hljs-string">                   &lt;title&gt;ç¬¬ä¸€è¡Œä»£ç &lt;/title&gt;</span><br><span class="hljs-string">                   &lt;author id=&quot;2&quot;&gt;éƒ­éœ–&lt;/author&gt;</span><br><span class="hljs-string">               &lt;/book&gt;</span><br><span class="hljs-string">               &lt;book available=&quot;13&quot; id=&quot;3&quot;&gt;</span><br><span class="hljs-string">                   &lt;title&gt;Androidå¼€å‘è‰ºæœ¯æ¢ç´¢&lt;/title&gt;</span><br><span class="hljs-string">                   &lt;author id=&quot;3&quot;&gt;ä»»ç‰åˆš&lt;/author&gt;</span><br><span class="hljs-string">               &lt;/book&gt;</span><br><span class="hljs-string">           &lt;/books&gt;</span><br><span class="hljs-string">       &lt;/value&gt;</span><br><span class="hljs-string">    &lt;/response&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment">//åˆ›å»º XmlSlurper ç±»å¯¹è±¡ï¼Œè§£æ XML æ–‡ä»¶ä¸»è¦å€ŸåŠ© XmlSlurper è¿™ä¸ªç±»</span><br><span class="hljs-keyword">def</span> xmlSlurper = <span class="hljs-keyword">new</span> XmlSlurper()<br><span class="hljs-comment">//è§£æ mxl è¿”å› response æ ¹ç»“ç‚¹å¯¹è±¡</span><br><span class="hljs-keyword">def</span> response = xmlSlurper.parseText(xml)<br><span class="hljs-comment">//æ‰“å°ä¸€äº›ç»“æœ</span><br>println response.value.books[<span class="hljs-number">0</span>].book[<span class="hljs-number">0</span>].title.text()<br>println response.value.books[<span class="hljs-number">0</span>].book[<span class="hljs-number">0</span>].author.text()<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç¬¬ä¸€è¡Œä»£ç <br>éƒ­éœ–<br><br><span class="hljs-comment">//1ã€ä½¿ç”¨è¿­ä»£å™¨è§£æ</span><br>response.value.books.each&#123; books -&gt;<br>    books.book.each&#123; book -&gt;<br>        println book.title<br>        println book.author <br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç¬¬ä¸€è¡Œä»£ç <br>éƒ­éœ–<br>Androidå¼€å‘è‰ºæœ¯æ¢ç´¢<br>ä»»ç‰åˆš<br><br><span class="hljs-comment">//2ã€æ·±åº¦éå† XML æ•°æ®</span><br><span class="hljs-keyword">def</span> str1 = response.depthFirst().findAll &#123; book -&gt;<br>    <span class="hljs-keyword">return</span> book.author == <span class="hljs-string">&#x27;éƒ­éœ–&#x27;</span><br>&#125;<br>println str1<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[ç¬¬ä¸€è¡Œä»£ç éƒ­éœ–]<br><br><span class="hljs-comment">//3ã€å¹¿åº¦éå† XML æ•°æ®</span><br><span class="hljs-keyword">def</span> str2 = response.value.books.children().findAll&#123; node -&gt;<br>    node.name() == <span class="hljs-string">&#x27;book&#x27;</span> &amp;&amp; node.<span class="hljs-meta">@id</span> == <span class="hljs-string">&#x27;2&#x27;</span><br>&#125;.collect &#123; node -&gt;<br>    <span class="hljs-string">&quot;$node.title $node.author&quot;</span><br>&#125;<br>println str2<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[ç¬¬ä¸€è¡Œä»£ç  éƒ­éœ–]<br></code></pre></td></tr></table></figure><h4 id="2-ã€ç”Ÿæˆ-XML-æ–‡ä»¶"><a href="#2-ã€ç”Ÿæˆ-XML-æ–‡ä»¶" class="headerlink" title="2)ã€ç”Ÿæˆ XML æ–‡ä»¶"></a>2)ã€ç”Ÿæˆ XML æ–‡ä»¶</h4><p>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ XmlSlurper è¿™ä¸ªç±»è§£æäº† XMLï¼Œç°åœ¨æˆ‘ä»¬å€ŸåŠ© MarkupBuilder æ¥ç”Ÿæˆ XML ,ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * &lt;response&gt;</span><br><span class="hljs-comment"> *      &lt;value&gt;</span><br><span class="hljs-comment"> *          &lt;books id=&quot;1&quot; classification=&quot;android&quot;&gt;</span><br><span class="hljs-comment"> *              &lt;book available=&quot;14&quot; id=&quot;2&quot;&gt;</span><br><span class="hljs-comment"> *                 &lt;title&gt;ç¬¬ä¸€è¡Œä»£ç &lt;/title&gt;</span><br><span class="hljs-comment"> *                 &lt;author id=&quot;2&quot;&gt;éƒ­éœ–&lt;/author&gt;</span><br><span class="hljs-comment"> *             &lt;/book&gt;</span><br><span class="hljs-comment"> *             &lt;book available=&quot;13&quot; id=&quot;3&quot;&gt;</span><br><span class="hljs-comment"> *                 &lt;title&gt;Androidå¼€å‘è‰ºæœ¯æ¢ç´¢&lt;/title&gt;</span><br><span class="hljs-comment"> *                 &lt;author id=&quot;3&quot;&gt;ä»»ç‰åˆš&lt;/author&gt;</span><br><span class="hljs-comment"> *             &lt;/book&gt;</span><br><span class="hljs-comment"> *         &lt;/books&gt;</span><br><span class="hljs-comment"> *     &lt;/value&gt;</span><br><span class="hljs-comment"> * &lt;/response&gt;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">//æ–¹å¼1ï¼šé€šè¿‡ä¸‹é¢è¿™ç§æ–¹å¼ å°±å¯ä»¥å®ç°ä¸Šé¢çš„æ•ˆæœï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æœ‰ä¸ªå¼Šç«¯ï¼Œæ•°æ®éƒ½æ˜¯å†™æ­»çš„</span><br><span class="hljs-keyword">def</span> sw = <span class="hljs-keyword">new</span> StringWriter()<br><span class="hljs-keyword">def</span> xmlBuilder = <span class="hljs-keyword">new</span> MarkupBuilder(sw)<br>xmlBuilder.response&#123;<br>    value&#123;<br>        books(<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-attr">classification:</span> <span class="hljs-string">&#x27;android&#x27;</span>)&#123;<br>            book(<span class="hljs-attr">available:</span> <span class="hljs-string">&#x27;14&#x27;</span>,<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;2&#x27;</span>)&#123;<br>                title(<span class="hljs-string">&#x27;ç¬¬ä¸€è¡Œä»£ç &#x27;</span>)<br>                author(<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;2&#x27;</span> ,<span class="hljs-string">&#x27;éƒ­éœ–&#x27;</span>)<br>            &#125;<br>            book(<span class="hljs-attr">available:</span> <span class="hljs-string">&#x27;13&#x27;</span>,<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;3&#x27;</span>)&#123;<br>                title(<span class="hljs-string">&#x27;Androidå¼€å‘è‰ºæœ¯æ¢ç´¢&#x27;</span>)<br>                author(<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;3&#x27;</span> ,<span class="hljs-string">&#x27;ä»»ç‰åˆš&#x27;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>println sw<br><br><span class="hljs-comment">//æ–¹å¼2ï¼šå°† XML æ•°æ®å¯¹åº”åˆ›å»ºç›¸åº”çš„æ•°æ®æ¨¡å‹ï¼Œå°±åƒæˆ‘ä»¬è§£æ Json åˆ›å»ºç›¸åº”çš„æ•°æ®æ¨¡å‹æ˜¯ä¸€æ ·çš„</span><br><span class="hljs-comment">//åˆ›å»º XML å¯¹åº”æ•°æ®æ¨¡å‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Response</span> &#123;<br>    <br>    <span class="hljs-keyword">def</span> value = <span class="hljs-keyword">new</span> Value()<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Value</span> &#123;<br><br>        <span class="hljs-keyword">def</span> books = <span class="hljs-keyword">new</span> Books(<span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-attr">classification:</span> <span class="hljs-string">&#x27;android&#x27;</span>)<br><br>        <span class="hljs-keyword">class</span> <span class="hljs-title class_">Books</span> &#123;<br>            <span class="hljs-keyword">def</span> id<br>            <span class="hljs-keyword">def</span> classification<br>            <span class="hljs-keyword">def</span> book = [<span class="hljs-keyword">new</span> Book(<span class="hljs-attr">available:</span> <span class="hljs-string">&#x27;14&#x27;</span>, <span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-attr">title:</span> <span class="hljs-string">&#x27;ç¬¬ä¸€è¡Œä»£ç &#x27;</span>, <span class="hljs-attr">authorId:</span> <span class="hljs-number">2</span>, <span class="hljs-attr">author:</span> <span class="hljs-string">&#x27;éƒ­éœ–&#x27;</span>),<br>               <span class="hljs-keyword">new</span> Book(<span class="hljs-attr">available:</span> <span class="hljs-string">&#x27;13&#x27;</span>, <span class="hljs-attr">id:</span> <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-attr">title:</span> <span class="hljs-string">&#x27;Androidå¼€å‘è‰ºæœ¯æ¢ç´¢&#x27;</span>, <span class="hljs-attr">authorId:</span> <span class="hljs-number">3</span>, <span class="hljs-attr">author:</span> <span class="hljs-string">&#x27;ä»»ç‰åˆš&#x27;</span>)]<br><br>            <span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span> &#123;<br>                <span class="hljs-keyword">def</span> available<br>                <span class="hljs-keyword">def</span> id<br>                <span class="hljs-keyword">def</span> title<br>                <span class="hljs-keyword">def</span> authorId<br>                <span class="hljs-keyword">def</span> author<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//åˆ›å»º response å¯¹è±¡</span><br><span class="hljs-keyword">def</span> response = <span class="hljs-keyword">new</span> Response()<br><span class="hljs-comment">//æ„å»º XML </span><br>xmlBuilder.response&#123;<br>    value&#123;<br>        books(<span class="hljs-attr">id:</span> response.value.books.id,<span class="hljs-attr">classification:</span> response.value.books.classification)&#123;<br>            response.value.books.book.each&#123;<br>                <span class="hljs-keyword">def</span> book1 = it<br>                book(<span class="hljs-attr">available:</span> it.available,<span class="hljs-attr">id:</span> it.id)&#123;<br>                    title(book1.title)<br>                    author(<span class="hljs-attr">authorId:</span> book1.authorId,book1.author)<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>println sw<br></code></pre></td></tr></table></figure><h3 id="3ã€Json-è§£æ"><a href="#3ã€Json-è§£æ" class="headerlink" title="3ã€Json è§£æ"></a>3ã€Json è§£æ</h3><p>Jsonè§£æä¸»è¦æ˜¯é€šè¿‡ JsonSlurper è¿™ä¸ªç±»å®ç°çš„ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å†™æ’ä»¶çš„æ—¶å€™å°±ä¸éœ€è¦é¢å¤–å¼•å…¥ç¬¬ä¸‰æ–¹çš„ Json è§£æåº“äº†ï¼Œå…¶ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-comment">//å‘é€è¯·æ±‚è·å–æœåŠ¡å™¨å“åº”çš„æ•°æ®</span><br><span class="hljs-keyword">def</span> response = getNetWorkData(<span class="hljs-string">&quot;https://www.wanandroid.com/banner/json&quot;</span>)<br>println response.data[<span class="hljs-number">0</span>].desc<br>println response.data[<span class="hljs-number">0</span>].imagePath<br><br><span class="hljs-keyword">def</span> getNetWorkData(String url)&#123;<br>    <span class="hljs-keyword">def</span> connect = <span class="hljs-keyword">new</span> URL(url).openConnection()<br>    connect.setRequestMethod(<span class="hljs-string">&quot;GET&quot;</span>)<br>    <span class="hljs-comment">//è¿™ä¸ªä¼šé˜»å¡çº¿ç¨‹ åœ¨Androidä¸­ä¸èƒ½è¿™æ ·æ“ä½œ ä½†æ˜¯åœ¨æ¡Œé¢ç¨‹åºæ˜¯å¯ä»¥çš„</span><br>    connect.connect()<br>    <span class="hljs-keyword">def</span> response = connect.content.text<br><br>    <span class="hljs-comment">//jsonè½¬å®ä½“å¯¹è±¡</span><br>    <span class="hljs-keyword">def</span> jsonSlurper = <span class="hljs-keyword">new</span> JsonSlurper()<br>    jsonSlurper.parseText(response)<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ‰”ç‰©çº¿<br><span class="hljs-attr">https:</span><span class="hljs-comment">//wanandroid.com/blogimgs/8a0131ac-05b7-4b6c-a8d0-f438678834ba.png</span><br></code></pre></td></tr></table></figure><h2 id="7ã€æ€»ç»“"><a href="#7ã€æ€»ç»“" class="headerlink" title="7ã€æ€»ç»“"></a>7ã€æ€»ç»“</h2><p>åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»äº†ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><p>1ã€ä¸€äº›å…³äº Gradle ï¼ŒGroovy çš„é—®é¢˜</p><p>2ã€æ­å»º Groovy å¼€å‘ç¯å¢ƒï¼Œåˆ›å»ºä¸€ä¸ª Groovy å·¥ç¨‹</p><p>3ã€è®²è§£äº† Groovy çš„ä¸€äº›åŸºç¡€è¯­æ³•</p><p>4ã€å¯¹é—­åŒ…è¿›è¡Œäº†æ·±å…¥çš„è®²è§£</p><p>5ã€è®²è§£äº† Groovy ä¸­çš„æ•°æ®ç»“æ„å’Œå¸¸ç”¨ Api ä½¿ç”¨ï¼Œå¹¶ä»¥ Map ä¸¾ä¾‹ï¼ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£å»ç¡®å®š Api çš„ä½¿ç”¨å’Œé—­åŒ…çš„å‚æ•°</p><p>6ã€è®²è§£äº† Groovy æ–‡ä»¶ç›¸å…³çš„å¤„ç†</p><p>å­¦ä¹ äº† Groovy ï¼Œå¯¹äºæˆ‘ä»¬åç»­è‡ªå®šä¹‰ Gradle æ’ä»¶è¿ˆå‡ºäº†å…³é”®çš„ä¸€æ­¥ã€‚å…¶æ¬¡å¦‚æœä½ å­¦ä¹ è¿‡ Kotlin ï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒä»¬çš„è¯­æ³•éå¸¸çš„ç±»ä¼¼ï¼Œå› æ­¤å¯¹äºåç»­å­¦ä¹  Kotlin æˆ‘ä»¬ä¹Ÿå¯ä»¥å¿«é€Ÿå»ä¸Šæ‰‹ã€‚</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6844904128594853902#heading-87">æ·±åº¦æ¢ç´¢ Gradle è‡ªåŠ¨åŒ–æ„å»ºæŠ€æœ¯ï¼ˆäºŒã€Groovy ç­‘åŸºç¯‡</a></p><p><a href="https://juejin.cn/post/6888977881679495175#heading-0">Gradle çˆ¬å‘æŒ‡å— â€“ æ¦‚å¿µåˆè§£ã€Grovvy è¯­æ³•ã€å¸¸è§ API</a></p><p><a href="https://yanbober.blog.csdn.net/article/details/109560923">Groovy æœ¬è´¨åˆæ¢åŠé—­åŒ…ç‰¹æ€§åŸç†æ€»ç»“</a></p><p><a href="https://blog.csdn.net/singwhatiwanna/article/details/76084580">Gradleä»å…¥é—¨åˆ°å®æˆ˜ - GroovyåŸºç¡€</a></p><p><a href="https://coding.imooc.com/class/206.html#Anchor">æ…•è¯¾ç½‘ä¹‹Gradle3.0è‡ªåŠ¨åŒ–é¡¹ç›®æ„å»ºæŠ€æœ¯ç²¾è®²+å®æˆ˜</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Gradle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APT ç³»åˆ— ï¼ˆå››ï¼‰ï¼šAPT å®æˆ˜åº”ç”¨</title>
    <link href="/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9AAPT%20%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/"/>
    <url>/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9AAPT%20%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e512d8f772004386b721956bfccb2e71~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹ APT æŠ€æœ¯è¿›è¡Œäº†è®²è§£ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6978500975770206239">Android APT ç³»åˆ— ï¼ˆä¸‰ï¼‰ï¼šAPT æŠ€æœ¯æ¢ç©¶</a>ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨ APT æŠ€æœ¯æ¥è¿›è¡Œå®æˆ˜åº”ç”¨ã€‚</p><p><a href="https://github.com/sweetying520/AptDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥çœ‹ Demo è·Ÿéšæˆ‘çš„æ€è·¯ä¸€èµ·åˆ†æ</p><h2 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h2><p>åœ¨æœ¬ç³»åˆ—çš„å¼€ç¯‡ï¼Œæˆ‘è®²äº†åœ¨é¡¹ç›®å®è·µè¿‡ç¨‹ä¸­åšçš„ä¸€ä¸ªå¸ƒå±€ä¼˜åŒ–ï¼ŒAndroid ä¸­å°‘é‡çš„ç³»ç»Ÿæ§ä»¶æ˜¯é€šè¿‡ <code>new</code> çš„æ–¹å¼åˆ›å»ºå‡ºæ¥çš„ï¼Œè€Œå¤§éƒ¨åˆ†æ§ä»¶å¦‚ <code>androidx.appcompat.widget</code> ä¸‹çš„æ§ä»¶ï¼Œè‡ªå®šä¹‰æ§ä»¶ï¼Œç¬¬ä¸‰æ–¹æ§ä»¶ç­‰ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡åå°„åˆ›å»ºçš„ã€‚å¤§é‡çš„åå°„åˆ›å»ºå¤šå¤šå°‘å°‘ä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å»è§£å†³åå°„åˆ›å»ºçš„é—®é¢˜ï¼Œæˆ‘çš„è§£å†³æ€è·¯æ˜¯ï¼š</p><blockquote><p>1ã€é€šè¿‡ç¼–å†™ Android æ’ä»¶è·å– Xml å¸ƒå±€ä¸­çš„æ‰€æœ‰æ§ä»¶ </p><p>2ã€æ‹¿åˆ°æ§ä»¶åï¼Œé€šè¿‡ APT ç”Ÿæˆç”¨ <code>new</code> çš„æ–¹å¼åˆ›å»º View çš„ç±» </p><p>3ã€æœ€åé€šè¿‡åå°„è·å–å½“å‰ç±»å¹¶åœ¨åŸºç±»é‡Œé¢å®Œæˆæ›¿æ¢</p></blockquote><h2 id="ä¸€ã€å‡†å¤‡-Android-æ’ä»¶ç”Ÿæˆçš„æ–‡ä»¶"><a href="#ä¸€ã€å‡†å¤‡-Android-æ’ä»¶ç”Ÿæˆçš„æ–‡ä»¶" class="headerlink" title="ä¸€ã€å‡†å¤‡ Android æ’ä»¶ç”Ÿæˆçš„æ–‡ä»¶"></a>ä¸€ã€å‡†å¤‡ Android æ’ä»¶ç”Ÿæˆçš„æ–‡ä»¶</h2><p>å…¶ä¸­ 1 çš„å…·ä½“æµç¨‹æ˜¯ï¼šé€šè¿‡ Android æ’ä»¶è·å–æ‰€æœ‰ Xml å¸ƒå±€ä¸­çš„æ§ä»¶åç§°ï¼Œå¹¶å†™å…¥åˆ°ä¸€ä¸ª<code>.txt</code>æ–‡ä»¶ä¸­ï¼Œå›  Gradle ç³»åˆ—è¿˜æ²¡è®²ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„æ§ä»¶åç§°å·²ç»å†™å…¥åˆ°<code>.txt</code>æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d18efb79eeed4538b4ac115e272c36f5~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210629191446005"></p><p>ä¸Šè¿°æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><p>1ã€ä¸€äº›ä¸å¸¦ <code>.</code> çš„ç³»ç»Ÿæ§ä»¶ï¼Œå¦‚ TextViewï¼ŒImageView ã€‚ç³»ç»Ÿä¼šé»˜è®¤ç»™æˆ‘ä»¬é€šè¿‡ <code>new</code> çš„æ–¹å¼å»åˆ›å»ºï¼Œä¸”æ›¿æ¢ä¸ºäº†<code>androidx.appcompat.widget</code>åŒ…ä¸‹çš„æ§ä»¶ï¼Œä¾‹å¦‚ï¼šTextView -&gt; AppCompatTextView ï¼ŒImageView -&gt; AppCompatImageView </p><p>2ã€å¸¦ <code>.</code> çš„æ§ä»¶ã€‚å¯èƒ½ä¸º <code>androidx.appcompat.widget</code> ä¸‹çš„æ§ä»¶ï¼Œè‡ªå®šä¹‰æ§ä»¶ï¼Œç¬¬ä¸‰æ–¹æ§ä»¶ç­‰ç­‰ï¼Œè¿™äº›æ§ä»¶å¦‚æœæˆ‘ä»¬ä¸åšå¤„ç†ï¼Œç³»ç»Ÿä¼šé€šè¿‡åå°„å»åˆ›å»ºã€‚å› æ­¤æˆ‘ä»¬ä¸»è¦æ˜¯é’ˆå¯¹è¿™äº›æ§ä»¶å»åšå¤„ç†</p><p><strong>æ³¨æ„</strong>ï¼šæˆ‘è¿™é‡Œåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ª <code>all_view_name.txt</code> çš„æ–‡ä»¶ï¼Œç„¶åæ”¾å…¥äº†ä¸€äº› View çš„åç§°ï¼Œè¿™é‡Œåªæ˜¯æ–¹ä¾¿æˆ‘ä»¬æ¼”ç¤ºã€‚å®é™…ä¸Šç”¨ Android æ’ä»¶å»ç”Ÿæˆçš„æ–‡ä»¶æˆ‘ä»¬ä¸€èˆ¬ä¼šæŒ‡å®šæ”¾åœ¨ app çš„ <code>/build</code>ç›®å½•ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ clean çš„æ—¶å€™å°±èƒ½é¡ºå¸¦æŠŠå®ƒç»™å¹²æ‰</p><p>ç°åœ¨ 1 å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥ 2 å’Œ 3 å°±å›åˆ°äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„ APT æµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦è¯»å–è¯¥æ–‡ä»¶ï¼Œé€šè¿‡ APT ç”Ÿæˆç›¸åº”çš„ç±»ï¼Œæœ€åä½¿ç”¨è¿™ä¸ªç±»çš„åŠŸèƒ½å°± OK äº†ï¼Œè¿˜ä¸ç†Ÿæ‚‰ APT çš„ï¼Œå…ˆå»å­¦ä¹ ä¸€æ³¢ <a href="https://juejin.cn/post/6978500975770206239">ä¼ é€é—¨</a> </p><p>è¿˜æ˜¯åŸºäºä¸Šç¯‡æ–‡ç« çš„å·¥ç¨‹è¿›è¡Œå®æ“ï¼Œä¸ºäº†æ–¹ä¾¿åç»­æµç¨‹çš„è®²è§£ï¼Œæˆ‘è¿˜æ˜¯è´´å‡ºä¸Šç¯‡æ–‡ç« çš„å·¥ç¨‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9ab51732570425eaf4c8ddebe921875~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210627182425586"></p><h2 id="äºŒã€apt-annotation-æ³¨è§£ç¼–å†™"><a href="#äºŒã€apt-annotation-æ³¨è§£ç¼–å†™" class="headerlink" title="äºŒã€apt-annotation æ³¨è§£ç¼–å†™"></a>äºŒã€apt-annotation æ³¨è§£ç¼–å†™</h2><p>ç¼–å†™æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.CLASS)</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> ViewCreator &#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€è§„å®šç”Ÿæˆçš„ç±»æ¨¡ç‰ˆï¼Œä¸ºåç»­è‡ªåŠ¨ç”Ÿæˆä»£ç åšå‡†å¤‡"><a href="#ä¸‰ã€è§„å®šç”Ÿæˆçš„ç±»æ¨¡ç‰ˆï¼Œä¸ºåç»­è‡ªåŠ¨ç”Ÿæˆä»£ç åšå‡†å¤‡" class="headerlink" title="ä¸‰ã€è§„å®šç”Ÿæˆçš„ç±»æ¨¡ç‰ˆï¼Œä¸ºåç»­è‡ªåŠ¨ç”Ÿæˆä»£ç åšå‡†å¤‡"></a>ä¸‰ã€è§„å®šç”Ÿæˆçš„ç±»æ¨¡ç‰ˆï¼Œä¸ºåç»­è‡ªåŠ¨ç”Ÿæˆä»£ç åšå‡†å¤‡</h2><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šè¿™ä¹ˆåšï¼š</p><p>1ã€å°†éœ€è¦ç”Ÿæˆçš„ç±»æ–‡ä»¶å®ç°æŸä¸ªå®šä¹‰å¥½çš„æ¥å£ï¼Œé€šè¿‡æ¥å£ä»£ç†æ¥ä½¿ç”¨</p><p>2ã€è§„å®šç”Ÿæˆçš„ Java ç±»æ¨¡ç‰ˆï¼Œæ ¹æ®æ¨¡ç‰ˆå»è¿›è¡Œç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™</p><h3 id="1ã€å°†éœ€è¦ç”Ÿæˆçš„ç±»æ–‡ä»¶å®ç°æŸä¸ªå®šä¹‰å¥½çš„æ¥å£ï¼Œé€šè¿‡æ¥å£ä»£ç†æ¥ä½¿ç”¨"><a href="#1ã€å°†éœ€è¦ç”Ÿæˆçš„ç±»æ–‡ä»¶å®ç°æŸä¸ªå®šä¹‰å¥½çš„æ¥å£ï¼Œé€šè¿‡æ¥å£ä»£ç†æ¥ä½¿ç”¨" class="headerlink" title="1ã€å°†éœ€è¦ç”Ÿæˆçš„ç±»æ–‡ä»¶å®ç°æŸä¸ªå®šä¹‰å¥½çš„æ¥å£ï¼Œé€šè¿‡æ¥å£ä»£ç†æ¥ä½¿ç”¨"></a>1ã€å°†éœ€è¦ç”Ÿæˆçš„ç±»æ–‡ä»¶å®ç°æŸä¸ªå®šä¹‰å¥½çš„æ¥å£ï¼Œé€šè¿‡æ¥å£ä»£ç†æ¥ä½¿ç”¨</h3><p>å…³äºæ¥å£ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæ”¾åˆ° <code>apt-api</code> è¿™ä¸ª Module ä¸­</p><h3 id="2ã€è§„å®šç”Ÿæˆçš„-Java-ç±»æ¨¡ç‰ˆï¼Œæ ¹æ®æ¨¡ç‰ˆå»è¿›è¡Œç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™"><a href="#2ã€è§„å®šç”Ÿæˆçš„-Java-ç±»æ¨¡ç‰ˆï¼Œæ ¹æ®æ¨¡ç‰ˆå»è¿›è¡Œç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™" class="headerlink" title="2ã€è§„å®šç”Ÿæˆçš„ Java ç±»æ¨¡ç‰ˆï¼Œæ ¹æ®æ¨¡ç‰ˆå»è¿›è¡Œç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™"></a>2ã€è§„å®šç”Ÿæˆçš„ Java ç±»æ¨¡ç‰ˆï¼Œæ ¹æ®æ¨¡ç‰ˆå»è¿›è¡Œç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦ç”Ÿæˆçš„ Java ç±»æ¨¡ç‰ˆå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.dream.aptdemo;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewCreatorImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMyViewCreator</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> View <span class="hljs-title function_">createView</span><span class="hljs-params">(String name, Context context, AttributeSet attr)</span> &#123;<br>    <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">switch</span>(name) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;androidx.core.widget.NestedScrollView&quot;</span>:<br>      view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NestedScrollView</span>(context,attr);<br>      <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;androidx.constraintlayout.widget.ConstraintLayout&quot;</span>:<br>      view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstraintLayout</span>(context,attr);<br>      <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;androidx.appcompat.widget.ButtonBarLayout&quot;</span>:<br>      view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ButtonBarLayout</span>(context,attr);<br>      <span class="hljs-keyword">break</span>;<br>        <span class="hljs-comment">//...</span><br>      <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> view;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè‡ªåŠ¨ç”Ÿæˆä»£ç é€»è¾‘çš„ç¼–å†™äº†</p><h2 id="å››ã€apt-processor-è‡ªåŠ¨ç”Ÿæˆä»£ç "><a href="#å››ã€apt-processor-è‡ªåŠ¨ç”Ÿæˆä»£ç " class="headerlink" title="å››ã€apt-processor è‡ªåŠ¨ç”Ÿæˆä»£ç "></a>å››ã€apt-processor è‡ªåŠ¨ç”Ÿæˆä»£ç </h2><p>è¿™é‡Œä½ å°±å¯¹ç€ä¸Šé¢ç»™å‡ºçš„ä»£ç æ¨¡ç‰ˆï¼Œé€šè¿‡ javapoet æ¡†æ¶ç¼–å†™ç›¸åº”çš„ä»£ç ç”Ÿæˆé€»è¾‘å³å¯ï¼Œå¯¹ <code>javapoet</code> ä¸ç†Ÿçš„èµ¶ç´§å»å­¦ä¹ ä¸€æ³¢ <a href="https://github.com/square/javapoet">ä¼ é€é—¨</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AutoService(Processor.class)</span><br><span class="hljs-meta">@SupportedAnnotationTypes(&quot;com.dream.apt_annotation.ViewCreator&quot;)</span><br><span class="hljs-meta">@SupportedSourceVersion(SourceVersion.RELEASE_8)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewCreatorProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br><br>    <span class="hljs-comment">/**æ–‡ä»¶ç”Ÿæˆå™¨*/</span><br>    <span class="hljs-keyword">private</span> Filer mFiler;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(ProcessingEnvironment processingEnv)</span> &#123;<br>        <span class="hljs-built_in">super</span>.init(processingEnv);<br>        mFiler = processingEnv.getFiler();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv)</span> &#123;<br>        <span class="hljs-comment">//ä»æ–‡ä»¶ä¸­è¯»å–æ§ä»¶åç§°ï¼Œå¹¶è½¬æ¢æˆå¯¹åº”çš„é›†åˆ</span><br>        Set&lt;String&gt; mViewNameSet = readViewNameFromFile();<br>        <span class="hljs-comment">//å¦‚æœè·å–çš„æ§ä»¶åç§°é›†åˆä¸ºç©ºï¼Œåˆ™ç»ˆæ­¢æµç¨‹</span><br>        <span class="hljs-keyword">if</span>(mViewNameSet == <span class="hljs-literal">null</span> || mViewNameSet.isEmpty())&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>      <br>        <span class="hljs-comment">//è·å–ä½¿ç”¨äº†æ³¨è§£çš„å…ƒç´ </span><br>        Set&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&gt; elementsAnnotatedWith = roundEnv.getElementsAnnotatedWith(ViewCreator.class);<br>        <span class="hljs-keyword">for</span> (Element element : elementsAnnotatedWith) &#123;<br>            System.out.println(<span class="hljs-string">&quot;Hello &quot;</span> + element.getSimpleName() + <span class="hljs-string">&quot;, æ¬¢è¿ä½¿ç”¨ APT&quot;</span>);<br>            startGenerateCode(mViewNameSet);<br>            <span class="hljs-comment">//å¦‚æœæœ‰å¤šä¸ªåœ°æ–¹æ ‡æ³¨äº†æ³¨è§£ï¼Œæˆ‘ä»¬åªè¯»å–ç¬¬ä¸€æ¬¡çš„å°±è¡Œäº†</span><br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼€å§‹æ‰§è¡Œç”Ÿæˆä»£ç çš„é€»è¾‘</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> mViewNameSet æ§ä»¶åç§°é›†åˆ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startGenerateCode</span><span class="hljs-params">(Set&lt;String&gt; mViewNameSet)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹ç”Ÿæˆ Java ç±»...&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;a few moment later...&quot;</span>);<br>        <span class="hljs-comment">//=================================== æ„å»ºæ–¹æ³• start ======================================</span><br>        <span class="hljs-comment">//1ã€æ„å»ºæ–¹æ³•ï¼šæ–¹æ³•åï¼Œæ³¨è§£ï¼Œä¿®é¥°ç¬¦ï¼Œè¿”å›å€¼ï¼Œå‚æ•°</span><br><br>        <span class="hljs-type">ClassName</span> <span class="hljs-variable">viewType</span> <span class="hljs-operator">=</span> ClassName.get(<span class="hljs-string">&quot;android.view&quot;</span>,<span class="hljs-string">&quot;View&quot;</span>);<br>        MethodSpec.<span class="hljs-type">Builder</span> <span class="hljs-variable">methodBuilder</span> <span class="hljs-operator">=</span> MethodSpec<br>                <span class="hljs-comment">//æ–¹æ³•å</span><br>                .methodBuilder(<span class="hljs-string">&quot;createView&quot;</span>)<br>                <span class="hljs-comment">//æ³¨è§£</span><br>                .addAnnotation(Override.class)<br>                <span class="hljs-comment">//ä¿®é¥°ç¬¦</span><br>                .addModifiers(Modifier.PUBLIC)<br>                <span class="hljs-comment">//è¿”å›å€¼</span><br>                .returns(viewType)<br>                <span class="hljs-comment">//ç¬¬ä¸€ä¸ªå‚æ•°</span><br>                .addParameter(String.class,<span class="hljs-string">&quot;name&quot;</span>)<br>                <span class="hljs-comment">//ç¬¬äºŒä¸ªå‚æ•°</span><br>                .addParameter(ClassName.get(<span class="hljs-string">&quot;android.content&quot;</span>,<span class="hljs-string">&quot;Context&quot;</span>),<span class="hljs-string">&quot;context&quot;</span>)<br>                <span class="hljs-comment">//ç¬¬ä¸‰ä¸ªå‚æ•°</span><br>                .addParameter(ClassName.get(<span class="hljs-string">&quot;android.util&quot;</span>,<span class="hljs-string">&quot;AttributeSet&quot;</span>),<span class="hljs-string">&quot;attr&quot;</span>);<br><br>        <span class="hljs-comment">//2ã€æ„å»ºæ–¹æ³•ä½“</span><br>        methodBuilder.addStatement(<span class="hljs-string">&quot;$T view = null&quot;</span>,viewType);<br>        methodBuilder.beginControlFlow(<span class="hljs-string">&quot;switch(name)&quot;</span>);<br>        <span class="hljs-comment">//å¾ªç¯éå†æ§ä»¶åç§°é›†åˆ</span><br>        <span class="hljs-keyword">for</span> (String viewName : mViewNameSet) &#123;<br>            <span class="hljs-comment">//é’ˆå¯¹åŒ…å« . çš„æ§ä»¶åç§°è¿›è¡Œå¤„ç†</span><br>            <span class="hljs-keyword">if</span>(viewName.contains(<span class="hljs-string">&quot;.&quot;</span>))&#123;<br>                <span class="hljs-comment">//åˆ†ç¦»åŒ…åå’Œæ§ä»¶åï¼Œå¦‚ï¼šandroidx.constraintlayout.widget.ConstraintLayout</span><br>                <span class="hljs-comment">//packageNameï¼šandroidx.constraintlayout.widget</span><br>                <span class="hljs-comment">//simpleViewNameï¼šConstraintLayout</span><br>                <span class="hljs-type">String</span> <span class="hljs-variable">packageName</span> <span class="hljs-operator">=</span> viewName.substring(<span class="hljs-number">0</span>,viewName.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>));<br>                <span class="hljs-type">String</span> <span class="hljs-variable">simpleViewName</span> <span class="hljs-operator">=</span> viewName.substring(viewName.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>) + <span class="hljs-number">1</span>);<br>                <span class="hljs-type">ClassName</span> <span class="hljs-variable">returnType</span> <span class="hljs-operator">=</span> ClassName.get(packageName, simpleViewName);<br><br>                methodBuilder.addCode(<span class="hljs-string">&quot;case $S:\n&quot;</span>,viewName);<br>                methodBuilder.addStatement(<span class="hljs-string">&quot;\tview = new $T(context,attr)&quot;</span>, returnType);<br>                methodBuilder.addStatement(<span class="hljs-string">&quot;\tbreak&quot;</span>);<br>            &#125;<br>        &#125;<br>        methodBuilder.addCode(<span class="hljs-string">&quot;default:\n&quot;</span>);<br>        methodBuilder.addStatement(<span class="hljs-string">&quot;\tbreak&quot;</span>);<br>        methodBuilder.endControlFlow();<br>        methodBuilder.addStatement(<span class="hljs-string">&quot;return view&quot;</span>);<br><br>        <span class="hljs-type">MethodSpec</span> <span class="hljs-variable">createView</span> <span class="hljs-operator">=</span> methodBuilder.build();<br>        <span class="hljs-comment">//=================================== æ„å»ºæ–¹æ³• end ======================================</span><br><br>        <span class="hljs-comment">//=================================== æ„å»ºç±» start ======================================</span><br>        <span class="hljs-type">TypeSpec</span> <span class="hljs-variable">myViewCreatorImpl</span> <span class="hljs-operator">=</span> TypeSpec.classBuilder(<span class="hljs-string">&quot;MyViewCreatorImpl&quot;</span>)<br>                <span class="hljs-comment">//ç±»ä¿®é¥°ç¬¦</span><br>                .addModifiers(Modifier.PUBLIC)<br>                <span class="hljs-comment">//å®ç°æ¥å£</span><br>                .addSuperinterface(ClassName.get(<span class="hljs-string">&quot;com.dream.apt_api&quot;</span>, <span class="hljs-string">&quot;IMyViewCreator&quot;</span>))<br>                <span class="hljs-comment">//æ·»åŠ æ–¹æ³•</span><br>                .addMethod(createView)<br>                .build();<br>        <span class="hljs-comment">//=================================== æ„å»ºç±» end ========================================</span><br><br>        <span class="hljs-comment">//=================================== æŒ‡å®šåŒ…è·¯å¾„ï¼Œæ„å»ºæ–‡ä»¶ä½“ start =========================</span><br>        <span class="hljs-comment">//æŒ‡å®šç±»åŒ…è·¯å¾„</span><br>        <span class="hljs-type">JavaFile</span> <span class="hljs-variable">javaFile</span> <span class="hljs-operator">=</span> JavaFile.builder(<span class="hljs-string">&quot;com.dream.aptdemo&quot;</span>,myViewCreatorImpl).build();<br>        <span class="hljs-comment">//ç”Ÿæˆæ–‡ä»¶</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            javaFile.writeTo(mFiler);<br>            System.out.println(<span class="hljs-string">&quot;ç”ŸæˆæˆåŠŸ...&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>            System.out.println(<span class="hljs-string">&quot;ç”Ÿæˆå¤±è´¥...&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">//=================================== æŒ‡å®šåŒ…è·¯å¾„ï¼Œæ„å»ºæ–‡ä»¶ä½“ end ============================</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»æ–‡ä»¶ä¸­è¯»å–æ§ä»¶åç§°ï¼Œå¹¶è½¬æ¢æˆå¯¹åº”çš„é›†åˆ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Set&lt;String&gt; <span class="hljs-title function_">readViewNameFromFile</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//è·å–å­˜å‚¨æ§ä»¶åç§°çš„æ–‡ä»¶</span><br>            <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/Users/zhouying/AndroidStudioProjects/AptDemo/all_view_name.txt&quot;</span>);<br>            <span class="hljs-type">Properties</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>            config.load(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(file));<br>            <span class="hljs-comment">//è·å–æ§ä»¶åç§°é›†åˆ</span><br>            <span class="hljs-keyword">return</span> config.stringPropertyNames();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ç”Ÿæˆä»£ç çš„é€»è¾‘å†™äº†è¯¦ç»†çš„æ³¨é‡Šï¼Œä¸»è¦å°±æ˜¯å¯¹ <code>javapoet</code> æ¡†æ¶çš„ä¸€ä¸ªåº”ç”¨</p><p>ä»£ç ç”Ÿæˆå¥½äº†ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦æä¾›ç»™ä¸Šå±‚ä½¿ç”¨</p><h2 id="äº”ã€apt-api-ä¸šåŠ¡å°è£…ä¾›ä¸Šå±‚ä½¿ç”¨"><a href="#äº”ã€apt-api-ä¸šåŠ¡å°è£…ä¾›ä¸Šå±‚ä½¿ç”¨" class="headerlink" title="äº”ã€apt-api ä¸šåŠ¡å°è£…ä¾›ä¸Šå±‚ä½¿ç”¨"></a>äº”ã€apt-api ä¸šåŠ¡å°è£…ä¾›ä¸Šå±‚ä½¿ç”¨</h2><h3 id="1ã€å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œ-apt-api-å’Œ-apt-processor-éƒ½ä¼šä½¿ç”¨åˆ°"><a href="#1ã€å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œ-apt-api-å’Œ-apt-processor-éƒ½ä¼šä½¿ç”¨åˆ°" class="headerlink" title="1ã€å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œ apt-api å’Œ apt-processor éƒ½ä¼šä½¿ç”¨åˆ°"></a>1ã€å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œ <code>apt-api</code> å’Œ <code>apt-processor</code> éƒ½ä¼šä½¿ç”¨åˆ°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªæ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IMyViewCreator</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡ new çš„æ–¹å¼åˆ›å»º View</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> name æ§ä»¶åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> context ä¸Šä¸‹æ–‡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> attributeSet å±æ€§</span><br><span class="hljs-comment">     */</span><br>    View <span class="hljs-title function_">createView</span><span class="hljs-params">(String name, Context context, AttributeSet attributeSet)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€åå°„è·å–ç”Ÿæˆçš„ç±»ï¼Œæä¾›ç›¸åº”çš„ä»£ç†ç±»ä¾›ä¸Šå±‚è°ƒç”¨"><a href="#2ã€åå°„è·å–ç”Ÿæˆçš„ç±»ï¼Œæä¾›ç›¸åº”çš„ä»£ç†ç±»ä¾›ä¸Šå±‚è°ƒç”¨" class="headerlink" title="2ã€åå°„è·å–ç”Ÿæˆçš„ç±»ï¼Œæä¾›ç›¸åº”çš„ä»£ç†ç±»ä¾›ä¸Šå±‚è°ƒç”¨"></a>2ã€åå°„è·å–ç”Ÿæˆçš„ç±»ï¼Œæä¾›ç›¸åº”çš„ä»£ç†ç±»ä¾›ä¸Šå±‚è°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewCreatorDelegate</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IMyViewCreator</span>&#123;<br>    <br>    <span class="hljs-keyword">private</span> IMyViewCreator mIMyViewCreator;<br>    <br>    <span class="hljs-comment">//================================== å•ä¾‹ start =====================================</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;all&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">MyViewCreatorDelegate</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// é€šè¿‡åå°„æ‹¿åˆ° Apt ç”Ÿæˆçš„ç±»</span><br>            <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.dream.aptdemo.MyViewCreatorImpl&quot;</span>);<br>            mIMyViewCreator = (IMyViewCreator) aClass.newInstance();<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>            t.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MyViewCreatorDelegate <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> Holder.MY_VIEW_CREATOR_DELEGATE;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">MyViewCreatorDelegate</span> <span class="hljs-variable">MY_VIEW_CREATOR_DELEGATE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyViewCreatorDelegate</span>();<br>    &#125;<br>    <span class="hljs-comment">//================================== å•ä¾‹ end =======================================</span><br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡ç”Ÿæˆçš„ç±»åˆ›å»º View</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> name æ§ä»¶åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> context ä¸Šä¸‹æ–‡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> attributeSet å±æ€§</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> View</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">createView</span><span class="hljs-params">(String name, Context context, AttributeSet attributeSet)</span> &#123;<br>        <span class="hljs-keyword">if</span>(mIMyViewCreator != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">return</span> mIMyViewCreator.createView(name, context, attributeSet);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæˆ‘ä»¬å¸ƒå±€ä¼˜åŒ–æµç¨‹å·®ä¸å¤šå°±è¦ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸Šå±‚è°ƒç”¨</p><h2 id="å…­ã€app-ä¸Šå±‚è°ƒç”¨"><a href="#å…­ã€app-ä¸Šå±‚è°ƒç”¨" class="headerlink" title="å…­ã€app ä¸Šå±‚è°ƒç”¨"></a>å…­ã€app ä¸Šå±‚è°ƒç”¨</h2><h3 id="1ã€åœ¨åˆ›å»ºçš„-MyApplication-ä¸Šæ·»åŠ æ³¨è§£"><a href="#1ã€åœ¨åˆ›å»ºçš„-MyApplication-ä¸Šæ·»åŠ æ³¨è§£" class="headerlink" title="1ã€åœ¨åˆ›å»ºçš„ MyApplication ä¸Šæ·»åŠ æ³¨è§£"></a>1ã€åœ¨åˆ›å»ºçš„ MyApplication ä¸Šæ·»åŠ æ³¨è§£</h3><p>å…³äºæ³¨è§£ä½ å¯ä»¥æ·»åŠ åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› ä¸ºæˆ‘æ³¨è§£å¤„ç†å™¨é‡Œé¢åšäº†é€»è¾‘åˆ¤æ–­ï¼Œåªä¼šè¯»å–ç¬¬ä¸€æ¬¡çš„æ³¨è§£ã€‚ä¸ºäº†å¯¹åº”ï¼Œæˆ‘é€‰æ‹©æŠŠæ³¨è§£åŠ åˆ° MyApplication ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9465eb668782489b8915bce09f8c589d~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210629192519893"></p><h3 id="2ã€æœ€ååœ¨-MainActviity-ä¸­åŠ å…¥æ›¿æ¢-View-çš„é€»è¾‘"><a href="#2ã€æœ€ååœ¨-MainActviity-ä¸­åŠ å…¥æ›¿æ¢-View-çš„é€»è¾‘" class="headerlink" title="2ã€æœ€ååœ¨ MainActviity ä¸­åŠ å…¥æ›¿æ¢ View çš„é€»è¾‘"></a>2ã€æœ€ååœ¨ MainActviity ä¸­åŠ å…¥æ›¿æ¢ View çš„é€»è¾‘</h3><p>å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//...</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br><br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-meta">@Nullable</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name, <span class="hljs-meta">@NonNull</span> Context context, <span class="hljs-meta">@NonNull</span> AttributeSet attrs)</span> &#123;<br>        <span class="hljs-comment">//1ã€ä¼˜å…ˆä½¿ç”¨æˆ‘ä»¬ç”Ÿæˆçš„ç±»å»è¿›è¡Œ View çš„åˆ›å»º</span><br>        <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> MyViewCreatorDelegate.getInstance().createView(name, context, attrs);<br>        <span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> view;<br>        &#125;<br>        <span class="hljs-comment">//2ã€ä¸€äº›ç³»ç»Ÿçš„ View ,åˆ™èµ°ç³»ç»Ÿçš„ä¸€ä¸ªåˆ›å»ºæµç¨‹</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.onCreateView(name, context, attrs);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸€èˆ¬æˆ‘ä»¬ä¼šæŠŠæ›¿æ¢ View çš„é€»è¾‘æ”¾åˆ°åŸºç±»é‡Œé¢</p><h2 id="ä¸ƒã€æ•ˆæœéªŒè¯"><a href="#ä¸ƒã€æ•ˆæœéªŒè¯" class="headerlink" title="ä¸ƒã€æ•ˆæœéªŒè¯"></a>ä¸ƒã€æ•ˆæœéªŒè¯</h2><p>è¿è¡Œé¡¹ç›®</p><p>1ã€å…ˆçœ‹ä¸‹æˆ‘ä»¬æ‰“å°çš„æ—¥å¿—ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a7e9154f8ad4ba1827f9839acd15bf7~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210629195411055"></p><p>2ã€åœ¨çœ‹ä¸€çœ¼æˆ‘ä»¬ç”Ÿæˆçš„ Java ç±»æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47cefa64ab494d6aa18ad8cafb0d28d3~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210629194711378"></p><p>3ã€æœ€å debug é¡¹ç›®è·Ÿä¸‹æµç¨‹ï¼Œå‘ç°å’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€è‡´ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/123032d1ca3844f4959839bf46d66a80~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210629194101025"></p><p>è‡³æ­¤ï¼Œéœ€æ±‚å®Œç»“</p><h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€é€šè¿‡ APT è¯»å–æ–‡ä»¶è·å–æ‰€æœ‰çš„æ§ä»¶åç§°å¹¶ç”Ÿæˆ Java ç±»</p><p>2ã€é€šè¿‡æ¥å£ä»£ç†ï¼Œåˆç†çš„ä¸šåŠ¡å°è£…æä¾›ç»™ä¸Šå±‚è°ƒç”¨</p><p>3ã€åœ¨ä¸Šå±‚ Application é‡Œé¢è¿›è¡Œæ³¨è§£ï¼Œåœ¨ Activity ä¸­è¿›è¡Œ View æ§ä»¶çš„æ›¿æ¢</p><p>4ã€å®é™…å®Œæˆåçš„ä¸€ä¸ªæ•ˆæœéªŒè¯</p><p>å¥½äº†ï¼Œæœ¬ç³»åˆ—æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>APT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android APT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APT ç³»åˆ— ï¼ˆä¸‰ï¼‰ï¼šAPT æŠ€æœ¯æ¢ç©¶</title>
    <link href="/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AAPT%20%E6%8A%80%E6%9C%AF%E6%8E%A2%E7%A9%B6/"/>
    <url>/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AAPT%20%E6%8A%80%E6%9C%AF%E6%8E%A2%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f39b6dc6311a4c8f92962499db88737c~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹æ³¨è§£è¿›è¡Œäº†è®²è§£ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6978293956450713630">Android APT ç³»åˆ— ï¼ˆäºŒï¼‰ï¼šAPT ç­‘åŸºä¹‹æ³¨è§£</a>ã€‚è‡³æ­¤ï¼Œå…³äº Apt åŸºç¡€éƒ¨åˆ†æˆ‘ä»¬éƒ½è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥å°±æ­£å¼è¿›å…¥ APT æŠ€æœ¯çš„å­¦ä¹ </p><p><a href="https://github.com/sweetying520/AptDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥çœ‹ Demo è·Ÿéšæˆ‘çš„æ€è·¯ä¸€èµ·åˆ†æ</p><h2 id="ä¸€ã€APT-ä»‹ç»"><a href="#ä¸€ã€APT-ä»‹ç»" class="headerlink" title="ä¸€ã€APT ä»‹ç»"></a>ä¸€ã€APT ä»‹ç»</h2><h3 id="1ï¼‰ã€ä»€ä¹ˆæ˜¯-APT"><a href="#1ï¼‰ã€ä»€ä¹ˆæ˜¯-APT" class="headerlink" title="1ï¼‰ã€ä»€ä¹ˆæ˜¯ APT ?"></a>1ï¼‰ã€ä»€ä¹ˆæ˜¯ APT ?</h3><p>APT å…¨ç§° <code>Annotation Processing Tool</code>ï¼Œç¿»è¯‘è¿‡æ¥å³æ³¨è§£å¤„ç†å™¨ã€‚å¼•ç”¨å®˜æ–¹ä¸€æ®µå¯¹ APT çš„ä»‹ç»ï¼š<strong>APT æ˜¯ä¸€ç§å¤„ç†æ³¨é‡Šçš„å·¥å…·, å®ƒå¯¹æºä»£ç æ–‡ä»¶è¿›è¡Œæ£€æµ‹æ‰¾å‡ºå…¶ä¸­çš„æ³¨è§£ï¼Œå¹¶ä½¿ç”¨æ³¨è§£è¿›è¡Œé¢å¤–çš„å¤„ç†ã€‚</strong></p><h3 id="2ï¼‰ã€APT-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#2ï¼‰ã€APT-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="2ï¼‰ã€APT æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>2ï¼‰ã€APT æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>APT èƒ½åœ¨ç¼–è¯‘æœŸæ ¹æ®ç¼–è¯‘é˜¶æ®µæ³¨è§£ï¼Œç»™æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œç®€åŒ–ä½¿ç”¨ã€‚å¾ˆå¤šæµè¡Œæ¡†æ¶éƒ½ä½¿ç”¨åˆ°äº† APT æŠ€æœ¯ï¼Œå¦‚ ButterKnifeï¼ŒRetrofitï¼ŒArouterï¼ŒEventBus ç­‰ç­‰</p><h2 id="äºŒã€APT-å·¥ç¨‹"><a href="#äºŒã€APT-å·¥ç¨‹" class="headerlink" title="äºŒã€APT å·¥ç¨‹"></a>äºŒã€APT å·¥ç¨‹</h2><h3 id="1ï¼‰ã€APT-å·¥ç¨‹åˆ›å»º"><a href="#1ï¼‰ã€APT-å·¥ç¨‹åˆ›å»º" class="headerlink" title="1ï¼‰ã€APT å·¥ç¨‹åˆ›å»º"></a>1ï¼‰ã€APT å·¥ç¨‹åˆ›å»º</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒAPT å¤§è‡´çš„çš„ä¸€ä¸ªå®ç°è¿‡ç¨‹ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ª <code>Java Module</code> ï¼Œç”¨æ¥ç¼–å†™æ³¨è§£</p><p>2ã€åˆ›å»ºä¸€ä¸ª <code>Java Module</code> ï¼Œç”¨æ¥è¯»å–æ³¨è§£ä¿¡æ¯ï¼Œå¹¶æ ¹æ®æŒ‡å®šè§„åˆ™ï¼Œç”Ÿæˆç›¸åº”çš„ç±»æ–‡ä»¶</p><p>3ã€åˆ›å»ºä¸€ä¸ª <code>Android Module</code> ï¼Œé€šè¿‡åå°„è·å–ç”Ÿæˆçš„ç±»ï¼Œè¿›è¡Œåˆç†çš„å°è£…ï¼Œæä¾›ç»™ä¸Šå±‚è°ƒç”¨</p><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4415046ff7434044bc7959dd77d21358~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210627182425586"></p><p>è¿™æ˜¯æˆ‘çš„ APT å·¥ç¨‹ï¼Œå…³äº Module åç§°å¯ä»¥ä»»æ„å–ï¼ŒæŒ‰ç…§æˆ‘ä¸Šé¢è¯´çš„è§„åˆ™å»è¿›è¡Œå°±å¥½äº†</p><h3 id="2ï¼‰ã€Module-ä¾èµ–"><a href="#2ï¼‰ã€Module-ä¾èµ–" class="headerlink" title="2ï¼‰ã€Module ä¾èµ–"></a>2ï¼‰ã€Module ä¾èµ–</h3><p>å·¥ç¨‹åˆ›å»ºå¥½åï¼Œæˆ‘ä»¬å°±éœ€è¦ç†æ¸…æ¥šå„ä¸ª Module ä¹‹é—´çš„ä¸€ä¸ªä¾èµ–å…³ç³»ï¼š</p><p>1ã€å› ä¸º <code>apt-processor</code> è¦è¯»å– <code>apt-annotation</code> çš„æ³¨è§£ï¼Œæ‰€ä»¥ <code>apt-processor</code> éœ€è¦ä¾èµ– <code>apt-annotation</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//apt-processor çš„ build.gradle æ–‡ä»¶</span><br>dependencies &#123;<br>    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(path: <span class="hljs-string">&#x27;:apt-annotation&#x27;</span>)</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€app ä½œä¸ºè°ƒç”¨å±‚ï¼Œä»¥ä¸Š 3 ä¸ª Module éƒ½éœ€è¦è¿›è¡Œä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//app çš„ build.gradle æ–‡ä»¶</span><br>dependencies &#123;<br>    <span class="hljs-comment">//...</span><br>    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(path: <span class="hljs-string">&#x27;:apt-api&#x27;</span>)</span><br>    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(path: <span class="hljs-string">&#x27;:apt-annotation&#x27;</span>)</span><br>    annotationProcessor <span class="hljs-title function_">project</span><span class="hljs-params">(path: <span class="hljs-string">&#x27;:apt-processor&#x27;</span>)</span><br>&#125;<br></code></pre></td></tr></table></figure><p>APT å·¥ç¨‹é…ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å„ä¸ª Module è¿›è¡Œä¸€ä¸ªå…·ä½“ä»£ç çš„ç¼–å†™äº†</p><h2 id="ä¸‰ã€apt-annotation-æ³¨è§£ç¼–å†™"><a href="#ä¸‰ã€apt-annotation-æ³¨è§£ç¼–å†™" class="headerlink" title="ä¸‰ã€apt-annotation æ³¨è§£ç¼–å†™"></a>ä¸‰ã€apt-annotation æ³¨è§£ç¼–å†™</h2><p>è¿™ä¸ª Module çš„å¤„ç†ç›¸å¯¹æ¥è¯´å¾ˆç®€å•ï¼Œå°±æ˜¯ç¼–å†™ç›¸åº”çš„è‡ªå®šä¹‰æ³¨è§£å°±å¥½äº†ï¼Œæˆ‘ç¼–å†™çš„å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.SOURCE)</span><br><span class="hljs-meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> AptAnnotation &#123;<br>    String <span class="hljs-title function_">desc</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&quot;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€apt-processor-è‡ªåŠ¨ç”Ÿæˆä»£ç "><a href="#å››ã€apt-processor-è‡ªåŠ¨ç”Ÿæˆä»£ç " class="headerlink" title="å››ã€apt-processor è‡ªåŠ¨ç”Ÿæˆä»£ç "></a>å››ã€apt-processor è‡ªåŠ¨ç”Ÿæˆä»£ç </h2><p>è¿™ä¸ª Module ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬æŠŠå®ƒåˆ†ä¸ºä»¥ä¸‹ 3 ä¸ªæ­¥éª¤ï¼š</p><p>1ã€æ³¨è§£å¤„ç†å™¨å£°æ˜</p><p>2ã€æ³¨è§£å¤„ç†å™¨æ³¨å†Œ</p><p>3ã€æ³¨è§£å¤„ç†å™¨ç”Ÿæˆç±»æ–‡ä»¶</p><h3 id="1ï¼‰ã€æ³¨è§£å¤„ç†å™¨å£°æ˜"><a href="#1ï¼‰ã€æ³¨è§£å¤„ç†å™¨å£°æ˜" class="headerlink" title="1ï¼‰ã€æ³¨è§£å¤„ç†å™¨å£°æ˜"></a>1ï¼‰ã€æ³¨è§£å¤„ç†å™¨å£°æ˜</h3><h4 id="1ã€æ–°å»ºä¸€ä¸ªç±»ï¼Œç±»åæŒ‰ç…§è‡ªå·±çš„å–œå¥½å–ï¼Œç»§æ‰¿-javax-annotation-processing-è¿™ä¸ªåŒ…ä¸‹çš„-AbstractProcessor-ç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•"><a href="#1ã€æ–°å»ºä¸€ä¸ªç±»ï¼Œç±»åæŒ‰ç…§è‡ªå·±çš„å–œå¥½å–ï¼Œç»§æ‰¿-javax-annotation-processing-è¿™ä¸ªåŒ…ä¸‹çš„-AbstractProcessor-ç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•" class="headerlink" title="1ã€æ–°å»ºä¸€ä¸ªç±»ï¼Œç±»åæŒ‰ç…§è‡ªå·±çš„å–œå¥½å–ï¼Œç»§æ‰¿ javax.annotation.processing è¿™ä¸ªåŒ…ä¸‹çš„ AbstractProcessor ç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•"></a>1ã€æ–°å»ºä¸€ä¸ªç±»ï¼Œç±»åæŒ‰ç…§è‡ªå·±çš„å–œå¥½å–ï¼Œç»§æ‰¿ <code>javax.annotation.processing</code> è¿™ä¸ªåŒ…ä¸‹çš„ AbstractProcessor ç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AptAnnotationProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¼–å†™ç”Ÿæˆ Java ç±»çš„ç›¸å…³é€»è¾‘</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> set              æ”¯æŒå¤„ç†çš„æ³¨è§£é›†åˆ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> roundEnvironment é€šè¿‡è¯¥å¯¹è±¡æŸ¥æ‰¾æŒ‡å®šæ³¨è§£ä¸‹çš„èŠ‚ç‚¹ä¿¡æ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> true: è¡¨ç¤ºæ³¨è§£å·²å¤„ç†ï¼Œåç»­æ³¨è§£å¤„ç†å™¨æ— éœ€å†å¤„ç†å®ƒä»¬ï¼›false: è¡¨ç¤ºæ³¨è§£æœªå¤„ç†ï¼Œå¯èƒ½è¦æ±‚åç»­æ³¨è§£å¤„ç†å™¨å¤„ç†</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(Set&lt;? extends TypeElement&gt; set, RoundEnvironment roundEnvironment)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‡ç‚¹çœ‹ä¸‹ç¬¬ä¸€ä¸ªå‚æ•°ä¸­çš„ TypeElement ï¼Œè¿™ä¸ªå°±æ¶‰åŠåˆ° Element çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š</p><p><strong>Element ä»‹ç»</strong></p><p>å®é™…ä¸Šï¼ŒJava æºæ–‡ä»¶æ˜¯ä¸€ç§ç»“æ„ä½“è¯­è¨€ï¼Œæºä»£ç çš„æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½å¯¹åº”äº†ä¸€ä¸ªç‰¹å®šç±»å‹çš„ Element ï¼Œä¾‹å¦‚åŒ…ï¼Œç±»ï¼Œå­—æ®µï¼Œæ–¹æ³•ç­‰ç­‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.dream;         <span class="hljs-comment">// PackageElementï¼šåŒ…å…ƒç´ </span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span>&lt;T&gt; &#123;     <span class="hljs-comment">// TypeElementï¼šç±»å…ƒç´ ; å…¶ä¸­ &lt;T&gt; å±äº TypeParameterElement æ³›å‹å…ƒç´ </span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> x;         <span class="hljs-comment">// VariableElementï¼šå˜é‡ã€æšä¸¾ã€æ–¹æ³•å‚æ•°å…ƒç´ </span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Main</span><span class="hljs-params">()</span> &#123;        <span class="hljs-comment">// ExecuteableElementï¼šæ„é€ å‡½æ•°ã€æ–¹æ³•å…ƒç´ </span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Java çš„ Element æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">javax</span>.lang.model.AnnotatedConstruct &#123;<br>    <span class="hljs-comment">// è·å–å…ƒç´ çš„ç±»å‹ï¼Œå®é™…çš„å¯¹è±¡ç±»å‹</span><br>    TypeMirror <span class="hljs-title function_">asType</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// è·å–Elementçš„ç±»å‹ï¼Œåˆ¤æ–­æ˜¯å“ªç§Element</span><br>    ElementKind <span class="hljs-title function_">getKind</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// è·å–ä¿®é¥°ç¬¦ï¼Œå¦‚public static finalç­‰å…³é”®å­—</span><br>    Set&lt;Modifier&gt; <span class="hljs-title function_">getModifiers</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// è·å–ç±»å</span><br>    Name <span class="hljs-title function_">getSimpleName</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// è¿”å›åŒ…å«è¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œä¸getEnclosedElements()æ–¹æ³•ç›¸å</span><br>    Element <span class="hljs-title function_">getEnclosingElement</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// è¿”å›è¯¥èŠ‚ç‚¹ä¸‹ç›´æ¥åŒ…å«çš„å­èŠ‚ç‚¹ï¼Œä¾‹å¦‚åŒ…èŠ‚ç‚¹ä¸‹åŒ…å«çš„ç±»èŠ‚ç‚¹</span><br>    List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&gt; getEnclosedElements();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object obj)</span>;<br>  <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span>;<br>  <br>    <span class="hljs-meta">@Override</span><br>    List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnnotationMirror</span>&gt; getAnnotationMirrors();<br>  <br>    <span class="hljs-comment">//è·å–æ³¨è§£</span><br>    <span class="hljs-meta">@Override</span><br>    &lt;A <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Annotation</span>&gt; A <span class="hljs-title function_">getAnnotation</span><span class="hljs-params">(Class&lt;A&gt; annotationType)</span>;<br>  <br>    &lt;R, P&gt; R <span class="hljs-title function_">accept</span><span class="hljs-params">(ElementVisitor&lt;R, P&gt; v, P p)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Element è·å–å¦‚ä¸Šä¸€äº›ä¿¡æ¯ï¼ˆå†™äº†æ³¨é‡Šçš„éƒ½æ˜¯ä¸€äº›å¸¸ç”¨çš„ï¼‰</p><p>ç”± Element è¡ç”Ÿå‡ºæ¥çš„æ‰©å±•ç±»å…±æœ‰ 5 ç§ï¼š</p><p>1ã€PackageElement è¡¨ç¤ºä¸€ä¸ªåŒ…ç¨‹åºå…ƒç´ </p><p>2ã€TypeElement è¡¨ç¤ºä¸€ä¸ªç±»æˆ–è€…æ¥å£ç¨‹åºå…ƒç´ </p><p>3ã€TypeParameterElement è¡¨ç¤ºä¸€ä¸ªæ³›å‹å…ƒç´ </p><p>4ã€VariableElement è¡¨ç¤ºä¸€ä¸ªå­—æ®µã€enum å¸¸é‡ã€æ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•çš„å‚æ•°ã€å±€éƒ¨å˜é‡æˆ–å¼‚å¸¸å‚æ•°</p><p>5ã€ExecuteableElement è¡¨ç¤ºæŸä¸ªç±»æˆ–è€…æ¥å£çš„æ–¹æ³•ã€æ„é€ æ–¹æ³•æˆ–åˆå§‹åŒ–ç¨‹åºï¼ˆé™æ€æˆ–è€…å®ä¾‹ï¼‰</p><p>å¯ä»¥å‘ç°ï¼ŒElement æœ‰æ—¶ä¼šä»£è¡¨å¤šç§å…ƒç´ ï¼Œä¾‹å¦‚ TypeElement ä»£è¡¨ç±»æˆ–æ¥å£ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ element.getKind() æ¥åŒºåˆ†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">Set&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&gt; elements = roundEnvironment.getElementsAnnotatedWith(AptAnnotation.class);<br><span class="hljs-keyword">for</span> (Element element : elements) &#123;<br>    <span class="hljs-keyword">if</span> (element.getKind() == ElementKind.CLASS) &#123;<br>        <span class="hljs-comment">// å¦‚æœå…ƒç´ æ˜¯ç±»</span><br><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.getKind() == ElementKind.INTERFACE) &#123;<br>        <span class="hljs-comment">// å¦‚æœå…ƒç´ æ˜¯æ¥å£</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ElementKind æ˜¯ä¸€ä¸ªæšä¸¾ç±»ï¼Œå®ƒçš„å–å€¼æœ‰å¾ˆå¤šï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">PACKAGE<span class="hljs-comment">//è¡¨ç¤ºåŒ…</span><br>ENUM <span class="hljs-comment">//è¡¨ç¤ºæšä¸¾</span><br>CLASS <span class="hljs-comment">//è¡¨ç¤ºç±»</span><br>ANNOTATION_TYPE<span class="hljs-comment">//è¡¨ç¤ºæ³¨è§£</span><br>INTERFACE <span class="hljs-comment">//è¡¨ç¤ºæ¥å£</span><br>ENUM_CONSTANT <span class="hljs-comment">//è¡¨ç¤ºæšä¸¾å¸¸é‡</span><br>FIELD <span class="hljs-comment">//è¡¨ç¤ºå­—æ®µ</span><br>PARAMETER <span class="hljs-comment">//è¡¨ç¤ºå‚æ•°</span><br>LOCAL_VARIABLE <span class="hljs-comment">//è¡¨ç¤ºæœ¬åœ°å˜é‡</span><br>EXCEPTION_PARAMETER <span class="hljs-comment">//è¡¨ç¤ºå¼‚å¸¸å‚æ•°</span><br>METHOD <span class="hljs-comment">//è¡¨ç¤ºæ–¹æ³•</span><br>CONSTRUCTOR <span class="hljs-comment">//è¡¨ç¤ºæ„é€ å‡½æ•°</span><br>OTHER <span class="hljs-comment">//è¡¨ç¤ºå…¶ä»–</span><br></code></pre></td></tr></table></figure><p>å…³äº Element å°±ä»‹ç»åˆ°è¿™ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹</p><h4 id="2ã€é‡å†™æ–¹æ³•è§£è¯»"><a href="#2ã€é‡å†™æ–¹æ³•è§£è¯»" class="headerlink" title="2ã€é‡å†™æ–¹æ³•è§£è¯»"></a>2ã€é‡å†™æ–¹æ³•è§£è¯»</h4><p>é™¤äº†å¿…é¡»å®ç°çš„è¿™ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é‡å†™å…¶ä»– 4 ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AptAnnotationProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br>    <span class="hljs-comment">//...</span><br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * èŠ‚ç‚¹å·¥å…·ç±»ï¼ˆç±»ã€å‡½æ•°ã€å±æ€§éƒ½æ˜¯èŠ‚ç‚¹ï¼‰</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Elements mElementUtils;<br><br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * ç±»ä¿¡æ¯å·¥å…·ç±»</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Types mTypeUtils;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–‡ä»¶ç”Ÿæˆå™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Filer mFiler;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ—¥å¿—ä¿¡æ¯æ‰“å°å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Messager mMessager;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œ</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> processingEnvironment è¿™ä¸ªå‚æ•°æä¾›äº†è‹¥å¹²å·¥å…·ç±»ï¼Œä¾›ç¼–å†™ç”Ÿæˆ Java ç±»æ—¶æ‰€ä½¿ç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(ProcessingEnvironment processingEnv)</span> &#123;<br>        <span class="hljs-built_in">super</span>.init(processingEnv);<br>        mElementUtils = processingEnv.getElementUtils();<br>        mTypeUtils = processingEnv.getTypeUtils();<br>        mFiler = processingEnv.getFiler();<br>        mMessager = processingEnv.getMessager();<br>    &#125;<br>  <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¥æ”¶å¤–æ¥ä¼ å…¥çš„å‚æ•°ï¼Œæœ€å¸¸ç”¨çš„å½¢å¼å°±æ˜¯åœ¨ build.gradle è„šæœ¬æ–‡ä»¶é‡Œçš„ javaCompileOptions çš„é…ç½®</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å±æ€§çš„ Key é›†åˆ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Set&lt;String&gt; <span class="hljs-title function_">getSupportedOptions</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getSupportedOptions();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“å‰æ³¨è§£å¤„ç†å™¨æ”¯æŒçš„æ³¨è§£é›†åˆï¼Œå¦‚æœæ”¯æŒï¼Œå°±ä¼šè°ƒç”¨ process æ–¹æ³•</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ”¯æŒçš„æ³¨è§£é›†åˆ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Set&lt;String&gt; <span class="hljs-title function_">getSupportedAnnotationTypes</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getSupportedAnnotationTypes();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¼–è¯‘å½“å‰æ³¨è§£å¤„ç†å™¨çš„ JDK ç‰ˆæœ¬</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JDK ç‰ˆæœ¬</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> SourceVersion <span class="hljs-title function_">getSupportedSourceVersion</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getSupportedSourceVersion();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š<code>getSupportedAnnotationTypes()</code>ã€<code>getSupportedSourceVersion()</code>å’Œ<code>getSupportedOptions()</code> è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é‡‡ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œæä¾›ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SupportedOptions(&quot;MODULE_NAME&quot;)</span><br><span class="hljs-meta">@SupportedAnnotationTypes(&quot;com.dream.apt_annotation.AptAnnotation&quot;)</span><br><span class="hljs-meta">@SupportedSourceVersion(SourceVersion.RELEASE_8)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AptAnnotationProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€æ³¨è§£å¤„ç†å™¨æ³¨å†Œ"><a href="#2ï¼‰ã€æ³¨è§£å¤„ç†å™¨æ³¨å†Œ" class="headerlink" title="2ï¼‰ã€æ³¨è§£å¤„ç†å™¨æ³¨å†Œ"></a>2ï¼‰ã€æ³¨è§£å¤„ç†å™¨æ³¨å†Œ</h3><p>æ³¨è§£å¤„ç†å™¨å£°æ˜å¥½äº†ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°±è¦æ³¨å†Œå®ƒï¼Œå…¶ä¸­æ³¨å†Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ã€æ‰‹åŠ¨æ³¨å†Œ</p><p>2ã€è‡ªåŠ¨æ³¨å†Œ</p><p>æ‰‹åŠ¨æ³¨å†Œæ¯”è¾ƒç¹çå›ºå®šä¸”å®¹æ˜“å‡ºé”™ï¼Œä¸æ¨èä½¿ç”¨ï¼Œè¿™é‡Œå°±ä¸è®²äº†ã€‚æˆ‘ä»¬ä¸»è¦çœ‹ä¸‹è‡ªåŠ¨æ³¨å†Œ</p><h4 id="è‡ªåŠ¨æ³¨å†Œ"><a href="#è‡ªåŠ¨æ³¨å†Œ" class="headerlink" title="è‡ªåŠ¨æ³¨å†Œ"></a>è‡ªåŠ¨æ³¨å†Œ</h4><p>1ã€é¦–å…ˆæˆ‘ä»¬è¦åœ¨ <code>apt-processor</code>è¿™ä¸ª Module ä¸‹çš„ build.gradle æ–‡ä»¶å¯¼å…¥å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;com.google.auto.service:auto-service:1.0-rc6&#x27;</span><br>annotationProcessor <span class="hljs-string">&#x27;com.google.auto.service:auto-service:1.0-rc6&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸¤å¥å¿…é¡»éƒ½è¦åŠ ï¼Œå¦åˆ™æ³¨å†Œä¸æˆåŠŸï¼Œæˆ‘ä¹‹å‰è¸©å‘äº†</p><p>2ã€åœ¨æ³¨è§£å¤„ç†å™¨ä¸ŠåŠ ä¸Š <code>@AutoService(Processor.class)</code> å³å¯å®Œæˆæ³¨å†Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AutoService(Processor.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AptAnnotationProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€æ³¨è§£å¤„ç†å™¨ç”Ÿæˆç±»æ–‡ä»¶"><a href="#3ï¼‰ã€æ³¨è§£å¤„ç†å™¨ç”Ÿæˆç±»æ–‡ä»¶" class="headerlink" title="3ï¼‰ã€æ³¨è§£å¤„ç†å™¨ç”Ÿæˆç±»æ–‡ä»¶"></a>3ï¼‰ã€æ³¨è§£å¤„ç†å™¨ç”Ÿæˆç±»æ–‡ä»¶</h3><p>æ³¨å†Œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼ç¼–å†™ç”Ÿæˆ Java ç±»æ–‡ä»¶çš„ä»£ç äº†ï¼Œå…¶ä¸­ç”Ÿæˆä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ã€å¸¸è§„çš„å†™æ–‡ä»¶æ–¹å¼</p><p>2ã€é€šè¿‡ javapoet æ¡†æ¶æ¥ç¼–å†™</p><p>1 çš„æ–¹å¼æ¯”è¾ƒæ­»æ¿ï¼Œéœ€è¦æŠŠæ¯ä¸€ä¸ªå­—æ¯éƒ½å†™ä¸Šï¼Œä¸æ¨èä½¿ç”¨ï¼Œè¿™é‡Œå°±ä¸è®²äº†ã€‚æˆ‘ä»¬ä¸»è¦çœ‹ä¸‹é€šè¿‡ javapoet è¿™ä¸ªæ¡†æ¶ç”Ÿæˆ Java ç±»æ–‡ä»¶</p><h4 id="javapoet-æ–¹å¼"><a href="#javapoet-æ–¹å¼" class="headerlink" title="javapoet æ–¹å¼"></a>javapoet æ–¹å¼</h4><p>è¿™ç§æ–¹å¼æ›´åŠ ç¬¦åˆé¢å‘å¯¹è±¡ç¼–ç çš„ä¸€ä¸ªé£æ ¼ï¼Œå¯¹ javapoet è¿˜ä¸ç†Ÿçš„æœ‹å‹ï¼Œå¯ä»¥å» github ä¸Šå­¦ä¹ ä¸€æ³¢ <a href="https://github.com/square/javapoet">ä¼ é€é—¨</a>ï¼Œè¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å®ƒå¸¸ç”¨çš„ä¸€äº›ç±»ï¼š</p><blockquote><p>TypeSpecï¼šç”¨äºç”Ÿæˆç±»ã€æ¥å£ã€æšä¸¾å¯¹è±¡çš„ç±»</p><p>MethodSpecï¼šç”¨äºç”Ÿæˆæ–¹æ³•å¯¹è±¡çš„ç±»</p><p>ParameterSpecï¼šç”¨äºç”Ÿæˆå‚æ•°å¯¹è±¡çš„ç±»</p><p>AnnotationSpecï¼šç”¨äºç”Ÿæˆæ³¨è§£å¯¹è±¡çš„ç±»</p><p>FieldSpecï¼šç”¨äºé…ç½®ç”Ÿæˆæˆå‘˜å˜é‡çš„ç±»</p><p>ClassNameï¼šé€šè¿‡åŒ…åå’Œç±»åç”Ÿæˆçš„å¯¹è±¡ï¼Œåœ¨JavaPoetä¸­ç›¸å½“äºä¸ºå…¶æŒ‡å®š Class</p><p>ParameterizedTypeNameï¼šé€šè¿‡ MainClass å’Œ IncludeClass ç”ŸæˆåŒ…å«æ³›å‹çš„ Class</p><p>JavaFileï¼šæ§åˆ¶ç”Ÿæˆçš„ Java æ–‡ä»¶çš„è¾“å‡ºçš„ç±»</p></blockquote><h5 id="1ã€å¯¼å…¥-javapoet-æ¡†æ¶ä¾èµ–"><a href="#1ã€å¯¼å…¥-javapoet-æ¡†æ¶ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ javapoet æ¡†æ¶ä¾èµ–"></a>1ã€å¯¼å…¥ javapoet æ¡†æ¶ä¾èµ–</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;com.squareup:javapoet:1.13.0&#x27;</span><br></code></pre></td></tr></table></figure><h5 id="2ã€æŒ‰ç…§æŒ‡å®šä»£ç æ¨¡ç‰ˆç”Ÿæˆ-Java-ç±»æ–‡ä»¶"><a href="#2ã€æŒ‰ç…§æŒ‡å®šä»£ç æ¨¡ç‰ˆç”Ÿæˆ-Java-ç±»æ–‡ä»¶" class="headerlink" title="2ã€æŒ‰ç…§æŒ‡å®šä»£ç æ¨¡ç‰ˆç”Ÿæˆ Java ç±»æ–‡ä»¶"></a>2ã€æŒ‰ç…§æŒ‡å®šä»£ç æ¨¡ç‰ˆç”Ÿæˆ Java ç±»æ–‡ä»¶</h5><p>ä¾‹å¦‚ï¼Œæˆ‘åœ¨ app çš„ build.gradle ä¸‹è¿›è¡Œäº†å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy">android &#123;<br>    <span class="hljs-comment">//...</span><br>    defaultConfig &#123;<br>        <span class="hljs-comment">//...</span><br>        javaCompileOptions &#123;<br>            annotationProcessorOptions &#123;<br>                arguments = [<span class="hljs-attr">MODULE_NAME:</span> project.getName()]<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ MainActivity ä¸‹é¢è¿›è¡Œäº†å¦‚ä¸‹æ³¨è§£ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0fcccf3c6fe64a88bb00488bb1cb9308~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210627212604288"></p><p>æˆ‘å¸Œæœ›ç”Ÿæˆçš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd59cb4022624f7c9c171fa22441dd99~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210627220320906"></p><p>ç°åœ¨æˆ‘ä»¬æ¥å®æ“ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AutoService(Processor.class)</span><br><span class="hljs-meta">@SupportedOptions(&quot;MODULE_NAME&quot;)</span><br><span class="hljs-meta">@SupportedAnnotationTypes(&quot;com.dream.apt_annotation.AptAnnotation&quot;)</span><br><span class="hljs-meta">@SupportedSourceVersion(SourceVersion.RELEASE_8)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AptAnnotationProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractProcessor</span> &#123;<br><br>    <span class="hljs-comment">//æ–‡ä»¶ç”Ÿæˆå™¨</span><br>    Filer filer;<br>    <span class="hljs-comment">//æ¨¡å—å</span><br>    <span class="hljs-keyword">private</span> String mModuleName;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(ProcessingEnvironment processingEnvironment)</span> &#123;<br>        <span class="hljs-built_in">super</span>.init(processingEnvironment);<br>      <span class="hljs-comment">//åˆå§‹åŒ–æ–‡ä»¶ç”Ÿæˆå™¨</span><br>        filer = processingEnvironment.getFiler();<br>      <span class="hljs-comment">//é€šè¿‡ key è·å– build.gradle ä¸­å¯¹åº”çš„ value</span><br>        mModuleName = processingEnv.getOptions().get(<span class="hljs-string">&quot;MODULE_NAME&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(Set&lt;? extends TypeElement&gt; set, RoundEnvironment roundEnvironment)</span> &#123;<br>        <span class="hljs-keyword">if</span> (set == <span class="hljs-literal">null</span> || set.isEmpty()) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>      <span class="hljs-comment">//è·å–å½“å‰æ³¨è§£ä¸‹çš„èŠ‚ç‚¹ä¿¡æ¯</span><br>        Set&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&gt; rootElements = roundEnvironment.getElementsAnnotatedWith(AptAnnotation.class);<br><br>        <span class="hljs-comment">// æ„å»º test å‡½æ•°</span><br>        MethodSpec.<span class="hljs-type">Builder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> MethodSpec.methodBuilder(<span class="hljs-string">&quot;test&quot;</span>)<br>                .addModifiers(Modifier.PUBLIC) <span class="hljs-comment">// æŒ‡å®šæ–¹æ³•ä¿®é¥°ç¬¦</span><br>                .returns(<span class="hljs-keyword">void</span>.class) <span class="hljs-comment">// æŒ‡å®šè¿”å›ç±»å‹</span><br>                .addParameter(String.class, <span class="hljs-string">&quot;param&quot;</span>); <span class="hljs-comment">// æ·»åŠ å‚æ•°</span><br>        builder.addStatement(<span class="hljs-string">&quot;$T.out.println($S)&quot;</span>, System.class, <span class="hljs-string">&quot;æ¨¡å—: &quot;</span> + mModuleName);<br><br>        <span class="hljs-keyword">if</span> (rootElements != <span class="hljs-literal">null</span> &amp;&amp; !rootElements.isEmpty()) &#123;<br>            <span class="hljs-keyword">for</span> (Element element : rootElements) &#123;<br>              <span class="hljs-comment">//å½“å‰èŠ‚ç‚¹åç§°</span><br>                <span class="hljs-type">String</span> <span class="hljs-variable">elementName</span> <span class="hljs-operator">=</span> element.getSimpleName().toString();<br>              <span class="hljs-comment">//å½“å‰èŠ‚ç‚¹ä¸‹æ³¨è§£çš„å±æ€§</span><br>                <span class="hljs-type">String</span> <span class="hljs-variable">desc</span> <span class="hljs-operator">=</span> element.getAnnotation(AptAnnotation.class).desc();<br>                <span class="hljs-comment">// æ„å»ºæ–¹æ³•ä½“</span><br>                builder.addStatement(<span class="hljs-string">&quot;$T.out.println($S)&quot;</span>, System.class, <br>                                     <span class="hljs-string">&quot;èŠ‚ç‚¹: &quot;</span> + elementName + <span class="hljs-string">&quot;  &quot;</span> + <span class="hljs-string">&quot;æè¿°: &quot;</span> + desc);<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">MethodSpec</span> <span class="hljs-variable">main</span> <span class="hljs-operator">=</span>builder.build();<br><br>        <span class="hljs-comment">// æ„å»º HelloWorld ç±»</span><br>        <span class="hljs-type">TypeSpec</span> <span class="hljs-variable">helloWorld</span> <span class="hljs-operator">=</span> TypeSpec.classBuilder(<span class="hljs-string">&quot;HelloWorld&quot;</span>)<br>                .addModifiers(Modifier.PUBLIC) <span class="hljs-comment">// æŒ‡å®šç±»ä¿®é¥°ç¬¦</span><br>                .addMethod(main) <span class="hljs-comment">// æ·»åŠ æ–¹æ³•</span><br>                .build();<br><br>        <span class="hljs-comment">// æŒ‡å®šåŒ…è·¯å¾„ï¼Œæ„å»ºæ–‡ä»¶ä½“</span><br>        <span class="hljs-type">JavaFile</span> <span class="hljs-variable">javaFile</span> <span class="hljs-operator">=</span> JavaFile.builder(<span class="hljs-string">&quot;com.dream.aptdemo&quot;</span>, helloWorld).build();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// åˆ›å»ºæ–‡ä»¶</span><br>            javaFile.writeTo(filer);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢è¿™äº›æ­¥éª¤ï¼Œæˆ‘ä»¬è¿è¡Œ App å°±èƒ½ç”Ÿæˆä¸Šé¢æˆªå›¾çš„ä»£ç äº†ï¼Œç°åœ¨è¿˜å·®æœ€åä¸€æ­¥ï¼Œå¯¹ç”Ÿæˆçš„ä»£ç è¿›è¡Œä½¿ç”¨</p><p><strong>æ³¨æ„</strong>ï¼šä¸åŒç‰ˆæœ¬çš„ Gradle ç”Ÿæˆçš„ç±»æ–‡ä»¶ä½ç½®å¯èƒ½ä¸ä¸€æ ·ï¼Œæˆ‘çš„ Gradle ç‰ˆæœ¬æ˜¯ 6.7.1ï¼Œç”Ÿæˆçš„ç±»æ–‡ä»¶åœ¨å¦‚ä¸‹ä½ç½®ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d51e6dd32ab4042a4d5905122b6ef43~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210627221836736"></p><p>ä¸€äº›ä½ç‰ˆæœ¬çš„ Gradle ç”Ÿæˆçš„ç±»æ–‡ä»¶åœ¨ <code>/build/generated/source</code> è¿™ä¸ªç›®å½•ä¸‹</p><h2 id="äº”ã€apt-api-è°ƒç”¨ç”Ÿæˆä»£ç å®Œæˆä¸šåŠ¡åŠŸèƒ½"><a href="#äº”ã€apt-api-è°ƒç”¨ç”Ÿæˆä»£ç å®Œæˆä¸šåŠ¡åŠŸèƒ½" class="headerlink" title="äº”ã€apt-api è°ƒç”¨ç”Ÿæˆä»£ç å®Œæˆä¸šåŠ¡åŠŸèƒ½"></a>äº”ã€apt-api è°ƒç”¨ç”Ÿæˆä»£ç å®Œæˆä¸šåŠ¡åŠŸèƒ½</h2><p>è¿™ä¸ª Module çš„æ“ä½œç›¸å¯¹æ¥è¯´ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é€šè¿‡åå°„è·å–åˆ°ç”Ÿæˆçš„ç±»ï¼Œè¿›è¡Œç›¸åº”çš„å°è£…ä½¿ç”¨å³å¯ï¼Œæˆ‘çš„ç¼–å†™å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAptApi</span> &#123;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;all&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.dream.aptdemo.HelloWorld&quot;</span>);<br>            <span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> c.getDeclaredConstructor();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> declaredConstructor.newInstance();<br>            <span class="hljs-type">Method</span> <span class="hljs-variable">test</span> <span class="hljs-operator">=</span> c.getDeclaredMethod(<span class="hljs-string">&quot;test&quot;</span>, String.class);<br>            test.invoke(o, <span class="hljs-string">&quot;&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬åœ¨ MainActivity çš„ oncreate æ–¹æ³•é‡Œé¢è¿›è¡Œè°ƒç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AptAnnotation(desc = &quot;æˆ‘æ˜¯ MainActivity ä¸Šé¢çš„æ³¨è§£&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>  <br>    <span class="hljs-meta">@AptAnnotation(desc = &quot;æˆ‘æ˜¯ onCreate ä¸Šé¢çš„æ³¨è§£&quot;)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        MyAptApi.init();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ¨¡å—: app<br>èŠ‚ç‚¹: MainActivity  æè¿°: æˆ‘æ˜¯ MainActivity ä¸Šé¢çš„æ³¨è§£<br>èŠ‚ç‚¹: onCreate  æè¿°: æˆ‘æ˜¯ onCreate ä¸Šé¢çš„æ³¨è§£<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€APT å·¥ç¨‹æ‰€éœ€åˆ›å»ºçš„ä¸åŒç§ç±»çš„ Module åŠ Module ä¹‹é—´çš„ä¾èµ–å…³ç³»</p><p>2ã€Java æºæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ç§ç»“æ„ä½“è¯­è¨€ï¼Œæºä»£ç çš„æ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½å¯¹åº”äº†ä¸€ä¸ªç‰¹å®šç±»å‹çš„ Element</p><p>3ã€é‡‡ç”¨ auto-service å¯¹æ³¨è§£å¤„ç†å™¨è¿›è¡Œè‡ªåŠ¨æ³¨å†Œ</p><p>4ã€é‡‡ç”¨ javapoet æ¡†æ¶ç¼–å†™æ‰€éœ€ç”Ÿæˆçš„ Java ç±»æ–‡ä»¶</p><p>5ã€é€šè¿‡åå°„åŠé€‚å½“çš„å°è£…ï¼Œå°†ç”Ÿæˆçš„ç±»çš„åŠŸèƒ½æä¾›ç»™ä¸Šå±‚è°ƒç”¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²æˆ‘æ˜¯å¦‚ä½•åº”ç”¨ APT æŠ€æœ¯å®ç°åå°„åˆ›å»º View çš„ä¸€ä¸ªæ›¿æ¢ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6963873016220663844#comment">Androidæ³¨è§£å¤„ç†å™¨APTæŠ€æœ¯æ¢ç©¶</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>APT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android APT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APT ç³»åˆ— ï¼ˆäºŒï¼‰ï¼šAPT ç­‘åŸºä¹‹æ³¨è§£</title>
    <link href="/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AAPT%20%E7%AD%91%E5%9F%BA%E4%B9%8B%E6%B3%A8%E8%A7%A3/"/>
    <url>/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9AAPT%20%E7%AD%91%E5%9F%BA%E4%B9%8B%E6%B3%A8%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aee69ebabed54908974c6173800ee1ff~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹åå°„ä¸€äº›å¸¸ç”¨çš„çŸ¥è¯†è¿›è¡Œäº†è®²è§£ï¼Œè¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/6977679823132950536">Android APT ç³»åˆ— ï¼ˆä¸€ï¼‰ï¼šAPT ç­‘åŸºä¹‹åå°„</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹ Java æ³¨è§£</p><p><a href="https://github.com/sweetying520/AptDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥çœ‹ Demo è·Ÿéšæˆ‘çš„æ€è·¯ä¸€èµ·åˆ†æ</p><h2 id="ä¸€ã€æ³¨è§£ä»‹ç»"><a href="#ä¸€ã€æ³¨è§£ä»‹ç»" class="headerlink" title="ä¸€ã€æ³¨è§£ä»‹ç»"></a>ä¸€ã€æ³¨è§£ä»‹ç»</h2><h3 id="1ï¼‰ã€ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿ"><a href="#1ï¼‰ã€ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿ" class="headerlink" title="1ï¼‰ã€ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿ"></a>1ï¼‰ã€ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿ</h3><p>è¦è§£é‡Šæ³¨è§£æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½ä»€ä¹ˆæ˜¯å…ƒæ•°æ®ï¼š<strong>å…ƒæ•°æ®å°±æ˜¯ä¸ºå…¶ä»–æ•°æ®æä¾›ä¿¡æ¯çš„æ•°æ®</strong></p><p>é‚£ä¹ˆè¿˜æ˜¯å¼•å…¥å®˜æ–¹ä¸€æ®µå¯¹æ³¨è§£çš„è§£é‡Šï¼š<strong>æ³¨è§£ç”¨äºä¸ºä»£ç æä¾›å…ƒæ•°æ®ã€‚ä½œä¸ºå…ƒæ•°æ®ï¼Œæ³¨è§£ä¸ç›´æ¥å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Œä½†ä¹Ÿæœ‰ä¸€äº›ç±»å‹çš„æ³¨è§£å®é™…ä¸Šå¯ä»¥ç”¨äºè¿™ä¸€ç›®çš„ã€‚Java æ³¨è§£æ˜¯ä» JDK 1.5 å¼€å§‹æ·»åŠ åˆ° Java çš„ã€‚</strong></p><p>ç®€å•çš„ç†è§£ï¼š<strong>æ³¨è§£å°±æ˜¯é™„åŠ åˆ°ä»£ç ä¸Šçš„ä¸€ç§é¢å¤–è¡¥å……ä¿¡æ¯</strong></p><h3 id="2ï¼‰ã€æ³¨è§£æœ‰å“ªäº›ä½œç”¨ï¼Ÿ"><a href="#2ï¼‰ã€æ³¨è§£æœ‰å“ªäº›ä½œç”¨ï¼Ÿ" class="headerlink" title="2ï¼‰ã€æ³¨è§£æœ‰å“ªäº›ä½œç”¨ï¼Ÿ"></a>2ï¼‰ã€æ³¨è§£æœ‰å“ªäº›ä½œç”¨ï¼Ÿ</h3><p><strong>æºç é˜¶æ®µæ³¨è§£</strong>ï¼š ç¼–è¯‘å™¨å¯åˆ©ç”¨è¯¥é˜¶æ®µæ³¨è§£æ£€æµ‹é”™è¯¯ï¼Œæç¤ºè­¦å‘Šä¿¡æ¯ï¼Œæ‰“å°æ—¥å¿—ç­‰</p><p><strong>ç¼–è¯‘é˜¶æ®µæ³¨è§£</strong>ï¼šåˆ©ç”¨æ³¨è§£ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆä»£ç ã€æ–‡æ¡£æˆ–è€…åšå…¶å®ƒç›¸åº”çš„è‡ªåŠ¨å¤„ç†</p><p><strong>è¿è¡Œé˜¶æ®µæ³¨è§£</strong>ï¼š å¯é€šè¿‡åå°„è·å–æ³¨è§£ä¿¡æ¯ï¼Œåšç›¸åº”æ“ä½œ</p><h3 id="3ï¼‰ã€å¦‚ä½•è‡ªå®šä¹‰å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Ÿ"><a href="#3ï¼‰ã€å¦‚ä½•è‡ªå®šä¹‰å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Ÿ" class="headerlink" title="3ï¼‰ã€å¦‚ä½•è‡ªå®šä¹‰å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Ÿ"></a>3ï¼‰ã€å¦‚ä½•è‡ªå®šä¹‰å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Ÿ</h3><p>ä½¿ç”¨ <code>@interface</code> + æ³¨è§£åç§°è¿™ç§è¯­æ³•ç»“æ„å°±èƒ½å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ä¸€äº›å…ƒæ³¨è§£æ¥ä¿®é¥°è‡ªå®šä¹‰æ³¨è§£</p><h2 id="äºŒã€å…ƒæ³¨è§£"><a href="#äºŒã€å…ƒæ³¨è§£" class="headerlink" title="äºŒã€å…ƒæ³¨è§£"></a>äºŒã€å…ƒæ³¨è§£</h2><p>äº†è§£äº†ä¹‹å‰çš„å…ƒæ•°æ®ï¼Œ<strong>å…ƒæ³¨è§£å°±æ˜¯ä¸ºæ³¨è§£æä¾›æ³¨è§£çš„æ³¨è§£</strong> ğŸ˜‚ï¼Œè¿™å¥è¯å¯èƒ½æœ‰ç‚¹ç»•ï¼Œåæ­£ä½ æ¸…æ¥šå…ƒæ³¨è§£æ˜¯ç»™æ³¨è§£ç”¨çš„å°±è¡Œäº†</p><p>JDK ç»™æˆ‘ä»¬æä¾›çš„å…ƒæ³¨è§£æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</p><p>1ã€@Target</p><p>2ã€@Retention</p><p>3ã€@Inherited</p><p>4ã€@Documented</p><p>5ã€@Repeatable</p><h3 id="1ï¼‰ã€-Target"><a href="#1ï¼‰ã€-Target" class="headerlink" title="1ï¼‰ã€@Target"></a>1ï¼‰ã€@Target</h3><p>@Target è¡¨ç¤ºè¿™ä¸ªæ³¨è§£èƒ½æ”¾åœ¨ä»€ä¹ˆä½ç½®ä¸Šï¼Œå…·ä½“é€‰æ‹©çš„ä½ç½®åˆ—è¡¨å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">ElementType.ANNOTATION_TYPE <span class="hljs-comment">//èƒ½ä¿®é¥°æ³¨è§£</span><br>ElementType.CONSTRUCTOR <span class="hljs-comment">//èƒ½ä¿®é¥°æ„é€ å™¨</span><br>ElementType.FIELD <span class="hljs-comment">//èƒ½ä¿®é¥°æˆå‘˜å˜é‡</span><br>ElementType.LOCAL_VARIABLE <span class="hljs-comment">//èƒ½ä¿®é¥°å±€éƒ¨å˜é‡</span><br>ElementType.METHOD <span class="hljs-comment">//èƒ½ä¿®é¥°æ–¹æ³•</span><br>ElementType.PACKAGE <span class="hljs-comment">//èƒ½ä¿®é¥°åŒ…å </span><br>ElementType.PARAMETER <span class="hljs-comment">//èƒ½ä¿®é¥°å‚æ•°</span><br>ElementType.TYPE <span class="hljs-comment">//èƒ½ä¿®é¥°ç±»ã€æ¥å£æˆ–æšä¸¾ç±»å‹</span><br>ElementType.TYPE_PARAMETER <span class="hljs-comment">//èƒ½ä¿®é¥°æ³›å‹ï¼Œå¦‚æ³›å‹æ–¹æ³•ã€æ³›å‹ç±»ã€æ³›å‹æ¥å£ ï¼ˆjdk1.8åŠ å…¥ï¼‰</span><br>ElementType.TYPE_USE <span class="hljs-comment">//èƒ½ä¿®é¥°ç±»å‹ å¯ç”¨äºä»»æ„ç±»å‹é™¤äº† class ï¼ˆjdk1.8åŠ å…¥ï¼‰</span><br>  <br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹æ— é™åˆ¶</p><h3 id="2ï¼‰ã€-Retention"><a href="#2ï¼‰ã€-Retention" class="headerlink" title="2ï¼‰ã€@Retention"></a>2ï¼‰ã€@Retention</h3><p>@Retention è¡¨ç¤ºæ³¨è§£çš„çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯é€‰çš„å€¼æœ‰ 3 ä¸ªï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">RetentionPolicy.SOURCE <span class="hljs-comment">//è¡¨ç¤ºæ³¨è§£åªåœ¨æºç ä¸­å­˜åœ¨ï¼Œç¼–è¯‘æˆ class ä¹‹åï¼Œå°±æ²¡äº†</span><br>  <br>RetentionPolicy.CLASS <span class="hljs-comment">//è¡¨ç¤ºæ³¨è§£åœ¨ java æºæ–‡ä»¶ç¼–ç¨‹æˆ .class æ–‡ä»¶åï¼Œä¾ç„¶å­˜åœ¨ï¼Œä½†æ˜¯è¿è¡Œèµ·æ¥åå°±æ²¡äº†</span><br>  <br>RetentionPolicy.RUNTIME <span class="hljs-comment">//è¡¨ç¤ºæ³¨è§£åœ¨è¿è¡Œèµ·æ¥åä¾ç„¶å­˜åœ¨ï¼Œç¨‹åºå¯ä»¥é€šè¿‡åå°„è·å–è¿™äº›ä¿¡æ¯</span><br>  <br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ä¸º <code>RetentionPolicy.CLASS</code></p><h3 id="3ï¼‰ã€-Inherited"><a href="#3ï¼‰ã€-Inherited" class="headerlink" title="3ï¼‰ã€@Inherited"></a>3ï¼‰ã€@Inherited</h3><p>@Inherited è¡¨ç¤ºè¯¥æ³¨è§£å¯è¢«ç»§æ‰¿ï¼Œå³å½“ä¸€ä¸ªå­ç±»ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œè¯¥çˆ¶ç±»æ·»åŠ çš„æ³¨è§£æœ‰è¢« @Inherited ä¿®é¥°ï¼Œé‚£ä¹ˆå­ç±»å°±å¯ä»¥è·å–åˆ°è¯¥æ³¨è§£ï¼Œå¦åˆ™è·å–ä¸åˆ°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ä¸ºä¸å¯ç»§æ‰¿</p><h3 id="4ï¼‰ã€-Documented"><a href="#4ï¼‰ã€-Documented" class="headerlink" title="4ï¼‰ã€@Documented"></a>4ï¼‰ã€@Documented</h3><p>@Documented  è¡¨ç¤ºè¯¥æ³¨è§£åœ¨é€šè¿‡ <code>javadoc</code> å‘½ä»¤ç”Ÿæˆ Api æ–‡æ¡£åï¼Œä¼šå‡ºç°è¯¥æ³¨è§£çš„æ³¨é‡Šè¯´æ˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ä¸ºä¸å‡ºç°</p><h3 id="5ï¼‰ã€-Repeatable"><a href="#5ï¼‰ã€-Repeatable" class="headerlink" title="5ï¼‰ã€@Repeatable"></a>5ï¼‰ã€@Repeatable</h3><p>@Repeatable æ˜¯ JDK 1.8 æ–°å¢çš„å…ƒæ³¨è§£ï¼Œå®ƒè¡¨ç¤ºæ³¨è§£åœ¨åŒä¸€ä¸ªä½ç½®èƒ½å‡ºç°å¤šæ¬¡ï¼Œè¿™ä¸ªæ³¨è§£æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­ç†è§£ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ¸¸æˆç©å®¶æ³¨è§£</span><br><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@interface</span> GamePlayer&#123;<br>    Game[] value();<br>&#125;<br><br><span class="hljs-comment">//æ¸¸æˆæ³¨è§£</span><br><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@Repeatable(GamePlayer.class)</span><br><span class="hljs-meta">@interface</span> Game&#123;<br>    String <span class="hljs-title function_">gameName</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-meta">@Game(gameName = &quot;CF&quot;)</span><br><span class="hljs-meta">@Game(gameName = &quot;LOL&quot;)</span><br><span class="hljs-meta">@Game(gameName = &quot;DNF&quot;)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GameTest</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ä¸å¯é‡å¤</p><p><strong>ç»éªŒ</strong>ï¼šé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªå…ƒæ³¨è§£ç»„åˆæ¥ä¿®é¥°è‡ªå®šä¹‰æ³¨è§£</p><h2 id="ä¸‰ã€æ³¨è§£å±æ€§"><a href="#ä¸‰ã€æ³¨è§£å±æ€§" class="headerlink" title="ä¸‰ã€æ³¨è§£å±æ€§"></a>ä¸‰ã€æ³¨è§£å±æ€§</h2><h3 id="1ï¼‰ã€æ³¨è§£å±æ€§ç±»å‹"><a href="#1ï¼‰ã€æ³¨è§£å±æ€§ç±»å‹" class="headerlink" title="1ï¼‰ã€æ³¨è§£å±æ€§ç±»å‹"></a>1ï¼‰ã€æ³¨è§£å±æ€§ç±»å‹</h3><p>æ³¨è§£å±æ€§ç±»å‹å¯ä»¥ä¸ºä»¥ä¸‹çš„ä¸€äº›ç±»å‹ï¼š</p><p>1ã€åŸºæœ¬æ•°æ®ç±»å‹</p><p>2ã€String</p><p>3ã€æšä¸¾ç±»å‹</p><p>4ã€æ³¨è§£ç±»å‹</p><p>5ã€Class ç±»å‹</p><p>6ã€ä»¥ä¸Šç±»å‹çš„ä¸€ç»´æ•°ç»„ç±»å‹</p><h3 id="2ï¼‰ã€å®šä¹‰æ³¨è§£å±æ€§"><a href="#2ï¼‰ã€å®šä¹‰æ³¨è§£å±æ€§" class="headerlink" title="2ï¼‰ã€å®šä¹‰æ³¨è§£å±æ€§"></a>2ï¼‰ã€å®šä¹‰æ³¨è§£å±æ€§</h3><p>é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€äº›æ³¨è§£å±æ€§ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@interface</span> TestAnnotation&#123;<br>    <span class="hljs-comment">//è¿™å°±æ˜¯æ³¨è§£å±æ€§çš„è¯­æ³•ç»“æ„</span><br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå±æ€§å¹¶ç»™äº†é»˜è®¤å€¼</span><br>    String <span class="hljs-title function_">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&quot;erdai&quot;</span>;<br>  <br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå±æ€§æœªç»™é»˜è®¤å€¼</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">age</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½ä½ ä¼šæœ‰äº›ç–‘é—®ï¼šè¿™éš¾é“ä¸æ˜¯åœ¨å®šä¹‰æ–¹æ³•å—ï¼Ÿè¿˜å¯ä»¥ç»™é»˜è®¤å€¼ï¼Ÿ</p><p>è¿™äº›ç–‘é—®å…ˆç•™ç€ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†æ</p><p>è‡ªå®šä¹‰æ³¨è§£é»˜è®¤éƒ½ä¼šç»§æ‰¿ Annotation ï¼ŒAnnotation æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Annotation</span> &#123;<br>   <br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object obj)</span>;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span>;<br>  <br>    String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>;<br>    <br>    Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Annotation</span>&gt; annotationType();<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ¥å£ä¸­å¯ä»¥å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼Œé‚£ä¹ˆä½œä¸ºè‡ªå®šä¹‰æ³¨è§£ï¼Œæ˜¯å¦ä¹Ÿå¯ä»¥å®šä¹‰å‘¢ï¼Ÿ</p><p>å¯ä»¥ï¼Œæ¥å£ä¸­çš„å±æ€§é»˜è®¤éƒ½æ˜¯ç”¨<code>public static final</code> ä¿®é¥°çš„ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå¯¹äºè‡ªå®šä¹‰æ³¨è§£æ¥è¯´ï¼Œè¿™ç‚¹æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚è€Œæ¥å£ä¸­çš„æ–¹æ³•å…¶å®å°±ç›¸å½“äºè‡ªå®šä¹‰æ³¨è§£çš„å±æ€§ï¼Œåªä¸è¿‡è‡ªå®šä¹‰æ³¨è§£è¿˜å¯ä»¥ç»™é»˜è®¤å€¼ã€‚å› æ­¤æˆ‘ä»¬åœ¨å­¦ä¹ è‡ªå®šä¹‰æ³¨è§£å±æ€§æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠå®ƒå½“ä½œä¸€ä¸ªæ–°çŸ¥è¯†ï¼ŒåŠ ä¸Šæˆ‘åˆšæ‰å¯¹æ¥å£çš„åˆ†æå¯¹æ¯”ï¼Œä½ ä¸Šé¢çš„é‚£äº›ç–‘é—®ä¾¿å¯ä»¥è¿åˆƒè€Œè§£äº†</p><h3 id="3ï¼‰ã€æ³¨è§£å±æ€§ä½¿ç”¨"><a href="#3ï¼‰ã€æ³¨è§£å±æ€§ä½¿ç”¨" class="headerlink" title="3ï¼‰ã€æ³¨è§£å±æ€§ä½¿ç”¨"></a>3ï¼‰ã€æ³¨è§£å±æ€§ä½¿ç”¨</h3><p>1ã€åœ¨ä½¿ç”¨æ³¨è§£çš„åé¢æ¥ä¸Šä¸€å¯¹æ‹¬å·ï¼Œæ‹¬å·é‡Œé¢ä½¿ç”¨ <code>å±æ€§å = value</code> çš„æ ¼å¼ï¼Œå¤šä¸ªå±æ€§ä¹‹é—´ä¸­é—´ç”¨ <code>,</code>éš”å¼€</p><p>2ã€æœªç»™é»˜è®¤å€¼çš„å±æ€§å¿…é¡»è¿›è¡Œèµ‹å€¼ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥çº¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å•ä¸ªå±æ€§</span><br><span class="hljs-meta">@TestAnnotation(age = 18)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br>    <br>&#125;<br><br><span class="hljs-comment">//å¤šä¸ªå±æ€§</span><br><span class="hljs-meta">@TestAnnotation(age = 18,name = &quot;erdai666&quot;)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ï¼‰ã€æ³¨è§£å±æ€§è·å–"><a href="#4ï¼‰ã€æ³¨è§£å±æ€§è·å–" class="headerlink" title="4ï¼‰ã€æ³¨è§£å±æ€§è·å–"></a>4ï¼‰ã€æ³¨è§£å±æ€§è·å–</h3><p>æ³¨è§£å±æ€§çš„è·å–å¯ä»¥å‚è€ƒæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href="https://juejin.cn/post/6977679823132950536">ä¼ é€é—¨</a> ï¼Œä¸Šç¯‡æ–‡ç« æˆ‘ä»¬è®²çš„æ˜¯é€šè¿‡ç±»å¯¹è±¡è·å–æ³¨è§£ï¼Œå’±ä»¬è¡¥å……ç‚¹ä¸Šç¯‡æ–‡ç« æ²¡è®²åˆ°çš„</p><p>1ã€æˆ‘ä»¬åœ¨è·å–å±æ€§çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å­˜åœ¨è¯¥æ³¨è§£ï¼Œå¢å¼ºä»£ç çš„å¥å£®æ€§ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@TestAnnotation(age = 18,name = &quot;erdai666&quot;)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br><br>&#125;<br><br>Class&lt;Test&gt; testClass = Test.class;<br><span class="hljs-comment">//è·å–å½“å‰æ³¨è§£æ˜¯å¦å­˜åœ¨</span><br><span class="hljs-type">boolean</span> <span class="hljs-variable">annotationPresent</span> <span class="hljs-operator">=</span> testClass.isAnnotationPresent(TestAnnotation.class);<br><span class="hljs-comment">//å¦‚æœå­˜åœ¨åˆ™è¿›å…¥æ¡ä»¶ä½“</span><br><span class="hljs-keyword">if</span>(annotationPresent)&#123;<br>    <span class="hljs-type">TestAnnotation</span> <span class="hljs-variable">declaredAnnotation</span> <span class="hljs-operator">=</span> testClass.getDeclaredAnnotation(TestAnnotation.class);<br>    System.out.println(declaredAnnotation.name());<br>    System.out.println(declaredAnnotation.age());<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€è·å–ç±»å±æ€§çš„æ³¨è§£å±æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-meta">@interface</span> TestField&#123;<br>    String <span class="hljs-title function_">filed</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br>    <span class="hljs-meta">@TestField(filed = &quot;æˆ‘æ˜¯å±æ€§&quot;)</span><br>    <span class="hljs-keyword">public</span> String test;<br>&#125;<br><br><span class="hljs-comment">//é€šè¿‡åå°„è·å–å±æ€§æ³¨è§£</span><br>Class&lt;Test&gt; testClass1 = Test.class;<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> testClass1.getDeclaredField(<span class="hljs-string">&quot;test&quot;</span>);<br>    <span class="hljs-keyword">if</span>(field.isAnnotationPresent(TestField.class))&#123;<br>        <span class="hljs-type">TestField</span> <span class="hljs-variable">fieldAnnotation</span> <span class="hljs-operator">=</span> field.getDeclaredAnnotation(TestField.class);<br>        System.out.println(fieldAnnotation.filed());<br>    &#125;<br>&#125; <span class="hljs-keyword">catch</span> (NoSuchFieldException e) &#123;<br>    e.printStackTrace();<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯å±æ€§<br></code></pre></td></tr></table></figure><p>3ã€è·å–ç±»æ–¹æ³•çš„æ³¨è§£å±æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@interface</span> TestMethod&#123;<br>    String <span class="hljs-title function_">method</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br>    <span class="hljs-meta">@TestMethod(method = &quot;æˆ‘æ˜¯æ–¹æ³•&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br>&#125;<br><span class="hljs-comment">//é€šè¿‡åå°„è·å–æ–¹æ³•æ³¨è§£</span><br>Class&lt;Test&gt; testClass2 = Test.class;<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> testClass2.getDeclaredMethod(<span class="hljs-string">&quot;test&quot;</span>);<br>    <span class="hljs-keyword">if</span>(method.isAnnotationPresent(TestMethod.class))&#123;<br>        <span class="hljs-type">TestMethod</span> <span class="hljs-variable">methodAnnotation</span> <span class="hljs-operator">=</span> method.getDeclaredAnnotation(TestMethod.class);<br>        System.out.println(methodAnnotation.method());<br>    &#125;<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    e.printStackTrace();<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯æ–¹æ³•<br></code></pre></td></tr></table></figure><h2 id="å››ã€JDK-æä¾›çš„å†…ç½®æ³¨è§£"><a href="#å››ã€JDK-æä¾›çš„å†…ç½®æ³¨è§£" class="headerlink" title="å››ã€JDK æä¾›çš„å†…ç½®æ³¨è§£"></a>å››ã€JDK æä¾›çš„å†…ç½®æ³¨è§£</h2><p>JDK ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šå†…ç½®çš„æ³¨è§£ï¼Œå…¶ä¸­å¸¸ç”¨çš„æœ‰ï¼š</p><p>)1ã€@Override</p><p>2ã€@Deprecated</p><p>3ã€@SuppressWarnings</p><p>4ã€@FunctionalInterface</p><h3 id="1ï¼‰ã€-Override"><a href="#1ï¼‰ã€-Override" class="headerlink" title="1ï¼‰ã€@Override"></a>1ï¼‰ã€@Override</h3><p>@Override ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œä¾‹å¦‚ <code>toString</code> æ–¹æ³• </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.toString();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€-Deprecated"><a href="#2ï¼‰ã€-Deprecated" class="headerlink" title="2ï¼‰ã€@Deprecated"></a>2ï¼‰ã€@Deprecated</h3><p>@Deprecated è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•è¢«å¼ƒç”¨ï¼Œä¸å»ºè®®å¼€å‘è€…ä½¿ç”¨</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/33397c95cde24591afca8a257d3901cd~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210626113644915" style="zoom:50%;" /><p>å¯ä»¥çœ‹åˆ°ç”¨ @Deprecated æ³¨è§£çš„æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ä¼šè¢«åˆ’æ‰</p><h3 id="3ï¼‰ã€-SuppressWarnings"><a href="#3ï¼‰ã€-SuppressWarnings" class="headerlink" title="3ï¼‰ã€@SuppressWarnings"></a>3ï¼‰ã€@SuppressWarnings</h3><p>@SuppressWarnings ç”¨äºå¿½ç•¥è­¦å‘Šä¿¡æ¯ï¼Œå¸¸è§çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li>deprecationï¼šä½¿ç”¨äº†ä¸èµæˆä½¿ç”¨çš„ç±»æˆ–æ–¹æ³•æ—¶çš„è­¦å‘Šï¼ˆä½¿ç”¨ @Deprecated ä½¿å¾—ç¼–è¯‘å™¨äº§ç”Ÿçš„è­¦å‘Šï¼‰</li><li>uncheckedï¼šæ‰§è¡Œäº†æœªæ£€æŸ¥çš„è½¬æ¢æ—¶çš„è­¦å‘Šï¼Œä¾‹å¦‚å½“ä½¿ç”¨é›†åˆæ—¶æ²¡æœ‰ç”¨æ³›å‹ (Generics) æ¥æŒ‡å®šé›†åˆä¿å­˜çš„ç±»å‹; å…³é—­ç¼–è¯‘å™¨è­¦å‘Š</li><li>fallthroughï¼šå½“ Switch ç¨‹åºå—ç›´æ¥é€šå¾€ä¸‹ä¸€ç§æƒ…å†µè€Œæ²¡æœ‰ Break æ—¶çš„è­¦å‘Š</li><li>pathï¼šåœ¨ç±»è·¯å¾„ã€æºæ–‡ä»¶è·¯å¾„ç­‰ä¸­æœ‰ä¸å­˜åœ¨çš„è·¯å¾„æ—¶çš„è­¦å‘Š</li><li>serialï¼šå½“åœ¨å¯åºåˆ—åŒ–çš„ç±»ä¸Šç¼ºå°‘ serialVersionUID å®šä¹‰æ—¶çš„è­¦å‘Š</li><li>finallyï¼šä»»ä½• finally å­å¥ä¸èƒ½æ­£å¸¸å®Œæˆæ—¶çš„è­¦å‘Š</li><li>rawtypes æ³›å‹ç±»å‹æœªæŒ‡æ˜</li><li>unused å¼•ç”¨å®šä¹‰äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨</li><li>allï¼šå…³äºä»¥ä¸Šæ‰€æœ‰æƒ…å†µçš„è­¦å‘Š</li></ul><p>ä»¥æ³›å‹ä¸¾ä¸ªä¾‹å­ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/33a67f867a124bc184d4625d8a236b03~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210626114048630" style="zoom:50%;" /><p>å½“æˆ‘ä»¬åˆ›å»º List æœªæŒ‡å®šæ³›å‹æ—¶ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é»„æç¤ºæˆ‘ä»¬æœªæŒ‡æ˜æ³›å‹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£äº†ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e5e7263b5a84905b6da544fde609e2d~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210626114241155" style="zoom:50%;" /><h3 id="4ï¼‰ã€-FunctionalInterface"><a href="#4ï¼‰ã€-FunctionalInterface" class="headerlink" title="4ï¼‰ã€@FunctionalInterface"></a>4ï¼‰ã€@FunctionalInterface</h3><p>@FunctionalInterface æ˜¯ JDK 1.8 æ–°å¢çš„æ³¨è§£ï¼Œç”¨äºçº¦å®šå‡½æ•°å¼æ¥å£ï¼Œ<strong>å‡½æ•°å¼æ¥å£å°±æ˜¯æ¥å£ä¸­åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">testInterface</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMethod</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œå½“ä½ æœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•æ—¶ï¼Œæ³¨è§£ä¼šæŠ¥çº¢æç¤ºä½ ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0ab4a93e5dc4080a0bb5f6b52672cca~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210626114855416" style="zoom:50%;" /><h2 id="äº”ã€æ³¨è§£å®é™…åº”ç”¨åœºæ™¯"><a href="#äº”ã€æ³¨è§£å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="äº”ã€æ³¨è§£å®é™…åº”ç”¨åœºæ™¯"></a>äº”ã€æ³¨è§£å®é™…åº”ç”¨åœºæ™¯</h2><h3 id="1ï¼‰ã€ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ä»£æ›¿æšä¸¾ç±»å‹"><a href="#1ï¼‰ã€ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ä»£æ›¿æšä¸¾ç±»å‹" class="headerlink" title="1ï¼‰ã€ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ä»£æ›¿æšä¸¾ç±»å‹"></a>1ï¼‰ã€ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ä»£æ›¿æšä¸¾ç±»å‹</h3><p>ä¸»è¦é’ˆå¯¹æºç é˜¶æ®µæ³¨è§£</p><p>è¿™ä¸ªåœ¨æˆ‘ä»¬å®é™…å·¥ä½œä¸­ä¹ŸæŒºå¸¸ç”¨çš„ï¼Œä½¿ç”¨æšä¸¾ç±»å‹å¼€é”€å¤§ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ›¿ä»£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€ä½¿ç”¨æšä¸¾</span><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">EnumFontType</span>&#123;<br>    ROBOTO_REGULAR,ROBOTO_MEDIUM,ROBOTO_BOLD<br>&#125;<br><span class="hljs-comment">//å®é™…è°ƒç”¨</span><br><span class="hljs-type">EnumFontType</span> <span class="hljs-variable">type1</span> <span class="hljs-operator">=</span> EnumFontType.ROBOTO_BOLD;<br><br><span class="hljs-comment">//================================ å®Œç¾çš„åˆ†å‰²çº¿ ==================================</span><br><span class="hljs-comment">//2ã€ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£</span><br><span class="hljs-meta">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER, ElementType.LOCAL_VARIABLE&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.SOURCE)</span><br><span class="hljs-meta">@IntDef(&#123;AnnotationFontType.ROBOTO_REGULAR,AnnotationFontType.ROBOTO_MEDIUM,AnnotationFontType.ROBOTO_BOLD&#125;)</span><br><span class="hljs-meta">@interface</span> AnnotationFontType&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ROBOTO_REGULAR</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ROBOTO_MEDIUM</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ROBOTO_BOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br>&#125;<br><span class="hljs-comment">//å®é™…è°ƒç”¨</span><br><span class="hljs-meta">@AnnotationFontType</span> <span class="hljs-type">int</span> <span class="hljs-variable">type2</span> <span class="hljs-operator">=</span> AnnotationFontType.ROBOTO_MEDIUM;<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€æ³¨è§£å¤„ç†å™¨-APT"><a href="#2ï¼‰ã€æ³¨è§£å¤„ç†å™¨-APT" class="headerlink" title="2ï¼‰ã€æ³¨è§£å¤„ç†å™¨ (APT)"></a>2ï¼‰ã€æ³¨è§£å¤„ç†å™¨ (APT)</h3><p>ä¸»è¦é’ˆå¯¹ç¼–è¯‘é˜¶æ®µæ³¨è§£</p><p>å®é™…æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å®ƒï¼Œå› ä¸ºæˆ‘ä»¬å¸¸ç”¨çš„ä¸€äº›å¼€æºåº“å¦‚ ButterKnifeï¼ŒRetrofitï¼ŒArouterï¼ŒEventBus ç­‰ç­‰éƒ½ä½¿ç”¨åˆ°äº† APT æŠ€æœ¯ã€‚ä¹Ÿæ­£æ˜¯å› ä¸ºè¿™äº›è‘—åçš„å¼€æºåº“ï¼Œæ‰ä½¿å¾— APT æŠ€æœ¯è¶Šæ¥è¶Šç«ï¼Œåœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä¹Ÿä¼šè®²åˆ°ã€‚</p><h3 id="3ï¼‰ã€è¿è¡Œæ—¶æ³¨è§£å¤„ç†"><a href="#3ï¼‰ã€è¿è¡Œæ—¶æ³¨è§£å¤„ç†" class="headerlink" title="3ï¼‰ã€è¿è¡Œæ—¶æ³¨è§£å¤„ç†"></a>3ï¼‰ã€è¿è¡Œæ—¶æ³¨è§£å¤„ç†</h3><p>ä¸»è¦é’ˆå¯¹è¿è¡Œé˜¶æ®µæ³¨è§£</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼šä¾‹å¦‚æˆ‘ä»¬å¼€è½¦å»è‡ªåŠ©åŠ æ²¹æœºåŠ æ²¹ï¼Œè®¾å®šçš„ Money æ˜¯ 200ï¼Œå¦‚æœå°‘äº 200 åˆ™æç¤º <code>åŠ æ²¹ä¸­...</code>ï¼Œå¦åˆ™æç¤º <code>æ²¹å·²åŠ æ»¡</code>ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸æƒ…å†µï¼Œæç¤º <code>åŠ æ²¹å¤±è´¥</code></p><p>ç°åœ¨æˆ‘ä»¬é€šè¿‡æ³¨è§£æ¥å®ç°ä¸€ä¸‹å®ƒï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@interface</span> OilAnnotation&#123;<br>    <span class="hljs-type">double</span> <span class="hljs-title function_">maxOilMoney</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GasStation</span>&#123;<br><br>    <span class="hljs-meta">@OilAnnotation(maxOilMoney = 200)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addOil</span><span class="hljs-params">(<span class="hljs-type">double</span> money)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">tips</span> <span class="hljs-operator">=</span> processOilAnnotation(money);<br>        System.out.println(tips);<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;all&quot;)</span><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">processOilAnnotation</span><span class="hljs-params">(<span class="hljs-type">double</span> money)</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Class&lt;GasStation&gt; aClass = GasStation.class;<br>            <span class="hljs-comment">//è·å–å½“å‰æ–¹æ³•çš„æ³¨è§£</span><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">addOilMethod</span> <span class="hljs-operator">=</span> aClass.getDeclaredMethod(<span class="hljs-string">&quot;addOil&quot;</span>, <span class="hljs-type">double</span>.class);<br>            <span class="hljs-comment">//è·å–æ–¹æ³•æ³¨è§£æ˜¯å¦å­˜åœ¨</span><br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">annotationPresent</span> <span class="hljs-operator">=</span> addOilMethod.isAnnotationPresent(OilAnnotation.class);<br>            <span class="hljs-keyword">if</span>(annotationPresent)&#123;<br>                <span class="hljs-type">OilAnnotation</span> <span class="hljs-variable">oilAnnotation</span> <span class="hljs-operator">=</span> addOilMethod.getDeclaredAnnotation(OilAnnotation.class);<br>                <span class="hljs-keyword">if</span>(money &gt;= oilAnnotation.maxOilMoney())&#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ²¹å·²åŠ æ»¡&quot;</span>;<br>                &#125;<span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;åŠ æ²¹ä¸­...&quot;</span>;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;åŠ æ²¹å¤±è´¥&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">GasStation</span>().addOil(<span class="hljs-number">100</span>);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>åŠ æ²¹ä¸­...<br>  <br><span class="hljs-keyword">new</span> <span class="hljs-title class_">GasStation</span>().addOil(<span class="hljs-number">200</span>);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ²¹å·²åŠ æ»¡<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€è‡ªå®šä¹‰æ³¨è§£æ—¶ï¼Œå…ƒæ³¨è§£çš„ç»„åˆä½¿ç”¨</p><p>2ã€æ³¨è§£å±æ€§çš„å®šä¹‰ï¼Œä½¿ç”¨å’Œè·å–</p><p>3ã€ä¸€äº›å¸¸ç”¨çš„ JDK å†…ç½®æ³¨è§£</p><p>4ã€æ³¨è§£çš„å®é™…åº”ç”¨åŠè¿è¡Œé˜¶æ®µæ³¨è§£çš„ä¸€ä¸ªå®è·µ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ­£å¼å¼€å§‹ APT æŠ€æœ¯çš„è®²è§£äº†ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/6844903833299058702">Java æ³¨è§£å®Œå…¨è§£æ</a></p><p><a href="https://www.jianshu.com/p/5871e1186840">ã€ŒJava è·¯çº¿ã€| æ³¨è§£ï¼ˆå« Kotlinï¼‰</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>APT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android APT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android APT ç³»åˆ— ï¼ˆä¸€ï¼‰ï¼šAPT ç­‘åŸºä¹‹åå°„</title>
    <link href="/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AAPT%20%E7%AD%91%E5%9F%BA%E4%B9%8B%E5%8F%8D%E5%B0%84/"/>
    <url>/2022/10/10/Android%20APT%20%E7%B3%BB%E5%88%97%20%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9AAPT%20%E7%AD%91%E5%9F%BA%E4%B9%8B%E5%8F%8D%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2efcab2ef7b4420e950e01c716a6d82f~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>è¿™åˆæ˜¯ä¸€ä¸ªæ–°çš„ç³»åˆ—ï¼Œçµæ„Ÿæ¥æºäºæœ€è¿‘åšçš„ä¸€æ¬¡å¸ƒå±€ä¼˜åŒ–ï¼Œæˆ‘ä»¬çŸ¥é“ï¼šAndroid ä¸­å°‘é‡çš„ç³»ç»Ÿæ§ä»¶æ˜¯é€šè¿‡ <code>new</code> çš„æ–¹å¼åˆ›å»ºå‡ºæ¥çš„ï¼Œè€Œå¤§éƒ¨åˆ†æ§ä»¶å¦‚ <code>androidx.appcompat.widget</code> ä¸‹çš„æ§ä»¶ï¼Œè‡ªå®šä¹‰æ§ä»¶ï¼Œç¬¬ä¸‰æ–¹æ§ä»¶ç­‰ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡åå°„åˆ›å»ºçš„ã€‚å¤§é‡çš„åå°„åˆ›å»ºå¤šå¤šå°‘å°‘ä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å»è§£å†³åå°„åˆ›å»ºçš„é—®é¢˜ï¼Œæˆ‘çš„è§£å†³æ€è·¯æ˜¯ï¼š</p><blockquote><p>1ã€é€šè¿‡ç¼–å†™ Android æ’ä»¶è·å– Xml å¸ƒå±€ä¸­çš„æ‰€æœ‰æ§ä»¶ </p><p>2ã€æ‹¿åˆ°æ§ä»¶åï¼Œé€šè¿‡ APT ç”Ÿæˆç”¨ <code>new</code> çš„æ–¹å¼åˆ›å»º View çš„ç±» </p><p>3ã€æœ€åé€šè¿‡åå°„è·å–å½“å‰ç±»å¹¶åœ¨åŸºç±»é‡Œé¢å®Œæˆæ›¿æ¢</p></blockquote><p>ä¸€ä¸ªå°å°çš„å¸ƒå±€ä¼˜åŒ–ï¼Œæ¶‰åŠçš„ä¸œè¥¿è¿˜æŒºå¤šçš„ï¼ŒAndroid æ’ä»¶æˆ‘ä»¬åç»­åœ¨è®²ï¼Œè¯è¯´ Gradle ç³»åˆ—ç›®å‰åªæ›´äº†ä¸€ç¯‡ğŸ˜‚ï¼Œåˆ«æ€¥ï¼Œåé¢éƒ½ä¼šæœ‰çš„ã€‚æˆ‘ä»¬è¿™ä¸ªç³»åˆ—ä¸»è¦æ˜¯è®² APTï¼Œè€Œè®² APT ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆäº†è§£ä¸¤ä¸ªé‡ç‚¹çŸ¥è¯†ï¼š<strong>æ³¨è§£å’Œåå°„</strong></p><p>ä»Šå¤©å°±é‡ç‚¹æ¥ä»‹ç»ä¸‹åå°„</p><p><a href="https://github.com/sweetying520/AptDemo">Github Demo åœ°å€</a> , å¤§å®¶å¯ä»¥çœ‹ Demo è·Ÿéšæˆ‘çš„æ€è·¯ä¸€èµ·åˆ†æ</p><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</h2><p>ç®€å•æ¥è®²ï¼Œåå°„å°±æ˜¯ï¼š<strong>å·²çŸ¥ä¸€ä¸ªç±»ï¼Œå¯ä»¥è·å–è¿™ä¸ªç±»çš„æ‰€æœ‰ä¿¡æ¯</strong></p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ ¹æ®é¢å‘å¯¹è±¡å°è£…åŸåˆ™ï¼ŒJava å®ä½“ç±»çš„å±æ€§éƒ½æ˜¯ç§æœ‰çš„ï¼Œæˆ‘ä»¬ä¸èƒ½è·å–ç±»ä¸­çš„å±æ€§ã€‚ä½†æˆ‘ä»¬å¯ä»¥æ ¹æ®åå°„ï¼Œè·å–ç§æœ‰å˜é‡ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ï¼Œæ³¨è§£ï¼Œæ³›å‹ç­‰ç­‰ï¼Œéå¸¸çš„å¼ºå¤§</p><p><strong>æ³¨æ„</strong>ï¼šGoogle åœ¨ Android 9.0 åŠä¹‹åå¯¹åå°„åšäº†é™åˆ¶ï¼Œè¢«ä½¿ç”¨ <code>@hide</code> æ ‡è®°çš„å±æ€§å’Œæ–¹æ³•é€šè¿‡åå°„æ‹¿ä¸åˆ°</p><h2 id="äºŒã€åå°„ä½¿ç”¨"><a href="#äºŒã€åå°„ä½¿ç”¨" class="headerlink" title="äºŒã€åå°„ä½¿ç”¨"></a>äºŒã€åå°„ä½¿ç”¨</h2><p>ä¸‹é¢ç»™å‡ºä¸€æ®µå·²çŸ¥çš„ä»£ç ï¼Œæˆ‘ä»¬é€šè¿‡å®è·µæ¥å¯¹åå°„è¿›è¡Œè®²è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åŒ…è·¯å¾„</span><br><span class="hljs-keyword">package</span> com.dream.aptdemo;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰æ³¨è§£1</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@interface</span> CustomAnnotation1&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰æ³¨è§£2</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@interface</span> CustomAnnotation2&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰æ³¨è§£3</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@interface</span> CustomAnnotation3&#123;<br><br>&#125;<br><br><span class="hljs-comment">//æ¥å£</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ICar</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">combine</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">//è½¦</span><br><span class="hljs-meta">@CustomAnnotation3</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>&lt;K,V&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">carDesign</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;è®¾è®¡ç¨¿&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-variable">engine</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;å‘åŠ¨æœº&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(<span class="hljs-type">long</span> kilometer)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Car run &quot;</span> + kilometer + <span class="hljs-string">&quot; km&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//==============================ä¸Šé¢è¿™äº›éƒ½æ˜¯ä¸ºä¸‹é¢è¿™å°å¥”é©°æœåŠ¡çš„ğŸ˜‚===========================</span><br><span class="hljs-comment">//å¥”é©°</span><br><span class="hljs-meta">@CustomAnnotation1</span><br><span class="hljs-meta">@CustomAnnotation2</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Benz</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Car</span>&lt;String,Integer&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ICar</span> &#123;<br>  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">carName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;å¥”é©°&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-variable">carColor</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ç™½è‰²&quot;</span>;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Benz</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Benz</span><span class="hljs-params">(String carName)</span> &#123;<br>        <span class="hljs-built_in">this</span>.carName = carName;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Benz</span><span class="hljs-params">(String carName, String carColor)</span> &#123;<br>        <span class="hljs-built_in">this</span>.carName = carName;<br>        <span class="hljs-built_in">this</span>.carColor = carColor;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">combine</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ç»„è£…ä¸€å°å¥”é©°&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">privateMethod</span><span class="hljs-params">(String params)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ç§æœ‰æ–¹æ³•: &quot;</span> + params);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ‰€è®²åˆ°çš„éƒ½æ˜¯å…³äºåå°„ä¸€äº›å¸¸ç”¨çš„ Api</p><h2 id="ä¸‰ã€ç±»"><a href="#ä¸‰ã€ç±»" class="headerlink" title="ä¸‰ã€ç±»"></a>ä¸‰ã€ç±»</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ 3 ç§æ–¹å¼å»è·å–ç±»å¯¹è±¡ï¼š</p><h3 id="1ï¼‰ã€Benz-class-ï¼šç±»è·å–"><a href="#1ï¼‰ã€Benz-class-ï¼šç±»è·å–" class="headerlink" title="1ï¼‰ã€Benz.class ï¼šç±»è·å–"></a>1ï¼‰ã€<code>Benz.class</code> ï¼šç±»è·å–</h3><h3 id="2ï¼‰ã€benz-getClass-ï¼šå¯¹è±¡è·å–"><a href="#2ï¼‰ã€benz-getClass-ï¼šå¯¹è±¡è·å–" class="headerlink" title="2ï¼‰ã€benz.getClass ï¼šå¯¹è±¡è·å–"></a>2ï¼‰ã€<code>benz.getClass</code> ï¼šå¯¹è±¡è·å–</h3><h3 id="3ï¼‰ã€Class-forName-ï¼šé™æ€è·å–"><a href="#3ï¼‰ã€Class-forName-ï¼šé™æ€è·å–" class="headerlink" title="3ï¼‰ã€Class.forName ï¼šé™æ€è·å–"></a>3ï¼‰ã€<code>Class.forName</code> ï¼šé™æ€è·å–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Benz</span> <span class="hljs-variable">benz</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Benz</span>();<br><span class="hljs-type">Class</span> <span class="hljs-variable">benzClass</span> <span class="hljs-operator">=</span> Benz.class;<br><span class="hljs-type">Class</span> <span class="hljs-variable">benzClass1</span> <span class="hljs-operator">=</span> benz.getClass();<br><span class="hljs-type">Class</span> <span class="hljs-variable">benzClass2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.dream.aptdemo.Benz&quot;</span>);<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><p>1ã€åœ¨ä¸€ä¸ª JVM ä¸­ï¼Œä¸€ç§ç±»ï¼Œåªä¼šæœ‰ä¸€ä¸ªç±»å¯¹è±¡å­˜åœ¨ã€‚æ‰€ä»¥ä»¥ä¸Šä¸‰ç§æ–¹å¼å–å‡ºæ¥çš„ç±»å¯¹è±¡ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>2ã€æ— è®ºå“ªç§é€”å¾„è·å–ç±»å¯¹è±¡ï¼Œéƒ½ä¼šå¯¼è‡´é™æ€å±æ€§è¢«åˆå§‹åŒ–ï¼Œè€Œä¸”åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ï¼ˆé™¤äº†ç›´æ¥ä½¿ç”¨ <code>Benz.class</code> ç±»è·å–è¿™ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼ä¸ä¼šå¯¼è‡´é™æ€å±æ€§è¢«åˆå§‹åŒ–ï¼‰</p><p><strong>ä¸‹é¢çš„æµç¨‹ä¼šç»å¸¸ä½¿ç”¨åˆ° benz å®ä¾‹å’Œ benzClass ç±»å¯¹è±¡</strong></p><h3 id="4ï¼‰ã€è·å–ç±»å"><a href="#4ï¼‰ã€è·å–ç±»å" class="headerlink" title="4ï¼‰ã€è·å–ç±»å"></a>4ï¼‰ã€è·å–ç±»å</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> benzClass.getSimpleName();<br>System.out.println(className);<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Benz<br></code></pre></td></tr></table></figure><h3 id="5ï¼‰ã€è·å–ç±»è·¯å¾„"><a href="#5ï¼‰ã€è·å–ç±»è·¯å¾„" class="headerlink" title="5ï¼‰ã€è·å–ç±»è·¯å¾„"></a>5ï¼‰ã€è·å–ç±»è·¯å¾„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">classPath1</span> <span class="hljs-operator">=</span> benzClass.getName();<br><span class="hljs-type">String</span> <span class="hljs-variable">classPath2</span> <span class="hljs-operator">=</span> benzClass.getCanonicalName();<br>System.out.println(classPath1);<br>System.out.println(classPath2);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>com.dream.aptdemo.Benz<br>com.dream.aptdemo.Benz<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯èƒ½å¤§å®¶ä¼šæœ‰ä¸ªç–‘é—®ï¼š<code>benzClass.getName()</code> å’Œ <code>benzClass.getCanonicalName()</code> æœ‰å•¥åŒºåˆ«å—ï¼Ÿ</p><p>ä»ä¸Šé¢æ‰“å°ç»“æœæ¥çœ‹ï¼Œæ²¡å•¥åŒºåˆ«ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨ Benz è¿™ä¸ªé‡Œé¢åŠ ä¸ªå†…éƒ¨ç±»ï¼Œç„¶åè·å–å†…éƒ¨ç±»çš„è·¯å¾„ï¼Œä½ å°±ä¼šçœ‹åˆ°åŒºåˆ«äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//...</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Benz</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ICar</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">InnerClass</span>&#123;<br>        <br>    &#125;<br>&#125;<br><br>Class&lt;Benz.InnerClass&gt; innerClass = Benz.InnerClass.class;<br>System.out.println(innerClass.getName());<br>System.out.println(innerClass.getCanonicalName());<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>com.dream.aptdemo.Benz$InnerClass<br>com.dream.aptdemo.Benz.InnerClass<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°åŒºåˆ«äº†å§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç»“è®ºï¼š<strong>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œ<code>getCanonicalName</code>å’Œ <code>getName</code> è·å–åˆ°çš„éƒ½æ˜¯åŒ…å«è·¯å¾„çš„ç±»åã€‚ä½†å†…éƒ¨ç±»æœ‰ç‚¹ç‰¹æ®Šï¼ŒgetName è·å–çš„æ˜¯è·¯å¾„.ç±»å$å†…éƒ¨ç±»</strong></p><h3 id="6ï¼‰ã€è·å–çˆ¶ç±»å"><a href="#6ï¼‰ã€è·å–çˆ¶ç±»å" class="headerlink" title="6ï¼‰ã€è·å–çˆ¶ç±»å"></a>6ï¼‰ã€è·å–çˆ¶ç±»å</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">fatherClassName</span> <span class="hljs-operator">=</span> benzClass.getSuperclass().getSimpleName();<br>System.out.println(fatherClassName);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Car<br></code></pre></td></tr></table></figure><h3 id="7ï¼‰ã€è·å–æ¥å£"><a href="#7ï¼‰ã€è·å–æ¥å£" class="headerlink" title="7ï¼‰ã€è·å–æ¥å£"></a>7ï¼‰ã€è·å–æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Class[] interfaces = benzClass.getInterfaces();<br><span class="hljs-keyword">for</span> (Class anInterface : interfaces) &#123;<br>    System.out.println(anInterface.getName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>com.dream.aptdemo.ICar<br></code></pre></td></tr></table></figure><h3 id="8ï¼‰ã€åˆ›å»ºå®ä¾‹å¯¹è±¡"><a href="#8ï¼‰ã€åˆ›å»ºå®ä¾‹å¯¹è±¡" class="headerlink" title="8ï¼‰ã€åˆ›å»ºå®ä¾‹å¯¹è±¡"></a>8ï¼‰ã€åˆ›å»ºå®ä¾‹å¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æ„é€ æ–¹æ³•</span><br><span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> benzClass.getDeclaredConstructor();<br><span class="hljs-comment">//åˆ›å»ºå®ä¾‹</span><br><span class="hljs-type">Benz</span> <span class="hljs-variable">myBenz</span> <span class="hljs-operator">=</span> (Benz) constructor.newInstance();<br><span class="hljs-comment">//ä¿®æ”¹å±æ€§</span><br>myBenz.carColor = <span class="hljs-string">&quot;é»‘è‰²&quot;</span>;<br>myBenz.combine();<br>System.out.println(myBenz.carColor);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç»„è£…ä¸€å°å¥”é©°<br>é»‘è‰²<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢è¦è®²çš„å…³äºå¸¦ <code>Declare</code> çš„å±æ€§å’Œæ–¹æ³•å’Œä¸å¸¦<code>Declare</code> åŒºåˆ«ï¼š</p><p><strong>1ã€å¸¦  <code>Declare</code> çš„å±æ€§å’Œæ–¹æ³•è·å–çš„æ˜¯æœ¬ç±»æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¸åŒ…å«ç»§æ‰¿å¾—æ¥çš„</strong></p><p><strong>2ã€ä¸å¸¦  <code>Declare</code> çš„å±æ€§å’Œæ–¹æ³•è·å–çš„æ˜¯æ‰€æœ‰ <code>public</code> ä¿®é¥°çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŒ…å«ç»§æ‰¿å¾—æ¥çš„</strong></p><p><strong>3ã€è®¿é—® <code>private</code> ä¿®é¥°çš„å±æ€§å’Œæ–¹æ³•ï¼Œéœ€è°ƒç”¨ <code>setAccessible</code> è®¾ç½®ä¸º true ï¼Œè¡¨ç¤ºå…è®¸æˆ‘ä»¬è®¿é—®ç§æœ‰å˜é‡</strong></p><h2 id="å››ã€å±æ€§"><a href="#å››ã€å±æ€§" class="headerlink" title="å››ã€å±æ€§"></a>å››ã€å±æ€§</h2><h3 id="1ï¼‰ã€è·å–å•ä¸ªå±æ€§"><a href="#1ï¼‰ã€è·å–å•ä¸ªå±æ€§" class="headerlink" title="1ï¼‰ã€è·å–å•ä¸ªå±æ€§"></a>1ï¼‰ã€è·å–å•ä¸ªå±æ€§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Field</span> <span class="hljs-variable">carName</span> <span class="hljs-operator">=</span> benzClass.getDeclaredField(<span class="hljs-string">&quot;carName&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€è·å–å¤šä¸ªå±æ€§"><a href="#2ï¼‰ã€è·å–å¤šä¸ªå±æ€§" class="headerlink" title="2ï¼‰ã€è·å–å¤šä¸ªå±æ€§"></a>2ï¼‰ã€è·å–å¤šä¸ªå±æ€§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æœ¬ç±»å…¨éƒ¨å±æ€§</span><br>Field[] declaredFields = benzClass.getDeclaredFields();<br><span class="hljs-keyword">for</span> (Field declaredField : declaredFields) &#123;<br>    System.out.println(<span class="hljs-string">&quot;å±æ€§: &quot;</span> + declaredField.getName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å±æ€§: carName<br>å±æ€§: carColor<br><br><span class="hljs-comment">//è·å–æœ¬ç±»åŠçˆ¶ç±»å…¨éƒ¨ public ä¿®é¥°çš„å±æ€§</span><br>Field[] fields = benzClass.getFields();<br><span class="hljs-keyword">for</span> (Field field : fields) &#123;<br>    System.out.println(<span class="hljs-string">&quot;å±æ€§: &quot;</span> + field.getName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å±æ€§: carColor<br>å±æ€§: engine<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€è®¾ç½®å…è®¸è®¿é—®ç§æœ‰å˜é‡"><a href="#3ï¼‰ã€è®¾ç½®å…è®¸è®¿é—®ç§æœ‰å˜é‡" class="headerlink" title="3ï¼‰ã€è®¾ç½®å…è®¸è®¿é—®ç§æœ‰å˜é‡"></a>3ï¼‰ã€è®¾ç½®å…è®¸è®¿é—®ç§æœ‰å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">carName.setAccessible(<span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure><p>4ï¼‰ã€è·å–å±æ€§å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(carName.getName());<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>carName<br></code></pre></td></tr></table></figure><p>5ï¼‰ã€è·å–å˜é‡ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(carName.getType().getName());<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>java.lang.String<br></code></pre></td></tr></table></figure><p>6ï¼‰ã€è·å–å¯¹è±¡ä¸­è¯¥å±æ€§çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(carName.get(benz));<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¥”é©°<br></code></pre></td></tr></table></figure><p>7ï¼‰ã€ç»™å±æ€§è®¾ç½®å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">carName.set(benz,<span class="hljs-string">&quot;sweetying&quot;</span>);<br>System.out.println(carName.get(benz));<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>sweetying<br></code></pre></td></tr></table></figure><h2 id="äº”ã€æ–¹æ³•"><a href="#äº”ã€æ–¹æ³•" class="headerlink" title="äº”ã€æ–¹æ³•"></a>äº”ã€æ–¹æ³•</h2><h3 id="1ï¼‰ã€è·å–å•ä¸ªæ–¹æ³•"><a href="#1ï¼‰ã€è·å–å•ä¸ªæ–¹æ³•" class="headerlink" title="1ï¼‰ã€è·å–å•ä¸ªæ–¹æ³•"></a>1ï¼‰ã€è·å–å•ä¸ªæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å– public æ–¹æ³•</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">publicMethod</span> <span class="hljs-operator">=</span> benzClass.getMethod(<span class="hljs-string">&quot;combine&quot;</span>);<br><br><span class="hljs-comment">//è·å– private æ–¹æ³•</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">privateMethod</span> <span class="hljs-operator">=</span> benzClass.getDeclaredMethod(<span class="hljs-string">&quot;privateMethod&quot;</span>,String.class);<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€è·å–å¤šä¸ªæ–¹æ³•"><a href="#2ï¼‰ã€è·å–å¤šä¸ªæ–¹æ³•" class="headerlink" title="2ï¼‰ã€è·å–å¤šä¸ªæ–¹æ³•"></a>2ï¼‰ã€è·å–å¤šä¸ªæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æœ¬ç±»å…¨éƒ¨æ–¹æ³•</span><br>Method[] declaredMethods = benzClass.getDeclaredMethods();<br><span class="hljs-keyword">for</span> (Method declaredMethod : declaredMethods) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ–¹æ³•å: &quot;</span> + declaredMethod.getName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ–¹æ³•å: privateMethod<br>æ–¹æ³•å: combine<br><br><br><span class="hljs-comment">//è·å–æœ¬ç±»åŠçˆ¶ç±»å…¨éƒ¨ public ä¿®é¥°çš„æ–¹æ³•</span><br>Method[] methods = benzClass.getMethods();<br><span class="hljs-keyword">for</span> (Method method : methods) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ–¹æ³•å: &quot;</span> + method.getName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ å› ä¸ºæ‰€æœ‰ç±»é»˜è®¤ç»§æ‰¿ Object , æ‰€ä»¥æ‰“å°äº† Object çš„ä¸€äº›æ–¹æ³•</span><br>æ–¹æ³•å: combine<br>æ–¹æ³•å: run<br>æ–¹æ³•å: wait<br>æ–¹æ³•å: wait<br>æ–¹æ³•å: wait<br>æ–¹æ³•å: equals<br>æ–¹æ³•å: toString<br>æ–¹æ³•å: hashCode<br>æ–¹æ³•å: getClass<br>æ–¹æ³•å: notify<br>æ–¹æ³•å: notifyAll<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€æ–¹æ³•è°ƒç”¨"><a href="#3ï¼‰ã€æ–¹æ³•è°ƒç”¨" class="headerlink" title="3ï¼‰ã€æ–¹æ³•è°ƒç”¨"></a>3ï¼‰ã€æ–¹æ³•è°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Method</span> <span class="hljs-variable">privateMethod</span> <span class="hljs-operator">=</span> benzClass.getDeclaredMethod(<span class="hljs-string">&quot;privateMethod&quot;</span>,String.class);<br>privateMethod.setAccessible(<span class="hljs-literal">true</span>);<br>privateMethod.invoke(benz,<span class="hljs-string">&quot;æ¥æ”¶ä¼ å…¥çš„å‚æ•°&quot;</span>);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æˆ‘æ˜¯ç§æœ‰æ–¹æ³•: æ¥æ”¶ä¼ å…¥çš„å‚æ•°<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ„é€ æ–¹æ³•"><a href="#å…­ã€æ„é€ æ–¹æ³•" class="headerlink" title="å…­ã€æ„é€ æ–¹æ³•"></a>å…­ã€æ„é€ æ–¹æ³•</h2><h3 id="1ï¼‰ã€è·å–å•ä¸ªæ„é€ æ–¹æ³•"><a href="#1ï¼‰ã€è·å–å•ä¸ªæ„é€ æ–¹æ³•" class="headerlink" title="1ï¼‰ã€è·å–å•ä¸ªæ„é€ æ–¹æ³•"></a>1ï¼‰ã€è·å–å•ä¸ªæ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æœ¬ç±»å•ä¸ªæ„é€ æ–¹æ³•</span><br><span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> benzClass.getDeclaredConstructor(String.class);<br><br><span class="hljs-comment">//è·å–æœ¬ç±»å•ä¸ª public ä¿®é¥°çš„æ„é€ æ–¹æ³•</span><br><span class="hljs-type">Constructor</span> <span class="hljs-variable">singleConstructor</span> <span class="hljs-operator">=</span> benzClass.getConstructor(String.class,String.class);<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€è·å–å¤šä¸ªæ„é€ æ–¹æ³•"><a href="#2ï¼‰ã€è·å–å¤šä¸ªæ„é€ æ–¹æ³•" class="headerlink" title="2ï¼‰ã€è·å–å¤šä¸ªæ„é€ æ–¹æ³•"></a>2ï¼‰ã€è·å–å¤šä¸ªæ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æœ¬ç±»å…¨éƒ¨æ„é€ æ–¹æ³•</span><br>Constructor[] declaredConstructors = benzClass.getDeclaredConstructors();<br><span class="hljs-keyword">for</span> (Constructor declaredConstructor1 : declaredConstructors) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ„é€ æ–¹æ³•: &quot;</span> + declaredConstructor1);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ„é€ æ–¹æ³•: <span class="hljs-keyword">public</span> com.dream.aptdemo.Benz()<br>æ„é€ æ–¹æ³•: <span class="hljs-keyword">public</span> com.dream.aptdemo.Benz(java.lang.String,java.lang.String)<br>æ„é€ æ–¹æ³•: <span class="hljs-keyword">private</span> com.dream.aptdemo.Benz(java.lang.String)<br><br><br><span class="hljs-comment">//è·å–å…¨éƒ¨ public æ„é€ æ–¹æ³•, ä¸åŒ…å«çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span><br>Constructor[] constructors = benzClass.getConstructors();<br><span class="hljs-keyword">for</span> (Constructor constructor1 : constructors) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ„é€ æ–¹æ³•: &quot;</span> + constructor1);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ„é€ æ–¹æ³•: <span class="hljs-keyword">public</span> com.dream.aptdemo.Benz()<br>æ„é€ æ–¹æ³•: <span class="hljs-keyword">public</span> com.dream.aptdemo.Benz(java.lang.String,java.lang.String)<br></code></pre></td></tr></table></figure><h3 id="3ï¼‰ã€æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡"><a href="#3ï¼‰ã€æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="3ï¼‰ã€æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡"></a>3ï¼‰ã€æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä»¥ä¸Šé¢ declaredConstructor ä¸ºä¾‹</span><br>declaredConstructor.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-type">Benz</span> <span class="hljs-variable">declareBenz</span> <span class="hljs-operator">=</span> (Benz) declaredConstructor.newInstance(<span class="hljs-string">&quot;&quot;</span>);<br>System.out.println(declareBenz.carColor);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç™½è‰²<br><br><span class="hljs-comment">//ä»¥ä¸Šé¢ singleConstructor ä¸ºä¾‹</span><br><span class="hljs-type">Benz</span> <span class="hljs-variable">singleBenz</span> <span class="hljs-operator">=</span> (Benz) singleConstructor.newInstance(<span class="hljs-string">&quot;å¥”é©° S &quot;</span>,<span class="hljs-string">&quot;é¦™æ§Ÿé‡‘&quot;</span>);<br>System.out.println(singleBenz.carColor);<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>é¦™æ§Ÿé‡‘<br></code></pre></td></tr></table></figure><h2 id="ä¸ƒã€æ³›å‹"><a href="#ä¸ƒã€æ³›å‹" class="headerlink" title="ä¸ƒã€æ³›å‹"></a>ä¸ƒã€æ³›å‹</h2><h3 id="1ï¼‰ã€è·å–çˆ¶ç±»çš„æ³›å‹"><a href="#1ï¼‰ã€è·å–çˆ¶ç±»çš„æ³›å‹" class="headerlink" title="1ï¼‰ã€è·å–çˆ¶ç±»çš„æ³›å‹"></a>1ï¼‰ã€è·å–çˆ¶ç±»çš„æ³›å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Type</span> <span class="hljs-variable">genericType</span> <span class="hljs-operator">=</span> benzClass.getGenericSuperclass();<br><span class="hljs-keyword">if</span> (genericType <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>   Type[] actualType = ((ParameterizedType) genericType).getActualTypeArguments();<br>   <span class="hljs-keyword">for</span> (Type type : actualType) &#123;<br>       System.out.println(type.getTypeName());<br>   &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>java.lang.String<br>java.lang.Integer<br></code></pre></td></tr></table></figure><h2 id="å…«ã€æ³¨è§£"><a href="#å…«ã€æ³¨è§£" class="headerlink" title="å…«ã€æ³¨è§£"></a>å…«ã€æ³¨è§£</h2><h3 id="1ï¼‰ã€è·å–å•ä¸ªæ³¨è§£"><a href="#1ï¼‰ã€è·å–å•ä¸ªæ³¨è§£" class="headerlink" title="1ï¼‰ã€è·å–å•ä¸ªæ³¨è§£"></a>1ï¼‰ã€è·å–å•ä¸ªæ³¨è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–å•ä¸ªæœ¬ç±»æˆ–çˆ¶ç±»æ³¨è§£</span><br><span class="hljs-type">Annotation</span> <span class="hljs-variable">annotation1</span> <span class="hljs-operator">=</span> benzClass.getAnnotation(CustomAnnotation1.class);<br>System.out.println(annotation1.annotationType().getSimpleName());<br><span class="hljs-type">Annotation</span> <span class="hljs-variable">annotation3</span> <span class="hljs-operator">=</span> benzClass.getAnnotation(CustomAnnotation3.class);<br>System.out.println(annotation3.annotationType().getSimpleName());<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>CustomAnnotation1<br>CustomAnnotation3<br><br><span class="hljs-comment">//è·å–å•ä¸ªæœ¬ç±»æ³¨è§£</span><br><span class="hljs-type">Annotation</span> <span class="hljs-variable">declaredAnnotation1</span> <span class="hljs-operator">=</span> benzClass.getDeclaredAnnotation(CustomAnnotation2.class);<br>System.out.println(declaredAnnotation1.annotationType().getSimpleName());<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>CustomAnnotation2<br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€è·å–å…¨éƒ¨æ³¨è§£"><a href="#2ï¼‰ã€è·å–å…¨éƒ¨æ³¨è§£" class="headerlink" title="2ï¼‰ã€è·å–å…¨éƒ¨æ³¨è§£"></a>2ï¼‰ã€è·å–å…¨éƒ¨æ³¨è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æœ¬ç±»å’Œçˆ¶ç±»çš„æ³¨è§£(çˆ¶ç±»çš„æ³¨è§£éœ€ç”¨ @Inherited è¡¨ç¤ºå¯è¢«ç»§æ‰¿)</span><br>Annotation[] annotations = benzClass.getAnnotations();<br><span class="hljs-keyword">for</span> (Annotation annotation : annotations) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ³¨è§£åç§°: &quot;</span> + annotation.annotationType().getSimpleName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ³¨è§£åç§°: CustomAnnotation3<br>æ³¨è§£åç§°: CustomAnnotation1<br>æ³¨è§£åç§°: CustomAnnotation2<br><br><span class="hljs-comment">//è·å–æœ¬ç±»çš„æ³¨è§£</span><br>Annotation[] declaredAnnotations = benzClass.getDeclaredAnnotations();<br><span class="hljs-keyword">for</span> (Annotation declaredAnnotation : declaredAnnotations) &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ³¨è§£åç§°: &quot;</span> + declaredAnnotation.annotationType().getSimpleName());<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>æ³¨è§£åç§°: CustomAnnotation1<br>æ³¨è§£åç§°: CustomAnnotation2<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œæˆ‘ä»¬æŠŠåå°„å¤§éƒ¨åˆ†çŸ¥è¯†ç‚¹éƒ½è®²å®Œäº†ï¼Œå¯ä»¥è¯´åå°„æ˜¯éå¸¸çš„å¼ºå¤§ï¼Œä½†æ˜¯å­¦ä¹ äº†ä¹‹åï¼Œä½ å¯èƒ½ä¼šä¸çŸ¥é“è¯¥å¦‚ä½•ä½¿ç”¨ï¼Œåè€Œè§‰å¾—è¿˜ä¸å¦‚ç›´æ¥è°ƒç”¨æ–¹æ³•æ¥çš„ç›´æ¥å’Œæ–¹ä¾¿ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡å®è·µæ¥æ„Ÿå—ä¸€ä¸‹ã€‚</p><h2 id="ä¹ã€åå°„å®è·µ"><a href="#ä¹ã€åå°„å®è·µ" class="headerlink" title="ä¹ã€åå°„å®è·µ"></a>ä¹ã€åå°„å®è·µ</h2><p>éœ€æ±‚å¤§æ¦‚å°±æ˜¯ï¼šé€šè¿‡åå°é…ç½®ä¸‹å‘ï¼Œå®Œæˆ App ä¸šåŠ¡åŠŸèƒ½çš„åˆ‡æ¢ã€‚å› ä¸ºåªæ˜¯æ¨¡æ‹Ÿï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä»¥é€šè¿‡è¯»å–æœ¬åœ°é…ç½®æ–‡ä»¶å®Œæˆ App ä¸šåŠ¡åŠŸèƒ½çš„åˆ‡æ¢ï¼š</p><p>1ï¼‰ã€é¦–å…ˆå‡†å¤‡ä¸¤ä¸ªä¸šåŠ¡ç±»ï¼Œå‡è®¾ä»–ä»¬çš„åŠŸèƒ½éƒ½å¾ˆå¤æ‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åŒ…å</span><br><span class="hljs-keyword">package</span> com.dream.aptdemo;<br><br><span class="hljs-comment">//ä¸šåŠ¡1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Business1</span> &#123;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doBusiness1Function</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å¤æ‚ä¸šåŠ¡åŠŸèƒ½1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¸šåŠ¡2</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Business2</span> &#123;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doBusiness2Function</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å¤æ‚ä¸šåŠ¡åŠŸèƒ½2&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€éåå°„æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>  <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//ä¸šåŠ¡åŠŸèƒ½1</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Business1</span>().doBusiness1Function();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‡è®¾è¿™ä¸ªæ—¶å€™éœ€è¦ä»ç¬¬ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œä½¿ç”¨éåå°„æ–¹å¼ï¼Œå¿…é¡»ä¿®æ”¹ä»£ç ï¼Œå¹¶ä¸”é‡æ–°ç¼–è¯‘è¿è¡Œï¼Œæ‰å¯ä»¥è¾¾åˆ°æ•ˆæœã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„å»é€šè¿‡è¯»å–é…ç½®ä»è€Œå®ŒæˆåŠŸèƒ½çš„åˆ‡æ¢ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸éœ€è¦ä¿®æ”¹ä»£ç ä¸”ä»£ç å˜å¾—æ›´åŠ é€šç”¨</p><p>3ï¼‰ã€åå°„æ–¹å¼</p><p>1ã€é¦–å…ˆå‡†å¤‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4de69825228a40dbb491fc9b3f456922~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210625180301557"></p><p>2ã€è¯»å–é…ç½®æ–‡ä»¶ï¼Œåå°„åˆ›å»ºå®ä¾‹å¹¶è°ƒç”¨æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>  <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//è·å–æ–‡ä»¶</span><br>            <span class="hljs-type">File</span> <span class="hljs-variable">springConfigFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/Users/zhouying/AndroidStudioProjects/AptDemo/config.txt&quot;</span>);<br>            <span class="hljs-comment">//è¯»å–é…ç½®</span><br>            Properties config= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>            config.load(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(springConfigFile));<br>            <span class="hljs-comment">//è·å–ç±»è·¯å¾„</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">classPath</span> <span class="hljs-operator">=</span> (String) config.get(<span class="hljs-string">&quot;class&quot;</span>);<br>            <span class="hljs-comment">//è·å–æ–¹æ³•å</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> (String) config.get(<span class="hljs-string">&quot;method&quot;</span>);<br><br>            <span class="hljs-comment">//åå°„åˆ›å»ºå®ä¾‹å¹¶è°ƒç”¨æ–¹æ³•</span><br>            <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(classPath);<br>            <span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> aClass.getDeclaredConstructor();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> declaredConstructor.newInstance();<br>            <span class="hljs-type">Method</span> <span class="hljs-variable">declaredMethod</span> <span class="hljs-operator">=</span> aClass.getDeclaredMethod(methodName);<br>            declaredMethod.invoke(o);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€å®Œæˆä¸Šé¢ä¸¤æ­¥åï¼Œåç»­æˆ‘ä»¬å°±åªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½å®Œæˆ App ä¸šåŠ¡åŠŸèƒ½çš„åˆ‡æ¢äº†</p><h2 id="åã€æ€»ç»“"><a href="#åã€æ€»ç»“" class="headerlink" title="åã€æ€»ç»“"></a>åã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€åå°„å¸¸ç”¨ Api çš„ä½¿ç”¨ï¼Œæ³¨æ„åœ¨è®¿é—®ç§æœ‰å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œè°ƒç”¨ <code>setAccessible</code> è®¾ç½®ä¸º true ï¼Œè¡¨ç¤ºå…è®¸æˆ‘ä»¬è®¿é—®ç§æœ‰å˜é‡</p><p>2ã€å®è·µé€šè¿‡åå°„å®Œæˆ App ä¸šåŠ¡åŠŸèƒ½çš„åˆ‡æ¢</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²æ³¨è§£ï¼Œæ•¬è¯·æœŸå¾…å§</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://blog.csdn.net/qq_41464123/article/details/109248009?utm_source=app">Javaåå°„æœ‰å¤šå¼ºï¼Ÿ ä»–æ‹¥æœ‰è¿™äº”å¤§ç¥å¥‡åŠŸèƒ½ï¼</a></p><p><a href="https://how2j.cn/k/reflection/reflection-class/108.html">HOW2J åå°„éƒ¨åˆ†</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>APT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Android</tag>
      
      <tag>Android APT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆå…«ï¼‰ï¼šFlutter ä¸ Android çš„ä½ æ¥æˆ‘å¾€</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9AFlutter%20%E4%B8%8E%20Android%20%E7%9A%84%E4%BD%A0%E6%9D%A5%E6%88%91%E5%BE%80/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9AFlutter%20%E4%B8%8E%20Android%20%E7%9A%84%E4%BD%A0%E6%9D%A5%E6%88%91%E5%BE%80/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ef7d5226198d42a09559419a34f9c406~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Flutter ä¸­çš„è·¯ç”±ï¼š</p><blockquote><p>1ã€åŸºæœ¬è·¯ç”±</p><p>2ã€å‘½åè·¯ç”±</p><p>3ã€è¿”å›ä¸Šä¸€çº§</p><p>4ã€æ›¿æ¢è·¯ç”±</p><p>5ã€è¿”å›åˆ°æ ¹è·¯ç”±</p></blockquote><p>ä»¥åŠé›†æˆ http åº“è¿›è¡Œ https è¯·æ±‚å®æˆ˜ã€‚</p><p>è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7142650961868095524#heading-11">Flutter ç³»åˆ—ï¼ˆä¸ƒï¼‰ï¼šFlutter è·¯ç”±å’Œ HTTPS è¯·æ±‚å®æˆ˜</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ Flutter ä¸ Android åŸç”Ÿçš„äº¤äº’ä¸é€šä¿¡è¿›è¡Œä»‹ç»</p><p>æˆ‘åš Android åŸç”Ÿå¼€å‘æ—¶ï¼Œé€šå¸¸ä¼šä»¥ç»„ä»¶åŒ–çš„æ–¹å¼å»è¿›è¡Œï¼Œæ ¹æ®ä¸šåŠ¡åˆ’åˆ†ä¸åŒçš„ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥ç¨‹ï¼Œå¯ä»¥è¿›è¡Œç‹¬ç«‹çš„è¿è¡Œå’Œè°ƒè¯•ï¼Œå½“éœ€è¦å‘ç‰ˆæ—¶ï¼Œæˆ‘ä»¬ä¼šå°†æ¯ä¸ªç»„ä»¶æ‰“æˆ aar åŒ…å¹¶ä¸Šä¼ åˆ° Maven ç§æœä»“åº“ï¼Œç„¶åæ•´åˆåˆ° App å£³å·¥ç¨‹ä¸­ï¼Œæœ€ç»ˆè¿›è¡Œæ‰“åŒ…ä¸Šçº¿ã€‚åœ¨è¿™ä¸ªå¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»„ä»¶ä¹‹é—´æ˜¯éœ€è¦è¿›è¡Œé€šä¿¡çš„ï¼Œå¦‚æœéœ€è¦é€šä¿¡çš„ç»„ä»¶éƒ½æ˜¯ Android åŸç”Ÿå¼€å‘çš„ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ä¸€ä¸ªè·¯ç”±æ¡†æ¶è¿›è¡Œé€šä¿¡ï¼Œä¾‹å¦‚ï¼šArouterã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬æœ‰äº›ä¸šåŠ¡ç»„ä»¶æ˜¯ä½¿ç”¨ Flutter å¼€å‘çš„ï¼Œå› æ­¤è¿™é‡Œå°±æ¶‰åŠåˆ° Flutter ä¸ Android åŸç”Ÿçš„é€šä¿¡ï¼Œé‚£ä¹ˆå®ƒä»¬æ˜¯å¦‚ä½•è¿›è¡Œé€šä¿¡çš„å‘¢ï¼Ÿä¸”å¬æˆ‘ç»†ç»†é“æ¥</p><h2 id="ä¸€ã€Android-å£³å·¥ç¨‹é›†æˆ-Flutter-ç»„ä»¶"><a href="#ä¸€ã€Android-å£³å·¥ç¨‹é›†æˆ-Flutter-ç»„ä»¶" class="headerlink" title="ä¸€ã€Android å£³å·¥ç¨‹é›†æˆ Flutter ç»„ä»¶"></a>ä¸€ã€Android å£³å·¥ç¨‹é›†æˆ Flutter ç»„ä»¶</h2><p>1ã€æ‰“å¼€ AndroidStudio ï¼Œåˆ›å»ºä¸€ä¸ª Android å·¥ç¨‹ AndroidAndFlutterInteractiveï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf366145424946f193676017f1a2bc42~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220918215022577" width="50%" /><p>2ã€æ¥ç€åœ¨åˆ›å»ºä¸€ä¸ª Flutter å·¥ç¨‹ fluttermoduleï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/63073b782a5e4716a0a0a8659673cc28~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220918215214876" width="50%" /><p>main.dart æ–‡ä»¶åˆå§‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() =&gt; runApp(<span class="hljs-keyword">const</span> MyApp());<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-keyword">const</span> MyApp(&#123;Key? key&#125;) : <span class="hljs-keyword">super</span>(key: key);<br><br>  <span class="hljs-comment">// This widget is the root of your application.</span><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MaterialApp(<br>      title: <span class="hljs-string">&#x27;Flutter Demo&#x27;</span>,<br>      theme: ThemeData(<br>        primarySwatch: Colors.blue,<br>      ),<br>      home: <span class="hljs-keyword">const</span> MyHomePage(title: <span class="hljs-string">&#x27;Flutter Demo Home Page&#x27;</span>),<br>    );<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyHomePage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-keyword">const</span> MyHomePage(&#123;Key? key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.title&#125;) : <span class="hljs-keyword">super</span>(key: key);<br><br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> title;<br><br>  <span class="hljs-meta">@override</span><br>  State&lt;MyHomePage&gt; createState() =&gt; _MyHomePageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyHomePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyHomePage</span>&gt; </span>&#123;<br>  <span class="hljs-built_in">int</span> _counter = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">void</span> _incrementCounter() &#123;<br>    setState(() &#123;<br>      _counter++;<br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      appBar: AppBar(<br>        title: Text(widget.title),<br>      ),<br>      body: Center(<br>        child: Column(<br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: &lt;Widget&gt;[<br>            <span class="hljs-keyword">const</span> Text(<br>              <span class="hljs-string">&#x27;You have clicked the button this many times:&#x27;</span>,<br>            ),<br>            Text(<br>              <span class="hljs-string">&#x27;<span class="hljs-subst">$_counter</span>&#x27;</span>,<br>              style: Theme.of(context).textTheme.headline4,<br>            ),<br>          ],<br>        ),<br>      ),<br>      floatingActionButton: FloatingActionButton(<br>        onPressed: _incrementCounter,<br>        tooltip: <span class="hljs-string">&#x27;Increment&#x27;</span>,<br>        child: <span class="hljs-keyword">const</span> Icon(Icons.add),<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€åœ¨ Flutter å·¥ç¨‹ä¸­æ‰§è¡Œ <code>flutter build aar</code> å‘½ä»¤æˆ–è€…ç›´æ¥ä½¿ç”¨ AndroidStudio ä¸Šçš„å¯è§†åŒ–æ“ä½œï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d61a34bea63840d3a74083913adccf2a~tplv-k3u1fbpfcp-watermark.image?" alt="202209221609588.png" width="70%" /><p>æ‰§è¡Œå®Œåä¼šæœ‰å¦‚ä¸‹æç¤ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs dart">Consuming the Module<br>  <span class="hljs-number">1.</span> Open &lt;host&gt;/app/build.gradle<br>  <span class="hljs-number">2.</span> Ensure you have the repositories configured, otherwise add them:<br><br>      <span class="hljs-built_in">String</span> storageUrl = System.env.FLUTTER_STORAGE_BASE_URL ?: <span class="hljs-string">&quot;https://storage.googleapis.com&quot;</span><br>      repositories &#123;<br>        maven &#123;<br>            url <span class="hljs-string">&#x27;/Users/zhouying/codeandnotes/Flutter/fluttermodule/build/host/outputs/repo&#x27;</span><br>        &#125;<br>        maven &#123;<br>            url <span class="hljs-string">&quot;<span class="hljs-subst">$storageUrl</span>/download.flutter.io&quot;</span><br>        &#125;<br>      &#125;<br><br>  <span class="hljs-number">3.</span> Make the host app depend <span class="hljs-keyword">on</span> the Flutter module:<br><br>    dependencies &#123;<br>      debugImplementation <span class="hljs-string">&#x27;com.example.fluttermodule:flutter_debug:1.0&#x27;</span><br>      profileImplementation <span class="hljs-string">&#x27;com.example.fluttermodule:flutter_profile:1.0&#x27;</span><br>      releaseImplementation <span class="hljs-string">&#x27;com.example.fluttermodule:flutter_release:1.0&#x27;</span><br>    &#125;<br><br><br>  <span class="hljs-number">4.</span> Add the `profile` build type:<br><br>    android &#123;<br>      buildTypes &#123;<br>        profile &#123;<br>          initWith debug<br>        &#125;<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>å¤§è‡´æ„æ€å°±æ˜¯åœ¨æˆ‘ä»¬åˆ›å»ºçš„ Android å·¥ç¨‹ä¸­é…ç½®ç”Ÿæˆçš„ Flutter aar çš„ä»“åº“åœ°å€ï¼Œç„¶åå¼•ç”¨è¿™ä¸ª aarï¼Œå¤§å®¶æŒ‰ç…§ä¸Šè¿°æ­¥éª¤é…ç½®å³å¯</p><p><strong>æ³¨æ„</strong>ï¼šä¸Šè¿°æ¼”ç¤ºç”Ÿæˆçš„ Flutter aar åªæ˜¯å­˜åœ¨æœ¬åœ°ï¼Œå®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šè‡ªå·±ç¼–å†™è„šæœ¬ç”Ÿæˆ aar å¹¶ä¸Šä¼ åˆ° Maven ç§æœä»“åº“</p><p>é…ç½®å®Œæˆåï¼ŒåŒæ­¥ä¸€ä¸‹é¡¹ç›®ï¼Œå¦‚æœæ²¡å•¥æŠ¥é”™ï¼Œæˆ‘ä»¬å°±ç®—æ˜¯æˆåŠŸé›†æˆäº† Flutter ç»„ä»¶</p><h2 id="äºŒã€Android-è°ƒèµ·-Flutter-é¡µé¢ï¼ˆFlutterActivityï¼‰"><a href="#äºŒã€Android-è°ƒèµ·-Flutter-é¡µé¢ï¼ˆFlutterActivityï¼‰" class="headerlink" title="äºŒã€Android è°ƒèµ· Flutter é¡µé¢ï¼ˆFlutterActivityï¼‰"></a>äºŒã€Android è°ƒèµ· Flutter é¡µé¢ï¼ˆFlutterActivityï¼‰</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å¯¹ Android å·¥ç¨‹è¿›è¡Œé…ç½®ï¼Œè®© Flutter é¡µé¢æ˜¾ç¤ºå‡ºæ¥</p><p>1ã€åœ¨ Android å·¥ç¨‹çš„ AndroidManifest.xml æ–‡ä»¶ä¸­æ·»åŠ  FlutterActivity</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dart">&lt;!--æ³¨å†ŒFlutterActivity--&gt;<br>&lt;activity<br>    android:name=<span class="hljs-string">&quot;io.flutter.embedding.android.FlutterActivity&quot;</span><br>    android:configChanges=<span class="hljs-string">&quot;orientation|keyboardHidden|screenSize&quot;</span><br>    android:hardwareAccelerated=<span class="hljs-string">&quot;true&quot;</span><br>    android:windowSoftInputMode=<span class="hljs-string">&quot;adjustResize&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™ä¸€ä¸ª button è·³è½¬åˆ° Flutter é¡µé¢</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€activity_main.xml</span><br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;LinearLayout xmlns:android=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span><br>    xmlns:tools=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span><br>    android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;match_parent&quot;</span><br>    android:orientation=<span class="hljs-string">&quot;vertical&quot;</span><br>    tools:context=<span class="hljs-string">&quot;.MainActivity&quot;</span>&gt;<br><br>    &lt;Button<br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;wrap_content&quot;</span><br>        android:layout_marginHorizontal=<span class="hljs-string">&quot;20dp&quot;</span><br>        android:textAllCaps=<span class="hljs-string">&quot;false&quot;</span><br>        android:onClick=<span class="hljs-string">&quot;toFlutterActivity&quot;</span><br>        android:text=<span class="hljs-string">&quot;è·³è½¬ FlutterActivity&quot;</span><br>        tools:ignore=<span class="hljs-string">&quot;HardcodedText,UsingOnClickInXml&quot;</span> /&gt;<br><br>&lt;/LinearLayout&gt;<br><br><span class="hljs-comment">//2ã€MainActivity</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br>    <br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br>    &#125;<br><br>    <span class="hljs-comment">//è·³è½¬åˆ° FlutterActivity</span><br>    fun toFlutterActivity(view: View) &#123;<br>        val intent = FlutterActivity.createDefaultIntent(<span class="hljs-keyword">this</span>)<br>        startActivity(intent)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/120d15e966e24a588e0a212d36ffbd7d~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><p>ä¸Šè¿°æ•ˆæœå›¾è™½ç„¶è·³è¿‡å»äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç‚¹å‡» button æ—¶ä¸€ä¸ªæ˜æ˜¾çš„åœé¡¿æ„Ÿï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ï¼Œæ¥ä¸‹æ¥ä»‹ç»ä¸€ç§é¢„åˆå§‹åŒ– Flutter çš„æ–¹å¼</p><h3 id="2-1ã€Android-é¢„åˆå§‹åŒ–-Flutter-é¡µé¢è·³è½¬"><a href="#2-1ã€Android-é¢„åˆå§‹åŒ–-Flutter-é¡µé¢è·³è½¬" class="headerlink" title="2.1ã€Android é¢„åˆå§‹åŒ– Flutter é¡µé¢è·³è½¬"></a>2.1ã€Android é¢„åˆå§‹åŒ– Flutter é¡µé¢è·³è½¬</h3><p>æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç¼“å­˜ FlutterEngineï¼Œç„¶åä»ç¼“å­˜ä¸­å–å‡º FlutterEngine è¿›è¡Œè·³è½¬</p><p>1ã€ä¿®æ”¹ MainActivity ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br><br>    companion object&#123;<br>        <span class="hljs-comment">//ç¼“å­˜ FlutterEngine çš„ key</span><br>        <span class="hljs-keyword">const</span> val FLUTTER_ENGINE_ID = <span class="hljs-string">&quot;default&quot;</span><br>    &#125;<br>    <span class="hljs-comment">//FlutterEngine</span><br>    private lateinit <span class="hljs-keyword">var</span> flutterEngine: FlutterEngine<br><br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br>        <span class="hljs-comment">//åˆå§‹åŒ– FlutterEngine</span><br>        flutterEngine = initFlutterEngine(FLUTTER_ENGINE_ID)<br>    &#125;<br><br>    <span class="hljs-comment">//è·³è½¬åˆ° FlutterActivity</span><br>    fun toFlutterActivity(view: View) &#123;<br>        val intent = FlutterActivity.withCachedEngine(FLUTTER_ENGINE_ID).build(<span class="hljs-keyword">this</span>)<br>        startActivity(intent)<br>    &#125;<br><br>    <span class="hljs-comment"><span class="language-markdown">/<span class="hljs-strong">**</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     <span class="hljs-emphasis">* åˆå§‹åŒ– FlutterEngine</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     *</span> ä¸€èˆ¬åœ¨è·³è½¬å‰è°ƒç”¨ï¼Œä»ç¼“å­˜ä¸­å–å‡º FlutterEngineï¼Œè¿™æ ·å¯ä»¥åŠ å¿«æˆ‘ä»¬é¡µé¢çš„ä¸€ä¸ªè·³è½¬</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     <span class="hljs-emphasis">*/</span></span></span></span><br>    private fun initFlutterEngine(engineId: <span class="hljs-built_in">String</span>): FlutterEngine &#123;<br>        <span class="hljs-comment">//åˆ›å»º FlutterEngine</span><br>        val flutterEngine = FlutterEngine(<span class="hljs-keyword">this</span>)<br>        <span class="hljs-comment">//æŒ‡å®šè¦è·³è½¬çš„ Flutter é¡µé¢</span><br>        flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">&quot;main&quot;</span>)<br>        flutterEngine.dartExecutor.executeDartEntrypoint(DartExecutor.DartEntrypoint.createDefault())<br>        <span class="hljs-comment">//ç¼“å­˜ FlutterEngine</span><br>        val flutterEngineCache = FlutterEngineCache.getInstance()<br>        flutterEngineCache.put(engineId,flutterEngine)<br>        <span class="hljs-keyword">return</span> flutterEngine<br>    &#125;<br><br>    override fun onDestroy() &#123;<br>        <span class="hljs-keyword">super</span>.onDestroy()<br>        <span class="hljs-comment"><span class="language-markdown"><span class="hljs-strong"><span class="hljs-emphasis">/*</span><span class="hljs-emphasis">*</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">         *</span> æ³¨æ„è¿™é‡Œä¸€å®šè¦é”€æ¯ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">         <span class="hljs-emphasis">* å› ä¸º FlutterEngine æ¯”æ˜¾ç¤ºå®ƒçš„ FlutterActivity ç”Ÿå‘½å‘¨æœŸè¦é•¿</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">         *</span> å½“æˆ‘ä»¬é€€å‡º FlutterActivity æ—¶ï¼ŒFlutterEngine å¯èƒ½è¿˜ä¼šç»§ç»­æ‰§è¡Œä»£ç </span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">         <span class="hljs-emphasis">* æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ FlutterActivity é€€å‡ºæ—¶è°ƒç”¨ flutterEngine.destroy åœæ­¢æ‰§è¡Œå¹¶é‡Šæ”¾èµ„æº</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">         *</span>/</span></span></span><br>        flutterEngine.destroy()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€Flutter ç«¯ä¹Ÿè¦åšç›¸åº”çš„ä¿®æ”¹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() =&gt; runApp(getRouter(<span class="hljs-built_in">window</span>.defaultRouteName));<br><br><span class="hljs-comment">///<span class="language-markdown">æ¥æ”¶ Android è·³è½¬è¿‡æ¥çš„å¯åŠ¨è·¯ç”±å‚æ•°ï¼Œå¦‚æœåŒ¹é…ä¸Šäº†èµ°æ­£å¸¸æµç¨‹</span></span><br><span class="hljs-comment">///<span class="language-markdown">å¦‚æœæ²¡åŒ¹é…ä¸Šï¼Œåˆ™æç¤º page not found</span></span><br>Widget getRouter(<span class="hljs-built_in">String</span> routeName) &#123;<br>  <span class="hljs-keyword">switch</span>(routeName)&#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;main&quot;</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> MyApp();<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">return</span> MaterialApp(<br>        home: Scaffold(<br>          appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&quot;Flutter Demo Home Page&quot;</span>),<br>          ),<br>          body: <span class="hljs-keyword">const</span> Center(<br>            child: Text(<br>              <span class="hljs-string">&quot;page not found&quot;</span>,<br>              style: TextStyle(<br>                fontSize: <span class="hljs-number">24</span>,<br>                color: Colors.red<br>              ),<br>            ),<br>          ),<br>        ),<br>      );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€å½“æˆ‘ä»¬ä¿®æ”¹ Flutter å·¥ç¨‹çš„ä»£ç åï¼Œé‡æ–°è¿è¡Œ Android é¡¹ç›®å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p><blockquote><p>1ã€åœ¨ Flutter å·¥ç¨‹é‡æ–°æ‰§è¡Œ <code>flutter build aar</code> å‘½ä»¤</p><p>2ã€å¾… Flutter å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œclean Android å·¥ç¨‹</p></blockquote><p>æ­¤æ—¶æˆ‘ä»¬è¿è¡Œ Android é¡¹ç›®ï¼Œå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e34d61c673024ce2bdc36f6c13602b0f~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (1).gif" width="30%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œé¡µé¢è·³è½¬å˜å¾—éå¸¸ä¸æ»‘</p><p>ç°åœ¨åªæ˜¯ç®€å•çš„è·³è½¬ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘æƒ³åœ¨è·³è½¬æ—¶ç»™ Flutter é¡µé¢ä¼ å€¼è¦æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h3 id="2-2ã€Android-ç»™-Flutter-é¡µé¢ä¼ å€¼"><a href="#2-2ã€Android-ç»™-Flutter-é¡µé¢ä¼ å€¼" class="headerlink" title="2.2ã€Android ç»™ Flutter é¡µé¢ä¼ å€¼"></a>2.2ã€Android ç»™ Flutter é¡µé¢ä¼ å€¼</h3><p>åˆ†æ 2.1 è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ Android å·¥ç¨‹ä¸­è®¾ç½®äº†å¯åŠ¨è·¯ç”±ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">&quot;main&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ Flutter ä¸­é€šè¿‡ <code>window.defaultRouteName</code> è·å–äº†è·¯ç”±</p><p>é‚£ä¹ˆæˆ‘æ˜¯å¦å¯ä»¥åœ¨å¯åŠ¨è·¯ç”±ä¸­å¤šæ·»åŠ ä¸€äº›æ•°æ®ï¼Œç„¶å Flutter è·å–åè¿›è¡Œè§£æå‘¢ï¼Ÿä¾‹å¦‚ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æˆ‘åœ¨ Android ä¸­è¿™æ ·è®¾ç½®</span><br>flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">&quot;main?&#123;\&quot;name\&quot;:\&quot;erdai\&quot;,\&quot;age\&quot;:18&#125;&quot;</span>)<br><br><span class="hljs-comment">//2ã€Flutter ä¸­è·å–è·¯ç”±å¹¶è¿›è¡Œè§£æ</span><br><span class="hljs-built_in">String</span> url = <span class="hljs-built_in">window</span>.defaultRouteName;<br><span class="hljs-comment">//è·å–è·¯ç”±åç§°</span><br><span class="hljs-built_in">String</span> routeName = url.substring(<span class="hljs-number">0</span>,url.indexOf(<span class="hljs-string">&quot;?&quot;</span>));<br><span class="hljs-comment">//è·å–å‚æ•°ï¼Œå°†å‚æ•°è§£æå¹¶è½¬æ¢æˆä¸€ä¸ª Map å¯¹è±¡</span><br><span class="hljs-built_in">String</span> paramsString = url.substring(url.indexOf(<span class="hljs-string">&quot;?&quot;</span>) + <span class="hljs-number">1</span>);<br><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">dynamic</span>&gt; paramsMap = json.decode(paramsString);<br><br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šå°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼Œæˆ‘ä»¬ä¿®æ”¹ Flutter ç«¯çš„ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-comment">//è·å– Android ä¼ è¿‡æ¥çš„è·¯ç”±</span><br>  <span class="hljs-built_in">String</span> url = <span class="hljs-built_in">window</span>.defaultRouteName;<br>  <span class="hljs-comment">//è§£æå¹¶è·å–è·¯ç”±åç§°</span><br>  <span class="hljs-built_in">String</span> routeName = url.substring(<span class="hljs-number">0</span>,url.indexOf(<span class="hljs-string">&quot;?&quot;</span>));<br>  <span class="hljs-comment">//è§£æå¹¶å°†å‚æ•°è½¬æ¢æˆä¸€ä¸ª Map å¯¹è±¡</span><br>  <span class="hljs-built_in">String</span> paramsString = url.substring(url.indexOf(<span class="hljs-string">&quot;?&quot;</span>) + <span class="hljs-number">1</span>);<br>  <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">dynamic</span>&gt; paramsMap = json.decode(paramsString);<br>  <span class="hljs-comment">//æ‰“å°å‚æ•°</span><br>  <span class="hljs-built_in">print</span>(paramsMap);<br>  runApp(getRouter(routeName));<br>&#125;<br><span class="hljs-comment">//...</span><br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬å‘å¸ƒ aarï¼Œclean Android å·¥ç¨‹å¹¶é‡æ–°è¿è¡Œä¼šè¿›è¡Œå‚æ•°çš„æ‰“å°ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a1404b92feb4ad1b7c00c89964a619c~tplv-k3u1fbpfcp-watermark.image?" alt="202209221611327.png" width="70%" /><h2 id="ä¸‰ã€Android-åµŒå…¥-Flutter-é¡µé¢ï¼ˆFlutterFragmentï¼‰"><a href="#ä¸‰ã€Android-åµŒå…¥-Flutter-é¡µé¢ï¼ˆFlutterFragmentï¼‰" class="headerlink" title="ä¸‰ã€Android åµŒå…¥ Flutter é¡µé¢ï¼ˆFlutterFragmentï¼‰"></a>ä¸‰ã€Android åµŒå…¥ Flutter é¡µé¢ï¼ˆFlutterFragmentï¼‰</h2><p>ç±»æ¯” Android å¯åŠ¨ FlutterActivityï¼Œä¸»è¦æ˜¯é€šè¿‡ä¸¤ç§æ–¹å¼æ„å»º intent å¯¹è±¡ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//æ–¹å¼ä¸€</span><br><span class="hljs-keyword">var</span> intent: Intent = FlutterActivity.createDefaultIntent(<span class="hljs-keyword">this</span>)<br>  <br><span class="hljs-comment">//æ–¹å¼äºŒ</span><br><span class="hljs-keyword">var</span> intent = FlutterActivity<br>  .withCachedEngine(FLUTTER_ENGINE_ID)<br>  .build(<span class="hljs-keyword">this</span>)<br></code></pre></td></tr></table></figure><p>æ„å»º FlutterFragment ç±»ä¼¼ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//æ–¹å¼ä¸€</span><br><span class="hljs-keyword">var</span> flutterFragment: FlutterFragment = FlutterFragment.createDefault()<br>  <br><span class="hljs-comment">//æ–¹å¼äºŒ</span><br><span class="hljs-keyword">var</span> flutterFragment: FlutterFragment = FlutterFragment<br>     .withCachedEngine(FLUTTER_ENGINE_ID)<br>     .build()<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ Android ä»£ç  ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æˆ‘ä»¬æ–°å»ºä¸€ä¸ª SecondActivity</span><br><span class="hljs-comment">//activity_second.xmlå†…å®¹ï¼šFrameLayout ç”¨äºæ‰¿è½½ FlutterFragment</span><br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;FrameLayout <br>    xmlns:android=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span><br>    xmlns:tools=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span><br>    android:id=<span class="hljs-string">&quot;@+id/flFragmentContainer&quot;</span><br>    android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;match_parent&quot;</span><br>    tools:context=<span class="hljs-string">&quot;.SecondActivity&quot;</span>/&gt;<br>      <br><span class="hljs-comment">//2ã€ä¿®æ”¹ SecondActivity</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecondActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br>    companion object&#123;<br>        <span class="hljs-comment">//ç¼“å­˜ FlutterEngine çš„ key</span><br>        <span class="hljs-keyword">const</span> val FLUTTER_ENGINE_ID = <span class="hljs-string">&quot;default&quot;</span><br>    &#125;<br>    <span class="hljs-comment">//FlutterEngine</span><br>    private lateinit <span class="hljs-keyword">var</span> flutterEngine: FlutterEngine<br>    <span class="hljs-comment">//FlutterFragment</span><br>    private lateinit <span class="hljs-keyword">var</span> flutterFragment: FlutterFragment<br><br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_second)<br>        <span class="hljs-comment">//åˆå§‹åŒ– FlutterEngine</span><br>        flutterEngine = initFlutterEngine(FLUTTER_ENGINE_ID)<br><br>        <span class="hljs-comment">//åˆå§‹åŒ– FlutterFragment</span><br>        flutterFragment = FlutterFragment<br>            .withCachedEngine(FLUTTER_ENGINE_ID)<br>            .build()<br><br>        <span class="hljs-comment">//å°† FlutterFragment åµŒå…¥åˆ° SecondActivity ä¸­</span><br>        supportFragmentManager.beginTransaction().replace(R.id.flFragmentContainer,flutterFragment).commit()<br>    &#125;<br><br>    <span class="hljs-comment"><span class="language-markdown">/<span class="hljs-strong">**</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     <span class="hljs-emphasis">* åˆå§‹åŒ– FlutterEngine</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     *</span> ä¸Šè¿°ä»£ç ä¸€èˆ¬åœ¨è·³è½¬å‰è°ƒç”¨ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«æˆ‘ä»¬é¡µé¢çš„ä¸€ä¸ªè·³è½¬</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     <span class="hljs-emphasis">*/</span></span></span></span><br>    private fun initFlutterEngine(engineId: <span class="hljs-built_in">String</span>): FlutterEngine &#123;<br>        <span class="hljs-comment">//åˆ›å»º FlutterEngine</span><br>        val flutterEngine = FlutterEngine(<span class="hljs-keyword">this</span>)<br>        <span class="hljs-comment">//æŒ‡å®šè¦è·³è½¬çš„ Flutter é¡µé¢å¹¶æºå¸¦å‚æ•°</span><br>        flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">&quot;main?&#123;\&quot;name\&quot;:\&quot;erdai\&quot;,\&quot;age\&quot;:18&#125;&quot;</span>)<br>        flutterEngine.dartExecutor.executeDartEntrypoint(DartExecutor.DartEntrypoint.createDefault())<br>        <span class="hljs-comment">//ç¼“å­˜ FlutterEngine</span><br>        val flutterEngineCache = FlutterEngineCache.getInstance()<br>        flutterEngineCache.put(engineId,flutterEngine)<br>        <span class="hljs-keyword">return</span> flutterEngine<br>    &#125;<br><br>    <span class="hljs-comment">//é‡å†™ä¸€äº›æ–¹æ³•ï¼Œç„¶åå°†å…¶è½¬å‘åˆ°äº† FlutterFragment ä¸­</span><br>    override fun onPostResume() &#123;<br>        <span class="hljs-keyword">super</span>.onPostResume()<br>        flutterFragment.onPostResume()<br>    &#125;<br><br>    override fun onNewIntent(intent: Intent) &#123;<br>        <span class="hljs-keyword">super</span>.onNewIntent(intent)<br>        flutterFragment.onNewIntent(intent)<br>    &#125;<br><br>    override fun onBackPressed() &#123;<br>        <span class="hljs-keyword">super</span>.onBackPressed()<br>        flutterFragment.onBackPressed()<br>    &#125;<br><br>    override fun onRequestPermissionsResult(<br>        requestCode: Int,<br>        permissions: Array&lt;out <span class="hljs-built_in">String</span>&gt;,<br>        grantResults: IntArray<br>    ) &#123;<br>        <span class="hljs-keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults)<br>        flutterFragment.onRequestPermissionsResult(requestCode,permissions,grantResults)<br>    &#125;<br><br>    override fun onUserLeaveHint() &#123;<br>        <span class="hljs-keyword">super</span>.onUserLeaveHint()<br>        flutterFragment.onUserLeaveHint()<br>    &#125;<br><br>    override fun onTrimMemory(level: Int) &#123;<br>        <span class="hljs-keyword">super</span>.onTrimMemory(level)<br>        flutterFragment.onTrimMemory(level)<br>    &#125;<br><br>    override fun onDestroy() &#123;<br>        <span class="hljs-keyword">super</span>.onDestroy()<br>        <span class="hljs-comment">//åœæ­¢ä»£ç æ‰§è¡Œå¹¶é‡Šæ”¾èµ„æº</span><br>        flutterEngine.destroy()<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€åœ¨ AndroidManifest æ–‡ä»¶ä¸­è®¾ç½® SecondActivity ä¸»é¢˜</span><br>&lt;activity<br>   android:name=<span class="hljs-string">&quot;.SecondActivity&quot;</span><br>   android:exported=<span class="hljs-string">&quot;false&quot;</span><br>   android:theme=<span class="hljs-string">&quot;@style/Theme.MaterialComponents.DayNight.NoActionBar&quot;</span>/&gt;<br><br><span class="hljs-comment">//4ã€ä¿®æ”¹ MainActivity è·³è½¬æŒ‰é’®è·³è½¬åˆ° SecondActivity</span><br>fun toSecondActivity(view: View) &#123;<br>    startActivity(Intent(<span class="hljs-keyword">this</span>,SecondActivity::<span class="hljs-keyword">class</span>.java))<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿° SecondActivity ä¸­æˆ‘ä»¬é‡å†™äº†å¾ˆå¤šæ–¹æ³•ï¼Œç„¶åå°†å…¶è½¬å‘åˆ°äº† FlutterFragment ä¸­ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å®ç° Flutter ä¸­æ‰€æœ‰é¢„æœŸçš„è¡Œä¸º</p><p>æ¥ä¸‹æ¥çœ‹ä¸‹æ•ˆæœï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/22fcb0303f744a7984f2f2feff10f47a~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker2.gif" width="30%" /><h2 id="å››ã€Android-ä¸-Flutter-é€šä¿¡"><a href="#å››ã€Android-ä¸-Flutter-é€šä¿¡" class="headerlink" title="å››ã€Android ä¸ Flutter é€šä¿¡"></a>å››ã€Android ä¸ Flutter é€šä¿¡</h2><p>Flutter æä¾›äº†ä¸€å¥— PlatformChannel æœºåˆ¶ç”¨äº Flutter å’Œ Android çš„é€šä¿¡ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š</p><p>1ã€<strong>MethodChannel</strong>ï¼šä¸»è¦ç”¨äºä¼ é€’æ–¹æ³•è°ƒç”¨ï¼ŒFlutter å’Œ Nativeï¼ˆAndroidï¼‰ä¹‹é—´è¿›è¡Œæ–¹æ³•è°ƒç”¨æ—¶å¯ä»¥ä½¿ç”¨ï¼Œæ˜¯ä¸€ç§åŒå‘çš„é€šä¿¡æ–¹å¼</p><p>2ã€<strong>EventChannel</strong>ï¼šä¸»è¦ç”¨äºç”¨æˆ·æ•°æ®æµçš„é€šä¿¡ï¼Œå¦‚ï¼šæ‰‹æœºç”µé‡å˜åŒ–ï¼Œç½‘ç»œè¿æ¥å˜åŒ–ç­‰ã€‚è¿™ç§æ–¹å¼åªèƒ½  Nativeï¼ˆAndroidï¼‰å‘ Flutter å‘é€æ•°æ®ï¼Œæ˜¯ä¸€ç§å•å‘çš„é€šä¿¡æ–¹å¼</p><p>3ã€<strong>BaseicMessageChannel</strong>ï¼šä¸»è¦ç”¨äºä¼ é€’å„ç§ç±»å‹æ•°æ®ï¼Œå®ƒæ”¯æŒçš„ç±»å‹æœ‰å¾ˆå¤šï¼Œå¦‚ï¼šStringï¼ŒåŠç»“æ„åŒ–ä¿¡æ¯ç­‰ï¼Œæ˜¯ä¸€ç§åŒå‘çš„é€šä¿¡æ–¹å¼</p><h3 id="4-1ã€MethodChannel"><a href="#4-1ã€MethodChannel" class="headerlink" title="4.1ã€MethodChannel"></a>4.1ã€MethodChannel</h3><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº† Android ç»™ Flutter é¡µé¢ä¼ å€¼ï¼Œä¸»è¦æ˜¯é€šè¿‡è¿™è¡Œä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">&quot;main?&#123;\&quot;name\&quot;:\&quot;erdai\&quot;,\&quot;age\&quot;:18&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç‚¹å‡»æŸ¥çœ‹ navigationChannel çš„æºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//NavigationChannel æºç </span><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NavigationChannel</span> </span>&#123;<br>  private <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> TAG = <span class="hljs-string">&quot;NavigationChannel&quot;</span>;<br><br>  <span class="hljs-meta">@NonNull</span> public <span class="hljs-keyword">final</span> MethodChannel channel;<br><br>  public NavigationChannel(<span class="hljs-meta">@NonNull</span> DartExecutor dartExecutor) &#123;<br>    <span class="hljs-keyword">this</span>.channel = <span class="hljs-keyword">new</span> MethodChannel(dartExecutor, <span class="hljs-string">&quot;flutter/navigation&quot;</span>, JSONMethodCodec.INSTANCE);<br>    channel.setMethodCallHandler(defaultHandler);<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°å®ƒå®é™…å°±æ˜¯å¯¹ MethodChannel åšäº†ä¸€å±‚å°è£…ï¼Œåº•å±‚æ˜¯é€šè¿‡ MethodChannel æ¥è¿›è¡Œé€šä¿¡</p><p>è¿™ç§æ–¹å¼åœ¨å¼€å‘ä¸­ç”¨çš„æ¯”è¾ƒå¤šï¼Œä½¿ç”¨ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡ä¾‹å­è¯´æ˜</p><p>ä¸‹é¢å®ç°è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚ï¼š<strong>é¦–å…ˆä» MainActivity è·³è½¬åˆ° SecondActivityï¼Œç„¶å SecondActivity æ¯éš”ä¸€ç§’ç»™ Flutter é¡µé¢å‘é€ä¸€ä¸ªæ•°å­—ï¼ŒFlutter æ¥æ”¶åˆ°æ•°å­—å¹¶æ˜¾ç¤ºåˆ°ä¸­é—´çš„ Text ä¸­ï¼Œå½“æ¥æ”¶åˆ°æ•°å­—ç­‰äº 5 ï¼Œé€šçŸ¥ SecondActivty finish</strong></p><p>å…ˆçœ‹ä¸€çœ¼å®ç°çš„æ•ˆæœï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5303863bc054b7aac3216a3ce715d50~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (3).gif" width="30%" /><p>1ã€é¦–å…ˆæ¥çœ‹ Android ç«¯ä»£ç å®ç°ï¼ŒSecondActivity æ–°å¢çš„éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecondActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br>   <br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">//MethodChannel</span><br>    private lateinit <span class="hljs-keyword">var</span> methodChannel: MethodChannel<br>    <span class="hljs-comment">//å‘é€ç»™ Flutter çš„æ•°å­—</span><br>    private <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span><br><br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_second)<br>        <span class="hljs-comment">//...</span><br><span class="hljs-comment">//MethodChannelåˆå§‹åŒ–ï¼Œæ³¨æ„åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>        methodChannel = MethodChannel(flutterEngine.dartExecutor,<span class="hljs-string">&quot;com.dream.interactive&quot;</span>)<br>       <span class="hljs-comment">//è®¾ç½® Flutter ä¼ ç»™æˆ‘ä»¬çš„æ–¹æ³•å›è°ƒ</span><br>        methodChannel.setMethodCallHandler &#123; call, result -&gt;<br>            <span class="hljs-keyword">if</span>(call.method == <span class="hljs-string">&quot;sendFinish&quot;</span>)&#123;<br>                finish()<br>            &#125;<br>        &#125;<br>      <span class="hljs-comment">//å¼€å¯å®šæ—¶å™¨ï¼Œæ¯éš”ä¸€ç§’ç»™ Flutter å‘é€ä¸€ä¸ªæ•°å­—</span><br>        startTimer()<br>    &#125;<br><br>    private fun startTimer() &#123;<br>        Timer().schedule(timerTask &#123;<br>            runOnUiThread &#123;<br>                val map = mapOf(<span class="hljs-string">&quot;count&quot;</span> to count++)<br>                methodChannel.invokeMethod(<span class="hljs-string">&quot;timer&quot;</span>, map)<br>            &#125;<br>        &#125;, <span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)<br>    &#125;<br><br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€Flutter ç«¯ä»£ç å®ç°ï¼Œæ–°å¢éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyHomePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyHomePage</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//è®°å½•ä¼ é€’è¿‡æ¥çš„æ•°å­—</span><br>  <span class="hljs-built_in">int</span> _counter = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">//åˆå§‹åŒ– MethodChannelï¼Œå­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>  <span class="hljs-keyword">final</span> _channel = <span class="hljs-keyword">const</span> MethodChannel(<span class="hljs-string">&quot;com.dream.interactive&quot;</span>);<br>  <span class="hljs-comment">//...</span><br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br>    <span class="hljs-comment">//è®¾ç½®æ¥æ”¶ Android ä¼ é€’è¿‡æ¥çš„æ–¹æ³•å›è°ƒ</span><br>    _channel.setMethodCallHandler((call) <span class="hljs-keyword">async</span> &#123;<br>      <span class="hljs-built_in">String</span> method = call.method;<br>      <span class="hljs-keyword">switch</span>(method)&#123;<br>        <span class="hljs-comment">//å¦‚æœåŒ¹é…åˆ°äº† timer æ–¹æ³•</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;timer&quot;</span>:<br>          <span class="hljs-comment">//æ¥æ”¶ä¼ é€’è¿‡æ¥çš„æ•°å­—å¹¶åˆ·æ–° UI</span><br>          setState(() &#123;<br>            _counter = call.arguments[<span class="hljs-string">&quot;count&quot;</span>];<br>          &#125;);<br>          <span class="hljs-comment">//å½“æ•°å­—ç­‰äº 5ï¼Œé€šçŸ¥ Android finish SecondActivity</span><br>          <span class="hljs-keyword">if</span>(_counter == <span class="hljs-number">5</span>)&#123;<br>            _channel.invokeMethod(<span class="hljs-string">&quot;sendFinish&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br>          &#125;<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;);<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-2ã€EventChannel"><a href="#4-2ã€EventChannel" class="headerlink" title="4.2ã€EventChannel"></a>4.2ã€EventChannel</h3><p><strong>æˆ‘ä»¬ä½¿ç”¨ EventChannel æ¨¡æ‹Ÿ Android å‘é€ä¸€ä¸ªå……ç”µä¿¡æ¯ç»™ Flutter ï¼ŒFlutter æ¥æ”¶ååœ¨ä¸­é—´çš„ Text å±•ç¤ºå‡ºæ¥</strong></p><p>1ã€ Android ç«¯ä»£ç å®ç°ï¼ŒSecondActivity æ–°å¢çš„éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecondActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br>   <br>    <span class="hljs-comment"><span class="language-markdown">/<span class="hljs-strong">**</span></span></span><br><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     <span class="hljs-emphasis">* EventChannel äº‹ä»¶æ¥æ”¶å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬ä¸»è¦é€šè¿‡å®ƒç»™ Flutter ä¼ é€’ event äº‹ä»¶</span></span></span></span><br><span class="hljs-emphasis"><span class="hljs-strong"><span class="language-markdown"><span class="hljs-comment">     *</span>/</span></span></span><br>    private lateinit <span class="hljs-keyword">var</span> eventSink: EventChannel.EventSink<br>    <span class="hljs-comment">//ç”µé‡ä¿¡æ¯</span><br>    private <span class="hljs-keyword">var</span> electricity = <span class="hljs-number">0</span><br><br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_second)<br>          <br>        <span class="hljs-comment">//åˆå§‹åŒ– EventChannelï¼Œæ³¨æ„åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>        val eventChannel =  EventChannel(flutterEngine.dartExecutor,<span class="hljs-string">&quot;com.dream.eventchannel&quot;</span>)<br>        <span class="hljs-comment">//è®¾ç½®æ¥æ”¶ Flutter ä¼ é€’è¿‡æ¥çš„æ•°æ®æµå›è°ƒ</span><br>        eventChannel.setStreamHandler(object : EventChannel.StreamHandler &#123;<br>            <span class="hljs-comment">//å½“ Flutter ä¸ Android å»ºç«‹è¿æ¥åä¼šå›è°ƒæ­¤æ–¹æ³•</span><br>            override fun onListen(arguments: Any?, events: EventChannel.EventSink) &#123;<br>              <span class="hljs-comment">//æ‰“å° Flutter ä¼ è¿‡æ¥çš„å‚æ•°ï¼Œå»ºç«‹è¿æ¥æ—¶è¿”å›çš„å€¼ï¼Œä»…æ­¤ä¸€æ¬¡</span><br>                Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onListen: <span class="hljs-subst">$arguments</span>&quot;</span>)<br>                <span class="hljs-comment">//å¯¹ eventSink èµ‹å€¼</span><br>                eventSink = events<br>                <span class="hljs-comment">//å¼€å¯å®šæ—¶å™¨ï¼Œæ¯éš”ä¸€ç§’ç”µé‡å¢åŠ  20%</span><br>                startTimer()<br>            &#125;<br><br>            <span class="hljs-comment">//å½“ Flutter ä¸ Android æ–­å¼€è¿æ¥åä¼šå›è°ƒæ­¤æ–¹æ³•</span><br>            override fun onCancel(arguments: Any?) &#123;<br>                Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCancel: æ–­å¼€è¿æ¥&quot;</span>)<br>            &#125;<br>        &#125;)<br>    &#125;<br><br>    <span class="hljs-comment">//å¼€å¯å®šæ—¶å™¨ï¼Œæ¯éš”ä¸€ç§’ç”µé‡å¢åŠ  20%</span><br>    private fun startTimer() &#123;<br>        Timer().schedule(timerTask &#123;<br>            runOnUiThread &#123;<br>              <span class="hljs-comment">//æ¯éš”ä¸€ç§’ç”µé‡ +20</span><br>                electricity += <span class="hljs-number">20</span><br>                <span class="hljs-comment">//å‘é€äº‹ä»¶ç»™ Flutter</span><br>                eventSink.success(<span class="hljs-string">&quot;ç”µé‡ï¼š<span class="hljs-subst">$electricity</span>%&quot;</span>)<br>                <span class="hljs-keyword">if</span>(electricity == <span class="hljs-number">100</span>)&#123;<br>                   <span class="hljs-comment">//å½“ç”µé‡ä¸º 100 ï¼Œå‘é€å®Œæˆäº‹ä»¶ç»™ Flutter</span><br>                   eventSink.endOfStream()<br>                &#125;<br>            &#125;<br>        &#125;, <span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€Flutter ç«¯ä»£ç å®ç°ï¼Œæ–°å¢éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyHomePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyHomePage</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//ç”µé‡ä¿¡æ¯</span><br>  <span class="hljs-built_in">dynamic</span> electricity;<br>  <span class="hljs-comment">//EventChannel æ³¨æ„åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>  <span class="hljs-keyword">final</span> _eventChannel = <span class="hljs-keyword">const</span> EventChannel(<span class="hljs-string">&quot;com.dream.eventchannel&quot;</span>);<br>  <span class="hljs-comment">//è®¢é˜…æµä¿¡æ¯</span><br>  StreamSubscription? _streamSubscription;<br>  <br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br>    <span class="hljs-comment">//åˆå§‹åŒ– StreamSubscription</span><br>    _streamSubscription = _eventChannel<br>        .receiveBroadcastStream([<span class="hljs-string">&quot;Helloï¼Œå»ºç«‹è¿æ¥å§&quot;</span>])<br>        .listen(_onData,onError: _onError,onDone: _onDone);<br>  &#125;<br><br>  <span class="hljs-comment">//æ¥æ”¶ Andorid å‘é€è¿‡æ¥çš„æ­£å¸¸äº‹ä»¶</span><br>  <span class="hljs-keyword">void</span> _onData(event)&#123;<br>    <span class="hljs-comment">//æ‰“å°</span><br>    <span class="hljs-built_in">print</span>(event);<br>    <span class="hljs-comment">//å¯¹ electricity èµ‹å€¼ï¼Œåˆ·æ–° UI</span><br>    setState(() &#123;<br>      electricity = event;<br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-comment">//æ¥æ”¶ Andorid å‘é€è¿‡æ¥çš„ error äº‹ä»¶</span><br>  <span class="hljs-keyword">void</span> _onError(error)&#123;<br>    <span class="hljs-comment">//æ‰“å°</span><br>    <span class="hljs-built_in">print</span>(error);<br>  &#125;<br><br>  <span class="hljs-comment">//æ¥æ”¶ Android å‘é€è¿‡æ¥çš„å®Œæˆäº‹ä»¶</span><br>  <span class="hljs-keyword">void</span> _onDone()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;_onDone&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-comment">//é‡Šæ”¾èµ„æº</span><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> dispose() &#123;<br>    <span class="hljs-keyword">if</span>(_streamSubscription != <span class="hljs-keyword">null</span>)&#123;<br>      _streamSubscription?.cancel();<br>      _streamSubscription = <span class="hljs-keyword">null</span>;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      <span class="hljs-comment">//...</span><br>      body: Center(<br>        child: Column(<br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: &lt;Widget&gt;[<br>            <span class="hljs-comment">//...</span><br>            Text(<br>              <span class="hljs-string">&#x27;<span class="hljs-subst">$electricity</span>&#x27;</span>,<br>              style: Theme.of(context).textTheme.headline4,<br>            ),<br>          ],<br>        ),<br>      ),<br>      <span class="hljs-comment">//..</span><br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹æ•ˆæœå’Œ Log æ—¥å¿—ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ea43f0988ec478a873e01c11d347917~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (4).gif" width="30%" /><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d49e854843e46c7bd7ad58a846b21f5~tplv-k3u1fbpfcp-watermark.image?" alt="202209221613607.png" width="70%" /><h3 id="4-3ã€BaseicMessageChannel"><a href="#4-3ã€BaseicMessageChannel" class="headerlink" title="4.3ã€BaseicMessageChannel"></a>4.3ã€BaseicMessageChannel</h3><p><strong>æˆ‘ä»¬ä½¿ç”¨ BaseicMessageChannel å®ç°ä¸€æ®µ Andorid å’Œ Flutter çš„å¯¹è¯ï¼ŒFlutter æ”¶åˆ° Android çš„æ¶ˆæ¯ï¼Œåœ¨ä¸­é—´çš„ Text å±•ç¤ºå‡ºæ¥ï¼ŒAndroid æ”¶åˆ° Flutter çš„æ¶ˆæ¯ï¼Œä½¿ç”¨ Toast å±•ç¤ºå‡ºæ¥</strong> </p><p>1ã€ Android ç«¯ä»£ç å®ç°ï¼ŒSecondActivity æ–°å¢çš„éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecondActivity</span> : <span class="hljs-title">AppCompatActivity</span>() </span>&#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-comment">//BasicMessageChannel</span><br>    private lateinit <span class="hljs-keyword">var</span> messageChannel: BasicMessageChannel&lt;<span class="hljs-built_in">String</span>&gt;<br>  <br>    <span class="hljs-meta">@SuppressLint</span>(<span class="hljs-string">&quot;SetTextI18n&quot;</span>)<br>    override fun onCreate(savedInstanceState: Bundle?) &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_second)<br>      <span class="hljs-comment">//...</span><br><br><span class="hljs-comment">//åˆå§‹åŒ– BasicMessageChannelï¼Œæ³¨æ„åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>        messageChannel = <br>          BasicMessageChannel(flutterEngine.dartExecutor,<span class="hljs-string">&quot;com.dream.messagechannel&quot;</span>,StringCodec.INSTANCE)<br>        <span class="hljs-comment">//è®¾ç½®æ¥æ”¶ Flutter ä¼ é€’è¿‡æ¥çš„æ¶ˆæ¯å›è°ƒ</span><br>        messageChannel.setMessageHandler &#123; replay: <span class="hljs-built_in">String?</span>, reply: BasicMessageChannel.Reply&lt;<span class="hljs-built_in">String</span>&gt; -&gt;<br>            <span class="hljs-comment">//æ‰“å° Flutter å‘è¿‡æ¥çš„æ¶ˆæ¯</span><br>            Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCreate: <span class="hljs-subst">$replay</span>&quot;</span>)<br>            <span class="hljs-comment">//ä½¿ç”¨ Toast å±•ç¤ºå‡ºæ¥</span><br>            Toast.makeText(<span class="hljs-keyword">this</span>,replay,Toast.LENGTH_SHORT).<span class="hljs-keyword">show</span>()<br>            <span class="hljs-comment">//å›ä¼ æ¶ˆæ¯ç»™ Flutter</span><br>            reply.reply(<span class="hljs-string">&quot;æ¢§æ¡å±±&quot;</span>)<br>        &#125;<br>      <br>      <span class="hljs-comment">//å‘é€æ¶ˆæ¯ç»™ Flutter</span><br>        messageChannel.send(<span class="hljs-string">&quot;å‘¨æœ«å»çˆ¬å±±å—?&quot;</span>) &#123; replay: <span class="hljs-built_in">String?</span> -&gt;<br>            <span class="hljs-comment">//æ¥æ”¶ Flutter å›ä¼ çš„æ¶ˆæ¯</span><br>            <span class="hljs-comment">//æ‰“å° Flutter å›ä¼ çš„æ¶ˆæ¯</span><br>            Log.d(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-string">&quot;onCreate: <span class="hljs-subst">$replay</span>&quot;</span>)<br>            <span class="hljs-comment">//ä½¿ç”¨ Toast å±•ç¤ºå‡ºæ¥</span><br>            Toast.makeText(<span class="hljs-keyword">this</span>,replay,Toast.LENGTH_SHORT).<span class="hljs-keyword">show</span>()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€Flutter ç«¯ä»£ç å®ç°ï¼Œæ–°å¢éƒ¨åˆ†ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyHomePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyHomePage</span>&gt; </span>&#123;<br> <br>  <span class="hljs-comment">//è®°å½• Android ä¼ è¿‡æ¥çš„å€¼</span><br>  <span class="hljs-built_in">dynamic</span> _content;<br>  <span class="hljs-comment">//BasicMessageChannelï¼Œæ³¨æ„åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¿æŒ Android å’Œ Flutter ä¸€è‡´</span><br>  <span class="hljs-keyword">final</span> _messageChannel = <span class="hljs-keyword">const</span> BasicMessageChannel(<span class="hljs-string">&quot;com.dream.messagechannel&quot;</span>, StringCodec());<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br>    <span class="hljs-comment">//è®¾ç½®æ¥æ”¶ Android ä¼ é€’è¿‡æ¥çš„æ¶ˆæ¯å›è°ƒ</span><br>    _messageChannel.setMessageHandler((message) =&gt;Future&lt;<span class="hljs-built_in">String</span>&gt;(()&#123;<br>      <span class="hljs-comment">//æ‰“å° Android å‘é€è¿‡æ¥çš„æ¶ˆæ¯</span><br>      <span class="hljs-built_in">print</span>(message);<br>      <span class="hljs-comment">//ç»™ _content èµ‹å€¼ï¼Œåˆ·æ–° UI</span><br>      setState(() &#123;<br>        _content = message;<br>      &#125;);<br>      <span class="hljs-comment">//å›ä¼ å€¼ç»™ Android</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å¥½å•Š&quot;</span>;<br>    &#125;));<br>    <br>    <span class="hljs-comment">//...</span><br>  &#125;<br>  <br>  <span class="hljs-comment">//ç‚¹å‡» FloatingActionButton çš„å“åº”æ–¹æ³•</span><br>  <span class="hljs-keyword">void</span> _incrementCounter() <span class="hljs-keyword">async</span>&#123;<br>    <span class="hljs-comment">//ç»™ Android å‘é€æ¶ˆæ¯ï¼Œå¹¶æ¥æ”¶ Android å›ä¼ çš„æ¶ˆæ¯</span><br>    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> _messageChannel.send(<span class="hljs-string">&quot;å»çˆ¬å“ªåº§å±±?&quot;</span>);<br>    <span class="hljs-comment">//æ‰“å° Android å›ä¼ çš„æ¶ˆæ¯</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$result</span>&quot;</span>);<br>    <span class="hljs-comment">//ç»™ _content èµ‹å€¼ï¼Œåˆ·æ–° UI</span><br>    setState(() &#123;<br>      _content = result;<br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      appBar: AppBar(<br>        title: Text(widget.title),<br>      ),<br>      body: Center(<br>        child: Column(<br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: &lt;Widget&gt;[<br>            <span class="hljs-comment">//...</span><br>            Text(<br>              <span class="hljs-string">&#x27;<span class="hljs-subst">$_content</span>&#x27;</span>,<br>              style: Theme.of(context).textTheme.headline4,<br>            ),<br>          ],<br>        ),<br>      ),<br>      floatingActionButton: FloatingActionButton(<br>        onPressed: _incrementCounter,<br>        tooltip: <span class="hljs-string">&#x27;Increment&#x27;</span>,<br>        child: <span class="hljs-keyword">const</span> Icon(Icons.add),<br>      ), <br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹ä¸‹æ•ˆæœå’Œ Log æ—¥å¿—ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7da4428000554b0eac543f1530a0c3c2~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (5).gif" width="30%" /><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d749ee7774ba41518b615972d6ac7004~tplv-k3u1fbpfcp-watermark.image" alt="202209221614000.png"></p><h3 id="4-4ã€é€šä¿¡åŸç†"><a href="#4-4ã€é€šä¿¡åŸç†" class="headerlink" title="4.4ã€é€šä¿¡åŸç†"></a>4.4ã€é€šä¿¡åŸç†</h3><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b581ad4490034520b24e1940f3311118~tplv-k3u1fbpfcp-watermark.image?" alt="202209221615654.png" width="100%" /><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p><p>1ã€Android å’Œ Flutter éƒ½æ˜¯ä»¥ ByteBuffer ä¸ºè½½ä½“ï¼Œç„¶åé€šè¿‡ BinaryMessenger æ¥å‘é€å’Œæ¥æ”¶æ•°æ®</p><p>2ã€Android å’Œ Flutter éƒ½æ˜¯åŸºäº PlatformChannel æœºåˆ¶æ¥è¿›è¡Œé€šä¿¡çš„</p><p>ä¹‹æ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿå¦‚æ­¤ç®€å•çš„è¿›è¡Œé€šä¿¡ï¼Œå®åˆ™æ˜¯ç³»ç»Ÿç»™æˆ‘ä»¬åšäº†å¤§é‡çš„å°è£…ï¼šçº¿ç¨‹çš„åˆ‡æ¢ï¼Œæ•°æ®æ‹·è´ç­‰å¤æ‚æ“ä½œ</p><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>åœ¨ Android ä¾§ï¼ŒBinaryMessenger æ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨ FlutterView ä¸­å®ç°äº†è¯¥æ¥å£ï¼Œåœ¨ BinaryMessenger çš„æ–¹æ³•ä¸­é€šè¿‡ JNI æ¥ä¸ç³»ç»Ÿåº•å±‚æ²Ÿé€šã€‚åœ¨ Flutter ä¾§ï¼ŒBinaryMessenger æ˜¯ä¸€ä¸ªç±»ï¼Œè¯¥ç±»çš„ä½œç”¨å°±æ˜¯ä¸ç±» window æ²Ÿé€šï¼Œè€Œç±» window æ‰çœŸæ­£ä¸ç³»ç»Ÿåº•å±‚æ²Ÿé€š</strong></p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Android é›†æˆ Flutter </p><blockquote><p>ä¸»è¦å°±æ˜¯å°† Flutter ç«¯çš„ä»£ç æ‰“æˆ aar ï¼Œç„¶å Android å¼•ç”¨è¿™ä¸ª aar</p></blockquote><p>2ã€Android è°ƒèµ· Flutter é¡µé¢ï¼ˆFlutterActivityï¼ŒFlutterFragmentï¼‰ï¼Œå¹¶ç»™ Flutter é¡µé¢ä¼ å€¼</p><blockquote><p>ä¼ å€¼åº•å±‚ä½¿ç”¨çš„ MethodChannel</p></blockquote><p>3ã€Android ä¸ Flutter é€šä¿¡ï¼Œä¸»è¦ä½¿ç”¨åˆ°äº† Flutter çš„ PlatformChannel æœºåˆ¶ï¼Œå…¶å®ç°ä¸»è¦æœ‰ä¸‰ç§ç±»å‹ï¼š</p><blockquote><p>1ã€MethodChannelï¼šç”¨äº Flutter å’Œ Android ä¹‹é—´çš„æ–¹æ³•é€šä¿¡ï¼ŒåŒå‘çš„</p><p>2ã€EventChannelï¼šç”¨äº Flutter å’Œ Android ä¹‹é—´çš„æ•°æ®æµé€šä¿¡ï¼Œå•å‘çš„ï¼šAndroid -&gt; Flutter</p><p>3ã€BaseicMessageChannelï¼šç”¨äº Flutter å’Œ Android ä¹‹é—´çš„æ•°æ®é€šä¿¡ï¼ŒåŒå‘çš„</p></blockquote><p>4ã€ç®€å•çš„ä»‹ç»äº† Android ä¸ Flutter é€šä¿¡çš„åŸç†</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®²å¼€å‘ Flutter é¡¹ç›®çš„ä¸€ä¸ªæŠ€æœ¯é€‰å‹ï¼Œå°½è¯·æœŸå¾…å§ğŸº</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/7054743801520193543">Android é›†æˆ Flutter | ä¸äº¤äº’</a></p><p><a href="https://juejin.cn/post/6844903873358856200#heading-7">ä¸€ç¯‡çœ‹æ‡‚Androidä¸Flutterä¹‹é—´çš„é€šä¿¡</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆä¸ƒï¼‰ï¼šFlutter è·¯ç”±å’Œ HTTPS è¯·æ±‚å®æˆ˜</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%83%EF%BC%89%EF%BC%9AFlutter%20%E8%B7%AF%E7%94%B1%E5%92%8C%20HTTPS%20%E8%AF%B7%E6%B1%82%E5%AE%9E%E6%88%98/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%83%EF%BC%89%EF%BC%9AFlutter%20%E8%B7%AF%E7%94%B1%E5%92%8C%20HTTPS%20%E8%AF%B7%E6%B1%82%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62ffd4977786447e8174026b2f58ccd3~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Flutter ä¸­å¸¸ç”¨çš„è¡¨å• Widgetï¼šTextFieldï¼ŒCheckBoxï¼ŒRadioï¼ŒSwitchï¼ŒCheckboxListTileï¼ŒRadioListTileï¼ŒSwitchListTileï¼ŒSliderï¼Œæœ€åé€šè¿‡è¿™äº› Widget å®ç°äº†ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7137457377959706654">Flutter ç³»åˆ—ï¼ˆå…­ï¼‰ï¼šFlutter å¸¸ç”¨è¡¨å• Widget</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ Flutter è·¯ç”±å’Œ HTTPS è¯·æ±‚å®æˆ˜è¿›è¡Œä»‹ç»</p><h2 id="ä¸€ã€Flutter-è·¯ç”±"><a href="#ä¸€ã€Flutter-è·¯ç”±" class="headerlink" title="ä¸€ã€Flutter è·¯ç”±"></a>ä¸€ã€Flutter è·¯ç”±</h2><p>1ï¼‰ã€Flutter ä¸­çš„è·¯ç”±ç®€å•ç†è§£å°±æ˜¯é¡µé¢è·³è½¬ã€‚Flutter é€šè¿‡ Navigator ç»„ä»¶ç®¡ç†è·¯ç”±å¯¼èˆªï¼Œå¹¶æä¾›äº†ç®¡ç†å †æ ˆçš„æ–¹æ³•ã€‚å¦‚ï¼šNavigator.pushï¼ŒNavigator.pop</p><p>2ï¼‰ã€Flutter ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§é…ç½®è·¯ç”±è·³è½¬çš„æ–¹å¼ï¼š</p><blockquote><p>1ã€åŸºæœ¬è·¯ç”±</p><p>2ã€å‘½åè·¯ç”±</p></blockquote><h3 id="1-1ã€åŸºæœ¬è·¯ç”±"><a href="#1-1ã€åŸºæœ¬è·¯ç”±" class="headerlink" title="1.1ã€åŸºæœ¬è·¯ç”±"></a>1.1ã€åŸºæœ¬è·¯ç”±</h3><h4 id="1-1-1ã€åŸºæœ¬è·¯ç”±ä½¿ç”¨"><a href="#1-1-1ã€åŸºæœ¬è·¯ç”±ä½¿ç”¨" class="headerlink" title="1.1.1ã€åŸºæœ¬è·¯ç”±ä½¿ç”¨"></a>1.1.1ã€åŸºæœ¬è·¯ç”±ä½¿ç”¨</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªé¡µé¢ï¼šHomePage.dartï¼ŒSearchPage.dartï¼Œå…ˆçœ‹ä¸€çœ¼å®ƒä»¬åˆå§‹çš„ä¸€ä¸ªä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€HomePage.dart</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/route/Routes.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>      home: HomePage()<br>  ));<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomePage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;HomePage&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: Center(<br>        child: RaisedButton(<br>          child: Text(<span class="hljs-string">&quot;è·³è½¬åˆ° SearchPage&quot;</span>),<br>          <span class="hljs-comment">//æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span><br>          onPressed: () &#123;<br>            <br>          &#125;,<br>        ),<br>      ), <br>    );<br>  &#125;<br>&#125;<br><br><br><span class="hljs-comment">//2ã€SearchPage.dart</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SearchPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-keyword">final</span> arguments;<br><br>  <span class="hljs-comment">//å¯é€‰å‚æ•° arguments</span><br>  SearchPage(&#123;<span class="hljs-keyword">this</span>.arguments&#125;);<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>        appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;SearchPage&#x27;</span>)<br>        ),<br>        body: Center(<br>          child: Text(<span class="hljs-string">&quot;æœç´¢é¡µé¢å†…å®¹åŒºåŸŸï¼š<span class="hljs-subst">$arguments</span>&quot;</span>),<br>        )<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¾ˆç®€å•ï¼Œç°åœ¨æˆ‘ä»¬æƒ³ä» HomePage è·³è½¬åˆ° SearchPageï¼Œéœ€è¦ä»¥ä¸‹ä¸¤æ­¥ï¼š</p><p>1ã€åœ¨ HomePage.dart ä¸­å¼•å…¥ SearchPage.dart </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€ç»å¯¹è·¯å¾„</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/pages/SearchPage.dart&#x27;</span>;<br><span class="hljs-comment">//2ã€ç›¸å¯¹è·¯å¾„</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../SearchPage.dart&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>Tips</strong>ï¼šæ—¥å¸¸å¼€å‘ä¸­å»ºè®®ç»Ÿä¸€ä½¿ç”¨ç»å¯¹è·¯å¾„</p><p>2ã€åœ¨ HomePage çš„ç‚¹å‡»äº‹ä»¶ä¸­é€šè¿‡å¦‚ä¸‹æ–¹æ³•è·³è½¬</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//æ–¹å¼ä¸€</span><br>Navigator.push(context, MaterialPageRoute(builder: (context)&#123;<br>  <span class="hljs-keyword">return</span> SearchPage();<br>&#125;));<br><br><span class="hljs-comment">//æ–¹å¼äºŒ</span><br>Navigator.of(context).push(<br>  MaterialPageRoute(builder: (context)&#123;<br>    <span class="hljs-keyword">return</span> SearchPage();<br>  &#125;)<br>);<br><br><span class="hljs-comment">//ä¸Šè¿°ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼Œå®é™…ä¸Šæ–¹å¼ä¸€æ˜¯å¯¹æ–¹å¼äºŒçš„å°è£…</span><br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢ä¸¤æ­¥æˆ‘ä»¬å°±å¯ä»¥è·³è½¬åˆ° SearchPage é¡µé¢äº†</p><p>æ­¤æ—¶è¿˜åªæ˜¯ç®€å•çš„è·³è½¬ï¼Œå¦‚æœæˆ‘æƒ³å‘ SearchPage ä¼ å€¼å‘¢ï¼Ÿ</p><h4 id="1-1-2ã€åŸºæœ¬è·¯ç”±ä¼ å€¼"><a href="#1-1-2ã€åŸºæœ¬è·¯ç”±ä¼ å€¼" class="headerlink" title="1.1.2ã€åŸºæœ¬è·¯ç”±ä¼ å€¼"></a>1.1.2ã€åŸºæœ¬è·¯ç”±ä¼ å€¼</h4><p>å®åˆ™å°±æ˜¯åœ¨ SearchPage çš„æ„é€ æ–¹æ³•ä¸­å¢åŠ å®å‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart">Navigator.of(context).push(<br>  MaterialPageRoute(builder: (context)&#123;<br>    <span class="hljs-keyword">return</span> SearchPage(arguments: <span class="hljs-string">&quot;erdai666&quot;</span>);<br>  &#125;)<br>);<br></code></pre></td></tr></table></figure><p>è¿™ç§åŸºæœ¬è·¯ç”±çš„ä½¿ç”¨æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼š<strong>ä¸èƒ½è¿›è¡Œè·¯ç”±çš„ç»Ÿä¸€ç®¡ç†</strong>ã€‚å¦‚æœæˆ‘ä»¬æƒ³æŠŠè·¯ç”±ç»Ÿä¸€ç®¡ç†ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°å‘½åè·¯ç”±</p><h3 id="1-2ã€å‘½åè·¯ç”±"><a href="#1-2ã€å‘½åè·¯ç”±" class="headerlink" title="1.2ã€å‘½åè·¯ç”±"></a>1.2ã€å‘½åè·¯ç”±</h3><h4 id="1-2-1ã€å‘½åè·¯ç”±ä½¿ç”¨"><a href="#1-2-1ã€å‘½åè·¯ç”±ä½¿ç”¨" class="headerlink" title="1.2.1ã€å‘½åè·¯ç”±ä½¿ç”¨"></a>1.2.1ã€å‘½åè·¯ç”±ä½¿ç”¨</h4><p>å‘½åè·¯ç”±å°±æ˜¯ç»™æ¯ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ«åï¼Œé€šå¸¸æ˜¯ä»¥ &#x2F; å¼€å¤´ï¼Œå¦‚ï¼šâ€&#x2F;searchPageâ€ã€‚è¿˜æ˜¯ä»¥ 1.1.1 çš„ä¾‹å­è¿›è¡Œä¸¾ä¾‹ï¼š</p><p>1ã€æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ª .dart æ–‡ä»¶è¿›è¡Œè·¯ç”±çš„ç»Ÿä¸€ç®¡ç†ï¼Œæˆ‘è¿™é‡Œå« Routes.dart ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-built_in">String</span> homePage = <span class="hljs-string">&quot;/&quot;</span>;<br><span class="hljs-built_in">String</span> searchPage = <span class="hljs-string">&quot;/searchPage&quot;</span>;<br><br><span class="hljs-keyword">final</span> routes = &#123;<br>  homePage: (context) =&gt; HomePage(),<br>  searchPage: (context) =&gt; SearchPage()<br>&#125;;<br><br><span class="hljs-comment">//ä¸‹é¢è¿™æ®µä»£ç æ˜¯å°†ä¸€ä¸ªåŒ¿åæ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</span><br><span class="hljs-comment">//åŒ¿åæ–¹æ³•åšçš„äº‹æƒ…ï¼šå¤„ç†è·¯ç”±ä¼ å‚ï¼Œç”Ÿæˆ MaterialPageRoute è·¯ç”±å¯¹è±¡</span><br><span class="hljs-keyword">var</span> onGenerateRoute = (settings) &#123;<br>  <span class="hljs-built_in">Function?</span> pageContentBuilder = routes[settings.name];<br>  <span class="hljs-keyword">if</span> (pageContentBuilder != <span class="hljs-keyword">null</span>) &#123;<br>    <span class="hljs-keyword">if</span> (settings.arguments != <span class="hljs-keyword">null</span>) &#123;<br>      <span class="hljs-keyword">var</span> route = MaterialPageRoute(<br>          builder: (context) =&gt;<br>              pageContentBuilder(context, arguments: settings.arguments));<br>      <span class="hljs-keyword">return</span> route;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">var</span> route =<br>      MaterialPageRoute(builder: (context) =&gt; pageContentBuilder(context));<br>      <span class="hljs-keyword">return</span> route;<br>    &#125;<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p><strong>Tips</strong>ï¼šé€šå¸¸æˆ‘ä»¬ä¼šä»¥ â€˜&#x2F;â€˜ è¡¨ç¤º App å¯åŠ¨é¡µçš„è·¯ç”±</p><p>2ã€åœ¨ HomePage.dart ä¸­æ–°å¢å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//å¯¼åŒ…</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/route/Routes.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>      <span class="hljs-comment">//app å¯åŠ¨è·¯ç”±é¡µé¢</span><br>      initialRoute: homePage,<br>      <span class="hljs-comment">//è·¯ç”±ç”Ÿæˆ</span><br>      onGenerateRoute: onGenerateRoute,<br>      <span class="hljs-comment">//...</span><br>  ));<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€åœ¨ HomePage çš„ç‚¹å‡»äº‹ä»¶ä¸­é€šè¿‡å¦‚ä¸‹æ–¹æ³•è·³è½¬</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//æ–¹å¼ä¸€</span><br>Navigator.pushNamed(context, searchPage);<br><br><span class="hljs-comment">//æ–¹å¼äºŒ</span><br>Navigator.of(context).pushNamed(searchPage);<br><br><span class="hljs-comment">//ä¸Šè¿°ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼Œå®é™…ä¸Šæ–¹å¼ä¸€æ˜¯å¯¹æ–¹å¼äºŒçš„å°è£…</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªè§„å¾‹ï¼š<strong>Navigator æä¾›äº†ä¸¤ç§ Api è°ƒç”¨æ–¹å¼ï¼š<code>Navigator.api...</code> å’Œ <code>Navigator.of(context).api...</code>ï¼Œå‰è€…æ˜¯åè€…çš„ä¸€ä¸ªå°è£…</strong>ï¼Œåé¢æˆ‘ä»¬éƒ½ä»¥å‰è€…ä¸¾ä¾‹</p><h4 id="1-2-2ã€å‘½åè·¯ç”±ä¼ å€¼"><a href="#1-2-2ã€å‘½åè·¯ç”±ä¼ å€¼" class="headerlink" title="1.2.2ã€å‘½åè·¯ç”±ä¼ å€¼"></a>1.2.2ã€å‘½åè·¯ç”±ä¼ å€¼</h4><p>å®åˆ™å°±æ˜¯ç»™ SearchPage çš„æ„é€ æ–¹æ³•ä¼ å…¥å®å‚ï¼š</p><p>1ã€ä¿®æ”¹  Routes.dart ä¸­çš„è·¯ç”±è·³æŠ“</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//...</span><br><span class="hljs-keyword">final</span> routes = &#123;<br>  <span class="hljs-comment">//æ”¹åŠ¨ç‚¹ï¼šæ–°å¢ arguments å‘½åå‚æ•°ä¼ ç»™ SearchPage</span><br>  searchPage: (context,&#123;arguments&#125;) =&gt; SearchPage(arguments: arguments)<br>&#125;;<br></code></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹ HomePage çš„ç‚¹å‡»äº‹ä»¶è·³è½¬æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">Navigator.pushNamed(context, searchPage,arguments: <span class="hljs-string">&quot;erdai666&quot;</span>);<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b1faa83a0564f1484c55168cdd74ae6~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker.gif" width="30%" /><h3 id="1-3ã€è¿”å›ä¸Šä¸€çº§"><a href="#1-3ã€è¿”å›ä¸Šä¸€çº§" class="headerlink" title="1.3ã€è¿”å›ä¸Šä¸€çº§"></a>1.3ã€è¿”å›ä¸Šä¸€çº§</h3><p>ä¸Šè¿°æ•ˆæœå›¾ä¸­ï¼ŒSearchPage å·¦ä¸Šè§’ç™½è‰²çš„è¿”å›æŒ‰é’®æ˜¯ç³»ç»Ÿç»™æˆ‘ä»¬å®ç°çš„ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è‡ªå·±å®ç°è¿”å›ä¸Šä¸€çº§çš„æ•ˆæœï¼Œä½¿ç”¨å¦‚ä¸‹ Api å³å¯ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">Navigator.pop(context);<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬ç»™ SearchPage ä¸­é—´çš„å†…å®¹åŒºåŸŸæ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œè®©å®ƒè¿”å›ä¸Šä¸€çº§ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SearchPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-keyword">final</span> arguments;<br><br>  SearchPage(&#123;<span class="hljs-keyword">this</span>.arguments&#125;);<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>        appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;SearchPage&#x27;</span>)<br>        ),<br>        body: Center(<br>          <span class="hljs-comment">//æ–°å¢éƒ¨åˆ†çš„ä»£ç </span><br>          child: InkWell(<br>            child: Text(<span class="hljs-string">&quot;æœç´¢é¡µé¢å†…å®¹åŒºåŸŸï¼š<span class="hljs-subst">$arguments</span>&quot;</span>),<br>            onTap: ()&#123;<br>              Navigator.pop(context);<br>            &#125;,<br>          ),<br>        )<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨åˆ°äº† InkWell Widgetï¼Œå®ƒçš„ä½œç”¨æ˜¯ç»™æ²¡æœ‰ç‚¹å‡»äº‹ä»¶çš„ Widget æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œçœ‹æ•ˆæœï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7b86175f8c846238ea6a1b18c0b8d3b~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (1).gif" width="30%" /><h3 id="1-4ã€æ›¿æ¢è·¯ç”±"><a href="#1-4ã€æ›¿æ¢è·¯ç”±" class="headerlink" title="1.4ã€æ›¿æ¢è·¯ç”±"></a>1.4ã€æ›¿æ¢è·¯ç”±</h3><p>1ï¼‰ã€å’Œ Android ä¸­å…ˆå¯åŠ¨ä¸€ä¸ª Activity ç„¶å finish ä¸Šä¸ª Activity ç±»ä¼¼ã€‚æ›¿æ¢è·¯ç”±å°±æ˜¯å¯åŠ¨ä¸€ä¸ªæ–°é¡µé¢ï¼Œç„¶åå°†æ–°é¡µé¢æ›¿æ¢ä¸Šä¸€ä¸ªé¡µé¢</p><p>2ï¼‰ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Navigator.pushReplacementNamed</code> è¿›è¡Œè·¯ç”±çš„æ›¿æ¢</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª LoginPage.dart çš„ç™»é™†é¡µï¼Œç„¶åä½¿ç”¨ LoginPage æ›¿æ¢ SearchPageï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€LoginPage ç¼–å†™</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>        appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;LoginPage&#x27;</span>)<br>        ),<br>        body: <span class="hljs-keyword">const</span> Center(<br>          child: Text(<span class="hljs-string">&quot;å»æ³¨å†Œ&quot;</span>),<br>        )<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨ Routes.dart ä¸­æ–°å¢è·¯ç”±ä¿¡æ¯</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/pages/LoginPage.dart&#x27;</span>;<br><br><span class="hljs-comment">//...</span><br><span class="hljs-built_in">String</span> loginPage = <span class="hljs-string">&quot;/loginPage&quot;</span>;<br><br><span class="hljs-keyword">final</span> routes = &#123;<br>  <span class="hljs-comment">//...</span><br>  loginPage: (context) =&gt; LoginPage()<br>&#125;;<br></code></pre></td></tr></table></figure><p>3ã€ä¿®æ”¹ SearchPage çš„ç‚¹å‡»äº‹ä»¶è·³è½¬æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//...</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SearchPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-keyword">final</span> arguments;<br><br>  SearchPage(&#123;<span class="hljs-keyword">this</span>.arguments&#125;);<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>        appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;SearchPage&#x27;</span>)<br>        ),<br>        body: Center(<br>          child: InkWell(<br>            child: Text(<span class="hljs-string">&quot;æœç´¢é¡µé¢å†…å®¹åŒºåŸŸï¼š<span class="hljs-subst">$arguments</span>&quot;</span>),<br>            onTap: ()&#123;<br>              <span class="hljs-comment">//è·¯ç”±æ›¿æ¢</span><br>              Navigator.pushReplacementNamed(context,loginPage);<br>            &#125;,<br>          ),<br>        )<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€æ•ˆæœå±•ç¤º</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da99b98353d949b08570cb1c0b3443ea~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (2).gif" width="30%" /><p>æ•ˆæœå›¾ä¸­æˆ‘ä»¬ç‚¹å‡» LoginPage çš„è¿”å›æŒ‰é’®è¿”å›åˆ°äº† HomePage ï¼Œè¯æ˜ SearchPage è¢«æ›¿æ¢</p><h3 id="1-5ã€è¿”å›åˆ°æ ¹è·¯ç”±"><a href="#1-5ã€è¿”å›åˆ°æ ¹è·¯ç”±" class="headerlink" title="1.5ã€è¿”å›åˆ°æ ¹è·¯ç”±"></a>1.5ã€è¿”å›åˆ°æ ¹è·¯ç”±</h3><p>1ï¼‰ã€å’Œ Android ä¸­å¯åŠ¨ä¸€ä¸ª Activityï¼Œç„¶åå°†è¿™ä¸ª Activity ä¹‹ä¸Šçš„æ‰€æœ‰ Activity å¼¹å‡ºæ ˆç±»ä¼¼ã€‚è¿”å›æ ¹è·¯ç”±å°±æ˜¯å°†å½“å‰é¡µé¢ä¹‹ä¸Šçš„é¡µé¢å…¨éƒ¨ç§»é™¤æ‰</p><p>2ï¼‰ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Navigator.pushAndRemoveUtil</code> è¿”å›æ ¹è·¯ç”±</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª RegisterPage.dart çš„æ³¨å†Œé¡µï¼Œç„¶å Hompage -&gt; SearchPage -&gt; LoginPage -&gt; RegisterPage éƒ½ä½¿ç”¨ <code>Navigator.pushNamed</code> æ–¹å¼è·³è½¬ï¼ŒRegisterPage -&gt; Hompage ä½¿ç”¨ <code>Navigator.pushAndRemoveUtil</code> æ–¹å¼è·³è½¬ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€LoginPage ç¼–å†™</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/HomePage.dart&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Registerpage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Scaffold(<br>        appBar: AppBar(<br>            title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&#x27;RegisterPage&#x27;</span>)<br>        ),<br>        body:  Center(<br>          child: InkWell(<br>            child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">&quot;æ³¨å†ŒæˆåŠŸï¼Œå» HomePage&quot;</span>),<br>            onTap: ()&#123;<br>              <span class="hljs-comment">//é€šè¿‡è¿”å›æ ¹è·¯ç”±è·³è½¬åˆ° HomePage </span><br>              Navigator.pushAndRemoveUntil(<br>                  context,<br>                  MaterialPageRoute(builder: (context)&#123;<br>                    <span class="hljs-keyword">return</span> HomePage();<br>                  &#125;),<br>                  (route) =&gt; <span class="hljs-keyword">false</span>);<br>            &#125;,<br>          ),<br>        )<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨ Routes.dart ä¸­æ–°å¢è·¯ç”±ä¿¡æ¯</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutterapplication/pages/RegisterPage.dart&#x27;</span>;<br><br><span class="hljs-comment">//...</span><br><span class="hljs-built_in">String</span> registerPage = <span class="hljs-string">&quot;/registerPage&quot;</span>;<br><br><span class="hljs-keyword">final</span> routes = &#123;<br>  <span class="hljs-comment">//...</span><br>  registerPage: (context) =&gt; RegisterPage()<br>&#125;;<br></code></pre></td></tr></table></figure><p>3ã€ä¿®æ”¹ Hompageï¼ŒSearchPageï¼ŒLoginPage çš„è·³è½¬æ–¹å¼ä¸º <code>Navigator.pushNamed</code></p><p>4ã€æ•ˆæœå±•ç¤º</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2c6bf6ff3eb4510bbd21d66cd4af71f~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (3).gif" width="30%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä» RegisterPage åˆ° HomePageï¼Œç„¶ååœ¨è¿”å›ï¼Œç›´æ¥é€€åˆ°äº†æ¡Œé¢ï¼Œè¯æ˜å…¶å®ƒé¡µé¢éƒ½è¢«ç§»é™¤äº†</p><h2 id="äºŒã€HTTPS-è¯·æ±‚å®æˆ˜"><a href="#äºŒã€HTTPS-è¯·æ±‚å®æˆ˜" class="headerlink" title="äºŒã€HTTPS è¯·æ±‚å®æˆ˜"></a>äºŒã€HTTPS è¯·æ±‚å®æˆ˜</h2><p>Flutter ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼š</p><blockquote><p> http </p><p> é“¾æ¥ï¼š<a href="https://pub.dev/packages/http">https://pub.dev/packages/http</a></p></blockquote><p>è¿™é‡Œéœ€è¦å¤§å®¶æŒæ¡ Dart å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ï¼Œè¿˜ä¸æ˜ç™½çš„çœ‹æˆ‘<a href="https://juejin.cn/post/7130647339294785549#heading-80">Flutter ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šDart è¯­æ³•ç­‘åŸº</a>è¿™ç¯‡æ–‡ç« </p><p>åœ¨é¡¹ç›®çš„ pubspec.yaml é…ç½®æ–‡ä»¶æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart">dependencies:<br>  http: ^<span class="hljs-number">0.13</span><span class="hljs-number">.5</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œç®€å•çš„ä»‹ç»ä¸‹ getï¼Œpost è¯·æ±‚ï¼Œè¿™é‡Œç‰¹åˆ«æ„Ÿè°¢ <a href="https://www.wanandroid.com/">WanAndroid</a> æä¾›çš„ Api</p><h3 id="2-1ã€get-è¯·æ±‚"><a href="#2-1ã€get-è¯·æ±‚" class="headerlink" title="2.1ã€get è¯·æ±‚"></a>2.1ã€get è¯·æ±‚</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//å¯¼å…¥ http å¹¶è®¾ç½®åˆ«å</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br><br><span class="hljs-comment">//ä½¿ç”¨ async æ ‡è®°ä¸ºå¼‚æ­¥</span><br><span class="hljs-keyword">void</span> _getData() <span class="hljs-keyword">async</span>&#123;<br>  <span class="hljs-comment">//æ„å»ºè¯·æ±‚ uri</span><br>  <span class="hljs-keyword">var</span> uri = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&quot;www.wanandroid.com&quot;</span>, <span class="hljs-string">&quot;/friend/json&quot;</span>);<br>  <span class="hljs-comment">//ä½¿ç”¨ http å‘èµ· get è¯·æ±‚ï¼Œç­‰å¾…è¿”å›ç»“æœè¿›è¡Œåç»­ä»£ç æ‰§è¡Œ</span><br>  <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(uri);<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;====&gt; <span class="hljs-subst">$&#123;result.statusCode&#125;</span>&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  _getData();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>====&gt; <span class="hljs-number">200</span><br></code></pre></td></tr></table></figure><h3 id="2-2ã€post-è¯·æ±‚"><a href="#2-2ã€post-è¯·æ±‚" class="headerlink" title="2.2ã€post è¯·æ±‚"></a>2.2ã€post è¯·æ±‚</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//json è½¬æ¢</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:convert&#x27;</span>;<br><span class="hljs-comment">//å¯¼å…¥ http å¹¶è®¾ç½®åˆ«å</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br><br><br><span class="hljs-comment">//ä½¿ç”¨ async æ ‡è®°ä¸ºå¼‚æ­¥</span><br><span class="hljs-keyword">void</span> _postData() <span class="hljs-keyword">async</span>&#123;<br>  <span class="hljs-comment">//æ„å»ºè¯·æ±‚ uri</span><br>  <span class="hljs-keyword">var</span> uri = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&quot;www.wanandroid.com&quot;</span>, <span class="hljs-string">&quot;/user/login&quot;</span>);<br>  <span class="hljs-comment">//ä½¿ç”¨ http å‘èµ· post è¯·æ±‚ï¼Œç­‰å¾…è¿”å›ç»“æœè¿›è¡Œåç»­ä»£ç æ‰§è¡Œ</span><br>  <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> http.post(uri,body: &#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;è´¦å·&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;å¯†ç &quot;</span>&#125;);<br>  <span class="hljs-keyword">if</span> (result.statusCode == <span class="hljs-number">200</span>) &#123;<br>    <span class="hljs-comment">//å°† json è§£ææˆ map</span><br>    <span class="hljs-keyword">var</span> resultMap = json.decode(result.body) <span class="hljs-keyword">as</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">dynamic</span>&gt;;<br>    <span class="hljs-comment">//æ‰“å° map é‡Œé¢çš„å±æ€§</span><br>    <span class="hljs-built_in">print</span>(resultMap[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;nickname&quot;</span>]);<br>  &#125;<br>&#125;<br><br><br><span class="hljs-keyword">void</span> main()&#123;<br>  _postData();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>sweetying<br></code></pre></td></tr></table></figure><h3 id="2-3ã€è¯·æ±‚æ¡ˆä¾‹å®æˆ˜"><a href="#2-3ã€è¯·æ±‚æ¡ˆä¾‹å®æˆ˜" class="headerlink" title="2.3ã€è¯·æ±‚æ¡ˆä¾‹å®æˆ˜"></a>2.3ã€è¯·æ±‚æ¡ˆä¾‹å®æˆ˜</h3><p>é¦–å…ˆçœ‹ä¸€çœ¼æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45f74a89d3914ba7bfb01a74833891ec~tplv-k3u1fbpfcp-watermark.image?" alt="ezgif.com-gif-maker (4).gif" width="30%" /><p>å®é™…ä¸Šå°±æ˜¯å°†æˆ‘ä»¬è¯·æ±‚çš„ç½‘ç»œæ•°æ®ä½¿ç”¨ ListView å±•ç¤ºå‡ºæ¥ï¼Œæ¯”è¾ƒç®€å•ï¼Œå¤§å®¶ä¸»è¦æŒæ¡æ€è·¯ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//å¯¼åŒ…</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:convert&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpPracticePage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  _HttpPracticePageState createState() =&gt; _HttpPracticePageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_HttpPracticePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">HttpPracticePage</span>&gt; </span>&#123;<br>  <span class="hljs-keyword">var</span> list = [];<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> initState() &#123;<br>    <span class="hljs-keyword">super</span>.initState();<br>    <span class="hljs-comment">//åŠ è½½ç½‘ç»œæ•°æ®</span><br>    _getData();<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MaterialApp(<br>      home: Scaffold(<br>          appBar: AppBar(<br>            title: Text(<span class="hljs-string">&#x27;Http å®è·µé¡µé¢&#x27;</span>),<br>          ),<br>          <span class="hljs-comment">//å¦‚æœ list ä¸ºç©ºï¼Œå±•ç¤ºä¸ºç©ºç™½é¡µé¢ï¼Œä¸ä¸ºç©ºæ¸²æŸ“ ListView</span><br>          body: list.isNotEmpty<br>              ? ListView.builder(<br>              itemCount: list.length,<br>              itemBuilder: (context, index) &#123;<br>                  <span class="hljs-keyword">return</span> ListTile(<br>                      title: Text(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;list[index][<span class="hljs-string">&quot;name&quot;</span>]&#125;</span>&quot;</span>),<br>                      subtitle: Text(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;list[index][<span class="hljs-string">&quot;link&quot;</span>]&#125;</span>&quot;</span>));<br>                &#125;)<br>              : Text(<span class="hljs-string">&quot;&quot;</span>)),<br>    );<br>  &#125;<br><br>  <span class="hljs-comment">//ä½¿ç”¨ async æ ‡è®°ä¸ºå¼‚æ­¥</span><br>  <span class="hljs-keyword">void</span> _getData() <span class="hljs-keyword">async</span> &#123;<br>    <span class="hljs-comment">//æ„å»ºè¯·æ±‚ uri</span><br>    <span class="hljs-keyword">var</span> uri = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&quot;www.wanandroid.com&quot;</span>, <span class="hljs-string">&quot;/friend/json&quot;</span>);<br>    <span class="hljs-comment">//ä½¿ç”¨ http å‘èµ· get è¯·æ±‚ï¼Œç­‰å¾…è¿”å›ç»“æœè¿›è¡Œåç»­ä»£ç æ‰§è¡Œ</span><br>    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(uri);<br>    <span class="hljs-keyword">if</span> (result.statusCode == <span class="hljs-number">200</span>) &#123;<br>      <span class="hljs-comment">//å°† json è§£ææˆ map</span><br>      <span class="hljs-keyword">var</span> map = json.decode(result.body) <span class="hljs-keyword">as</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt;;<br>      <span class="hljs-comment">//é€šçŸ¥ UI è¿›è¡Œåˆ·æ–°</span><br>      setState(() &#123;<br>        list = map[<span class="hljs-string">&quot;data&quot;</span>];<br>      &#125;);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Flutter ä¸­çš„è·¯ç”±ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä½¿ç”¨ä¸åŒçš„ Api</p><p>2ã€æ¨èä½¿ç”¨è·¯ç”±ç»Ÿä¸€ç®¡ç†ä»¥åŠå¯¼åŒ…çš„æ—¶å€™ä½¿ç”¨ç»å¯¹è·¯å¾„</p><p>3ã€ç®€å•çš„ä»‹ç»äº†ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ http è¿›è¡Œ getï¼Œpost è¯·æ±‚ï¼Œæœ€åè¿›è¡Œäº†ä¸€ä¸ªè¯·æ±‚æ¡ˆä¾‹çš„å®æˆ˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®² Flutter ä¸ Android çš„é€šä¿¡ï¼Œå°½è¯·æœŸå¾…å§ğŸº</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV1S4411E7LY?p=19&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">Flutter æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚çš„ Flutter å…¥é—¨æ•™ç¨‹</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆå…­ï¼‰ï¼šFlutter å¸¸ç”¨è¡¨å• Widget</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%E8%A1%A8%E5%8D%95%20Widget/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%E8%A1%A8%E5%8D%95%20Widget/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/313ea59d82f249428468c5c9186f69d0~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Flutter ä¸­å¸¸ç”¨çš„æŒ‰é’® Widgetï¼ŒFlutter 1.x å’Œ Flutter 2.x æŒ‰é’®çš„å˜åŒ–ï¼Œæœ€åé€šè¿‡ Flutter 1.x ç›¸å…³ Button + BottomNavigationBar + FloatingActionButton å®ç°äº†ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7137082885571346463">Flutter ç³»åˆ—ï¼ˆäº”ï¼‰ï¼šFlutter å¸¸ç”¨æŒ‰é’® Widget</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ Flutter è¡¨å• Widget è¿›è¡Œå­¦ä¹ </p><p>Flutter ä¸­å¸¸è§çš„è¡¨å•æœ‰ï¼šTextFieldï¼ŒCheckBoxï¼ŒRadioï¼ŒSwitchï¼ŒCheckboxListTileï¼ŒRadioListTileï¼ŒSwitchListTileï¼ŒSlider ç­‰ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹è¿™äº›å¸¸ç”¨çš„ Widget</p><h2 id="ä¸€ã€Flutter-å¸¸ç”¨è¡¨å•-Widget-ä»‹ç»"><a href="#ä¸€ã€Flutter-å¸¸ç”¨è¡¨å•-Widget-ä»‹ç»" class="headerlink" title="ä¸€ã€Flutter å¸¸ç”¨è¡¨å• Widget ä»‹ç»"></a>ä¸€ã€Flutter å¸¸ç”¨è¡¨å• Widget ä»‹ç»</h2><h3 id="1-1ã€TextFiled-æ–‡æœ¬æ¡†"><a href="#1-1ã€TextFiled-æ–‡æœ¬æ¡†" class="headerlink" title="1.1ã€TextFiled æ–‡æœ¬æ¡†"></a>1.1ã€TextFiled æ–‡æœ¬æ¡†</h3><p>TextFiled æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„æ–‡æœ¬æ¡† Widgetï¼Œå…¶å¸¸ç”¨çš„å±æ€§æœ‰ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>maxLines</td><td>int</td><td>è®¾ç½®æ­¤å‚æ•°å¯ä»¥æŠŠæ–‡æœ¬æ¡†æ”¹ä¸ºå¤šè¡Œæ–‡æœ¬æ¡†</td></tr><tr><td>onChanged</td><td>ValueChanged<String></td><td>æ–‡æœ¬æ¡†æ”¹å˜æ—¶è§¦å‘çš„äº‹ä»¶</td></tr><tr><td>decoratioin</td><td>InputDecoration</td><td>è£…é¥°ï¼ŒInputDecoration å¸¸ç”¨å±æ€§ï¼š<br>hintTextï¼šé»˜è®¤æç¤ºæ–‡æ¡ˆ<br>borderï¼šæ–‡æœ¬æ¡†è¾¹æ¡†ï¼Œé…åˆ OutlineInputBorder ä½¿ç”¨<br>labelTextï¼šlabel çš„åç§°<br>labelStyleï¼šé…ç½® label çš„æ ·å¼</td></tr><tr><td>obscureText</td><td>bool</td><td>æ˜¯å¦æŠŠæ–‡æœ¬æ¡†æ”¹ä¸ºå¯†ç æ¡†</td></tr><tr><td>controller</td><td>TextEditingController</td><td>é…ç½®æ–‡æœ¬æ¡†é»˜è®¤æ˜¾ç¤ºçš„å†…å®¹</td></tr></tbody></table><p>è¿è¡Œä¸‹é¢ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Form Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>    )<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Padding(<br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      child: Column(<br>        children: [<br>          TextField( <span class="hljs-comment">//è´¦å·è¾“å…¥æ¡†</span><br>            maxLines: <span class="hljs-number">1</span>, <span class="hljs-comment">//æœ€å¤§æ˜¾ç¤ºä¸€è¡Œ</span><br>            decoration: InputDecoration(<br>                hintText: <span class="hljs-string">&quot;please input account&quot;</span>, <span class="hljs-comment">//é»˜è®¤æç¤ºæ–‡æ¡ˆ</span><br>                label: Text(<span class="hljs-string">&quot;Account&quot;</span>) <span class="hljs-comment">//æ–‡æœ¬æ¡†æ ‡ç­¾æç¤º</span><br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          TextField(<span class="hljs-comment">//å¯†ç è¾“å…¥æ¡†</span><br>            maxLines: <span class="hljs-number">1</span>, <span class="hljs-comment">//æœ€å¤§æ˜¾ç¤ºä¸€è¡Œ</span><br>            obscureText: <span class="hljs-keyword">true</span>, <span class="hljs-comment">//è®¾ç½®æ–‡æœ¬è¾“å…¥ä¸ºå¯†æ–‡</span><br>            decoration: InputDecoration(<br>                hintText: <span class="hljs-string">&quot;please input password&quot;</span>, <span class="hljs-comment">//é»˜è®¤æç¤ºæ–‡æ¡ˆ</span><br>                label: Text(<span class="hljs-string">&quot;Password&quot;</span>) <span class="hljs-comment">//æ–‡æœ¬æ¡†æ ‡ç­¾æç¤º</span><br>            ),<br>          )<br>        ],<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/02d56e52ecc84c8baebd9e8b1f3cc86c~tplv-k3u1fbpfcp-watermark.image?" alt="textfield.png" width="50%" /><h3 id="1-2ã€Checkboxï¼ŒCheckboxListTile-å¤é€‰æ¡†"><a href="#1-2ã€Checkboxï¼ŒCheckboxListTile-å¤é€‰æ¡†" class="headerlink" title="1.2ã€Checkboxï¼ŒCheckboxListTile å¤é€‰æ¡†"></a>1.2ã€Checkboxï¼ŒCheckboxListTile å¤é€‰æ¡†</h3><p>Checkbox æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„å¤é€‰æ¡† Widgetï¼Œå¸¸ç”¨å±æ€§æœ‰ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>value</td><td>bool</td><td>å¿…å¡«é¡¹ï¼Œtrueï¼šé€‰ä¸­ï¼Œfalseï¼šæœªé€‰ä¸­</td></tr><tr><td>onChanged</td><td>ValueChanged<bool></td><td>å¿…å¡«é¡¹ï¼Œæ”¹å˜æ—¶è§¦å‘çš„äº‹ä»¶</td></tr><tr><td>activeColor</td><td>Color</td><td>é€‰ä¸­çš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>checkColor</td><td>Color</td><td>é€‰ä¸­å¤é€‰æ¡†é‡Œé¢ç¬¦å·çš„é¢œè‰²</td></tr></tbody></table><p>CheckboxListTile æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„å¤é€‰æ¡†åˆ—è¡¨ Itemï¼Œå¸¸ç”¨å±æ€§æœ‰ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>value</td><td>bool</td><td>å¿…å¡«é¡¹ï¼Œtrueï¼šé€‰ä¸­ï¼Œfalseï¼šæœªé€‰ä¸­</td></tr><tr><td>onChanged</td><td>ValueChanged<bool></td><td>å¿…å¡«é¡¹ï¼Œæ”¹å˜æ—¶è§¦å‘çš„äº‹ä»¶</td></tr><tr><td>activeColor</td><td>Color</td><td>é€‰ä¸­çš„èƒŒæ™¯é¢œè‰²ï¼Œå¦‚æœ selected ä¸º true ï¼Œåˆ™ titleï¼Œsubtitleï¼Œsecondary ä¹Ÿä¼šå˜</td></tr><tr><td>checkColor</td><td>Color</td><td>é€‰ä¸­å¤é€‰æ¡†é‡Œé¢ç¬¦å·çš„é¢œè‰²</td></tr><tr><td>title</td><td>Widget</td><td>æ ‡é¢˜</td></tr><tr><td>subtitle</td><td>Widget</td><td>äºŒçº§æ ‡é¢˜</td></tr><tr><td>secondary</td><td>Widget</td><td>é…ç½®æ˜¾ç¤ºçš„å›¾æ ‡æˆ–å›¾ç‰‡</td></tr><tr><td>selected</td><td>bool</td><td>é€‰ä¸­æ—¶å…¶å®ƒå­ Widget é¢œè‰²æ˜¯å¦è·Ÿç€æ”¹å˜</td></tr></tbody></table><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰ Wdiget éƒ½æ˜¯ç»§æ‰¿ StatelessWidgetï¼Œä½†è¡¨å•ç›¸å…³çš„ Widget éƒ½æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå› æ­¤éœ€è¦ç»§æ‰¿ StatefulWidget æ¥åŠ¨æ€å±•ç¤ºå®ƒçš„ä¸€ä¸ªçŠ¶æ€ï¼Œç»§æ‰¿ StatefulWidget çš„ä¸€ä¸ªæ ‡å‡†æ¨¡ç‰ˆå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt;</span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> implement build</span><br>    <span class="hljs-keyword">throw</span> UnimplementedError();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Checkboxï¼ŒCheckboxListTile æ¥å®è·µä¸€ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Form Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>    )<br>  ));<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt; </span>&#123;<br><br>  <span class="hljs-comment">//è®°å½•ç¬¬ä¸€ä¸ªå¤é€‰æ¡†çš„é€‰ä¸­çŠ¶æ€</span><br>  <span class="hljs-keyword">var</span> flag1 = <span class="hljs-keyword">false</span>;<br>  <span class="hljs-comment">//è®°å½•ç¬¬äºŒä¸ªå¤é€‰æ¡†çš„é€‰ä¸­çŠ¶æ€</span><br>  <span class="hljs-keyword">var</span> flag2 = <span class="hljs-keyword">false</span>;<br>  <span class="hljs-comment">//è®°å½•ç¬¬ä¸‰ä¸ªå¤é€‰æ¡†çš„é€‰ä¸­çŠ¶æ€</span><br>  <span class="hljs-keyword">var</span> flag3 = <span class="hljs-keyword">false</span>;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Column(<br>      mainAxisAlignment: MainAxisAlignment.center,<br>      children: [<br>        Checkbox( <span class="hljs-comment">//ç¬¬ä¸€ä¸ªå¤é€‰æ¡†</span><br>          value: flag1,<br>          onChanged: (value)&#123;<br>            setState(() &#123;<br>              flag1 = value??<span class="hljs-keyword">false</span>; <span class="hljs-comment">//æ›´æ–°å¤é€‰æ¡†çš„çŠ¶æ€</span><br>            &#125;);<br>          &#125;,<br>        ),<br>        Row(<br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: [<br>            Text(flag1 == <span class="hljs-keyword">true</span> ? <span class="hljs-string">&quot;é€‰ä¸­&quot;</span> : <span class="hljs-string">&quot;æœªé€‰ä¸­&quot;</span>)<br>          ],<br>        ),<br>        Divider(color: Colors.black),<br>        CheckboxListTile(value: flag2, onChanged: (value)&#123; <span class="hljs-comment">//ç¬¬äºŒä¸ªå¤é€‰æ¡†åˆ—è¡¨ item</span><br>          setState(() &#123;<br>            flag2 = value??<span class="hljs-keyword">false</span>; <span class="hljs-comment">//æ›´æ–°å¤é€‰æ¡†çš„çŠ¶æ€</span><br>          &#125;);<br>        &#125;,<br>          activeColor: Colors.green, <span class="hljs-comment">//é€‰ä¸­çš„èƒŒæ™¯é¢œè‰²ï¼Œå¦‚æœ selected ä¸º true ï¼Œåˆ™ titleï¼Œsubtitleï¼Œsecondary ä¹Ÿä¼šå˜</span><br>          checkColor: Colors.black, <span class="hljs-comment">//é€‰ä¸­å¤é€‰æ¡†é‡Œé¢ç¬¦å·çš„é¢œè‰²</span><br>          title: Text(<span class="hljs-string">&#x27;æ ‡é¢˜&#x27;</span>), <span class="hljs-comment">//å±•ç¤ºæ ‡é¢˜</span><br>          subtitle: Text(<span class="hljs-string">&quot;æè¿°&quot;</span>), <span class="hljs-comment">//å±•ç¤ºå‰¯æ ‡é¢˜</span><br>          selected: flag2, <span class="hljs-comment">//é€‰ä¸­æ—¶å…¶å®ƒå­ Widget é¢œè‰²è·Ÿç€æ”¹å˜</span><br>        ),<br><br>        Divider(color: Colors.black),<br><br>        CheckboxListTile(value: flag3, onChanged: (value)&#123; <span class="hljs-comment">//ç¬¬ä¸‰ä¸ªå¤é€‰æ¡†åˆ—è¡¨ item</span><br>          setState(() &#123;<br>            flag3 = value??<span class="hljs-keyword">false</span>; <span class="hljs-comment">//æ›´æ–°å¤é€‰æ¡†çš„çŠ¶æ€</span><br>          &#125;);<br>        &#125;,<br>          title: Text(<span class="hljs-string">&#x27;æ ‡é¢˜&#x27;</span>), <span class="hljs-comment">//å±•ç¤ºæ ‡é¢˜</span><br>          subtitle: Text(<span class="hljs-string">&quot;æè¿°&quot;</span>), <span class="hljs-comment">//å±•ç¤ºå‰¯æ ‡é¢˜</span><br>          secondary: Icon(Icons.home), <span class="hljs-comment">//å±•ç¤ºå›¾æ ‡</span><br>          selected: <span class="hljs-keyword">false</span>, <span class="hljs-comment">//é€‰ä¸­æ—¶å…¶å®ƒå­ Widget é¢œè‰²ä¸è·Ÿç€æ”¹å˜</span><br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/152787ffc53245e6952bdb94f269da08~tplv-k3u1fbpfcp-watermark.image?" alt="checkbox.gif" width="30%" /><h3 id="1-3ã€Radioï¼ŒRadioListTile-å•é€‰æ¡†"><a href="#1-3ã€Radioï¼ŒRadioListTile-å•é€‰æ¡†" class="headerlink" title="1.3ã€Radioï¼ŒRadioListTile å•é€‰æ¡†"></a>1.3ã€Radioï¼ŒRadioListTile å•é€‰æ¡†</h3><p>Radioï¼ŒRadioListTile æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„å•é€‰æ¡†å’Œå•é€‰æ¡†åˆ—è¡¨ Itemï¼Œå®ƒçš„å¸¸ç”¨å±æ€§å’Œ Checkboxï¼ŒCheckboxListTile éå¸¸ç±»ä¼¼ï¼ŒåŒºåˆ«å°±æ˜¯ï¼šRadioï¼ŒRadioListTile å¿…é¡»æä¾›ä¸€ä¸ª groupValue å±æ€§ç”¨äºè®°å½•å•é€‰æ¡†çš„åˆ†ç»„ï¼Œç›´æ¥ä¸Šä»£ç æ„Ÿå—ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Form Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>    )<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//æ€§åˆ«</span><br>  <span class="hljs-built_in">int</span> sex = <span class="hljs-number">1</span>;<br>  <span class="hljs-comment">//ç¬¬äºŒä¸ªå¤é€‰æ¡†çŠ¶æ€æ ‡è®°</span><br>  <span class="hljs-built_in">bool</span> flag = <span class="hljs-keyword">true</span>;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Column(<br>      mainAxisAlignment: MainAxisAlignment.center,<br>      children: [<br>        <span class="hljs-comment">//ç¬¬ä¸€ç»„å•é€‰æ¡†</span><br>        Row(<br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: [<br>            Text(<span class="hljs-string">&quot;ç”·&quot;</span>),<br>            Radio(<br>                value: <span class="hljs-number">1</span>,<br>                onChanged: (value) &#123;<br>                  setState(() &#123;<br>                    sex = value <span class="hljs-keyword">as</span> <span class="hljs-built_in">int</span>; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>                  &#125;);<br>                &#125;,<br>                groupValue: sex), <span class="hljs-comment">//groupValue ä¸º sex</span><br>            SizedBox(width: <span class="hljs-number">20</span>),<br>            Text(<span class="hljs-string">&quot;å¥³&quot;</span>),<br>            Radio(<br>                value: <span class="hljs-number">2</span>,<br>                onChanged: (value) &#123;<br>                  setState(() &#123;<br>                    sex = value <span class="hljs-keyword">as</span> <span class="hljs-built_in">int</span>; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>                  &#125;);<br>                &#125;,<br>                groupValue: sex) <span class="hljs-comment">//groupValue ä¸º sex</span><br>          ],<br>        ),<br>        SizedBox(height: <span class="hljs-number">20</span>),<br>        Divider(),<br>         <span class="hljs-comment">//ç¬¬äºŒç»„å•é€‰æ¡†</span><br>        RadioListTile(<br>          value: <span class="hljs-keyword">true</span>,<br>          onChanged: (value) &#123;<br>            setState(() &#123;<br>              flag = value <span class="hljs-keyword">as</span> <span class="hljs-built_in">bool</span>; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>            &#125;);<br>          &#125;,<br>          groupValue: flag, <span class="hljs-comment">//groupValue ä¸º flag</span><br>          title: Text(<span class="hljs-string">&quot;ä¸€çº§æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//æ ‡é¢˜</span><br>          subtitle: Text(<span class="hljs-string">&quot;äºŒçº§æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//å‰¯æ ‡é¢˜</span><br>          secondary: Icon(Icons.home), <span class="hljs-comment">//æ˜¾ç¤ºå›¾æ ‡</span><br>        ),<br>        RadioListTile(<br>          value: <span class="hljs-keyword">false</span>,<br>          onChanged: (value) &#123;<br>            setState(() &#123;<br>              flag = value <span class="hljs-keyword">as</span> <span class="hljs-built_in">bool</span>; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>            &#125;);<br>          &#125;,<br>          groupValue: flag, <span class="hljs-comment">//groupValue ä¸º flag</span><br>          title: Text(<span class="hljs-string">&quot;ä¸€çº§æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//æ ‡é¢˜</span><br>          subtitle: Text(<span class="hljs-string">&quot;äºŒçº§æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//å‰¯æ ‡é¢˜</span><br>          secondary: Image.network( <span class="hljs-comment">//æ˜¾ç¤ºå›¾ç‰‡</span><br>              <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>),<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d902dab159d44c4b737255539be94e4~tplv-k3u1fbpfcp-watermark.image?" alt="radiobutton.gif" width="30%" /><h3 id="1-4ã€Switchï¼ŒSwitchListTile-å¼€å…³"><a href="#1-4ã€Switchï¼ŒSwitchListTile-å¼€å…³" class="headerlink" title="1.4ã€Switchï¼ŒSwitchListTile å¼€å…³"></a>1.4ã€Switchï¼ŒSwitchListTile å¼€å…³</h3><p>Switchï¼ŒSwitchListTile æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„å¼€å…³å’Œå¼€å…³åˆ—è¡¨ Itemï¼Œå¸¸ç”¨å±æ€§å’Œä¸Šé¢ä¸¤ä¸ªç±»ä¼¼ï¼Œæˆ‘ä»¬å¿«é€Ÿè¿‡ä¸€ä¸‹ï¼š</p><p>ä»£ç å®è·µï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Form Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>    )<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt; </span>&#123;<br>  <span class="hljs-comment">//å¼€å…³çš„çŠ¶æ€æ ‡è®°</span><br>  <span class="hljs-built_in">bool</span> flag = <span class="hljs-keyword">true</span>;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Column(<br>      children: [<br>        Switch( <span class="hljs-comment">//Switch</span><br>            value: flag,<br>            onChanged: (value) &#123;<br>              setState(() &#123;<br>                flag = value; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>              &#125;);<br>            &#125;),<br>        SizedBox(height: <span class="hljs-number">20</span>),<br>        SwitchListTile( <span class="hljs-comment">//SwitchListTile</span><br>            value: flag,<br>            onChanged: (value) &#123;<br>              setState(() &#123;<br>                flag = value; <span class="hljs-comment">//æ›´æ–°çŠ¶æ€</span><br>              &#125;);<br>            &#125;,<br>            title: Text(<span class="hljs-string">&quot;æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//æ ‡é¢˜</span><br>            subtitle: Text(<span class="hljs-string">&quot;å‰¯æ ‡é¢˜&quot;</span>), <span class="hljs-comment">//å‰¯æ ‡é¢˜</span><br>            secondary: Image.network( <span class="hljs-comment">//æ˜¾ç¤ºå›¾ç‰‡</span><br>              <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>            ) <br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45fad04d96ec4c12a3b9f7ee67e04580~tplv-k3u1fbpfcp-watermark.image?" alt="switch.gif" width="30%" /><h3 id="1-5ã€Slider-è¿›åº¦æ¡"><a href="#1-5ã€Slider-è¿›åº¦æ¡" class="headerlink" title="1.5ã€Slider è¿›åº¦æ¡"></a>1.5ã€Slider è¿›åº¦æ¡</h3><p>Slider æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„è¿›åº¦æ¡ Widgetã€‚å…¶å¸¸ç”¨å±æ€§æœ‰ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>value</td><td>double</td><td>å¿…å¡«é¡¹ï¼Œå½“å‰ Slider æ»‘å—ä½ç½®çš„å€¼ï¼Œæ³¨æ„ä¸å¯ä»¥è¶…å‡º min å’Œ max çš„èŒƒå›´ï¼Œå¦åˆ™ä¼šæŠ¥é”™</td></tr><tr><td>onChanged</td><td>ValueChanged<double></td><td>å¿…å¡«é¡¹ï¼Œæ­£åœ¨æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ï¼Œæœªæ¾æ‰‹</td></tr><tr><td>onChangeStart</td><td>ValueChanged<double></td><td>åˆšå¼€å§‹ç‚¹å‡»</td></tr><tr><td>onChangeEnd</td><td>ValueChanged<double></td><td>æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ç»“æŸï¼Œå·²æ¾æ‰‹</td></tr><tr><td>min</td><td>double</td><td>æœ€å°å€¼ï¼Œé»˜è®¤ä¸º 0.0</td></tr><tr><td>max</td><td>double</td><td>æœ€å¤§å€¼ï¼Œé»˜è®¤ä¸º 1.0</td></tr><tr><td>activeColor</td><td>Color</td><td>æ»‘å—é¢œè‰²</td></tr><tr><td>inactiveColor</td><td>Color</td><td>è½¨é“é¢œè‰²</td></tr><tr><td>label</td><td>String</td><td>æ°”æ³¡æ–‡æœ¬</td></tr><tr><td>divisions</td><td>int</td><td>åˆ»åº¦ï¼Œå¦‚æ²¡æœ‰åˆ»åº¦ï¼Œlabel åˆ™ä¸ä¼šå±•ç¤º</td></tr></tbody></table><p>ä»£ç å®è·µï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Form Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>    )<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt;</span>&#123;<br>  <span class="hljs-comment">//æ»‘å—çš„å€¼</span><br>  <span class="hljs-built_in">double</span> sliderValue = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span><br>  <span class="hljs-keyword">void</span> updateSlider(value)&#123;<br>    sliderValue = value;<br>    setState(() &#123;<br><br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Padding(<br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      child: Column(<br>        children: [<br>          _slider() <br>        ],<br>      ),<br>    );<br>  &#125;<br><br>  <span class="hljs-comment">//æ„å»ºæ»‘å— Widget</span><br>  Slider _slider()&#123;<br>    <span class="hljs-keyword">return</span> Slider(<br>      value: sliderValue,<br>      max: <span class="hljs-number">100</span>, <span class="hljs-comment">//æœ€å¤§å€¼ä¸º 100</span><br>      activeColor: Colors.red, <span class="hljs-comment">//æ»‘å—é¢œè‰²ä¸ºçº¢è‰²</span><br>      inactiveColor: Colors.green, <span class="hljs-comment">//è½¨é“é¢œè‰²ä¸ºç»¿è‰²</span><br>      label: <span class="hljs-string">&quot;è¿›åº¦ï¼š<span class="hljs-subst">$sliderValue</span>&quot;</span>, <span class="hljs-comment">//æ°”æ³¡æ–‡æœ¬</span><br>      divisions: <span class="hljs-number">10</span>, <span class="hljs-comment">//åˆ»åº¦</span><br>      onChanged: (value)&#123; <span class="hljs-comment">//æ­£åœ¨æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ï¼Œæœªæ¾æ‰‹</span><br>        updateSlider(value);<br>      &#125;,<br>      onChangeStart: (value)&#123; <span class="hljs-comment">//åˆšå¼€å§‹ç‚¹å‡»</span><br>        updateSlider(value);<br>      &#125;,<br>      onChangeEnd: (value)&#123; <span class="hljs-comment">//æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ç»“æŸï¼Œå·²æ¾æ‰‹</span><br>        updateSlider(value);<br>      &#125;,<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1783f4399eb14b8eaafb5a5a69778c0d~tplv-k3u1fbpfcp-watermark.image?" alt="slider.gif" width="30%" /><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ SliderTheme åµŒå¥— Slider å®ç°å„ç§è‡ªå®šä¹‰æ ·å¼ï¼Œè¿™é‡Œå°±ä¸åšæ¼”ç¤ºäº†ï¼ŒSliderTheme å¸¸ç”¨å±æ€§æœ‰ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>data</td><td>SliderThemeData</td><td>å¿…å¡«é¡¹ï¼Œé€šè¿‡ SliderThemeData å®ç°å„ç§è‡ªå®šä¹‰æ ·å¼</td></tr><tr><td>child</td><td>Widget</td><td>å¿…å¡«é¡¹ï¼Œå­ Widget</td></tr></tbody></table><p>SliderThemeData å±æ€§ä»‹ç»ï¼š<a href="https://api.flutter.dev/flutter/material/SliderThemeData-class.html">https://api.flutter.dev/flutter/material/SliderThemeData-class.html</a></p><h2 id="äºŒã€è¡¨å•-Widget-ä¹‹ç»¼åˆæ¡ˆä¾‹"><a href="#äºŒã€è¡¨å•-Widget-ä¹‹ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="äºŒã€è¡¨å• Widget ä¹‹ç»¼åˆæ¡ˆä¾‹"></a>äºŒã€è¡¨å• Widget ä¹‹ç»¼åˆæ¡ˆä¾‹</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨è¡¨å• Widget åšä¸€ä¸ªç”¨æˆ·ä¿¡æ¯ç™»è®°ç³»ç»Ÿï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b87c5a8f38ca46c1a1c9931f6a9d6cda~tplv-k3u1fbpfcp-watermark.image?" alt="form_combine.gif" width="30%" /><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬å…ˆåˆ†æè¿™ä¸ªé¡µé¢ï¼š</p><p>1ã€å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»ä¸Šå¾€ä¸‹çš„å‚ç›´å¸ƒå±€ï¼Œæœ‰ä¸ªå†…è¾¹è·ï¼Œå­ Widget æ˜¯è‡ªé€‚åº”çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ListView å¹¶è®¾ç½®ä¸€ä¸ª padding å®ç°</p><p>2ã€ç„¶åä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯ï¼Œè¾“å…¥å§“åï¼šæ–‡æœ¬æ¡†ï¼ˆTextFieldï¼‰ï¼Œæ€§åˆ«é€‰æ‹©ï¼šå•é€‰æ¡†ï¼ˆRadioï¼‰ï¼Œå…´è¶£çˆ±å¥½ï¼šå¤é€‰æ¡†ï¼ˆCheckboxï¼‰ï¼Œé¢œå€¼æ‰“åˆ†ï¼šæ»‘å—ï¼ˆSliderï¼‰ï¼Œæ°¸ä¸å®•æœºï¼šå¼€å…³ï¼ˆSwitchListTileï¼‰ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆRaisedButtonï¼‰ï¼Œç”¨æˆ·ä¿¡æ¯å±•ç¤ºï¼ˆTextï¼‰</p><p>3ã€è¿™äº› Widget éƒ½æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»§æ‰¿ StatefulWidgetï¼Œå¹¶ä½¿ç”¨ setState æ–¹æ³•å»æ›´æ–°çŠ¶æ€</p><p>æˆ‘ä»¬ç”»ä¸€å¼ å›¾æ¥ç†ä¸€ä¸‹ Widget ä¹‹é—´çš„æ ‘å½¢ç»“æ„ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca88da02d2e84137ac6b3fd017ab63c1~tplv-k3u1fbpfcp-watermark.image?" alt="è¡¨å• Widget ä¹‹ç»¼åˆæ¡ˆä¾‹.png" width="50%" /><p>æœ€åæˆ‘ä»¬è¿›è¡Œä»£ç å®ç°ï¼Œé‡Œé¢å†™äº†è¯¦ç»†çš„æ³¨é‡Šï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>      home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;ç”¨æˆ·ä¿¡æ¯ç™»è®°ç³»ç»Ÿ&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>      )<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  State&lt;StatefulWidget&gt; createState() =&gt; _MyBodyPageState();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyBodyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyBodyPage</span>&gt; </span>&#123;<br><br>  <span class="hljs-comment">//ç”¨æˆ·å§“å</span><br>  <span class="hljs-built_in">String</span> userName = <span class="hljs-string">&quot;&quot;</span>;<br>  <span class="hljs-comment">//æ€§åˆ«</span><br>  <span class="hljs-built_in">int</span> sex = <span class="hljs-number">1</span>;<br>  <span class="hljs-comment">//æ˜¯å¦å¼€å¯æ°¸ä¸å®•æœº</span><br>  <span class="hljs-built_in">bool</span> flag = <span class="hljs-keyword">false</span>;<br>  <span class="hljs-comment">//é¢œå€¼æ‰“åˆ†</span><br>  <span class="hljs-built_in">double</span> sliderValue = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">//å…´è¶£çˆ±å¥½</span><br>  <span class="hljs-built_in">List</span> hobbies = [<br>    &#123;<span class="hljs-string">&quot;checked&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ‰“ç¯®çƒ&quot;</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;checked&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;çˆ¬å±±&quot;</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;checked&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;å†™ä»£ç &quot;</span>&#125;,<br>  ];<br>  <span class="hljs-comment">//ä¸ªäººä¿¡æ¯</span><br>  <span class="hljs-built_in">String</span> info = <span class="hljs-string">&quot;&quot;</span>;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ListView(<br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      children: [<br>        TextField( <span class="hljs-comment">//æ–‡æœ¬æ¡†ï¼šç”¨æˆ·å§“å</span><br>          decoration: InputDecoration(<br>              hintText: <span class="hljs-string">&quot;è¯·è¾“å…¥ç”¨æˆ·å§“å&quot;</span>, <span class="hljs-comment">//é»˜è®¤æç¤ºæ–‡æ¡ˆ</span><br>              label: Text(<span class="hljs-string">&quot;å§“å&quot;</span>) <span class="hljs-comment">//æ ‡ç­¾</span><br>          ),<br>          onChanged: (str)&#123;<br>            setState(() &#123;<br>              userName = str; <span class="hljs-comment">//æ›´æ–°ç”¨æˆ·å§“åçŠ¶æ€</span><br>            &#125;);<br>          &#125;,<br>        ),<br>        SizedBox(height: <span class="hljs-number">10</span>),<br>        Text(<span class="hljs-string">&quot;æ€§åˆ«ï¼š&quot;</span>),<br>        Row( <span class="hljs-comment">//æ€§åˆ«é€‰æ‹©</span><br>          children: [<br>            Text(<span class="hljs-string">&quot;ç”·&quot;</span>),<br>            Radio(value: <span class="hljs-number">1</span>, groupValue: sex, onChanged: _sexChanged),<br>            Text(<span class="hljs-string">&quot;å¥³&quot;</span>),<br>            Radio(value: <span class="hljs-number">2</span>, groupValue: sex, onChanged:_sexChanged)<br>          ],<br>        ),<br>        Text(<span class="hljs-string">&quot;å…´è¶£çˆ±å¥½ï¼š&quot;</span>),<br>        Row( <span class="hljs-comment">//å…´è¶£çˆ±å¥½</span><br>          children: _getHobbies(),<br>        ),<br>        _slider(),<br>        Row( <span class="hljs-comment">//é¢œå€¼æ‰“åˆ†</span><br>          mainAxisAlignment: MainAxisAlignment.center,<br>          children: [<br>            Text(<span class="hljs-string">&quot;é¢œå€¼ï¼š<span class="hljs-subst">$sliderValue</span>åˆ†&quot;</span>),<br>          ],<br>        ),<br>        SwitchListTile( <span class="hljs-comment">//å¼€å…³æ°¸ä¸å®•æœº</span><br>            value: flag,<br>            title: Text(<span class="hljs-string">&quot;æ°¸ä¸å®•æœº&quot;</span>),<br>            onChanged: (value)&#123;<br>              setState(() &#123;<br>                flag = value;<br>              &#125;);<br>            &#125;<br>        ),<br>        RaisedButton( <span class="hljs-comment">//è·å–ç”¨æˆ·ä¿¡æ¯</span><br>          child: Text(<span class="hljs-string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;</span>),<br>          onPressed: ()&#123;<br>            setState(() &#123;<br>              info = getInfo(); <span class="hljs-comment">//æ›´æ–°ç”¨æˆ·çŠ¶æ€ä¿¡æ¯</span><br>            &#125;);<br>          &#125;,<br>          color: Colors.blue,<br>          textColor: Colors.white,<br>        ),<br><br>        Text(info) <span class="hljs-comment">//ç”¨æˆ·ä¿¡æ¯å±•ç¤º</span><br>      ],<br>    );<br>  &#125;<br><br>  <span class="hljs-comment">//è·å–ç”¨æˆ·å±•ç¤ºçš„ä¿¡æ¯</span><br>  <span class="hljs-built_in">String</span> getInfo() &#123;<br>    <span class="hljs-built_in">String</span> hobbiesStr = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> hobbies) &#123;<br>      <span class="hljs-keyword">if</span>(element[<span class="hljs-string">&quot;checked&quot;</span>])&#123;<br>        hobbiesStr += element[<span class="hljs-string">&quot;title&quot;</span>] + <span class="hljs-string">&quot;ï¼Œ&quot;</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;<span class="hljs-subst">$userName</span>ï¼Œæ€§åˆ«<span class="hljs-subst">$&#123;sex == <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;ç”·&quot;</span> : <span class="hljs-string">&quot;å¥³&quot;</span>&#125;</span>ï¼Œå–œæ¬¢<span class="hljs-subst">$hobbiesStr</span><span class="hljs-subst">$&#123;flag ? <span class="hljs-string">&quot;æ°¸ä¸å®•æœºï¼Œ&quot;</span> : <span class="hljs-string">&quot;&quot;</span>&#125;</span>é¢œå€¼<span class="hljs-subst">$sliderValue</span>åˆ†&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//æ›´æ–°æ€§åˆ«çŠ¶æ€</span><br>  <span class="hljs-keyword">void</span> _sexChanged(value)&#123;<br>    setState(() &#123;<br>      sex = value <span class="hljs-keyword">as</span> <span class="hljs-built_in">int</span>;<br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-comment">//æ›´æ–°æ»‘å—çŠ¶æ€</span><br>  <span class="hljs-keyword">void</span> updateSlider(value)&#123;<br>    sliderValue = value;<br>    setState(() &#123;<br><br>    &#125;);<br>  &#125;<br><br>  <span class="hljs-comment">//è·å–å…´è¶£çˆ±å¥½ Widget List</span><br>  <span class="hljs-built_in">List</span>&lt;Widget&gt; _getHobbies() &#123;<br>    <span class="hljs-built_in">List</span>&lt;Widget&gt; temp = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> hobbies) &#123;<br>      <span class="hljs-comment">//æ·»åŠ  Text</span><br>      temp.add(Text(element[<span class="hljs-string">&quot;title&quot;</span>]));<br>      <span class="hljs-comment">//æ·»åŠ  Checkbox</span><br>      temp.add(Checkbox(<br>          value: element[<span class="hljs-string">&quot;checked&quot;</span>],<br>          onChanged: (value) &#123;<br>            setState(() &#123;<br>              element[<span class="hljs-string">&quot;checked&quot;</span>] = value;<br>            &#125;);<br>          &#125;));<br>    &#125;<br>    <span class="hljs-keyword">return</span> temp;<br>  &#125;<br><br>  <span class="hljs-comment">//è·å–æ»‘å— Widget</span><br>  Slider _slider()&#123;<br>    <span class="hljs-keyword">return</span> Slider(<br>      value: sliderValue,<br>      max: <span class="hljs-number">100</span>, <span class="hljs-comment">//æœ€å¤§å€¼ä¸º 100</span><br>      label: <span class="hljs-string">&quot;é¢œå€¼ï¼š<span class="hljs-subst">$sliderValue</span>åˆ†&quot;</span>, <span class="hljs-comment">//æ°”æ³¡æ–‡æœ¬</span><br>      divisions: <span class="hljs-number">10</span>, <span class="hljs-comment">//åˆ»åº¦</span><br>      onChanged: (value)&#123; <span class="hljs-comment">//æ­£åœ¨æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ï¼Œæœªæ¾æ‰‹</span><br>        updateSlider(value);<br>      &#125;,<br>      onChangeStart: (value)&#123; <span class="hljs-comment">//åˆšå¼€å§‹ç‚¹å‡»</span><br>        updateSlider(value);<br>      &#125;,<br>      onChangeEnd: (value)&#123; <span class="hljs-comment">//æ»‘åŠ¨æˆ–è€…ç‚¹å‡»ç»“æŸï¼Œå·²æ¾æ‰‹</span><br>        updateSlider(value);<br>      &#125;,<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Flutter ä¸­å¸¸ç”¨çš„è¡¨å• Widget ï¼šTextFieldï¼ŒCheckBoxï¼ŒRadioï¼ŒSwitchï¼ŒCheckboxListTileï¼ŒRadioListTileï¼ŒSwitchListTileï¼ŒSlider çš„å¸¸ç”¨å±æ€§å’Œä½¿ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„æ˜¾ç¤ºæ•ˆæœ</p><p>2ã€é€šè¿‡è¡¨å• Widget ç»„åˆå®ç°äº†ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯ç™»è®°ç³»ç»Ÿ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>åç»­ä¸ä¼šèŠ±å¤§ç¯‡å¹…å»ä»‹ç» Widgetï¼Œæˆ‘ä¼šç©¿æ’åœ¨å…¶å®ƒçŸ¥è¯†ç‚¹ä¸­ç®€å•ä»‹ç»ä¸‹ï¼ŒFlutter ä¸­æœ‰ 400 å¤šä¸ª Widgetï¼Œä¸å¯èƒ½æ¯ä¸ªéƒ½å»å­¦ï¼Œæˆ‘çš„å»ºè®®ï¼šæŒæ¡å¸¸ç”¨çš„ï¼Œå…¶å®ƒç”¨åˆ°æ—¶åœ¨å»å®˜ç½‘æŸ¥è¯¢ã€‚</p><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®² Flutter ä¸­çš„è·¯ç”±ä»¥åŠå®é™…å¼€å‘ä¸­è¯·æ±‚ Http æ¥å£æ¸²æŸ“é¡µé¢ï¼Œå°½è¯·æœŸå¾…å§ğŸº</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV1S4411E7LY?p=19&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">Flutter æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚çš„ Flutter å…¥é—¨æ•™ç¨‹</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆäº”ï¼‰ï¼šFlutter å¸¸ç”¨æŒ‰é’® Widget</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%94%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%E6%8C%89%E9%92%AE%20Widget/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%94%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%E6%8C%89%E9%92%AE%20Widget/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a784cd0ae6b1439a8c9e3d0ac0b92ea8~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ï¼šæ•ˆæœå±•ç¤º -&gt; Widget ä»‹ç» -&gt; ä»£ç å®ç°çš„æ–¹å¼å¯¹ Imageï¼ŒListViewï¼ŒGridViewï¼ŒStack è¿›è¡Œäº†ä»‹ç»ï¼Œå¹¶ç©¿æ’è®²è§£äº†ä¸€äº›å…¶å®ƒ Widget ï¼Œæœ€åé€šè¿‡ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹å¯¹å­¦ä¹ çš„ Widget è¿›è¡Œäº†ç»„åˆä½¿ç”¨ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7135827895993237541">Flutter ç³»åˆ—ï¼ˆå››ï¼‰ï¼šFlutter å¸¸ç”¨ Widget äºŒ</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ Flutter æŒ‰é’® Widget è¿›è¡Œå­¦ä¹ </p><p>Flutter ä¸­çš„æŒ‰é’® Widget æœ‰å¾ˆå¤šï¼Œå¸¸è§çš„æŒ‰é’® Widget æœ‰ï¼šRaisedButtonï¼ŒFlatButtonï¼ŒIconButtonï¼ŒOutlineButtonï¼ŒButtonBarï¼ŒFloatingActionButton ç­‰ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹è¿™äº›å¸¸ç”¨çš„ Widget</p><h2 id="ä¸€ã€Flutter-å¸¸ç”¨æŒ‰é’®-Widget-ä»‹ç»"><a href="#ä¸€ã€Flutter-å¸¸ç”¨æŒ‰é’®-Widget-ä»‹ç»" class="headerlink" title="ä¸€ã€Flutter å¸¸ç”¨æŒ‰é’® Widget ä»‹ç»"></a>ä¸€ã€Flutter å¸¸ç”¨æŒ‰é’® Widget ä»‹ç»</h2><h3 id="1-1ã€Flutter-æŒ‰é’®-Widget-é€šç”¨å±æ€§"><a href="#1-1ã€Flutter-æŒ‰é’®-Widget-é€šç”¨å±æ€§" class="headerlink" title="1.1ã€Flutter æŒ‰é’® Widget é€šç”¨å±æ€§"></a>1.1ã€Flutter æŒ‰é’® Widget é€šç”¨å±æ€§</h3><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹ï¼ŒæŒ‰é’® Widget éƒ½æœ‰çš„ä¸€äº›å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>onPressed</td><td>VoidCallback</td><td>æ­¤é¡¹ä¸ºå¿…å¡«å‚æ•°ï¼ŒæŒ‰ä¸‹æŒ‰é’®æ—¶è§¦å‘çš„å›è°ƒï¼Œæ¥æ”¶ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå‚æ•°ï¼Œä¼  null è¡¨ç¤ºæŒ‰é’®ç¦ç”¨ï¼Œä¼šæ˜¾ç¤ºç¦ç”¨ç›¸å…³æ ·å¼</td></tr><tr><td>child</td><td>Widget</td><td>å­æ§ä»¶ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šä½¿ç”¨æ–‡æœ¬ Widget æ¥å¡«å……</td></tr><tr><td>textColor</td><td>Color</td><td>æ–‡æœ¬é¢œè‰²</td></tr><tr><td>color</td><td>Color</td><td>æŒ‰é’®èƒŒæ™¯é¢œè‰²</td></tr><tr><td>disabledColor</td><td>Color</td><td>æŒ‰é’®ç¦ç”¨æ—¶çš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>disabledTextColor</td><td>Color</td><td>æŒ‰é’®ç¦ç”¨æ—¶çš„æ–‡æœ¬é¢œè‰²</td></tr><tr><td>splashColor</td><td>Color</td><td>ç‚¹å‡»æŒ‰é’®æ—¶çš„æ°´æ³¢çº¹é¢œè‰²</td></tr><tr><td>highlightColor</td><td>Color</td><td>é•¿æŒ‰æŒ‰é’®åæŒ‰é’®çš„èƒŒæ™¯é¢œè‰²</td></tr><tr><td>elevation</td><td>double</td><td>æŒ‰é’®é˜´å½±çš„èŒƒå›´ï¼Œå€¼è¶Šå¤§é˜´å½±èŒƒå›´è¶Šå¤§</td></tr><tr><td>padding</td><td>EdgeInsetsGeometry</td><td>å…§è¾¹è·</td></tr><tr><td>shape</td><td>ShapeBorder</td><td>è®¾ç½®æŒ‰é’®çš„å½¢çŠ¶ï¼ŒShapeBorder å®ç°ç±»æœ‰ï¼š<br>RoundedRectangleBorderï¼šåœ†è§’å½¢çŠ¶<br>CircleBorderï¼šåœ†å½¢å½¢çŠ¶</td></tr></tbody></table><p>ä»‹ç»å®Œäº†æŒ‰é’® Widget çš„é€šç”¨å±æ€§ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹æ¯ä¸ªæŒ‰é’®åˆå§‹å½¢æ€çš„ä¸€ä¸ªæ•ˆæœï¼Œåœ¨ç»“åˆè¿™äº›æŒ‰é’®åšä¸€ä¸ªç»¼åˆæ¡ˆä¾‹</p><h3 id="1-2ã€RaisedButton"><a href="#1-2ã€RaisedButton" class="headerlink" title="1.2ã€RaisedButton"></a>1.2ã€RaisedButton</h3><p>RaisedButton è§åçŸ¥æ„ï¼šå‡¸èµ·çš„æŒ‰é’®ï¼Œå…¶å®å°±æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„ Material Design é£æ ¼çš„æŒ‰é’®ï¼š</p><p>è¿è¡Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Button Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ ListView è®©æŒ‰é’®è‡ªé€‚åº”å±å¹•å®½åº¦</span><br>    <span class="hljs-keyword">return</span> ListView(<br>      <span class="hljs-comment">//å†…é—´è· 20</span><br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      children: [<br>        <span class="hljs-comment">//RaisedButton å‡¸èµ·æŒ‰é’®</span><br>        RaisedButton(<br>          onPressed:()&#123;&#125;,<br>          child: Text(<span class="hljs-string">&quot;RaisedButton&quot;</span>),<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/426f79d2652f4d379394b8cc28902bd9~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828103722122" width="50%" /><p>é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªç°è‰²èƒŒæ™¯çš„å‡¸èµ·æŒ‰é’®</p><h3 id="1-3ã€FlatButton"><a href="#1-3ã€FlatButton" class="headerlink" title="1.3ã€FlatButton"></a>1.3ã€FlatButton</h3><p>FlatButton è§åçŸ¥æ„ï¼šæ‰å¹³çš„æŒ‰é’®ï¼Œå’Œ RaiseButton åˆšå¥½ç›¸åï¼Œæ²¡æœ‰å‡¸èµ·çš„æ•ˆæœã€‚å°†ä¸Šè¿° RaiseButton æ¢æˆ FlatButton æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/326cfc9abf8c421e842ba8c5cfc7131d~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828110640212" width="50%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ²¡æœ‰èƒŒæ™¯ï¼Œå°±åƒä¸€ä¸ªæ–‡æœ¬ Widget ä¸€æ ·</p><h3 id="1-4ã€OutlineButton"><a href="#1-4ã€OutlineButton" class="headerlink" title="1.4ã€OutlineButton"></a>1.4ã€OutlineButton</h3><p>OutlineButton è§åçŸ¥æ„ï¼šå¸¦çº¿æ¡†çš„æŒ‰é’®ï¼Œå®ƒå°±åƒæ˜¯ FlatButton åŠ äº†ä¸€ä¸ªè¾¹æ¡†ã€‚å°†ä¸Šè¿° RaiseButton æ¢æˆ OutlineButton æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dee2a6a1417a4396b12500861737a30e~tplv-k3u1fbpfcp-watermark.image?" alt="outlinebutton.png" width="50%" /><h3 id="1-5ã€IconButton"><a href="#1-5ã€IconButton" class="headerlink" title="1.5ã€IconButton"></a>1.5ã€IconButton</h3><p>IconButton è§åçŸ¥æ„ï¼šå¸¦ Icon çš„æŒ‰é’®ã€‚å°†ä¸Šè¿° RaiseButton æ¢æˆ IconButton å¹¶åšå±æ€§çš„è°ƒæ•´ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dart">IconButton(<br>   icon: Icon(Icons.home),<br>   onPressed:()&#123;&#125;,<br>)<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fcf789f83b5248c3910ed88306c43099~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828111723913" width="50%" /><h3 id="1-6ã€ButtonBar"><a href="#1-6ã€ButtonBar" class="headerlink" title="1.6ã€ButtonBar"></a>1.6ã€ButtonBar</h3><p>ButtonBar æ˜¯ä¸€ä¸ªæŒ‰é’®ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒçš„ children å±æ€§ä¸­æ”¾å…¥å¤šä¸ªæŒ‰é’®ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Button Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ButtonBar(<br>      <span class="hljs-comment">//æŒ‰é’®ç»„</span><br>      children: [<br>        RaisedButton( <span class="hljs-comment">//RaisedButton</span><br>          onPressed: () &#123;&#125;,<br>          child: Text(<span class="hljs-string">&quot;RaisedButton&quot;</span>),<br>        ),<br>        FlatButton( <span class="hljs-comment">//FlatButton</span><br>          onPressed: () &#123;&#125;,<br>          child: Text(<span class="hljs-string">&quot;FlatButton&quot;</span>),<br>        ),<br>        OutlineButton( <span class="hljs-comment">//OutlineButton</span><br>          onPressed: () &#123;&#125;,<br>          child: Text(<span class="hljs-string">&quot;OutlineButton&quot;</span>),<br>        ),<br>        IconButton( <span class="hljs-comment">//IconButton</span><br>          icon: Icon(Icons.home),<br>          onPressed: () &#123;&#125;,<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c49b50b9684249e18c84c942c80e6af5~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828112553805" width="50%" /><h3 id="1-7ã€FloatingActionButton"><a href="#1-7ã€FloatingActionButton" class="headerlink" title="1.7ã€FloatingActionButton"></a>1.7ã€FloatingActionButton</h3><p>FloatingActionButton ç®€ç§° FABï¼Œå¯ä»¥å®ç°æµ®åŠ¨æŒ‰é’®ã€‚å®ƒå¸¸ç”¨çš„ä¸€äº›å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>onPressed</td><td>VoidCallback</td><td>æ­¤é¡¹ä¸ºå¿…å¡«å‚æ•°ï¼ŒæŒ‰ä¸‹æŒ‰é’®æ—¶è§¦å‘çš„å›è°ƒï¼Œæ¥æ”¶ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå‚æ•°ï¼Œä¼  null è¡¨ç¤ºæŒ‰é’®ç¦ç”¨ï¼Œä¼šæ˜¾ç¤ºç¦ç”¨ç›¸å…³æ ·å¼</td></tr><tr><td>child</td><td>Widget</td><td>å­æ§ä»¶ï¼Œä¸€èˆ¬ä¸º Iconï¼Œä¸æ¨èä½¿ç”¨æ–‡å­—</td></tr><tr><td>backgroundColor</td><td>Color</td><td>èƒŒæ™¯é¢œè‰²</td></tr><tr><td>elevation</td><td>double</td><td>æœªç‚¹å‡»æ—¶å€™çš„é˜´å½±</td></tr><tr><td>highlightElevation</td><td>double</td><td>ç‚¹å‡»æ—¶çš„é˜´å½±å€¼ï¼Œé»˜è®¤ä¸ºï¼š12.0</td></tr><tr><td>shape</td><td>ShapeBorder</td><td>å®šä¹‰ FAB çš„å½¢çŠ¶</td></tr><tr><td>mini</td><td>bool</td><td>æ˜¯å¦æ˜¯ mini ç±»å‹ï¼Œé»˜è®¤ä¸ºï¼šfalse</td></tr></tbody></table><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Button Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ListView(<br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      children: [<br>        FloatingActionButton( <span class="hljs-comment">//FloatingActionButton æŒ‰é’®</span><br>          onPressed: ()&#123;&#125;,<br>          child: Icon(Icons.search),<br>          backgroundColor: Colors.lightGreen,<br>          elevation: <span class="hljs-number">20</span>,<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac14d2bb83594441b8d07bf8e131beb7~tplv-k3u1fbpfcp-watermark.image?" alt="floatingactionbutton.png" width="50%" /><h2 id="äºŒã€Flutter-2-x-æŒ‰é’®-Widget-çš„å˜åŒ–"><a href="#äºŒã€Flutter-2-x-æŒ‰é’®-Widget-çš„å˜åŒ–" class="headerlink" title="äºŒã€Flutter 2.x æŒ‰é’® Widget çš„å˜åŒ–"></a>äºŒã€Flutter 2.x æŒ‰é’® Widget çš„å˜åŒ–</h2><p>å¦‚æœä½ æ˜¯ Flutter 2.x çš„ç‰ˆæœ¬ï¼Œä½ ä¼šå‘ç°ä¹‹å‰çš„ä¸€äº›æŒ‰é’® Widget è¢«åºŸå¼ƒäº†ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e65c7518c914c4d82361cd1228732d4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828114616994" style="zoom:70%;" width="50%"/><p>ä¸»è¦æ˜¯ä¸Šé¢è¿™ä¸‰ä¸ªæŒ‰é’®çš„å˜åŒ–ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ï¼š</p><table><thead><tr><th>Flutter 1.x ä¸­çš„æŒ‰é’® Widget</th><th>Flutter 2.x ä¸­çš„æŒ‰é’® Widget</th></tr></thead><tbody><tr><td>RaisedButton å‡¸èµ·æŒ‰é’®</td><td>ElevatedButton å‡¸èµ·æŒ‰é’®</td></tr><tr><td>FlatButton æ‰å¹³æŒ‰é’®</td><td>TextButton æ‰å¹³æŒ‰é’®</td></tr><tr><td>OutlinedButton çº¿æ¡†æŒ‰é’®</td><td>OutlinedButton çº¿æ¡†æŒ‰é’®</td></tr></tbody></table><p>å¦å¤–åœ¨ 1.x ä¸­è®¾ç½®çš„ä¸€ç³»åˆ—å±æ€§ï¼Œå¦‚ï¼šcolorï¼ŒtextColorï¼Œelevationï¼Œshapeç­‰åœ¨ 2.x ä¸­éƒ½è¢«å°è£…åˆ°äº† style å±æ€§ä¸­ï¼Œstyle å±æ€§æ¥æ”¶ä¸€ä¸ª ButtonStyle ç±»å‹çš„å¯¹è±¡ï¼Œä»‹ç»ä¸€ä¸‹ ButtonStyle ä¸­çš„å¸¸ç”¨å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>textStyle</td><td>MaterialStateProperty<TextStyle></td><td>æ–‡æœ¬çš„æ ·å¼ ä½†æ˜¯å¯¹äºé¢œè‰²æ˜¯ä¸èµ·ä½œç”¨çš„</td></tr><tr><td>backgroundColor</td><td>MaterialStateProperty<Color></td><td>æŒ‰é’®èƒŒæ™¯è‰²</td></tr><tr><td>foregroundColor</td><td>MaterialStateProperty<Color></td><td>æ–‡æœ¬åŠå›¾æ ‡é¢œè‰²</td></tr><tr><td>overlayColor</td><td>MaterialStateProperty<Color></td><td>é«˜äº®è‰²ï¼ŒæŒ‰é’®å¤„äº focusedï¼Œhovered or pressed æ—¶çš„é¢œè‰²</td></tr><tr><td>shadowColor</td><td>MaterialStateProperty<Color></td><td>é˜´å½±é¢œè‰²</td></tr><tr><td>elevation</td><td>MaterialStateProperty<double></td><td>æŒ‰é’®é˜´å½±çš„èŒƒå›´ï¼Œå€¼è¶Šå¤§é˜´å½±èŒƒå›´è¶Šå¤§</td></tr><tr><td>padding</td><td>MaterialStateProperty<EdgeInsetsGeometry></td><td>æŒ‰é’®å†…è¾¹è·</td></tr><tr><td>minimumSize</td><td>MaterialStateProperty<Size></td><td>æŒ‰é’®æœ€å°å€¼</td></tr><tr><td>fixedSize</td><td>MaterialStateProperty<Size></td><td>æŒ‰é’®å¤§å°</td></tr><tr><td>maximumSize</td><td>MaterialStateProperty<Size></td><td>æŒ‰é’®æœ€å¤§å€¼</td></tr><tr><td>side</td><td>MaterialStateProperty<BorderSide></td><td>è¾¹æ¡†</td></tr><tr><td>shape</td><td>MaterialStateProperty<OutlinedBorder></td><td>è®¾ç½®æŒ‰é’®çš„å½¢çŠ¶</td></tr><tr><td>alignment</td><td>AlignmentGeometry</td><td>æŒ‰é’®å­ Widget å¯¹é½æ–¹å¼</td></tr></tbody></table><p>å®è·µå¯¹æ¯”ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Button Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ListView(<br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      children: [<br>        RaisedButton( <span class="hljs-comment">//RaisedButton</span><br>          onPressed: ()&#123;&#125;,<br>          child: Text(<span class="hljs-string">&quot;RaisedButton&quot;</span>),<br>          textColor: Colors.white, <span class="hljs-comment">//æ–‡æœ¬é¢œè‰²</span><br>          color: Colors.green, <span class="hljs-comment">//æŒ‰é’®èƒŒæ™¯é¢œè‰²</span><br>          splashColor: Colors.red, <span class="hljs-comment">//æ°´æ³¢çº¹é¢œè‰²</span><br>          elevation: <span class="hljs-number">20</span>, <span class="hljs-comment">//é˜´å½±çš„èŒƒå›´</span><br>          shape: RoundedRectangleBorder( <span class="hljs-comment">//è®¾ç½® 20 çš„åœ†è§’</span><br>            borderRadius: BorderRadius.circular(<span class="hljs-number">20</span>)<br>          )<br>        ),<br>        SizedBox(height: <span class="hljs-number">40</span>),<br>        ElevatedButton( <span class="hljs-comment">//ElevatedButton</span><br>            onPressed: ()&#123;&#125;,<br>            child: Text(<span class="hljs-string">&quot;ElevatedButton&quot;</span>),<br>            style: ButtonStyle(<br>              foregroundColor: MaterialStateProperty.all(Colors.white), <span class="hljs-comment">//æ–‡æœ¬é¢œè‰²</span><br>              backgroundColor: MaterialStateProperty.all(Colors.green), <span class="hljs-comment">//æŒ‰é’®èƒŒæ™¯é¢œè‰²</span><br>              overlayColor: MaterialStateProperty.all(Colors.red), <span class="hljs-comment">//æ°´æ³¢çº¹é¢œè‰²</span><br>              elevation: MaterialStateProperty.all(<span class="hljs-number">20</span>), <span class="hljs-comment">//é˜´å½±çš„èŒƒå›´</span><br>              shape: MaterialStateProperty.all(<span class="hljs-comment">//è®¾ç½® 20 çš„åœ†è§’</span><br>                  RoundedRectangleBorder(<br>                      borderRadius: BorderRadius.circular(<span class="hljs-number">20</span>)<br>                  )<br>              )<br>            ),<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f82277a9e354bf18e7249a66b799c94~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220828134202212" width="50%" /><h2 id="ä¸‰ã€æŒ‰é’®-Widget-ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹"><a href="#ä¸‰ã€æŒ‰é’®-Widget-ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="ä¸‰ã€æŒ‰é’® Widget ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹"></a>ä¸‰ã€æŒ‰é’® Widget ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹</h2><p>åœ¨è®²ç»¼åˆæ¡ˆä¾‹ä¹‹å‰æˆ‘ä»¬å…ˆå­¦ä¹ ä¸‹ BottomNavigationBar ï¼Œä¸€ä¼šä¼šç”¨åˆ°</p><h3 id="3-1ã€BottomNavigationBar-ä»‹ç»"><a href="#3-1ã€BottomNavigationBar-ä»‹ç»" class="headerlink" title="3.1ã€BottomNavigationBar ä»‹ç»"></a>3.1ã€BottomNavigationBar ä»‹ç»</h3><p>BottomNavigationBar æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„åº•éƒ¨å¯¼èˆªæ  Widgetï¼Œä¸€èˆ¬ç”¨åœ¨ Scaffold çš„ bottomNavigationBar å±æ€§ä¸­</p><p>BottomNavigationBar å¸¸ç”¨å±æ€§ä»‹ç»ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>å±æ€§ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>items</td><td>List<BottomNavigationBarItem></td><td>å¿…é¡»å±æ€§ï¼Œæœ€å°‘è¦æœ‰ä¸¤ä¸ªå­ Widget</td></tr><tr><td>onTap</td><td>ValueChanged</td><td>Widget ç‚¹å‡»äº‹ä»¶</td></tr><tr><td>currentIndex</td><td>int</td><td>å½“å‰æ˜¾ç¤ºçš„æ˜¯å“ªä¸ª Widget</td></tr><tr><td>elevation</td><td>double</td><td>é˜´å½±èŒƒå›´</td></tr><tr><td>type</td><td>BottomNavigationBarType</td><td>BottomNavigationBarType.fixedï¼šå›ºå®š<br>BottomNavigationBarType.shiftingï¼šå¯æ»‘åŠ¨</td></tr><tr><td>fixedColor</td><td>Color</td><td>ç›¸å½“äº selectedItemColorï¼Œä½†æ˜¯ä¸èƒ½è·Ÿ selectedItemColor åŒæ—¶å­˜åœ¨</td></tr><tr><td>backgroundColor</td><td>Color</td><td>èƒŒæ™¯é¢œè‰²</td></tr><tr><td>iconSize</td><td>double</td><td>è®¾ç½®å›¾æ ‡å¤§å°</td></tr><tr><td>selectedItemColor</td><td>Color</td><td>è®¾ç½® Widget é€‰ä¸­çš„é¢œè‰²</td></tr><tr><td>unselectedItemColor</td><td>Color</td><td>è®¾ç½® Widget æœªé€‰ä¸­çš„é¢œè‰²</td></tr><tr><td>selectedFontSize</td><td>double</td><td>è®¾ç½® Widget é€‰ä¸­æ—¶æ–‡å­—çš„å¤§å°</td></tr><tr><td>unselectedFontSize</td><td>double</td><td>è®¾ç½® Widget æœªé€‰ä¸­æ—¶æ–‡å­—çš„å¤§å°</td></tr></tbody></table><p>è¿è¡Œä¸‹é¢ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Button Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        ),<br>        bottomNavigationBar: MyBottomNavigationBar(),<br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBottomNavigationBar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> BottomNavigationBar(<br>        iconSize: <span class="hljs-number">35</span>, <span class="hljs-comment">//å›¾æ ‡å¤§å° 35</span><br>        fixedColor: Colors.green, <span class="hljs-comment">//å›¾ç‰‡é¢œè‰²ç»¿è‰²</span><br>        type: BottomNavigationBarType.fixed, <span class="hljs-comment">//item å›ºå®šæ˜¾ç¤º</span><br>        items: [ <span class="hljs-comment">//è®¾ç½®äº† 3 ä¸ª å­ item</span><br>          BottomNavigationBarItem(icon: Icon(Icons.home), label: <span class="hljs-string">&quot;é¦–é¡µ&quot;</span>),<br>          BottomNavigationBarItem(icon: Icon(Icons.category), label: <span class="hljs-string">&quot;åˆ†ç±»&quot;</span>),<br>          BottomNavigationBarItem(icon: Icon(Icons.settings), label: <span class="hljs-string">&quot;è®¾ç½®&quot;</span>)<br>        ]);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/492432dd8d8e497a838565e7b619a70b~tplv-k3u1fbpfcp-zoom-1.image" width="30%"/><h3 id="3-2ã€ç»¼åˆæ¡ˆä¾‹"><a href="#3-2ã€ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="3.2ã€ç»¼åˆæ¡ˆä¾‹"></a>3.2ã€ç»¼åˆæ¡ˆä¾‹</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä½¿ç”¨æŒ‰é’® Widget ç»„åˆæ¥å®ç°å¦‚ä¸‹æ•ˆæœï¼š</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf7e80059f054488a3cf02691ed3521f~tplv-k3u1fbpfcp-watermark.image?" alt="button_together.png" width="30%" /><p>ç®€å•çš„åˆ†æä¸‹è¿™ä¸ªé¡µé¢ï¼šæœ€å¤–å±‚æœ‰ä¸ªå†…é—´è·ï¼ˆPaddingï¼‰ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªä»ä¸Šå¾€ä¸‹æ’åˆ—çš„å‚ç›´å¸ƒå±€ï¼ˆColumnï¼‰ï¼Œå‚ç›´å¸ƒå±€é‡Œé¢æœ‰ä¸€ç³»åˆ—ä½¿ç”¨ button å®ç°çš„æŒ‰é’®ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ Flutter 1.x ç³»åˆ—çš„ Button å»å®ç°ï¼Œæœ€ååº•éƒ¨æœ‰ä¸€ä¸ª BottomNavigationBarï¼ŒBottomNavigationBar ä¸­é—´æœ‰ä¸€ä¸ªå‡¸èµ·çš„ FloatingActionButtonï¼Œç±»ä¼¼å’¸é±¼ä¸­é—´å‘å¸ƒæŒ‰é’®çš„æ•ˆæœã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ç”¨ä»£ç å®ç°ä¸€ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Button Practice&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>      ),<br>      body: MyBodyPage(), <span class="hljs-comment">//è‡ªå®šä¹‰ body Wdiget</span><br>      bottomNavigationBar: MyBottomNavigationBar(), <span class="hljs-comment">//è‡ªå®šä¹‰ bottomNavigationBar Widget</span><br>      floatingActionButton: MyFloatingActionButton(), <span class="hljs-comment">//è‡ªå®šä¹‰ floatingActionButton Widget</span><br>      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked, <span class="hljs-comment">//floatingActionButton åœ¨åº•éƒ¨ä¸­å¿ƒåœé </span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰ BottomNavigationBar</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBottomNavigationBar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> BottomNavigationBar(<br>        iconSize: <span class="hljs-number">35</span>, <span class="hljs-comment">//å›¾æ ‡å¤§å° 35</span><br>        fixedColor: Colors.green, <span class="hljs-comment">//é€‰ä¸­é¢œè‰²ä¸ºç»¿è‰²</span><br>        type: BottomNavigationBarType.fixed, <span class="hljs-comment">//item å›ºå®šæ˜¾ç¤º</span><br>        items: [ <span class="hljs-comment">//è®¾ç½®äº† 3 ä¸ª å­ item</span><br>          BottomNavigationBarItem(icon: Icon(Icons.home), label: <span class="hljs-string">&quot;é¦–é¡µ&quot;</span>),<br>          BottomNavigationBarItem(icon: Icon(Icons.category), label: <span class="hljs-string">&quot;åˆ†ç±»&quot;</span>),<br>          BottomNavigationBarItem(icon: Icon(Icons.settings), label: <span class="hljs-string">&quot;è®¾ç½®&quot;</span>)<br>        ]);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰ FloatingActionButton</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyFloatingActionButton</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-comment">//ä½¿ç”¨ Container åŒ…è£¹ FloatingActionButton åœ¨å¤–å±‚åŠ ä¸€ä¸ªç™½è‰²çš„è¾¹æ¡†</span><br>    <span class="hljs-keyword">return</span>  Container(<br>      width: <span class="hljs-number">80</span>,<br>      height: <span class="hljs-number">80</span>,<br>      padding: EdgeInsets.all(<span class="hljs-number">8</span>),<br>      decoration: BoxDecoration(<br>          color: Colors.white,<br>          borderRadius: BorderRadius.circular(<span class="hljs-number">40</span>)<br>      ),<br>      child: FloatingActionButton(<br>        backgroundColor: Colors.yellow,<br>        onPressed: ()&#123;&#125;,<br>        child: Icon(Icons.add),<br>      ),<br>    );<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Padding(<span class="hljs-comment">//Padding å®ç°å†…é—´è· 20</span><br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>      child: Column(<br>        children: [<br>          Row( <span class="hljs-comment">//ç¬¬ä¸€æ’ï¼šæ™®é€šæŒ‰é’® + çº¢è‰²æŒ‰é’® + å¸¦é˜´å½±çš„æŒ‰é’®</span><br>            children: [<br>              RaisedButton(<br>                onPressed: ()&#123;&#125;,<br>                child: Text(<span class="hljs-string">&quot;æ™®é€šæŒ‰é’®&quot;</span>),<br>              ),<br>              SizedBox(width: <span class="hljs-number">20</span>),<br>              RaisedButton(<br>                onPressed: ()&#123;&#125;,<br>                child: Text(<span class="hljs-string">&quot;çº¢è‰²æŒ‰é’®&quot;</span>),<br>                color: Colors.red,<br>                textColor: Colors.white,<br>              ),<br>              SizedBox(width: <span class="hljs-number">20</span>),<br>              RaisedButton(<br>                onPressed: ()&#123;&#125;,<br>                child: Text(<span class="hljs-string">&quot;å¸¦é˜´å½±çš„æŒ‰é’®&quot;</span>),<br>                color: Colors.blue,<br>                textColor: Colors.white,<br>                elevation: <span class="hljs-number">20</span>,<br>              )<br>            ],<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Container( <span class="hljs-comment">//ç¬¬äºŒæ’ï¼šè‡ªé€‚åº”æŒ‰é’®</span><br>            height: <span class="hljs-number">60</span>,<br>            width: <span class="hljs-built_in">double</span>.infinity,<br>            child: RaisedButton(<br>              onPressed: () &#123;&#125;,<br>              child: Text(<span class="hljs-string">&quot;è‡ªé€‚åº”æŒ‰é’®&quot;</span>),<br>              textColor: Colors.white,<br>              color: Colors.blue,<br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Row(children: [ <span class="hljs-comment">//ç¬¬ä¸‰æ’ï¼šicon æŒ‰é’® + æœ‰å®½é«˜çš„æŒ‰é’®</span><br>            RaisedButton.icon(<br>              onPressed: ()&#123;&#125;,<br>              icon: Icon(Icons.home),<br>              label: Text(<span class="hljs-string">&quot; Icon æŒ‰é’®&quot;</span>),<br>              color: Colors.yellow,<br>              textColor: Colors.green,<br>            ),<br>            SizedBox(width: <span class="hljs-number">20</span>),<br>            Container(<br>              height: <span class="hljs-number">60</span>,<br>              width: <span class="hljs-number">200</span>,<br>              child: RaisedButton(<br>                onPressed: () &#123;&#125;,<br>                child: Text(<span class="hljs-string">&quot;æœ‰å®½é«˜çš„æŒ‰é’®&quot;</span>),<br>                textColor: Colors.white,<br>                color: Colors.orange,<br>              ),<br>            )<br>          ]),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Container( <span class="hljs-comment">//ç¬¬å››æ’ï¼šè‡ªé€‚åº”å¸¦åœ†è§’çš„æŒ‰é’®</span><br>            height: <span class="hljs-number">60</span>,<br>            width: <span class="hljs-built_in">double</span>.infinity,<br>            child: RaisedButton(<br>              onPressed: () &#123;&#125;,<br>              child: Text(<span class="hljs-string">&quot;è‡ªé€‚åº”å¸¦åœ†è§’çš„æŒ‰é’®&quot;</span>),<br>              textColor: Colors.white,<br>              color: Colors.blue,<br>              shape: RoundedRectangleBorder(<br>                  borderRadius: BorderRadius.circular(<span class="hljs-number">100</span>)<br>              ),<br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Container( <span class="hljs-comment">//ç¬¬äº”æ’ï¼šåœ†å½¢æŒ‰é’®</span><br>            height: <span class="hljs-number">100</span>,<br>            width: <span class="hljs-number">150</span>,<br>            child: RaisedButton(<br>              onPressed: () &#123;&#125;,<br>              child: Text(<span class="hljs-string">&#x27;åœ†å½¢æŒ‰é’®&#x27;</span>),<br>              textColor: Colors.white,<br>              color: Colors.lightGreen,<br>              elevation: <span class="hljs-number">20</span>,<br>              splashColor: Colors.green,<br>              shape: CircleBorder(side: BorderSide(color: Colors.white)),<br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Container( <span class="hljs-comment">//ç¬¬å…­æ’ï¼šæ³¨å†ŒæŒ‰é’®</span><br>            width: <span class="hljs-built_in">double</span>.infinity,<br>            height: <span class="hljs-number">50</span>,<br>            margin: EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">0</span>),<br>            child:  OutlineButton(<br>              child: Text(<span class="hljs-string">&quot;æ³¨å†Œ&quot;</span>),<br>              onPressed: ()&#123;&#125;,<br>              borderSide: BorderSide(<br>                  width: <span class="hljs-number">1</span>,<br>                  color: Colors.red<br>              ),<br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">20</span>),<br>          Container( <span class="hljs-comment">//ç¬¬ä¸ƒæ’ï¼šç™»é™†æŒ‰é’®</span><br>            width: <span class="hljs-built_in">double</span>.infinity,<br>            height: <span class="hljs-number">50</span>,<br>            margin: EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">0</span>),<br>            child:  RaisedButton(<br>              child: Text(<span class="hljs-string">&quot;ç™»é™†&quot;</span>),<br>              onPressed: ()&#123;&#125;,<br>              color: Colors.blue,<br>              textColor: Colors.white,<br>            ),<br>          )<br>        ],<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æˆ‘ä»¬è®²äº†ï¼š</p><p>1ã€Flutter ä¸­å¸¸ç”¨çš„æŒ‰é’® Widget ï¼šRaisedButtonï¼ŒFlatButtonï¼ŒIconButtonï¼ŒOutlineButtonï¼ŒButtonBarï¼ŒFloatingActionButton</p><p>2ã€ä»‹ç»äº† Flutter 1.x å’Œ Flutter 2.x æŒ‰é’®ç›¸å…³çš„å˜åŒ–åŠä½¿ç”¨</p><blockquote><p>Flutter 2.x ä¸­å¸¸ç”¨çš„å±æ€§éƒ½è¢«å°è£…åˆ°äº† style å±æ€§ä¸­</p></blockquote><p>3ã€ä»‹ç»äº† BottomNavigationBarï¼Œå¹¶é€šè¿‡ Flutter 1.x ç›¸å…³ Button + BottomNavigationBar + FloatingActionButton å®ç°äº†ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šä»‹ç» Flutter è¡¨å•ç›¸å…³ Widget ï¼Œå°½è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV1S4411E7LY?p=19&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">Flutter æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚çš„ Flutter å…¥é—¨æ•™ç¨‹</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆå››ï¼‰ï¼šFlutter å¸¸ç”¨ Widget äºŒ</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%20Widget%20%E4%BA%8C/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9AFlutter%20%E5%B8%B8%E7%94%A8%20Widget%20%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a6163b15995449799850cef6fd5508c~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Flutter ç‰¹ç‚¹ä»¥åŠä¸€äº›å¸¸ç”¨çš„ Widgetï¼šMaterialAppï¼ŒScaffoldï¼ŒAppBarï¼ŒCenterï¼ŒContainerï¼ŒTextã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7134343543975313445">Flutter ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šFlutter ç‰¹ç‚¹åŠå¸¸ç”¨ Widget ä»‹ç»</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å¯¹ Flutter Widget è¿›è¡Œå­¦ä¹ </p><p>ä¸‹é¢æˆ‘ä¼šé€šè¿‡ï¼šæ•ˆæœå±•ç¤º -&gt; Widget è®²è§£ -&gt; ä»£ç å®ç°çš„æ–¹å¼å¯¹ Widget è¿›è¡Œä»‹ç»ï¼Œæœ€ååœ¨é€šè¿‡ Widget ç»„åˆç¼–å†™ä¸€ä¸ªç»¼åˆçš„æ¡ˆä¾‹</p><h2 id="ä¸€ã€Flutter-Widget-ä¹‹-Image"><a href="#ä¸€ã€Flutter-Widget-ä¹‹-Image" class="headerlink" title="ä¸€ã€Flutter Widget ä¹‹ Image"></a>ä¸€ã€Flutter Widget ä¹‹ Image</h2><p>Image æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›æ˜¾ç¤ºå›¾ç‰‡çš„ Widget</p><p>å…ˆçœ‹ä¸€çœ¼ä½¿ç”¨ Image å®ç°çš„æ•ˆæœ</p><h3 id="1-1ã€Image-æ•ˆæœå±•ç¤º"><a href="#1-1ã€Image-æ•ˆæœå±•ç¤º" class="headerlink" title="1.1ã€Image æ•ˆæœå±•ç¤º"></a>1.1ã€Image æ•ˆæœå±•ç¤º</h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9c9d4e9e7b94ef0bb5299fd62faa8ae~tplv-k3u1fbpfcp-watermark.image" alt="flutter_01 (2).png"></p><p>åˆ˜äº¦è²çš„åœ†å½¢å›¾ç‰‡ğŸ˜„ï¼Œç¾çˆ†äº†ã€‚è¨€å½’æ­£ä¼ ï¼Œå¤§å®¶å¯ä»¥å…ˆæƒ³ä¸€ä¸‹æ€ä¹ˆå»å®ç°ï¼Ÿ</p><h3 id="1-2ã€Image-ä»‹ç»"><a href="#1-2ã€Image-ä»‹ç»" class="headerlink" title="1.2ã€Image ä»‹ç»"></a>1.2ã€Image ä»‹ç»</h3><p>Image ç»„ä»¶æœ‰å¾ˆå¤šæ„é€ æ–¹æ³•ï¼Œè¿™é‡Œç»™å¤§å®¶è®²ä¸¤ä¸ªå¸¸ç”¨çš„ï¼š</p><p>1ã€Image.network ï¼šåŠ è½½è¿œç¨‹å›¾ç‰‡</p><p>2ã€Image.asset ï¼šåŠ è½½æœ¬åœ°å›¾ç‰‡</p><p>ä¸Šé¢è¿™ä¸¤ä¸ªå±äº Image çš„å‘½åæ„é€ æ–¹æ³•ï¼Œå¯¹å‘½åæ„é€ æ–¹æ³•è¿˜ä¸ç†Ÿæ‚‰çš„èµ¶ç´§å…ˆå»çœ‹ä¸€ä¸‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7130647339294785549#heading-0">ä¼ é€é—¨</a></p><h4 id="1-2-1ã€Image-network-åŠ è½½è¿œç¨‹å›¾ç‰‡"><a href="#1-2-1ã€Image-network-åŠ è½½è¿œç¨‹å›¾ç‰‡" class="headerlink" title="1.2.1ã€Image.network åŠ è½½è¿œç¨‹å›¾ç‰‡"></a>1.2.1ã€Image.network åŠ è½½è¿œç¨‹å›¾ç‰‡</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Image Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Image.network(<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯ä½¿ç”¨ Image.network ä¼ å…¥ä¸€å¼ å›¾ç‰‡ url ï¼Œè¿™æ ·å°±å¯ä»¥å°†è¿™å¼ ç½‘ç»œå›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥äº†ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4f8ebf9c4034f23b4a52a59984b046d~tplv-k3u1fbpfcp-watermark.image" alt="flutter_02.png"></p><h4 id="1-2-2ã€Image-asset-åŠ è½½æœ¬åœ°å›¾ç‰‡"><a href="#1-2-2ã€Image-asset-åŠ è½½æœ¬åœ°å›¾ç‰‡" class="headerlink" title="1.2.2ã€Image.asset åŠ è½½æœ¬åœ°å›¾ç‰‡"></a>1.2.2ã€Image.asset åŠ è½½æœ¬åœ°å›¾ç‰‡</h4><p>åŠ è½½æœ¬åœ°å›¾ç‰‡ç¨å¾®å¤æ‚ä¸€äº›</p><p>1ã€æ–°å»ºå›¾ç‰‡ç›®å½•ï¼Œå¼•å…¥å›¾ç‰‡èµ„æº</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3315fbd5066448f7b8c87109f2e3db22~tplv-k3u1fbpfcp-watermark.image" alt="flutter_03 (2).png"></p><p>æˆ‘ä»¬æ–°å»ºäº† images æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ images ä¸‹æ”¾å…¥äº†å›¾ç‰‡èµ„æºï¼Œåˆæ–°å»ºäº† 2.0x å’Œ 3.0x æ–‡ä»¶å¤¹åˆ†åˆ«å¯¹åº” 2 å€å›¾å’Œ 3 å€å›¾ï¼Œè¿™æ ·å°±èƒ½ä¿è¯ä¸åŒæ‰‹æœºåˆ†è¾¨ç‡çš„æ‰‹æœºåŠ è½½å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„å›¾ç‰‡èµ„æº</p><p>2ã€æ‰“å¼€ pubspec.yaml é…ç½®æ–‡ä»¶å£°æ˜ä¸€ä¸‹æˆ‘ä»¬æ·»åŠ çš„å›¾ç‰‡</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2466b29935204ef0960cb4fa29be8cb2~tplv-k3u1fbpfcp-watermark.image" alt="flutter_04 (1).png"></p><p>3ã€æœ€ååœ¨ä»£ç ä¸­ä½¿ç”¨å°±å¯ä»¥äº†</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Image Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Image.asset(<span class="hljs-string">&quot;images/ic_launcher_round.png&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2105bb0b41846a88d69143a14eb4cda~tplv-k3u1fbpfcp-watermark.image" alt="flutter_05.png"></p><h4 id="1-2-3ã€Image-å¸¸ç”¨å±æ€§"><a href="#1-2-3ã€Image-å¸¸ç”¨å±æ€§" class="headerlink" title="1.2.3ã€Image å¸¸ç”¨å±æ€§"></a>1.2.3ã€Image å¸¸ç”¨å±æ€§</h4><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>alignment</td><td>Alignment</td><td>å›¾ç‰‡çš„å¯¹é½æ–¹å¼</td></tr><tr><td>color å’Œ colorBlendMode</td><td></td><td>è®¾ç½®å›¾ç‰‡çš„èƒŒæ™¯é¢œè‰²ï¼Œé€šå¸¸å’Œ colorBlendMode é…åˆä¸€èµ·ä½¿ç”¨ï¼Œè¿™æ ·å¯ä»¥ä½¿å›¾ç‰‡é¢œè‰²å’ŒèƒŒæ™¯è‰²æ··åˆ</td></tr><tr><td>fit</td><td>BoxFit</td><td>fit å±æ€§ç”¨æ¥æ§åˆ¶å›¾ç‰‡çš„æ‹‰ä¼¸å’ŒæŒ¤å‹ï¼Œè¿™éƒ½æ˜¯æ ¹æ®çˆ¶å®¹å™¨æ¥çš„ï¼š<br/>BoxFit.fillï¼šå…¨å›¾æ˜¾ç¤ºï¼Œå›¾ç‰‡ä¼šè¢«æ‹‰ä¼¸ï¼Œå¹¶å……æ»¡çˆ¶å®¹å™¨<br/>BoxFit.containï¼šå…¨å›¾æ˜¾ç¤ºï¼Œæ˜¾ç¤ºåŸæ¯”ä¾‹ï¼Œå¯èƒ½ä¼šæœ‰ç©ºéš™<br/>BoxFit.coverï¼šæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ï¼Œå……æ»¡ï¼ˆå›¾ç‰‡è¦å……æ»¡æ•´ä¸ªå®¹å™¨ï¼Œè¿˜ä¸å˜å½¢ï¼‰<br/>BoxFit.fitWidthï¼šå®½åº¦å……æ»¡(æ¨ªå‘å……æ»¡)ï¼Œæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œ å¯èƒ½è£åˆ‡<br/>BoxFit.fitHeightï¼šé«˜åº¦å……æ»¡(ç«–å‘å……æ»¡),æ˜¾ç¤ºå¯èƒ½æ‹‰ ä¼¸ï¼Œå¯èƒ½è£åˆ‡<br/>BoxFit.scaleDownï¼šæ•ˆæœå’Œ contain å·®ä¸å¤šï¼Œä½†æ˜¯æ­¤å±æ€§ä¸å…è®¸æ˜¾ç¤ºè¶…è¿‡åŸå›¾ç‰‡å¤§å°ï¼Œå¯å°ä¸å¯å¤§</td></tr><tr><td>width</td><td></td><td>å®½åº¦ï¼Œä¸€èˆ¬ç»“åˆ ClipOval Widget æ‰èƒ½çœ‹åˆ°æ•ˆæœ</td></tr><tr><td>height</td><td></td><td>é«˜åº¦ï¼Œä¸€èˆ¬ç»“åˆ ClipOval Widget æ‰èƒ½çœ‹åˆ°æ•ˆæœ</td></tr></tbody></table><p>æ›´å¤šå±æ€§å‚è€ƒï¼š<a href="https://api.flutter.dev/flutter/widgets/Image-class.html">https://api.flutter.dev/flutter/widgets/Image-class.html</a></p><p><strong>PS</strong>ï¼šClipOval æ˜¯ä¸€ä¸ªè£å‰ªå­ Widget ä¸ºæ¤­åœ†çš„ Widgetï¼Œå¸¸ç”¨äºåœ†å½¢ï¼Œåœ†è§’å›¾ç‰‡ç­‰</p><h3 id="1-3ã€æ•ˆæœå®ç°"><a href="#1-3ã€æ•ˆæœå®ç°" class="headerlink" title="1.3ã€æ•ˆæœå®ç°"></a>1.3ã€æ•ˆæœå®ç°</h3><p>å›é¡¾ 1.1 çš„æ•ˆæœï¼šå…¶å®å°±æ˜¯ä¸€ä¸ªå±…ä¸­å±•ç¤ºçš„åœ†å½¢å›¾ç‰‡</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Center è¿›è¡Œå±…ä¸­ï¼Œç„¶åä½¿ç”¨ Image + ClipOval é…åˆç›¸å…³å±æ€§å®ç°åœ†å½¢å›¾ç‰‡ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Image Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Center(<br>      child: ClipOval(<br>        child: Image.network(<br>          <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>          width: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„å®½åº¦ä¸º 300</span><br>          height: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„é«˜åº¦ä¸º 300</span><br>          fit: BoxFit.cover, <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡ç­‰æ¯”æ”¾å¤§ï¼Œå……æ»¡çˆ¶å®¹å™¨</span><br>        ),<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å°±å®ç°äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ</p><h2 id="äºŒã€Flutter-Widget-ä¹‹-ListView"><a href="#äºŒã€Flutter-Widget-ä¹‹-ListView" class="headerlink" title="äºŒã€Flutter Widget ä¹‹ ListView"></a>äºŒã€Flutter Widget ä¹‹ ListView</h2><p>åˆ—è¡¨æ˜¯æˆ‘ä»¬é¡¹ç›®å¼€å‘ä¸­æœ€å¸¸ç”¨çš„ä¸€ç§å¸ƒå±€æ–¹å¼ï¼ŒFlutter ç»™æˆ‘ä»¬æä¾›äº† ListView æ¥å®šä¹‰åˆ—è¡¨ï¼Œå®ƒæ”¯æŒå‚ç›´å’Œæ°´å¹³æ–¹å‘å±•ç¤ºï¼Œé€šè¿‡ä¸€ä¸ªå±æ€§å°±å¯ä»¥æ§åˆ¶åˆ—è¡¨çš„æ˜¾ç¤ºæ–¹å‘</p><h3 id="2-1ã€æ•ˆæœå±•ç¤º"><a href="#2-1ã€æ•ˆæœå±•ç¤º" class="headerlink" title="2.1ã€æ•ˆæœå±•ç¤º"></a>2.1ã€æ•ˆæœå±•ç¤º</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/71e5730aaec645d9b0652dc6e8c77b9c~tplv-k3u1fbpfcp-watermark.image" alt="flutter_06.png"></p><h3 id="2-2ã€ListView-ä»‹ç»"><a href="#2-2ã€ListView-ä»‹ç»" class="headerlink" title="2.2ã€ListView ä»‹ç»"></a>2.2ã€ListView ä»‹ç»</h3><h4 id="2-2-1ã€å¸¸ç”¨å±æ€§ä»‹ç»"><a href="#2-2-1ã€å¸¸ç”¨å±æ€§ä»‹ç»" class="headerlink" title="2.2.1ã€å¸¸ç”¨å±æ€§ä»‹ç»"></a>2.2.1ã€å¸¸ç”¨å±æ€§ä»‹ç»</h4><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>scrollDirection</td><td>Axis</td><td>Axis.horizontal æ°´å¹³åˆ—è¡¨ <br/>Axis.vertical å‚ç›´åˆ—è¡¨</td></tr><tr><td>padding</td><td>EdgeInsetsGeometry</td><td>å…§è¾¹è·</td></tr><tr><td>resolve</td><td>bool</td><td>ç»„ä»¶åå‘æ’åº</td></tr><tr><td>children</td><td>List<Widget></td><td>åˆ—è¡¨å…ƒç´ </td></tr></tbody></table><p>æ›´å¤šå±æ€§å‚è€ƒï¼š<a href="https://api.flutter.dev/flutter/widgets/ListView-class.html">https://api.flutter.dev/flutter/widgets/ListView-class.html</a></p><p>ListView çš„ children èƒ½åµŒå¥—å„ç§ Widget å»å®ç°åˆ—è¡¨ UI æ•ˆæœ</p><h4 id="2-2-2ã€ListTile-ä»‹ç»"><a href="#2-2-2ã€ListTile-ä»‹ç»" class="headerlink" title="2.2.2ã€ListTile ä»‹ç»"></a>2.2.2ã€ListTile ä»‹ç»</h4><p>ListTile æ˜¯ä¸€ä¸ªåˆ—è¡¨ item Widget ï¼Œé€šå¸¸ç”¨äºå„ç§åˆ—è¡¨ä¸­ï¼Œå…¶å¸¸ç”¨çš„å±æ€§æœ‰ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>leading</td><td>Widget</td><td>å·¦ä¾§ç»„ä»¶</td></tr><tr><td>title</td><td>Widget</td><td>æ ‡é¢˜</td></tr><tr><td>subtitle</td><td>Widget</td><td>å‰¯æ ‡é¢˜</td></tr><tr><td>trailing</td><td>Widget</td><td>å³ä¾§ç»„ä»¶</td></tr><tr><td>onTap</td><td></td><td>ç‚¹å‡»äº‹ä»¶å›è°ƒ</td></tr><tr><td>onLongPress</td><td></td><td>é•¿æŒ‰äº‹ä»¶å›è°ƒ</td></tr></tbody></table><p>æ›´å¤šå±æ€§å‚è€ƒï¼š<a href="https://api.flutter.dev/flutter/material/ListTile-class.html">https://api.flutter.dev/flutter/material/ListTile-class.html</a></p><p>ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ ListView + ListTile å®ç°ä¸€ä¸ªæ•ˆæœï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br><br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter ListView Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ListView(<br>      children: [<br>        ListTile(<br>          leading: Icon(Icons.search),<br>          title: Text(<span class="hljs-string">&quot;æ ‡é¢˜1&quot;</span>),<br>          subtitle: Text(<span class="hljs-string">&quot;æè¿°1&quot;</span>),<br>          trailing: Icon(Icons.home),<br>        ),<br>        ListTile(<br>          leading: Icon(Icons.search),<br>          title: Text(<span class="hljs-string">&quot;æ ‡é¢˜2&quot;</span>),<br>          subtitle: Text(<span class="hljs-string">&quot;æè¿°2&quot;</span>),<br>          trailing: Icon(Icons.home)<br>        ),<br>        ListTile(<br>          leading: Icon(Icons.search),<br>          title: Text(<span class="hljs-string">&quot;æ ‡é¢˜3&quot;</span>),<br>          subtitle: Text(<span class="hljs-string">&quot;æè¿°3&quot;</span>),<br>          trailing: Icon(Icons.home)<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c02d016436184879a7d8871bdfb2e904~tplv-k3u1fbpfcp-watermark.image" alt="flutter_07.png"></p><h3 id="2-3ã€æ•ˆæœå®ç°"><a href="#2-3ã€æ•ˆæœå®ç°" class="headerlink" title="2.3ã€æ•ˆæœå®ç°"></a>2.3ã€æ•ˆæœå®ç°</h3><p>ä¸Šé¢ 2.1 å±•ç¤ºçš„æ•ˆæœå°±æ˜¯ï¼šListTile + æ¨ªçº¿ä½œä¸ºä¸€ä¸ª item è¿›è¡Œæ’åˆ—ï¼Œå¦‚ä½•å°†è¿™ä¸¤ä¸ª Widget åŒ…è£…ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œæˆ‘ä»¬å°±è¦å­¦ä¹ ä¸‹ Column </p><p>1ã€Column ä»‹ç»</p><p>Column æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„å‚ç›´å¸ƒå±€ Widgetï¼Œå…¶å¸¸ç”¨å±æ€§æœ‰ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>mainAxisAlignment</td><td>MainAxisAlignment</td><td>ä¸»è½´çš„æ’åºæ–¹å¼</td></tr><tr><td>crossAxisAlignment</td><td>CrossAxisAlignment</td><td>æ¬¡è½´çš„æ’åºæ–¹å¼</td></tr><tr><td>children</td><td>List<Widget></td><td>ç»„ä»¶å­å…ƒç´ </td></tr></tbody></table><p>æ›´å¤šå±æ€§å‚è€ƒï¼š<a href="https://api.flutter.dev/flutter/widgets/Column-class.html">https://api.flutter.dev/flutter/widgets/Column-class.html</a></p><p>åŒæ · Flutter ç»™æˆ‘ä»¬æä¾›äº†æ°´å¹³å¸ƒå±€ Widget Rowï¼Œå¸¸ç”¨å±æ€§å’Œ Column ä¸€æ ·</p><p>2ã€æ¨ªçº¿æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Divider</p><p>okï¼Œç°åœ¨å°±å¯ä»¥å»å®ç°æ•ˆæœå›¾äº†ï¼Œä¸Šé¢ 2.2 çš„ä¾‹å­ ListView é‡Œé¢çš„æ•°æ®éƒ½æ˜¯å†™æ­»çš„ï¼Œä¸çµæ´»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ ListView çš„å‘½åæ„é€ æ–¹æ³• ListView.Builder æ¥å®ç°åŠ¨æ€åŠ è½½ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br><br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter ListView Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-comment">//mock æ•°æ®ï¼šç›¸å½“äº List&lt;Map&gt;</span><br>  <span class="hljs-keyword">var</span> mDataList = [<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜1&quot;</span>,<br>      <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;æè¿°1&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜2&quot;</span>,<br>      <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;æè¿°2&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜3&quot;</span>,<br>      <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;æè¿°3&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜4&quot;</span>,<br>      <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;æè¿°4&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜5&quot;</span>,<br>      <span class="hljs-string">&quot;desc&quot;</span>:<span class="hljs-string">&quot;æè¿°6&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>  ];<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> ListView.builder(<span class="hljs-comment">//é€šè¿‡ ListView.builder å®ç°æ•°æ®çš„åŠ¨æ€åŠ è½½</span><br>        itemCount: mDataList.length, <span class="hljs-comment">//item çš„ä¸ªæ•°</span><br>        itemBuilder: (context, index) &#123; <span class="hljs-comment">//é€šè¿‡ itemBuilder æ„å»º Widget</span><br>          <span class="hljs-keyword">return</span> Column(<br>            children: [ <span class="hljs-comment">//Column é‡Œé¢åŒ…è£…äº† ListTile + Divider</span><br>              ListTile(<br>                leading: ClipOval( <span class="hljs-comment">//åœ†å½¢å›¾ç‰‡</span><br>                  child: Image.network(<br>                    mDataList[index][<span class="hljs-string">&quot;image&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>,<br>                    width: <span class="hljs-number">50</span>,<br>                    height: <span class="hljs-number">50</span>,<br>                    fit: BoxFit.cover,<br>                  ),<br>                ),<br>                title: Text(mDataList[index][<span class="hljs-string">&quot;title&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>), <span class="hljs-comment">//æ ‡é¢˜</span><br>                subtitle: Text(mDataList[index][<span class="hljs-string">&quot;desc&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>), <span class="hljs-comment">//å‰¯æ ‡é¢˜</span><br>              ),<br>              Divider() <span class="hljs-comment">//æ¨ªçº¿</span><br>            ],<br>          );<br>        &#125;);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å°±å®ç°äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ</p><h2 id="ä¸‰ã€Flutter-Widget-ä¹‹-GridView"><a href="#ä¸‰ã€Flutter-Widget-ä¹‹-GridView" class="headerlink" title="ä¸‰ã€Flutter Widget ä¹‹ GridView"></a>ä¸‰ã€Flutter Widget ä¹‹ GridView</h2><p>GridView æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„ç½‘æ ¼å¸ƒå±€ Widgetï¼Œæˆ‘ä»¬å¿«é€Ÿè¿‡ä¸€ä¸‹ï¼Œç„¶åå®ç°ä¸€äº›æ•ˆæœï¼š</p><p>GridView åˆ›å»ºç½‘æ ¼åˆ—è¡¨æœ‰å¤šç§æ–¹å¼ï¼Œä¸»è¦ä»‹ç»ä¸¤ç§ï¼š</p><p>1ã€é€šè¿‡ GridView.count å®ç°ç½‘æ ¼å¸ƒå±€</p><p>2ã€é€šè¿‡ GridView.builder å®ç°ç½‘æ ¼å¸ƒå±€</p><p><strong>å¸¸ç”¨å±æ€§</strong>ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>scrollDirection</td><td>Axis</td><td>Axis.horizontal æ°´å¹³åˆ—è¡¨ <br/>Axis.vertical å‚ç›´åˆ—è¡¨</td></tr><tr><td>padding</td><td>EdgeInsetsGeometry</td><td>å…§è¾¹è·</td></tr><tr><td>resolve</td><td>bool</td><td>ç»„ä»¶åå‘æ’åº</td></tr><tr><td>children</td><td>List<Widget></td><td>åˆ—è¡¨å…ƒç´ </td></tr><tr><td>crossAxisSpacing</td><td>double</td><td>æ°´å¹³å­ Widget ä¹‹é—´é—´è·</td></tr><tr><td>mainAxisSpacing</td><td>double</td><td>å‚ç›´å­ Widget ä¹‹é—´é—´è·</td></tr><tr><td>crossAxisCount</td><td>int</td><td>ä¸€è¡Œçš„ Widget æ•°é‡</td></tr><tr><td>childAspectRatio</td><td>double</td><td>å­ Widget å®½é«˜æ¯”ä¾‹</td></tr><tr><td>gridDelegate</td><td>SliverGridDelegate</td><td>æ§åˆ¶å¸ƒå±€ä¸»è¦ç”¨åœ¨ GridView.builder é‡Œé¢</td></tr></tbody></table><h3 id="3-1ã€Flutter-GridView-count-å®ç°ç½‘æ ¼å¸ƒå±€"><a href="#3-1ã€Flutter-GridView-count-å®ç°ç½‘æ ¼å¸ƒå±€" class="headerlink" title="3.1ã€Flutter GridView.count å®ç°ç½‘æ ¼å¸ƒå±€"></a>3.1ã€Flutter GridView.count å®ç°ç½‘æ ¼å¸ƒå±€</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br><br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter ListView Widget&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br><br>  <span class="hljs-comment">//mock æ•°æ®</span><br>  <span class="hljs-keyword">var</span> mDataList = [<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜1&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜2&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜3&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜4&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;æ ‡é¢˜5&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>:<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>  ];<br><br>  <span class="hljs-built_in">List</span>&lt;Widget&gt; _getListWidget() &#123;<br>    <span class="hljs-keyword">var</span> listWidget = mDataList.map((value) &#123;<br>      <span class="hljs-keyword">return</span> Container(<br>        decoration: <span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªå®½åº¦ä¸º 1 ç»¿è‰²çš„è¾¹æ¡†</span><br>          BoxDecoration(border: Border.all(color: Colors.green, width: <span class="hljs-number">1.0</span>)),<br>        child: Column( <span class="hljs-comment">//å‚ç›´å¸ƒå±€é‡Œé¢åµŒå¥—ï¼šExpanded + SizedBox + Text + SizedBox</span><br>          children: [<br>            Expanded( <span class="hljs-comment">//å±•å¼€ Widgetï¼Œç±»ä¼¼ Android é‡Œé¢ Linearlayout è®¾ç½®æƒé‡ï¼Œç”¨åœ¨è¿™æ˜¯è®©å›¾ç‰‡è‡ªé€‚åº”å±•å¼€</span><br>              child: Image.network(<span class="hljs-comment">// å›¾ç‰‡</span><br>                value[<span class="hljs-string">&quot;image&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>,<br>                fit: BoxFit.cover,<br>                width: <span class="hljs-built_in">double</span>.infinity, <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„å®½åº¦ä¸ºå±å¹•çš„å®½åº¦</span><br>              ),<br>            ),<br>            SizedBox(height: <span class="hljs-number">12</span>),<span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªé«˜åº¦ä¸º 12 çš„ç©ºç™½é—´è·</span><br>            Text( <span class="hljs-comment">// è®¾ç½®æ–‡æœ¬</span><br>                value[<span class="hljs-string">&quot;title&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>,<br>                textAlign: TextAlign.center,<br>                style: TextStyle(<br>                    fontSize: <span class="hljs-number">20</span><br>                )<br>            ),<br>            SizedBox(height: <span class="hljs-number">12</span>),<span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªé«˜åº¦ä¸º 12 çš„ç©ºç™½é—´è·</span><br>          ],<br>        ),<br>      );<br>    &#125;);<br>    <span class="hljs-keyword">return</span> listWidget.toList();<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> GridView.count(<br>      crossAxisCount: <span class="hljs-number">2</span>,<span class="hljs-comment">// è®¾ç½®ä¸€è¡Œæ˜¾ç¤º Widget æ•°é‡ä¸º 2</span><br>      padding: EdgeInsets.all(<span class="hljs-number">20</span>), <span class="hljs-comment">//è®¾ç½® GridView å…§è¾¹è·ä¸º 20</span><br>      crossAxisSpacing: <span class="hljs-number">20</span>, <span class="hljs-comment">//è®¾ç½®æ°´å¹³å­ Widget ä¹‹é—´çš„é—´è·ä¸º 20</span><br>      mainAxisSpacing: <span class="hljs-number">20</span>,  <span class="hljs-comment">//è®¾ç½®å‚ç›´å­ Widget ä¹‹é—´çš„é—´è·ä¸º 20</span><br>      children: _getListWidget() <span class="hljs-comment">//è®¾ç½®å­ Widget</span><br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªæ–° Widgetï¼šExpandedï¼ŒSizeBox</p><p>1ã€Expanded æ˜¯ç”¨äºå±•å¼€å­ Widget çš„ Widgetï¼Œå¸¸ç”¨äº Rowï¼ŒColumn ä¸­ï¼Œå…¶ flex å±æ€§å°±æ˜¯ç”¨æ¥è®¾ç½®æƒé‡çš„ï¼Œç±»ä¼¼äº Android çš„ LinearLayout è®¾ç½®æƒé‡</p><p>2ã€SizeBox ä¸»è¦æ˜¯ç”¨æ¥æŒ‡å®šä¸€æ®µé—´è·çš„ï¼Œå…¶æœ‰ä¸¤ä¸ªå±æ€§ï¼Œwidthï¼Œheightã€‚å¦‚æœè®¾ç½® width å°±æ˜¯æŒ‡å®šå®½åº¦ï¼Œå¦‚æœè®¾ç½® height å°±æ˜¯æŒ‡å®šé«˜åº¦</p><p>å®ç°æ•ˆæœï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8ed5babf3a7642069893a05e1afe3240~tplv-k3u1fbpfcp-watermark.image" alt="flutter_08.png"></p><h3 id="3-2ã€Flutter-GridView-builder-å®ç°ç½‘æ ¼å¸ƒå±€"><a href="#3-2ã€Flutter-GridView-builder-å®ç°ç½‘æ ¼å¸ƒå±€" class="headerlink" title="3.2ã€Flutter GridView.builder å®ç°ç½‘æ ¼å¸ƒå±€"></a>3.2ã€Flutter GridView.builder å®ç°ç½‘æ ¼å¸ƒå±€</h3><p>åŒæ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬ä½¿ç”¨ GridView.builder æ¥å®ç°</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter GridView Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>          elevation: <span class="hljs-number">30</span>, <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>        ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-comment">//mock æ•°æ®</span><br>  <span class="hljs-keyword">var</span> mDataList = [<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ ‡é¢˜1&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ ‡é¢˜2&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ ‡é¢˜3&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ ‡é¢˜4&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;æ ‡é¢˜5&quot;</span>,<br>      <span class="hljs-string">&quot;image&quot;</span>: <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span><br>    &#125;,<br>  ];<br><br>  Widget _getListWidget(context, index) &#123;<br>    <span class="hljs-keyword">return</span> Container(<br>      decoration: <span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªå®½åº¦ä¸º 1 ç»¿è‰²çš„è¾¹æ¡†</span><br>          BoxDecoration(border: Border.all(color: Colors.green, width: <span class="hljs-number">1.0</span>)),<br>      child: Column(<br>        <span class="hljs-comment">//å‚ç›´å¸ƒå±€é‡Œé¢åµŒå¥—ï¼šExpanded + SizedBox + Text + SizedBox</span><br>        children: [<br>          Expanded(<br>            <span class="hljs-comment">//æ‰©å±• Widgetï¼Œç±»ä¼¼ Android é‡Œé¢ Linearlayout è®¾ç½®æƒé‡ï¼Œç”¨åœ¨è¿™æ˜¯è®©å›¾ç‰‡è‡ªé€‚åº”</span><br>            child: Image.network(<br>              <span class="hljs-comment">// å›¾ç‰‡</span><br>              mDataList[index][<span class="hljs-string">&quot;image&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>,<br>              fit: BoxFit.cover,<br>              width: <span class="hljs-built_in">double</span>.infinity, <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡çš„å®½åº¦ä¸ºå±å¹•çš„å®½åº¦</span><br>            ),<br>          ),<br>          SizedBox(height: <span class="hljs-number">12</span>), <span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªé«˜åº¦ä¸º 12 çš„ç©ºç™½é—´è·</span><br>          Text(<br>              <span class="hljs-comment">// è®¾ç½®æ–‡æœ¬</span><br>              mDataList[index][<span class="hljs-string">&quot;title&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>,<br>              textAlign: TextAlign.center,<br>              style: TextStyle(fontSize: <span class="hljs-number">20</span>)),<br>          SizedBox(height: <span class="hljs-number">12</span>), <span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªé«˜åº¦ä¸º 12 çš„ç©ºç™½é—´è·</span><br>        ],<br>      ),<br>    );<br>  &#125;<br><br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> GridView.builder(<br>        itemCount: mDataList.length,<br>        padding: EdgeInsets.all(<span class="hljs-number">20</span>),<br>        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(<br>          crossAxisCount: <span class="hljs-number">2</span>, <span class="hljs-comment">//è®¾ç½®ä¸€è¡Œæœ‰ä¸¤ä¸ª Widget</span><br>          crossAxisSpacing: <span class="hljs-number">20</span>, <span class="hljs-comment">//è®¾ç½®æ°´å¹³å­ Widget ä¹‹é—´çš„é—´è·ä¸º 20</span><br>          mainAxisSpacing: <span class="hljs-number">20</span>, <span class="hljs-comment">//è®¾ç½®å‚ç›´å­ Widget ä¹‹é—´çš„é—´è·ä¸º 20</span><br>          childAspectRatio: <span class="hljs-number">1</span>, <span class="hljs-comment">//è®¾ç½®å­ç»„ä»¶å®½é«˜æ¯”ä¾‹ä¸º 1</span><br>        ),<br>        itemBuilder: _getListWidget <span class="hljs-comment">//å°†æ–¹æ³•ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ å…¥</span><br>        );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€Flutter-Widget-ä¹‹-Stack"><a href="#å››ã€Flutter-Widget-ä¹‹-Stack" class="headerlink" title="å››ã€Flutter Widget ä¹‹ Stack"></a>å››ã€Flutter Widget ä¹‹ Stack</h2><p>Stack æ˜¯ Fluter æä¾›çš„å å±‚ Widget ï¼Œç±»ä¼¼ Android çš„ FrameLayout</p><p><strong>å¸¸ç”¨å±æ€§</strong>ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>alignment</td><td>AlignmentGeometry</td><td>é…ç½®æ‰€æœ‰å­å…ƒç´ çš„æ˜¾ç¤ºä½ç½®</td></tr><tr><td>children</td><td>List<Widget></td><td>å­ç»„ä»¶</td></tr></tbody></table><p>é€šå¸¸å®ƒä¼šé…åˆ Align æˆ– Positioned å®ç°å®šä½å¸ƒå±€</p><p><strong>Align å¸¸ç”¨å±æ€§</strong></p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>alignment</td><td>AlignmentGeometry</td><td>é…ç½®å­å…ƒç´ çš„æ˜¾ç¤ºä½ç½®</td></tr><tr><td>child</td><td>Widget</td><td>å­ç»„ä»¶</td></tr></tbody></table><p><strong>Positioned å¸¸ç”¨å±æ€§</strong></p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>top</td><td>double</td><td>å­å…ƒç´ è·ç¦»é¡¶éƒ¨çš„è·ç¦»</td></tr><tr><td>bottom</td><td>double</td><td>å­å…ƒç´ è·ç¦»åº•éƒ¨çš„è·ç¦»</td></tr><tr><td>left</td><td>double</td><td>å­å…ƒç´ è·ç¦»å·¦ä¾§è·ç¦»</td></tr><tr><td>right</td><td>double</td><td>å­å…ƒç´ è·ç¦»å³ä¾§è·ç¦»</td></tr><tr><td>child</td><td>Widget</td><td>å­ç»„ä»¶</td></tr></tbody></table><p>ä¸‹é¢æˆ‘ä»¬å®ç°å¦‚ä¸‹æ•ˆæœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65d60dd3b5ee487e89e6abc3f3265e13~tplv-k3u1fbpfcp-watermark.image" alt="flutter_09.png"></p><h3 id="4-1ã€Stack-Align-å®ç°å®šä½å¸ƒå±€"><a href="#4-1ã€Stack-Align-å®ç°å®šä½å¸ƒå±€" class="headerlink" title="4.1ã€Stack + Align å®ç°å®šä½å¸ƒå±€"></a>4.1ã€Stack + Align å®ç°å®šä½å¸ƒå±€</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Stack Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>          elevation: <span class="hljs-number">30</span>, <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>        ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Stack(<br>      children: [<br>        Align(<br>          alignment: Alignment.topLeft,<span class="hljs-comment">//å·¦ä¸Š</span><br>          child: Container(<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            color: Colors.red,<br>          ),<br>        ),<br>        Align(<br>          alignment: Alignment.topRight,<span class="hljs-comment">//å³ä¸Š</span><br>          child: Container(<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            color: Colors.orange,<br>          ),<br>        ),<br>        Align(<br>          alignment: Alignment.center,<span class="hljs-comment">//ä¸­é—´</span><br>          child: Container(<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            color: Colors.yellow,<br>          ),<br>        ),<br>        Align(<br>          alignment: Alignment.bottomLeft,<span class="hljs-comment">//å·¦ä¸‹</span><br>          child: Container(<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            color: Colors.green,<br>          ),<br>        ),<br>        Align(<br>          alignment: Alignment.bottomRight,<span class="hljs-comment">//å³ä¸‹</span><br>          child: Container(<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            color: Colors.blue,<br>          ),<br>        )<br>      ],<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-2ã€Stack-Positioned-å®ç°å®šä½å¸ƒå±€"><a href="#4-2ã€Stack-Positioned-å®ç°å®šä½å¸ƒå±€" class="headerlink" title="4.2ã€Stack + Positioned å®ç°å®šä½å¸ƒå±€"></a>4.2ã€Stack + Positioned å®ç°å®šä½å¸ƒå±€</h3><p>è¿™ç§æ–¹å¼å¿…é¡»æŒ‡å®šç²¾ç¡®çš„å®½é«˜ï¼Œåœ¨ä¸åŒåˆ†è¾¨ç‡çš„æ‰‹æœºï¼Œå¯èƒ½æ˜¾ç¤ºä¼šæœ‰ç‚¹é—®é¢˜ï¼Œä¼˜å…ˆè¿˜æ˜¯ä½¿ç”¨ Stack + Align å®ç°å®šä½å¸ƒå±€ï¼Œå¦‚æœå¯¹ UI çš„å°åå·®èƒ½å¿½ç•¥ä¸è®¡ï¼Œç”¨è¿™ä¸ªä¹Ÿå¯ä»¥</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Stack Widget&quot;</span>), <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>          elevation: <span class="hljs-number">30</span>, <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>        ),<br>        body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>        ),<br>  ));<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">final</span> size = MediaQuery.of(context).size;<br>    <span class="hljs-keyword">final</span> screenWidth = size.width; <span class="hljs-comment">//è·å–å±å¹•å®½åº¦</span><br>    <span class="hljs-keyword">final</span> screenHeight = size.height; <span class="hljs-comment">//è·å–å±å¹•é«˜åº¦</span><br>    <span class="hljs-keyword">return</span> Container(<br>      width: <span class="hljs-built_in">double</span>.infinity,<br>      height: <span class="hljs-built_in">double</span>.infinity,<br>      child: Stack(<br>        children: [<br>          Positioned(<span class="hljs-comment">//å·¦ä¸Š</span><br>            child: Container(<br>              width: <span class="hljs-number">100</span>,<br>              height: <span class="hljs-number">100</span>,<br>              color: Colors.red,<br>            ),<br>          ),<br>          Positioned(<span class="hljs-comment">//å³ä¸Š</span><br>            left: screenWidth - <span class="hljs-number">100</span>,<br>            child: Container(<br>              width: <span class="hljs-number">100</span>,<br>              height: <span class="hljs-number">100</span>,<br>              color: Colors.orange,<br>            ),<br>          ),<br>          Positioned(<span class="hljs-comment">//ä¸­é—´</span><br>            left: screenWidth / <span class="hljs-number">2</span> - <span class="hljs-number">50</span>,<br>            top: screenHeight / <span class="hljs-number">2</span> - <span class="hljs-number">90</span>,<br>            child: Container(<br>              width: <span class="hljs-number">100</span>,<br>              height: <span class="hljs-number">100</span>,<br>              color: Colors.yellow,<br>            ),<br>          ),<br>          Positioned(<span class="hljs-comment">//å·¦ä¸‹</span><br>            top: screenHeight - <span class="hljs-number">180</span>,<br>            child: Container(<br>              width: <span class="hljs-number">100</span>,<br>              height: <span class="hljs-number">100</span>,<br>              color: Colors.green,<br>            ),<br>          ),<br>          Positioned(<span class="hljs-comment">//å³ä¸‹</span><br>            left: screenWidth - <span class="hljs-number">100</span>,<br>            top: screenHeight - <span class="hljs-number">180</span>,<br>            child: Container(<br>              width: <span class="hljs-number">100</span>,<br>              height: <span class="hljs-number">100</span>,<br>              color: Colors.blue,<br>            ),<br>          )<br>        ],<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€Widget-ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹"><a href="#äº”ã€Widget-ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="äº”ã€Widget ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹"></a>äº”ã€Widget ç»„åˆä¹‹ç»¼åˆæ¡ˆä¾‹</h2><p>è®²ç»¼åˆæ¡ˆä¾‹ä¹‹å‰æˆ‘ä»¬ä»‹ç»ä¸‹ Paddingï¼š</p><p>Padding æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›å±•ç¤ºå†…é—´è·çš„ Widgetï¼Œä¸ºå•¥è¦æä¾›è¿™ä¸ª Widget å‘¢ï¼Ÿå› ä¸ºå¾ˆå¤š Widget éƒ½æ²¡æœ‰ padding å±æ€§ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨ Padding å¤„ç†ä¸å­ Widget çš„å…§é—´è·ï¼Œå…¶å¸¸ç”¨çš„å±æ€§å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>padding</td><td>EdgeInsetsGeometry</td><td>padding å€¼, EdgeInsets è®¾ç½®å¡«å……çš„å€¼</td></tr><tr><td>child</td><td>Widget</td><td>å­ç»„ä»¶</td></tr></tbody></table><p>okï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹ç»¼åˆæ¡ˆä¾‹è¦å®ç°çš„æ•ˆæœï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8b90e40d5ce42aa95c1a6be5bf0a1c1~tplv-k3u1fbpfcp-watermark.image" alt="flutter_10.png"></p><p>å…ˆæ‹ä¸€æ‹å®ç°çš„æ€è·¯ï¼šé¦–é¡µæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªé¡µé¢æ•´ä½“æœ‰ä¸€ä¸ªå†…é—´è·ï¼ˆPaddingï¼‰ï¼Œå…ƒç´ åˆ’åˆ†ä¸º 4 å—ï¼Œä»ä¸Šåˆ°ä¸‹å‚ç›´æ’åˆ—ï¼Œå¯ä»¥ä½¿ç”¨ Columnï¼Œåœ¨çœ‹å…·ä½“çš„æ¯ä¸€å—ï¼š</p><p>ç¬¬ä¸€å—ï¼šä¸€ä¸ªé»‘è‰²çš„é•¿æ–¹å½¢ï¼Œå¯ä»¥ä½¿ç”¨ Container å®ç°</p><p>ç¬¬äºŒå—ï¼šå·¦è¾¹ä¸€å¼ é•¿å›¾ï¼Œå³è¾¹å…ˆæ•´ä½“ä¹Ÿçœ‹æˆä¸€å¼ å›¾ç‰‡ï¼Œå·¦å³æ¯”ä¾‹ 2 : 1ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Row + Expanded å®ç°ï¼Œåœ¨çœ‹å³è¾¹è¿™å—æ•´ä½“åˆåˆ†ä¸Šä¸‹ä¸¤å¼ å›¾ç‰‡ï¼Œä¸ºäº†è®©è¿™ä¸¤å¼ å›¾ç‰‡è‡ªé€‚åº”å®½åº¦ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ListView åµŒå¥—ä¸¤ä¸ª Image</p><p>ç¬¬ä¸‰å—ï¼šå·¦ä¸­å³ä¸‰å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Stack + Align å®šä½å¸ƒå±€å®ç°</p><p>ç¬¬å››å—ï¼šç›´æ¥ä½¿ç”¨ ListTile å®ç°ï¼ŒListTile çš„ leading ä¸ºä¸€ä¸ªåœ†å½¢å›¾ç‰‡</p><p>å¦å¤–è¿˜æœ‰ä¸€äº›å°å°çš„ç»†èŠ‚ï¼Œå¦‚æ¯ä¸€å—ä¹‹é—´çš„é—´è·ï¼Œæ¨ªçº¿ï¼Œæ¯ä¸€å—å†…éƒ¨çš„é—´è·ï¼Œè¿™äº›æˆ‘ä»¬ä½¿ç”¨ SizedBoxï¼ŒDivider å®ç°</p><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘æ•´ç†å‡ºäº†ä¸€å¼ ç»“æ„å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a63bcb7778c42c6bcfef99a9bb3c81e~tplv-k3u1fbpfcp-watermark.image" alt="flutter_11 (2).png"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ç”¨ä»£ç å®ç°ä¸€ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MyApp());<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MaterialApp(<br>      home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&quot;Flutter Widget Combine Pricetice&quot;</span>),<br>          elevation: <span class="hljs-number">30</span>, <span class="hljs-comment">//è®¾ç½®æ ‡é¢˜é˜´å½±</span><br>        ),<br>        body: MyHome(),<br>      ),<br>    );<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyHome</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Padding( <span class="hljs-comment">//Padding å®ç°é¡µé¢å…§é—´è·</span><br>      padding: EdgeInsets.all(<span class="hljs-number">10</span>),<br>      child: Column( <span class="hljs-comment">//Column å®ç°å¸ƒå±€å‚ç›´æ’åˆ—</span><br>        children: [<br>          Container( <span class="hljs-comment">//Container å®ç°é»‘è‰²é•¿æ–¹å½¢</span><br>              color: Colors.black,<br>              height: <span class="hljs-number">180</span><br>          ),<br>          SizedBox(height: <span class="hljs-number">10</span>), <span class="hljs-comment">//é«˜åº¦ä¸º 10 çš„é—´è·</span><br>          Row( <span class="hljs-comment">// Row + Expanded å®ç°æ¨ªå‘å¸ƒå±€çš„ç­‰æ¯”åˆ†é…</span><br>            children: [<br>              Expanded(<br>                  flex: <span class="hljs-number">2</span>,<br>                  child: Container( <span class="hljs-comment">//Container åµŒå¥— Image å®ç°å·¦è¾¹é•¿å›¾</span><br>                    child: Image.network(<br>                        <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                        fit: BoxFit.cover,<br>                        height: <span class="hljs-number">100</span>),<br>                  )),<br>              SizedBox(width: <span class="hljs-number">10</span>), <span class="hljs-comment">//é«˜åº¦ä¸º 10 çš„é—´è·</span><br>              Expanded(<br>                flex: <span class="hljs-number">1</span>,<br>                child: Container( <span class="hljs-comment">//Container åµŒå¥— ListView å®ç°å³è¾¹ä¸Šä¸‹ä¸¤å¼ è‡ªé€‚åº”å›¾</span><br>                  height: <span class="hljs-number">100</span>,<br>                  child: ListView(<br>                    children: [<br>                      Image.network(<br>                          <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                          fit: BoxFit.cover,<br>                          height: <span class="hljs-number">45</span>),<br>                      SizedBox(height: <span class="hljs-number">10</span>), <span class="hljs-comment">//é«˜åº¦ä¸º 10 çš„é—´è·</span><br>                      Image.network(<br>                          <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                          fit: BoxFit.cover,<br>                          height: <span class="hljs-number">45</span>),<br>                    ],<br>                  ),<br>                ),<br>              )<br>            ],<br>          ),<br>          Divider(), <span class="hljs-comment">//æ¨ªçº¿</span><br>          Stack( <span class="hljs-comment">// Stack + Align å®ç°å®šä½å¸ƒå±€</span><br>            children: [<br>              Align(<br>                  alignment: Alignment.topLeft,<br>                  child: Image.network(<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                      width: <span class="hljs-number">70</span>,<br>                      height: <span class="hljs-number">70</span>,<br>                      fit: BoxFit.cover)<br>              ),<br>              Align(<br>                  alignment: Alignment.topCenter,<br>                  child: Image.network(<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                      width: <span class="hljs-number">70</span>,<br>                      height: <span class="hljs-number">70</span>,<br>                      fit: BoxFit.cover)<br>              ),<br>              Align(<br>                  alignment: Alignment.topRight,<br>                  child: Image.network(<span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                      width: <span class="hljs-number">70</span>,<br>                      height: <span class="hljs-number">70</span>,<br>                      fit: BoxFit.cover)<br>              )<br>            ],<br>          ),<br>          Divider(), <span class="hljs-comment">//æ¨ªçº¿</span><br>          ListTile( <span class="hljs-comment">// ListTile å®ç° item</span><br>            leading: ClipOval( <span class="hljs-comment">//åœ†å½¢å›¾ç‰‡</span><br>              child: Image.network(<br>                <span class="hljs-string">&quot;https://img.lianzhixiu.com/uploads/210106/37-21010609363aS.jpg&quot;</span>,<br>                width: <span class="hljs-number">50</span>,<br>                height: <span class="hljs-number">50</span>,<br>                fit: BoxFit.cover,<br>              ),<br>            ),<br>            title: Text(<br>              <span class="hljs-string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜äº¦è²&quot;</span>,<span class="hljs-comment">//æ ‡é¢˜</span><br>              style: TextStyle(<br>                  color: Colors.green,<br>                  fontWeight: FontWeight.bold<br>              )<br>            ),<br>            subtitle: Text(<br>                <span class="hljs-string">&quot;å¾ˆé«˜å…´è®¤è¯†ä½ &quot;</span>,<span class="hljs-comment">//å‰¯æ ‡é¢˜</span><br>                style: TextStyle(<br>                  color: Colors.orange,<br>                )<br>            ),<br>          )<br>        ],<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬æ–‡é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€é‡‡ç”¨ æ•ˆæœ -&gt; Widget ä»‹ç» -&gt; ä»£ç å®ç°çš„æ–¹å¼å¯¹ Imageï¼ŒListViewï¼ŒGridViewï¼ŒStack è¿›è¡Œäº†ä»‹ç»</p><p>2ã€åœ¨ä»‹ç»ä¸Šé¢ Widget çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆç©¿æ’äº†å…¶å®ƒä¸€äº› Widget çš„è®²è§£ï¼šClipOvalï¼ŒListTileï¼ŒExpandedï¼ŒSizedBoxï¼ŒDividerï¼ŒAlignï¼ŒPositionedï¼ŒPadding</p><p>3ã€æœ€åé€šè¿‡ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹å¯¹ä»‹ç»çš„ Widget è¿›è¡Œç»„åˆä½¿ç”¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šä»‹ç» Flutter Button ç›¸å…³ Widgetï¼Œä»¥åŠ Flutter 2.x Button çš„å˜åŒ–</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://api.flutter.dev/flutter/dart-ui/dart-ui-library.html">Flutter å®˜æ–¹ API æ–‡æ¡£</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼šFlutter ç‰¹ç‚¹åŠå¸¸ç”¨ Widget ä»‹ç»</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AFlutter%20%E7%89%B9%E7%82%B9%E5%8F%8A%E5%B8%B8%E7%94%A8%20Widget%20%E4%BB%8B%E7%BB%8D/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AFlutter%20%E7%89%B9%E7%82%B9%E5%8F%8A%E5%B8%B8%E7%94%A8%20Widget%20%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e1baaa8a9b94961a5cae015b0890cf3~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å…¨é¢ä»‹ç»äº† Dart è¯­æ³•ï¼Œå†…å®¹å¾ˆå¤šï¼Œæ–‡å­—+ä»£ç æœ‰ä¸‰ä¸‡å¤šå­—ï¼Œå¦‚æœä½ èƒ½å¤Ÿè€å¿ƒçœ‹å®Œå¹¶æ‰‹æ•²é‡Œé¢çš„ç¤ºä¾‹ï¼Œä½ ä¸€å®šä¼šæ”¶è·å¾ˆå¤§ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯» <a href="https://juejin.cn/post/7130647339294785549#heading-0">Flutter ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šDart è¯­æ³•ç­‘åŸº</a>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥ Flutter çš„å­¦ä¹ ã€‚</p><h2 id="ä¸€ã€Flutter-ç‰¹ç‚¹ä»‹ç»"><a href="#ä¸€ã€Flutter-ç‰¹ç‚¹ä»‹ç»" class="headerlink" title="ä¸€ã€Flutter ç‰¹ç‚¹ä»‹ç»"></a>ä¸€ã€Flutter ç‰¹ç‚¹ä»‹ç»</h2><p>å­¦ä¹ ä¸€ä¸ªæ¡†æ¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£è¿™ä¸ªæ¡†æ¶çš„ç‰¹ç‚¹ï¼Œå°±å¥½æ¯”ä½ å­¦å¼€è½¦ä¸€æ ·ï¼Œä½ è¦çŸ¥é“è¿™ä¸ªè½¦æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œä½ æ‰èƒ½å¿«é€Ÿçš„å»ä¸Šæ‰‹å®ƒã€‚Flutter ç‰¹ç‚¹ä»‹ç»ï¼š</p><h3 id="1-1ã€åœ¨-Flutter-ä¸­ï¼Œä¸‡ç‰©çš†-Widgetï¼ˆç»„ä»¶ï¼‰"><a href="#1-1ã€åœ¨-Flutter-ä¸­ï¼Œä¸‡ç‰©çš†-Widgetï¼ˆç»„ä»¶ï¼‰" class="headerlink" title="1.1ã€åœ¨ Flutter ä¸­ï¼Œä¸‡ç‰©çš† Widgetï¼ˆç»„ä»¶ï¼‰"></a>1.1ã€åœ¨ Flutter ä¸­ï¼Œä¸‡ç‰©çš† Widgetï¼ˆç»„ä»¶ï¼‰</h3><p>æˆ‘ä»¬åœ¨å†™ Flutter æ—¶ï¼Œä¸€å®šè¦æœ‰è¿™æ ·çš„æ„è¯†ã€‚è¿™æ ·æˆ‘ä»¬æ‰èƒ½æ›´å¥½åœ°ä¸Šæ‰‹å­¦ä¹ ã€‚åœ¨ Flutter ä¸­ï¼Œå‡ ä¹ä»»ä½•ä¸œè¥¿éƒ½æ˜¯ Widgetï¼Œä¸ä»…æ˜¯å¸¸è§çš„ UI ç»„ä»¶ï¼Œç”šè‡³æ˜¯å¸ƒå±€æ–¹å¼ï¼Œæ ·å¼ï¼ŒåŠ¨ç”»ç­‰éƒ½æ˜¯ Widget</p><h3 id="1-2ã€Widget-åµŒå¥—"><a href="#1-2ã€Widget-åµŒå¥—" class="headerlink" title="1.2ã€Widget åµŒå¥—"></a>1.2ã€Widget åµŒå¥—</h3><p>å†™ Android æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨ Xml æ–‡ä»¶ä¸­ç¼–å†™å¸ƒå±€åŠ View åµŒå¥—ï¼Œç„¶ååœ¨ Java æˆ– Kotlin æ–‡ä»¶ä¸­è¿›è¡Œ View é€»è¾‘ç¼–å†™ã€‚ä½†å†™ Flutterï¼Œæ— è®ºæ˜¯ Widget åµŒå¥—ï¼Œè¿˜æ˜¯ Widget é€»è¾‘ç¼–å†™ï¼Œéƒ½æ˜¯åœ¨ Dart æ–‡ä»¶ä¸­è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·å°±ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ï¼š</p><blockquote><p>1ã€å¤æ‚ç•Œé¢å‡ºç°å„ç§æ·±å±‚ Widget åµŒå¥—</p><p>2ã€ä»£ç é€»è¾‘æ··ä¹±ï¼Œå¯è¯»æ€§å·®</p></blockquote><p>ä½œä¸º Android å¼€å‘ï¼Œæˆ‘ä¸€å¼€å§‹çœŸçš„å¾ˆä¸ä¹ æƒ¯ï¼Œä½†æ˜¯éšç€ä½ å­¦ä¹ çš„æ·±å…¥ï¼Œå¯¹é¡¹ç›®è¿›è¡Œåˆç†çš„æ¶æ„è®¾è®¡ï¼ŒåŒ…ç»“æ„è®¾è®¡ï¼Œæ¸…æ™°çš„ä»£ç æ³¨é‡Šï¼Œä¸Šé¢çš„é—®é¢˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¾—åˆ°äº†è§£å†³</p><h3 id="1-3ã€Widget-çŠ¶æ€"><a href="#1-3ã€Widget-çŠ¶æ€" class="headerlink" title="1.3ã€Widget çŠ¶æ€"></a>1.3ã€Widget çŠ¶æ€</h3><p>åœ¨ Flutter ä¸­ï¼ŒWidget åˆ†ä¸ºä¸¤ç§ï¼š</p><blockquote><p>1ã€æ— çŠ¶æ€ Widget</p><p>2ã€æœ‰çŠ¶æ€ Widget</p></blockquote><p>æ— çŠ¶æ€ Widget (ç»§æ‰¿è‡ª StatelessWidget)ï¼šåˆå§‹åŒ–åæ— æ³•ä¿®æ”¹å…¶çŠ¶æ€å’Œ UIï¼Œå¦‚ï¼šTextï¼ŒScrollView</p><p>æœ‰çŠ¶æ€ Widget (ç»§æ‰¿è‡ª StatefulWidget)ï¼šå…¶çŠ¶æ€å¯èƒ½åœ¨ Widget ç”Ÿå‘½å‘¨æœŸä¸­å‘ç”Ÿå˜åŒ–ã€‚å¦‚ Imageï¼Œ Scrollable ç­‰ã€‚åœ¨è°ƒç”¨ setState æ–¹æ³•åï¼ŒWidget ä¼šé‡æ–°ç»˜åˆ¶ï¼Œåˆ›å»ºå…¶æ–°çš„ Widget</p><p>StatelessWidget å’Œ StatefulWidget éƒ½ç»§æ‰¿è‡ªWidget</p><p><strong>å° Tips</strong>ï¼š</p><p>1ã€åœ¨ä½ ç¼–å†™è‡ªå®šä¹‰ Widget æ—¶ï¼Œä½ é¦–å…ˆåˆ¤æ–­å®ƒæ˜¯æœ‰çŠ¶æ€çš„è¿˜æ˜¯æ— çŠ¶æ€çš„ï¼Œå¦‚æœ Widget éœ€è¦æ ¹æ®ç”¨æˆ·äº¤äº’æˆ–å…¶ä»–å› ç´ è¿›è¡Œæ›´æ”¹ï¼Œåˆ™è¯¥ Widget æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå¦åˆ™å°±æ˜¯æ— çŠ¶æ€çš„</p><p>2ã€å½“ä½ éœ€è¦æ”¹å˜ Widget çŠ¶æ€æ—¶ï¼Œå¿…é¡»è°ƒç”¨ setState æ–¹æ³•æ¥é€šçŸ¥ Flutter æ¥æ›´æ–°åˆ›å»ºæ–°çš„ Widget</p><p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢ä¸€äº›ç‰¹ç‚¹å¯èƒ½ä¸€å¼€å§‹ä¸èƒ½ç†è§£ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œæœ‰äº›é—®é¢˜éšç€ä½ çŸ¥è¯†çš„ç§¯ç´¯ä¾¿è¿åˆƒè€Œè§£äº†</p><h2 id="äºŒã€Flutter-å¸¸ç”¨-Widget-ä»‹ç»"><a href="#äºŒã€Flutter-å¸¸ç”¨-Widget-ä»‹ç»" class="headerlink" title="äºŒã€Flutter å¸¸ç”¨ Widget ä»‹ç»"></a>äºŒã€Flutter å¸¸ç”¨ Widget ä»‹ç»</h2><p>å…ˆçœ‹ä¸€å¼ æ•ˆæœå›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/963be24804034c308ba042a9fe6c6aac~tplv-k3u1fbpfcp-watermark.image" alt="1661082533405.jpg"></p><p>é—®é¢˜ï¼šä¸Šé¢çš„æ•ˆæœæ€ä¹ˆå®ç°çš„å‘¢ğŸ¤”ï¸ï¼Ÿ</p><p>å¦‚æœä½ æ˜¯å°ç™½ï¼Œé‚£ä¹ˆå°±è·Ÿç€æˆ‘çš„æ­¥ä¼ç»§ç»­å¾€ä¸‹å­¦ä¹ ã€‚å¦‚æœä¸æ˜¯ï¼Œä½ å¯ä»¥æƒ³ä¸€ä¸‹å¯ä»¥ä½¿ç”¨å“ªäº› Widget åµŒå¥—æ¥å®ç°ï¼Œä»¥åŠå®ç°çš„ä¸€äº›ç»†èŠ‚ã€‚</p><p>å¾…æˆ‘ä»¬å­¦ä¹ å®Œä¸‹é¢çš„ Widget åï¼Œåœ¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><h3 id="2-1ã€MaterialApp"><a href="#2-1ã€MaterialApp" class="headerlink" title="2.1ã€MaterialApp"></a>2.1ã€MaterialApp</h3><p>è§åçŸ¥ä¹‰ï¼ŒMaterialApp å°±æ˜¯ä¸€ä¸ªå¸¦ Material Design è®¾è®¡é£æ ¼çš„ Widgetï¼Œä¸€èˆ¬ä½œä¸ºé¡¶å±‚ Widget æ¥ä½¿ç”¨</p><h4 id="2-1-1ã€å±æ€§"><a href="#2-1-1ã€å±æ€§" class="headerlink" title="2.1.1ã€å±æ€§"></a>2.1.1ã€å±æ€§</h4><p>æˆ‘ä»¬å¦‚æœè¦æŸ¥çœ‹ä¸€ä¸ª Widget æœ‰å“ªäº›å±æ€§ï¼Œå¯ä»¥é€šè¿‡ IDE ç›´æ¥ç‚¹å‡»è¿™ä¸ª Widget çš„æºç å»æŸ¥çœ‹ï¼Œä½ ä¼šå‘ç°æ¯ä¸ª Widget éƒ½åŒ…å«è®¸å¤šå±æ€§ï¼Œè¿™ä¹ˆå¤šå±æ€§ä¸å¯èƒ½æ¯ä¸ªéƒ½å»çœ‹ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š<strong>æŒæ¡åŸºç¡€å¸¸ç”¨çš„ï¼Œå…¶å®ƒç”¨åˆ°æ—¶ï¼Œçœ‹æºç æŒ‰éœ€å»å–</strong></p><p>MaterialApp æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> MaterialApp(&#123;<br>    Key? key,<br>    <span class="hljs-keyword">this</span>.navigatorKey,<br>    <span class="hljs-keyword">this</span>.scaffoldMessengerKey,<br>    <span class="hljs-keyword">this</span>.home,<br>    <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, WidgetBuilder&gt; <span class="hljs-keyword">this</span>.routes = <span class="hljs-keyword">const</span> &lt;<span class="hljs-built_in">String</span>, WidgetBuilder&gt;&#123;&#125;,<br>    <span class="hljs-keyword">this</span>.initialRoute,<br>    <span class="hljs-keyword">this</span>.onGenerateRoute,<br>    <span class="hljs-keyword">this</span>.onGenerateInitialRoutes,<br>    <span class="hljs-keyword">this</span>.onUnknownRoute,<br>    <span class="hljs-built_in">List</span>&lt;NavigatorObserver&gt; <span class="hljs-keyword">this</span>.navigatorObservers = <span class="hljs-keyword">const</span> &lt;NavigatorObserver&gt;[],<br>    <span class="hljs-keyword">this</span>.builder,<br>    <span class="hljs-keyword">this</span>.title = <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-keyword">this</span>.onGenerateTitle,<br>    <span class="hljs-keyword">this</span>.color,<br>    <span class="hljs-keyword">this</span>.theme,<br>    <span class="hljs-keyword">this</span>.darkTheme,<br>    <span class="hljs-keyword">this</span>.highContrastTheme,<br>    <span class="hljs-keyword">this</span>.highContrastDarkTheme,<br>    <span class="hljs-keyword">this</span>.themeMode = ThemeMode.system,<br>    <span class="hljs-keyword">this</span>.locale,<br>    <span class="hljs-keyword">this</span>.localizationsDelegates,<br>    <span class="hljs-keyword">this</span>.localeListResolutionCallback,<br>    <span class="hljs-keyword">this</span>.localeResolutionCallback,<br>    <span class="hljs-keyword">this</span>.supportedLocales = <span class="hljs-keyword">const</span> &lt;Locale&gt;[Locale(<span class="hljs-string">&#x27;en&#x27;</span>, <span class="hljs-string">&#x27;US&#x27;</span>)],<br>    <span class="hljs-keyword">this</span>.debugShowMaterialGrid = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.showPerformanceOverlay = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.checkerboardRasterCacheImages = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.checkerboardOffscreenLayers = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.showSemanticsDebugger = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.debugShowCheckedModeBanner = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.shortcuts,<br>    <span class="hljs-keyword">this</span>.actions,<br>    <span class="hljs-keyword">this</span>.restorationScopeId,<br>    <span class="hljs-keyword">this</span>.scrollBehavior,<br>    <span class="hljs-keyword">this</span>.useInheritedMediaQuery = <span class="hljs-keyword">false</span>,<br>  &#125;) : <span class="hljs-keyword">assert</span>(routes != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(navigatorObservers != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(title != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(debugShowMaterialGrid != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(showPerformanceOverlay != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(checkerboardRasterCacheImages != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(checkerboardOffscreenLayers != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(showSemanticsDebugger != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(debugShowCheckedModeBanner != <span class="hljs-keyword">null</span>),<br>       routeInformationProvider = <span class="hljs-keyword">null</span>,<br>       routeInformationParser = <span class="hljs-keyword">null</span>,<br>       routerDelegate = <span class="hljs-keyword">null</span>,<br>       backButtonDispatcher = <span class="hljs-keyword">null</span>,<br>       <span class="hljs-keyword">super</span>(key: key);<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä¸‹é¢ä»‹ç»çš„å±æ€§ä»…æ˜¯ç”¨äºå®ç°ä¸Šé¢çš„æ•ˆæœå›¾</p><p>MaterialApp å¸¸ç”¨å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>home</td><td>é…ç½® App ä¸»é¡µ</td></tr></tbody></table><p>MaterialApp æ›´å¤šå±æ€§ä»‹ç»ï¼š<a href="https://segmentfault.com/a/1190000040552453">https://segmentfault.com/a/1190000040552453</a></p><h3 id="2-2ã€Scaffold"><a href="#2-2ã€Scaffold" class="headerlink" title="2.2ã€Scaffold"></a>2.2ã€Scaffold</h3><p>Scaffold æ˜¯ä¸€ä¸ª Material Design è®¾è®¡é£æ ¼çš„è„šæ‰‹æ¶ Widgetï¼Œä¸€èˆ¬åµŒå¥—åœ¨ MaterialApp çš„ home å±æ€§ä¸­</p><h4 id="2-2-1ã€å±æ€§"><a href="#2-2-1ã€å±æ€§" class="headerlink" title="2.2.1ã€å±æ€§"></a>2.2.1ã€å±æ€§</h4><p>Scaffold æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> Scaffold(&#123;<br>    Key? key,<br>    <span class="hljs-keyword">this</span>.appBar,<br>    <span class="hljs-keyword">this</span>.body,<br>    <span class="hljs-keyword">this</span>.floatingActionButton,<br>    <span class="hljs-keyword">this</span>.floatingActionButtonLocation,<br>    <span class="hljs-keyword">this</span>.floatingActionButtonAnimator,<br>    <span class="hljs-keyword">this</span>.persistentFooterButtons,<br>    <span class="hljs-keyword">this</span>.drawer,<br>    <span class="hljs-keyword">this</span>.onDrawerChanged,<br>    <span class="hljs-keyword">this</span>.endDrawer,<br>    <span class="hljs-keyword">this</span>.onEndDrawerChanged,<br>    <span class="hljs-keyword">this</span>.bottomNavigationBar,<br>    <span class="hljs-keyword">this</span>.bottomSheet,<br>    <span class="hljs-keyword">this</span>.backgroundColor,<br>    <span class="hljs-keyword">this</span>.resizeToAvoidBottomInset,<br>    <span class="hljs-keyword">this</span>.primary = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.drawerDragStartBehavior = DragStartBehavior.start,<br>    <span class="hljs-keyword">this</span>.extendBody = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.extendBodyBehindAppBar = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.drawerScrimColor,<br>    <span class="hljs-keyword">this</span>.drawerEdgeDragWidth,<br>    <span class="hljs-keyword">this</span>.drawerEnableOpenDragGesture = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.endDrawerEnableOpenDragGesture = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.restorationId,<br>  &#125;) : <span class="hljs-keyword">assert</span>(primary != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(extendBody != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(extendBodyBehindAppBar != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(drawerDragStartBehavior != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">super</span>(key: key);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>appBar</td><td>é…ç½®æ˜¾ç¤ºåœ¨ç•Œé¢é¡¶éƒ¨çš„ä¸€ä¸ª AppBar</td></tr><tr><td>body</td><td>é…ç½®å½“å‰ç•Œé¢æ‰€æ˜¾ç¤ºçš„ä¸»è¦å†…å®¹ Widget</td></tr></tbody></table><p>Scaffold æ›´å¤šå±æ€§ä»‹ç»ï¼š<a href="https://segmentfault.com/a/1190000040554948">https://segmentfault.com/a/1190000040554948</a></p><p>ä»¥ä¸Šä¸¤ä¸ª Widget å°±èƒ½æ­å»ºèµ·é¡µé¢çš„åŸºæœ¬æ¡†æ¶äº†ï¼Œä½†æ˜¯çœ‹åˆ°çš„ä¼šæ˜¯ä¸€ä¸ªç©ºç™½çš„é¡µé¢ã€‚å›åˆ°ä¸Šé¢é‚£å¼ å›¾ï¼Œæˆ‘ä»¬çœ‹åˆ°é¡¶éƒ¨æœ‰ä¸€ä¸ªæ ‡é¢˜æ ï¼Œè€Œä¸”è¿˜æœ‰é˜´å½±ï¼ŒFlutter ç»™æˆ‘ä»¬æä¾›äº† AppBar æ¥å®ç°</p><h3 id="2-3ã€AppBar"><a href="#2-3ã€AppBar" class="headerlink" title="2.3ã€AppBar"></a>2.3ã€AppBar</h3><p>AppBar æ˜¯åŸºäº Material Design è®¾è®¡é£æ ¼çš„æ ‡é¢˜æ  Widgetï¼Œä¸€èˆ¬åœ¨ Scaffold çš„ appBar å±æ€§ä¸­ä½¿ç”¨ï¼Œä½œä¸ºé¡¶éƒ¨æ ‡é¢˜æ </p><h4 id="2-3-1ã€å±æ€§"><a href="#2-3-1ã€å±æ€§" class="headerlink" title="2.3.1ã€å±æ€§"></a>2.3.1ã€å±æ€§</h4><p>AppBar æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs dart">AppBar(&#123;<br>    Key? key,<br>    <span class="hljs-keyword">this</span>.leading,<br>    <span class="hljs-keyword">this</span>.automaticallyImplyLeading = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.title,<br>    <span class="hljs-keyword">this</span>.actions,<br>    <span class="hljs-keyword">this</span>.flexibleSpace,<br>    <span class="hljs-keyword">this</span>.bottom,<br>    <span class="hljs-keyword">this</span>.elevation,<br>    <span class="hljs-keyword">this</span>.shadowColor,<br>    <span class="hljs-keyword">this</span>.shape,<br>    <span class="hljs-keyword">this</span>.backgroundColor,<br>    <span class="hljs-keyword">this</span>.foregroundColor,<br>    <span class="hljs-meta">@Deprecated</span>(<br>      <span class="hljs-string">&#x27;This property is no longer used, please use systemOverlayStyle instead. &#x27;</span><br>      <span class="hljs-string">&#x27;This feature was deprecated after v2.4.0-0.0.pre.&#x27;</span>,<br>    )<br>    <span class="hljs-keyword">this</span>.brightness,<br>    <span class="hljs-keyword">this</span>.iconTheme,<br>    <span class="hljs-keyword">this</span>.actionsIconTheme,<br>    <span class="hljs-meta">@Deprecated</span>(<br>      <span class="hljs-string">&#x27;This property is no longer used, please use toolbarTextStyle and titleTextStyle instead. &#x27;</span><br>      <span class="hljs-string">&#x27;This feature was deprecated after v2.4.0-0.0.pre.&#x27;</span>,<br>    )<br>    <span class="hljs-keyword">this</span>.textTheme,<br>    <span class="hljs-keyword">this</span>.primary = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.centerTitle,<br>    <span class="hljs-keyword">this</span>.excludeHeaderSemantics = <span class="hljs-keyword">false</span>,<br>    <span class="hljs-keyword">this</span>.titleSpacing,<br>    <span class="hljs-keyword">this</span>.toolbarOpacity = <span class="hljs-number">1.0</span>,<br>    <span class="hljs-keyword">this</span>.bottomOpacity = <span class="hljs-number">1.0</span>,<br>    <span class="hljs-keyword">this</span>.toolbarHeight,<br>    <span class="hljs-keyword">this</span>.leadingWidth,<br>    <span class="hljs-meta">@Deprecated</span>(<br>      <span class="hljs-string">&#x27;This property is obsolete and is false by default. &#x27;</span><br>      <span class="hljs-string">&#x27;This feature was deprecated after v2.4.0-0.0.pre.&#x27;</span>,<br>    )<br>    <span class="hljs-keyword">this</span>.backwardsCompatibility,<br>    <span class="hljs-keyword">this</span>.toolbarTextStyle,<br>    <span class="hljs-keyword">this</span>.titleTextStyle,<br>    <span class="hljs-keyword">this</span>.systemOverlayStyle,<br>  &#125;) : <span class="hljs-keyword">assert</span>(automaticallyImplyLeading != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(elevation == <span class="hljs-keyword">null</span> || elevation &gt;= <span class="hljs-number">0.0</span>),<br>       <span class="hljs-keyword">assert</span>(primary != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(toolbarOpacity != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(bottomOpacity != <span class="hljs-keyword">null</span>),<br>       preferredSize = _PreferredAppBarSize(toolbarHeight, bottom?.preferredSize.height),<br>       <span class="hljs-keyword">super</span>(key: key);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>title</td><td>é…ç½®æ ‡é¢˜æ çš„æ ‡é¢˜</td></tr><tr><td>elevation</td><td>é…ç½®æ ‡é¢˜æ ä¸‹æ–¹çš„é˜´å½±å¤§å°</td></tr></tbody></table><p>AppBar æ›´å¤šå±æ€§ä»‹ç»ï¼š<a href="https://segmentfault.com/a/1190000040562147">https://segmentfault.com/a/1190000040562147</a></p><p>æ ‡é¢˜æ å®ç°äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ body ä¸»ä½“éƒ¨åˆ†ï¼Œæˆ‘ä»¬åœ¨æ¥åˆ†æä¸€ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œä¸»ä½“éƒ¨åˆ†æ˜¯ä¸€ä¸ª<strong>å±…ä¸­</strong>æ˜¾ç¤ºçš„<strong>åœ†å½¢</strong>å›¾åƒï¼ŒèƒŒæ™¯æ˜¯è“è‰²ï¼Œæœ‰ä¸ªçº¢è‰²çš„è¾¹æ¡†ã€‚åœ†å½¢å›¾åƒé‡Œé¢æœ‰ä¸€è¡Œ<strong>æ–‡æœ¬</strong>ï¼Œæ–‡æœ¬çš„é¢œè‰²æ˜¯ç™½è‰²ï¼Œå­—ä½“æœ‰ç‚¹å€¾æ–œï¼Œå­—é—´è·åå¤§ï¼Œåªæ˜¾ç¤ºäº†ä¸€è¡Œï¼Œè¶…å‡ºéƒ¨åˆ† â€¦ ï¼Œè€Œä¸”æ–‡æœ¬çš„ä¸­é—´æœ‰ä¸€ä¸ªçº¢è‰²çš„è™šåˆ é™¤çº¿</p><p>ä¸Šé¢åŠ ç²—çš„æ–‡å­—å°±æ˜¯ç”¨äºå®ç°è¯¥æ•ˆæœçš„ Widgetï¼šCenterï¼ŒContainerï¼ŒText</p><h3 id="2-4ã€Center"><a href="#2-4ã€Center" class="headerlink" title="2.4ã€Center"></a>2.4ã€Center</h3><p>Center å°±æ˜¯å°†å­ Widget è¿›è¡Œä¸€ä¸ªå±…ä¸­å±•ç¤ºçš„ Widgetï¼Œå®ƒç»§æ‰¿è‡ª Alignï¼Œå› ä¸º Align é»˜è®¤çš„å¯¹é½æ–¹å¼æ˜¯å±…ä¸­çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å®ç°å±…ä¸­æ•ˆæœï¼Œå¦‚æœ Center çš„å°ºå¯¸æ²¡æœ‰å—åˆ°é™åˆ¶ï¼Œé‚£ä¹ˆå®ƒå°†å……æ»¡æ•´ä¸ªå±å¹•</p><h4 id="2-4-1ã€å±æ€§"><a href="#2-4-1ã€å±æ€§" class="headerlink" title="2.4.1ã€å±æ€§"></a>2.4.1ã€å±æ€§</h4><p>Center æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> Center(&#123; Key? key, <span class="hljs-built_in">double?</span> widthFactor, <span class="hljs-built_in">double?</span> heightFactor, Widget? child &#125;)<br>    : <span class="hljs-keyword">super</span>(key: key, widthFactor: widthFactor, heightFactor: heightFactor, child: child);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>child</td><td>é…ç½®å±…ä¸­æ˜¾ç¤ºçš„å­ Widget</td></tr></tbody></table><h3 id="2-5ã€Container"><a href="#2-5ã€Container" class="headerlink" title="2.5ã€Container"></a>2.5ã€Container</h3><p>Container æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¤šåŠŸèƒ½ Widgetï¼Œå¦‚æœå­ Widget éœ€è¦ä¸€äº›èƒŒæ™¯æ ·å¼ã€å½¢çŠ¶ã€å°ºå¯¸é™åˆ¶ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ Container æ¥è¿›è¡ŒåŒ…è£¹ï¼Œä¸Šé¢çš„åœ†å½¢å›¾åƒå°±æ˜¯ä½¿ç”¨ Container æ¥å®ç°çš„</p><h4 id="2-5-1ã€å±æ€§"><a href="#2-5-1ã€å±æ€§" class="headerlink" title="2.5.1ã€å±æ€§"></a>2.5.1ã€å±æ€§</h4><p>Container æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs dart">Container(&#123;<br>    Key? key,<br>    <span class="hljs-keyword">this</span>.alignment,<br>    <span class="hljs-keyword">this</span>.padding,<br>    <span class="hljs-keyword">this</span>.color,<br>    <span class="hljs-keyword">this</span>.decoration,<br>    <span class="hljs-keyword">this</span>.foregroundDecoration,<br>    <span class="hljs-built_in">double?</span> width,<br>    <span class="hljs-built_in">double?</span> height,<br>    BoxConstraints? constraints,<br>    <span class="hljs-keyword">this</span>.margin,<br>    <span class="hljs-keyword">this</span>.transform,<br>    <span class="hljs-keyword">this</span>.transformAlignment,<br>    <span class="hljs-keyword">this</span>.child,<br>    <span class="hljs-keyword">this</span>.clipBehavior = Clip.none,<br>  &#125;) : <span class="hljs-keyword">assert</span>(margin == <span class="hljs-keyword">null</span> || margin.isNonNegative),<br>       <span class="hljs-keyword">assert</span>(padding == <span class="hljs-keyword">null</span> || padding.isNonNegative),<br>       <span class="hljs-keyword">assert</span>(decoration == <span class="hljs-keyword">null</span> || decoration.debugAssertIsValid()),<br>       <span class="hljs-keyword">assert</span>(constraints == <span class="hljs-keyword">null</span> || constraints.debugAssertIsValid()),<br>       <span class="hljs-keyword">assert</span>(clipBehavior != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(decoration != <span class="hljs-keyword">null</span> || clipBehavior == Clip.none),<br>       <span class="hljs-keyword">assert</span>(color == <span class="hljs-keyword">null</span> || decoration == <span class="hljs-keyword">null</span>,<br>         <span class="hljs-string">&#x27;Cannot provide both a color and a decoration\n&#x27;</span><br>         <span class="hljs-string">&#x27;To provide both, use &quot;decoration: BoxDecoration(color: color)&quot;.&#x27;</span>,<br>       ),<br>       constraints =<br>        (width != <span class="hljs-keyword">null</span> || height != <span class="hljs-keyword">null</span>)<br>          ? constraints?.tighten(width: width, height: height)<br>            ?? BoxConstraints.tightFor(width: width, height: height)<br>          : constraints,<br>       <span class="hljs-keyword">super</span>(key: key);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>child</td><td>é…ç½®æ˜¾ç¤ºçš„å­ Widget</td></tr><tr><td>color</td><td>é…ç½® Container èƒŒæ™¯é¢œè‰²</td></tr><tr><td>width</td><td>é…ç½® Container æ˜¾ç¤ºçš„å®½åº¦</td></tr><tr><td>height</td><td>é…ç½® Container æ˜¾ç¤ºçš„é«˜åº¦</td></tr><tr><td>alignment</td><td>é…ç½®å­ Widget çš„å¯¹é½æ–¹å¼</td></tr><tr><td>padding</td><td>é…ç½® Container å…§è¾¹è·</td></tr><tr><td>decoration</td><td>é…ç½® Container è£…é¥°</td></tr></tbody></table><p>decoration æ¥æ”¶ä¸€ä¸ª Decoration ç±»å‹çš„å‚æ•°ï¼Œå…¶å®ç°ç±»ï¼šBoxDecorationï¼ŒBoxDecoration çš„å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>color</td><td>é…ç½® Container èƒŒæ™¯é¢œè‰²</td></tr><tr><td>border</td><td>é…ç½® Container æ˜¾ç¤ºçš„è¾¹æ¡†</td></tr><tr><td>borderRadius</td><td>é…ç½® Container æ˜¾ç¤ºçš„åœ†è§’</td></tr></tbody></table><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœ BoxDecoration è®¾ç½®äº† color å±æ€§ï¼Œå°±ä¸èƒ½è®¾ç½® Container çš„ color å±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œæ­¤æ—¶åœ¨ BoxDecoration ä¸­è®¾ç½® color å³å¯</p><p>Container æ›´å¤šå±æ€§ä»‹ç»ï¼š<a href="https://www.liujunmin.com/flutter/container.html">https://www.liujunmin.com/flutter/container.html</a></p><h3 id="2-6ã€Text"><a href="#2-6ã€Text" class="headerlink" title="2.6ã€Text"></a>2.6ã€Text</h3><p>Text æ˜¯ Flutter ç»™æˆ‘ä»¬æä¾›çš„æ–‡æœ¬ Widgetï¼Œæœ€å¸¸ç”¨çš„ Widget ä¹‹ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å®ç°å„ç§æ–‡æœ¬æ•ˆæœ</p><h4 id="2-6-1ã€å±æ€§"><a href="#2-6-1ã€å±æ€§" class="headerlink" title="2.6.1ã€å±æ€§"></a>2.6.1ã€å±æ€§</h4><p>Text æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> Text(<br>    <span class="hljs-built_in">String</span> <span class="hljs-keyword">this</span>.data, &#123;<br>    Key? key,<br>    <span class="hljs-keyword">this</span>.style,<br>    <span class="hljs-keyword">this</span>.strutStyle,<br>    <span class="hljs-keyword">this</span>.textAlign,<br>    <span class="hljs-keyword">this</span>.textDirection,<br>    <span class="hljs-keyword">this</span>.locale,<br>    <span class="hljs-keyword">this</span>.softWrap,<br>    <span class="hljs-keyword">this</span>.overflow,<br>    <span class="hljs-keyword">this</span>.textScaleFactor,<br>    <span class="hljs-keyword">this</span>.maxLines,<br>    <span class="hljs-keyword">this</span>.semanticsLabel,<br>    <span class="hljs-keyword">this</span>.textWidthBasis,<br>    <span class="hljs-keyword">this</span>.textHeightBehavior,<br>  &#125;) : <span class="hljs-keyword">assert</span>(<br>         data != <span class="hljs-keyword">null</span>,<br>         <span class="hljs-string">&#x27;A non-null String must be provided to a Text widget.&#x27;</span>,<br>       ),<br>       textSpan = <span class="hljs-keyword">null</span>,<br>       <span class="hljs-keyword">super</span>(key: key);<br></code></pre></td></tr></table></figure><p>TextStyle æ„é€ æ–¹æ³•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> TextStyle(&#123;<br>    <span class="hljs-keyword">this</span>.inherit = <span class="hljs-keyword">true</span>,<br>    <span class="hljs-keyword">this</span>.color,<br>    <span class="hljs-keyword">this</span>.backgroundColor,<br>    <span class="hljs-keyword">this</span>.fontSize,<br>    <span class="hljs-keyword">this</span>.fontWeight,<br>    <span class="hljs-keyword">this</span>.fontStyle,<br>    <span class="hljs-keyword">this</span>.letterSpacing,<br>    <span class="hljs-keyword">this</span>.wordSpacing,<br>    <span class="hljs-keyword">this</span>.textBaseline,<br>    <span class="hljs-keyword">this</span>.height,<br>    <span class="hljs-keyword">this</span>.leadingDistribution,<br>    <span class="hljs-keyword">this</span>.locale,<br>    <span class="hljs-keyword">this</span>.foreground,<br>    <span class="hljs-keyword">this</span>.background,<br>    <span class="hljs-keyword">this</span>.shadows,<br>    <span class="hljs-keyword">this</span>.fontFeatures,<br>    <span class="hljs-keyword">this</span>.decoration,<br>    <span class="hljs-keyword">this</span>.decorationColor,<br>    <span class="hljs-keyword">this</span>.decorationStyle,<br>    <span class="hljs-keyword">this</span>.decorationThickness,<br>    <span class="hljs-keyword">this</span>.debugLabel,<br>    <span class="hljs-built_in">String?</span> fontFamily,<br>    <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">String</span>&gt;? fontFamilyFallback,<br>    <span class="hljs-built_in">String?</span> package,<br>    <span class="hljs-keyword">this</span>.overflow,<br>  &#125;) : fontFamily = package == <span class="hljs-keyword">null</span> ? fontFamily : <span class="hljs-string">&#x27;packages/<span class="hljs-subst">$package</span>/<span class="hljs-subst">$fontFamily</span>&#x27;</span>,<br>       _fontFamilyFallback = fontFamilyFallback,<br>       _package = package,<br>       <span class="hljs-keyword">assert</span>(inherit != <span class="hljs-keyword">null</span>),<br>       <span class="hljs-keyword">assert</span>(color == <span class="hljs-keyword">null</span> || foreground == <span class="hljs-keyword">null</span>, _kColorForegroundWarning),<br>       <span class="hljs-keyword">assert</span>(backgroundColor == <span class="hljs-keyword">null</span> || background == <span class="hljs-keyword">null</span>, _kColorBackgroundWarning);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>data</td><td>é…ç½® Text è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ï¼Œå¿…é¡»é…ç½®</td></tr><tr><td>maxLines</td><td>é…ç½® Text èƒ½æ˜¾ç¤ºçš„æœ€å¤§è¡Œæ•°</td></tr><tr><td>overflow</td><td>é…ç½® Text æ–‡å­—è¶…å‡ºå±å¹•åçš„å¤„ç†æ–¹å¼ï¼ˆclipï¼šè£å‰ªï¼Œfadeï¼šæ¸éšï¼Œellipsisï¼šâ€¦çœç•¥ï¼‰</td></tr><tr><td>style</td><td>é…ç½® Text æ˜¾ç¤ºçš„æ ·å¼</td></tr></tbody></table><p>style æ¥æ”¶ä¸€ä¸ª TextStyle ç±»å‹çš„å‚æ•°ï¼Œå®ƒçš„å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>fontSize</td><td>é…ç½® Text æ˜¾ç¤ºçš„å­—ä½“å¤§å°</td></tr><tr><td>fontWeight</td><td>é…ç½® Text æ˜¾ç¤ºçš„å­—ä½“ç²—ç»†ï¼ˆboldï¼šç²—ä½“ï¼Œnormalï¼šæ­£å¸¸ä½“ï¼‰</td></tr><tr><td>color</td><td>é…ç½® Text æ˜¾ç¤ºçš„æ–‡å­—é¢œè‰²</td></tr><tr><td>decoration</td><td>é…ç½® text æ˜¾ç¤ºçš„è£…é¥°çº¿ï¼ˆnoneï¼šæ²¡æœ‰çº¿ï¼ŒlineThroughï¼šåˆ é™¤çº¿ï¼Œoverlineï¼šä¸Šåˆ’çº¿ï¼Œunderlineï¼šä¸‹åˆ’çº¿ï¼‰</td></tr><tr><td>decorationColor</td><td>é…ç½® Text æ˜¾ç¤ºçš„è£…é¥°çº¿é¢œè‰²</td></tr><tr><td>decorationStyle</td><td>é…ç½® Text æ˜¾ç¤ºçš„è£…é¥°çº¿é£æ ¼ï¼ˆdashedï¼šé•¿è™šçº¿ï¼Œdottedï¼šç‚¹è™šçº¿ï¼Œdoubleï¼šä¸¤æ ¹çº¿ï¼Œsolidï¼šä¸€æ ¹å®çº¿ï¼Œwavyï¼šæ³¢æµªçº¿ï¼‰</td></tr><tr><td>wordSpacing</td><td>é…ç½® Text æ˜¾ç¤ºçš„å•è¯é—´éš™</td></tr><tr><td>letterSpacing</td><td>é…ç½® Text æ˜¾ç¤ºçš„å­—æ¯é—´éš™</td></tr><tr><td>fontStyle</td><td>é…ç½® Text æ˜¾ç¤ºçš„æ–‡å­—æ ·å¼ï¼ˆitalicï¼šæ–œä½“ï¼Œnormalï¼šæ­£å¸¸ä½“ï¼‰</td></tr></tbody></table><p>Text æ›´å¤šå±æ€§ä»‹ç»ï¼š<a href="https://juejin.cn/post/6844903724846972942">https://juejin.cn/post/6844903724846972942</a></p><p>ä¸Šé¢ä»‹ç»çš„ Widget å°±å¯ä»¥å®ç°æ•ˆæœå›¾äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹å®ƒå§</p><h2 id="ä¸‰ã€æ•ˆæœå›¾å®ç°"><a href="#ä¸‰ã€æ•ˆæœå›¾å®ç°" class="headerlink" title="ä¸‰ã€æ•ˆæœå›¾å®ç°"></a>ä¸‰ã€æ•ˆæœå›¾å®ç°</h2><p>ä¸€ä¸ªæ¸…æ™°çš„æ€è·¯å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å…ˆæ‹ä¸€æ‹ï¼š</p><p>1ã€ä½¿ç”¨ MaterialApp å’Œ Scaffold æ­å»ºé¡µé¢çš„åŸºæœ¬æ¡†æ¶</p><p>2ã€ä½¿ç”¨ AppBar å®ç°å¸¦é˜´å½±çš„é¡¶éƒ¨æ ‡é¢˜æ </p><p>3ã€ä½¿ç”¨ Center åµŒå¥—ä¸€ä¸ª Container å±…ä¸­æ˜¾ç¤ºï¼Œç„¶åé€šè¿‡ Container å±æ€§é…ç½®å°† Container è®¾ç½®ä¸ºå¸¦çº¢è‰²è¾¹æ¡†çš„åœ†å½¢å›¾åƒï¼ŒContainer åµŒå¥—ä¸€ä¸ª Text ï¼Œåœ¨å¯¹ Text è¿›è¡Œå±æ€§é…ç½®å³å¯</p><p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Widget Learning&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: Center(<br>        child: Container( <span class="hljs-comment">// Center åµŒå¥—ä¸€ä¸ª Container</span><br>          width: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½® Container å®½åº¦ä¸º 300</span><br>          height: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½® Container é«˜åº¦ä¸º 300</span><br>          alignment: Alignment.center, <span class="hljs-comment">//è®¾ç½®å­ Widget å±…ä¸­</span><br>          padding: EdgeInsets.all(<span class="hljs-number">20</span>), <span class="hljs-comment">//è®¾ç½® Container å…§è¾¹è·ä¸º 20</span><br>          decoration: BoxDecoration( <span class="hljs-comment">//è®¾ç½® Container è£…é¥°</span><br>            color: Colors.blue, <span class="hljs-comment">//è®¾ç½® Container èƒŒæ™¯é¢œè‰²ä¸ºè“è‰²</span><br>            border: Border.all(<br>              color: Colors.red, <span class="hljs-comment">//è®¾ç½® Container è¾¹æ¡†é¢œè‰²ä¸ºçº¢è‰²</span><br>              width: <span class="hljs-number">2</span> <span class="hljs-comment">//è®¾ç½® Container è¾¹æ¡†çš„å®½åº¦ä¸º 2</span><br>            ),<br>            borderRadius: BorderRadius.all(Radius.circular(<span class="hljs-number">200</span>)), <span class="hljs-comment">//è®¾ç½® Container çš„å½¢çŠ¶ä¸ºä¸€ä¸ªåœ†å½¢</span><br>          ),<br>          child: Text( <span class="hljs-comment">//Container åµŒå¥—ä¸€ä¸ª Text</span><br>            <span class="hljs-string">&quot;Hello erdai str&quot;</span>, <span class="hljs-comment">// è®¾ç½® Text è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²</span><br>            maxLines: <span class="hljs-number">1</span>, <span class="hljs-comment">//è®¾ç½® Text æœ€å¤§æ˜¾ç¤ºä¸€è¡Œ</span><br>            overflow: TextOverflow.ellipsis, <span class="hljs-comment">//è®¾ç½® Text æ–‡æœ¬è¶…è¿‡ä¸€è¡Œ ... æ˜¾ç¤º</span><br>            style: TextStyle( <span class="hljs-comment">//é…ç½® Text æ ·å¼</span><br>                fontSize: <span class="hljs-number">28</span>, <span class="hljs-comment">//è®¾ç½® Text çš„å­—ä½“å¤§å°ä¸º 28</span><br>                fontWeight: FontWeight.bold, <span class="hljs-comment">//è®¾ç½® Text æ˜¾ç¤ºä¸ºç²—ä½“</span><br>                color: Colors.white, <span class="hljs-comment">//è®¾ç½® Text æ–‡å­—é¢œè‰²ä¸ºç™½è‰²</span><br>                decoration: TextDecoration.lineThrough, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿</span><br>                decorationColor: Colors.red, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿é¢œè‰²ä¸ºçº¢è‰²</span><br>                decorationStyle: TextDecorationStyle.dashed, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿ä¸ºè™šçº¿</span><br>                wordSpacing: <span class="hljs-number">20</span>, <span class="hljs-comment">//è®¾ç½® Text å•è¯ä¹‹é—´é—´è·ä¸º 20</span><br>                letterSpacing: <span class="hljs-number">6</span>, <span class="hljs-comment">//è®¾ç½® Text å­—æ¯é—´è·ä¸º 6</span><br>                fontStyle: FontStyle.italic <span class="hljs-comment">//è®¾ç½® Text å­—ä½“æ ·å¼ä¸ºæ–œä½“</span><br>            ),<br>          ),<br>        ),<br>      ),<br>    ),<br>  ));<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å°±å®ç°äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹ç‚¹ç‘•ç–µï¼Œé‚£å°±æ˜¯ä»£ç éƒ½å†™åœ¨ main æ–¹æ³•ä¸­ï¼Œå¯¼è‡´ main æ–¹æ³•æ¯”è¾ƒè‡ƒè‚¿ï¼Œé‚£æ˜¯å¦æœ‰åŠæ³•å¯¹ main æ–¹æ³•ä¸­çš„é€»è¾‘è¿›è¡ŒæŠ½ç¦»å‘¢ï¼Ÿ</p><p>ç­”ï¼šæœ‰çš„ï¼Œè‡ªå®šä¹‰ Widget å¯¹ main æ–¹æ³•é€»è¾‘è¿›è¡ŒæŠ½ç¦»ä¼˜åŒ–</p><h2 id="å››ã€è‡ªå®šä¹‰-Widget"><a href="#å››ã€è‡ªå®šä¹‰-Widget" class="headerlink" title="å››ã€è‡ªå®šä¹‰ Widget"></a>å››ã€è‡ªå®šä¹‰ Widget</h2><p>ä¸Šé¢è®²è¿‡ï¼Œè‡ªå®šä¹‰ Widget å…ˆè¦å¯¹ Widget çš„çŠ¶æ€è¿›è¡Œåˆ¤æ–­ï¼Œæˆ‘ä»¬è¿™é‡Œæ— éœ€ç”¨æˆ·äº¤äº’ä»¥åŠå…¶ä»–å› ç´ è¿›è¡Œæ›´æ”¹ï¼Œå› æ­¤æ˜¯æ— çŠ¶æ€çš„ï¼Œç»§æ‰¿ StatelessWidget å³å¯</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ body éƒ¨åˆ†çš„é€»è¾‘è¿›è¡ŒæŠ½ç¦»ï¼Œå°è£…ä¸ºä¸€ä¸ªè‡ªå®šä¹‰ Widgetï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBodyPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> Center(<br>      child: Container( <span class="hljs-comment">// Center åµŒå¥—ä¸€ä¸ª Container</span><br>        width: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½® Container å®½åº¦ä¸º 300</span><br>        height: <span class="hljs-number">300</span>, <span class="hljs-comment">//è®¾ç½® Container é«˜åº¦ä¸º 300</span><br>        alignment: Alignment.center, <span class="hljs-comment">//è®¾ç½®å­ Widget å±…ä¸­</span><br>        padding: EdgeInsets.all(<span class="hljs-number">20</span>), <span class="hljs-comment">//è®¾ç½® Container å…§è¾¹è·ä¸º 20</span><br>        decoration: BoxDecoration( <span class="hljs-comment">//è®¾ç½® Container è£…é¥°</span><br>          color: Colors.blue, <span class="hljs-comment">//è®¾ç½® Container èƒŒæ™¯é¢œè‰²ä¸ºè“è‰²</span><br>          border: Border.all(<br>              color: Colors.red, <span class="hljs-comment">//è®¾ç½® Container è¾¹æ¡†é¢œè‰²ä¸ºçº¢è‰²</span><br>              width: <span class="hljs-number">2</span> <span class="hljs-comment">//è®¾ç½® Container è¾¹æ¡†çš„å®½åº¦ä¸º 2</span><br>          ),<br>          borderRadius: BorderRadius.all(Radius.circular(<span class="hljs-number">200</span>)), <span class="hljs-comment">//è®¾ç½® Container çš„å½¢çŠ¶ä¸ºä¸€ä¸ªåœ†å½¢</span><br>        ),<br>        child: Text( <span class="hljs-comment">//Container åµŒå¥—ä¸€ä¸ª Text</span><br>          <span class="hljs-string">&quot;Hello erdai str&quot;</span>, <span class="hljs-comment">// è®¾ç½® Text è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²</span><br>          maxLines: <span class="hljs-number">1</span>, <span class="hljs-comment">//è®¾ç½® Text æœ€å¤§æ˜¾ç¤ºä¸€è¡Œ</span><br>          overflow: TextOverflow.ellipsis, <span class="hljs-comment">//è®¾ç½® Text æ–‡æœ¬è¶…è¿‡ä¸€è¡Œ ... æ˜¾ç¤º</span><br>          style: TextStyle( <span class="hljs-comment">//é…ç½® Text æ ·å¼</span><br>              fontSize: <span class="hljs-number">28</span>, <span class="hljs-comment">//è®¾ç½® Text çš„å­—ä½“å¤§å°ä¸º 28</span><br>              fontWeight: FontWeight.bold, <span class="hljs-comment">//è®¾ç½® Text æ˜¾ç¤ºä¸ºç²—ä½“</span><br>              color: Colors.white, <span class="hljs-comment">//è®¾ç½® Text æ–‡å­—é¢œè‰²ä¸ºç™½è‰²</span><br>              decoration: TextDecoration.lineThrough, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿</span><br>              decorationColor: Colors.red, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿é¢œè‰²ä¸ºçº¢è‰²</span><br>              decorationStyle: TextDecorationStyle.dashed, <span class="hljs-comment">//è®¾ç½® Text åˆ é™¤çº¿ä¸ºè™šçº¿</span><br>              wordSpacing: <span class="hljs-number">20</span>, <span class="hljs-comment">//è®¾ç½® Text å•è¯ä¹‹é—´é—´è·ä¸º 20</span><br>              letterSpacing: <span class="hljs-number">6</span>, <span class="hljs-comment">//è®¾ç½® Text å­—æ¯é—´è·ä¸º 6</span><br>              fontStyle: FontStyle.italic <span class="hljs-comment">//è®¾ç½® Text å­—ä½“æ ·å¼ä¸ºæ–œä½“</span><br>          ),<br>        ),<br>      ),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®åˆ™å°±æ˜¯å°† body éƒ¨åˆ†çš„ä»£ç ç§»è¿‡æ¥ğŸ˜‚ï¼ŒæŒæ¡è‡ªå®šä¹‰ Widget çš„æ€è·¯å³å¯ï¼Œé‚£ä¹ˆ main æ–¹æ³•çš„ä»£ç å°±ç®€åŒ–äº†å¾ˆå¤šï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  runApp(MaterialApp(<br>    home: Scaffold(<br>      appBar: AppBar(<br>        title: Text(<span class="hljs-string">&quot;Flutter Widget Learning&quot;</span>),<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ æ ‡é¢˜</span><br>        elevation: <span class="hljs-number">30</span>,<span class="hljs-comment">//è®¾ç½®æ ‡é¢˜æ é˜´å½±</span><br>      ),<br>      body: MyBodyPage() <span class="hljs-comment">//è‡ªå®šä¹‰ Widget</span><br>    ),<br>  ));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬æ–‡é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€Flutter çš„ç‰¹ç‚¹ï¼Œäº†è§£å®ƒï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„å­¦ä¹  Flutter</p><p>2ã€ä»‹ç»äº†å®ç°æ•ˆæœå›¾ç”¨åˆ°çš„ Widgetï¼šMaterialAppï¼ŒScaffoldï¼ŒAppBarï¼ŒCenterï¼ŒContainerï¼ŒText</p><p>3ã€å­¦ä¹  Widget å®åˆ™å°±æ˜¯è¦é‡ç‚¹æŒæ¡å®ƒæœ‰å“ªäº›å±æ€§ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼šæŒæ¡å¸¸ç”¨çš„ï¼Œå…¶å®ƒçš„ç”¨åˆ°æ—¶æŸ¥çœ‹æºç å³<br>å¯ã€‚å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šå½“ä½ ä¸çŸ¥é“å±æ€§æ€ä¹ˆèµ‹å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŸ¥çœ‹æºç äº†è§£å±æ€§çš„ç±»å‹ï¼Œç„¶åè¿›è¡Œç›¸åº”çš„èµ‹å€¼</p><p>4ã€ä»‹ç»äº†è‡ªå®šä¹‰å±æ€§ï¼Œæ ¹æ®çŠ¶æ€åˆ¤æ–­æ˜¯ç»§æ‰¿ StatelessWidget è¿˜æ˜¯ StatefulWidget</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>Flutter Widget æœ‰å¾ˆå¤šï¼Œä»Šå¤©æˆ‘ä»¬åªæ˜¯å­¦ä¹ äº†ç®€å•çš„å‡ ä¸ªï¼Œæ¥ä¸‹æ¥æˆ‘è¿˜ä¼šç»§ç»­å¯¹ Flutter Widget è¿›è¡Œä»‹ç»</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://www.bilibili.com/video/BV1S4411E7LY?p=19&vd_source=d0b24cb21c438ff4a9ac2e589eacb3d9">Flutter æ•™ç¨‹</a>ï¼šé€šä¿—æ˜“æ‡‚çš„ Flutter å…¥é—¨æ•™ç¨‹</p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šDart è¯­æ³•ç­‘åŸº</title>
    <link href="/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9ADart%20%E8%AF%AD%E6%B3%95%E7%AD%91%E5%9F%BA/"/>
    <url>/2022/10/10/Flutter%20%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9ADart%20%E8%AF%AD%E6%B3%95%E7%AD%91%E5%9F%BA/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0faab578ed4741edb81bf9b8d22b60c8~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>åœ¨æœ¬ç³»åˆ—çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Flutter å¼€å‘ç¯å¢ƒæ­å»ºï¼Œä»¥åŠä½¿ç”¨ AndroidStudio è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter é¡¹ç›®ï¼Œä½“éªŒäº†çƒ­é‡è½½ã€‚è¿˜æ²¡æœ‰çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„æœ‹å‹ï¼Œå»ºè®®å…ˆå»é˜…è¯»<a href="https://juejin.cn/post/7057420846863745031">Flutter ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šè¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter åº”ç”¨</a>ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼ŒDart åœ¨è®¾è®¡æ—¶åº”è¯¥æ˜¯å€Ÿé‰´äº†ç™¾å®¶è¯­è¨€ä¹‹æ‰€é•¿ğŸ˜„ï¼šJavaï¼ŒKotlinç­‰ï¼š</p><p>1ã€åœ¨é™æ€è¯­æ³•æ–¹é¢ï¼Œå¦‚ï¼šç±»å‹å®šä¹‰ï¼Œæ–¹æ³•å£°æ˜ï¼Œæ³›å‹ç­‰ï¼Œå’Œ Java éå¸¸ç›¸ä¼¼</p><p>2ã€ä¸€äº›è¯­æ³•ç‰¹æ€§ï¼Œå¦‚ï¼šå‡½æ•°å¼ç‰¹æ€§ï¼Œç©ºå®‰å…¨ï¼Œå‡½æ•°é»˜è®¤å€¼ç­‰ï¼Œå’Œ Kotlin éå¸¸ç›¸ä¼¼</p><p>3ã€Dart è¿˜æœ‰ä¸€äº›è‡ªå·±ç‹¬åˆ›çš„è¯­æ³•ï¼Œå¦‚ï¼šå‘½åæ„é€ æ–¹æ³•ï¼Œçº§è”æ“ä½œç¬¦ç­‰</p><p>æ€»ä¹‹ï¼Œç†Ÿæ‚‰ä¹‹åï¼Œä½ ä¼šå‘ç° Dart æ˜¯ä¸€é—¨éå¸¸æœ‰æ„æ€çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€èµ·è¿›å…¥ Dart çš„è¯­æ³•å­¦ä¹ å§</p><p><strong>æ³¨æ„</strong>ï¼š Dart è¯­æ³•å’Œ Javaï¼ŒKotlin çœŸçš„å¾ˆåƒï¼Œå°¤å…¶æ˜¯ Javaã€‚å¦å¤–å¦‚æœå¯¹ Kotlin è¯­æ³•ä¸ç†Ÿçš„ï¼Œå¯ä»¥å»çœ‹æˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/6942251919662383134">â€œKotlinâ€ç³»åˆ—: ä¸€ã€Kotlinå…¥é—¨</a></p><h2 id="ä¸€ã€å˜é‡å’Œæ–¹æ³•"><a href="#ä¸€ã€å˜é‡å’Œæ–¹æ³•" class="headerlink" title="ä¸€ã€å˜é‡å’Œæ–¹æ³•"></a>ä¸€ã€å˜é‡å’Œæ–¹æ³•</h2><h3 id="1-1ã€å˜é‡"><a href="#1-1ã€å˜é‡" class="headerlink" title="1.1ã€å˜é‡"></a>1.1ã€å˜é‡</h3><p>1ï¼‰ã€Dart å¯ä»¥æ˜¾ç¤ºæŒ‡æ˜ç±»å‹æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ã€‚ä¸”æŒ‡æ˜çš„ç±»å‹åˆ†ä¸ºå¯ç©ºå’Œéç©º</p><p>2ï¼‰ã€Dart ä¹Ÿå¯ä»¥ä½¿ç”¨ var å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¼šæ ¹æ®å˜é‡åˆå§‹å€¼è‡ªåŠ¨æ¨æ–­ç±»å‹</p><p>3ï¼‰ã€Dart ä½¿ç”¨ final å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ï¼Œä¸”å¯ä»¥æ›¿ä»£ var æˆ–åŠ åœ¨ç±»å‹å‰é¢</p><p>4ï¼‰ã€Dart ä¸­å˜é‡å¦‚æœæ˜¯éç©ºç±»å‹ï¼Œé‚£ä¹ˆå¿…é¡»ç»™ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå¦åˆ™æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚å¦‚æœæ˜¯å¯ç©ºç±»å‹ï¼Œé»˜è®¤å€¼éƒ½ä¸º null</p><p>5ï¼‰ã€Dart ä¸­æ¯ä¸€è¡Œä»£ç éƒ½è¦åŠ  ; ğŸ˜‚ï¼Œèµ°å›å¤´è·¯äº†ï¼Œæœ‰ç‚¹é¸¡è‚‹</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Dart å¯ä»¥æ˜¾ç¤ºæŒ‡æ˜ç±»å‹æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ã€‚ä¸”æŒ‡æ˜çš„ç±»å‹åˆ†ä¸ºå¯ç©ºå’Œéç©º</span><br><span class="hljs-comment">//1.1ã€ç±»æ¯” Javaï¼Œæ˜¾ç¤ºæŒ‡æ˜ç±»å‹æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡</span><br><span class="hljs-comment">//dart å†™æ³•ï¼š</span><br><span class="hljs-built_in">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-built_in">bool</span> b = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//Java å†™æ³•</span><br><span class="hljs-built_in">int</span> a = <span class="hljs-number">10</span>;<br>boolean b = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//1.2ã€æŒ‡æ˜çš„ç±»å‹åˆ†ä¸ºå¯ç©ºå’Œéç©º</span><br><span class="hljs-comment">//dart å†™æ³•</span><br><span class="hljs-built_in">int?</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-built_in">bool?</span> b = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//kotlin å†™æ³•</span><br><span class="hljs-keyword">var</span> a: Int? = <span class="hljs-number">10</span><br><span class="hljs-keyword">var</span> b: Boolean? = <span class="hljs-keyword">true</span><br>  <br><span class="hljs-comment">//2ã€Dart ä¹Ÿå¯ä»¥ä½¿ç”¨ var å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå¯å˜çš„å˜é‡ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¼šæ ¹æ®å˜é‡åˆå§‹å€¼è‡ªåŠ¨æ¨æ–­ç±»å‹</span><br><span class="hljs-comment">//dart å†™æ³•</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">var</span> b = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//kotlin å†™æ³•</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span><br><span class="hljs-keyword">var</span> b = <span class="hljs-keyword">true</span><br>  <br><span class="hljs-comment">//3ã€Dart ä½¿ç”¨ final å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ï¼Œä¸”å¯ä»¥æ›¿ä»£ var æˆ–åŠ åœ¨ç±»å‹å‰é¢</span><br><span class="hljs-comment">//dart å†™æ³•</span><br><span class="hljs-keyword">final</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> aa = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">final</span> b = <span class="hljs-keyword">true</span>;<br><span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> bb = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//Java å†™æ³•</span><br><span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">final</span> boolean b = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//5ã€Dart ä¸­å˜é‡å¦‚æœæ˜¯éç©ºç±»å‹ï¼Œé‚£ä¹ˆå¿…é¡»ç»™ä¸€ä¸ªé»˜è®¤å€¼ã€‚å¦‚æœæ˜¯å¯ç©ºç±»å‹ï¼Œé»˜è®¤å€¼éƒ½ä¸º null</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-built_in">String</span> s = <span class="hljs-string">&quot;erdai&quot;</span>;<br>  <span class="hljs-built_in">int?</span> i;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$s</span> <span class="hljs-subst">$i</span>&#x27;</span>); <span class="hljs-comment">//æ‰“å°ç»“æœï¼šerdai null</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å°å»ºè®®</strong>ï¼šå®šä¹‰å˜é‡ï¼Œä¼˜å…ˆä½¿ç”¨è‡ªåŠ¨æ¨æ–­ï¼Œæ¥è‡ª Dart å®˜æ–¹çš„å»ºè®®</p><p><strong>æ³¨æ„</strong>ï¼š Dart å®Œå…¨æŠ›å¼ƒäº† Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¨éƒ¨éƒ½æ˜¯å¯¹è±¡æ•°æ®ç±»å‹</p><p>5ï¼‰ã€Dart ä¸­è¿˜å¯ä»¥ä½¿ç”¨ Object å’Œ dynamic å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå˜é‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Dart ä¸­è¿˜å¯ä»¥ä½¿ç”¨ Object å’Œ dynamic å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå˜é‡</span><br><span class="hljs-comment">//1.1ã€Object å£°æ˜å˜é‡ï¼Œè¿™ä¸€ç‚¹å’Œ Java æ²¡ä»»ä½•åŒºåˆ«</span><br><span class="hljs-built_in">Object</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-built_in">Object</span> b = <span class="hljs-keyword">true</span>;<br><span class="hljs-built_in">Object</span> str = <span class="hljs-string">&quot;erdai666&quot;</span>;<br><br><span class="hljs-comment">//1.2ã€dynamic å£°æ˜å˜é‡ï¼Œè¿™ä¸€ç‚¹æ˜¯ Java æ‰€æ²¡æœ‰çš„</span><br><span class="hljs-built_in">dynamic</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-built_in">dynamic</span> b = <span class="hljs-keyword">true</span>;<br><span class="hljs-built_in">dynamic</span> str = <span class="hljs-string">&quot;erdai666&quot;</span>;<br></code></pre></td></tr></table></figure><p>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šObject å’Œ dynamic æœ‰å•¥åŒºåˆ«å‘¢ï¼ŸğŸ¤”ï¸</p><p>ç­”ï¼šObject æ˜¯æ‰€æœ‰ç±»çš„åŸºç±»ï¼Œç›¸å½“äºä¸€ä¸ªå¯ä»¥å…¼å®¹æ‰€æœ‰ç±»å‹çš„è¶…çº§ç±»å‹ï¼Œè¿™ç‚¹å’Œ Java ç±»ä¼¼ã€‚dynamic å°±æ˜¯ä¸€ä¸ªå®šä¹‰åŠ¨æ€ç±»å‹çš„å…³é”®å­—</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å£°æ˜ä¸€ä¸ª Object ç±»å‹çš„å˜é‡è°ƒç”¨ substringï¼Œæ­¤æ—¶ä¼šç¼–è¯‘æŠ¥é”™ï¼Œå› ä¸º Object æ²¡æœ‰ substring æ–¹æ³•</span><br><span class="hljs-built_in">Object</span> str = <span class="hljs-string">&quot;erdai666&quot;</span>;<br>str.substring(<span class="hljs-number">1</span>); <span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™ï¼šThe method &#x27;substring&#x27; isn&#x27;t defined for the type &#x27;Object&#x27;.</span><br><br><span class="hljs-comment">//2ã€ä½¿ç”¨ dynamic å®šä¹‰ä¸€ä¸ªå˜é‡è°ƒç”¨ substringï¼Œæ­¤æ—¶å¯ä»¥ç»•è¿‡ç¼–è¯‘æ£€æŸ¥</span><br><span class="hljs-built_in">dynamic</span> str = <span class="hljs-string">&quot;erdai666&quot;</span>;<br>str.substring(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨ dynamic å®šä¹‰çš„å˜é‡è°ƒç”¨ç›¸å…³æŒ‡å®šç±»å‹ api æ—¶ï¼Œå› ä¸ºä¼šç»•è¿‡ç¼–è¯‘å™¨æ£€æŸ¥ï¼Œæ‰€ä»¥åˆ«å†™é”™äº†ï¼Œå¦åˆ™è¿è¡Œæ—¶å°±ä¼šæŠ¥æ‰¾ä¸åˆ°æ­¤ apiï¼Œå¦‚ä¸‹ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56018a16767142e28c710727a2e9fa39~tplv-k3u1fbpfcp-zoom-1.image" alt="img" width="100%" /><p>å¯ä»¥çœ‹åˆ°ï¼Œç¼–è¯‘å™¨æç¤ºï¼š String ç±»æ²¡æœ‰ subString æ–¹æ³•ã€‚å°±æ˜¯å› ä¸ºæˆ‘ä»¬ api å†™é”™äº†ï¼Œå°† substring å†™æˆäº† subString å¯¼è‡´çš„</p><h3 id="1-2ã€å¸¸é‡"><a href="#1-2ã€å¸¸é‡" class="headerlink" title="1.2ã€å¸¸é‡"></a>1.2ã€å¸¸é‡</h3><p>1ï¼‰ã€Dart ä½¿ç”¨ const å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå¸¸é‡</p><p>2ï¼‰ã€Dart å¯ä»¥ä½¿ç”¨ const å…³é”®å­—æ›¿ä»£ var æˆ–åŠ åœ¨ç±»å‹å‰é¢</p><p>3ï¼‰ã€Dart è¿˜å¯ä»¥ä½¿ç”¨ const å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªå¸¸é‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Dart ä½¿ç”¨ const å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªå¸¸é‡</span><br><span class="hljs-comment">//2ã€Dart å¯ä»¥ä½¿ç”¨ const å…³é”®å­—æ›¿ä»£ var æˆ–åŠ åœ¨ç±»å‹å‰é¢</span><br><span class="hljs-keyword">const</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">const</span> b = <span class="hljs-keyword">true</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> aa = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-built_in">bool</span> bb = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">//3ã€Dart è¿˜å¯ä»¥ä½¿ç”¨ const å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªå¸¸é‡</span><br><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå†…å®¹å’Œå¼•ç”¨éƒ½ä¸å¯å˜çš„ list æ•°ç»„</span><br><span class="hljs-keyword">var</span> list = <span class="hljs-keyword">const</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå†…å®¹å’Œå¼•ç”¨éƒ½ä¸å¯å˜çš„ set é›†åˆ</span><br><span class="hljs-keyword">var</span> <span class="hljs-keyword">set</span> = <span class="hljs-keyword">const</span> &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼šé‚£ const å’Œ final æœ‰å•¥å¼‚åŒå‘¢ï¼Ÿ</p><p>ç­”ï¼š</p><p>å¼‚ï¼š</p><p>1ã€final å¯ä»¥ä¸€å¼€å§‹ä¸èµ‹å€¼ï¼Œå¦‚æœèµ‹å€¼äº†åˆ™ä¸å¯å˜ã€‚const ä¸€å¼€å§‹å°±éœ€è¦èµ‹å€¼ä¸”ä¸å¯å˜</p><p>2ã€const å¿…é¡»ç»™ä¸€ä¸ªæ˜ç¡®çš„ç¼–è¯‘å¸¸é‡å€¼ï¼ˆå³ç¼–è¯‘æœŸé—´å°±ç¡®å®šçš„å€¼ï¼‰</p><p>3ã€final å¯ä»¥é€šè¿‡è®¡ç®—æˆ–è€…æ–¹æ³•è·å–ä¸€ä¸ªå€¼ï¼ˆå³è¿è¡ŒæœŸé—´ç¡®å®šçš„å€¼ï¼‰</p><p>4ã€final è¡¨ç¤ºå¼•ç”¨ä¸å¯å˜ï¼Œä½†å†…å®¹æ˜¯å¯å˜çš„ã€‚const è¡¨ç¤ºå†…å®¹å’Œå¼•ç”¨éƒ½ä¸å¯å˜</p><p>åŒï¼š</p><p>1ã€finalï¼Œconst å…³é”®å­—éƒ½å¯ä»¥ç”¨æ¥å®šä¹‰ä¸€ä¸ªå¸¸é‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€final å¯ä»¥ä¸€å¼€å§‹ä¸èµ‹å€¼ï¼Œå¦‚æœèµ‹å€¼äº†åˆ™ä¸å¯å˜ã€‚const ä¸€å¼€å§‹å°±éœ€è¦èµ‹å€¼ä¸”ä¸å¯å˜</span><br><span class="hljs-comment">//2ã€const å¿…é¡»ç»™ä¸€ä¸ªæ˜ç¡®çš„ç¼–è¯‘å¸¸é‡å€¼ï¼ˆå³ç¼–è¯‘æœŸé—´å°±ç¡®å®šçš„å€¼ï¼‰</span><br><span class="hljs-comment">//3ã€final å¯ä»¥é€šè¿‡è®¡ç®—/æ–¹æ³•è·å–ä¸€ä¸ªå€¼ï¼ˆå³è¿è¡ŒæœŸé—´ç¡®å®šçš„å€¼ï¼‰</span><br><br><span class="hljs-keyword">final</span> a;<span class="hljs-comment">//ç¼–è¯‘é€šè¿‡</span><br>a = <span class="hljs-number">10</span>;<span class="hljs-comment">//ç¼–è¯‘é€šè¿‡</span><br><br><span class="hljs-keyword">const</span> b;<span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™</span><br>b = <span class="hljs-number">10</span>;<span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™</span><br><br><span class="hljs-comment">//4ã€final è¡¨ç¤ºå¼•ç”¨ä¸å¯å˜ï¼Œä½†å†…å®¹æ˜¯å¯å˜çš„ã€‚const è¡¨ç¤ºå†…å®¹å’Œå¼•ç”¨éƒ½ä¸å¯å˜</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">set</span> = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;;<br><span class="hljs-keyword">set</span>.add(<span class="hljs-number">4</span>);<br><br><span class="hljs-keyword">var</span> list = <span class="hljs-keyword">const</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>list.add(<span class="hljs-number">4</span>);<span class="hljs-comment">//è¿è¡ŒæŠ¥é”™ï¼Œconst list ä¸å¯æ–°å¢å…ƒç´ </span><br></code></pre></td></tr></table></figure><h3 id="1-3ã€æ–¹æ³•"><a href="#1-3ã€æ–¹æ³•" class="headerlink" title="1.3ã€æ–¹æ³•"></a>1.3ã€æ–¹æ³•</h3><h4 id="1-3-1ã€æ–¹æ³•å®šä¹‰"><a href="#1-3-1ã€æ–¹æ³•å®šä¹‰" class="headerlink" title="1.3.1ã€æ–¹æ³•å®šä¹‰"></a>1.3.1ã€æ–¹æ³•å®šä¹‰</h4><p>1ï¼‰ã€æ–¹æ³•å’Œå‡½æ•°æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼Œåœ¨ Java ä¸­æˆ‘ä»¬ä¹ æƒ¯å«æ–¹æ³• (method)ã€‚åœ¨ Kotlin ä¸­æˆ‘ä»¬ä¹ æƒ¯å«å‡½æ•° (function)ã€‚å›  Dart æ›´åƒ Java ï¼Œå› æ­¤è¿™é‡Œå»ºè®®å¤§å®¶ä¹Ÿå«æ–¹æ³• (method)</p><p>2ï¼‰ã€æ–¹æ³•æ˜¯è¿è¡Œä»£ç çš„è½½ä½“ï¼Œåƒæˆ‘ä»¬ä½¿ç”¨è¿‡çš„ main æ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ–¹æ³•</p><p>Dart ä¸­å®šä¹‰æ–¹æ³•çš„è¯­æ³•è§„åˆ™ï¼š</p><blockquote><p>è¿”å›å‚æ•°ç±»å‹ æ–¹æ³•å(å‚æ•°1,å‚æ•°2,å‚æ•°3â€¦) {</p><p>æ–¹æ³•ä½“</p><p>}</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€Dart å†™æ³•1ï¼šæ–¹æ³•çš„å‚æ•°ä½¿ç”¨ï¼švar å‚æ•°å</span><br><span class="hljs-built_in">String</span> methodName(<span class="hljs-keyword">var</span> name,<span class="hljs-keyword">var</span> age)&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;erdai666&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">//2ã€Dart å†™æ³•2ï¼šæ–¹æ³•çš„å‚æ•°ä½¿ç”¨ï¼šç±»å‹ å‚æ•°å</span><br><span class="hljs-built_in">String</span> methodName(<span class="hljs-built_in">String</span> name,<span class="hljs-built_in">int</span> age)&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;erdai666&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">//3ã€Dart å†™æ³•3ï¼šæ–¹æ³•çš„è¿”å›ç±»å‹å¯çœç•¥ï¼Œæ ¹æ®æ–¹æ³•ä½“æœ€åä¸€è¡Œä»£ç è¿›è¡Œè¿”å›ç±»å‹æ¨æ–­</span><br>methodName(<span class="hljs-keyword">var</span> name,<span class="hljs-keyword">var</span> age)&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;erdai666&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">//4ã€å¦‚æœæ²¡æœ‰å†™è¿”å›ç±»å‹ï¼Œä¸”æ–¹æ³•ä½“æœ€åä¸€è¡Œä»£ç æ²¡æœ‰æ˜ç¡®å†™è¿”å›è¯­å¥ï¼Œé‚£ä¹ˆé»˜è®¤æ‰§è¡Œï¼šreturn null</span><br>methodName(<span class="hljs-keyword">var</span> name,<span class="hljs-keyword">var</span> age)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//5ã€Dart å†™æ³•4ï¼šæ— è¿”å›å€¼ä½¿ç”¨ void å…³é”®å­—</span><br><span class="hljs-keyword">void</span> methodName(<span class="hljs-keyword">var</span> name,<span class="hljs-keyword">var</span> age)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//6ã€Dart å†™æ³•5ï¼šå¦‚æœæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œè¡¨è¾¾å¼ï¼Œå¯å°†å…¶æ”¹æˆå•è¡Œæ–¹æ³•æ ·å¼ï¼Œæ–¹æ³•åå’Œæ–¹æ³•ä½“ç”¨ =&gt; è¿æ¥</span><br><span class="hljs-built_in">String</span> methodName(<span class="hljs-keyword">var</span> name,<span class="hljs-keyword">var</span> age) =&gt; <span class="hljs-string">&quot;erdai666&quot;</span>;<br></code></pre></td></tr></table></figure><p>æ–¹æ³•è¯­æ³•è§£é‡Šï¼š</p><ul><li><p>æ‰€æœ‰æ–¹æ³•éƒ½æœ‰è¿”å›å€¼ï¼Œå³ä½¿è¿”å›å€¼æ˜¯ void</p></li><li><p>æ–¹æ³•çš„è¿”å›ç±»å‹ï¼Œå¯å†™å¯ä¸å†™ã€‚å¦‚æœä¸å†™ï¼Œä¼šæ ¹æ®æ–¹æ³•ä½“é‡Œé¢æœ€åä¸€è¡Œä»£ç è¿›è¡Œç±»å‹æ¨æ–­</p></li><li><p>å¦‚æœæ²¡æœ‰å†™è¿”å›ç±»å‹ï¼Œä¸”æ–¹æ³•ä½“æœ€åä¸€è¡Œä»£ç æ²¡æœ‰æ˜ç¡®å†™è¿”å›è¯­å¥ï¼Œé‚£ä¹ˆé»˜è®¤æ‰§è¡Œï¼šreturn null</p></li><li><p>æ–¹æ³•åç§°å¯ä»¥éšä¾¿å–ï¼Œå°±åƒ Java ï¼ŒKotlin é‡Œé¢å®šä¹‰æ–¹æ³•åä¸€æ ·</p></li><li><p>æ–¹æ³•åé‡Œé¢çš„å‚æ•°å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼Œå‚æ•°çš„å£°æ˜æ ¼å¼æœ‰ä¸¤ç§ï¼š</p><blockquote><p>1ã€var å‚æ•°å</p><p>2ã€ç±»å‹ å‚æ•°å</p></blockquote></li></ul><!----><ul><li>å¦‚æœæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œè¡¨è¾¾å¼ï¼Œå¯å°†å…¶æ”¹æˆå•è¡Œæ–¹æ³•æ ·å¼ï¼Œæ–¹æ³•åå’Œæ–¹æ³•ä½“ç”¨ &#x3D;&gt; è¿æ¥</li></ul><p><strong>å°å»ºè®®</strong>ï¼šå®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå»ºè®®æŠŠè¿”å›ç±»å‹ç»™å†™å‡ºæ¥ï¼Œå¯è¯»æ€§å¼º</p><h4 id="1-3-2ã€å¯é€‰å‚æ•°-amp-å‘½åå‚æ•°-amp-é»˜è®¤å‚æ•°"><a href="#1-3-2ã€å¯é€‰å‚æ•°-amp-å‘½åå‚æ•°-amp-é»˜è®¤å‚æ•°" class="headerlink" title="1.3.2ã€å¯é€‰å‚æ•° &amp; å‘½åå‚æ•° &amp; é»˜è®¤å‚æ•°"></a>1.3.2ã€å¯é€‰å‚æ•° &amp; å‘½åå‚æ•° &amp; é»˜è®¤å‚æ•°</h4><h5 id="å¯é€‰å‚æ•°"><a href="#å¯é€‰å‚æ•°" class="headerlink" title="å¯é€‰å‚æ•°"></a>å¯é€‰å‚æ•°</h5><p>1ï¼‰ã€å¯é€‰å‚æ•°é¡¾åæ€ä¹‰å°±æ˜¯å¯ä»¥é€‰æ‹©çš„å‚æ•°ï¼Œä½¿ç”¨ [] è¡¨ç¤ºå¯é€‰çš„ä½ç½®å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> optionFunction(<span class="hljs-keyword">var</span> value1,[<span class="hljs-keyword">var</span> value2 = <span class="hljs-number">2</span>,<span class="hljs-keyword">var</span> value3 = <span class="hljs-number">3</span>])&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$value1</span> <span class="hljs-subst">$value2</span> <span class="hljs-subst">$value3</span>&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  optionFunction(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>ç–‘é—®ï¼šå¦‚æœæˆ‘åªæƒ³ç»™ value1 å’Œ value3 ä¼ å‚ï¼šå¯ä»¥åšåˆ°å—ï¼Ÿ</p><p>ç­”ï¼šä¸èƒ½ã€‚å¦‚æœæƒ³åšåˆ°ï¼Œå°±éœ€è¦ä½¿ç”¨å‘½åå‚æ•°</p><h5 id="å‘½åå‚æ•°"><a href="#å‘½åå‚æ•°" class="headerlink" title="å‘½åå‚æ•°"></a>å‘½åå‚æ•°</h5><p>1ï¼‰ã€å‘½åå‚æ•°é»˜è®¤éƒ½ä¸ºå¯é€‰å‚æ•°ã€‚å¦‚æœæ˜¯å¿…è¦å‚æ•°ï¼Œåˆ™éœ€è¦ç”¨ required å…³é”®å­—ï¼Œä¸”ä½¿ç”¨ required ä¿®é¥°çš„å‚æ•°ä¸èƒ½æä¾›é»˜è®¤å€¼</p><p>2ï¼‰ã€ä½¿ç”¨ {} æ¥æŒ‡å®šå‘½åå‚æ•°</p><p>3ï¼‰ã€å‘½åå‚æ•°å¿…é¡»ä»¥ key: value çš„å½¢å¼å»æŒ‡å®š</p><p>å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€ä½¿ç”¨ &#123;&#125; æ¥æŒ‡å®šå‘½åå‚æ•°</span><br><span class="hljs-keyword">void</span> optionFunction(<span class="hljs-keyword">var</span> value1,&#123;<span class="hljs-keyword">var</span> value2 = <span class="hljs-number">2</span>,<span class="hljs-keyword">var</span> value3 = <span class="hljs-number">3</span>&#125;)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$value1</span> <span class="hljs-subst">$value2</span> <span class="hljs-subst">$value3</span>&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  optionFunction(<span class="hljs-number">1</span>,value3: <span class="hljs-number">4</span>);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span><br><br> <br><span class="hljs-comment">//2ã€å¦‚æœæ˜¯å¿…è¦å‚æ•°ï¼Œåˆ™éœ€è¦ç”¨ required å…³é”®å­—ï¼Œä¸”ä½¿ç”¨ required ä¿®é¥°çš„å‚æ•°ä¸èƒ½æä¾›é»˜è®¤å€¼</span><br><span class="hljs-comment">//æ­¤æ—¶ value2 ä¸ºå¿…ä¼ çš„å‚æ•°</span><br><span class="hljs-keyword">void</span> optionFunction(<span class="hljs-keyword">var</span> value1,&#123;<span class="hljs-keyword">required</span> <span class="hljs-keyword">var</span> value2,<span class="hljs-keyword">var</span> value3 = <span class="hljs-number">3</span>&#125;)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$value1</span> <span class="hljs-subst">$value2</span> <span class="hljs-subst">$value3</span>&#x27;</span>);<br>&#125;  <br><br><span class="hljs-keyword">void</span> main()&#123;<br>  optionFunction(<span class="hljs-number">1</span>,value2: <span class="hljs-number">4</span>);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h5 id="é»˜è®¤å‚æ•°"><a href="#é»˜è®¤å‚æ•°" class="headerlink" title="é»˜è®¤å‚æ•°"></a>é»˜è®¤å‚æ•°</h5><p>å¦‚ä¸Šæˆ‘ä»¬åˆšæ‰ç»™å¯é€‰å‚æ•°å’Œå‘½åå‚æ•°æä¾›çš„é»˜è®¤å€¼</p><p>1ï¼‰ã€é»˜è®¤å‚æ•°å°±æ˜¯ç»™å¯é€‰å‚æ•°æä¾›é»˜è®¤å€¼ï¼Œä»¥ä¾¿åœ¨æœªæä¾›ç›¸åº”å®å‚æ—¶ä½¿ç”¨</p><p>2ï¼‰ã€é»˜è®¤å€¼å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡</p><p>3ï¼‰ã€å¦‚æœå¯é€‰å‚æ•°æ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œé‚£é»˜è®¤å€¼å°±ä¸º null</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å¦‚æœå¯é€‰å‚æ•°æ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œé‚£é»˜è®¤å€¼å°±ä¸º null</span><br><span class="hljs-keyword">void</span> optionFunction(<span class="hljs-keyword">var</span> value1,&#123;<span class="hljs-keyword">var</span> value2 = <span class="hljs-number">2</span>,<span class="hljs-keyword">var</span> value3&#125;)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$value1</span> <span class="hljs-subst">$value2</span> <span class="hljs-subst">$value3</span>&#x27;</span>);<br>&#125;<br> <br><span class="hljs-keyword">void</span> main()&#123;<br>  optionFunction(<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-keyword">null</span><br></code></pre></td></tr></table></figure><h4 id="1-3-3ã€åŒ¿åæ–¹æ³•ï¼ˆåˆç§°é—­åŒ…ï¼‰"><a href="#1-3-3ã€åŒ¿åæ–¹æ³•ï¼ˆåˆç§°é—­åŒ…ï¼‰" class="headerlink" title="1.3.3ã€åŒ¿åæ–¹æ³•ï¼ˆåˆç§°é—­åŒ…ï¼‰"></a>1.3.3ã€åŒ¿åæ–¹æ³•ï¼ˆåˆç§°é—­åŒ…ï¼‰</h4><p>1ï¼‰ã€åŒ¿åæ–¹æ³•é¡¾åæ€ä¹‰å°±æ˜¯æ²¡æœ‰åå­—çš„æ–¹æ³•ï¼Œè¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æ–¹å¼ä¸€ï¼š</span><br>(<span class="hljs-keyword">var</span> å‚æ•°å)&#123;<br>   æ–¹æ³•ä½“<br>&#125;<br><br><span class="hljs-comment">//2ã€æ–¹å¼äºŒï¼š</span><br>(ç±»å‹ å‚æ•°å)&#123;<br>   æ–¹æ³•ä½“<br>&#125;<br><br><span class="hljs-comment">//3ã€æ–¹å¼ä¸‰ï¼šå¦‚æœæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œä»£ç å¯ä»¥å°†åŒ¿åæ–¹æ³•ç”¨å•è¡Œè¡¨ç¤º</span><br>(<span class="hljs-keyword">var</span> å‚æ•°å) =&gt; æ–¹æ³•ä½“<br>(ç±»å‹ å‚æ•°å) =&gt; æ–¹æ³•ä½“<br>  <br><span class="hljs-comment">//4ã€æ–¹å¼å››ï¼šçœç•¥ var æˆ–ç±»å‹</span><br>(å‚æ•°å)&#123;<br>   æ–¹æ³•ä½“<br>&#125;<br><br>(å‚æ•°å) =&gt; æ–¹æ³•ä½“<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€åŒ¿åæ–¹æ³•ä¸€èˆ¬ä¼šå½“åšå‚æ•°æˆ–èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€åŒ¿åæ–¹æ³•å½“ä½œå‚æ•°ä½¿ç”¨</span><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">const</span> list = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>  list.forEach((element)&#123;<br>    <span class="hljs-built_in">print</span>(element);<br>  &#125;);<br>  <span class="hljs-comment">//å¯ç®€åŒ–æˆå¦‚ä¸‹å†™æ³•ï¼š</span><br>  <span class="hljs-comment">//list.forEach((element) =&gt; print(element));</span><br>&#125;<br><br><span class="hljs-comment">//2ã€åŒ¿åæ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</span><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">const</span> list = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>  <span class="hljs-keyword">var</span> function = (element)&#123;<br>    <span class="hljs-built_in">print</span>(element);<br>  &#125;;<br>  <span class="hljs-comment">//å¯ç®€åŒ–æˆå¦‚ä¸‹å†™æ³•ï¼š</span><br>  <span class="hljs-comment">//var function = (element) =&gt;  print(element);</span><br>  list.forEach(function);<br>&#125;<br></code></pre></td></tr></table></figure><p>3ï¼‰ã€åŒ¿åæ–¹æ³•ç«‹å³æ‰§è¡Œ</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æ–¹å¼1</span><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> func = ()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;666&#x27;</span>);<br>  &#125;;<br>  (func)();<br>&#125;<br><br><span class="hljs-comment">//2ã€æ–¹å¼2</span><br><span class="hljs-keyword">void</span> main()&#123;<br>  (()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;666&#x27;</span>);<br>  &#125;)();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p>4ï¼‰ã€åŒ¿åæ–¹æ³•å†…éƒ¨å¯ä»¥å¼•ç”¨åŒ…å«è¯¥åŒ¿åæ–¹æ³•çš„æ‰€æœ‰å±‚çº§ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œä¸åŒ¿åæ–¹æ³•è°ƒç”¨çš„ä½ç½®æ— å…³ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//makeAdder è¿”å›ä¸€ä¸ªåŒ¿åæ–¹æ³•</span><br><span class="hljs-built_in">Function</span> makeAdder(<span class="hljs-built_in">num</span> addBy)&#123;<br>  <span class="hljs-comment">//åŒ¿åæ–¹æ³•è®¿é—® addBy å‚æ•°</span><br>  <span class="hljs-keyword">return</span> (<span class="hljs-built_in">num</span> i) =&gt; addBy + i;<br>&#125;<br><br><span class="hljs-keyword">void</span>  main()&#123;<br>  <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œä¼ å…¥å®å‚ä¸º 2</span><br>  <span class="hljs-keyword">var</span> add1 = makeAdder(<span class="hljs-number">2</span>);<br>  <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œä¼ å…¥å®å‚ä¸º 3</span><br>  <span class="hljs-keyword">var</span> add2 = makeAdder(<span class="hljs-number">3</span>);<br><br>  <span class="hljs-comment">//åˆ†åˆ«è°ƒç”¨ä¸¤ä¸ªåŒ¿åæ–¹æ³•ï¼Œå¹¶æ‰“å°ç»“æœ</span><br>  <span class="hljs-built_in">print</span>(add1(<span class="hljs-number">3</span>));<br>  <span class="hljs-built_in">print</span>(add2(<span class="hljs-number">4</span>));<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">5</span><br><span class="hljs-number">7</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šDart ä¸­çš„æ–¹æ³•ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œå¯¹åº” Function ç±»ï¼Œæ‰€ä»¥æ–¹æ³•å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡æˆ–ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªæ–¹æ³•</p><h4 id="1-3-4ã€é™æ€æ–¹æ³•"><a href="#1-3-4ã€é™æ€æ–¹æ³•" class="headerlink" title="1.3.4ã€é™æ€æ–¹æ³•"></a>1.3.4ã€é™æ€æ–¹æ³•</h4><p>1ï¼‰ã€ä½¿ç”¨ static å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•å³ä¸ºé™æ€æ–¹æ³•ï¼Œå› é™æ€æ–¹æ³•ä¸å±äºç±»å®ä¾‹ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•è®¿é—®ç±»æˆå‘˜</p><p>2ï¼‰ã€é™æ€æ–¹æ³•å¯ä»¥ä½¿ç”¨ç±»åç›´æ¥è°ƒç”¨</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> staticFunction1()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> staticFunction2()&#123;<br> <br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  Test.staticFunction1();<br>  Test.staticFunction2();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€åŸºæœ¬ç±»å‹å’Œè¿ç®—ç¬¦"><a href="#äºŒã€åŸºæœ¬ç±»å‹å’Œè¿ç®—ç¬¦" class="headerlink" title="äºŒã€åŸºæœ¬ç±»å‹å’Œè¿ç®—ç¬¦"></a>äºŒã€åŸºæœ¬ç±»å‹å’Œè¿ç®—ç¬¦</h2><h3 id="2-1ã€åŸºæœ¬ç±»å‹"><a href="#2-1ã€åŸºæœ¬ç±»å‹" class="headerlink" title="2.1ã€åŸºæœ¬ç±»å‹"></a>2.1ã€åŸºæœ¬ç±»å‹</h3><p>å‰é¢æåˆ°è¿‡ï¼šDart å®Œå…¨æŠ›å¼ƒäº† Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¨éƒ¨éƒ½æ˜¯å¯¹è±¡æ•°æ®ç±»å‹ã€‚å› æ­¤æˆ‘ä»¬è¿™é‡Œè®²çš„åŸºæœ¬ç±»å‹ï¼Œä¹Ÿæ˜¯å¯¹è±¡æ•°æ®ç±»å‹ï¼Œåªä¸è¿‡æ˜¯ Dart é»˜è®¤ç»™æˆ‘ä»¬æä¾›çš„</p><h4 id="2-1-1ã€æ•°å­—ç±»å‹"><a href="#2-1-1ã€æ•°å­—ç±»å‹" class="headerlink" title="2.1.1ã€æ•°å­—ç±»å‹"></a>2.1.1ã€æ•°å­—ç±»å‹</h4><p>1ï¼‰ã€åœ¨dartè¯­è¨€ä¸­æ•°å­—ç±»å‹ä¸»è¦æœ‰ä¸‹é¢ä¸‰ç§ï¼š</p><blockquote><p>intï¼šæ•´æ•°ç±»å‹</p><p>doubleï¼šæµ®ç‚¹æ•°ç±»å‹</p><p>numï¼šæ•°å­—ç±»å‹ï¼Œintå’Œdoubleéƒ½æ˜¯å®ƒçš„å­ç±»</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;   <span class="hljs-comment">// åˆå§‹åŒ–ä¸º int ç±»å‹</span><br><span class="hljs-keyword">var</span> y = <span class="hljs-number">1.1</span>;  <span class="hljs-comment">// åŒ…å«å°æ•°ï¼Œåˆå§‹åŒ–ä¸º double</span><br><br><span class="hljs-comment">// æ˜ç¡®æŒ‡å®šæ•°æ®ç±»å‹</span><br><span class="hljs-built_in">double</span> z = <span class="hljs-number">1</span>;<br><span class="hljs-built_in">num</span> d = <span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€æ•°å­—ç±»å‹å’Œå­—ç¬¦ä¸²ç±»å‹äº’ç›¸è½¬æ¢</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å°† String ç±»å‹è½¬æ¢æˆ int ç±»å‹</span><br><span class="hljs-keyword">var</span> one = <span class="hljs-built_in">int</span>.parse(<span class="hljs-string">&#x27;1&#x27;</span>);<br><br><span class="hljs-comment">// å°† String ç±»å‹è½¬æ¢æˆ double ç±»å‹</span><br><span class="hljs-keyword">var</span> onePointOne = <span class="hljs-built_in">double</span>.parse(<span class="hljs-string">&#x27;1.1&#x27;</span>);<br><br><br><span class="hljs-comment">// å°† int ç±»å‹è½¬æ¢æˆ String ç±»å‹</span><br><span class="hljs-built_in">String</span> oneAsString = <span class="hljs-number">1.</span>toString();<br><br><span class="hljs-comment">// å°† double ç±»å‹è½¬æ¢æˆ String ç±»å‹, ä¿ç•™ä¸¤ä½å°æ•°</span><br><span class="hljs-built_in">String</span> piAsString = <span class="hljs-number">3.14159</span>.toStringAsFixed(<span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure><h4 id="2-1-2ã€å­—ç¬¦ä¸²ç±»å‹"><a href="#2-1-2ã€å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="2.1.2ã€å­—ç¬¦ä¸²ç±»å‹"></a>2.1.2ã€å­—ç¬¦ä¸²ç±»å‹</h4><p>1ï¼‰ã€å­—ç¬¦ä¸²ç±»å‹ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·åŒ…è£¹å­—ç¬¦ä¸²éƒ½å¯ä»¥</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> s1 = <span class="hljs-string">&#x27;Hello&#x27;</span>;<br><span class="hljs-keyword">var</span> s2 = <span class="hljs-string">&quot;erdai&quot;</span>;<br></code></pre></td></tr></table></figure><h5 id="2-1-2-1ã€å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼"><a href="#2-1-2-1ã€å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼" class="headerlink" title="2.1.2.1ã€å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼"></a>2.1.2.1ã€å­—ç¬¦ä¸²å†…åµŒè¡¨è¾¾å¼</h5><p>1ï¼‰ã€Dart æ”¯æŒåœ¨å­—ç¬¦ä¸²ä¸­å†…åµŒå˜é‡ï¼Œæˆ–è€…å¹²è„†å†…åµŒè¡¨è¾¾å¼</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å†…åµŒå˜é‡</span><br><span class="hljs-keyword">var</span> s3 = <span class="hljs-string">&#x27;ä½ å¥½: <span class="hljs-subst">$s2</span>&#x27;</span>;<br><br><span class="hljs-comment">// å†…åµŒè¡¨è¾¾å¼</span><br><span class="hljs-keyword">var</span> s4 = <span class="hljs-string">&quot;è½¬å¤§å†™ï¼š<span class="hljs-subst">$&#123;s2.toUpperCase()&#125;</span>&quot;</span>;<br></code></pre></td></tr></table></figure><h5 id="2-1-2-2ã€å­—ç¬¦ä¸²ç›¸åŠ ï¼ˆè¿æ¥ï¼‰"><a href="#2-1-2-2ã€å­—ç¬¦ä¸²ç›¸åŠ ï¼ˆè¿æ¥ï¼‰" class="headerlink" title="2.1.2.2ã€å­—ç¬¦ä¸²ç›¸åŠ ï¼ˆè¿æ¥ï¼‰"></a>2.1.2.2ã€å­—ç¬¦ä¸²ç›¸åŠ ï¼ˆè¿æ¥ï¼‰</h5><p>å­—ç¬¦ä¸²ç›¸åŠ ï¼Œå°±æ˜¯å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œdart è¯­è¨€ä¸­æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°å­—ç¬¦ä¸²è¿æ¥ï¼š</p><p>1ï¼‰ã€è¿ç»­çš„å­—é¢å­—ç¬¦ä¸²å®šä¹‰ï¼Œé»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è¿æ¥èµ·æ¥</p><p>2ï¼‰ã€ä½¿ç”¨ + åŠ å·è¿æ¥å­—ç¬¦ä¸²</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-comment">//1ã€è¿ç»­çš„å­—é¢å­—ç¬¦ä¸²å®šä¹‰ï¼Œé»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è¿æ¥èµ·æ¥</span><br>  <span class="hljs-keyword">var</span> str1 = <span class="hljs-string">&quot;erdai&quot;</span> <span class="hljs-string">&quot;666&quot;</span>;<br>  <span class="hljs-comment">//2ã€ä½¿ç”¨ + åŠ å·è¿æ¥å­—ç¬¦ä¸²</span><br>  <span class="hljs-keyword">var</span> str2 = <span class="hljs-string">&quot;erdai&quot;</span> + <span class="hljs-string">&quot;666&quot;</span>;<br>  <span class="hljs-built_in">print</span>(str1);<br>  <span class="hljs-built_in">print</span>(str2);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai666<br>erdai666<br></code></pre></td></tr></table></figure><h5 id="2-1-2-3ã€å¤šè¡Œå­—ç¬¦ä¸²å®šä¹‰"><a href="#2-1-2-3ã€å¤šè¡Œå­—ç¬¦ä¸²å®šä¹‰" class="headerlink" title="2.1.2.3ã€å¤šè¡Œå­—ç¬¦ä¸²å®šä¹‰"></a>2.1.2.3ã€å¤šè¡Œå­—ç¬¦ä¸²å®šä¹‰</h5><p>1ï¼‰ã€ä½¿ç”¨ <strong>â€˜â€™â€™</strong> ä¸‰å¼•å·å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ä¿ç•™å­—ç¬¦ä¸²çš„æ¢è¡Œç¬¦</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> s1 = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">è¿™æ˜¯ç¬¬ä¸€è¡Œå­—ç¬¦ä¸²ã€‚</span><br><span class="hljs-string">è¿™æ˜¯ç¬¬äºŒè¡Œå­—ç¬¦ä¸²ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>;<br>  <span class="hljs-built_in">print</span>(s1);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>è¿™æ˜¯ç¬¬ä¸€è¡Œå­—ç¬¦ä¸²ã€‚<br>è¿™æ˜¯ç¬¬äºŒè¡Œå­—ç¬¦ä¸²ã€‚<br></code></pre></td></tr></table></figure><h4 id="2-1-3ã€å¸ƒå°”ç±»å‹"><a href="#2-1-3ã€å¸ƒå°”ç±»å‹" class="headerlink" title="2.1.3ã€å¸ƒå°”ç±»å‹"></a>2.1.3ã€å¸ƒå°”ç±»å‹</h4><p>å¸ƒå°”ç±»å‹å°±ä¸¤ç§å€¼ï¼štrue æˆ–è€… falseï¼Œ åˆ†åˆ«è¡¨ç¤ºçœŸå’Œå‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> isOk = <span class="hljs-keyword">false</span>;<br><span class="hljs-built_in">bool</span> status = <span class="hljs-keyword">true</span>;<br></code></pre></td></tr></table></figure><h4 id="2-1-4ã€æšä¸¾ç±»å‹"><a href="#2-1-4ã€æšä¸¾ç±»å‹" class="headerlink" title="2.1.4ã€æšä¸¾ç±»å‹"></a>2.1.4ã€æšä¸¾ç±»å‹</h4><p>1ï¼‰ã€æšä¸¾ç±»å‹å…¶å®å°±æ˜¯ä¸€ç»„å¸¸é‡çš„é›†åˆï¼Œéƒ½æ˜¯åªè¯»çš„</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// ä½¿ç”¨ enum å…³é”®å­—ï¼Œå®šä¹‰ Color æšä¸¾ç±»å‹ï¼ŒColor åŒ…å«äº†3ä¸ªå¸¸é‡ redã€greenã€blue</span><br><span class="hljs-keyword">enum</span> Color &#123; red, green, blue &#125;<br><br><span class="hljs-comment">// è¯»å– Color.blue æšä¸¾å¸¸é‡</span><br><span class="hljs-keyword">var</span> aColor = Color.blue;<br><br><span class="hljs-comment">// ä½¿ç”¨ switch è¯­å¥åˆ¤æ–­ aColor å˜é‡å€¼</span><br><span class="hljs-keyword">switch</span> (aColor) &#123;<br>  <span class="hljs-keyword">case</span> Color.red:  <span class="hljs-comment">// ä½¿ç”¨æšä¸¾å¸¸é‡ä½œä¸ºæ£€æµ‹æ¡ä»¶ï¼ŒaColor == Color.red åˆ™æˆç«‹ã€‚</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Red as roses!&#x27;</span>);<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">case</span> Color.green:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Green as grass!&#x27;</span>);<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">default</span>: <span class="hljs-comment">// é»˜è®¤æ¡ä»¶</span><br>    <span class="hljs-built_in">print</span>(aColor); <span class="hljs-comment">// &#x27;Color.blue&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€æšä¸¾å¸¸é‡éƒ½æœ‰ä¸€ä¸ªä» 0 å¼€å§‹æ•°å­—ç¼–å·ï¼Œç¬¬ä¸€ä¸ªå¸¸é‡æ˜¯ 0ï¼Œç¬¬äºŒä¸ªæ˜¯ 1ï¼Œä»¥æ­¤ç±»æ¨</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-built_in">print</span>(Color.green.index);<br>  <span class="hljs-built_in">print</span>(Color.blue.index);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="2-2ã€è¿ç®—ç¬¦"><a href="#2-2ã€è¿ç®—ç¬¦" class="headerlink" title="2.2ã€è¿ç®—ç¬¦"></a>2.2ã€è¿ç®—ç¬¦</h3><p>è¿ç®—ç¬¦è¿™ä¸€å—ï¼Œé™¤äº†çº§è”è°ƒç”¨æ˜¯ Java å’Œ Kotlin æ‰€æ²¡æœ‰çš„ï¼Œå…¶ä»–è¿ç®—ç¬¦åŸºæœ¬ç±»ä¼¼</p><h4 id="2-2-1ã€çº§è”è°ƒç”¨"><a href="#2-2-1ã€çº§è”è°ƒç”¨" class="headerlink" title="2.2.1ã€çº§è”è°ƒç”¨"></a>2.2.1ã€çº§è”è°ƒç”¨</h4><p>1ï¼‰ã€çº§è”è°ƒç”¨å°±æ˜¯é€šè¿‡ <strong>.. (ä¸¤ä¸ªè¿ç»­çš„ç‚¹)</strong> è¿ç»­è°ƒç”¨å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#confirm&#x27;</span>) <span class="hljs-comment">// é€šè¿‡ querySelector æŸ¥è¯¢è·å¾—ä¸€ä¸ªå¯¹è±¡</span><br>  ..text = <span class="hljs-string">&#x27;Confirm&#x27;</span> <span class="hljs-comment">// è®¾ç½®å¯¹è±¡ text å±æ€§</span><br>  ..classes.add(<span class="hljs-string">&#x27;important&#x27;</span>);  <span class="hljs-comment">// è°ƒç”¨å¯¹è±¡çš„ classes å±æ€§çš„ add å‡½æ•°</span><br><br><span class="hljs-comment">//ç­‰ä»·å¦‚ä¸‹ä»£ç </span><br><br><span class="hljs-comment">// é€šè¿‡ querySelector æŸ¥è¯¢è·å¾—ä¸€ä¸ªå¯¹è±¡</span><br><span class="hljs-keyword">var</span> button = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#confirm&#x27;</span>);<br><span class="hljs-comment">// è®¾ç½®å¯¹è±¡ text å±æ€§</span><br>button.text = <span class="hljs-string">&#x27;Confirm&#x27;</span>;<br><span class="hljs-comment">// è°ƒç”¨å¯¹è±¡çš„ classes å±æ€§çš„ add å‡½æ•°</span><br>button.classes.add(<span class="hljs-string">&#x27;important&#x27;</span>);<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šå¤§å®¶å…ˆå…³æ³¨è¯­æ³•å³å¯</p><h4 id="2-2-2ã€èµ‹å€¼è¿ç®—ç¬¦"><a href="#2-2-2ã€èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="2.2.2ã€èµ‹å€¼è¿ç®—ç¬¦"></a>2.2.2ã€èµ‹å€¼è¿ç®—ç¬¦</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€ä½¿ç”¨ = è¿›è¡Œèµ‹å€¼</span><br>a = <span class="hljs-number">100</span>;<br><br><span class="hljs-comment">//2ã€å¤åˆèµ‹å€¼è¿ç®—ç¬¦</span><br>a *= <span class="hljs-number">3</span>; <span class="hljs-comment">// ç­‰ä»·äº a = a * 3</span><br>a -= <span class="hljs-number">3</span>; <span class="hljs-comment">// ç­‰ä»·äº a = a - 3</span><br>a += <span class="hljs-number">3</span>; <span class="hljs-comment">// ç­‰ä»·äº a = a + 3</span><br>a /= <span class="hljs-number">3</span>; <span class="hljs-comment">// ç­‰ä»·äº a = a / 3</span><br>a %= <span class="hljs-number">3</span>; <span class="hljs-comment">// ç­‰ä»·äº a = a % 3</span><br></code></pre></td></tr></table></figure><h4 id="2-2-3ã€ç®—æ•°è¿ç®—ç¬¦"><a href="#2-2-3ã€ç®—æ•°è¿ç®—ç¬¦" class="headerlink" title="2.2.3ã€ç®—æ•°è¿ç®—ç¬¦"></a>2.2.3ã€ç®—æ•°è¿ç®—ç¬¦</h4><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>+</td><td>åŠ </td></tr><tr><td>-</td><td>å‡</td></tr><tr><td>-expr</td><td>ç®—æ•°å–å</td></tr><tr><td>*</td><td>ä¹˜</td></tr><tr><td>&#x2F;</td><td>é™¤</td></tr><tr><td>~&#x2F;</td><td>é™¤æ³•ï¼Œç»“æœå–æ•´</td></tr><tr><td>%</td><td>æ±‚ä½™</td></tr><tr><td>++</td><td>æ”¯æŒå‰ç½®è‡ªå¢å’Œåç½®è‡ªå¢</td></tr><tr><td>â€“</td><td>æ”¯æŒå‰ç½®è‡ªå‡å’Œåç½®è‡ªå‡</td></tr></tbody></table><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// a = 5</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span> + <span class="hljs-number">3</span>;<br><span class="hljs-comment">// a1 = -1</span><br><span class="hljs-keyword">var</span> a1 = <span class="hljs-number">2</span> - <span class="hljs-number">3</span>;<br><span class="hljs-comment">// a2 = 6</span><br><span class="hljs-keyword">var</span> a2 = <span class="hljs-number">2</span> * <span class="hljs-number">3</span>;<br><span class="hljs-comment">// a3 = 2.5</span><br><span class="hljs-keyword">var</span> a3 = <span class="hljs-number">5</span> / <span class="hljs-number">2</span>;<br><span class="hljs-comment">// æ•´é™¤ï¼Œa4 = 2</span><br><span class="hljs-keyword">var</span> a4 = <span class="hljs-number">5</span> ~/ <span class="hljs-number">2</span>;<br><span class="hljs-comment">// æ±‚ä½™æ•° a5 = 1</span><br><span class="hljs-keyword">var</span> a5 = <span class="hljs-number">5</span> % <span class="hljs-number">2</span>;<br><span class="hljs-comment">//a++ å’Œ ++a åŒºåˆ«ï¼ša++ å…ˆç”¨åœ¨åŠ ï¼Œ++aå…ˆåŠ åœ¨ç”¨</span><br>a++; <span class="hljs-comment">// ç›¸å½“äº a = a + 1</span><br>++a; <br>a--; <span class="hljs-comment">// ç›¸å½“äº a = a - 1</span><br>--a;<br></code></pre></td></tr></table></figure><h4 id="2-2-4ã€å…³ç³»è¿ç®—ç¬¦"><a href="#2-2-4ã€å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="2.2.4ã€å…³ç³»è¿ç®—ç¬¦"></a>2.2.4ã€å…³ç³»è¿ç®—ç¬¦</h4><p>å…³ç³»è¿è¿ç®—ç¬¦å¸¸ç”¨äºæ¡ä»¶è¡¨è¾¾å¼ä¸­ï¼Œåˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&#x3D;&#x3D;</td><td>åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰</td></tr><tr><td>!&#x3D;</td><td>åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸ç›¸ç­‰</td></tr><tr><td>&gt;</td><td>å¤§äº</td></tr><tr><td>&lt;</td><td>å°äº</td></tr><tr><td>&gt;&#x3D;</td><td>å¤§äºç­‰äº</td></tr><tr><td>&lt;&#x3D;</td><td>å°äºç­‰äº</td></tr></tbody></table><h4 id="2-2-5ã€ç±»å‹æµ‹è¯•è¿ç®—ç¬¦"><a href="#2-2-5ã€ç±»å‹æµ‹è¯•è¿ç®—ç¬¦" class="headerlink" title="2.2.5ã€ç±»å‹æµ‹è¯•è¿ç®—ç¬¦"></a>2.2.5ã€ç±»å‹æµ‹è¯•è¿ç®—ç¬¦</h4><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>as</td><td>ç”¨äºç±»å‹è½¬æ¢ï¼Œå°†ä¸€ä¸ªå¯¹è±¡ç±»å‹è½¬æ¢æˆå¦å¤–ä¸€ç§å¯¹è±¡ç±»å‹ï¼Œä¸€èˆ¬ç”¨äºå­ç±»å¯¹è±¡è½¬æ¢æˆçˆ¶ç±»å¯¹è±¡ã€‚</td></tr><tr><td>is</td><td>ç”¨äºæ£€æµ‹ä¸€ä¸ªå˜é‡æ˜¯å¦å±äºæŸç§å¯¹è±¡ç±»å‹</td></tr><tr><td>is!</td><td>ç”¨äºæ£€æµ‹ä¸€ä¸ªå˜é‡ä¸å±äºæŸç§å¯¹è±¡ç±»å‹</td></tr></tbody></table><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å¦‚æœ emp å˜é‡æ˜¯ Person ç±»å‹åˆ™æ¡ä»¶ä¸º true</span><br><span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">is</span> Person) &#123;<br>  <span class="hljs-comment">// å¿½ç•¥ä»£ç </span><br>&#125;<br><br><span class="hljs-comment">// æ°¸è¿œè¿”å› true, å› ä¸ºæ‰€æœ‰ç±»å‹éƒ½ç»§æ‰¿äº† Objectã€‚</span><br><span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">is</span> <span class="hljs-built_in">Object</span>) &#123;<br>    <span class="hljs-comment">// å¿½ç•¥ä»£ç </span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœå˜é‡æ˜¯æŸä¸ªç±»çš„å­ç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡ä¹Ÿå±äºçˆ¶ç±»ç±»å‹ï¼Œis æ¡ä»¶è¿”å› true</p><h4 id="2-2-6ã€é€»è¾‘è¿ç®—ç¬¦"><a href="#2-2-6ã€é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="2.2.6ã€é€»è¾‘è¿ç®—ç¬¦"></a>2.2.6ã€é€»è¾‘è¿ç®—ç¬¦</h4><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>!expr</td><td>è¡¨è¾¾å¼æ¡ä»¶å–å</td></tr><tr><td>||</td><td>é€»è¾‘æˆ–</td></tr><tr><td>&amp;&amp;</td><td>é€»è¾‘ä¸</td></tr></tbody></table><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//å¸¸ç”¨äºæ¡ä»¶è¯­å¥ç»„åˆè¡¨è¾¾å¼</span><br><span class="hljs-keyword">if</span> (!done &amp;&amp; (col == <span class="hljs-number">0</span> || col == <span class="hljs-number">3</span>)) &#123;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-7ã€ä½è¿ç®—ç¬¦"><a href="#2-2-7ã€ä½è¿ç®—ç¬¦" class="headerlink" title="2.2.7ã€ä½è¿ç®—ç¬¦"></a>2.2.7ã€ä½è¿ç®—ç¬¦</h4><p>äºŒè¿›åˆ¶ä½è¿ç®—ç¬¦</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&amp;</td><td>ä¸</td></tr><tr><td>|</td><td>æˆ–</td></tr><tr><td>^</td><td>å¼‚æˆ–</td></tr><tr><td>~expr</td><td>æŒ‰ä½å–å</td></tr><tr><td>&lt;&lt;</td><td>å·¦ç§»</td></tr><tr><td>&gt;&gt;</td><td>å³ç§»</td></tr></tbody></table><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// a = 256</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>; <span class="hljs-comment">// 1 å·¦ç§» 8 ä½ç›¸å½“äºï¼š1 * 2 çš„ 8 æ¬¡æ–¹</span><br></code></pre></td></tr></table></figure><h4 id="2-2-8ã€æ¡ä»¶è¿ç®—ç¬¦"><a href="#2-2-8ã€æ¡ä»¶è¿ç®—ç¬¦" class="headerlink" title="2.2.8ã€æ¡ä»¶è¿ç®—ç¬¦"></a>2.2.8ã€æ¡ä»¶è¿ç®—ç¬¦</h4><p>Dart ä¸­æœ‰ä¸¤ç§æ¡ä»¶è¿ç®—ç¬¦ï¼š</p><p>1ã€è¯­æ³•è§„åˆ™ï¼šcondition ? expr1 : expr2 ï¼Œç±»ä¼¼ Java ä¸‰ç›®è¿ç®—ç¬¦ã€‚condition è¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œå¹¶è¿”å› expr1 çš„å€¼ï¼Œ å¦åˆ™æ‰§è¡Œ expr2</p><p>2ã€è¯­æ³•è§„åˆ™ï¼šexpr1 ?? expr2 ï¼Œç±»ä¼¼ Kotlin çš„ ?: ã€‚å¦‚æœ expr1 ä¸ç­‰äº null, åˆ™æ‰§è¡Œ expr1 å¹¶è¿”å› expr1 çš„å€¼ï¼Œå¦åˆ™æ‰§è¡Œå¹¶è¿”å› expr2 çš„å€¼</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å¦‚æœisPublicä¸ºçœŸï¼Œvisibility = &#x27;public&#x27; å¦åˆ™ visibility = &#x27;private&#x27;</span><br><span class="hljs-keyword">var</span> visibility = isPublic ? <span class="hljs-string">&#x27;public&#x27;</span> : <span class="hljs-string">&#x27;private&#x27;</span>;<br><br><span class="hljs-comment">// è¿™ç§è¯­æ³•åœ¨å¤„ç†å‚æ•°é»˜è®¤å€¼éå¸¸æœ‰ç”¨ã€‚</span><br><span class="hljs-comment">// å¦‚æœnameä¸ç­‰äºnull, åˆ™payerName = name å¦åˆ™payerName = &#x27;Guest&#x27;</span><br><span class="hljs-built_in">String</span> payerName = name ?? <span class="hljs-string">&#x27;Guest&#x27;</span>;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ•°ç»„å’Œé›†åˆ"><a href="#ä¸‰ã€æ•°ç»„å’Œé›†åˆ" class="headerlink" title="ä¸‰ã€æ•°ç»„å’Œé›†åˆ"></a>ä¸‰ã€æ•°ç»„å’Œé›†åˆ</h2><h3 id="3-1ã€List-æ•°ç»„"><a href="#3-1ã€List-æ•°ç»„" class="headerlink" title="3.1ã€List æ•°ç»„"></a>3.1ã€List æ•°ç»„</h3><h4 id="3-1-1ã€å®šä¹‰"><a href="#3-1-1ã€å®šä¹‰" class="headerlink" title="3.1.1ã€å®šä¹‰"></a>3.1.1ã€å®šä¹‰</h4><p>1ï¼‰ã€ä¸ Java çš„æ•°ç»„ç±»å‹ä¸åŒï¼ŒDart ä¸­çš„æ•°ç»„ç±»å‹å°±æ˜¯ Listï¼Œå®ƒæ˜¯æ³›å‹ç±»å‹æ•°æ®ç»“æ„ï¼Œæ”¯æŒä»»æ„æ•°æ®ç±»å‹çš„æ•°ç»„</p><p>2ï¼‰ã€List æ•°ç»„å®šä¹‰çš„å…ƒç´ æœ‰åºå¯é‡å¤ï¼Œç±»ä¼¼ Java çš„ List é›†åˆ</p><p>3ï¼‰ã€Dart ä¸­ List æ•°ç»„ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><p>1ã€å¯å˜é•¿åº¦æ•°ç»„</p><p>2ã€å›ºå®šé•¿åº¦æ•°ç»„</p><p>ä¸ç®¡æ˜¯å“ªç§ç±»å‹çš„æ•°ç»„ï¼Œä»–ä»¬çš„æ“ä½œæ–¹å¼æ˜¯ä¸€æ ·çš„</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å¯å˜é•¿åº¦æ•°ç»„</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª int ç±»å‹çš„å¯å˜æ•°ç»„</span><br><span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt; a = []; <span class="hljs-comment">//ç­‰ä»·ï¼švar a = &lt;int&gt;[];</span><br><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª String ç±»å‹çš„å¯å˜æ•°ç»„</span><br><span class="hljs-keyword">var</span> strs = &lt;<span class="hljs-built_in">String</span>&gt;[]; <span class="hljs-comment">//ç­‰ä»· List&lt;String&gt; strs = [];</span><br><br><span class="hljs-comment">//å¦‚ä¸‹è¿™ç§å®šä¹‰æ–¹å¼ï¼Œç¼–è¯‘å™¨ä¼šç»™æˆ‘ä»¬æ¨æ–­å‡ºæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å¯å˜æ•°ç»„</span><br><span class="hljs-keyword">var</span> strs = [<span class="hljs-string">&#x27;å­—ç¬¦ä¸²&#x27;</span>];<br></code></pre></td></tr></table></figure><p>1ã€ç†Ÿæ‚‰ Java çš„äººéƒ½çŸ¥é“ï¼Œä¸Šè¿°è¿™ç§å®šä¹‰å°±æ˜¯æ³›å‹ç±»å‹çš„è¯­æ³•ï¼Œ&lt;&gt; ç¬¦å·å®šä¹‰çš„æ˜¯ List çš„å…ƒç´ ç±»å‹</p><p>2ã€ä¸Šè¿°å®šä¹‰æ•°ç»„æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šæ•°ç»„å¤§å°ï¼Œå› æ­¤ä»–ä»¬å®šä¹‰çš„éƒ½æ˜¯å¯å˜æ•°ç»„ï¼Œå¯å˜æ•°ç»„å¯ä»¥å¾€æ•°ç»„ä¸­æ’å…¥ä¸é™åˆ¶æ•°é‡çš„å…ƒç´  ï¼ˆåªè¦æ²¡è¶…è¿‡å†…å­˜é™åˆ¶ï¼‰</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//2ã€å›ºå®šé•¿åº¦æ•°ç»„</span><br><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå›ºå®šé•¿åº¦ä¸º 3 ï¼Œç±»å‹ä¸º int çš„æ•°ç»„</span><br><span class="hljs-keyword">var</span> list = <span class="hljs-built_in">List</span>.filled(<span class="hljs-number">3</span>,<span class="hljs-number">0</span>);<br><br><span class="hljs-comment">//æµ‹è¯•ä¸€</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå›ºå®šé•¿åº¦ä¸º 3 ï¼Œç±»å‹ä¸º int çš„æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> list = <span class="hljs-built_in">List</span>.filled(<span class="hljs-number">3</span>,<span class="hljs-number">0</span>);<br>  list[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>  list[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<br>  list[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;<br>  <span class="hljs-comment">//æ­¤æ—¶å¦‚æœæˆ‘ä»¬æ·»åŠ ç¬¬ 4 ä¸ªå…ƒç´ ï¼Œåˆ™ä¼šæŠ¥æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸</span><br>  <span class="hljs-comment">//list[3] = 4; //æ•°ç»„ä¸‹æ ‡è¶Šç•Œ</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value <span class="hljs-keyword">in</span> list) &#123;<br>    <span class="hljs-built_in">print</span>(value);<br>  &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br>  <br><span class="hljs-comment">//æµ‹è¯•äºŒï¼š</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå›ºå®šé•¿åº¦ä¸º 2 ï¼Œç±»å‹ä¸º String çš„æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> list = <span class="hljs-built_in">List</span>.filled(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;&quot;</span>);<br>  list[<span class="hljs-number">0</span>] = <span class="hljs-string">&quot;erdai&quot;</span>;<br>  list[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;666&quot;</span>;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value <span class="hljs-keyword">in</span> list) &#123;<br>    <span class="hljs-built_in">print</span>(value);<br>  &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br><span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong></p><p>1ã€ä¸Šè¿° filled æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªè¡¨ç¤ºæ•°ç»„é•¿åº¦ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºå­˜æ”¾çš„å…ƒç´ ç±»å‹åˆå§‹å€¼</p><p>2ã€å›ºå®šé•¿åº¦çš„æ•°ç»„ï¼Œåªèƒ½é€šè¿‡æ•°ç»„ä¸‹æ ‡çš„æ–¹å¼è¯»å†™æ•°ç»„ï¼Œä¸èƒ½ä½¿ç”¨ addï¼Œinsert æ–¹æ³•ä¿®æ”¹æ•°ç»„ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><h4 id="3-1-2ã€ä¼¸å±•è¿ç®—ç¬¦"><a href="#3-1-2ã€ä¼¸å±•è¿ç®—ç¬¦" class="headerlink" title="3.1.2ã€ä¼¸å±•è¿ç®—ç¬¦"></a>3.1.2ã€ä¼¸å±•è¿ç®—ç¬¦</h4><p>å¦‚æœæˆ‘ä»¬æƒ³å°†ä¸€ä¸ª List æ•°ç»„çš„å…ƒç´ å¡«å……åˆ°å¦å¤–ä¸€ä¸ªæ•°ç»„å»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼¸å±•è¿ç®—ç¬¦ <strong>â€¦</strong> ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> list = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><span class="hljs-keyword">var</span> list2 = [<span class="hljs-number">0</span>, ...list]; <span class="hljs-comment">// å°† list æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ä¸€ä¸ªä¸ªå±•å¼€æ¥ï¼Œæ’å…¥åˆ° list2 ä¸­</span><br><span class="hljs-comment">// ç­‰ä»·ä»£ç  var list2 = [0, 1, 2, 3]</span><br></code></pre></td></tr></table></figure><h4 id="3-1-3ã€å¸¸ç”¨-Api-ä»‹ç»"><a href="#3-1-3ã€å¸¸ç”¨-Api-ä»‹ç»" class="headerlink" title="3.1.3ã€å¸¸ç”¨ Api ä»‹ç»"></a>3.1.3ã€å¸¸ç”¨ Api ä»‹ç»</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€é¦–å…ˆå®šä¹‰ä¸€ä¸ª int ç±»å‹çš„å¯å˜æ•°ç»„</span><br><span class="hljs-keyword">var</span> a = &lt;<span class="hljs-built_in">int</span>&gt;[];<br><br><span class="hljs-comment">//2ã€å¾€æ•°ç»„å°¾å·´æ·»åŠ å…ƒç´  a:[1,2,3]</span><br>a.add(<span class="hljs-number">1</span>);<br>a.add(<span class="hljs-number">2</span>);<br>a.add(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">//3ã€ä¿®æ”¹ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ a:[0,2,3]</span><br>a[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">//4ã€åœ¨æ•°ç»„ 0 ä½ç½®ï¼Œæ’å…¥ 100 a:[100,0,2,3]</span><br>a.insert(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>);<br><br><span class="hljs-comment">//5ã€åˆ é™¤ä¸€ä¸ªå…ƒç´  a:[100,0,2]</span><br><span class="hljs-comment">//æ ¹æ®å…ƒç´ åˆ é™¤</span><br>a.remove(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">//æ ¹æ®ä¸‹æ ‡åˆ é™¤ a:[100,2]</span><br>a.removeAt(<span class="hljs-number">1</span>);<br><br><span class="hljs-comment">//6ã€è·å–æ•°ç»„å¤§å°</span><br><span class="hljs-built_in">print</span>(a.length); <span class="hljs-comment">//æ‰“å°ï¼š2</span><br>  <br><span class="hljs-comment">//7ã€æ•°ç»„æ’åºï¼šé»˜è®¤æ•°ç»„ä»å°åˆ°å¤§æ’åº a:[2,100]</span><br>a.sort();<br><br><span class="hljs-comment">//8ã€åˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ </span><br>a.contains(<span class="hljs-number">2</span>); <span class="hljs-comment">// true</span><br><br><span class="hljs-comment">//9ã€æ¸…ç©º Listï¼Œåˆ é™¤æ‰€æœ‰æ•°æ® a:[]</span><br>a.clear();<br></code></pre></td></tr></table></figure><h3 id="3-2ã€Set-é›†åˆ"><a href="#3-2ã€Set-é›†åˆ" class="headerlink" title="3.2ã€Set é›†åˆ"></a>3.2ã€Set é›†åˆ</h3><h4 id="3-2-1ã€å®šä¹‰"><a href="#3-2-1ã€å®šä¹‰" class="headerlink" title="3.2.1ã€å®šä¹‰"></a>3.2.1ã€å®šä¹‰</h4><p>1ï¼‰ã€Dart ä¸­çš„ Set æ˜¯æ— åºé›†åˆç±»å‹ï¼ŒSet è·Ÿ List éƒ½èƒ½ä¿å­˜ä¸€ç»„æ•°æ®ï¼ŒåŒºåˆ«å°±æ˜¯ Set çš„å…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå’Œ Java çš„ Set é›†åˆç±»ä¼¼</p><p>2ï¼‰ã€Set æ”¯æŒä»»æ„ç±»å‹æ•°æ®ï¼Œä¸»è¦æœ‰ä¸‹é¢ä¸‰ç§æ–¹å¼åˆå§‹åŒ–ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æ–¹å¼ä¸€ï¼šä½¿ç”¨ &#123;&#125; å®šä¹‰ä¸€ä¸ª String ç±»å‹çš„ Set</span><br><span class="hljs-keyword">var</span> strSet = &#123;<span class="hljs-string">&quot;str&quot;</span>&#125;;<br><br><span class="hljs-comment">//2ã€æ–¹å¼äºŒï¼šå®šä¹‰ä¸€ä¸ªç©ºçš„ String ç±»å‹çš„ Set</span><br><span class="hljs-keyword">var</span> names = &lt;<span class="hljs-built_in">String</span>&gt;&#123;&#125;;<br><br><span class="hljs-comment">//3ã€æ–¹å¼ä¸‰ï¼šé€šè¿‡ Set å¯¹è±¡å®šä¹‰ä¸€ä¸ªå¯ä»¥ä¿å­˜ String ç±»å‹çš„ Set</span><br><span class="hljs-keyword">var</span> names = <span class="hljs-built_in">Set</span>&lt;<span class="hljs-built_in">String</span>&gt;();<br></code></pre></td></tr></table></figure><h4 id="3-2-2ã€å¸¸ç”¨-Api-ä»‹ç»"><a href="#3-2-2ã€å¸¸ç”¨-Api-ä»‹ç»" class="headerlink" title="3.2.2ã€å¸¸ç”¨ Api ä»‹ç»"></a>3.2.2ã€å¸¸ç”¨ Api ä»‹ç»</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€é¦–å…ˆå®šä¹‰ä¸€ä¸ª set é›†åˆ</span><br><span class="hljs-keyword">var</span> names = &lt;<span class="hljs-built_in">String</span>&gt;&#123;&#125;;<br><br><span class="hljs-comment">//2ã€æ·»åŠ ä¸€ä¸ªå…ƒç´  names:&#123;&quot;Dart&quot;&#125;</span><br>names.add(<span class="hljs-string">&quot;Dart&quot;</span>);<br><br><span class="hljs-comment">//3ã€æ·»åŠ ä¸€ä¸ª List æ•°ç»„ names:&#123;&quot;Dart&quot;,&quot;Flutter&quot;&#125;</span><br><span class="hljs-keyword">var</span> titles = [<span class="hljs-string">&quot;Flutter&quot;</span>];<br>names.addAll(titles);<br><br><span class="hljs-comment">//4ã€è·å– Set å¤§å°</span><br><span class="hljs-built_in">print</span>(names.length); <span class="hljs-comment">//æ‰“å°ï¼š2</span><br><br><span class="hljs-comment">//5ã€åˆ é™¤å…ƒç´ </span><br><span class="hljs-comment">//æ ¹æ®å…ƒç´ è¿›è¡Œåˆ é™¤ names:&#123;&quot;Dart&quot;&#125;</span><br>names.remove(<span class="hljs-string">&quot;Flutter&quot;</span>);<br><br><span class="hljs-comment">//6ã€åˆ¤æ–­ Set æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ </span><br>names.contains(<span class="hljs-string">&quot;Dart&quot;</span>); <span class="hljs-comment">//true</span><br><br><span class="hljs-comment">//7ã€æ¸…ç©º Set æ‰€æœ‰å…ƒç´  names:&#123;&#125;</span><br>names.clear();<br></code></pre></td></tr></table></figure><h3 id="3-3ã€Map-é›†åˆ"><a href="#3-3ã€Map-é›†åˆ" class="headerlink" title="3.3ã€Map é›†åˆ"></a>3.3ã€Map é›†åˆ</h3><h4 id="3-3-1ã€å®šä¹‰"><a href="#3-3-1ã€å®šä¹‰" class="headerlink" title="3.3.1ã€å®šä¹‰"></a>3.3.1ã€å®šä¹‰</h4><p>1ï¼‰ã€Dart ä¸­ map ç±»å‹ï¼Œå°±æ˜¯ä¸€ç§å“ˆå¸Œç±»å‹æ•°æ®ï¼Œmap ç±»å‹çš„æ•°æ®éƒ½æ˜¯ç”± key å’Œ value ä¸¤ä¸ªå€¼ç»„æˆï¼Œkey æ˜¯å”¯ä¸€çš„ï¼Œvalue ä¸å¿…å”¯ä¸€ï¼Œè¯»å†™æ•°æ®éƒ½æ˜¯é€šè¿‡ key è¿›è¡Œï¼Œmap ä¹Ÿæ˜¯æ³›å‹ç±»å‹ï¼Œæ”¯æŒä»»æ„ç±»å‹æ•°æ®ï¼Œkey å’Œ value å¯ä»¥æ˜¯ä»»æ„ç±»å‹æ•°æ®</p><p>2ï¼‰ã€map ä¸»è¦æœ‰ä»¥ä¸‹å››ç§æ–¹å¼åˆå§‹åŒ–ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€æ–¹å¼ä¸€ï¼šç›´æ¥ä»¥key, value çš„æ–¹å¼åˆå§‹åŒ–ä¸€ä¸ª map ç±»å‹å˜é‡ï¼Œ key å’Œ value éƒ½æ˜¯ String ç±»å‹</span><br><span class="hljs-keyword">var</span> map1 = &#123;<br>  <span class="hljs-comment">//æ ¼å¼  Key: Value</span><br>  <span class="hljs-string">&#x27;first&#x27;</span>: <span class="hljs-string">&#x27;partridge&#x27;</span>,<br>  <span class="hljs-string">&#x27;second&#x27;</span>: <span class="hljs-string">&#x27;turtledoves&#x27;</span>,<br>  <span class="hljs-string">&#x27;fifth&#x27;</span>: <span class="hljs-string">&#x27;golden rings&#x27;</span><br>&#125;;<br><br><span class="hljs-comment">//2ã€æ–¹å¼äºŒï¼šç›´æ¥é€šè¿‡ Map ç±»æ„é€ ä¸€ä¸ª map ç±»å‹å˜é‡, key ç±»å‹ä¸º String, value ç±»å‹ä¸º int</span><br><span class="hljs-keyword">var</span> map2 = <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">int</span>&gt;();<br><br><span class="hljs-comment">//3ã€æ–¹å¼ä¸‰ï¼šå®šä¹‰ä¸€ä¸ª key ç±»å‹ä¸º String, value ç±»å‹ä¸º int çš„ç©º Map</span><br><span class="hljs-keyword">var</span> map3 = &lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">int</span>&gt;&#123;&#125;<br><br><span class="hljs-comment">//4ã€æ–¹å¼å››ï¼šå®šä¹‰ä¸€ä¸ªç»•è¿‡ç¼–è¯‘æ£€æŸ¥çš„åŠ¨æ€ keyï¼Œvalue ç±»å‹ Map</span><br><span class="hljs-keyword">var</span> map4 = <span class="hljs-built_in">Map</span>(); <span class="hljs-comment">//ç­‰ä»·äºï¼švar map4 = &#123;&#125;;</span><br></code></pre></td></tr></table></figure><h4 id="3-3-2ã€å¸¸ç”¨-Api-ä»‹ç»"><a href="#3-3-2ã€å¸¸ç”¨-Api-ä»‹ç»" class="headerlink" title="3.3.2ã€å¸¸ç”¨ Api ä»‹ç»"></a>3.3.2ã€å¸¸ç”¨ Api ä»‹ç»</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€é¦–å…ˆå®šä¹‰ä¸€ä¸ª map</span><br><span class="hljs-keyword">var</span> map = &#123;&#125;;<br><br><span class="hljs-comment">//2ã€å‘ map æ·»åŠ æ•°æ® map:&#123;&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;&#125;</span><br><span class="hljs-comment">//ä½¿ç”¨ [] æ“ä½œç¬¦è¯»å†™ map æ•°æ®ï¼Œè¯­æ³•ï¼šmapå˜é‡[key]</span><br>map[<span class="hljs-string">&quot;key1&quot;</span>] = <span class="hljs-string">&quot;value1&quot;</span>;<br>map[<span class="hljs-string">&quot;key2&quot;</span>] = <span class="hljs-string">&quot;value2&quot;</span>;<br><br><span class="hljs-comment">//3ã€æŸ¥è¯¢ mapï¼šä½¿ç”¨[]æ“ä½œç¬¦ï¼Œæ ¹æ® key æŸ¥è¯¢å¯¹åº”çš„ value å€¼ï¼Œå¦‚æœ key ä¸å­˜åœ¨åˆ™è¿”å› null</span><br><span class="hljs-keyword">var</span> v1 = map[<span class="hljs-string">&quot;key1&quot;</span>];<br><span class="hljs-keyword">var</span> v2 = map[<span class="hljs-string">&quot;key2&quot;</span>];<br><br><span class="hljs-comment">//4ã€æ›´æ–° map æ•°æ®ï¼šæ ¹æ® key æ›´æ–° map æ•°æ®å’Œæ·»åŠ  map æ•°æ®ç”¨æ³•ä¸€æ ·</span><br><span class="hljs-comment">//å¦‚æœ key å€¼ä¸å­˜åœ¨åˆ™æ·»åŠ ï¼Œå¦åˆ™æ›´æ–° key çš„æ•°æ®</span><br><span class="hljs-comment">//map:&#123;&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;&#125;</span><br>map[<span class="hljs-string">&quot;key2&quot;</span>] = <span class="hljs-string">&quot;erdai&quot;</span>;<br><br><span class="hljs-comment">//5ã€è·å– map å¤§å°</span><br><span class="hljs-built_in">print</span>(map.length); <span class="hljs-comment">//æ‰“å°ï¼š2</span><br><br><span class="hljs-comment">//6ã€éå† map</span><br>map.forEach((k, v) &#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$k</span> <span class="hljs-subst">$v</span>&#x27;</span>);<br>&#125;);<br><br><span class="hljs-comment">//7ã€åˆ é™¤ map æ•°æ®ï¼šé€šè¿‡ remove å‡½æ•°å¯ä»¥åˆ é™¤æŒ‡å®šçš„ key æ•°æ®</span><br><span class="hljs-comment">//map:&#123;&quot;key2&quot;:&quot;value2&quot;&#125;</span><br>map.remove(<span class="hljs-string">&quot;key1&quot;</span>);<br><br><span class="hljs-comment">//8ã€æ¸…ç©ºæ‰€æœ‰ map æ•°æ® map:&#123;&#125;</span><br>map.clear();<br></code></pre></td></tr></table></figure><h2 id="å››ã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶"><a href="#å››ã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶" class="headerlink" title="å››ã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶"></a>å››ã€ç¨‹åºçš„é€»è¾‘æ§åˆ¶</h2><p>è¿™ä¸ªç« èŠ‚ç›¸å¯¹ç®€å•ï¼Œæˆ‘ä»¬å°±ç®€å•ä¸¾ä¸ªä¾‹å­</p><h3 id="4-1ã€if-else"><a href="#4-1ã€if-else" class="headerlink" title="4.1ã€if-else"></a>4.1ã€if-else</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">if</span> (isRaining()) &#123;<br>  <span class="hljs-comment">// ä»£ç 1</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isSnowing()) &#123;<br>  <span class="hljs-comment">// ä»£ç 2</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-comment">// ä»£ç 3</span><br>&#125;<br></code></pre></td></tr></table></figure><p>elseæ˜¯å¯é€‰çš„ï¼Œæ ¹æ®éœ€è¦ç»„åˆå³å¯</p><h3 id="4-2ã€for-i-å’Œ-for-in-å¾ªç¯"><a href="#4-2ã€for-i-å’Œ-for-in-å¾ªç¯" class="headerlink" title="4.2ã€for-i å’Œ for-in å¾ªç¯"></a>4.2ã€for-i å’Œ for-in å¾ªç¯</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å®šä¹‰ int æ•°ç»„</span><br><span class="hljs-keyword">var</span> list = [<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>];<br><br><span class="hljs-comment">//1ã€for-i å¾ªç¯éå†æ•°ç»„</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; list.length; i++) &#123;<br>  <span class="hljs-comment">// æ‰“å°æ•°ç»„å…ƒç´ </span><br>  <span class="hljs-built_in">print</span>(list[i]); <br>&#125;<br><br><span class="hljs-comment">//2ã€for-in å¾ªç¯éå†æ•°ç»„å˜é‡ list</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> v <span class="hljs-keyword">in</span> list) &#123;<br>  <span class="hljs-comment">// æ‰“å°æ•°ç»„å…ƒç´  v</span><br>  <span class="hljs-built_in">print</span>(v); <br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">5</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">6</span><br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="4-3ã€switchè¯­å¥"><a href="#4-3ã€switchè¯­å¥" class="headerlink" title="4.3ã€switchè¯­å¥"></a>4.3ã€switchè¯­å¥</h3><p>1ï¼‰ã€switch è¯­å¥çš„ä½œç”¨è·Ÿ if è¯­å¥ç±»ä¼¼ï¼Œç”¨äºæ£€æµ‹å„ç§æ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œç„¶åæ‰§è¡Œç›¸åº”åˆ†æ”¯çš„ä»£ç </p><p>2ï¼‰ã€switch æ”¯æŒæ£€æµ‹ intï¼ŒString ç±»å‹å˜é‡çš„æ£€æµ‹ï¼Œå½“ç„¶å¦‚æœä½ è‡ªå®šä¹‰çš„ç±»é‡è½½äº† &#x3D;&#x3D; æ“ä½œç¬¦ï¼Œä¹Ÿå¯ä»¥åœ¨ switch æ¡ä»¶ä¸­ä½¿ç”¨</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// æ¡ä»¶çŠ¶æ€å˜é‡</span><br><span class="hljs-keyword">var</span> command = <span class="hljs-string">&#x27;OPEN&#x27;</span>;<br><br><span class="hljs-keyword">switch</span> (command) &#123; <span class="hljs-comment">// éœ€è¦æ£€æµ‹çš„å˜é‡ </span><br>  <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;CLOSED&#x27;</span>:  <span class="hljs-comment">//case è¯­å¥ç”¨äºè®¾ç½®æ£€æµ‹æ¡ä»¶</span><br>    executeClosed(); <span class="hljs-comment">// å¦‚æœ command = &#x27;CLOSED&#x27;ï¼Œæ‰§è¡Œå½“å‰åˆ†æ”¯ä»£ç ã€‚</span><br>    <span class="hljs-keyword">break</span>; <span class="hljs-comment">// ç»“æŸå½“å‰åˆ†æ”¯æ‰§è¡Œé€»è¾‘</span><br>  <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;PENDING&#x27;</span>:<br>    executePending();<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;APPROVED&#x27;</span>:<br>    executeApproved();<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">default</span>: <span class="hljs-comment">// å¦‚æœä¸Šé¢çš„ case è¯­å¥éƒ½æ²¡æœ‰åŒ¹é…æˆåŠŸï¼Œåˆ™æ‰§è¡Œ default åˆ†æ”¯çš„é€»è¾‘ã€‚</span><br>    executeUnknown();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-4ã€while-å’Œ-do-while-å¾ªç¯è¯­å¥"><a href="#4-4ã€while-å’Œ-do-while-å¾ªç¯è¯­å¥" class="headerlink" title="4.4ã€while å’Œ do-while å¾ªç¯è¯­å¥"></a>4.4ã€while å’Œ do-while å¾ªç¯è¯­å¥</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€while å¾ªç¯è¯­å¥ä¾‹å­</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">// å®šä¹‰ int æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> list = [<span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>];<br><br>  <span class="hljs-comment">// å¾ªç¯éå†æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> (i &lt; list.length) &#123;<br>    <span class="hljs-comment">// æ¡ä»¶ä¸º true åˆ™æ‰§è¡Œå¾ªç¯ä½“ä»£ç </span><br>    <span class="hljs-built_in">print</span>(list[i]); <span class="hljs-comment">// æ‰“å°æ•°ç»„å…ƒç´ </span><br>    i++; <span class="hljs-comment">// æ•°ç»„ä¸‹æ ‡é€’å¢</span><br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€do-while å¾ªç¯è¯­å¥ä¾‹å­</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">// å®šä¹‰ int æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> list = [<span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>];<br><br>  <span class="hljs-comment">// å¾ªç¯éå†æ•°ç»„</span><br>  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span> &#123;<br>    <span class="hljs-built_in">print</span>(list[i]);<br>    i++;<br>  &#125; <span class="hljs-keyword">while</span> (i &lt; list.length); <span class="hljs-comment">// å…ˆæ‰§è¡Œå¾ªç¯ä½“ä»£ç åå†æ£€æµ‹å¾ªç¯æ¡ä»¶ï¼Œæ¡ä»¶ä¸º true åˆ™ç»§ç»­æ‰§è¡Œå¾ªç¯</span><br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">5</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">6</span><br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h2 id="äº”ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#äº”ã€é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="äº”ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>äº”ã€é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>Dart æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œå¯¹è±¡éƒ½æ˜¯ç”±ç±»åˆ›å»ºçš„ï¼Œæ‰€æœ‰ç±»éƒ½æ˜¯ç”± Object ç±»æ´¾ç”Ÿå‡ºæ¥çš„å­ç±»ï¼Œé™¤äº† Object , æ‰€æœ‰ç±»åªæœ‰ä¸€ä¸ªçˆ¶ç±»ï¼ˆå³åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼‰</p><p>å°½ç®¡ Dart è¯­è¨€ä¸­ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†æ˜¯ Dart è¯­è¨€æä¾›äº† mixin æœºåˆ¶ï¼Œå¯ä»¥å¤ç”¨å¤šä¸ªç±»ï¼Œè¾¾åˆ°ç±»ä¼¼å¤šç»§æ‰¿çš„æ•ˆæœ</p><h3 id="5-1ã€ç±»å’Œå¯¹è±¡"><a href="#5-1ã€ç±»å’Œå¯¹è±¡" class="headerlink" title="5.1ã€ç±»å’Œå¯¹è±¡"></a>5.1ã€ç±»å’Œå¯¹è±¡</h3><p>1ï¼‰ã€Dart æ²¡æœ‰ publicã€protected å’Œ private ç­‰æˆå‘˜è®¿é—®é™å®šç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹å±æ€§ï¼Œæ–¹æ³•ï¼Œç±»ç­‰éƒ½æ˜¯å…±æœ‰çš„ï¼Œç±»ä¼¼ Java çš„ publicã€‚å¦‚æœæƒ³è¦è¡¨ç¤ºç§æœ‰ï¼Œåˆ™ä»¥ä¸‹åˆ’çº¿ _ å¼€å¤´å»å‘½å</p><p>2ï¼‰ã€Dart ä¸­å®ä¾‹åŒ–å¯¹è±¡å’Œ Java ç±»ä¼¼ï¼Œnew å…³é”®å­—å¯å†™å¯ä¸å†™</p><p>3ï¼‰ã€å½“æˆ‘ä»¬åœ¨ç±»ä¸­åˆ›å»ºç§æœ‰å±æ€§æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ç»™ç§æœ‰å±æ€§æä¾› getter å’Œ setter æ–¹æ³•ä¾›å¤–ç•Œè®¿é—®ï¼š</p><p>get æ–¹æ³•è¯­æ³•æ ¼å¼ï¼š<strong>è¿”å›å€¼ç±»å‹ get æ–¹æ³•å { æ–¹æ³•ä½“ }</strong></p><p>set æ–¹æ³•è¯­æ³•æ ¼å¼ï¼š<strong>set æ–¹æ³•å ( å‚æ•° ) { æ–¹æ³•ä½“ }</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>  <span class="hljs-comment">// å®šä¹‰ç±»æˆå‘˜å±æ€§ï¼Œé»˜è®¤ç±»çš„æˆå‘˜å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯å…±æœ‰çš„ï¼Œç±»ä¼¼ java çš„ public</span><br>  <span class="hljs-keyword">var</span> name;<br>  <span class="hljs-comment">// ä»¥ä¸‹åˆ’çº¿ ( _ ) å¼€å¤´å‘½åçš„å±æ€§ä»£è¡¨ç§æœ‰æˆå‘˜å±æ€§</span><br>  <span class="hljs-keyword">var</span> _age;<br><br>  <span class="hljs-comment">// è·Ÿç±»ååŒåçš„æ–¹æ³•ï¼Œä¸ºæ„é€ æ–¹æ³•</span><br>  <span class="hljs-comment">// è¿™é‡Œè‡ªå®šä¹‰äº†ä¸€ä¸ªæºå¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚</span><br>  <span class="hljs-comment">// å¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰æ„é€ æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä¸å¸¦å‚æ•°çš„é»˜è®¤æ„é€ æ–¹æ³•</span><br>  Person(<span class="hljs-keyword">var</span> name, <span class="hljs-keyword">var</span> age) &#123;<br>    <span class="hljs-comment">// å› ä¸ºå‚æ•°åå’Œç±»å±æ€§ååŒåï¼Œå¯ä»¥ä½¿ç”¨thiså¼•ç”¨å½“å‰å¯¹è±¡</span><br>    <span class="hljs-keyword">this</span>.name = name;<br>    <span class="hljs-comment">// å¯ä»¥å¿½ç•¥thiså…³é”®å­—ï¼Œç›´æ¥å¼•ç”¨ç±»æˆå‘˜</span><br>    _age = age;<br>  &#125;<br>  <br>  <span class="hljs-comment">//ä¸º _age æä¾› getter å’Œ setter æ–¹æ³•</span><br>  <span class="hljs-built_in">int</span> <span class="hljs-keyword">get</span> age&#123;<br>    <span class="hljs-keyword">return</span> _age;<br>  &#125;<br>  <span class="hljs-comment">//getter æ–¹æ³•è¿˜å¯ä»¥ç®€åŒ–ä¸ºæ­¤å†™æ³•ï¼šint get age =&gt; _age;</span><br><br>  <span class="hljs-keyword">set</span> age(<span class="hljs-built_in">int</span> age)&#123;<br>    _age = age;<br>  &#125;<br><br>  <span class="hljs-comment">// å®šä¸€ä¸ª public çš„æ–¹æ³•</span><br>  <span class="hljs-built_in">String</span> greet(<span class="hljs-built_in">String</span> who) =&gt; <span class="hljs-string">&#x27;Hello, <span class="hljs-subst">$who</span>. I am <span class="hljs-subst">$name</span>, my age is <span class="hljs-subst">$_age</span> !&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> person = Person(<span class="hljs-string">&quot;erdai&quot;</span>,<span class="hljs-number">18</span>);<br>  <span class="hljs-comment">//ä¸‹é¢è¿™å¥å°±æ˜¯è°ƒç”¨äº† age çš„ set æ–¹æ³•</span><br>  person.age = <span class="hljs-number">20</span>;<br>  <span class="hljs-keyword">var</span> greet = person.greet(<span class="hljs-string">&quot;lucy&quot;</span>);<br>  <span class="hljs-built_in">print</span>(greet);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Hello, lucy. I am erdai, my age <span class="hljs-keyword">is</span> <span class="hljs-number">20</span> !<br></code></pre></td></tr></table></figure><h3 id="5-2ã€æ„é€ æ–¹æ³•"><a href="#5-2ã€æ„é€ æ–¹æ³•" class="headerlink" title="5.2ã€æ„é€ æ–¹æ³•"></a>5.2ã€æ„é€ æ–¹æ³•</h3><p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä¸å¸¦å‚æ•°çš„é»˜è®¤æ„é€ æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// è¿™ä¸ªç±»ä¼šç”Ÿæˆé»˜è®¤çš„æ„é€ æ–¹æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-built_in">String</span> name;<br>&#125;<br><br><span class="hljs-comment">// é€šè¿‡é»˜è®¤æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡</span><br><span class="hljs-keyword">var</span> p = Person();<br></code></pre></td></tr></table></figure><h4 id="5-2-1ã€è‡ªå®šä¹‰æ„é€ æ–¹æ³•"><a href="#5-2-1ã€è‡ªå®šä¹‰æ„é€ æ–¹æ³•" class="headerlink" title="5.2.1ã€è‡ªå®šä¹‰æ„é€ æ–¹æ³•"></a>5.2.1ã€è‡ªå®šä¹‰æ„é€ æ–¹æ³•</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span></span>&#123;<br>  <span class="hljs-keyword">var</span> x,y;<br>  <br>  Point(<span class="hljs-keyword">var</span> x,<span class="hljs-keyword">var</span> y)&#123;<br>    <span class="hljs-comment">// é€šè¿‡thisè®¿é—®æˆå‘˜å±æ€§ï¼Œå½“ç„¶ä¸€èˆ¬é™¤éå‡ºç°å‘½åå†²çªï¼Œå¦åˆ™å¯ä»¥å¿½ç•¥this</span><br>    <span class="hljs-keyword">this</span>.x = x;<br>    <span class="hljs-keyword">this</span>.y = y;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºæ„é€ æ–¹æ³•ä¸­ï¼Œç®€å•çš„èµ‹å€¼æ“ä½œï¼ŒDartè¯­è¨€æä¾›äº†æ›´ç®€æ´çš„è¯­æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span></span>&#123;<br>  <span class="hljs-keyword">var</span> x,y;<br><br>  <span class="hljs-comment">// ç›´æ¥å°†æ„é€ æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°èµ‹å€¼ç»™this.x, ç¬¬äºŒä¸ªå‚æ•°èµ‹å€¼ç»™this.y</span><br>  Point(<span class="hljs-keyword">this</span>.x,<span class="hljs-keyword">this</span>.y);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5-2-2ã€åˆå§‹åŒ–å‚æ•°åˆ—è¡¨"><a href="#5-2-2ã€åˆå§‹åŒ–å‚æ•°åˆ—è¡¨" class="headerlink" title="5.2.2ã€åˆå§‹åŒ–å‚æ•°åˆ—è¡¨"></a>5.2.2ã€åˆå§‹åŒ–å‚æ•°åˆ—è¡¨</h4><p>Dart è¿˜ä¸ºæ„é€ æ–¹æ³•æä¾›äº† <strong>å‚æ•°åˆå§‹åŒ–åˆ—è¡¨</strong> çš„è¯­æ³•ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡å‚æ•°</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span></span>&#123;<br>  <span class="hljs-keyword">var</span> x,y;<br><br>  <span class="hljs-comment">// å†’å· : åé¢çš„è¡¨è¾¾å¼å°±æ˜¯å‚æ•°åˆå§‹åŒ–åˆ—è¡¨ï¼Œæ¯ä¸ªè¡¨è¾¾å¼ç”¨é€—å·åˆ†éš”</span><br>  Point(<span class="hljs-keyword">var</span> x,<span class="hljs-keyword">var</span> y): <span class="hljs-keyword">this</span>.x = x,<span class="hljs-keyword">this</span>.y = y&#123;<br>    <span class="hljs-comment">// ä½¿ç”¨å‚æ•°åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–å¯¹è±¡å±æ€§ï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰åˆ«çš„åˆå§‹åŒ–å·¥ä½œè¦åšï¼Œå¯ä»¥æ˜¯ç©ºçš„</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5-2-3ã€å‘½åæ„é€ æ–¹æ³•"><a href="#5-2-3ã€å‘½åæ„é€ æ–¹æ³•" class="headerlink" title="5.2.3ã€å‘½åæ„é€ æ–¹æ³•"></a>5.2.3ã€å‘½åæ„é€ æ–¹æ³•</h4><p>1ï¼‰ã€Dart å¯ä»¥ä½¿ç”¨å‘½åæ„é€ æ–¹æ³•è¯­æ³•ï¼Œåˆ›å»ºå¤šä¸ªæ„é€ æ–¹æ³•ï¼Œå‘½åæ„é€ æ–¹æ³•è¯­æ³•æ ¼å¼ï¼š <strong>ç±»å.æ„é€ æ–¹æ³•å(å‚æ•°åˆ—è¡¨)</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span></span>&#123;<br>  <span class="hljs-keyword">var</span> x,y;<br><br>  Point(<span class="hljs-keyword">this</span>.x,<span class="hljs-keyword">this</span>.y);<br><br>  <span class="hljs-comment">// å‘½åæ„é€ æ–¹æ³• namedConstructor</span><br>  Point.namedConstructor()&#123;<br>    x = <span class="hljs-number">0</span>;<br>    y = <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-comment">// ä½¿ç”¨å‘½åæ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡</span><br>  <span class="hljs-keyword">var</span> point = Point.namedConstructor();<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ä¹Ÿå¯ä»¥æ”¹å†™ä¸ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span></span>&#123;<br>  <span class="hljs-keyword">var</span> x,y;<br><br>  Point(<span class="hljs-keyword">this</span>.x,<span class="hljs-keyword">this</span>.y);<br>  <span class="hljs-comment">// å‘½åæ„é€ æ–¹æ³• namedConstructor</span><br>  <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨å‚æ•°åˆå§‹åŒ–åˆ—è¡¨ï¼Œç›´æ¥é€šè¿‡ this è°ƒç”¨ä¸Šé¢çš„æ„é€ æ–¹æ³•ï¼Œä¼ å…¥ä¸¤ä¸ªå‚æ•° 0ï¼Œåˆå§‹åŒ–å¯¹è±¡</span><br>  Point.namedConstructor():<span class="hljs-keyword">this</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5-2-4ã€factory-æ„é€ æ–¹æ³•"><a href="#5-2-4ã€factory-æ„é€ æ–¹æ³•" class="headerlink" title="5.2.4ã€factory æ„é€ æ–¹æ³•"></a>5.2.4ã€factory æ„é€ æ–¹æ³•</h4><p>1ï¼‰ã€Dart æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„æ„é€ æ–¹æ³•ï¼Œç±»ä¼¼è®¾è®¡æ¨¡å¼ä¸­çš„å·¥å‚æ¨¡å¼ï¼Œç”¨æ¥åˆ›å»ºå¯¹è±¡</p><p>2ï¼‰ã€factory æ„é€ æ–¹æ³•åªèƒ½è®¿é—®é™æ€å±æ€§å’Œé™æ€æˆå‘˜æ–¹æ³•ï¼Œå› æ­¤ä¸èƒ½è®¿é—® this å¼•ç”¨</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å®šä¹‰ä¸ªæ—¥å¿—ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>&#123;<br>  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> name;<br>  <span class="hljs-built_in">bool</span> mute = <span class="hljs-keyword">false</span>;<br><br>  <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç§æœ‰çš„_cacheå±æ€§ï¼Œç”¨æ¥ä¿å­˜åˆ›å»ºå¥½çš„Loggerå¯¹è±¡</span><br>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, Logger&gt; _cache = &#123;&#125;;<br><br>  <span class="hljs-comment">// æ³¨æ„è¿™ä¸ªæ„é€ æ–¹æ³•ï¼Œå‰é¢ä½¿ç”¨äº†factoryå…³é”®å­—ä¿®é¥°ï¼Œè¿™ä»£è¡¨è¿™ä¸ªæ„é€ æ–¹æ³•æ˜¯ä¸€ä¸ªå·¥å‚æ„é€ æ–¹æ³•</span><br>  <span class="hljs-comment">// å·¥å‚æ„é€ æ–¹æ³•ä¸ä¼šæ¯æ¬¡éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„Loggerå¯¹è±¡</span><br>  <span class="hljs-keyword">factory</span> Logger(<span class="hljs-built_in">String</span> name) &#123;<br>    <span class="hljs-comment">// æ ¹æ®nameåˆ¤æ–­ç¼“å­˜çš„Loggerå¯¹è±¡æ˜¯å¦å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span> (_cache.containsKey(name)) &#123;<br>      <span class="hljs-comment">// è¿”å›ç¼“å­˜çš„Loggerå¯¹è±¡</span><br>      <span class="hljs-keyword">return</span> _cache[name]!;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œåˆ™è°ƒç”¨å‘½åæ„é€ æ–¹æ³•_internalåˆ›å»ºä¸€ä¸ªLoggerå¯¹è±¡</span><br>      <span class="hljs-keyword">final</span> logger = Logger._internal(name);<br>      <span class="hljs-comment">// æ ¹æ®nameç¼“å­˜logger</span><br>      _cache[name] = logger;<br>      <span class="hljs-comment">// è¿”å›æ–°çš„Loggerå¯¹è±¡</span><br>      <span class="hljs-keyword">return</span> logger;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// æ³¨æ„è¿™ä¸ªæ˜¯ä¸€ä¸ªç§æœ‰çš„å‘½åæ„é€ æ–¹æ³•ã€‚</span><br>  Logger._internal(<span class="hljs-keyword">this</span>.name);<br><br>  <span class="hljs-keyword">void</span> log(<span class="hljs-built_in">String</span> msg) &#123;<br>    <span class="hljs-keyword">if</span> (!mute) <span class="hljs-built_in">print</span>(msg);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> logger = Logger(<span class="hljs-string">&quot;erdai&quot;</span>);<br>  logger.log(logger.name);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br></code></pre></td></tr></table></figure><h3 id="5-3ã€ç»§æ‰¿å’Œå¤šæ€"><a href="#5-3ã€ç»§æ‰¿å’Œå¤šæ€" class="headerlink" title="5.3ã€ç»§æ‰¿å’Œå¤šæ€"></a>5.3ã€ç»§æ‰¿å’Œå¤šæ€</h3><h4 id="5-3-1ã€ç»§æ‰¿"><a href="#5-3-1ã€ç»§æ‰¿" class="headerlink" title="5.3.1ã€ç»§æ‰¿"></a>5.3.1ã€ç»§æ‰¿</h4><p>1ï¼‰ã€Dart é€šè¿‡ extend å…³é”®å­—ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œå’Œ Java ç±»ä¼¼</p><p>2ï¼‰ã€å­ç±»ä¼šç»§æ‰¿çˆ¶ç±»å¯è§çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¸ä¼šç»§æ‰¿æ„é€ æ–¹æ³•</p><p>3ï¼‰ã€å­ç±»èƒ½å¤Ÿå¤å†™çˆ¶ç±»çš„ getterï¼Œsetterï¼Œä»¥åŠæ™®é€šæ–¹æ³•ï¼Œä½¿ç”¨ @override è¡¨ç¤ºè¦†å†™</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span></span>&#123;<br>  <span class="hljs-built_in">String</span> name = <span class="hljs-string">&quot;&quot;</span>;<br>  <span class="hljs-built_in">int</span> age = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-comment">//è®¡ç®—å±æ€§</span><br>  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> adult =&gt; <span class="hljs-keyword">this</span>.age &gt; <span class="hljs-number">18</span>;<br><br>  <span class="hljs-comment">//ç§æœ‰å±æ€§ï¼Œå¯¹äºå­ç±»ä¸å¯è§</span><br>  <span class="hljs-built_in">String</span> _address = <span class="hljs-string">&quot;&quot;</span>;<br><br>  <span class="hljs-keyword">void</span> method()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Parent&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Children</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Parent</span></span>&#123;<br>  <br>  <span class="hljs-keyword">void</span> specificMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Children specificMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> child = Children();<br>  <span class="hljs-comment">//è°ƒç”¨å­ç±»è‡ªå·±çš„æ–¹æ³•</span><br>  child.specificMethod();<br>  <span class="hljs-comment">//è®¿é—®çˆ¶ç±»çš„å±æ€§</span><br>  child.name = <span class="hljs-string">&quot;erdai&quot;</span>;<br>  child.age = <span class="hljs-number">18</span>;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$&#123;child.name&#125;</span> <span class="hljs-subst">$&#123;child.age&#125;</span>&#x27;</span>);<br>  <span class="hljs-comment">//è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span><br>  child.method();<br>  <span class="hljs-comment">//è®¿é—®çˆ¶ç±»çš„è®¡ç®—å±æ€§</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$&#123;child.adult&#125;</span>&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Children specificMethod<br>erdai <span class="hljs-number">18</span><br>Parent<br><span class="hljs-keyword">false</span><br></code></pre></td></tr></table></figure><h4 id="5-3-2ã€å¤šæ€"><a href="#5-3-2ã€å¤šæ€" class="headerlink" title="5.3.2ã€å¤šæ€"></a>5.3.2ã€å¤šæ€</h4><p>1ï¼‰ã€ç®€å•çš„ç†è§£ï¼šå¤šæ€å°±æ˜¯å°†å­ç±»çš„å¯¹è±¡èµ‹å€¼ç»™çˆ¶ç±»çš„å¼•ç”¨ï¼ŒåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ä¼šæœ‰ä¸åŒçš„æ‰§è¡Œæ•ˆæœ</p><p>2ï¼‰ã€å¤šæ€çš„ä½“ç°ï¼šçˆ¶ç±»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè®©ç»§æ‰¿å®ƒçš„å­ç±»å»å®ç°ï¼Œæ¯ä¸ªå­ç±»æœ‰ä¸åŒçš„è¡¨ç°</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span></span>&#123;<br>  <span class="hljs-keyword">void</span> animalType()&#123;<br><br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> animalType() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;I am dog&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span></span>&#123;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> animalType() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;I am pig&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-comment">//å­ç±»çš„å¯¹è±¡èµ‹å€¼ç»™çˆ¶ç±»çš„å¼•ç”¨</span><br>  Animal animal1 = Dog();<br>  Animal animal2 = Pig();<br>  <span class="hljs-comment">//åŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ä¼šæœ‰ä¸åŒçš„æ‰§è¡Œæ•ˆæœ</span><br>  animal1.animalType();<br>  animal2.animalType();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>I am dog<br>I am pig<br></code></pre></td></tr></table></figure><h3 id="5-4ã€æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•"><a href="#5-4ã€æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•" class="headerlink" title="5.4ã€æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•"></a>5.4ã€æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•</h3><p>1ï¼‰ã€æŠ½è±¡ç±»å°±æ˜¯ä¸èƒ½å®ä¾‹åŒ–çš„ç±»ï¼Œé€šè¿‡ abstract å…³é”®å­—å£°æ˜</p><p>2ï¼‰ã€æŠ½è±¡æ–¹æ³•å°±æ˜¯æ²¡æœ‰å®ç°çš„æ–¹æ³•ï¼ŒDart ä¸­çš„æŠ½è±¡æ–¹æ³•ä¸èƒ½ç”¨ abstract å£°æ˜ï¼ŒDart ä¸­æ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•å°±ç§°ä¸ºæŠ½è±¡æ–¹æ³•</p><p>3ï¼‰ã€ç»§æ‰¿æŠ½è±¡ç±»ï¼Œå­ç±»å¿…é¡»è¦å®ç°æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// ä½¿ç”¨ abstract å…³é”®å­—ä¿®é¥°çš„ç±»ï¼Œå°±æ˜¯æŠ½è±¡ç±»</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Doer</span></span>&#123;<br>  <span class="hljs-comment">// æŠ½è±¡ç±»è·Ÿæ™®é€šç±»ä¸€æ ·ï¼Œå¯ä»¥å®šä¹‰æˆå‘˜å˜é‡ï¼Œæˆå‘˜æ–¹æ³•ã€‚</span><br>  <span class="hljs-built_in">String</span> name = <span class="hljs-string">&quot;&quot;</span>;<br>  <span class="hljs-comment">// å®šä¹‰ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æˆ‘ä»¬æ²¡æœ‰å®ç°å…·ä½“çš„åŠŸèƒ½</span><br>  <span class="hljs-keyword">void</span> doSomething();<br>&#125;<br><br><span class="hljs-comment">// ç»§æ‰¿æŠ½è±¡ç±» Doer</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EffectiveDoer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Doer</span></span>&#123;<br>  <span class="hljs-comment">// å®ç°æŠ½è±¡ç±»çš„æŠ½è±¡æ–¹æ³•</span><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> doSomething() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;doSomething&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> doer = EffectiveDoer();<br>  doer.doSomething();<br>  doer.name = <span class="hljs-string">&quot;erdai&quot;</span>;<br>  <span class="hljs-built_in">print</span>(doer.name);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>doSomething<br>erdai<br></code></pre></td></tr></table></figure><h3 id="5-5ã€æ¥å£"><a href="#5-5ã€æ¥å£" class="headerlink" title="5.5ã€æ¥å£"></a>5.5ã€æ¥å£</h3><p>1ï¼‰ã€Dart ä¸­çš„æ¥å£æ²¡æœ‰ä½¿ç”¨ interface å…³é”®å­—å®šä¹‰ï¼Œè€Œæ˜¯æ™®é€šç±»å’ŒæŠ½è±¡ç±»éƒ½å¯ä»¥ä½œä¸ºæ¥å£è¢«å®ç°ã€‚ä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯ç”¨æŠ½è±¡ç±»æ¥å®šä¹‰æ¥å£</p><p>2ï¼‰ã€å­ç±»é€šè¿‡ implements æ¥å®ç°æ¥å£</p><p>3ï¼‰ã€é»˜è®¤æƒ…å†µæ¯ä¸€ä¸ªç±»éƒ½<strong>éšå«</strong>ä¸€ä¸ªåŒ…å«æ‰€æœ‰å…¬æœ‰æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰çš„æ¥å£å®šä¹‰</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fruit</span></span>&#123;<br>  <span class="hljs-comment">// åŒ…å«åœ¨éšå¼æ¥å£é‡Œé¢</span><br>  <span class="hljs-built_in">String</span> name = <span class="hljs-string">&quot;&quot;</span>;<br>  <br>  <span class="hljs-comment">// æ„é€ æ–¹æ³•ä¸åŒ…å«åœ¨éšå¼æ¥å£é‡Œé¢</span><br>  Fruit(<span class="hljs-keyword">this</span>.name);<br>  <br>  <span class="hljs-comment">// åŒ…å«åœ¨éšå¼æ¥å£é‡Œé¢</span><br>  <span class="hljs-keyword">void</span> eat();<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Apple</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Fruit</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-built_in">String</span> name = <span class="hljs-string">&quot;è‹¹æœ&quot;</span>;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> eat() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;åƒ<span class="hljs-subst">$name</span>&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-keyword">var</span> fruit = Apple();<br>  fruit.eat();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>åƒè‹¹æœ<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šè™½ç„¶æ™®é€šç±»ä¹Ÿå¯ä»¥ä½œä¸ºæ¥å£å®ç°ï¼Œä½†æ˜¯ä¾ç„¶éœ€è¦å®ç°æ™®é€šç±»é‡Œé¢æ‰€æœ‰çš„å…¬æœ‰æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰ï¼Œå› æ­¤å»ºè®®å¤§å®¶ä½¿ç”¨æŠ½è±¡ç±»æ¥ä½œä¸ºæ¥å£å®ç°ï¼Œå› ä¸ºæŠ½è±¡ç±»æœ¬æ¥å°±æ˜¯ç”¨æ¥å®šä¹‰ç»™å­ç±»å®ç°çš„</p><h2 id="å…­ã€ç©ºå®‰å…¨æ£€æŸ¥"><a href="#å…­ã€ç©ºå®‰å…¨æ£€æŸ¥" class="headerlink" title="å…­ã€ç©ºå®‰å…¨æ£€æŸ¥"></a>å…­ã€ç©ºå®‰å…¨æ£€æŸ¥</h2><p>1ï¼‰ã€Dart åœ¨ 2.12 ç‰ˆæœ¬å’Œ Flutter 2.0 ä¸­å¼•å…¥äº†ç©ºå®‰å…¨çš„æ–°ç‰¹æ€§ï¼Œåœ¨ç©ºå®‰å…¨ç‰ˆæœ¬ä¸‹ï¼Œè¿è¡Œæ—¶çš„ <strong>NPE (NullPointer Exception)</strong> å¼‚å¸¸è¢«æå‰åˆ°äº†ç¼–è¯‘æœŸ</p><p>2ï¼‰ã€åœ¨ç©ºå®‰å…¨æ¨å‡ºä¹‹å‰ï¼Œé™æ€ç±»å‹ç³»ç»Ÿå…è®¸æ‰€æœ‰çš„ç±»å‹å€¼ä¸º nullï¼Œå› ä¸º Null æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»ã€‚è€Œåœ¨ç©ºå®‰å…¨æ¨å‡ºåï¼Œæ‰€æœ‰ç±»å‹é»˜è®¤ä¸ºä¸å¯ç©ºç±»å‹ï¼ŒNull ä¸å†æ˜¯æ‰€æœ‰ç±»çš„å­ç±»ï¼Œå®ƒå˜æˆäº†å’Œå…¶ä»–ç±»å‹å¹¶è¡Œçš„ç±»</p><p>3ï¼‰ã€Dart æ–°å¢äº†ä¸€äº›å…³é”®å­—ç”¨äºç©ºå®‰å…¨ï¼Œå¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>å…³é”®å­—</strong></th><th><strong>å«ä¹‰</strong></th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>?</td><td>å¯ç©º</td><td>int a?;</td></tr><tr><td>!</td><td>éç©º</td><td>int b &#x3D; a!;</td></tr><tr><td>late</td><td>å»¶è¿Ÿåˆå§‹åŒ–</td><td>late int a;</td></tr><tr><td>required</td><td>å¯é€‰å‚æ•°çš„ä¸å¯ç©º</td><td>{required int a}</td></tr></tbody></table><h3 id="6-1ã€ç©ºç±»å‹å£°æ˜ç¬¦-ï¼Ÿ"><a href="#6-1ã€ç©ºç±»å‹å£°æ˜ç¬¦-ï¼Ÿ" class="headerlink" title="6.1ã€ç©ºç±»å‹å£°æ˜ç¬¦ ï¼Ÿ"></a>6.1ã€<strong>ç©ºç±»å‹å£°æ˜ç¬¦ ï¼Ÿ</strong></h3><p>1ï¼‰ã€åœ¨ç±»å‹åé¢åŠ ä¸Š ï¼Ÿï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹</p><p>2ï¼‰ã€ä½¿ç”¨ var å…³é”®å­—å®šä¹‰çš„å˜é‡ä¹Ÿæ˜¯å¯ç©ºç±»å‹</p><p>3ï¼‰ã€å¯ç©ºç±»å‹å˜é‡çš„è°ƒç”¨ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸º null åˆ™è°ƒç”¨ï¼Œä¸º null åˆ™ä»€ä¹ˆéƒ½ä¸åš</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€åœ¨ç±»å‹åé¢åŠ ä¸Š ï¼Ÿï¼Œè¡¨ç¤ºå¯ç©ºç±»å‹</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª String çš„å¯ç©ºç±»å‹ï¼Œé»˜è®¤å€¼ä¸º null</span><br>  <span class="hljs-built_in">String?</span> str;<br>  <span class="hljs-comment">//ç¼–è¯‘æŠ¥çº¢ï¼Œå› ä¸ºå¯ç©ºç±»å‹éœ€è¦ä½¿ç”¨ ?. è°ƒç”¨</span><br>  <span class="hljs-comment">//æç¤ºï¼šThe property &#x27;length&#x27; can&#x27;t be unconditionally accessed because the receiver can be &#x27;null&#x27;.</span><br>  <span class="hljs-built_in">print</span>(str.length); <br>&#125;<br><br><span class="hljs-comment">//2ã€ä½¿ç”¨ var å…³é”®å­—å®šä¹‰çš„å˜é‡ä¹Ÿæ˜¯å¯ç©ºç±»å‹</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªåŠ¨æ€çš„å¯ç©ºç±»å‹ strï¼Œé»˜è®¤å€¼ä¸º null</span><br>  <span class="hljs-keyword">var</span> str;<br>  <span class="hljs-comment">//ä¸‹é¢è¿™å¥ä»£ç ä¼šç»•è¿‡ç¼–è¯‘å™¨æ£€æŸ¥ï¼Œä½†è¿è¡Œæ—¶ä¼šæŠ¥é”™ï¼šNoSuchMethodError: &#x27;length&#x27;</span><br>  <span class="hljs-built_in">print</span>(str.length);<br>&#125;<br><br><span class="hljs-comment">//3ã€å¯ç©ºç±»å‹å˜é‡çš„è°ƒç”¨ï¼Œä½¿ç”¨ ?. æ“ä½œç¬¦ï¼Œå®ƒè¡¨ç¤ºå¦‚æœå½“å‰å¯¹è±¡ä¸ä¸º null åˆ™è°ƒç”¨ï¼Œä¸º null åˆ™ä»€ä¹ˆéƒ½ä¸åš</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-built_in">String?</span> str1;<br>  <span class="hljs-keyword">var</span> str2;<br>  <span class="hljs-built_in">print</span>(str1?.length);<br>  <span class="hljs-built_in">print</span>(str2?.length);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-keyword">null</span><br><span class="hljs-keyword">null</span><br></code></pre></td></tr></table></figure><h3 id="6-2ã€éç©ºæ–­è¨€"><a href="#6-2ã€éç©ºæ–­è¨€" class="headerlink" title="6.2ã€éç©ºæ–­è¨€ !"></a>6.2ã€<strong>éç©ºæ–­è¨€ !</strong></h3><p>1ï¼‰ã€ä½¿ç”¨ ! å…³é”®å­—è¡¨ç¤ºå‘Šè¯‰ç¼–è¯‘å™¨è¿™æ˜¯ä¸€ä¸ªä¸å¯èƒ½ä¸ºç©ºçš„å˜é‡ã€‚å¦‚æœä¸ºç©ºï¼Œä½ å°±æŠ›å¼‚å¸¸</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-built_in">String?</span> getName() =&gt; <span class="hljs-string">&quot;erdai&quot;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br> <span class="hljs-built_in">String?</span> str = getName();<br> <span class="hljs-comment">//æ­¤æ—¶ä¼šç¼–è¯‘æŠ¥çº¢ï¼Œå› ä¸ºç¼–è¯‘å™¨æ— æ³•æ™ºèƒ½åˆ¤ç©º</span><br> <span class="hljs-comment">//print(str.length);</span><br> <span class="hljs-comment">//å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ ! å…³é”®å­—</span><br> <span class="hljs-built_in">print</span>(str!.length);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><h3 id="6-3ã€late-å»¶è¿Ÿåˆå§‹åŒ–"><a href="#6-3ã€late-å»¶è¿Ÿåˆå§‹åŒ–" class="headerlink" title="6.3ã€late å»¶è¿Ÿåˆå§‹åŒ–"></a>6.3ã€<strong>late å»¶è¿Ÿåˆå§‹åŒ–</strong></h3><p>1ï¼‰ã€late å…³é”®å­—ä¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼šè¿™æ˜¯ä¸ªéç©ºå˜é‡ï¼Œæˆ‘ç¨åä¼šåˆå§‹åŒ–</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//æ­¤æ—¶ä¼šç¼–è¯‘æŠ¥çº¢ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šå‘Šè¯‰æˆ‘ä»¬éç©ºå˜é‡å¿…é¡»å…ˆåˆå§‹åŒ–</span><br><span class="hljs-comment">//String str;</span><br><span class="hljs-comment">//å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ late å…³é”®å­—</span><br><span class="hljs-keyword">late</span> <span class="hljs-built_in">String</span> str;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  str = <span class="hljs-string">&quot;erdai&quot;</span>;<br>  <span class="hljs-built_in">print</span>(str);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>erdai<br></code></pre></td></tr></table></figure><h3 id="6-4ã€required-å…³é”®å­—"><a href="#6-4ã€required-å…³é”®å­—" class="headerlink" title="6.4ã€required å…³é”®å­—"></a>6.4ã€<strong>required å…³é”®å­—</strong></h3><p>1ï¼‰ã€required å…³é”®å­—ä¸»è¦æ˜¯ç”¨æ¥æ ‡è®°å‘½åå‚æ•°ï¼Œåœ¨ä½¿ç”¨æ—¶ä¸€å®šè¦ç»™ä»–ä»¬èµ‹å€¼ï¼Œä½¿å¾—ä»–ä»¬ä¸ä¸ºç©º</p><p>2ï¼‰ã€ä½¿ç”¨ required ä¿®é¥°çš„å‚æ•°ä¸èƒ½æä¾›é»˜è®¤å€¼</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> optionFunction(<span class="hljs-keyword">var</span> value1,&#123;<span class="hljs-keyword">required</span> <span class="hljs-keyword">var</span> value2,<span class="hljs-keyword">var</span> value3 = <span class="hljs-number">3</span>&#125;)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$value1</span> <span class="hljs-subst">$value2</span> <span class="hljs-subst">$value3</span>&#x27;</span>);<br>&#125; <br><br><span class="hljs-keyword">void</span> main() &#123;<br>  optionFunction(<span class="hljs-number">1</span>, value2: <span class="hljs-number">100</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">1</span> <span class="hljs-number">100</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h2 id="ä¸ƒã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½"><a href="#ä¸ƒã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½" class="headerlink" title="ä¸ƒã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½"></a>ä¸ƒã€æœ‰è¶£çš„è¿ç®—ç¬¦é‡è½½</h2><p>ä¸ Kotlin ç±»ä¼¼ï¼ŒDart çš„è¿ç®—ç¬¦é‡è½½å…è®¸æˆ‘ä»¬è®©ä»»æ„ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œç›¸åŠ ï¼Œæˆ–è€…æ˜¯è¿›è¡Œå…¶ä»–æ›´å¤šçš„è¿ç®—æ“ä½œ</p><p>1ï¼‰ã€è¿ç®—ç¬¦é‡è½½ä½¿ç”¨çš„æ˜¯ operator å…³é”®å­—ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æŒ‡å®šè¿ç®—ç¬¦å‰é¢åŠ ä¸Š operator å…³é”®å­—ï¼Œå°±å¯ä»¥å®ç°è¿ç®—ç¬¦é‡è½½çš„åŠŸèƒ½äº†ï¼ŒDart æ”¯æŒçš„é‡è½½è¿ç®—ç¬¦å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart">&lt;   +   |   []<br>&gt;   /   ^   []=<br>&lt;=  ~/  &amp;   ~<br>&gt;=  *   &lt;&lt;  ==<br>â€“   %   &gt;&gt;<br></code></pre></td></tr></table></figure><p>2ï¼‰ã€é‡è½½è¿ç®—ç¬¦çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart">å‡½æ•°è¿”å›å€¼ <span class="hljs-keyword">operator</span> è¿ç®—ç¬¦(è¿ç®—ç¬¦å‚æ•°) &#123;<br>    <span class="hljs-comment">// å®ç°è¿ç®—ç¬¦é‡è½½é€»è¾‘</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥å®è·µä¸€ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Money</span></span>&#123;<br>  <span class="hljs-built_in">int</span> value = <span class="hljs-number">0</span>;<br><br>  Money(<span class="hljs-keyword">this</span>.value);<br><br>  <span class="hljs-comment">//é‡è½½ + å·è¿ç®—ç¬¦, ä¸¤ä¸ª Money å¯¹è±¡ç›¸åŠ ,ç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ Money å¯¹è±¡</span><br>  Money <span class="hljs-keyword">operator</span> +(Money money)&#123;<br>    <span class="hljs-keyword">var</span> sum = value + money.value;<br>    <span class="hljs-keyword">return</span> Money(sum);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> money1 = Money(<span class="hljs-number">100</span>);<br>  <span class="hljs-keyword">var</span> money2 = Money(<span class="hljs-number">200</span>);<br>  <span class="hljs-comment">//ä¸¤ä¸ªå¯¹è±¡ç›¸åŠ </span><br>  <span class="hljs-keyword">var</span> money3 = money1 + money2;<br>  <span class="hljs-built_in">print</span>(money3.value);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…«ã€-mixin-æ··å…¥"><a href="#å…«ã€-mixin-æ··å…¥" class="headerlink" title="å…«ã€ mixin æ··å…¥"></a>å…«ã€ mixin æ··å…¥</h2><p>1ï¼‰ã€å‰é¢è¯´åˆ° Dart è¯­è¨€çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å®ç°ç±»ä¼¼å¤šç»§æ‰¿çš„æ•ˆæœå¯ä»¥ä½¿ç”¨ mixin æœºåˆ¶ï¼Œåˆå«æ··å…¥æœºåˆ¶ï¼Œä¾‹å¦‚æŠŠç±» A æ··å…¥åˆ°ç±» B ä¸­ï¼Œé‚£ä¹ˆç±» B å°±æ‹¥æœ‰äº†ç±» A çš„æˆå‘˜ï¼Œè·Ÿç»§æ‰¿çš„ç‰¹æ€§éå¸¸ç›¸ä¼¼</p><p>2ï¼‰ã€å®šä¹‰ä¸€ä¸ªå¯ä»¥è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ mixin å…³é”®å­—ä»£æ›¿ class å…³é”®å­—å³å¯</p><p>3ï¼‰ã€ç»§æ‰¿è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ with å…³é”®å­—ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä¸­é—´ç”¨ , éš”å¼€</p><p>4ï¼‰ã€è¢« mixin çš„ç±»åªèƒ½ç»§æ‰¿è‡ª Objectï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¸”ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</p><p>5ï¼‰ã€çˆ¶ç±»çº¦æŸï¼šå½“å£°æ˜ä¸€ä¸ª mixin æ—¶ï¼Œ on åé¢çš„ç±»å°±æ˜¯è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸã€‚ä¸€ä¸ªç±»è‹¥æ˜¯è¦ with è¿™ä¸ª mixinï¼Œåˆ™è¿™ä¸ªç±»å¿…é¡»ç»§æ‰¿æˆ–å®ç°è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸ</p><p>6ï¼‰ã€å°±è¿œå‘½ä¸­åŸåˆ™ï¼šå½“ with å¤šä¸ª mixinï¼Œå¤šä¸ª mixin æ‹¥æœ‰åŒä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è°ƒç”¨æ–¹æ³•æ—¶ä¼šå‘½ä¸­æœ€åä¸€ä¸ª mixin ç±»çš„æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªå¯ä»¥è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ mixin å…³é”®å­—ä»£æ›¿ class å…³é”®å­—å³å¯</span><br><span class="hljs-comment">//2ã€ç»§æ‰¿è¢« mixin çš„ç±»ï¼Œä½¿ç”¨ with å…³é”®å­—ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä¸­é—´ç”¨ , éš”å¼€</span><br><span class="hljs-keyword">mixin</span> A&#123;<br>  <span class="hljs-keyword">void</span> getA()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;A&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">mixin</span> B&#123;<br>  <span class="hljs-keyword">void</span> getB()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;B&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br>  <span class="hljs-keyword">void</span> getC()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;C&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CC</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">C</span> <span class="hljs-title">with</span> <span class="hljs-title">A</span>,<span class="hljs-title">B</span></span>&#123;&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> cc = CC();<br>  cc.getA();<br>  cc.getB();<br>  cc.getC();<br>  <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> A);<br>  <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> B);<br>  <span class="hljs-built_in">print</span>(cc <span class="hljs-keyword">is</span> C);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>A<br>B<br>C<br><span class="hljs-keyword">true</span><br><span class="hljs-keyword">true</span><br><span class="hljs-keyword">true</span><br>  <br><span class="hljs-comment">//3ã€è¢« mixin çš„ç±»åªèƒ½ç»§æ‰¿è‡ª Objectï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¸”ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span> </span>&#123;&#125;<br><br><span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™ï¼Œmixin ç±»ä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ï¼Œåªèƒ½ç»§æ‰¿è‡ª Object</span><br><span class="hljs-keyword">mixin</span> E <span class="hljs-keyword">extends</span> D&#123;<br>   <span class="hljs-comment">//ç¼–è¯‘æŠ¥é”™ï¼Œmixin ç±»ä¸èƒ½æœ‰æ„é€ æ–¹æ³•</span><br>   E();<br>&#125;<br><br><span class="hljs-comment">//4ã€çˆ¶ç±»çº¦æŸï¼šå½“å£°æ˜ä¸€ä¸ª mixin æ—¶ï¼Œ on åé¢çš„ç±»å°±æ˜¯è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸã€‚ä¸€ä¸ªç±»è‹¥æ˜¯è¦ with è¿™ä¸ª mixinï¼Œåˆ™è¿™ä¸ªç±»å¿…é¡»ç»§æ‰¿</span><br><span class="hljs-comment">//æˆ–å®ç°è¿™ä¸ª mixin çš„çˆ¶ç±»çº¦æŸ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">F</span></span>&#123;&#125;<br><br><span class="hljs-keyword">mixin</span> G <span class="hljs-keyword">on</span> F&#123;&#125;<br><br><span class="hljs-comment">//class I with G&#123;&#125; //ç¼–è¯‘æŠ¥é”™ï¼šclass I æ²¡æœ‰ç»§æ‰¿ mixin çš„çˆ¶ç±»çº¦æŸ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">I</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">F</span> <span class="hljs-title">with</span> <span class="hljs-title">G</span></span>&#123;&#125; <span class="hljs-comment">//ç¼–è¯‘é€šè¿‡ï¼Œclass I ç»§æ‰¿äº† mixin çš„çˆ¶ç±»çº¦æŸ</span><br><br><span class="hljs-comment">//5ã€å°±è¿œå‘½ä¸­åŸåˆ™ï¼šå½“ with å¤šä¸ª mixinï¼Œå¤šä¸ª mixin æ‹¥æœ‰åŒä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è°ƒç”¨æ–¹æ³•æ—¶ä¼šå‘½ä¸­æœ€åä¸€ä¸ª mixin ç±»çš„æ–¹æ³•</span><br><span class="hljs-keyword">mixin</span> Test1&#123;<br>  <span class="hljs-keyword">void</span> testMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test1 testMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">mixin</span> Test2&#123;<br>  <span class="hljs-keyword">void</span> testMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test2 testMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> <span class="hljs-title">with</span> <span class="hljs-title">Test1</span>,<span class="hljs-title">Test2</span></span>&#123;<br><br>&#125;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> test = Test();<br>  test.testMethod();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Test2 testMethod<br></code></pre></td></tr></table></figure><h2 id="ä¹ã€Dart-æ³›å‹"><a href="#ä¹ã€Dart-æ³›å‹" class="headerlink" title="ä¹ã€Dart æ³›å‹"></a>ä¹ã€Dart æ³›å‹</h2><p>æ³›å‹ç¼–ç¨‹æœºåˆ¶æœ€ä¸»è¦çš„ç›®çš„æ˜¯ä¸ºäº†ä»£ç å¤ç”¨ï¼Œé¿å…ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚å¦‚æœä½ å¯¹ Java ï¼ŒKotlin æ³›å‹å¾ˆç†Ÿæ‚‰ï¼Œä½ ä¼šè§‰å¾— Dart æ³›å‹éå¸¸ç®€å•ã€‚å¯¹ Java ï¼ŒKotlin æ³›å‹è¿˜ä¸ç†Ÿæ‚‰çš„ï¼Œçœ‹æˆ‘è¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6950042154496425992">ä¼ é€é—¨</a></p><p>1ï¼‰ã€Dart ä¸­æ³›å‹ä¸»è¦æœ‰ä»¥ä¸‹å››ç§ä½¿ç”¨ï¼š</p><p>1ã€æ³›å‹ç±»</p><p>2ã€æ³›å‹æ¥å£</p><p>3ã€æ³›å‹æ–¹æ³•</p><p>4ã€é™åˆ¶æ³›å‹ç±»å‹</p><h3 id="9-1ã€æ³›å‹ç±»ï¼Œæ³›å‹æ¥å£ï¼Œæ³›å‹æ–¹æ³•"><a href="#9-1ã€æ³›å‹ç±»ï¼Œæ³›å‹æ¥å£ï¼Œæ³›å‹æ–¹æ³•" class="headerlink" title="9.1ã€æ³›å‹ç±»ï¼Œæ³›å‹æ¥å£ï¼Œæ³›å‹æ–¹æ³•"></a>9.1ã€æ³›å‹ç±»ï¼Œæ³›å‹æ¥å£ï¼Œæ³›å‹æ–¹æ³•</h3><p>1ï¼‰ã€æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»ï¼Œæˆ–è€…æ¥å£çš„æ—¶å€™ï¼Œåœ¨ç±»ååé¢å¢åŠ æ³›å‹å‚æ•°ï¼Œå°±æ˜¯ä¸ºè¿™ä¸ªç±»æˆ–æ¥å£æ·»åŠ äº†ä¸€ä¸ªæ³›å‹</p><p>2ï¼‰ã€æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œåœ¨æ–¹æ³•ååé¢å¢åŠ æ³›å‹å‚æ•°ï¼Œå°±æ˜¯ä¸ºè¿™ä¸ªæ–¹æ³•æ·»åŠ äº†ä¸€ä¸ªæ³›å‹</p><p>3ï¼‰ã€æ³›å‹è¯­æ³•æ ¼å¼ï¼š<code>&lt;T&gt;</code> ï¼Œå¤šä¸ªæ³›å‹ä¹‹é—´ç”¨ , éš”å¼€ï¼š&lt;T,K&gt;</p><p>4ï¼‰ã€æ³›å‹å‚æ•°çš„å‘½åå¯ä»¥éšä¾¿å–ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¹ æƒ¯ä½¿ç”¨å¤§å†™å­—æ¯ä»£è¡¨æ³›å‹å‚æ•°</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//ä¸€ã€æ³›å‹ç±»</span><br><span class="hljs-comment">//1ã€å®šä¹‰æ³›å‹ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericClass</span>&lt;<span class="hljs-title">T</span>&gt;</span>&#123;<br><br>  T? name;<br><br>  GenericClass(<span class="hljs-keyword">this</span>.name);<br><br>  <span class="hljs-keyword">void</span> setName(T? value)&#123;<br>    name = value;<br>  &#125;<br><br>  T? getName()&#123;<br>    <span class="hljs-keyword">return</span> name;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æ³›å‹ç±»ä½¿ç”¨</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> genericClass = GenericClass&lt;<span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&quot;&quot;</span>);<br>  genericClass.setName(<span class="hljs-string">&quot;erdai&quot;</span>);<br>  <span class="hljs-built_in">print</span>(genericClass.getName());<br>&#125;<br><br><span class="hljs-comment">//3ã€æ‰“å°ç»“æœ</span><br>erdai<br>  <br><span class="hljs-comment">//äºŒã€æ³›å‹æ¥å£</span><br><span class="hljs-comment">//1ã€å®šä¹‰æ³›å‹æ¥å£</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericInterface</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt;</span>&#123;<br>  <span class="hljs-keyword">void</span> setKeyValue(K key,V value);<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰æ³›å‹æ¥å£å®ç°ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericInterfaceImpl</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">GenericInterface</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt;</span>&#123;<br><br>  <span class="hljs-keyword">var</span> map = &#123;&#125;;<br><br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> setKeyValue(K key, V value) &#123;<br>    map[key] = value;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//3ã€æ³›å‹æ¥å£ä½¿ç”¨</span><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> impl = GenericInterfaceImpl&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">int</span>&gt;();<br>  impl.setKeyValue(<span class="hljs-string">&quot;erdai&quot;</span>, <span class="hljs-number">666</span>);<br>  impl.map.forEach((key, value) &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;<span class="hljs-subst">$key</span> <span class="hljs-subst">$value</span>&#x27;</span>);<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment">//4ã€æ‰“å°ç»“æœ</span><br>erdai <span class="hljs-number">666</span><br><br><br><span class="hljs-comment">//ä¸‰ã€æ³›å‹æ–¹æ³•ï¼šç±»æ¯” Javaï¼ŒKotlin ä¸­çš„å†™æ³•</span><br><span class="hljs-comment">//Java ä¸­çš„å†™æ³•</span><br>public &lt;T&gt; <span class="hljs-keyword">void</span> genericMethod(T param)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//Kotlin ä¸­çš„å†™æ³•</span><br>fun &lt;T&gt; genericMethod(param: T)&#123;<br>  <br>&#125;<br><br><span class="hljs-comment">//Dart ä¸­çš„å†™æ³•</span><br><span class="hljs-keyword">void</span> genericMethod&lt;T&gt;(T param)&#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å®šä¹‰æ³›å‹ç±»ï¼Œæ³›å‹æ¥å£å’Œ Javaï¼ŒKotlin æ²¡å•¥åŒºåˆ«ï¼Œå€’æ˜¯å®šä¹‰æ³›å‹æ–¹æ³•ï¼Œå¤§å®¶éœ€è¦æ³¨æ„ï¼š</p><p>1ã€Java ä¸­æ–¹æ³•çš„æ³›å‹å®šä¹‰åœ¨è¿”å›å€¼çš„å‰é¢</p><p>2ã€Kotlin ä¸­çš„æ–¹æ³•æ³›å‹å®šä¹‰åœ¨æ–¹æ³•åçš„å‰é¢</p><p>3ã€Dart ä¸­çš„æ³›å‹å®šä¹‰åœ¨æ–¹æ³•åçš„åé¢</p><h3 id="9-2ã€é™åˆ¶æ³›å‹ç±»å‹"><a href="#9-2ã€é™åˆ¶æ³›å‹ç±»å‹" class="headerlink" title="9.2ã€é™åˆ¶æ³›å‹ç±»å‹"></a>9.2ã€é™åˆ¶æ³›å‹ç±»å‹</h3><p>1ï¼‰ã€é™åˆ¶æ³›å‹å‚æ•°ç±»å‹è¯­æ³•æ ¼å¼ï¼š&lt;æ³›å‹å‚æ•° extends çˆ¶ç±»&gt;</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseClass</span></span>&#123;<br><br>  <span class="hljs-keyword">void</span> baseMethod()&#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;BaseClass baseMethod...&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseClass</span></span>&#123;<br>  <span class="hljs-meta">@override</span><br>  <span class="hljs-keyword">void</span> baseMethod() &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Child baseMethod&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//T ç±»å‹å¿…é¡»æ˜¯ BaseClass æˆ–è€…å…¶å­ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseClass</span>&gt;</span>&#123;<br>  T? t;<br>  <br>  Foo(<span class="hljs-keyword">this</span>.t);<br><br>  <span class="hljs-keyword">void</span> fooTest()&#123;<br>    t?.baseMethod();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main()&#123;<br>  <span class="hljs-comment">//1ã€ä½¿ç”¨çˆ¶ç±» BaseClass ä½œä¸ºæ³›å‹å‚æ•°æ˜¯å…è®¸çš„</span><br>  <span class="hljs-keyword">var</span> baseClass = BaseClass();<br>  <span class="hljs-keyword">var</span> foo1 = Foo&lt;BaseClass&gt;(baseClass);<br>  foo1.fooTest();<br>  <br>  <span class="hljs-comment">//2ã€ä½¿ç”¨å­ç±» Child ä½œä¸ºæ³›å‹å‚æ•°</span><br>  <span class="hljs-keyword">var</span> childClass = Child();<br>  <span class="hljs-keyword">var</span> foo2 = Foo&lt;Child&gt;(childClass);<br>  foo2.fooTest();<br><br>  <span class="hljs-comment">//3ã€å¦‚æœä¸ä¼ å…¥ä»»ä½•æ³›å‹å‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨çˆ¶ç±» BaseClass ä½œä¸ºæ³›å‹å‚æ•°</span><br>  <span class="hljs-keyword">var</span> foo3 = Foo(baseClass);<br>  foo3.fooTest();<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>BaseClass baseMethod...<br>Child baseMethod<br>BaseClass baseMethod...<br></code></pre></td></tr></table></figure><h2 id="åã€Dart-Import-å¯¼å…¥åŒ…"><a href="#åã€Dart-Import-å¯¼å…¥åŒ…" class="headerlink" title="åã€Dart Import å¯¼å…¥åŒ…"></a>åã€Dart Import å¯¼å…¥åŒ…</h2><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¼å…¥æˆ‘ä»¬çš„æœ¬åœ°æ¨¡å—æˆ–è€…ç¬¬ä¸‰æ–¹å¼€æºåŒ…ã€‚Dart ä¸­ä¸»è¦é€šè¿‡ import æŒ‡ä»¤å¯¼å…¥åŒ…</p><h3 id="10-1ã€å¯¼å…¥å†…ç½®åŒ…"><a href="#10-1ã€å¯¼å…¥å†…ç½®åŒ…" class="headerlink" title="10.1ã€å¯¼å…¥å†…ç½®åŒ…"></a>10.1ã€å¯¼å…¥å†…ç½®åŒ…</h3><p>1ï¼‰ã€Dart å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„åŒ…ï¼Œè¿™äº›å†…ç½®çš„åŒ…ä¼šéšç€ Dart sdk ä¸€èµ·å®‰è£…åœ¨æœ¬åœ°</p><p>2ï¼‰ã€å¯¼å…¥å†…ç½®åŒ…ä½¿ç”¨ dart: ä½œä¸ºè·¯å¾„å‰ç¼€</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å¯¼å…¥å†…ç½® math åŒ…ï¼Œä½¿ç”¨ dart: ä½œä¸ºå‰ç¼€ã€‚</span><br><span class="hljs-comment">// math åŒ…ä¸»è¦æä¾›ä¸€äº›æ•°å­¦ç›¸å…³çš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼Œæ­£å¼¦å‡½æ•°ã€æ±‚æœ€å¤§å€¼å‡½æ•°ç­‰ç­‰</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:math&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">// è°ƒç”¨ math åŒ…ä¸­çš„ max å‡½æ•°ï¼Œæ±‚ä¸¤ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼ã€‚</span><br>  <span class="hljs-keyword">var</span> a = max(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<br>  <span class="hljs-built_in">print</span>(a); <span class="hljs-comment">//æ‰“å° 100</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="10-2ã€åŒ…çš„åˆ«å"><a href="#10-2ã€åŒ…çš„åˆ«å" class="headerlink" title="10.2ã€åŒ…çš„åˆ«å"></a>10.2ã€åŒ…çš„åˆ«å</h3><p>é»˜è®¤æƒ…å†µè°ƒç”¨åŒ…ä¸­çš„å‡½æ•°æˆ–è€…ç±»ï¼Œä¸éœ€è¦åŒ…åä½œä¸ºå‰ç¼€ï¼Œä¸Šé¢è°ƒç”¨äº† math åŒ…ä¸­çš„ max å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨åŒ…ä¸­çš„å‡½æ•°åã€‚ä½†æ˜¯è¿™æ ·ä¼šå­˜åœ¨å‘½åå†²çªçš„å¯èƒ½æ€§ï¼Œå¦‚æœå¯¼å…¥çš„ä¸¤ä¸ªåŒ…ï¼ŒåŒ…å«äº†åŒåçš„ç±»æˆ–è€…å‡½æ•°ï¼Œå°±ä¼šå‡ºç°å‘½åå†²çªï¼Œå› æ­¤æä¾›åˆ«åæœºåˆ¶</p><p>1ï¼‰ã€ä½¿ç”¨ as å…³é”®å­—æŒ‡å®šåŒ…çš„åˆ«å</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//ä½¿ç”¨ as å…³é”®å­—ï¼ŒæŒ‡å®šåŒ…çš„åˆ«å</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:math&#x27;</span> <span class="hljs-keyword">as</span> math;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">// ä½¿ç”¨åˆ«åï¼Œå¼•ç”¨åŒ…ä¸­çš„å‡½æ•° ã€‚</span><br>  <span class="hljs-keyword">var</span> a = math.max(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<br>  <span class="hljs-built_in">print</span>(a); <span class="hljs-comment">//æ‰“å° 100</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="10-3ã€å¯¼å…¥åŒ…çš„éƒ¨åˆ†å†…å®¹"><a href="#10-3ã€å¯¼å…¥åŒ…çš„éƒ¨åˆ†å†…å®¹" class="headerlink" title="10.3ã€å¯¼å…¥åŒ…çš„éƒ¨åˆ†å†…å®¹"></a>10.3ã€å¯¼å…¥åŒ…çš„éƒ¨åˆ†å†…å®¹</h3><p>1ï¼‰ã€æœ‰æ—¶å€™æˆ‘ä»¬ä¸æƒ³å¯¼å…¥æ•´ä¸ªåŒ…ï¼Œåªæƒ³å¯¼å…¥åŒ…é‡Œé¢çš„æŸä¸ªç±»æˆ–è€…æŸä¸ªå‡½æ•°ã€‚Dart æä¾›äº†show å’Œ hide å…³é”®å­—å¤„ç†å¯¼å…¥åŒ…çš„éƒ¨åˆ†å†…å®¹</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//1ã€ä»…å¯¼å…¥ max å‡½æ•°, å¯¼å…¥å¤šä¸ªå†…å®¹ä½¿ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ show max,sin</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:math&#x27;</span> <span class="hljs-keyword">show</span> max;<br><br><span class="hljs-comment">//2ã€é™¤äº†maxå‡½æ•°ï¼Œå¯¼å…¥ math ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:math&#x27;</span> <span class="hljs-keyword">hide</span> max;<br></code></pre></td></tr></table></figure><h3 id="10-4ã€å¯¼å…¥æœ¬åœ°æ¨¡å—"><a href="#10-4ã€å¯¼å…¥æœ¬åœ°æ¨¡å—" class="headerlink" title="10.4ã€å¯¼å…¥æœ¬åœ°æ¨¡å—"></a>10.4ã€å¯¼å…¥æœ¬åœ°æ¨¡å—</h3><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä¼šå¯¼å…¥æœ¬åœ°çš„æ¨¡å—ï¼Œä¸€èˆ¬é¡¹ç›®ä¸­ä¼šæœ‰å¤šä¸ª dart è„šæœ¬æ–‡ä»¶ï¼Œæ¯ä¸ª dart è„šæœ¬å®ç°ä¸åŒæ¨¡å—çš„ä»£ç ï¼Œåœ¨éœ€è¦çš„æ—¶å€™ç›´æ¥å¯¼å…¥ dart è„šæœ¬æ–‡ä»¶å³å¯</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//ä¾‹å¦‚æˆ‘æœ‰ä¸ªæœ¬åœ°æ¨¡å—ï¼šlibs/stack.dart</span><br><br><span class="hljs-comment">//å¯¼å…¥æœ¬åœ°æ¨¡å—</span><br><span class="hljs-comment">//ç›´æ¥é€šè¿‡æœ¬åœ°æ–‡ä»¶è·¯å¾„å¯¼å…¥ dart è„šæœ¬å³å¯</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;libs/stack.dart&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="10-5ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…"><a href="#10-5ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…" class="headerlink" title="10.5ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…"></a>10.5ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…</h3><h4 id="10-5-1ã€æŸ¥æ‰¾ç¬¬ä¸‰æ–¹å¼€æºåŒ…"><a href="#10-5-1ã€æŸ¥æ‰¾ç¬¬ä¸‰æ–¹å¼€æºåŒ…" class="headerlink" title="10.5.1ã€æŸ¥æ‰¾ç¬¬ä¸‰æ–¹å¼€æºåŒ…"></a>10.5.1ã€æŸ¥æ‰¾ç¬¬ä¸‰æ–¹å¼€æºåŒ…</h4><p><a href="https://pub.dev/">https://pub.dev/</a> ï¼šè¿™ä¸ªæ˜¯ pub çš„ä¸­å¤®ä»“åº“, ä¸Šé¢æœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹å¼€æºåŒ…ï¼Œå¯ä»¥åˆ°è¿™é‡Œæ‰¾åˆ°è‡ªå·±æƒ³è¦çš„åŒ…</p><h4 id="10-5-2ã€é…ç½®ä¾èµ–åŒ…"><a href="#10-5-2ã€é…ç½®ä¾èµ–åŒ…" class="headerlink" title="10.5.2ã€é…ç½®ä¾èµ–åŒ…"></a>10.5.2ã€é…ç½®ä¾èµ–åŒ…</h4><p>åœ¨é¡¹ç›®æ ¹ç›®å½• pubspec.yaml ä¸­é…ç½® dependencies å±æ€§ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><blockquote><p>dependencies:</p><p>åŒ…å: ç‰ˆæœ¬å·</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart">dependencies:<br>  http: ^<span class="hljs-number">0.13</span><span class="hljs-number">.5</span><br>  cupertino_icons: ^<span class="hljs-number">1.0</span><span class="hljs-number">.2</span><br></code></pre></td></tr></table></figure><p>å…³äºç‰ˆæœ¬å·è¯´æ˜ï¼Œå¦‚ä¸‹:</p><blockquote><p>^1.2.1 ä»£è¡¨çš„æ›´æ–°ç‰ˆæœ¬èŒƒå›´ä¸º &gt;&#x3D;1.2.1 &amp;&amp; &lt; 2.0.0</p><p>^0.2.1 ä»£è¡¨çš„æ›´æ–°ç‰ˆæœ¬èŒƒå›´ä¸º &gt;&#x3D;0.2.1 &amp;&amp; &lt; 0.3.0</p><p>^0.0.2 ä»£è¡¨çš„æ›´æ–°ç‰ˆæœ¬èŒƒå›´ä¸º 0.0.2ï¼ˆç›¸å½“äºé”å®šä¸ºäº† 0.0.2 ç‰ˆæœ¬ï¼‰</p></blockquote><p><strong>è§„å¾‹</strong>ï¼š å®åˆ™å°±æ˜¯æŠŠ ^ åé¢é 0 çš„æ•°å­— +1 ï¼Œç„¶åæŠŠå…¶ä»–ä½å˜ä¸º 0 å°±æ˜¯å®ƒçš„æœ€å¤§ç‰ˆæœ¬ã€‚å¦å¤–å¦‚æœæœ€åä¸€ä½é 0 ï¼Œå…¶ä»–ä½ä¸º 0 ï¼Œå°±ç›¸å½“äºé”ç‰ˆæœ¬ã€‚å¦‚ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart">æœ€å¤§ç‰ˆæœ¬ï¼š^<span class="hljs-number">1.2</span><span class="hljs-number">.1</span> =&gt; <span class="hljs-number">2.2</span><span class="hljs-number">.1</span> =&gt; <span class="hljs-number">2.0</span><span class="hljs-number">.0</span> èŒƒå›´ï¼š<span class="hljs-number">1.2</span><span class="hljs-number">.1</span><span class="hljs-number">-2.0</span><span class="hljs-number">.0</span><br>æœ€å¤§ç‰ˆæœ¬ï¼š^<span class="hljs-number">0.2</span><span class="hljs-number">.1</span> =&gt; <span class="hljs-number">0.3</span><span class="hljs-number">.1</span> =&gt; <span class="hljs-number">0.3</span><span class="hljs-number">.0</span> èŒƒå›´ï¼š<span class="hljs-number">0.2</span><span class="hljs-number">.1</span><span class="hljs-number">-0.3</span><span class="hljs-number">.0</span><br>^<span class="hljs-number">0.0</span><span class="hljs-number">.2</span>ï¼šå›ºå®šç‰ˆæœ¬ï¼š<span class="hljs-number">0.0</span><span class="hljs-number">.2</span><br></code></pre></td></tr></table></figure><h4 id="10-5-3ã€ä¸‹è½½ä¾èµ–åŒ…"><a href="#10-5-3ã€ä¸‹è½½ä¾èµ–åŒ…" class="headerlink" title="10.5.3ã€ä¸‹è½½ä¾èµ–åŒ…"></a>10.5.3ã€ä¸‹è½½ä¾èµ–åŒ…</h4><p>æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">flutter pub <span class="hljs-keyword">get</span><br></code></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥ä½¿ç”¨å¼€å‘å·¥å…·çš„å¯è§†åŒ–ç•Œé¢æ“ä½œ</p><h4 id="10-5-4ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…"><a href="#10-5-4ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…" class="headerlink" title="10.5.4ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…"></a>10.5.4ã€å¯¼å…¥ç¬¬ä¸‰æ–¹å¼€æºåŒ…</h4><p>ä¾èµ–åŒ…ä¸‹è½½å®‰è£…åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ import å¯¼å…¥ç¬¬ä¸‰æ–¹åŒ…ï¼Œç¬¬ä¸‰æ–¹åŒ…å‰ç¼€ä¸º package:</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// è¿™é‡Œå¯¼å…¥ http åŒ…ï¼Œåˆ«åä¸º http</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br></code></pre></td></tr></table></figure><h2 id="åä¸€ã€Dart-å¼‚å¸¸å¤„ç†"><a href="#åä¸€ã€Dart-å¼‚å¸¸å¤„ç†" class="headerlink" title="åä¸€ã€Dart å¼‚å¸¸å¤„ç†"></a>åä¸€ã€Dart å¼‚å¸¸å¤„ç†</h2><p>ç±»ä¼¼ Javaï¼ŒDart æä¾›äº† Exception å’Œ Error ä¸¤ç§ç±»å‹çš„å¼‚å¸¸ä»¥åŠä¸€äº›å­ç±»</p><p>1ï¼‰ã€ä½¿ç”¨ throw å…³é”®å­—æŠ›å‡ºè‡ªå®šä¹‰ç±»å‹å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥å°†ä»»ä½•é null å¯¹è±¡ä½œä¸ºå¼‚å¸¸æŠ›å‡º</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">&#x27;è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸&#x27;</span>);<br><span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>å°å»ºè®®</strong>ï¼šä¸€èˆ¬å»ºè®®æŠ›å‡º Exception å’Œ Error , æˆ–è€…ä»–ä»¬çš„å­ç±»</p><p>2ï¼‰ã€ä½¿ç”¨ try&#x2F;on catch é…åˆæ•è·å¼‚å¸¸</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">var</span> s;<br>    <span class="hljs-built_in">print</span>(s.length);<br>  &#125; <span class="hljs-keyword">on</span> NoSuchMethodError <span class="hljs-keyword">catch</span> (e) &#123;<br>    <span class="hljs-comment">//æ•è·å¼‚å¸¸å¹¶æ‰“å°</span><br>    <span class="hljs-built_in">print</span>(e);<br>  &#125; <span class="hljs-keyword">catch</span> (e, s) &#123;<br>    <span class="hljs-comment">//å…œåº•å¤„ç† eï¼šæŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ sï¼šæ ˆä¿¡æ¯ï¼Œæ­¤å‚æ•°å¯å†™å¯ä¸å†™</span><br>    <span class="hljs-built_in">print</span>(e);<br>    <span class="hljs-built_in">print</span>(s);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€ä½¿ç”¨ on å’Œ catch æ¥æ•è·å¼‚å¸¸ï¼šon ç”¨æ¥æŒ‡å®šå¼‚å¸¸çš„ç±»å‹ï¼Œcatch åˆ™ç”¨æ¥æ•è·å¯¹è±¡</p><p>2ã€å½“æŠ›å‡ºçš„é”™è¯¯å¹¶ä¸æ˜¯ on æŒ‡å®šçš„å¼‚å¸¸ç±»å‹æ—¶ï¼Œåˆ™èµ°æœ€åé¢çš„ catch å…œåº•</p><p>3ã€å…œåº• catch æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ ˆä¿¡æ¯</p><p>3ï¼‰ã€ä½¿ç”¨ rethrow å†æ¬¡æŠ›å‡ºå¼‚å¸¸</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> exceptionMethod()&#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-built_in">dynamic</span> b = <span class="hljs-keyword">true</span>;<br>    <span class="hljs-built_in">print</span>(b++); <span class="hljs-comment">//NoSuchMethodError</span><br>  &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>    <span class="hljs-keyword">rethrow</span>; <span class="hljs-comment">//å°†ä¸Šè¿°å¼‚å¸¸å†æ¬¡æŠ›å‡º</span><br>  &#125;<br>&#125;<br><br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    exceptionMethod();<br>  &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>    <span class="hljs-comment">//æ•è·å¼‚å¸¸å¹¶æ‰“å°</span><br>    <span class="hljs-built_in">print</span>(e);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åäºŒã€Dart-å¼‚æ­¥å¤„ç†"><a href="#åäºŒã€Dart-å¼‚æ­¥å¤„ç†" class="headerlink" title="åäºŒã€Dart å¼‚æ­¥å¤„ç†"></a>åäºŒã€Dart å¼‚æ­¥å¤„ç†</h2><p>Dart æ˜¯å•çº¿ç¨‹æ¨¡å‹çš„è¯­è¨€ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç¨‹åºä¸­åšè€—æ—¶æ“ä½œï¼šè¯·æ±‚ Api æ¥å£ï¼Œæ–‡ä»¶ IO ç­‰ï¼Œå°±å¯èƒ½å¯¼è‡´ç‚¹å‡»äº‹ä»¶æ²¡æœ‰å“åº”ï¼Œç¨‹åºå¡é¡¿ä¹‹ç±»çš„æƒ…å†µã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼ŒDart å¼•å…¥äº†å¼‚æ­¥æ“ä½œæœºåˆ¶ï¼š</p><p>1ã€Dart å¼‚æ­¥å¤„ç†ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥ç»§ç»­è¿è¡Œ</p><p>2ã€å› ä¸º Dart çš„å¼‚æ­¥æœºåˆ¶å¹¶ä¸æ¶‰åŠçº¿ç¨‹çš„åˆ‡æ¢ï¼Œä»…ä»…æ˜¯ç”±æˆ‘ä»¬çš„ç¼–ç¨‹è¯­è¨€å»æ§åˆ¶ï¼Œæ‰€ä»¥å®ƒçš„æ‰§è¡Œæ•ˆç‡éå¸¸é«˜</p><h3 id="12-1ã€Dart-å¼‚æ­¥å¤„ç†çš„ç”¨æ³•"><a href="#12-1ã€Dart-å¼‚æ­¥å¤„ç†çš„ç”¨æ³•" class="headerlink" title="12.1ã€Dart å¼‚æ­¥å¤„ç†çš„ç”¨æ³•"></a>12.1ã€Dart å¼‚æ­¥å¤„ç†çš„ç”¨æ³•</h3><p>1ï¼‰ã€Dart è¯­è¨€ä¸­ï¼Œæœ‰å¾ˆå¤šåº“çš„å‡½æ•°è¿”å› Future æˆ–è€… Stream å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½æ˜¯ Dart å¯¹å¼‚æ­¥ç¼–ç¨‹æ”¯æŒçš„å®ç°</p><p>Future - ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥è®¡ç®—ä»»åŠ¡ï¼Œå¯ä»¥è·å–ä»»åŠ¡çš„è®¡ç®—ç»“æœ</p><p>Stream - ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥çš„æ•°æ®åºåˆ—ï¼Œé€šå¸¸ç”¨äºè¯»å–è¿ç»­çš„æ•°æ®æˆ–è€…äº‹ä»¶</p><h4 id="12-1-1ã€Future"><a href="#12-1-1ã€Future" class="headerlink" title="12.1.1ã€Future"></a>12.1.1ã€Future</h4><p>1ï¼‰ã€Futureä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„è®¡ç®—ä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡è¿˜æ²¡æ‰§è¡Œå®Œæˆï¼Œæˆ‘ä»¬æ˜¯æ‹¿ä¸åˆ°å¼‚æ­¥ä»»åŠ¡çš„ç»“æœ</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-keyword">var</span> url = <span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>;<br>  <span class="hljs-comment">//è°ƒç”¨ get å‡½æ•°è¯·æ±‚ url, è¿”å›ä¸€ä¸ªå°è£…äº† http è¯·æ±‚ä»»åŠ¡çš„ future å¯¹è±¡</span><br>  Future fTask = http.<span class="hljs-keyword">get</span>(<span class="hljs-built_in">Uri</span>.parse(url));<br>  <span class="hljs-comment">//æ‰“å° future å¯¹è±¡</span><br>  <span class="hljs-built_in">print</span>(fTask);<br>  <br>  <span class="hljs-comment">// å‘ future å¯¹è±¡æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå¤„ç†è¯·æ±‚ç»“æœ</span><br>  fTask.then((response) =&gt; &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Response status: <span class="hljs-subst">$&#123;response.statusCode&#125;</span>&#x27;</span>)<br>  &#125;);<br>  <span class="hljs-comment">// æ‰“å° main å‡½æ•°ç»“æŸæ ‡è®°</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;main end...&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Instance of <span class="hljs-string">&#x27;Future&lt;Response&gt;&#x27;</span><br>main end...<br>Response status: <span class="hljs-number">200</span><br><br>Process finished <span class="hljs-keyword">with</span> exit code <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€é¦–å…ˆæ‰“å°äº† fTask ï¼Œè¾“å‡ºè¡¨ç¤º fTask æ˜¯ä¸€ä¸ª Future å¯¹è±¡ï¼Œå°†æ¥ä¼šè¿”å›ä¸€ä¸ªå« Response çš„ç»“æœå¯¹è±¡</p><p>2ã€æ¥ä¸‹æ¥æ‰“å°äº† main endâ€¦ ï¼Œè€Œä¸æ˜¯å…ˆè¾“å‡º http çš„è¯·æ±‚çŠ¶æ€ç </p><p>3ã€æœ€åæ‰“å°äº† http çš„è¯·æ±‚çŠ¶æ€ç ï¼šResponse status: 200 ï¼Œç„¶åè¿›ç¨‹ä¹Ÿé€€å‡ºäº†</p><p>ä¸Šé¢è¿™æ®µç¨‹åºåœ¨æ‰“å°äº† main endâ€¦ æ—¶è¿›ç¨‹å¹¶æ²¡æœ‰é€€å‡ºï¼Œè€Œæ˜¯ç­‰åˆ°æ‰“å°äº† http çš„è¯·æ±‚çŠ¶æ€ç ï¼šResponse status: 200 æ‰é€€å‡ºï¼Œè¿™ä¹ŸéªŒè¯äº†æˆ‘ä»¬å‰é¢ä¸€ä¸ªè§‚ç‚¹ï¼š <strong>Dart çš„å¼‚æ­¥æœºåˆ¶å¹¶ä¸æ¶‰åŠçº¿ç¨‹çš„åˆ‡æ¢ï¼Œä»…ä»…æ˜¯ç”±æˆ‘ä»¬çš„ç¼–ç¨‹è¯­è¨€å»æ§åˆ¶ï¼Œæ‰€ä»¥å®ƒçš„æ‰§è¡Œæ•ˆç‡éå¸¸é«˜</strong></p><h4 id="12-1-2ã€await-å’Œ-async"><a href="#12-1-2ã€await-å’Œ-async" class="headerlink" title="12.1.2ã€await å’Œ async"></a>12.1.2ã€await å’Œ async</h4><p>ä¸Šè¿°è¿™ä¸ªä¾‹å­å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š</p><p>1ã€éœ€è¦æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå¦‚æœæˆ‘æœ‰å¤šå±‚å›è°ƒï¼Œå¯è¯»æ€§å°±ä¼šå˜å¾—å¾ˆå·®</p><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ await å’Œ async æœºåˆ¶æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”å®ƒè¿˜èƒ½è®©æˆ‘ä»¬ä½¿ç”¨åŒæ­¥çš„æ–¹å¼å†™å‡ºå¼‚æ­¥çš„ä»£ç </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() <span class="hljs-keyword">async</span>&#123;<br>  <span class="hljs-keyword">var</span> url = <span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>;<br>  <span class="hljs-comment">//è¯·æ±‚ url, é€šè¿‡ awaitï¼Œç­‰å¾… future å¼‚æ­¥è®¡ç®—ä»»åŠ¡çš„ç»“æœï¼Œæ‰§è¡ŒæˆåŠŸå°±ç›´æ¥è¿”å›ç»“æœ</span><br>  <span class="hljs-keyword">var</span> response = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(<span class="hljs-built_in">Uri</span>.parse(url));<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Response status: <span class="hljs-subst">$&#123;response.statusCode&#125;</span>&#x27;</span>);<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;main end...&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Response status: <span class="hljs-number">200</span><br>main end...<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€è¾“å‡ºç»“æœçš„é¡ºåºï¼Œè·Ÿæˆ‘ä»¬ä¹¦å†™ä»£ç çš„é¡ºåºä¸€è‡´</p><p>2ã€é€šè¿‡æ ‡è®° async å’Œ await å…³é”®å­—ï¼Œæˆ‘ä»¬çš„å¼‚æ­¥ä»£ç ï¼Œçœ‹èµ·æ¥è·ŸåŒæ­¥ä»£ç æ²¡ä»€ä¹ˆåŒºåˆ«ï¼š</p><blockquote><p>1ã€async å…³é”®å­—çš„ä½œç”¨å°±æ˜¯æ ‡è®°ä¸€ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥å‡½æ•°</p><p>2ã€await å…³é”®å­—çš„ä½œç”¨æ˜¯ç­‰å¾…å¼‚æ­¥ä»»åŠ¡çš„ç»“æœ</p></blockquote><p><strong>æ³¨æ„ï¼š</strong> await å…³é”®å­—åªèƒ½åœ¨æ ‡è®°äº†async çš„å¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><h4 id="12-1-3ã€Stream"><a href="#12-1-3ã€Stream" class="headerlink" title="12.1.3ã€Stream"></a>12.1.3ã€Stream</h4><p>1ï¼‰ã€Stream ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥çš„æ•°æ®åºåˆ—ï¼Œæ˜¯ä¸€ç§å¼‚æ­¥è¯»å–æµå¼æ•°æ®çš„æ–¹å¼ï¼Œä½¿ç”¨æ ¼å¼å¦‚ä¸‹ï¼š</p><blockquote><p>await for (æ•°æ®ç±»å‹ å˜é‡ in streamç±»å‹å˜é‡) {</p><p>&#x2F;&#x2F; å¤„ç†æ•°æ®</p><p>}</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs dart">Future&lt;<span class="hljs-built_in">int</span>&gt; sumStream(Stream&lt;<span class="hljs-built_in">int</span>&gt; stream) <span class="hljs-keyword">async</span> &#123;<br>  <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">await</span> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> value <span class="hljs-keyword">in</span> stream) &#123;<br>    sum += value;<br>  &#125;<br>  <span class="hljs-keyword">return</span> sum;<br>&#125;<br><br><span class="hljs-comment">//async* è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªéœ€è¿”å› Stream ç±»å‹å‚æ•°çš„å¼‚æ­¥å‡½æ•°</span><br>Stream&lt;<span class="hljs-built_in">int</span>&gt; countStream(<span class="hljs-built_in">int</span> to) <span class="hljs-keyword">async</span>* &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">1</span>; i &lt;= to; i++) &#123;<br>    <span class="hljs-comment">//yield åœ¨è¿™é‡Œè¡¨ç¤ºæš‚æ—¶è®©å‡ºèµ„æºè®©å…¶ä»–ä»£ç æ‰§è¡Œ</span><br>    <span class="hljs-keyword">yield</span> i;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">void</span> main() <span class="hljs-keyword">async</span>&#123;<br>  <span class="hljs-keyword">var</span> stream = countStream(<span class="hljs-number">10</span>);<br>  <span class="hljs-comment">//é€šè¿‡ await ç­‰å¾… sumStream è®¡ç®—è¿”å›ç»“æœ</span><br>  <span class="hljs-keyword">var</span> sum = <span class="hljs-keyword">await</span> sumStream(stream);<br>  <span class="hljs-built_in">print</span>(sum);<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">55</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨ await æ ‡è®° for in å¾ªç¯è¯­å¥ï¼Œå¾ªç¯è¯»å– stream ç±»å‹å˜é‡ä¸­çš„æ•°æ®ï¼Œä»£ç ä¹¦å†™ä¹Ÿå¾ˆç›´è§‚ï¼Œè·ŸåŒæ­¥ä»£ç çš„ä¹¦å†™æ–¹å¼ä¸€è‡´</p><h2 id="åä¸‰ã€Dart-Isolate-å¹¶å‘"><a href="#åä¸‰ã€Dart-Isolate-å¹¶å‘" class="headerlink" title="åä¸‰ã€Dart Isolate å¹¶å‘"></a>åä¸‰ã€Dart Isolate å¹¶å‘</h2><p>æˆ‘ä»¬çŸ¥é“ä¸€èˆ¬å¸¸ç”¨çš„å¹¶å‘æœºåˆ¶ä¸»è¦åŒ…æ‹¬è¿›ç¨‹ï¼Œçº¿ç¨‹ä»¥åŠåé¢çš„åç¨‹ã€‚ä½†æ˜¯ Dart ä¸ä¸€èˆ¬ ğŸ˜‚ ï¼ŒDart ä¸­çš„å¹¶å‘æœºåˆ¶ä¸»è¦æ˜¯ç”± Isolate å»å®ç°çš„ã€‚æ‰€è°“ Isolate ï¼Œä½ å¯ä»¥ç®€å•çš„ç†è§£æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹</p><p>Isolate çš„ç‰¹ç‚¹ï¼š</p><p>1ã€Isolate ä¹‹é—´ä¸èƒ½å…±äº«å†…å­˜</p><p>2ã€Isolate ä¹‹é—´åªèƒ½é€šè¿‡æ¶ˆæ¯é€šè®¯</p><p>ä¸èƒ½å…±äº«å†…å­˜ï¼Œæ„å‘³ç€ä½ ä¸èƒ½åƒçº¿ç¨‹é‚£æ ·é€šè¿‡å˜é‡å…±äº«çŠ¶æ€ï¼Œæ¯ä¸ª Isolate éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ï¼Œè¿™æ ·è®¾è®¡çš„å¥½å¤„<strong>å°±æ˜¯ä½ ä¸ç”¨åŠ é”ï¼Œä¹Ÿèƒ½å®‰å…¨çš„æ“ä½œè‡ªå·±çš„æ•°æ®</strong></p><p>è¿™é‡Œä½ æ˜¯å¦ä¼šæœ‰ä¸€ä¸ªç–‘é—®ğŸ¤”ï¸ï¼šå‰é¢æˆ‘ä»¬é€šè¿‡ Dart å¼‚æ­¥æœºåˆ¶å¤„ç†äº†æ¥å£è¯·æ±‚ä¹‹ç±»çš„å¼‚æ­¥ä»»åŠ¡ï¼Œä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼å¹¶å‘çš„æ•ˆæœå—ï¼Ÿé‚£ä¸ºä»€ä¹ˆè¿˜è¦å¼•å…¥ Isolate å¹¶å‘æœºåˆ¶å‘¢ï¼Ÿ</p><p>ç­”ï¼šå‰é¢æˆ‘ä»¬è®²çš„å¼‚æ­¥æœºåˆ¶ä½ å¯ä»¥ç†è§£ä¸ºä¸€ç§å‡å¼‚æ­¥ï¼Œå› ä¸ºå®ƒå®é™…è¿˜æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å»å¤„ç†å„ç§ç½‘ç»œ IOï¼Œè¿™äº›ç½‘ç»œ IO å¹¶ä¸æ€ä¹ˆæ¶ˆè€— CPU èµ„æºï¼Œåªæ˜¯éœ€è¦å¤§é‡çš„ç­‰å¾…è¯·æ±‚å“åº”çš„æ—¶é—´ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç­‰å¾…çš„ç©ºé—²æ—¶é—´å»å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œè¿™å°±æ˜¯å¼‚æ­¥æœºåˆ¶èƒ½å¤Ÿæé«˜æ€§èƒ½çš„åŸå› ã€‚è¿™ç§æœºåˆ¶å…¶å®å’Œ Android Handler æœºåˆ¶æœ‰ç‚¹ç±»ä¼¼ã€‚è€Œç°åœ¨å¦‚æœä½ æœ‰ä¸€ä¸ªè®¡ç®—é‡éå¸¸å¤§çš„ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šä½ éœ€è¦å¯¹è§†é¢‘è¿›è¡Œæ ¼å¼åŒ–å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™è¿™äº› CPU å¯†é›†å‹è®¡ç®—å°±ä¼šé˜»å¡ä½ çš„çº¿ç¨‹ï¼Œå¯¼è‡´å…¶ä»–ä»»åŠ¡éƒ½æ‰§è¡Œä¸äº†ã€‚å› æ­¤é’ˆå¯¹è¿™ç§æ¯”è¾ƒè€— CPU èµ„æºçš„ä»»åŠ¡ï¼Œæœ€å¥½åˆ›å»ºä¸€ä¸ª Isolate å»å¤„ç†ï¼Œé¿å…é˜»å¡ä¸» Isolate ï¼ˆä¹Ÿå°±æ˜¯ä¸»çº¿ç¨‹ï¼‰ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥åˆ©ç”¨è®¾å¤‡çš„å¤šæ ¸ç‰¹æ€§</p><h3 id="13-1ã€Isolate-åŸºæœ¬ç”¨æ³•"><a href="#13-1ã€Isolate-åŸºæœ¬ç”¨æ³•" class="headerlink" title="13.1ã€Isolate åŸºæœ¬ç”¨æ³•"></a>13.1ã€Isolate åŸºæœ¬ç”¨æ³•</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å¯¼å…¥ isolate åŒ…</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:isolate&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() &#123;<br>  <span class="hljs-comment">// é€šè¿‡ Isolate.spawn é™æ€å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Isolate</span><br>  <span class="hljs-comment">// spawn æ˜¯ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªæ³›å‹å‚æ•°ï¼Œè¡¨ç¤º Isolate å…¥å£å‡½æ•°æ¥å—çš„å‚æ•°ç±»å‹</span><br>  <span class="hljs-comment">// è¿™é‡Œ spawn çš„æ³›å‹å‚æ•°æ˜¯ Stringï¼ŒsubTask æ˜¯å…¥å£å‡½æ•°</span><br>  <span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°è·Ÿæ³›å‹å‚æ•°ç±»å‹ä¸€è‡´ï¼Œè¡¨ç¤ºä¼ é€’ç»™å…¥å£å‡½æ•°çš„å‚æ•°ï¼Œè¿™é‡Œä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²</span><br>  Isolate.spawn&lt;<span class="hljs-built_in">String</span>&gt;(subTask, <span class="hljs-string">&quot;my task&quot;</span>);<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;main func end.&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// Isolate å…¥å£å‡½æ•°å®šä¹‰ï¼Œæ¥å—ä¸€ä¸ª String å‚æ•°</span><br><span class="hljs-comment">// å…¥å£å‡½æ•°çš„å‚æ•°ç±»å‹ç”±ä¸Šé¢çš„ spawn çš„æ³›å‹å‚æ•°å†³å®š</span><br><span class="hljs-keyword">void</span> subTask(<span class="hljs-built_in">String</span> msg)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;subTask receive: <span class="hljs-subst">$msg</span> &quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>main func end.<br>subTask receive: my task<br></code></pre></td></tr></table></figure><p>é€šè¿‡è¾“å‡ºï¼Œæˆ‘ä»¬å‘ç°å…ˆæ‰“å°äº† main func endï¼Œç„¶åï¼Œæ‰§è¡Œæ–°å»º Isolate çš„å…¥å£å‡½æ•°ã€‚ å¦‚æœæˆ‘ä»¬æƒ³è®©ä»£ç æ‰§è¡Œé¡ºåºï¼Œè·Ÿæˆ‘ä»¬ä¹¦å†™é¡ºåºä¸€è‡´çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ await å…³é”®å­—ç­‰å¾… Isolate æ‰§è¡Œç»“æŸï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// å¯¼å…¥ isolate åŒ…</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:isolate&#x27;</span>;<br><br><span class="hljs-comment">// ä½¿ç”¨ async å…³é”®å­—å°† main å‡½æ•°æ ‡è®°ä¸ºä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨ await å…³é”®å­—</span><br><span class="hljs-keyword">void</span> main() <span class="hljs-keyword">async</span>&#123;<br>  <span class="hljs-comment">// ä½¿ç”¨ await å…³é”®å­—ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆ</span><br>  <span class="hljs-keyword">await</span> Isolate.spawn&lt;<span class="hljs-built_in">String</span>&gt;(subTask, <span class="hljs-string">&quot;my task&quot;</span>);<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;main func end.&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// Isolate å…¥å£å‡½æ•°å®šä¹‰ï¼Œæ¥å—ä¸€ä¸ª String å‚æ•°</span><br><span class="hljs-keyword">void</span> subTask(<span class="hljs-built_in">String</span> msg)&#123;<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;subTask receive: <span class="hljs-subst">$msg</span> &quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>subTask receive: my task <br>main func end.<br></code></pre></td></tr></table></figure><h3 id="13-2ã€Isolate-æ¶ˆæ¯é€šè®¯"><a href="#13-2ã€Isolate-æ¶ˆæ¯é€šè®¯" class="headerlink" title="13.2ã€Isolate æ¶ˆæ¯é€šè®¯"></a>13.2ã€Isolate æ¶ˆæ¯é€šè®¯</h3><p>å¤šä¸ª Isolate ä¹‹é—´åªèƒ½é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šè®¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å»è·å–ä¸€ä¸ª Isolate è¿”å›çš„ç»“æœå‘¢ï¼Ÿ</p><p>ç­”ï¼šä¸»è¦é€šè¿‡ ReceivePort å’Œ SendPort ä¸¤ä¸ªç±»å¤„ç†æ¶ˆæ¯é€šè®¯</p><p>1ï¼‰ã€ReceivePort è´Ÿè´£æ¥æ”¶ SendPort å‘é€çš„æ¶ˆæ¯ï¼Œ SendPort å’Œ ReceivePort æ˜¯æ†ç»‘å…³ç³»ï¼Œ SendPort æ˜¯ç”± ReceivePort åˆ›å»ºçš„</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">void</span> main() <span class="hljs-keyword">async</span>&#123;<br>   <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª ReceivePort ç”¨äºæ¥æ”¶æ¶ˆæ¯</span><br>   <span class="hljs-keyword">var</span> recv = ReceivePort();<br><br>   <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª Isolateï¼Œæ³›å‹å‚æ•°ä¸º SendPortï¼Œå…¥å£å‡½æ•°ä¸º subTask</span><br>   <span class="hljs-comment">// subTask å…¥å£å‡½æ•°çš„å‚æ•°ä¸º SendPort ç±»å‹ï¼Œå› æ­¤ spawn ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¼ å…¥ recv çš„ sendPort å¯¹è±¡</span><br>   Isolate.spawn&lt;SendPort&gt;(subTask, recv.sendPort);<br><br>   <span class="hljs-comment">// ä½¿ç”¨ await ç­‰å¾… recv çš„ç¬¬ä¸€æ¡æ¶ˆæ¯</span><br>   <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> recv.first;<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;receiveï¼š<span class="hljs-subst">$result</span>&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// Isolate å…¥å£å‡½æ•°å®šä¹‰ï¼Œæ¥æ”¶ä¸€ä¸ª SendPort å¯¹è±¡ä½œä¸ºå‚æ•°</span><br><span class="hljs-keyword">void</span> subTask(SendPort port)&#123;<br>  <span class="hljs-comment">// ä½¿ç”¨ SendPort å‘é€ä¸€æ¡å­—ç¬¦ä¸²æ¶ˆæ¯</span><br>  port.send(<span class="hljs-string">&quot;subTask Result&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>receiveï¼šsubTask Result<br></code></pre></td></tr></table></figure><h2 id="åå››ã€æ€»ç»“"><a href="#åå››ã€æ€»ç»“" class="headerlink" title="åå››ã€æ€»ç»“"></a>åå››ã€æ€»ç»“</h2><p>æœ¬ç¯‡ä¼°è®¡æ˜¯æˆ‘å†™è¿‡æœ€é•¿çš„æ–‡ç« äº†ï¼Œæ¯”ä¹‹å‰å†™ Kotlin å…¥é—¨é‚£ä¸€ç¯‡è¿˜è¦é•¿ğŸ˜‚ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« å‡ ä¹æ¶µç›–äº† Dart çš„æ‰€æœ‰è¯­æ³•çŸ¥è¯†ï¼Œå¦‚æœä½ èƒ½å¤Ÿè€å¿ƒçœ‹åˆ°è¿™é‡Œï¼Œå¹¶æ‰‹æ•²é‡Œé¢çš„ç¤ºä¾‹ï¼Œç›¸ä¿¡ä½ ä¸€å®šæ”¶è·å¾ˆå¤§ã€‚å¦‚æœè§‰å¾—æˆ‘å†™çš„è¿˜ä¸é”™ï¼Œè¯·ç»™æˆ‘ç‚¹ä¸ªèµå§ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>åŸºç¡€æ‰“å¥½äº†ï¼Œä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ­£å¼è¿›å…¥åˆ° Flutter çš„å­¦ä¹ äº†ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://juejin.cn/post/7075337131974983688#heading-72">ä¸€æ–‡æå®šDartè¯­æ³•</a></p><p><a href="https://www.tizi365.com/archives/165.html">Dartè¯­è¨€æ•™ç¨‹</a></p><p><a href="https://juejin.cn/post/7028710779171897351#heading-7">Flutter åŸºç¡€ | Dart è¯­æ³•</a></p><p><a href="https://dart.cn/tutorials/language">Dart å®˜æ–¹æ•™ç¨‹</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong> <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="/2022/10/01/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2022/10/01/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>æ­£åˆ™è¡¨è¾¾å¼åœ¨æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°ï¼Œä¸‹é¢æ€»ç»“ä¸€äº›å¸¸ç”¨çš„åˆ†äº«ç»™å¤§å®¶</p><p>æµ‹è¯•å·¥å…·ï¼š<a href="https://regex101.com/">https://regex101.com/</a></p><h2 id="ä¸€ã€é™å®šç¬¦"><a href="#ä¸€ã€é™å®šç¬¦" class="headerlink" title="ä¸€ã€é™å®šç¬¦"></a>ä¸€ã€é™å®šç¬¦</h2><p>? ï¼šè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦éœ€è¦å‡ºç° 0 æ¬¡æˆ–è€… 1 æ¬¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">used? : d å¯æœ‰å¯æ— <br></code></pre></td></tr></table></figure><p><code>*</code> : åŒ¹é… 0 ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">ab*c : bå¯ä»¥æœ‰<span class="hljs-number">0</span>ä¸ªæˆ–è€…å¤šä¸ª<br>  <br>ac<br>abc<br>abbbbbbc<br><br></code></pre></td></tr></table></figure><p><code>+</code> : åŒ¹é…å‡ºç°ä¸€æ¬¡åŠä»¥ä¸Šçš„å­—ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">ab+c : bå¯ä»¥æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Š<br>  <br>abc<br>abbbbbbc<br></code></pre></td></tr></table></figure><p>{n} ï¼šç²¾ç¡®åŒ¹é…ï¼Œå‡ºç° n æ¬¡çš„å­—ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ab&#123;<span class="hljs-number">6</span>&#125;c ï¼šç²¾ç¡®åŒ¹é…å‡ºç° <span class="hljs-number">6</span> æ¬¡çš„å­—ç¬¦<br><br>abbbbbbc<br></code></pre></td></tr></table></figure><p>{n,m} : åŒ¹é…å‡ºç° n-m æ¬¡çš„å­—ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">ab&#123;<span class="hljs-number">1</span>,<span class="hljs-number">6</span>&#125;c ï¼šåŒ¹é…å‡ºç° <span class="hljs-number">1</span>-<span class="hljs-number">6</span> æ¬¡çš„å­—ç¬¦<br><br>abc<br>abbbbbbc<br></code></pre></td></tr></table></figure><p>{n,} ï¼šå‡ºç° n æ¬¡åŠä»¥ä¸Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ab&#123;<span class="hljs-number">2</span>,&#125;c ï¼šåŒ¹é…å‡ºç° <span class="hljs-number">2</span> æ¬¡åŠä»¥ä¸Šçš„å­—ç¬¦<br>  <br>abbbbbbc<br></code></pre></td></tr></table></figure><p>| ï¼šæˆ–è¿ç®—ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">a (cat|dog) ï¼ša åé¢æ‹¼æ¥ cat æˆ– dog<br>  <br>a cat<br>a dog<br></code></pre></td></tr></table></figure><p>[] ï¼šåŒ¹é…ç”±ä¸­æ‹¬å·é‡Œé¢æ„æˆçš„å†…å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[abc]+ : åŒ¹é… abc æ„æˆçš„å•è¯ï¼Œè‡³å°‘å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡<br>[a-zA-Z0-<span class="hljs-number">9</span>]+ : åŒ¹é… a-z A-Z <span class="hljs-number">0</span>-<span class="hljs-number">9</span> æ„æˆçš„å•è¯ï¼Œè‡³å°‘å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡<br></code></pre></td></tr></table></figure><p>^ : è¡¨ç¤ºå–å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">[^<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+ : ä¸å– <span class="hljs-number">0</span>-<span class="hljs-number">9</span> çš„å­—ç¬¦ï¼šéæ•°å­—å­—ç¬¦<br></code></pre></td></tr></table></figure><h2 id="äºŒã€å…ƒå­—ç¬¦"><a href="#äºŒã€å…ƒå­—ç¬¦" class="headerlink" title="äºŒã€å…ƒå­—ç¬¦"></a>äºŒã€å…ƒå­—ç¬¦</h2><table><thead><tr><th>å…ƒå­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>\d</td><td>æ•°å­—å­—ç¬¦</td></tr><tr><td>\w</td><td>å•è¯å­—ç¬¦ï¼ˆè‹±æ–‡ã€æ•°å­—åŠä¸‹åˆ’çº¿ï¼‰</td></tr><tr><td>\s</td><td>ç©ºç™½ç¬¦ï¼ˆåŒ…å«Tabå’Œæ¢è¡Œç¬¦ï¼‰</td></tr><tr><td>\D</td><td>éæ•°å­—å­—ç¬¦</td></tr><tr><td>\W</td><td>éå•è¯å­—ç¬¦</td></tr><tr><td>\S</td><td>éç©ºç™½å­—ç¬¦</td></tr><tr><td>.</td><td>ä»»æ„å­—ç¬¦ï¼ˆä¸åŒ…å«æ¢è¡Œç¬¦ï¼‰</td></tr><tr><td>^</td><td>åŒ¹é…è¡Œé¦– ^aï¼šåªä¼šå»åŒ¹é…è¡Œé¦–çš„ a</td></tr><tr><td>$</td><td>åŒ¹é…è¡Œå°¾ a$ï¼šåªä¼šå»åŒ¹é…è¡Œå°¾çš„ a</td></tr><tr><td>\b</td><td>ä»£è¡¨å•è¯å­—ç¬¦çš„è¾¹ç•Œ</td></tr></tbody></table><h2 id="ä¸‰ã€è´ªå©ªå»æ‡’æƒ°åŒ¹é…"><a href="#ä¸‰ã€è´ªå©ªå»æ‡’æƒ°åŒ¹é…" class="headerlink" title="ä¸‰ã€è´ªå©ªå»æ‡’æƒ°åŒ¹é…"></a>ä¸‰ã€è´ªå©ªå»æ‡’æƒ°åŒ¹é…</h2><p>åœ¨è¡¨è¾¾å¼åé¢åŠ <code>?</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- åŒ¹é…ä¸‹é¢å†…å®¹ä¸­çš„ html æ ‡ç­¾ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>This is a sample text<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-comment">&lt;!-- å¦‚æœæˆ‘ä»¬è¿™ä¹ˆå†™ï¼Œåˆ™ä¼šå»åŒ¹é…æ‰€æœ‰å­—ç¬¦ --&gt;</span><br>&lt;.+&gt; : ä¼šåŒ¹é…æ‰€æœ‰çš„å­—ç¬¦<br><br>è§£å†³æ–¹æ³•ï¼šå°†è´ªå©ªåŒ¹é…è½¬æ¢æˆæ‡’æƒ°åŒ¹é…ï¼š&lt;.+?&gt;<br></code></pre></td></tr></table></figure><h2 id="å››ã€å®æˆ˜æ¼”ç»ƒ"><a href="#å››ã€å®æˆ˜æ¼”ç»ƒ" class="headerlink" title="å››ã€å®æˆ˜æ¼”ç»ƒ"></a>å››ã€å®æˆ˜æ¼”ç»ƒ</h2><p>å®ä¾‹ä¸€ï¼šåŒ¹é… 16 è¿›åˆ¶é¢œè‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">#[a-fA-F0-<span class="hljs-number">9</span>]&#123;<span class="hljs-number">6</span>&#125;\b<br><br><br>#ffffff<br>#ffaaff<br>#aabbcc<br>#<span class="hljs-number">000000</span><br><br></code></pre></td></tr></table></figure><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ€åç”¨ä¸€å¼ å›¾å¯¹æˆ‘ä»¬ä¸Šé¢è®²çš„å†…å®¹è¿›è¡Œä¸€ä¸ªå½’çº³æ€»ç»“ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec99d84593d144a8a29cbcaf4ed9718b~tplv-k3u1fbpfcp-watermark.image" alt="image-20221031192203905.png"></p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤</p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ­£åˆ™è¡¨è¾¾å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸå­è®¿é—®ï¼ˆä¸ƒï¼‰</title>
    <link href="/2022/09/16/thread7/"/>
    <url>/2022/09/16/thread7/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€åŸå­æ€§æ“ä½œæ¦‚å¿µ"><a href="#ä¸€ã€åŸå­æ€§æ“ä½œæ¦‚å¿µ" class="headerlink" title="ä¸€ã€åŸå­æ€§æ“ä½œæ¦‚å¿µ"></a>ä¸€ã€åŸå­æ€§æ“ä½œæ¦‚å¿µ</h2><p>æ‰€è°“çš„åŸå­æ€§æ“ä½œå³ä¸å¯ä¸­æ–­ï¼Œä¸å¯åˆ†å‰²çš„æ“ä½œï¼Œæ¯”å¦‚èµ‹å€¼æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>åŸå­æ€§æ“ä½œæœ¬èº«æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯ i++ è¿™ä¸ªè¡Œä¸ºï¼Œäº‹å®ä¸Šæ˜¯ 3 ä¸ªåŸå­æ€§æ“ä½œæ“ä½œç»„æˆçš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//i++ æ“ä½œæ‹†åˆ†</span><br><span class="hljs-number">1</span>ã€å– i çš„å€¼<br><span class="hljs-number">2</span>ã€i + <span class="hljs-number">1</span><br><span class="hljs-number">3</span>ã€æŠŠæ–°çš„å€¼èµ‹äºˆ i<br></code></pre></td></tr></table></figure><p>è¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œä½†æ˜¯åˆåœ¨ä¸€èµ·ï¼Œå°±ä¸æ˜¯åŸå­æ“ä½œï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨æ­¥éª¤ 1 å– i çš„å€¼ç»“æŸåï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠè¿›è¡Œæ­¥éª¤ 2ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥å– i çš„å€¼äº†ã€‚</p><p>è¿™ä¹Ÿæ˜¯åˆ†æåŒæ­¥é—®é¢˜äº§ç”Ÿçš„åŸå› ä¸­çš„åŸç†ã€‚</p><p>i++ï¼Œiâ€“ï¼Œi &#x3D; i + 1 è¿™äº›éƒ½ä¸æ˜¯åŸå­æ€§æ“ä½œã€‚</p><p>åªæœ‰<code>int i = 1</code>è¿™ä¸ªæ“ä½œæ—¶åŸå­æ€§çš„</p><h2 id="äºŒã€AtomicInteger"><a href="#äºŒã€AtomicInteger" class="headerlink" title="äºŒã€AtomicInteger"></a>äºŒã€AtomicInteger</h2><p>JDK 1.6 ä¹‹åï¼ŒJava æ–°å¢ä¸€ä¸ªåŒ…<code>java.util.concurrent.atomic</code>ï¼Œé‡Œé¢æœ‰å„ç§åŸå­ç±»ï¼Œæ¯”å¦‚ï¼šAtomicInteger ã€‚</p><p>è€Œ AtomicInteger æä¾›äº†å„ç§è‡ªå¢ï¼Œè‡ªå‡ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯åŸå­æ€§çš„ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œè‡ªå¢æ–¹æ³• incrementAndGet æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒåŒä¸€ä¸ªæ—¶é—´ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">atomicInteger</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> atomicInteger.decrementAndGet();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> atomicInteger.incrementAndGet();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> atomicInteger.incrementAndGet();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> atomicInteger.addAndGet(<span class="hljs-number">3</span>);<br>        System.out.println(i);<br>        System.out.println(j);<br>        System.out.println(k);<br>        System.out.println(l);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>-<span class="hljs-number">1</span><br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€åŒæ­¥æµ‹è¯•"><a href="#ä¸‰ã€åŒæ­¥æµ‹è¯•" class="headerlink" title="ä¸‰ã€åŒæ­¥æµ‹è¯•"></a>ä¸‰ã€åŒæ­¥æµ‹è¯•</h2><p>åˆ†åˆ«ä½¿ç”¨åŸºæœ¬å˜é‡çš„éåŸå­æ€§æ“ä½œç¬¦å’ŒåŸå­æ€§çš„ AtomicInteger å¯¹è±¡çš„ incrementAndGet æ¥è¿›è¡Œå¤šçº¿ç¨‹æµ‹è¯•ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">atomicValue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;<br>        Thread[] ts1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[number];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; number; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    value++;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            ts1[i] = t;<br>        &#125;<br><br>        <span class="hljs-comment">//ç­‰å¾…è¿™äº›çº¿ç¨‹å…¨éƒ¨ç»“æŸ</span><br>        <span class="hljs-keyword">for</span> (Thread t : ts1) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        System.out.printf(<span class="hljs-string">&quot;%dä¸ªçº¿ç¨‹è¿›è¡Œvalue++åï¼Œvalueçš„å€¼å˜æˆ:%d%n&quot;</span>, number,value);<br><br>        Thread[] ts2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[number];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; number; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    atomicValue.incrementAndGet();<br>                &#125;<br>            &#125;;<br>            t.start();<br>            ts2[i] = t;<br>        &#125;<br><br>        <span class="hljs-comment">//ç­‰å¾…è¿™äº›çº¿ç¨‹å…¨éƒ¨ç»“æŸ</span><br>        <span class="hljs-keyword">for</span> (Thread t : ts2) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        System.out.printf(<span class="hljs-string">&quot;%dä¸ªçº¿ç¨‹è¿›è¡ŒatomicValue.incrementAndGet();åï¼ŒatomicValueçš„å€¼å˜æˆ:%d%n&quot;</span>, number,atomicValue.intValue());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10000</span>ä¸ªçº¿ç¨‹è¿›è¡Œvalue++åï¼Œvalueçš„å€¼å˜æˆ:<span class="hljs-number">9999</span><br><span class="hljs-number">10000</span>ä¸ªçº¿ç¨‹è¿›è¡ŒatomicValue.incrementAndGet();åï¼ŒatomicValueçš„å€¼å˜æˆ:<span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure><h2 id="å››ã€ä½¿ç”¨-AtomicInteger-æ¥æ›¿æ¢-Hero-ç±»ä¸­çš„-synchronized"><a href="#å››ã€ä½¿ç”¨-AtomicInteger-æ¥æ›¿æ¢-Hero-ç±»ä¸­çš„-synchronized" class="headerlink" title="å››ã€ä½¿ç”¨ AtomicInteger æ¥æ›¿æ¢ Hero ç±»ä¸­çš„ synchronized"></a>å››ã€ä½¿ç”¨ AtomicInteger æ¥æ›¿æ¢ Hero ç±»ä¸­çš„ synchronized</h2><p>Hero ç±»å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> hp;<br>     <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span>&#123;<br>        hp=hp+<span class="hljs-number">1</span>;<br>    &#125;<br>     <br>    <span class="hljs-comment">//æ‰è¡€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//ä½¿ç”¨thisä½œä¸ºåŒæ­¥å¯¹è±¡</span><br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>            hp=hp-<span class="hljs-number">1</span>;   <br>        &#125;<br>    &#125;<br>     <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        h.hp-=damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>,name,h.name,h.name,h.hp);<br>        <span class="hljs-keyword">if</span>(h.isDead())<br>            System.out.println(h.name +<span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&gt;=hp?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ AtomicInteger å¯¹å…¶è¿›è¡Œæ›¿æ¢ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">hp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span>&#123;<br>        hp.incrementAndGet();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span>&#123;<br>        hp.decrementAndGet();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        h.hp.addAndGet(<span class="hljs-number">0</span> - damage);<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>,name,h.name,h.name,h.hp);<br>        <span class="hljs-keyword">if</span>(h.isDead())<br>            System.out.println(h.name +<span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&gt;=hp.intValue()?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†åŸå­æ€§æ“ä½œçš„æ¦‚å¿µï¼Œä»¥åŠåŸå­æ€§æ“ä½œçš„ç±»ï¼šAtomicIntegerã€‚å¹¶è¿›è¡Œäº†åŒæ­¥æµ‹è¯•ä»¥åŠå¯¹ Hero ç±»è¿›è¡Œäº†æ›¿æ¢</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤šçº¿ç¨‹ Lock å¯¹è±¡ï¼ˆå…­ï¼‰</title>
    <link href="/2022/09/15/thread6/"/>
    <url>/2022/09/15/thread6/</url>
    
    <content type="html"><![CDATA[<h2 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h2><p>ä¸ synchronized ç±»ä¼¼çš„ï¼Œlock ä¹Ÿèƒ½å¤Ÿè¾¾åˆ°åŒæ­¥çš„æ•ˆæœã€‚</p><p>é¦–å…ˆå›å¿†ä¸€ä¸‹ synchronized åŒæ­¥å¯¹è±¡çš„æ–¹å¼ï¼š</p><p>å½“ä¸€ä¸ªçº¿ç¨‹å ç”¨ synchronized åŒæ­¥å¯¹è±¡ï¼Œå…¶ä»–çº¿ç¨‹å°±ä¸èƒ½å ç”¨äº†ï¼ŒçŸ¥é“é‡Šæ”¾è¿™ä¸ªåŒæ­¥å¯¹è±¡ä¸ºæ­¢</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13256736ecf2428c90b709da84fb5306~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221227103526974"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">now</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>).format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">someObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>        <span class="hljs-comment">//t1 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() +  <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    &#125;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t1.setName(<span class="hljs-string">&quot;t1&quot;</span>);<br>        t1.start();<br><br>        <span class="hljs-comment">//t2 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() +  <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šsomeObject&quot;</span>);<br><br>                    &#125;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t2.setName(<span class="hljs-string">&quot;t2&quot;</span>);<br>        t2.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸€ã€ä½¿ç”¨-Lock-å¯¹è±¡å®ç°åŒæ­¥æ•ˆæœ"><a href="#ä¸€ã€ä½¿ç”¨-Lock-å¯¹è±¡å®ç°åŒæ­¥æ•ˆæœ" class="headerlink" title="ä¸€ã€ä½¿ç”¨ Lock å¯¹è±¡å®ç°åŒæ­¥æ•ˆæœ"></a>ä¸€ã€ä½¿ç”¨ Lock å¯¹è±¡å®ç°åŒæ­¥æ•ˆæœ</h2><p>Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨ Lock å¯¹è±¡ï¼Œéœ€è¦ç”¨åˆ°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br></code></pre></td></tr></table></figure><p>ä¸ synchronized(someObject) ç±»ä¼¼ï¼Œlock() æ–¹æ³•è¡¨ç¤ºå½“å‰çº¿ç¨‹å ç”¨äº† lock å¯¹è±¡ï¼Œä¸€æ—¦å ç”¨ï¼Œå…¶ä»–çº¿ç¨‹å°±ä¸èƒ½å ç”¨äº†ã€‚</p><p>ä¸ synchronized ä¸åŒçš„æ˜¯ï¼Œä¸€æ—¦ synchronized å—ç»“æŸï¼Œå°±ä¼šè‡ªåŠ¨é‡Šæ”¾ someObject çš„å ç”¨ã€‚lock å´å¿…é¡»è°ƒç”¨ unlock() æ–¹æ³•è¿›è¡Œæ‰‹åŠ¨é‡Šæ”¾ï¼Œä¸ºäº†ä¿è¯é‡Šæ”¾çš„æ‰§è¡Œï¼Œå¾€å¾€ä¼šæŠŠ unlock() æ”¾åœ¨ finally ä¸­è¿›è¡Œã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">now</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>).format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br><br>        <span class="hljs-comment">//t1 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.lock();<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">5000</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.unlock();<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t1.setName(<span class="hljs-string">&quot;t1&quot;</span>);<br>        t1.start();<br><br>        <span class="hljs-comment">//è®© t1 å…ˆé£ 2 ç§’</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">2000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-comment">//t2 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.lock();<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">5000</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<span class="hljs-keyword">finally</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.unlock();<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t2.setName(<span class="hljs-string">&quot;t2&quot;</span>);<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">39</span> t1 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">39</span> t1 å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">39</span> t2 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">44</span> t1 é‡Šæ”¾å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">44</span> t1 çº¿ç¨‹ç»“æŸ<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">44</span> t2 å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">49</span> t2 é‡Šæ”¾å¯¹è±¡ï¼šlock<br><span class="hljs-number">15</span>:<span class="hljs-number">49</span>:<span class="hljs-number">49</span> t2 çº¿ç¨‹ç»“æŸ<br></code></pre></td></tr></table></figure><h2 id="äºŒã€trylock-æ–¹æ³•"><a href="#äºŒã€trylock-æ–¹æ³•" class="headerlink" title="äºŒã€trylock æ–¹æ³•"></a>äºŒã€trylock æ–¹æ³•</h2><p>synchronized æ˜¯ä¸å ç”¨åˆ°æ‰‹èª“ä¸ç½¢ä¼‘ï¼Œä¼šä¸€ç›´è¯•å›¾å ç”¨ä¸‹å»ã€‚</p><p>ä¸ synchronizedçš„é’»ç‰›è§’å°–ä¸ä¸€æ ·ï¼ŒLock æ¥å£è¿˜æä¾›äº†ä¸€ä¸ª trylock æ–¹æ³•ã€‚</p><p>trylock ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…è¯•å›¾å ç”¨ï¼Œå ç”¨æˆåŠŸäº†ï¼Œå°±å¯ä»¥å¹²æ´»äº†ã€‚å¦‚æœæ—¶é—´åˆ°äº†ï¼Œè¿˜å ç”¨ä¸æˆåŠŸï¼Œæ‰­å¤´å°±èµ°ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> å› ä¸ºä½¿ç”¨ trylock æœ‰å¯èƒ½æˆåŠŸï¼Œæœ‰å¯èƒ½å¤±è´¥ï¼Œæ‰€ä»¥åé¢ unlock é‡Šæ”¾é”çš„æ—¶å€™ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯å ç”¨æˆåŠŸäº†ï¼Œå¦‚æœæ²¡å ç”¨æˆåŠŸä¹Ÿ unlock ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">now</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>).format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br><br>        <span class="hljs-comment">//t1 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    locked = lock.tryLock(<span class="hljs-number">1</span>, TimeUnit.SECONDS);<br>                    <span class="hljs-keyword">if</span>(locked)&#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¿›è¡Œ 5 ç§’çš„ä¸šåŠ¡æ“ä½œ&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                    &#125;<span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; ç»è¿‡ 1 ç§’é’Ÿçš„åŠªåŠ›ï¼Œè¿˜æ²¡æœ‰å æœ‰å¯¹è±¡ï¼Œæ”¾å¼ƒå æœ‰&quot;</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    <span class="hljs-keyword">if</span>(locked)&#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                        lock.unlock();<br>                    &#125;<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t1.setName(<span class="hljs-string">&quot;t1&quot;</span>);<br>        t1.start();<br><br>        <span class="hljs-comment">//è®© t1 å…ˆé£ 2 ç§’</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">2000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-comment">//t2 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    locked = lock.tryLock(<span class="hljs-number">1</span>,TimeUnit.SECONDS);<br>                    <span class="hljs-keyword">if</span>(locked)&#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¿›è¡Œ 5 ç§’çš„ä¸šåŠ¡æ“ä½œ&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                    &#125;<span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; ç»è¿‡ 1 ç§’é’Ÿçš„åŠªåŠ›ï¼Œè¿˜æ²¡æœ‰å æœ‰å¯¹è±¡ï¼Œæ”¾å¼ƒå æœ‰&quot;</span>);<br>                    &#125;<br><br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<span class="hljs-keyword">finally</span> &#123;<br>                    <span class="hljs-keyword">if</span>(locked)&#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                        lock.unlock();<br>                    &#125;<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t2.setName(<span class="hljs-string">&quot;t2&quot;</span>);<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">47</span> t1 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">47</span> t1 å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">47</span> t1 è¿›è¡Œ <span class="hljs-number">5</span> ç§’çš„ä¸šåŠ¡æ“ä½œ<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">49</span> t2 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">50</span> t2 ç»è¿‡ <span class="hljs-number">1</span> ç§’é’Ÿçš„åŠªåŠ›ï¼Œè¿˜æ²¡æœ‰å æœ‰å¯¹è±¡ï¼Œæ”¾å¼ƒå æœ‰<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">50</span> t2 çº¿ç¨‹ç»“æŸ<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">52</span> t1 é‡Šæ”¾å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">00</span>:<span class="hljs-number">52</span> t1 çº¿ç¨‹ç»“æŸ<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€çº¿ç¨‹äº¤äº’"><a href="#ä¸‰ã€çº¿ç¨‹äº¤äº’" class="headerlink" title="ä¸‰ã€çº¿ç¨‹äº¤äº’"></a>ä¸‰ã€çº¿ç¨‹äº¤äº’</h2><p>ä½¿ç”¨ synchronized æ–¹å¼è¿›è¡Œçº¿ç¨‹äº¤äº’ï¼Œç”¨åˆ°çš„æ˜¯åŒæ­¥å¯¹è±¡çš„ waitï¼Œnotifyï¼ŒnotifyAll æ–¹æ³•ã€‚</p><p>Lock ä¹Ÿæä¾›äº†ç±»ä¼¼çš„è§£å†³åŠæ³•ï¼Œé¦–å…ˆé€šè¿‡ lock å¯¹è±¡å¾—åˆ°ä¸€ä¸ª Condition å¯¹è±¡ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨è¿™ä¸ª Condition å¯¹è±¡çš„ï¼šawaitï¼Œsignalï¼ŒsignalAll æ–¹æ³•ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> ä¸æ˜¯ Condition å¯¹è±¡çš„ waitï¼Œnotifyï¼ŒnotifyAll æ–¹æ³•ï¼Œæ˜¯ awaitï¼Œsignalï¼ŒsignalAll æ–¹æ³•</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">now</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>).format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> lock.newCondition();<br><br>        <span class="hljs-comment">//t1 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.lock();<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¿›è¡Œ 5 ç§’çš„ä¸šåŠ¡æ“ä½œ&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">5000</span>);<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; ä¸´æ—¶é‡Šæ”¾å¯¹è±¡ lockï¼Œå¹¶ç­‰å¾…&quot;</span>);<br>                    condition.await();<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡æ–°å æœ‰å¯¹è±¡ lockï¼Œå¹¶è¿›è¡Œ 5 ç§’çš„ä¸šåŠ¡æ“ä½œ&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">5000</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.unlock();<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t1.setName(<span class="hljs-string">&quot;t1&quot;</span>);<br>        t1.start();<br><br>        <span class="hljs-comment">//è®© t1 å…ˆé£ 2 ç§’</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">2000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-comment">//t2 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.lock();<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šlock&quot;</span>);<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; è¿›è¡Œ 5 ç§’çš„ä¸šåŠ¡æ“ä½œ&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">5000</span>);<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å”¤é†’ç­‰å¾…ä¸­çš„çº¿ç¨‹&quot;</span>);<br>                    condition.signal();<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<span class="hljs-keyword">finally</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šlock&quot;</span>);<br>                    lock.unlock();<br>                &#125;<br>                System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>            &#125;<br>        &#125;;<br>        t2.setName(<span class="hljs-string">&quot;t2&quot;</span>);<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">17</span>:<span class="hljs-number">18</span>:<span class="hljs-number">59</span> t1 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">18</span>:<span class="hljs-number">59</span> t1 å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">18</span>:<span class="hljs-number">59</span> t1 è¿›è¡Œ <span class="hljs-number">5</span> ç§’çš„ä¸šåŠ¡æ“ä½œ<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">01</span> t2 è¯•å›¾å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">04</span> t1 ä¸´æ—¶é‡Šæ”¾å¯¹è±¡ lockï¼Œå¹¶ç­‰å¾…<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">04</span> t2 å æœ‰å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">04</span> t2 è¿›è¡Œ <span class="hljs-number">5</span> ç§’çš„ä¸šåŠ¡æ“ä½œ<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:09 t2 å”¤é†’ç­‰å¾…ä¸­çš„çº¿ç¨‹<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:09 t2 é‡Šæ”¾å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:09 t2 çº¿ç¨‹ç»“æŸ<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:09 t1 é‡æ–°å æœ‰å¯¹è±¡ lockï¼Œå¹¶è¿›è¡Œ <span class="hljs-number">5</span> ç§’çš„ä¸šåŠ¡æ“ä½œ<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">14</span> t1 é‡Šæ”¾å¯¹è±¡ï¼šlock<br><span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">14</span> t1 çº¿ç¨‹ç»“æŸ<br></code></pre></td></tr></table></figure><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†å¦å¤–ä¸€ç§é” Lockï¼Œä»¥åŠç›¸å…³äº¤äº’çš„å®ç°ï¼Œå®ƒä¸ synchronized åŒºåˆ«ï¼š</p><p>1ã€Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œ synchronized æ˜¯ Java ä¸­çš„å…³é”®å­—ï¼Œsynchronized æ˜¯å†…ç½®çš„è¯­è¨€å®ç°ï¼ŒLock æ˜¯ä»£ç å±‚é¢çš„å®ç°ã€‚</p><p>2ã€ Lock å¯ä»¥é€‰æ‹©æ€§çš„è·å–é”ï¼Œå¦‚æœä¸€æ®µæ—¶é—´è·å–ä¸åˆ°ï¼Œå¯ä»¥æ”¾å¼ƒã€‚synchronized ä¸è¡Œï¼Œä¼šä¸€æ ¹ç­‹ä¸€ç›´è·å–ä¸‹å»ã€‚ å€ŸåŠ© Lock çš„è¿™ä¸ªç‰¹æ€§ï¼Œå°±èƒ½å¤Ÿè§„é¿æ­»é”ï¼Œsynchronized å¿…é¡»é€šè¿‡è°¨æ…å’Œè‰¯å¥½çš„è®¾è®¡ï¼Œæ‰èƒ½å‡å°‘æ­»é”çš„å‘ç”Ÿã€‚</p><p>3ã€ synchronized åœ¨å‘ç”Ÿå¼‚å¸¸å’ŒåŒæ­¥å—ç»“æŸçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾é”ã€‚è€Œ Lock å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾ï¼Œ æ‰€ä»¥å¦‚æœå¿˜è®°äº†é‡Šæ”¾é”ï¼Œä¸€æ ·ä¼šé€ æˆæ­»é”ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿ç¨‹æ± ï¼ˆäº”ï¼‰</title>
    <link href="/2022/09/14/thread5/"/>
    <url>/2022/09/14/thread5/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¯ä¸€ä¸ªçº¿ç¨‹çš„å¯åŠ¨å’Œç»“æŸéƒ½æ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´å’Œå ç”¨èµ„æºçš„ã€‚</p><p>å¦‚æœåœ¨ç³»ç»Ÿä¸­ä½¿ç”¨åˆ°äº†å¾ˆå¤šçš„çº¿ç¨‹ï¼Œå¤§é‡çš„å¯åŠ¨å’Œç»“æŸåŠ¨ä½œä¼šå¯¼è‡´ç³»ç»Ÿçš„æ€§èƒ½å˜å¡ï¼Œå“åº”å˜æ…¢ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥çº¿ç¨‹æ± è¿™ç§è®¾è®¡æ€æƒ³ã€‚</p><p>çº¿ç¨‹æ± çš„æ¨¡å¼å¾ˆåƒç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ¶ˆè´¹çš„å¯¹è±¡æ˜¯ä¸€ä¸ªä¸€ä¸ªèƒ½å¤Ÿè¿è¡Œçš„ä»»åŠ¡ã€‚</p><h2 id="ä¸€ã€çº¿ç¨‹æ± è®¾è®¡æ€è·¯"><a href="#ä¸€ã€çº¿ç¨‹æ± è®¾è®¡æ€è·¯" class="headerlink" title="ä¸€ã€çº¿ç¨‹æ± è®¾è®¡æ€è·¯"></a>ä¸€ã€çº¿ç¨‹æ± è®¾è®¡æ€è·¯</h2><p>çº¿ç¨‹æ± çš„æ€è·¯å’Œç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹æ˜¯å¾ˆæ¥è¿‘çš„ï¼š</p><p>1ã€å‡†å¤‡ä¸€ä¸ªä»»åŠ¡å®¹å™¨</p><p>2ã€ä¸€æ¬¡æ€§å¯åŠ¨ 10 ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹</p><p>3ã€åˆšå¼€å§‹ä»»åŠ¡å®¹å™¨æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥çº¿ç¨‹éƒ½ wait åœ¨ä¸Šé¢</p><p>4ã€ç›´åˆ°ä¸€ä¸ªå¤–éƒ¨çº¿ç¨‹å¾€è¿™ä¸ªä»»åŠ¡å®¹å™¨ä¸­æ‰”äº†ä¸€ä¸ª<code>ä»»åŠ¡</code>ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹è¢«å”¤é†’ notify</p><p>5ã€è¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å–å‡º<code>ä»»åŠ¡</code>ï¼Œå¹¶ä¸”æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œç»§ç»­ç­‰å¾…ä¸‹ä¸€æ¬¡ä»»åŠ¡çš„åˆ°æ¥ã€‚</p><p>6ã€å¦‚æœçŸ­æ—¶é—´å†…ï¼Œæœ‰è¾ƒå¤šçš„ä»»åŠ¡åŠ å…¥ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¤šä¸ªçº¿ç¨‹è¢«å”¤é†’ï¼Œå»æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚</p><p>åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œéƒ½ä¸éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè€Œæ˜¯å¾ªç¯ä½¿ç”¨è¿™äº›å·²ç»å­˜åœ¨çš„çº¿ç¨‹</p><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3635d0c8b576447bb4d3c0e403199134~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221228114142462"></p><h2 id="äºŒã€å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹æ± "><a href="#äºŒã€å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹æ± " class="headerlink" title="äºŒã€å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹æ± "></a>äºŒã€å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹æ± </h2><p>å¦‚ä¸‹ä»£ç å®ç°ï¼Œè™½ç„¶ä¸å¤Ÿå®Œå–„å’Œå¥å£®ï¼Œä½†æ˜¯å·²ç»è¶³ä»¥è¯´æ˜çº¿ç¨‹æ± çš„å·¥ä½œåŸç†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€è‡ªå®šä¹‰çº¿ç¨‹æ± </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPool</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * çº¿ç¨‹æ± å¤§å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> threadPoolSize;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»»åŠ¡å®¹å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> LinkedList&lt;Runnable&gt; tasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¯•å›¾æ¶ˆè´¹ä»»åŠ¡çš„çº¿ç¨‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadPool</span><span class="hljs-params">()</span>&#123;<br>        threadPoolSize = <span class="hljs-number">10</span>;<br><br>        <span class="hljs-comment">//å¯åŠ¨ 10 ä¸ªä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹</span><br>        <span class="hljs-keyword">synchronized</span> (tasks)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; threadPoolSize; i++) &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">TaskConsumeThread</span>(<span class="hljs-string">&quot;ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ &quot;</span> + i).start();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Runnable runnable)</span>&#123;<br>        <span class="hljs-keyword">synchronized</span> (tasks)&#123;<br>            tasks.add(runnable);<br>            <span class="hljs-comment">//å”¤é†’ç­‰å¾…çš„ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹</span><br>            tasks.notifyAll();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskConsumeThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span>&#123;<br><br>        <span class="hljs-keyword">private</span> Runnable task;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">TaskConsumeThread</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> String name)</span> &#123;<br>            <span class="hljs-built_in">super</span>(name);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;å¯åŠ¨ï¼š&quot;</span> + getName());<br>            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-keyword">synchronized</span> (tasks)&#123;<br>                    <span class="hljs-keyword">while</span> (tasks.isEmpty())&#123;<br>                        <span class="hljs-keyword">try</span> &#123;<br>                            tasks.wait();<br>                        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                            e.printStackTrace();<br>                        &#125;<br>                    &#125;<br><br>                    task = tasks.removeLast();<br>                    <span class="hljs-comment">//å…è®¸æ·»åŠ ä»»åŠ¡çš„çº¿ç¨‹å¯ä»¥ç»§ç»­æ·»åŠ ä»»åŠ¡</span><br>                    tasks.notifyAll();<br>                &#125;<br>                System.out.println(getName() + <span class="hljs-string">&quot; è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ&quot;</span>);<br>                task.run();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPool</span>();<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">finalI</span> <span class="hljs-operator">=</span> i;<br>            <span class="hljs-type">Runnable</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œä»»åŠ¡ï¼š&quot;</span> + finalI);<br>                &#125;<br>            &#125;;<br><br>            pool.add(task);<br>        &#125;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">0</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">2</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">1</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">3</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">5</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">6</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">9</span><br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">2</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">9</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">0</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>æ‰§è¡Œä»»åŠ¡ï¼š<span class="hljs-number">3</span><br>æ‰§è¡Œä»»åŠ¡ï¼š<span class="hljs-number">0</span><br>æ‰§è¡Œä»»åŠ¡ï¼š<span class="hljs-number">2</span><br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">1</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>æ‰§è¡Œä»»åŠ¡ï¼š<span class="hljs-number">1</span><br>æ‰§è¡Œä»»åŠ¡ï¼š<span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æµ‹è¯•çº¿ç¨‹æ± "><a href="#ä¸‰ã€æµ‹è¯•çº¿ç¨‹æ± " class="headerlink" title="ä¸‰ã€æµ‹è¯•çº¿ç¨‹æ± "></a>ä¸‰ã€æµ‹è¯•çº¿ç¨‹æ± </h2><p>åˆ›é€ ä¸€ä¸ªæƒ…æ™¯ï¼Œæ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´éƒ½æ˜¯ 1 ç§’ï¼Œåˆšå¼€å§‹æ˜¯é—´éš” 1 ç§’é’Ÿå‘çº¿ç¨‹æ± ä¸­æ·»åŠ ä»»åŠ¡ï¼Œç„¶åé—´éš”æ—¶é—´è¶Šæ¥è¶ŠçŸ­ï¼Œæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹è¿˜æ²¡æ¥å¾—åŠç»“æŸï¼Œæ–°çš„ä»»åŠ¡åˆæ¥äº†ã€‚æ­¤æ—¶å°±ä¼šè§‚å¯Ÿåˆ°çº¿ç¨‹æ± é‡Œçš„å…¶ä»–çº¿ç¨‹è¢«å”¤é†’æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPool</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sleep</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            pool.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>                <span class="hljs-meta">@Override</span><br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">1000</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;);<br>            <span class="hljs-keyword">try</span> &#123;<br>                Thread.sleep(sleep);<br>                sleep = sleep &gt; <span class="hljs-number">100</span> ? sleep - <span class="hljs-number">100</span> : sleep;<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br><br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">0</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">3</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">2</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">1</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">5</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">6</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span><br>å¯åŠ¨ï¼šä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">9</span><br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">6</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">5</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">9</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">0</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">1</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">4</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">2</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">3</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">6</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">7</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">5</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">8</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">9</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>ä»»åŠ¡æ¶ˆè´¹è€…çº¿ç¨‹ <span class="hljs-number">0</span> è·å–åˆ°ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ<br>...<br></code></pre></td></tr></table></figure><h2 id="å››ã€ä½¿ç”¨-Java-è‡ªå¸¦çº¿ç¨‹æ± "><a href="#å››ã€ä½¿ç”¨-Java-è‡ªå¸¦çº¿ç¨‹æ± " class="headerlink" title="å››ã€ä½¿ç”¨ Java è‡ªå¸¦çº¿ç¨‹æ± "></a>å››ã€ä½¿ç”¨ Java è‡ªå¸¦çº¿ç¨‹æ± </h2><p>Java ç»™æˆ‘ä»¬æä¾›äº†è‡ªå¸¦çš„çº¿ç¨‹æ±  ThreadPoolExecutor åœ¨ java.util.concurrent åŒ…ä¸‹ã€‚</p><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">60</span>, TimeUnit.SECONDS, <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;());<br>pool.execute(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œä»»åŠ¡&quot;</span>);<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•° 10 ï¼šè¡¨ç¤ºçº¿ç¨‹æ± åˆå§‹åŒ–äº† 10 çº¿ç¨‹åœ¨é‡Œé¢å·¥ä½œ</p><p>ç¬¬äºŒä¸ªå‚æ•° 15 ï¼šè¡¨ç¤ºå¦‚æœ 10 ä¸ªçº¿ç¨‹ä¸å¤Ÿç”¨äº†ï¼Œå°±ä¼šå¢åŠ åˆ°æœ€å¤š 15 ä¸ªçº¿ç¨‹</p><p>ç¬¬ä¸‰ä¸ªå‚æ•° 60 ï¼šç»“åˆç¬¬å››ä¸ªå‚æ•° TimeUnit.SECONDS è¡¨ç¤º ç»è¿‡ 60 ç§’ï¼Œå¤šå‡ºæ¥çš„çº¿ç¨‹æ²¡æœ‰æ¥åˆ°æ´»ï¼Œå°±ä¼šå›æ”¶ï¼Œæœ€åä¿æŒæ± å­é‡Œé¢å°± 10 ä¸ª</p><p>ç¬¬å››ä¸ªå‚æ•° TimeUnit.SECONDS å¦‚ä¸Š</p><p>ç¬¬äº”ä¸ªå‚æ•° new LinkedBlockingQueue&lt;&gt;() ï¼šè¡¨ç¤ºå­˜æ”¾ä»»åŠ¡çš„é›†åˆ</p><p>execute æ–¹æ³•ç”¨äºæ·»åŠ å¹¶æ‰§è¡Œæ–°çš„ä»»åŠ¡</p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€è®¾è®¡ä¸€ä¸ªçº¿ç¨‹æ± çš„æ€è·¯å¹¶è¿›è¡Œäº†å…·ä½“å®ç°</p><p>2ã€è‡ªå®šä¹‰çº¿ç¨‹æ± æµ‹è¯•</p><p>3ã€Java è‡ªå¸¦çº¿ç¨‹æ± ä»‹ç»</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤šçº¿ç¨‹äº¤äº’ï¼ˆå››ï¼‰</title>
    <link href="/2022/09/13/thread4/"/>
    <url>/2022/09/13/thread4/</url>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>çº¿ç¨‹ä¹‹é—´æœ‰äº¤äº’é€šçŸ¥çš„éœ€æ±‚ï¼Œè€ƒè™‘å¦‚ä¸‹æƒ…å†µï¼š</p><p><strong>æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå¤„ç†åŒä¸€ä¸ªè‹±é›„ï¼Œä¸€ä¸ªåŠ è¡€ï¼Œä¸€ä¸ªå‡è¡€ã€‚</strong></p><p><strong>å‡è¡€çš„çº¿ç¨‹ï¼Œå‘ç°è¡€é‡ &#x3D; 1ï¼Œå°±åœæ­¢å‡è¡€ï¼ŒçŸ¥é“åŠ è¡€çš„çº¿ç¨‹ä¸ºè‹±é›„åŠ äº†è¡€ï¼ŒåŠ å¯ä»¥ç»§ç»­å‡è¡€ã€‚</strong></p><h2 id="ä¸€ã€ä¸å¥½çš„è§£å†³æ–¹å¼"><a href="#ä¸€ã€ä¸å¥½çš„è§£å†³æ–¹å¼" class="headerlink" title="ä¸€ã€ä¸å¥½çš„è§£å†³æ–¹å¼"></a>ä¸€ã€ä¸å¥½çš„è§£å†³æ–¹å¼</h2><p>1ï¼‰ã€æ•…æ„è®¾è®¡å‡è¡€çº¿ç¨‹é¢‘ç‡æ›´é«˜ï¼Œç›–ä¼¦çš„è¡€é‡è¿Ÿæ—©ä¼šåˆ°è¾¾ 1</p><p>2ï¼‰ã€å‡è¡€çº¿ç¨‹ä¸­ä½¿ç”¨ while å¾ªç¯åˆ¤æ–­ hp æ˜¯å¦ä¸º 1ï¼Œå¦‚æœæ˜¯ 1 å°±ä¸åœçš„å¾ªç¯ï¼ŒçŸ¥é“åŠ è¡€çº¿ç¨‹å›å¤äº†è¡€é‡</p><p>3ï¼‰ã€è¿™ç§æ–¹å¼ä¼šå¤§é‡å ç”¨ cpu ï¼Œæ‹–æ…¢æ€§èƒ½</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€æ–°å»ºä¸€ä¸ª Hero ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> hp;<br>      <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br>      <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span>&#123;<br>        hp=hp+<span class="hljs-number">1</span>;<br>    &#125;    <br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span>&#123;<br>            hp=hp-<span class="hljs-number">1</span>;   <br>    &#125;<br>      <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        h.hp-=damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>,name,h.name,h.name,h.hp);<br>        <span class="hljs-keyword">if</span>(h.isDead())<br>            System.out.println(h.name +<span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br>   <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&gt;=hp?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br>   <br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br><br>                    <span class="hljs-comment">//å› ä¸ºå‡è¡€æ›´å¿«ï¼Œæ‰€ä»¥ç›–ä¼¦çš„è¡€é‡è¿Ÿæ—©ä¼šåˆ°è¾¾1</span><br>                    <span class="hljs-comment">//ä½¿ç”¨whileå¾ªç¯åˆ¤æ–­æ˜¯å¦æ˜¯1ï¼Œå¦‚æœæ˜¯1å°±ä¸åœçš„å¾ªç¯</span><br>                    <span class="hljs-comment">//ç›´åˆ°åŠ è¡€çº¿ç¨‹å›å¤äº†è¡€é‡</span><br>                    <span class="hljs-keyword">while</span>(gareen.hp==<span class="hljs-number">1</span>)&#123;<br>                        <span class="hljs-keyword">continue</span>;<br>                    &#125;<br><br>                    gareen.hurt();<br>                    System.out.printf(<span class="hljs-string">&quot;t1 ä¸º%s å‡è¡€1ç‚¹,å‡å°‘è¡€åï¼Œ%sçš„è¡€é‡æ˜¯%.0f%n&quot;</span>,gareen.name,gareen.name,gareen.hp);<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">10</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br><br>            &#125;<br>        &#125;;<br>        t1.start();<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                    gareen.recover();<br>                    System.out.printf(<span class="hljs-string">&quot;t2 ä¸º%s å›è¡€1ç‚¹,å¢åŠ è¡€åï¼Œ%sçš„è¡€é‡æ˜¯%.0f%n&quot;</span>,gareen.name,gareen.name,gareen.hp);<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br><br>            &#125;<br>        &#125;;<br>        t2.start();<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>t1 ä¸ºç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">615</span><br>t2 ä¸ºç›–ä¼¦ å›è¡€<span class="hljs-number">1</span>ç‚¹,å¢åŠ è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">616</span><br>t1 ä¸ºç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">615</span><br>t1 ä¸ºç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">614</span><br>...<br><br></code></pre></td></tr></table></figure><h2 id="äºŒã€ä½¿ç”¨-wait-å’Œ-notify-è¿›è¡Œçº¿ç¨‹äº¤äº’"><a href="#äºŒã€ä½¿ç”¨-wait-å’Œ-notify-è¿›è¡Œçº¿ç¨‹äº¤äº’" class="headerlink" title="äºŒã€ä½¿ç”¨ wait å’Œ notify è¿›è¡Œçº¿ç¨‹äº¤äº’"></a>äºŒã€ä½¿ç”¨ wait å’Œ notify è¿›è¡Œçº¿ç¨‹äº¤äº’</h2><p>1ï¼‰ã€åœ¨ Hero ç±»ä¸­ï¼šhurt() å‡è¡€æ–¹æ³•ï¼šå½“ hp &#x3D; 1 çš„æ—¶å€™ï¼Œæ‰§è¡Œ this.wait()ï¼Œthis.wait() è¡¨ç¤ºè®©å æœ‰ this çš„çº¿ç¨‹ç­‰å¾…ï¼Œå¹¶ä¸´æ—¶é‡Šæ”¾å æœ‰ã€‚</p><p>2ï¼‰ã€è¿›å…¥ hurt() æ–¹æ³•çš„çº¿ç¨‹å¿…ç„¶æ˜¯å‡è¡€çº¿ç¨‹ï¼Œthis.wait() ä¼šè®©å‡è¡€çº¿ç¨‹ä¸´æ—¶é‡Šæ”¾å † this çš„å æœ‰ï¼Œè¿™æ ·åŠ è¡€çº¿ç¨‹ï¼Œå°±æœ‰æœºä¼šè¿›è¡Œ recover() åŠ è¡€æ–¹æ³•äº†ã€‚</p><p>3ï¼‰ã€recover() åŠ è¡€æ–¹æ³•ï¼šå¢åŠ äº†è¡€é‡ï¼Œæ‰§è¡Œ this.notify()ã€‚</p><p>4ï¼‰ã€ this.notify() è¡¨ç¤ºé€šçŸ¥é‚£äº›ç­‰å¾…åœ¨ this çš„çº¿ç¨‹ï¼Œå¯ä»¥è‹é†’è¿‡æ¥äº†ã€‚ç­‰å¾…åœ¨ this çš„çº¿ç¨‹ï¼Œæ°æ°æ˜¯å‡è¡€çº¿ç¨‹ã€‚</p><p>5ï¼‰ã€ä¸€æ—¦ recover() ç»“æŸï¼ŒåŠ è¡€çº¿ç¨‹é‡Šæ”¾äº† thisï¼Œå‡è¡€çº¿ç¨‹ï¼Œå°±å¯ä»¥é‡æ–°å æœ‰ thisï¼Œå¹¶æ‰§è¡Œåé¢çš„å‡è¡€å·¥ä½œã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c80293a546074515a426034b1522bd48~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221227114708310"></p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€Hero ç±»æ”¹é€ </span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span> &#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> hp;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span> &#123;<br>        hp = hp + <span class="hljs-number">1</span>;<br>        System.out.printf(<span class="hljs-string">&quot;%s å›è¡€1ç‚¹,å¢åŠ è¡€åï¼Œ%sçš„è¡€é‡æ˜¯%.0f%n&quot;</span>, name, name, hp);<br>        <span class="hljs-comment">// é€šçŸ¥é‚£äº›ç­‰å¾…åœ¨thiså¯¹è±¡ä¸Šçš„çº¿ç¨‹ï¼Œå¯ä»¥é†’è¿‡æ¥äº†ï¼Œå¦‚ç¬¬20è¡Œï¼Œç­‰å¾…ç€çš„å‡è¡€çº¿ç¨‹ï¼Œè‹é†’è¿‡æ¥</span><br>        <span class="hljs-built_in">this</span>.notify();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (hp == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// è®©å æœ‰thisçš„å‡è¡€çº¿ç¨‹ï¼Œæš‚æ—¶é‡Šæ”¾å¯¹thisçš„å æœ‰ï¼Œå¹¶ç­‰å¾…</span><br>                <span class="hljs-built_in">this</span>.wait();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        hp = hp - <span class="hljs-number">1</span>;<br>        System.out.printf(<span class="hljs-string">&quot;%s å‡è¡€1ç‚¹,å‡å°‘è¡€åï¼Œ%sçš„è¡€é‡æ˜¯%.0f%n&quot;</span>, name, name, hp);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        h.hp -= damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>, name, h.name, h.name, h.hp);<br>        <span class="hljs-keyword">if</span> (h.isDead())<br>            System.out.println(h.name + <span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> &gt;= hp ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br><br>                    gareen.hurt();<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">10</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br><br>            &#125;<br>        &#125;;<br>        t1.start();<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                    gareen.recover();<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br><br>            &#125;<br>        &#125;;<br>        t2.start();<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">615</span><br>ç›–ä¼¦ å›è¡€<span class="hljs-number">1</span>ç‚¹,å¢åŠ è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">616</span><br>ç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">615</span><br>ç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">614</span><br>...<br>ç›–ä¼¦ å›è¡€<span class="hljs-number">1</span>ç‚¹,å¢åŠ è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">2</span><br>ç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">1</span><br>ç›–ä¼¦ å›è¡€<span class="hljs-number">1</span>ç‚¹,å¢åŠ è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">2</span><br>ç›–ä¼¦ å‡è¡€<span class="hljs-number">1</span>ç‚¹,å‡å°‘è¡€åï¼Œç›–ä¼¦çš„è¡€é‡æ˜¯<span class="hljs-number">1</span><br>...<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€å…³äº-waitï¼Œnotifyï¼ŒnotifyAll"><a href="#ä¸‰ã€å…³äº-waitï¼Œnotifyï¼ŒnotifyAll" class="headerlink" title="ä¸‰ã€å…³äº waitï¼Œnotifyï¼ŒnotifyAll"></a>ä¸‰ã€å…³äº waitï¼Œnotifyï¼ŒnotifyAll</h2><p>è¿™é‡Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œwait æ–¹æ³•å’Œ notify æ–¹æ³•ï¼Œå¹¶<strong>ä¸æ˜¯Threadçº¿ç¨‹ä¸Šçš„æ–¹æ³•</strong>ï¼Œå®ƒä»¬æ˜¯ Object ä¸Šçš„æ–¹æ³•ã€‚</p><p>å› ä¸ºæ‰€æœ‰çš„ Object éƒ½å¯ä»¥è¢«ç”¨æ¥ä½œä¸ºåŒæ­¥å¯¹è±¡ï¼Œæ‰€ä»¥å‡†ç¡®çš„è®²ï¼Œwait å’Œ notify æ˜¯åŒæ­¥å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚</p><p>wait() çš„æ„æ€æ˜¯ï¼š è®©å ç”¨äº†è¿™ä¸ªåŒæ­¥å¯¹è±¡çš„<strong>çº¿ç¨‹</strong>ï¼Œä¸´æ—¶é‡Šæ”¾å½“å‰çš„å ç”¨ï¼Œå¹¶ä¸”ç­‰å¾…ã€‚ æ‰€ä»¥è°ƒç”¨waitæ˜¯æœ‰å‰ææ¡ä»¶çš„ï¼Œä¸€å®šæ˜¯åœ¨synchronizedå—é‡Œï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ã€‚</p><p>notify() çš„æ„æ€æ˜¯ï¼šé€šçŸ¥<strong>ä¸€ä¸ª</strong>ç­‰å¾…åœ¨è¿™ä¸ªåŒæ­¥å¯¹è±¡ä¸Šçš„çº¿ç¨‹ï¼Œ<strong>ä½ </strong>å¯ä»¥è‹é†’è¿‡æ¥äº†ï¼Œæœ‰æœºä¼šé‡æ–°å ç”¨å½“å‰å¯¹è±¡äº†ã€‚</p><p>notifyAll() çš„æ„æ€æ˜¯ï¼šé€šçŸ¥<strong>æ‰€æœ‰çš„</strong>ç­‰å¾…åœ¨è¿™ä¸ªåŒæ­¥å¯¹è±¡ä¸Šçš„çº¿ç¨‹ï¼Œ<strong>ä½ ä»¬</strong>å¯ä»¥è‹é†’è¿‡æ¥äº†ï¼Œæœ‰æœºä¼šé‡æ–°å ç”¨å½“å‰å¯¹è±¡äº†ã€‚</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¤šçº¿ç¨‹äº¤äº’çš„é—®é¢˜ï¼Œå¼•å‡ºäº†å¯¹ wait ï¼Œnotify çš„ä»‹ç»å’Œä½¿ç”¨ï¼Œæ³¨æ„ wait ï¼Œnotify ç­‰æ–¹æ³•éƒ½æ˜¯ Object ä¸Šçš„æ–¹æ³•ï¼Œå› ä¸ºæ‰€æœ‰çš„ Object éƒ½å¯ä»¥å½“ä½œåŒæ­¥å¯¹è±¡ï¼Œæ‰€ä»¥æ›´å‡†ç¡®çš„è®²ï¼Œwait å’Œ notify æ˜¯åŒæ­¥å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 30. åŒ…å«minå‡½æ•°çš„æ ˆï¼ˆå››åï¼‰</title>
    <link href="/2022/09/13/A40-%E5%89%91%E6%8C%87%20Offer%2030.%20%E5%8C%85%E5%90%ABmin%E5%87%BD%E6%95%B0%E7%9A%84%E6%A0%88%EF%BC%88%E5%9B%9B%E5%8D%81%EF%BC%89/"/>
    <url>/2022/09/13/A40-%E5%89%91%E6%8C%87%20Offer%2030.%20%E5%8C%85%E5%90%ABmin%E5%87%BD%E6%95%B0%E7%9A%84%E6%A0%88%EF%BC%88%E5%9B%9B%E5%8D%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/bao-han-minhan-shu-de-zhan-lcof/">å‰‘æŒ‡ Offer 30. åŒ…å«minå‡½æ•°çš„æ ˆ</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ ˆã€</p><p>å®šä¹‰æ ˆçš„æ•°æ®ç»“æ„ï¼Œè¯·åœ¨è¯¥ç±»å‹ä¸­å®ç°ä¸€ä¸ªèƒ½å¤Ÿå¾—åˆ°æ ˆçš„æœ€å°å…ƒç´ çš„ min å‡½æ•°åœ¨è¯¥æ ˆä¸­ï¼Œè°ƒç”¨ minã€push åŠ pop çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">MinStack</span> <span class="hljs-variable">minStack</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MinStack</span>();<br>minStack.push(-<span class="hljs-number">2</span>);<br>minStack.push(<span class="hljs-number">0</span>);<br>minStack.push(-<span class="hljs-number">3</span>);<br>minStack.min();   --&gt; è¿”å› -<span class="hljs-number">3.</span><br>minStack.pop();<br>minStack.top();      --&gt; è¿”å› <span class="hljs-number">0.</span><br>minStack.min();   --&gt; è¿”å› -<span class="hljs-number">2.</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€å„å‡½æ•°çš„è°ƒç”¨æ€»æ¬¡æ•°ä¸è¶…è¿‡ 20000 æ¬¡</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>è¿™é¢˜æˆ‘ä»¬é¦–å…ˆè¦ç†è§£æ ˆç»“æ„å…ˆè¿›åå‡ºçš„æ€§è´¨ã€‚</p><p>å¯¹äºæ ˆæ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´  a åœ¨å…¥æ ˆæ—¶ï¼Œæ ˆé‡Œæœ‰å…¶å®ƒçš„å…ƒç´  b, c, dï¼Œé‚£ä¹ˆæ— è®ºè¿™ä¸ªæ ˆåœ¨ä¹‹åç»å†äº†ä»€ä¹ˆæ“ä½œï¼Œåªè¦ a åœ¨æ ˆä¸­ï¼Œb, c, d å°±ä¸€å®šåœ¨æ ˆä¸­ï¼Œå› ä¸ºåœ¨ a è¢«å¼¹å‡ºä¹‹å‰ï¼Œb, c, d ä¸ä¼šè¢«å¼¹å‡ºã€‚</p><p>å› æ­¤ï¼Œåœ¨æ“ä½œè¿‡ç¨‹ä¸­çš„ä»»æ„ä¸€ä¸ªæ—¶åˆ»ï¼Œåªè¦æ ˆé¡¶çš„å…ƒç´ æ˜¯ aï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šæ ˆé‡Œé¢ç°åœ¨çš„å…ƒç´ ä¸€å®šæ˜¯ a, b, c, dã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªå…ƒç´  a å…¥æ ˆæ—¶æŠŠå½“å‰æ ˆçš„æœ€å°å€¼ m å­˜å‚¨èµ·æ¥ã€‚åœ¨è¿™ä¹‹åæ— è®ºä½•æ—¶ï¼Œå¦‚æœæ ˆé¡¶å…ƒç´ æ˜¯ aï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¿”å›å­˜å‚¨çš„æœ€å°å€¼ mã€‚</p><p><strong>ç®—æ³•</strong></p><p>æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬åªéœ€è¦è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´  a ä¸å…¶ç›¸åº”çš„æœ€å°å€¼ m æ—¶åˆ»ä¿æŒä¸€ä¸€å¯¹åº”ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¾…åŠ©æ ˆï¼Œä¸å…ƒç´ æ ˆåŒæ­¥æ’å…¥ä¸åˆ é™¤ï¼Œç”¨äºå­˜å‚¨ä¸æ¯ä¸ªå…ƒç´ å¯¹åº”çš„æœ€å°å€¼ã€‚</p><p>å½“ä¸€ä¸ªå…ƒç´ è¦å…¥æ ˆæ—¶ï¼Œæˆ‘ä»¬å–å½“å‰è¾…åŠ©æ ˆçš„æ ˆé¡¶å­˜å‚¨çš„æœ€å°å€¼ï¼Œä¸å½“å‰å…ƒç´ æ¯”è¾ƒå¾—å‡ºæœ€å°å€¼ï¼Œå°†è¿™ä¸ªæœ€å°å€¼æ’å…¥è¾…åŠ©æ ˆä¸­ï¼›</p><p>å½“ä¸€ä¸ªå…ƒç´ è¦å‡ºæ ˆæ—¶ï¼Œæˆ‘ä»¬æŠŠè¾…åŠ©æ ˆçš„æ ˆé¡¶å…ƒç´ ä¹Ÿä¸€å¹¶å¼¹å‡ºï¼›</p><p>åœ¨ä»»æ„ä¸€ä¸ªæ—¶åˆ»ï¼Œæ ˆå†…å…ƒç´ çš„æœ€å°å€¼å°±å­˜å‚¨åœ¨è¾…åŠ©æ ˆçš„æ ˆé¡¶å…ƒç´ ä¸­ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MinStack</span> &#123;<br>    Deque&lt;Integer&gt; xStack;<br>    Deque&lt;Integer&gt; minStack;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MinStack</span><span class="hljs-params">()</span> &#123;<br>        xStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;Integer&gt;();<br>        minStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;Integer&gt;();<br>        minStack.push(Integer.MAX_VALUE);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        xStack.push(x);<br>        minStack.push(Math.min(minStack.peek(), x));<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pop</span><span class="hljs-params">()</span> &#123;<br>        xStack.pop();<br>        minStack.pop();<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">top</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> xStack.peek();<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">min</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> minStack.peek();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šå¯¹äºé¢˜ç›®ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)ã€‚å› ä¸ºæ ˆçš„æ’å…¥ã€åˆ é™¤ä¸è¯»å–æ“ä½œéƒ½æ˜¯ O(1)ï¼Œæˆ‘ä»¬å®šä¹‰çš„æ¯ä¸ªæ“ä½œæœ€å¤šè°ƒç”¨æ ˆæ“ä½œä¸¤æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºæ€»æ“ä½œæ•°ã€‚æœ€åæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šè¿ç»­æ’å…¥ n ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶ä¸¤ä¸ªæ ˆå ç”¨çš„ç©ºé—´ä¸º O(n)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨äº†åŒæ ˆï¼šä¸€ä¸ªæ­£å¸¸çš„æ ˆï¼Œä¸€ä¸ªè®°å½•æ ˆé¡¶ä¸ºæœ€å°å…ƒç´ çš„æ ˆã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>coroutine</title>
    <link href="/2022/09/13/coroutine/"/>
    <url>/2022/09/13/coroutine/</url>
    
    <content type="html"><![CDATA[<p>æºä»£ç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CoroutineActivity</span> : <span class="hljs-type">AppCompatActivity</span>() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_coroutine)<br><br>        startCoroutine()<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startCoroutine</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">val</span> funTest: <span class="hljs-keyword">suspend</span> CoroutineScope.() -&gt; <span class="hljs-built_in">Unit</span> = &#123;<br>            println(<span class="hljs-string">&quot;funTest&quot;</span>)<br>            suspendFun1()<br>            suspendFun2()<br>        &#125;<br><br>        GlobalScope.launch(Dispatchers.Default, block = funTest)<br>    &#125;<br><br>    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">suspendFun1</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;suspendFun1&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">suspendFun2</span><span class="hljs-params">()</span></span>&#123;<br>        println(<span class="hljs-string">&quot;suspendFun2&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åç¼–è¯‘åçš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CoroutineActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>   <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;<br>      <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>      <span class="hljs-built_in">this</span>.setContentView(<span class="hljs-number">1300001</span>);<br>      <span class="hljs-built_in">this</span>.startCoroutine();<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startCoroutine</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-type">Function2</span> <span class="hljs-variable">funTest</span> <span class="hljs-operator">=</span> (Function2)(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Function2</span>((Continuation)<span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">//å½“å‰çŠ¶æ€æœºï¼šé»˜è®¤ä¸º 0</span><br>         <span class="hljs-type">int</span> label;<br><br>         <span class="hljs-comment">//åç¨‹ä½“è¢«è½¬æ¢æˆ invokeSuspend å‡½æ•°çš„è°ƒç”¨</span><br>         <span class="hljs-meta">@Nullable</span><br>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Object <span class="hljs-title function_">invokeSuspend</span><span class="hljs-params">(<span class="hljs-meta">@NotNull</span> Object $result)</span> &#123;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">var3</span> <span class="hljs-operator">=</span> IntrinsicsKt.getCOROUTINE_SUSPENDED();<br>            CoroutineActivity var10000;<br>            <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.label) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>               ResultKt.throwOnFailure($result);<br>               <span class="hljs-type">String</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;funTest&quot;</span>;<br>               System.out.println(var2);<br>               var10000 = CoroutineActivity.<span class="hljs-built_in">this</span>;<br>               <span class="hljs-comment">//çŠ¶æ€æœºçŠ¶æ€è®¾ç½®ä¸º 1</span><br>               <span class="hljs-built_in">this</span>.label = <span class="hljs-number">1</span>;<br>               <span class="hljs-comment">//suspendFun1 å‡½æ•°è°ƒç”¨</span><br>               <span class="hljs-keyword">if</span> (var10000.suspendFun1(<span class="hljs-built_in">this</span>) == var3) &#123;<br>                  <span class="hljs-keyword">return</span> var3;<br>               &#125;<br>               <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>               <span class="hljs-comment">//å¼‚å¸¸å¤„ç†</span><br>               ResultKt.throwOnFailure($result);<br>               <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-comment">//å¼‚å¸¸å¤„ç†</span><br>               ResultKt.throwOnFailure($result);<br>               <span class="hljs-keyword">return</span> Unit.INSTANCE;<br>            <span class="hljs-keyword">default</span>:<br>               <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">&quot;call to &#x27;resume&#x27; before &#x27;invoke&#x27; with coroutine&quot;</span>);<br>            &#125;<br><br>            var10000 = CoroutineActivity.<span class="hljs-built_in">this</span>;<br>           <span class="hljs-comment">//çŠ¶æ€æœºçŠ¶æ€è®¾ç½®ä¸º 2</span><br>            <span class="hljs-built_in">this</span>.label = <span class="hljs-number">2</span>;<br>           <span class="hljs-comment">//suspendFun2 å‡½æ•°è°ƒç”¨</span><br>            <span class="hljs-keyword">if</span> (var10000.suspendFun2(<span class="hljs-built_in">this</span>) == var3) &#123;<br>               <span class="hljs-keyword">return</span> var3;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>               <span class="hljs-keyword">return</span> Unit.INSTANCE;<br>            &#125;<br>         &#125;<br><br>         <span class="hljs-comment">//åˆ›å»º Continuation</span><br>         <span class="hljs-meta">@NotNull</span> <br>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Continuation <span class="hljs-title function_">create</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object value, <span class="hljs-meta">@NotNull</span> Continuation completion)</span> &#123;<br>            Intrinsics.checkNotNullParameter(completion, <span class="hljs-string">&quot;completion&quot;</span>);<br>            <span class="hljs-type">Function2</span> <span class="hljs-variable">var3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> &lt;anonymous constructor&gt;(completion);<br>            <span class="hljs-keyword">return</span> var3;<br>         &#125;<br><br>         <span class="hljs-comment">//å®é™…æ˜¯è°ƒç”¨ invokeSuspend</span><br>         <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object var1, Object var2)</span> &#123;<br>            <span class="hljs-keyword">return</span> ((&lt;undefinedtype&gt;)<span class="hljs-built_in">this</span>.create(var1, (Continuation)var2)).invokeSuspend(Unit.INSTANCE);<br>         &#125;<br>      &#125;);<br>      BuildersKt.launch$<span class="hljs-keyword">default</span>((CoroutineScope)GlobalScope.INSTANCE, (CoroutineContext)Dispatchers.getDefault(), (CoroutineStart)<span class="hljs-literal">null</span>, funTest, <span class="hljs-number">2</span>, (Object)<span class="hljs-literal">null</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Nullable</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Object <span class="hljs-title function_">suspendFun1</span><span class="hljs-params">(<span class="hljs-meta">@NotNull</span> Continuation $completion)</span> &#123;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;suspendFun1&quot;</span>;<br>      System.out.println(var2);<br>      <span class="hljs-keyword">return</span> Unit.INSTANCE;<br>   &#125;<br><br>   <span class="hljs-meta">@Nullable</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Object <span class="hljs-title function_">suspendFun2</span><span class="hljs-params">(<span class="hljs-meta">@NotNull</span> Continuation $completion)</span> &#123;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;suspendFun2&quot;</span>;<br>      System.out.println(var2);<br>      <span class="hljs-keyword">return</span> Unit.INSTANCE;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€funTest åç¨‹ä½“ä¸¤ä¸ªé‡è¦æ–¹æ³•ï¼š</p><blockquote><p>invokeSuspend</p><p>create</p></blockquote><p>2ã€suspendFun1ï¼ŒsuspendFun2 æ–¹æ³•å¤šäº†ä¸€ä¸ª Contination å‚æ•°ï¼Œè¿™ä¹Ÿæ˜¯æ™®é€šå‡½æ•°æ— æ³•è°ƒèµ·æŒ‚æœºå‡½æ•°çš„åŸå› </p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¤šçº¿ç¨‹åŒæ­¥ï¼ˆä¸‰ï¼‰</title>
    <link href="/2022/09/12/thread3/"/>
    <url>/2022/09/12/thread3/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¼”ç¤ºå¤šçº¿ç¨‹åŒæ­¥é—®é¢˜"><a href="#ä¸€ã€æ¼”ç¤ºå¤šçº¿ç¨‹åŒæ­¥é—®é¢˜" class="headerlink" title="ä¸€ã€æ¼”ç¤ºå¤šçº¿ç¨‹åŒæ­¥é—®é¢˜"></a>ä¸€ã€æ¼”ç¤ºå¤šçº¿ç¨‹åŒæ­¥é—®é¢˜</h2><p>å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå¯èƒ½å¯¼è‡´çš„é—®é¢˜ï¼Œå¤šçº¿ç¨‹çš„é—®é¢˜ï¼Œä¹Ÿå«å¹¶å‘ï¼ˆConcurrencyï¼‰é—®é¢˜ã€‚</p><p>å‡è®¾ç›–ä¼¦æœ‰ 10000 æ»´è¡€ï¼Œå¹¶ä¸”åœ¨åŸºåœ°é‡Œï¼ŒåŒæ—¶åˆè¢«å¯¹æ–¹å¤šä¸ªè‹±é›„æ”»å‡»ï¼Œç›¸å½“äºï¼š</p><p><strong>æœ‰å¤šä¸ªçº¿ç¨‹åœ¨å‡å°‘ç›–ä¼¦çš„ hpï¼ŒåŒæ—¶åˆæœ‰å¤šä¸ªçº¿ç¨‹åœ¨æ¢å¤ç›–ä¼¦çš„ hp</strong></p><p>å‡è®¾çº¿ç¨‹çš„æ•°é‡æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”æ¯æ¬¡æ”¹å˜çš„å€¼éƒ½æ˜¯ 1ï¼Œé‚£ä¹ˆæ‰€æœ‰çº¿ç¨‹ç»“æŸåï¼Œç›–ä¼¦çš„ hp åº”è¯¥è¿˜æ˜¯ 10000ã€‚</p><p>ä½†å®é™…ç»“æœå¹¶éå¦‚æ­¤</p><p><strong>æ³¨æ„ï¼š</strong> ä¸æ˜¯æ¯ä¸€æ¬¡è¿è¡Œéƒ½ä¼šçœ‹åˆ°é”™è¯¯çš„æ•°æ®äº§ç”Ÿï¼Œå¤šè¿è¡Œå‡ æ¬¡ï¼Œæˆ–è€…å¢åŠ è¿è¡Œçš„æ¬¡æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€æ–°å»ºä¸€ä¸ª Hero ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span> &#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> hp;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br><br>    <span class="hljs-comment">//å›è¡€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span> &#123;<br>        hp = hp + <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æ‰è¡€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span> &#123;<br>        hp = hp - <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        h.hp -= damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>, name, h.name, h.name, h.hp);<br>        <span class="hljs-keyword">if</span> (h.isDead())<br>            System.out.println(h.name + <span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> &gt;= hp;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">10000</span>;<br><br>        System.out.printf(<span class="hljs-string">&quot;ç›–ä¼¦çš„åˆå§‹è¡€é‡æ˜¯ %.0f%n&quot;</span>, gareen.hp);<br><br>        <span class="hljs-comment">//å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜æŒ‡çš„æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå¯¼è‡´çš„é—®é¢˜</span><br>        <span class="hljs-comment">//å‡è®¾ç›–ä¼¦æœ‰10000æ»´è¡€ï¼Œå¹¶ä¸”åœ¨åŸºåœ°é‡Œï¼ŒåŒæ—¶åˆè¢«å¯¹æ–¹å¤šä¸ªè‹±é›„æ”»å‡»</span><br>        <span class="hljs-comment">//ç”¨ Java ä»£ç æ¥è¡¨ç¤ºï¼Œå°±æ˜¯æœ‰å¤šä¸ªçº¿ç¨‹åœ¨å‡å°‘ç›–ä¼¦çš„hp</span><br>        <span class="hljs-comment">//åŒæ—¶åˆæœ‰å¤šä¸ªçº¿ç¨‹åœ¨æ¢å¤ç›–ä¼¦çš„hp</span><br>        <span class="hljs-comment">//nä¸ªçº¿ç¨‹å¢åŠ ç›–ä¼¦çš„hp</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;<br><br>        Thread[] addThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br>        Thread[] reduceThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br><br>        <span class="hljs-comment">//nä¸ªçº¿ç¨‹æ¢å¤ç›–ä¼¦çš„hp</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    gareen.recover();<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            addThreads[i] = t;<br>        &#125;<br><br>        <span class="hljs-comment">//nä¸ªçº¿ç¨‹å‡å°‘ç›–ä¼¦çš„hp</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    gareen.hurt();<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            reduceThreads[i] = t;<br>        &#125;<br><br>        <span class="hljs-comment">//ç­‰å¾…æ‰€æœ‰åŠ è¡€çº¿ç¨‹ç»“æŸ</span><br>        <span class="hljs-keyword">for</span> (Thread t : addThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">//ç­‰å¾…æ‰€æœ‰å‡è¡€çº¿ç¨‹ç»“æŸ</span><br>        <span class="hljs-keyword">for</span> (Thread t : reduceThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">//ä»£ç æ‰§è¡Œåˆ°è¿™é‡Œï¼Œæ‰€æœ‰åŠ è¡€å’Œå‡è¡€çº¿ç¨‹éƒ½ç»“æŸäº†</span><br>        <span class="hljs-comment">//åŠ è¡€å’Œå‡è¡€çº¿ç¨‹çš„æ•°é‡æ˜¯ä¸€æ ·çš„ï¼Œæ¯æ¬¡éƒ½å¢åŠ ï¼Œå‡å°‘1.</span><br>        <span class="hljs-comment">//é‚£ä¹ˆæ‰€æœ‰çº¿ç¨‹éƒ½ç»“æŸåï¼Œç›–ä¼¦çš„hpåº”è¯¥è¿˜æ˜¯åˆå§‹å€¼</span><br>        <span class="hljs-comment">//ä½†æ˜¯äº‹å®ä¸Šè§‚å¯Ÿåˆ°çš„æ˜¯ï¼š</span><br>        System.out.printf(<span class="hljs-string">&quot;%dä¸ªåŠ è¡€çº¿ç¨‹å’Œ%dä¸ªå‡çº¿ç¨‹ç»“æŸå%nç›–ä¼¦çš„è¡€é‡å˜æˆäº† %.0f%n&quot;</span>, n, n, gareen.hp);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦çš„åˆå§‹è¡€é‡æ˜¯ <span class="hljs-number">10000</span><br><span class="hljs-number">10000</span>ä¸ªåŠ è¡€çº¿ç¨‹å’Œ<span class="hljs-number">10000</span>ä¸ªå‡è¡€çº¿ç¨‹ç»“æŸå<br>ç›–ä¼¦çš„è¡€é‡å˜æˆäº† <span class="hljs-number">9999</span><br></code></pre></td></tr></table></figure><h2 id="äºŒã€åˆ†æåŒæ­¥é—®é¢˜äº§ç”Ÿçš„åŸå› "><a href="#äºŒã€åˆ†æåŒæ­¥é—®é¢˜äº§ç”Ÿçš„åŸå› " class="headerlink" title="äºŒã€åˆ†æåŒæ­¥é—®é¢˜äº§ç”Ÿçš„åŸå› "></a>äºŒã€åˆ†æåŒæ­¥é—®é¢˜äº§ç”Ÿçš„åŸå› </h2><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae6aee4bb9d14117a42f02f70ac8c1e2~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221227100429593"></p><p>1ã€å‡è®¾åŠ è¡€çº¿ç¨‹å…ˆè¿›å…¥ï¼Œå¾—åˆ°çš„ hp æ˜¯ 10000ï¼Œè¿›è¡Œå¢åŠ è¿ç®—</p><p>2ã€æ­£åœ¨åšå¢åŠ è¿ç®—çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠä¿®æ”¹ hp çš„å€¼ï¼Œå‡è¡€çº¿ç¨‹æ¥äº†</p><p>3ã€å‡è¡€çº¿ç¨‹å¾—åˆ°çš„ hp ä¹Ÿæ˜¯ 10000ï¼Œå‡è¡€çº¿ç¨‹è¿›è¡Œå‡å°‘è¿ç®—</p><p>4ã€åŠ è¡€çº¿ç¨‹è¿ç®—ç»“æŸï¼Œå¾—åˆ°å€¼ 10001ï¼Œå¹¶æŠŠè¿™ä¸ªå€¼èµ‹äºˆ hp</p><p>5ã€å‡è¡€çº¿ç¨‹è¿ç®—ç»“æŸï¼Œå¾—åˆ°å€¼ 9999ï¼Œå¹¶æŠŠè¿™ä¸ªå€¼èµ‹äºˆ hpï¼Œé‚£ä¹ˆ hp æœ€ç»ˆçš„å€¼å°±æ˜¯ 9999</p><p>è™½ç„¶ç»å†äº†ä¸¤ä¸ªçº¿ç¨‹å„è‡ªå¢å‡äº†ä¸€æ¬¡ï¼Œæœ¬æ¥æœŸæœ›è¿˜æ˜¯åŸå€¼ 10000ï¼Œä½†æ˜¯å´å¾—åˆ°äº† 9999ï¼Œè¿™ä¸ªæ—¶å€™çš„å€¼æ˜¯ä¸€ä¸ªé”™è¯¯çš„å€¼ï¼Œåœ¨ä¸šåŠ¡ä¸Šåˆå«åšè„æ•°æ®</p><h2 id="ä¸‰ã€è§£å†³æ€è·¯"><a href="#ä¸‰ã€è§£å†³æ€è·¯" class="headerlink" title="ä¸‰ã€è§£å†³æ€è·¯"></a>ä¸‰ã€è§£å†³æ€è·¯</h2><p>æ€»ä½“è§£å†³æ€è·¯æ˜¯ï¼š<strong>åœ¨åŠ è¡€çº¿ç¨‹è®¿é—® hp æœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹ä¸å¯ä»¥è®¿é—® hp</strong></p><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/780176ee203b42f4bdd0a5a007935638~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221227102140108"></p><p>1ã€åŠ è¡€çº¿ç¨‹è·å¾— hp å¹¶è¿›è¡Œè¿ç®—ï¼Œåœ¨è¿ç®—æœŸé—´ï¼Œå‡è¡€çº¿ç¨‹è¯•å›¾æ¥è·å– hp ï¼Œä½†ä¸è¢«å…è®¸</p><p>2ã€åŠ è¡€çº¿ç¨‹è¿ç®—ç»“æŸï¼Œå¹¶æˆåŠŸä¿®æ”¹ hp çš„å€¼ä¸º 10001</p><p>3ã€å‡è¡€çº¿ç¨‹åœ¨åŠ è¡€çº¿ç¨‹åšå®Œåï¼Œæ‰èƒ½è®¿é—® hp çš„å€¼å³ 10001</p><p>4ã€å‡è¡€çº¿ç¨‹åšå‡å°‘è¿ç®—ï¼Œå¹¶å¾—åˆ°æ–°çš„å€¼ 10000</p><h2 id="å››ã€synchronized-åŒæ­¥å¯¹è±¡æ¦‚å¿µ"><a href="#å››ã€synchronized-åŒæ­¥å¯¹è±¡æ¦‚å¿µ" class="headerlink" title="å››ã€synchronized åŒæ­¥å¯¹è±¡æ¦‚å¿µ"></a>å››ã€synchronized åŒæ­¥å¯¹è±¡æ¦‚å¿µ</h2><p>è§£å†³ä¸Šè¿°é—®é¢˜ä¹‹å‰ï¼Œå…ˆç†è§£ synchronized å…³é”®å­—çš„æ„ä¹‰ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">someObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><span class="hljs-keyword">synchronized</span>(someObject)&#123;<br>  <span class="hljs-comment">//æ­¤å¤„çš„ä»£ç åªæœ‰å æœ‰äº† someObject åæ‰å¯ä»¥æ‰§è¡Œ</span><br>&#125;<br></code></pre></td></tr></table></figure><p>1ï¼‰ã€synchronized è¡¨ç¤ºå½“å‰çº¿ç¨‹ï¼Œç‹¬å å¯¹è±¡ someObjectï¼Œå½“å‰å¯¹è±¡ç‹¬å äº† someObjectï¼Œå¦‚æœæœ‰å…¶ä»–çº¿ç¨‹è¯•å›¾å æœ‰ someObject ï¼Œå°±ä¼šç­‰å¾…ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹é‡Šæ”¾ someObject çš„å ç”¨ã€‚</p><p>2ï¼‰ã€someObject åˆå«åŒæ­¥å¯¹è±¡ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºåŒæ­¥å¯¹è±¡</p><p>3ï¼‰ã€ä¸ºäº†è¾¾åˆ°åŒæ­¥çš„æ•ˆæœï¼Œå¿…é¡»ä½¿ç”¨åŒä¸€ä¸ªåŒæ­¥å¯¹è±¡</p><p>4ï¼‰ã€é‡Šæ”¾åŒæ­¥å¯¹è±¡çš„æ–¹å¼ï¼šsynchronized å—è‡ªç„¶ç»“æŸï¼Œæˆ–è€…æœ‰å¼‚å¸¸æŠ›å‡º</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13256736ecf2428c90b709da84fb5306~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20221227103526974"></p><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">now</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>).format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">someObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>        <span class="hljs-comment">//t1 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() +  <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    &#125;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t1.setName(<span class="hljs-string">&quot;t1&quot;</span>);<br>        t1.start();<br><br>        <span class="hljs-comment">//t2 çº¿ç¨‹</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() +  <span class="hljs-string">&quot; è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; å æœ‰å¯¹è±¡ï¼šsomeObject&quot;</span>);<br>                        Thread.sleep(<span class="hljs-number">5000</span>);<br>                        System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; é‡Šæ”¾å¯¹è±¡ï¼šsomeObject&quot;</span>);<br><br>                    &#125;<br>                    System.out.println(now() + <span class="hljs-string">&quot; &quot;</span> + getName() + <span class="hljs-string">&quot; çº¿ç¨‹ç»“æŸ&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t2.setName(<span class="hljs-string">&quot;t2&quot;</span>);<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">42</span> t2 è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">42</span> t1 è¯•å›¾å æœ‰å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">42</span> t2 å æœ‰å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">47</span> t2 é‡Šæ”¾å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">47</span> t2 çº¿ç¨‹ç»“æŸ<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">47</span> t1 å æœ‰å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span> t1 é‡Šæ”¾å¯¹è±¡ï¼šsomeObject<br><span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span> t1 çº¿ç¨‹ç»“æŸ<br></code></pre></td></tr></table></figure><p>æ ¹æ®æ‰“å°ç»“æœæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šåªæœ‰å½“ t2 é‡Šæ”¾å¯¹è±¡ä¹‹åï¼Œt1 æ‰èƒ½å æœ‰å¯¹è±¡</p><h2 id="äº”ã€ä½¿ç”¨-synchronized-è§£å†³åŒæ­¥é—®é¢˜"><a href="#äº”ã€ä½¿ç”¨-synchronized-è§£å†³åŒæ­¥é—®é¢˜" class="headerlink" title="äº”ã€ä½¿ç”¨ synchronized è§£å†³åŒæ­¥é—®é¢˜"></a>äº”ã€ä½¿ç”¨ synchronized è§£å†³åŒæ­¥é—®é¢˜</h2><p>æ‰€æœ‰éœ€è¦ä¿®æ”¹ hp çš„åœ°æ–¹ï¼Œæ˜¯å»ºç«‹åœ¨å æœ‰ someObject çš„åŸºç¡€ä¸Šï¼ŒsomeObject åœ¨åŒä¸€æ—¶é—´ï¼Œåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å æœ‰ã€‚é—´æ¥åœ°ï¼Œå¯¼è‡´åŒä¸€æ—¶é—´ï¼Œ hp åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">someObject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">10000</span>;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;<br><br>        Thread[] addThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br>        Thread[] reduceThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    <span class="hljs-comment">//ä»»ä½•çº¿ç¨‹è¦ä¿®æ”¹hpçš„å€¼ï¼Œå¿…é¡»å…ˆå æœ‰ someObject</span><br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        gareen.recover();<br>                    &#125;<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            addThreads[i] = t;<br><br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    <span class="hljs-comment">//ä»»ä½•çº¿ç¨‹è¦ä¿®æ”¹hpçš„å€¼ï¼Œå¿…é¡»å…ˆå æœ‰ someObject</span><br>                    <span class="hljs-keyword">synchronized</span> (someObject) &#123;<br>                        gareen.hurt();<br>                    &#125;<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            reduceThreads[i] = t;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (Thread t : addThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (Thread t : reduceThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        System.out.printf(<span class="hljs-string">&quot;%dä¸ªå¢åŠ çº¿ç¨‹å’Œ%dä¸ªå‡å°‘çº¿ç¨‹ç»“æŸå%nç›–ä¼¦çš„è¡€é‡æ˜¯ %.0f%n&quot;</span>, n, n, gareen.hp);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10000</span>ä¸ªå¢åŠ çº¿ç¨‹å’Œ<span class="hljs-number">10000</span>ä¸ªå‡å°‘çº¿ç¨‹ç»“æŸå<br>ç›–ä¼¦çš„è¡€é‡æ˜¯ <span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure><h2 id="å…­ã€ä½¿ç”¨-hero-å¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡"><a href="#å…­ã€ä½¿ç”¨-hero-å¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡" class="headerlink" title="å…­ã€ä½¿ç”¨ hero å¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡"></a>å…­ã€ä½¿ç”¨ hero å¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡</h2><p>æ—¢ç„¶ä»»æ„å¯¹è±¡éƒ½å¯ä»¥ç”¨æ¥ä½œä¸ºåŒæ­¥å¯¹è±¡ï¼Œè€Œæ‰€æœ‰çš„çº¿ç¨‹è®¿é—®çš„éƒ½æ˜¯åŒä¸€ä¸ª hero å¯¹è±¡ï¼Œ<strong>ç´¢æ€§å°±ä½¿ç”¨ gareen æ¥ä½œä¸ºåŒæ­¥å¯¹è±¡</strong>ï¼Œè¿›ä¸€æ­¥çš„ï¼Œå¯¹äº Hero çš„ hurt æ–¹æ³•ï¼ŒåŠ ä¸Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>è¡¨ç¤ºå½“å‰å¯¹è±¡ä¸ºåŒæ­¥å¯¹è±¡ï¼Œå³ä¹Ÿæ˜¯ gareen ä¸ºåŒæ­¥å¯¹è±¡ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€Hero çš„ hurt æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span> &#123;<br>  <br>    <span class="hljs-comment">//...</span><br>    <br>    <span class="hljs-comment">//æ‰è¡€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>)&#123;<br>            hp = hp - <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">10000</span>;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;<br><br>        Thread[] addThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br>        Thread[] reduceThreads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[n];<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><br>                    <span class="hljs-comment">//ä½¿ç”¨ gareen ä½œä¸º synchronized</span><br>                    <span class="hljs-keyword">synchronized</span> (gareen) &#123;<br>                        gareen.recover();<br>                    &#125;<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            addThreads[i] = t;<br><br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>() &#123;<br>                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                    <span class="hljs-comment">//ä½¿ç”¨ gareen ä½œä¸º synchronized</span><br>                    <span class="hljs-comment">//åœ¨æ–¹æ³• hurt ä¸­æœ‰ synchronized(this)</span><br>                    gareen.hurt();<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            t.start();<br>            reduceThreads[i] = t;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (Thread t : addThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (Thread t : reduceThreads) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                t.join();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        System.out.printf(<span class="hljs-string">&quot;%dä¸ªå¢åŠ çº¿ç¨‹å’Œ%dä¸ªå‡å°‘çº¿ç¨‹ç»“æŸå%nç›–ä¼¦çš„è¡€é‡æ˜¯ %.0f%n&quot;</span>, n, n, gareen.hp);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">10000</span>ä¸ªå¢åŠ çº¿ç¨‹å’Œ<span class="hljs-number">10000</span>ä¸ªå‡å°‘çº¿ç¨‹ç»“æŸå<br>ç›–ä¼¦çš„è¡€é‡æ˜¯ <span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure><h2 id="ä¸ƒã€åœ¨æ–¹æ³•å‰ï¼ŒåŠ ä¸Šä¿®é¥°ç¬¦-synchronized"><a href="#ä¸ƒã€åœ¨æ–¹æ³•å‰ï¼ŒåŠ ä¸Šä¿®é¥°ç¬¦-synchronized" class="headerlink" title="ä¸ƒã€åœ¨æ–¹æ³•å‰ï¼ŒåŠ ä¸Šä¿®é¥°ç¬¦ synchronized"></a>ä¸ƒã€åœ¨æ–¹æ³•å‰ï¼ŒåŠ ä¸Šä¿®é¥°ç¬¦ synchronized</h2><p>åœ¨ recover å‰ï¼Œç›´æ¥åŠ ä¸Š synchronized ï¼Œå…¶æ‰€å¯¹åº”çš„åŒæ­¥å¯¹è±¡ï¼Œå°±æ˜¯ thisï¼Œå’Œ hurt æ–¹æ³•è¾¾åˆ°çš„æ•ˆæœæ˜¯ä¸€æ ·ï¼Œå¤–éƒ¨çº¿ç¨‹è®¿é—® gareen çš„æ–¹æ³•ï¼Œå°±ä¸éœ€è¦é¢å¤–ä½¿ç”¨ synchronized äº†ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br><br>    <span class="hljs-comment">//...</span><br>  <br>  <br>    <span class="hljs-comment">//å›è¡€</span><br>    <span class="hljs-comment">//ç›´æ¥åœ¨æ–¹æ³•å‰åŠ ä¸Šä¿®é¥°ç¬¦ synchronized</span><br>    <span class="hljs-comment">//å…¶æ‰€å¯¹åº”çš„åŒæ­¥å¯¹è±¡ï¼Œå°±æ˜¯ this</span><br>    <span class="hljs-comment">//å’Œ hurt æ–¹æ³•è¾¾åˆ°çš„æ•ˆæœä¸€æ ·</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recover</span><span class="hljs-params">()</span>&#123;<br>        hp=hp+<span class="hljs-number">1</span>;<br>    &#125;<br>     <br>    <span class="hljs-comment">//æ‰è¡€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hurt</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//ä½¿ç”¨ this ä½œä¸ºåŒæ­¥å¯¹è±¡</span><br>        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>            hp=hp-<span class="hljs-number">1</span>;   <br>        &#125;<br>    &#125;<br>     <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬é€šè¿‡æ¼”ç¤ºå¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œåˆ†æäº§ç”Ÿçš„åŸå› ï¼Œè§£å†³æ€è·¯ï¼Œæœ€åå¼•å‡º synchronized ä¿®é¥°ç¬¦ï¼Œå¹¶é€šè¿‡ synchronized ä¿®é¥°ç¬¦è§£å†³äº†åŒæ­¥é—®é¢˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—ï¼ˆä¸‰åä¹ï¼‰</title>
    <link href="/2022/09/12/A39-%E5%89%91%E6%8C%87%20Offer%2009.%20%E7%94%A8%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97%EF%BC%88%E4%B8%89%E5%8D%81%E4%B9%9D%EF%BC%89/"/>
    <url>/2022/09/12/A39-%E5%89%91%E6%8C%87%20Offer%2009.%20%E7%94%A8%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97%EF%BC%88%E4%B8%89%E5%8D%81%E4%B9%9D%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof/">å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ ˆã€ã€ã€Œé˜Ÿåˆ—ã€</p><p>ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•° appendTail å’Œ deleteHead ï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°çš„åŠŸèƒ½ã€‚(è‹¥é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼ŒdeleteHead æ“ä½œè¿”å› -1 )</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼š<br>[<span class="hljs-string">&quot;CQueue&quot;</span>,<span class="hljs-string">&quot;appendTail&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>]<br>[[],[<span class="hljs-number">3</span>],[],[],[]]<br>è¾“å‡ºï¼š[<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼š<br>[<span class="hljs-string">&quot;CQueue&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>,<span class="hljs-string">&quot;appendTail&quot;</span>,<span class="hljs-string">&quot;appendTail&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>,<span class="hljs-string">&quot;deleteHead&quot;</span>]<br>[[],[],[<span class="hljs-number">5</span>],[<span class="hljs-number">2</span>],[],[]]<br>è¾“å‡ºï¼š[<span class="hljs-literal">null</span>,-<span class="hljs-number">1</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€1 &lt;&#x3D; values &lt;&#x3D; 10000</p><p>2ã€æœ€å¤šä¼šå¯¹ appendTailã€deleteHead è¿›è¡Œ 10000 æ¬¡è°ƒç”¨</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>å°†ä¸€ä¸ªæ ˆå½“ä½œè¾“å…¥æ ˆï¼Œç”¨äºå‹å…¥ appendTail ä¼ å…¥çš„æ•°æ®ï¼›å¦ä¸€ä¸ªæ ˆå½“ä½œè¾“å‡ºæ ˆï¼Œç”¨äº deleteHead æ“ä½œã€‚</p><p>æ¯æ¬¡ deleteHead æ—¶ï¼Œè‹¥è¾“å‡ºæ ˆä¸ºç©ºåˆ™å°†è¾“å…¥æ ˆçš„å…¨éƒ¨æ•°æ®ä¾æ¬¡å¼¹å‡ºå¹¶å‹å…¥è¾“å‡ºæ ˆï¼Œè¿™æ ·è¾“å‡ºæ ˆä»æ ˆé¡¶å¾€æ ˆåº•çš„é¡ºåºå°±æ˜¯é˜Ÿåˆ—ä»é˜Ÿé¦–å¾€é˜Ÿå°¾çš„é¡ºåºã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CQueue</span> &#123;<br>    Deque&lt;Integer&gt; inStack;<br>    Deque&lt;Integer&gt; outStack;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CQueue</span><span class="hljs-params">()</span> &#123;<br>        inStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayDeque</span>&lt;Integer&gt;();<br>        outStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayDeque</span>&lt;Integer&gt;();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendTail</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> &#123;<br>        inStack.push(value);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">deleteHead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (outStack.isEmpty()) &#123;<br>            <span class="hljs-keyword">if</span> (inStack.isEmpty()) &#123;<br>                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>            &#125;<br>            in2out();<br>        &#125;<br>        <span class="hljs-keyword">return</span> outStack.pop();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">in2out</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">while</span> (!inStack.isEmpty()) &#123;<br>            outStack.push(inStack.pop());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šappendTail ä¸º O(1)ï¼ŒdeleteHead ä¸ºå‡æ‘Š O(1)ã€‚å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œè‡³å¤šå…¥æ ˆå’Œå‡ºæ ˆå„ä¸¤æ¬¡ï¼Œæ•…å‡æ‘Šå¤æ‚åº¦ä¸º O(1)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚å…¶ä¸­ n æ˜¯æ“ä½œæ€»æ•°ã€‚å¯¹äºæœ‰ n æ¬¡ appendTail æ“ä½œçš„æƒ…å†µï¼Œé˜Ÿåˆ—ä¸­ä¼šæœ‰ n ä¸ªå…ƒç´ ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒæ ˆï¼šä¸€ä¸ªè¾“å…¥æ ˆï¼Œä¸€ä¸ªè¾“å‡ºæ ˆï¼Œç»è¿‡ä¸¤æ¬¡æ ˆæ“ä½œï¼Œä»–å°±å˜æˆäº†ä¸€ä¸ªé˜Ÿåˆ—ã€‚</p><blockquote><p>1ã€æ ˆç‰¹ç‚¹ï¼šå…ƒç´ å…ˆè¿›åå‡º</p><p>2ã€é˜Ÿåˆ—ç‰¹ç‚¹ï¼šå…ƒç´ å…ˆè¿›å…ˆå‡º</p></blockquote><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§çº¿ç¨‹çš„æ–¹æ³•ï¼ˆäºŒï¼‰</title>
    <link href="/2022/09/11/thread2/"/>
    <url>/2022/09/11/thread2/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€æš‚åœå½“å‰çº¿ç¨‹ï¼šsleep"><a href="#ä¸€ã€æš‚åœå½“å‰çº¿ç¨‹ï¼šsleep" class="headerlink" title="ä¸€ã€æš‚åœå½“å‰çº¿ç¨‹ï¼šsleep"></a>ä¸€ã€æš‚åœå½“å‰çº¿ç¨‹ï¼šsleep</h2><p>1ï¼‰ã€Thread.sleep(1000) ï¼šè¡¨ç¤ºå½“å‰çº¿ç¨‹æš‚åœ 1000 æ¯«ç§’ï¼Œå…¶ä»–çº¿ç¨‹ä¸å—å½±å“</p><p>2ï¼‰ã€Thread.sleep(1000) ä¼šæŠ›å‡º InterruptedException ä¸­æ–­å¼‚å¸¸ï¼Œå› ä¸ºå½“å‰çº¿ç¨‹ sleep çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è¢«åœæ­¢ï¼Œè¿™æ—¶å°±ä¼šæŠ›å‡º InterruptedException</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">seconds</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">1000</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                    System.out.printf(<span class="hljs-string">&quot;å·²ç»å®Œäº† LOL %d ç§’%n&quot;</span>,seconds++);<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t1.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å·²ç»å®Œäº† LOL <span class="hljs-number">1</span> ç§’<br>å·²ç»å®Œäº† LOL <span class="hljs-number">2</span> ç§’<br>å·²ç»å®Œäº† LOL <span class="hljs-number">3</span> ç§’<br>å·²ç»å®Œäº† LOL <span class="hljs-number">4</span> ç§’<br>å·²ç»å®Œäº† LOL <span class="hljs-number">5</span> ç§’<br>...<br>...<br></code></pre></td></tr></table></figure><h2 id="äºŒã€åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼šjoin"><a href="#äºŒã€åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼šjoin" class="headerlink" title="äºŒã€åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼šjoin"></a>äºŒã€åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼šjoin</h2><p>1ï¼‰ã€é¦–å…ˆè§£é‡Šä¸€ä¸‹ä¸»çº¿ç¨‹çš„æ¦‚å¿µï¼šæ‰€æœ‰è¿›ç¨‹ï¼Œè‡³å°‘ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å³ä¸»çº¿ç¨‹ï¼Œå³ main æ–¹æ³•å¼€å§‹æ‰§è¡Œæ—¶ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªçœ‹ä¸è§çš„ä¸»çº¿ç¨‹å­˜åœ¨ã€‚</p><p>2ï¼‰ã€t.joinï¼ˆThread å¯¹è±¡ï¼‰ï¼šè¡¨ç¤ºåœ¨ä¸»çº¿ç¨‹ä¸­åŠ å…¥è¯¥çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä¼šç­‰è¯¥çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šç»§ç»­å¾€ä¸‹è¿è¡Œ</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰è‹±é›„çš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> hp;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//ä¸ºäº†è¡¨ç¤ºæ”»å‡»éœ€è¦æ—¶é—´ï¼Œæ¯æ¬¡æ”»å‡»æš‚åœ1000æ¯«ç§’</span><br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        h.hp-=damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>,name,h.name,h.name,h.hp);<br><br>        <span class="hljs-keyword">if</span>(h.isDead())<br>            System.out.println(h.name +<span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&gt;=hp?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        Thread t1= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!teemo.isDead())&#123;<br>                    gareen.attackHero(teemo);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        t1.start();<br><br>        <span class="hljs-comment">//ä»£ç æ‰§è¡Œåˆ°è¿™é‡Œï¼Œä¸€ç›´æ˜¯mainçº¿ç¨‹åœ¨è¿è¡Œ</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//t1çº¿ç¨‹åŠ å…¥åˆ°mainçº¿ç¨‹ä¸­æ¥ï¼Œåªæœ‰t1çº¿ç¨‹è¿è¡Œç»“æŸï¼Œæ‰ä¼šç»§ç»­å¾€ä¸‹èµ°</span><br>            t1.join();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        Thread t2= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!leesin.isDead())&#123;<br>                    bh.attackHero(leesin);<br>                &#125;<br>            &#125;<br>        &#125;;<br>        <span class="hljs-comment">//ä¼šè§‚å¯Ÿåˆ°ç›–ä¼¦æŠŠæè«æ€æ‰åï¼Œæ‰è¿è¡Œt2çº¿ç¨‹</span><br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">250</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">200</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">150</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">100</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">50</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>æè«æ­»äº†ï¼<br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">390</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">325</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">260</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">195</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">130</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">65</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>ç›²åƒ§æ­»äº†ï¼<br></code></pre></td></tr></table></figure><p>æ ¹æ®æ‰“å°ç»“æœå¯çŸ¥ä¸»çº¿ç¨‹å…ˆæ˜¯ç­‰ t1 æ‰§è¡Œå®Œåï¼Œåœ¨æ‰§è¡Œ t2</p><h2 id="ä¸‰ã€çº¿ç¨‹ä¼˜å…ˆçº§ï¼šsetPriority"><a href="#ä¸‰ã€çº¿ç¨‹ä¼˜å…ˆçº§ï¼šsetPriority" class="headerlink" title="ä¸‰ã€çº¿ç¨‹ä¼˜å…ˆçº§ï¼šsetPriority"></a>ä¸‰ã€çº¿ç¨‹ä¼˜å…ˆçº§ï¼šsetPriority</h2><p>1ï¼‰ã€å½“çº¿ç¨‹å¤„äºç«äº‰å…³ç³»çš„æ—¶å€™ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹ä¼šæœ‰æ›´å¤§çš„å‡ ç‡è·å¾—CPUèµ„æº</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        Thread t1= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!teemo.isDead())&#123;<br>                    gareen.attackHero(teemo);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br><br><br>        Thread t2= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!leesin.isDead())&#123;<br>                    bh.attackHero(leesin);<br>                &#125;<br>            &#125;<br>        &#125;;<br><span class="hljs-comment">//è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§</span><br>        t1.setPriority(Thread.MAX_PRIORITY);<br>        t2.setPriority(Thread.MIN_PRIORITY);<br>        t1.start();<br>        t2.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€ä¸´æ—¶æš‚åœï¼šyield"><a href="#å››ã€ä¸´æ—¶æš‚åœï¼šyield" class="headerlink" title="å››ã€ä¸´æ—¶æš‚åœï¼šyield"></a>å››ã€ä¸´æ—¶æš‚åœï¼šyield</h2><p>1ï¼‰ã€å½“å‰çº¿ç¨‹ä¸´æ—¶æš‚åœï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹å¯ä»¥æœ‰æ›´å¤šçš„æœºä¼šå ç”¨ CPU èµ„æº</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        Thread t1= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><br>                <span class="hljs-keyword">while</span>(!teemo.isDead())&#123;<br>                    gareen.attackHero(teemo);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        Thread t2= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!leesin.isDead())&#123;<br>                    <span class="hljs-comment">//ä¸´æ—¶æš‚åœï¼Œä½¿å¾—t1å¯ä»¥å ç”¨CPUèµ„æº</span><br>                    Thread.yield();<br><br>                    bh.attackHero(leesin);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        t1.setPriority(<span class="hljs-number">5</span>);<br>        t2.setPriority(<span class="hljs-number">5</span>);<br>        t1.start();<br>        t2.start();<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”ã€å®ˆæŠ¤çº¿ç¨‹"><a href="#äº”ã€å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="äº”ã€å®ˆæŠ¤çº¿ç¨‹"></a>äº”ã€å®ˆæŠ¤çº¿ç¨‹</h2><p>ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœä¸€å®¶å…¬å¸é”€å”®éƒ¨ï¼Œç”Ÿäº§éƒ¨éƒ½è§£æ•£äº†ï¼Œåªå‰©ä¸‹åå‹¤ï¼Œé‚£ä¹ˆè¿™å®¶å…¬å¸ä¹Ÿå¯ä»¥è§£æ•£äº†</p><p>1ï¼‰ã€å®ˆæŠ¤çº¿ç¨‹å°±ç›¸å½“äºå…¬å¸çš„åå‹¤éƒ¨é—¨ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹åªå‰©ä¸‹å®ˆæŠ¤çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿›ç¨‹å°±ä¼šè‡ªåŠ¨ç»“æŸã€‚</p><p>2ï¼‰ã€å®ˆæŠ¤çº¿ç¨‹é€šå¸¸ä¼šè¢«ç”¨æ¥åšæ—¥å¿—ï¼Œæ€§èƒ½ç»Ÿè®¡ç­‰å·¥ä½œã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestThread</span> &#123;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>          <br>        Thread t1= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">seconds</span> <span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br>                 <br>                <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        Thread.sleep(<span class="hljs-number">1000</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                    System.out.printf(<span class="hljs-string">&quot;å·²ç»ç©äº†LOL %d ç§’%n&quot;</span>, seconds++);<br>                     <br>                &#125;              <br>            &#125;<br>        &#125;;<br>      <span class="hljs-comment">//å°† t1 è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</span><br>        t1.setDaemon(<span class="hljs-literal">true</span>);<br>        t1.start();<br>          <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬æŠŠ t1 è®¾ç½®ä¸ºäº†å®ˆæŠ¤çº¿ç¨‹ï¼Œé‚£ä¹ˆè¯¥ç¨‹åºä¼šå› ä¸ºåªå‰©ä¸‹å®ˆæŠ¤çº¿ç¨‹è€Œè‡ªåŠ¨ç»“æŸæ‰</p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†çº¿ç¨‹å¸¸ç”¨çš„ä¸€äº›æ–¹æ³•ï¼š</p><p>1ã€sleep ï¼šå½“å‰çº¿ç¨‹æš‚åœ</p><p>2ã€join ï¼šåŠ å…¥å½“å‰çº¿ç¨‹</p><p>3ã€setPriority ï¼šè®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§</p><p>4ã€yield ï¼šå½“å‰çº¿ç¨‹ä¸´æ—¶æš‚åœ</p><p>5ã€setDaemon ï¼šè®¾ç½®å®ˆæŠ¤çº¿ç¨‹</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 50. ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ï¼ˆä¸‰åå…«ï¼‰</title>
    <link href="/2022/09/11/A38-%E5%89%91%E6%8C%87%20Offer%2050.%20%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E5%AD%97%E7%AC%A6%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AB%EF%BC%89/"/>
    <url>/2022/09/11/A38-%E5%89%91%E6%8C%87%20Offer%2050.%20%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E5%AD%97%E7%AC%A6%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AB%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/di-yi-ge-zhi-chu-xian-yi-ci-de-zi-fu-lcof/">å‰‘æŒ‡ Offer 50. ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œå­—ç¬¦ä¸²ã€</p><p>åœ¨å­—ç¬¦ä¸² s ä¸­æ‰¾å‡ºç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿”å›ä¸€ä¸ªå•ç©ºæ ¼ã€‚ s åªåŒ…å«å°å†™å­—æ¯ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;abaccdeff&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&#x27;b&#x27;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;&quot;</span> <br>è¾“å‡ºï¼š<span class="hljs-string">&#x27; &#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; s çš„é•¿åº¦ &lt;&#x3D; 50000</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æˆ‘ä»¬å¯ä»¥å¯¹æ–¹æ³•ä¸€è¿›è¡Œä¿®æ”¹ï¼Œä½¿å¾—ç¬¬äºŒæ¬¡éå†çš„å¯¹è±¡ä»å­—ç¬¦ä¸²å˜ä¸ºå“ˆå¸Œæ˜ å°„ã€‚</p><p>å…·ä½“åœ°ï¼Œå¯¹äºå“ˆå¸Œæ˜ å°„ä¸­çš„æ¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œé”®è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå€¼è¡¨ç¤ºå®ƒçš„é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼ˆå¦‚æœè¯¥å­—ç¬¦åªå‡ºç°ä¸€æ¬¡ï¼‰æˆ–è€… âˆ’1ï¼ˆå¦‚æœè¯¥å­—ç¬¦å‡ºç°å¤šæ¬¡ï¼‰ã€‚å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡éå†å­—ç¬¦ä¸²æ—¶ï¼Œè®¾å½“å‰éå†åˆ°çš„å­—ç¬¦ä¸º cï¼Œå¦‚æœ c ä¸åœ¨å“ˆå¸Œæ˜ å°„ä¸­ï¼Œæˆ‘ä»¬å°±å°† c ä¸å®ƒçš„ç´¢å¼•ä½œä¸ºä¸€ä¸ªé”®å€¼å¯¹åŠ å…¥å“ˆå¸Œæ˜ å°„ä¸­ï¼Œå¦åˆ™æˆ‘ä»¬å°† c åœ¨å“ˆå¸Œæ˜ å°„ä¸­å¯¹åº”çš„å€¼ä¿®æ”¹ä¸º âˆ’1ã€‚</p><p>åœ¨ç¬¬ä¸€æ¬¡éå†ç»“æŸåï¼Œæˆ‘ä»¬åªéœ€è¦å†éå†ä¸€æ¬¡å“ˆå¸Œæ˜ å°„ä¸­çš„æ‰€æœ‰å€¼ï¼Œæ‰¾å‡ºå…¶ä¸­ä¸ä¸º âˆ’1 çš„æœ€å°å€¼ï¼Œå³ä¸ºç¬¬ä¸€ä¸ªä¸é‡å¤å­—ç¬¦çš„ç´¢å¼•ï¼Œç„¶åè¿”å›è¯¥ç´¢å¼•å¯¹åº”çš„å­—ç¬¦ã€‚å¦‚æœå“ˆå¸Œæ˜ å°„ä¸­çš„æ‰€æœ‰å€¼å‡ä¸º âˆ’1ï¼Œæˆ‘ä»¬å°±è¿”å›ç©ºæ ¼ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">char</span> <span class="hljs-title function_">firstUniqChar</span><span class="hljs-params">(String s)</span> &#123;<br>        Map&lt;Character, Integer&gt; position = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Character, Integer&gt;();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> s.length();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> s.charAt(i);<br>            <span class="hljs-keyword">if</span> (position.containsKey(ch)) &#123;<br>                position.put(ch, -<span class="hljs-number">1</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                position.put(ch, i);<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> n;<br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;Character, Integer&gt; entry : position.entrySet()) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> entry.getValue();<br>            <span class="hljs-keyword">if</span> (pos != -<span class="hljs-number">1</span> &amp;&amp; pos &lt; first) &#123;<br>                first = pos;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> first == n ? <span class="hljs-string">&#x27; &#x27;</span> : s.charAt(first);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚ä¸¤æ¬¡ for å¾ªç¯ç›¸åŠ ä¸º 2nï¼Œå¿½ç•¥å¸¸æ•°é¡¹ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚å“ˆå¸Œè¡¨ä¸­å­˜æ”¾çš„æ•°æ®ï¼Œé•¿åº¦ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦ n</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œä½¿ç”¨å“ˆå¸Œè¡¨å­˜æ”¾å‡ºç°å…ƒç´ çš„ç´¢å¼•è¿›è¡Œäº†å¿«é€Ÿæ±‚æ•‘ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥å­˜æ”¾å…ƒç´ å‡ºç°çš„é¢‘æ¬¡ï¼Œæ€è·¯å·®ä¸å¤šã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¸€ï¼‰</title>
    <link href="/2022/09/10/thread1/"/>
    <url>/2022/09/10/thread1/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€çº¿ç¨‹çš„æ¦‚å¿µ"><a href="#ä¸€ã€çº¿ç¨‹çš„æ¦‚å¿µ" class="headerlink" title="ä¸€ã€çº¿ç¨‹çš„æ¦‚å¿µ"></a>ä¸€ã€çº¿ç¨‹çš„æ¦‚å¿µ</h2><p>é¦–å…ˆè¦ç†è§£è¿›ç¨‹ï¼ˆProcessorï¼‰å’Œçº¿ç¨‹ï¼ˆThreadï¼‰çš„åŒºåˆ«ï¼š</p><p>1ã€è¿›ç¨‹ï¼šå¯åŠ¨ä¸€ä¸ª LOL.exe å°±å«ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¥ç€åˆå¯åŠ¨ä¸€ä¸ª DOTA.exeï¼Œè¿™å«ä¸¤ä¸ªè¿›ç¨‹ã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿæ‰§è¡Œçš„æœ€å°å•ä½</p><p>2ã€çº¿ç¨‹ï¼šçº¿ç¨‹æ˜¯åœ¨ä½ è¿›ç¨‹å†…éƒ¨åŒæ—¶åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚åœ¨ LOL é‡Œé¢ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…åœ¨åŒæ—¶å‘ç”Ÿï¼Œå¦‚ï¼šç›–ä¼¦å‡»æ€æè«çš„åŒæ—¶ï¼Œèµé‡‘çŒäººåœ¨å‡»æ€ç›²åƒ§ï¼Œè¿™ç§å°±æ˜¯ç”±å¤šçº¿ç¨‹å®ç°çš„ã€‚çº¿ç¨‹æ˜¯ CPU æ‰§è¡Œçš„æœ€å°å•ä½</p><p>æ­¤å¤„æ¼”ç¤ºä¸ä½¿ç”¨å¤šçº¿ç¨‹çš„æƒ…å†µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€åˆ›å»ºä¸€ä¸ªè‹±é›„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hero</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> hp;<br>     <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> damage;<br>     <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attackHero</span><span class="hljs-params">(Hero h)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//ä¸ºäº†è¡¨ç¤ºæ”»å‡»éœ€è¦æ—¶é—´ï¼Œæ¯æ¬¡æ”»å‡»æš‚åœ1000æ¯«ç§’</span><br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        h.hp-=damage;<br>        System.out.format(<span class="hljs-string">&quot;%s æ­£åœ¨æ”»å‡» %s, %sçš„è¡€å˜æˆäº† %.0f%n&quot;</span>,name,h.name,h.name,h.hp);<br>         <br>        <span class="hljs-keyword">if</span>(h.isDead())<br>            System.out.println(h.name +<span class="hljs-string">&quot;æ­»äº†ï¼&quot;</span>);<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDead</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&gt;=hp?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br> <br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        <span class="hljs-comment">//ç›–ä¼¦æ”»å‡»æè«</span><br>        <span class="hljs-keyword">while</span>(!teemo.isDead())&#123;<br>            gareen.attackHero(teemo);<br>        &#125;<br><br>        <span class="hljs-comment">//èµé‡‘çŒäººæ”»å‡»ç›²åƒ§</span><br>        <span class="hljs-keyword">while</span>(!leesin.isDead())&#123;<br>            bh.attackHero(leesin);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">250</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">200</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">150</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">100</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">50</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>æè«æ­»äº†ï¼<br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">390</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">325</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">260</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">195</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">130</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">65</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>ç›²åƒ§æ­»äº†ï¼<br></code></pre></td></tr></table></figure><p>æ ¹æ®æ‰“å°ç»“æœå¯çŸ¥ä»£ç æ˜¯ä»ä¸Šå¾€ä¸‹æŒ‰é¡ºåºæ‰§è¡Œçš„ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å®ç°å®ƒ</p><h2 id="äºŒã€åˆ›å»ºå¤šçº¿ç¨‹-ç»§æ‰¿çº¿ç¨‹ç±»"><a href="#äºŒã€åˆ›å»ºå¤šçº¿ç¨‹-ç»§æ‰¿çº¿ç¨‹ç±»" class="headerlink" title="äºŒã€åˆ›å»ºå¤šçº¿ç¨‹-ç»§æ‰¿çº¿ç¨‹ç±»"></a>äºŒã€åˆ›å»ºå¤šçº¿ç¨‹-ç»§æ‰¿çº¿ç¨‹ç±»</h2><p>ä½¿ç”¨å¤šçº¿ç¨‹å®ç°ï¼šç›–ä¼¦å‡»æ€æè«çš„åŒæ—¶ï¼Œèµé‡‘çŒäººåœ¨å‡»æ€ç›²åƒ§ã€‚</p><p>1ã€è®¾è®¡ä¸€ä¸ª KillThread ç±»ç»§æ‰¿ Thread ç±»ï¼Œå¹¶ä¸”é‡å†™ run æ–¹æ³•</p><p>2ã€å¯åŠ¨çº¿ç¨‹æ–¹æ³•ï¼šå®ä¾‹åŒ–ä¸€ä¸ª KillThread å¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨å…¶ start æ–¹æ³•</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€è®¾è®¡ä¸€ä¸ª KillThread ç±»ç»§æ‰¿ Thread ç±»ï¼Œå¹¶ä¸”é‡å†™ run æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">KillThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span>&#123;<br>     <br>    <span class="hljs-keyword">private</span> Hero h1;<br>    <span class="hljs-keyword">private</span> Hero h2;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">KillThread</span><span class="hljs-params">(Hero h1, Hero h2)</span>&#123;<br>        <span class="hljs-built_in">this</span>.h1 = h1;<br>        <span class="hljs-built_in">this</span>.h2 = h2;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">while</span>(!h2.isDead())&#123;<br>            h1.attackHero(h2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        <span class="hljs-type">KillThread</span> <span class="hljs-variable">killThread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KillThread</span>(gareen,teemo);<br>        killThread1.start();<br>        <span class="hljs-type">KillThread</span> <span class="hljs-variable">killThread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KillThread</span>(bh,leesin);<br>        killThread2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">250</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">390</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">325</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">200</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">260</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">150</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">195</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">100</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">130</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">50</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">65</span><br>æè«æ­»äº†ï¼<br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>ç›²åƒ§æ­»äº†ï¼<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç°åœ¨æ˜¯äº¤æ›¿æ‰“å°ï¼Œè¯æ˜æ˜¯å¤šçº¿ç¨‹</p><h2 id="ä¸‰ã€åˆ›å»ºå¤šçº¿ç¨‹-å®ç°-Runnable-æ¥å£"><a href="#ä¸‰ã€åˆ›å»ºå¤šçº¿ç¨‹-å®ç°-Runnable-æ¥å£" class="headerlink" title="ä¸‰ã€åˆ›å»ºå¤šçº¿ç¨‹-å®ç° Runnable æ¥å£"></a>ä¸‰ã€åˆ›å»ºå¤šçº¿ç¨‹-å®ç° Runnable æ¥å£</h2><p>1ã€åˆ›å»º Battle ç±»å®ç° Runnable æ¥å£ï¼Œå¯åŠ¨çš„æ—¶å€™ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª Battle å¯¹è±¡ï¼Œç„¶ååœ¨æ ¹æ®è¯¥ Battle å¯¹è±¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡å¹¶å¯åŠ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Battle</span> <span class="hljs-variable">battle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Battle</span>(gareen,teemo);<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(battle).start();<br></code></pre></td></tr></table></figure><p>2ã€battle å¯¹è±¡å®ç°äº† Runnable æ¥å£ï¼Œæ‰€ä»¥æœ‰ run æ–¹æ³•ï¼Œä½†æ˜¯ç›´æ¥è°ƒç”¨ run æ–¹æ³•ï¼Œå¹¶ä¸ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œå¿…é¡»å€ŸåŠ©ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡çš„ start æ–¹æ³•ï¼Œæ‰ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹</p><p>3ã€æ‰€ä»¥åœ¨åˆ›å»º Thread å¯¹è±¡çš„æ—¶å€™ï¼ŒæŠŠ battle ä½œä¸ºæ„é€ æ–¹æ³•çš„å‚æ•°ä¼ é€’è¿›å»ï¼Œè¿™ä¸ªçº¿ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šå»æ‰§è¡Œ battle.run æ–¹æ³•</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰ Battle ç±»ï¼Œå®ç°äº† Runnable æ¥å£ï¼Œé‡å†™äº† run æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Battle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>     <br>    <span class="hljs-keyword">private</span> Hero h1;<br>    <span class="hljs-keyword">private</span> Hero h2;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Battle</span><span class="hljs-params">(Hero h1, Hero h2)</span>&#123;<br>        <span class="hljs-built_in">this</span>.h1 = h1;<br>        <span class="hljs-built_in">this</span>.h2 = h2;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">while</span>(!h2.isDead())&#123;<br>            h1.attackHero(h2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        <span class="hljs-type">Battle</span> <span class="hljs-variable">battle1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Battle</span>(gareen,teemo);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(battle1).start();<br><br>        <span class="hljs-type">Battle</span> <span class="hljs-variable">battle2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Battle</span>(bh,leesin);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(battle2).start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">250</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">390</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">200</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">325</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">150</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">260</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">100</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">195</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">130</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">50</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">65</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>æè«æ­»äº†ï¼<br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>ç›²åƒ§æ­»äº†ï¼<br></code></pre></td></tr></table></figure><h2 id="å››ã€åˆ›å»ºå¤šçº¿ç¨‹-åŒ¿åå†…éƒ¨ç±»"><a href="#å››ã€åˆ›å»ºå¤šçº¿ç¨‹-åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="å››ã€åˆ›å»ºå¤šçº¿ç¨‹-åŒ¿åå†…éƒ¨ç±»"></a>å››ã€åˆ›å»ºå¤šçº¿ç¨‹-åŒ¿åå†…éƒ¨ç±»</h2><p>ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ï¼Œç»§æ‰¿ Thread ï¼Œé‡å†™ run æ–¹æ³•ï¼Œç›´æ¥åœ¨ run æ–¹æ³•ä¸­å†™ä¸šåŠ¡ä»£ç ï¼ŒåŒ¿åå†…éƒ¨ç±»çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¿é—®å¤–éƒ¨çš„å±€éƒ¨å˜é‡ã€‚å‰ææ˜¯å¤–éƒ¨çš„å±€éƒ¨å˜é‡éœ€è¦è¢«å£°æ˜ä¸º finalï¼ˆJDK 1.7 ä»¥åå°±ä¸éœ€è¦äº†ï¼‰</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">gareen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        gareen.name = <span class="hljs-string">&quot;ç›–ä¼¦&quot;</span>;<br>        gareen.hp = <span class="hljs-number">616</span>;<br>        gareen.damage = <span class="hljs-number">50</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">teemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        teemo.name = <span class="hljs-string">&quot;æè«&quot;</span>;<br>        teemo.hp = <span class="hljs-number">300</span>;<br>        teemo.damage = <span class="hljs-number">30</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">bh</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        bh.name = <span class="hljs-string">&quot;èµé‡‘çŒäºº&quot;</span>;<br>        bh.hp = <span class="hljs-number">500</span>;<br>        bh.damage = <span class="hljs-number">65</span>;<br><br>        <span class="hljs-type">Hero</span> <span class="hljs-variable">leesin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();<br>        leesin.name = <span class="hljs-string">&quot;ç›²åƒ§&quot;</span>;<br>        leesin.hp = <span class="hljs-number">455</span>;<br>        leesin.damage = <span class="hljs-number">80</span>;<br><br>        <span class="hljs-comment">//åŒ¿åç±»</span><br>        Thread t1= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-comment">//åŒ¿åç±»ä¸­ç”¨åˆ°å¤–éƒ¨çš„å±€éƒ¨å˜é‡teemoï¼Œå¿…é¡»æŠŠteemoå£°æ˜ä¸ºfinal</span><br>                <span class="hljs-comment">//ä½†æ˜¯åœ¨JDK7ä»¥åï¼Œå°±ä¸æ˜¯å¿…é¡»åŠ finalçš„äº†</span><br>                <span class="hljs-keyword">while</span>(!teemo.isDead())&#123;<br>                    gareen.attackHero(teemo);<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        t1.start();<br><br>        Thread t2= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>                <span class="hljs-keyword">while</span>(!leesin.isDead())&#123;<br>                    bh.attackHero(leesin);<br>                &#125;<br>            &#125;<br>        &#125;;<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">250</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">390</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">200</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">325</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">150</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">260</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">195</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">100</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">130</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">50</span><br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">65</span><br>ç›–ä¼¦ æ­£åœ¨æ”»å‡» æè«, æè«çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>æè«æ­»äº†ï¼<br>èµé‡‘çŒäºº æ­£åœ¨æ”»å‡» ç›²åƒ§, ç›²åƒ§çš„è¡€å˜æˆäº† <span class="hljs-number">0</span><br>ç›²åƒ§æ­»äº†ï¼<br></code></pre></td></tr></table></figure><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ä¸‰ç§å¯åŠ¨çº¿ç¨‹çš„æ–¹å¼ï¼š</p><p>1ã€ç»§æ‰¿ Thread ç±»</p><p>2ã€å®ç° Runnable æ¥å£</p><p>3ã€åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼</p><p><strong>æ³¨æ„ï¼š</strong> å¯åŠ¨çº¿ç¨‹æ˜¯ start æ–¹æ³•ï¼Œrun æ–¹æ³•å¹¶ä¸èƒ½å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>å¤šçº¿ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Java</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 29. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µï¼ˆä¸‰åä¸ƒï¼‰</title>
    <link href="/2022/09/10/A37-%E5%89%91%E6%8C%87%20Offer%2029.%20%E9%A1%BA%E6%97%B6%E9%92%88%E6%89%93%E5%8D%B0%E7%9F%A9%E9%98%B5%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%83%EF%BC%89/"/>
    <url>/2022/09/10/A37-%E5%89%91%E6%8C%87%20Offer%2029.%20%E9%A1%BA%E6%97%B6%E9%92%88%E6%89%93%E5%8D%B0%E7%9F%A9%E9%98%B5%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%83%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/shun-shi-zhen-da-yin-ju-zhen-lcof/">å‰‘æŒ‡ Offer 29. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€ŒçŸ©é˜µã€ã€ã€Œæ¨¡æ‹Ÿã€</p><p>è¾“å…¥ä¸€ä¸ªçŸ©é˜µï¼ŒæŒ‰ç…§ä»å¤–å‘é‡Œä»¥é¡ºæ—¶é’ˆçš„é¡ºåºä¾æ¬¡æ‰“å°å‡ºæ¯ä¸€ä¸ªæ•°å­—ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šmatrix = [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]]<br>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šmatrix = [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>],[<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>]]<br>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">8</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; matrix.length &lt;&#x3D; 100</p><p>2ã€0 &lt;&#x3D; matrix[i].length &lt;&#x3D; 100</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>å¯ä»¥å°†çŸ©é˜µçœ‹æˆè‹¥å¹²å±‚ï¼Œé¦–å…ˆæ‰“å°æœ€å¤–å±‚çš„å…ƒç´ ï¼Œå…¶æ¬¡æ‰“å°æ¬¡å¤–å±‚çš„å…ƒç´ ï¼Œç›´åˆ°æ‰“å°æœ€å†…å±‚çš„å…ƒç´ ã€‚</p><p>å®šä¹‰çŸ©é˜µçš„ç¬¬ k å±‚æ˜¯åˆ°æœ€è¿‘è¾¹ç•Œè·ç¦»ä¸º k çš„æ‰€æœ‰é¡¶ç‚¹ã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾çŸ©é˜µæœ€å¤–å±‚å…ƒç´ éƒ½æ˜¯ç¬¬ 1 å±‚ï¼Œæ¬¡å¤–å±‚å…ƒç´ éƒ½æ˜¯ç¬¬ 2 å±‚ï¼Œå‰©ä¸‹çš„å…ƒç´ éƒ½æ˜¯ç¬¬ 3 å±‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">[[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],<br> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],<br> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],<br> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],<br> [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]]<br></code></pre></td></tr></table></figure><p>å¯¹äºæ¯å±‚ï¼Œä»å·¦ä¸Šæ–¹å¼€å§‹ä»¥é¡ºæ—¶é’ˆçš„é¡ºåºéå†æ‰€æœ‰å…ƒç´ ã€‚å‡è®¾å½“å‰å±‚çš„å·¦ä¸Šè§’ä½äº (top,left)ï¼Œå³ä¸‹è§’ä½äº (bottom,right)ï¼ŒæŒ‰ç…§å¦‚ä¸‹é¡ºåºéå†å½“å‰å±‚çš„å…ƒç´ ã€‚</p><blockquote><p>1ã€ä»å·¦åˆ°å³éå†ä¸Šä¾§å…ƒç´ ï¼Œä¾æ¬¡ä¸º (top,left) åˆ° (top,right)ã€‚</p><p>2ã€ä»ä¸Šåˆ°ä¸‹éå†å³ä¾§å…ƒç´ ï¼Œä¾æ¬¡ä¸º (top+1,right) åˆ° (bottom,right)ã€‚</p><p>3ã€å¦‚æœ left&lt;right ä¸” top&lt;bottomï¼Œåˆ™ä»å³åˆ°å·¦éå†ä¸‹ä¾§å…ƒç´ ï¼Œä¾æ¬¡ä¸º (bottom,rightâˆ’1) åˆ° (bottom,left+1)ï¼Œä»¥åŠä»ä¸‹åˆ°ä¸Šéå†å·¦ä¾§å…ƒç´ ï¼Œä¾æ¬¡ä¸º (bottom,left) åˆ° (top+1,left)ã€‚</p></blockquote><p>éå†å®Œå½“å‰å±‚çš„å…ƒç´ ä¹‹åï¼Œå°† left å’Œ top åˆ†åˆ«å¢åŠ  1ï¼Œå°† right å’Œ bottom åˆ†åˆ«å‡å°‘ 1ï¼Œè¿›å…¥ä¸‹ä¸€å±‚ç»§ç»­éå†ï¼Œç›´åˆ°éå†å®Œæ‰€æœ‰å…ƒç´ ä¸ºæ­¢ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] spiralOrder(<span class="hljs-type">int</span>[][] matrix) &#123;<br>        <span class="hljs-keyword">if</span> (matrix == <span class="hljs-literal">null</span> || matrix.length == <span class="hljs-number">0</span> || matrix[<span class="hljs-number">0</span>].length == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">rows</span> <span class="hljs-operator">=</span> matrix.length, columns = matrix[<span class="hljs-number">0</span>].length;<br>        <span class="hljs-type">int</span>[] order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[rows * columns];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = columns - <span class="hljs-number">1</span>, top = <span class="hljs-number">0</span>, bottom = rows - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (left &lt;= right &amp;&amp; top &lt;= bottom) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">column</span> <span class="hljs-operator">=</span> left; column &lt;= right; column++) &#123;<br>                order[index++] = matrix[top][column];<br>            &#125;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">row</span> <span class="hljs-operator">=</span> top + <span class="hljs-number">1</span>; row &lt;= bottom; row++) &#123;<br>                order[index++] = matrix[row][right];<br>            &#125;<br>            <span class="hljs-keyword">if</span> (left &lt; right &amp;&amp; top &lt; bottom) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">column</span> <span class="hljs-operator">=</span> right - <span class="hljs-number">1</span>; column &gt; left; column--) &#123;<br>                    order[index++] = matrix[bottom][column];<br>                &#125;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">row</span> <span class="hljs-operator">=</span> bottom; row &gt; top; row--) &#123;<br>                    order[index++] = matrix[row][left];<br>                &#125;<br>            &#125;<br>            left++;<br>            right--;<br>            top++;<br>            bottom--;<br>        &#125;<br>        <span class="hljs-keyword">return</span> order;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(mn)ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«æ˜¯è¾“å…¥çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ã€‚çŸ©é˜µä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è¦è¢«è®¿é—®ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚é™¤äº†è¾“å‡ºæ•°ç»„ä»¥å¤–ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯å¸¸æ•°ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œè®¾è®¡å¥½ä»å¤–åˆ°é‡Œçš„ä¸€ä¸ªæ‰“å°æ€è·¯å¹¶èƒ½å¿«é€Ÿæ±‚è§£ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 05. æ›¿æ¢ç©ºæ ¼ï¼ˆä¸‰åå…­ï¼‰</title>
    <link href="/2022/09/09/A36-%E5%89%91%E6%8C%87%20Offer%2005.%20%E6%9B%BF%E6%8D%A2%E7%A9%BA%E6%A0%BC%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89/"/>
    <url>/2022/09/09/A36-%E5%89%91%E6%8C%87%20Offer%2005.%20%E6%9B%BF%E6%8D%A2%E7%A9%BA%E6%A0%BC%EF%BC%88%E4%B8%89%E5%8D%81%E5%85%AD%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/ti-huan-kong-ge-lcof/">å‰‘æŒ‡ Offer 05.Â æ›¿æ¢ç©ºæ ¼</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œå­—ç¬¦ä¸²ã€</p><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸² s ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆâ€%20â€ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;We are happy.&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&quot;We%20are%20happy.&quot;</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; s çš„é•¿åº¦ &lt;&#x3D; 10000</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šè¿­ä»£æ›¿æ¢"><a href="#æ³•ä¸€ï¼šè¿­ä»£æ›¿æ¢" class="headerlink" title="æ³•ä¸€ï¼šè¿­ä»£æ›¿æ¢"></a>æ³•ä¸€ï¼šè¿­ä»£æ›¿æ¢</h3><p>ç”±äºæ¯æ¬¡æ›¿æ¢ä» 1 ä¸ªå­—ç¬¦å˜æˆ 3 ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨å­—ç¬¦æ•°ç»„å¯æ–¹ä¾¿åœ°è¿›è¡Œæ›¿æ¢ã€‚å»ºç«‹å­—ç¬¦æ•°ç»„åœ°é•¿åº¦ä¸º s çš„é•¿åº¦çš„ 3 å€ï¼Œè¿™æ ·å¯ä¿è¯å­—ç¬¦æ•°ç»„å¯ä»¥å®¹çº³æ‰€æœ‰æ›¿æ¢åçš„å­—ç¬¦ã€‚</p><blockquote><p>1ã€è·å¾— s çš„é•¿åº¦ length</p><p>2ã€åˆ›å»ºå­—ç¬¦æ•°ç»„ arrayï¼Œå…¶é•¿åº¦ä¸º length * 3</p><p>3ã€åˆå§‹åŒ– size ä¸º 0ï¼Œsize è¡¨ç¤ºæ›¿æ¢åçš„å­—ç¬¦ä¸²çš„é•¿åº¦</p><p>4ã€ä»å·¦åˆ°å³éå†å­—ç¬¦ä¸² s</p><blockquote><p>1ã€è·å¾— s çš„å½“å‰å­—ç¬¦ cï¼Œå¦‚æœå­—ç¬¦ c æ˜¯ç©ºæ ¼ï¼Œåˆ™ä»¤ array[size] &#x3D; â€˜%â€™ï¼Œarray[size + 1] &#x3D; â€˜2â€™ï¼Œarray[size + 2] &#x3D; â€˜0â€™ï¼Œå¹¶å°† size çš„å€¼åŠ  3</p><p>2ã€å¦‚æœå­—ç¬¦ c ä¸æ˜¯ç©ºæ ¼ï¼Œåˆ™ä»¤ array[size] &#x3D; cï¼Œå¹¶å°† size çš„å€¼åŠ  1</p></blockquote><p>5ã€éå†ç»“æŸä¹‹åï¼Œsize çš„å€¼ç­‰äºæ›¿æ¢åçš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä» array çš„å‰ size ä¸ªå­—ç¬¦åˆ›å»ºæ–°å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ–°å­—ç¬¦ä¸²</p></blockquote><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">replaceSpace</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> s.length();<br>        <span class="hljs-type">char</span>[] array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[length * <span class="hljs-number">3</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.charAt(i);<br>            <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27; &#x27;</span>) &#123;<br>                array[size++] = <span class="hljs-string">&#x27;%&#x27;</span>;<br>                array[size++] = <span class="hljs-string">&#x27;2&#x27;</span>;<br>                array[size++] = <span class="hljs-string">&#x27;0&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                array[size++] = c;<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">newStr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(array, <span class="hljs-number">0</span>, size);<br>        <span class="hljs-keyword">return</span> newStr;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚éå†å­—ç¬¦ä¸² s ä¸€éã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é¢å¤–åˆ›å»ºå­—ç¬¦æ•°ç»„ï¼Œé•¿åº¦ä¸º s çš„é•¿åº¦çš„ 3 å€ã€‚</p><h3 id="æ³•äºŒï¼šä½¿ç”¨è¯­è¨€è‡ªå¸¦-Api"><a href="#æ³•äºŒï¼šä½¿ç”¨è¯­è¨€è‡ªå¸¦-Api" class="headerlink" title="æ³•äºŒï¼šä½¿ç”¨è¯­è¨€è‡ªå¸¦ Api"></a>æ³•äºŒï¼šä½¿ç”¨è¯­è¨€è‡ªå¸¦ Api</h3><p>Java ç»™æˆ‘ä»¬æä¾›äº† replaceAll æ–¹æ³•ï¼Œå¯å®Œæˆå¿«é€Ÿæ›¿æ¢</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">replaceSpace</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-keyword">return</span> s.replaceAll(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;%20&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚å†…éƒ¨ä½¿ç”¨äº† do while å¾ªç¯ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚å†…éƒ¨ä½¿ç”¨äº† StringBuffer è¿›è¡Œæ‹¼æ¥æ›¿æ¢ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œç›´æ¥éå†æ›¿æ¢å³å¯ï¼Œä¹Ÿå¯ä½¿ç”¨è¯­è¨€è‡ªå¸¦çš„ Api è¿›è¡Œå¿«é€Ÿæ±‚è§£ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 04. äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ï¼ˆä¸‰åäº”ï¼‰</title>
    <link href="/2022/09/08/A35-%E5%89%91%E6%8C%87%20Offer%2004.%C2%A0%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89/"/>
    <url>/2022/09/08/A35-%E5%89%91%E6%8C%87%20Offer%2004.%C2%A0%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/er-wei-shu-zu-zhong-de-cha-zhao-lcof/">å‰‘æŒ‡ Offer 04.Â äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€</p><p>åœ¨ä¸€ä¸ª n * m çš„äºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³ éé€’å‡ çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ éé€’å‡ çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªé«˜æ•ˆçš„å‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>ç°æœ‰çŸ©é˜µ matrix å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">[<br>  [<span class="hljs-number">1</span>,   <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>],<br>  [<span class="hljs-number">2</span>,   <span class="hljs-number">5</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">19</span>],<br>  [<span class="hljs-number">3</span>,   <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">22</span>],<br>  [<span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">24</span>],<br>  [<span class="hljs-number">18</span>, <span class="hljs-number">21</span>, <span class="hljs-number">23</span>, <span class="hljs-number">26</span>, <span class="hljs-number">30</span>]<br>]<br></code></pre></td></tr></table></figure><p>ç»™å®š target &#x3D; 5ï¼Œè¿”å› trueã€‚</p><p>ç»™å®š target &#x3D; 20ï¼Œè¿”å› falseã€‚</p><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; n &lt;&#x3D; 1000</p><p>2ã€0 &lt;&#x3D; m &lt;&#x3D; 1000</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šåŒé‡éå†"><a href="#æ³•ä¸€ï¼šåŒé‡éå†" class="headerlink" title="æ³•ä¸€ï¼šåŒé‡éå†"></a>æ³•ä¸€ï¼šåŒé‡éå†</h3><p>æˆ‘ä»¬ç›´æ¥åŒé‡ for å¾ªç¯éå†æ•´ä¸ªçŸ©é˜µ matrixï¼Œåˆ¤æ–­ target æ˜¯å¦å‡ºç°å³å¯ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">findNumberIn2DArray</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] matrix, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] row : matrix) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> element : row) &#123;<br>                <span class="hljs-keyword">if</span> (element == target) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ã€‚ä¸¤é‡ for å¾ªç¯</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚ä»…ä½¿ç”¨å¸¸æ•°ä¸ªå˜é‡</p><h3 id="æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾"><a href="#æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾"></a>æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾</h3><p>ç”±äºçŸ©é˜µ matrix ä¸­æ¯ä¸€è¡Œçš„å…ƒç´ éƒ½æ˜¯å‡åºæ’åˆ—çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸€è¡Œéƒ½ä½¿ç”¨ä¸€æ¬¡äºŒåˆ†æŸ¥æ‰¾ï¼Œåˆ¤æ–­ target æ˜¯å¦åœ¨è¯¥è¡Œä¸­ï¼Œä»è€Œåˆ¤æ–­ target æ˜¯å¦å‡ºç°ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">findNumberIn2DArray</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] matrix, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] row : matrix) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> search(row, target);<br>            <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">low</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, high = nums.length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (high - low) / <span class="hljs-number">2</span> + low;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> nums[mid];<br>            <span class="hljs-keyword">if</span> (num == target) &#123;<br>                <span class="hljs-keyword">return</span> mid;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num &gt; target) &#123;<br>                high = mid - <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                low = mid + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ã€‚å¯¹ä¸€è¡Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(logn)ï¼Œæœ€å¤šéœ€è¦è¿›è¡Œ n æ¬¡äºŒåˆ†æŸ¥æ‰¾ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œä½¿ç”¨åŒé‡ for å¾ªç¯èƒ½å¤Ÿå¿«é€Ÿæ±‚è§£ï¼Œè¿›ä¸€æ­¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾èƒ½ä¼˜åŒ–ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 03. æ•°ç»„ä¸­é‡å¤çš„æ•°å­—ï¼ˆä¸‰åå››ï¼‰</title>
    <link href="/2022/09/07/A34-%E5%89%91%E6%8C%87%20Offer%2003.%20%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E4%B8%89%E5%8D%81%E5%9B%9B%EF%BC%89/"/>
    <url>/2022/09/07/A34-%E5%89%91%E6%8C%87%20Offer%2003.%20%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E4%B8%89%E5%8D%81%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šï¼š<a href="https://leetcode.cn/problems/shu-zu-zhong-zhong-fu-de-shu-zi-lcof/">å‰‘æŒ‡ Offer 03.Â æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œå“ˆå¸Œè¡¨ã€</p><p>æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—ã€‚</p><p>åœ¨ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ nums é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨ 0ï½n-1 çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤äº†å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼š<br>[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">2</span> æˆ– <span class="hljs-number">3</span> <br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€2 &lt;&#x3D; n &lt;&#x3D; 100000</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1)ã€ç”±äºåªéœ€è¦æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼Œå› æ­¤éå†æ•°ç»„ï¼Œé‡åˆ°é‡å¤çš„æ•°å­—å³è¿”å›ã€‚ä¸ºäº†åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦é‡å¤é‡åˆ°ï¼Œä½¿ç”¨é›†åˆå­˜å‚¨å·²ç»é‡åˆ°çš„æ•°å­—ï¼Œå¦‚æœé‡åˆ°çš„ä¸€ä¸ªæ•°å­—å·²ç»åœ¨é›†åˆä¸­ï¼Œåˆ™å½“å‰çš„æ•°å­—æ˜¯é‡å¤æ•°å­—ã€‚</p><blockquote><p>åˆå§‹åŒ–é›†åˆä¸ºç©ºé›†åˆï¼Œé‡å¤çš„æ•°å­— repeat &#x3D; -1ï¼Œéå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼šå°†è¯¥å…ƒç´ åŠ å…¥é›†åˆä¸­ï¼Œåˆ¤æ–­æ˜¯å¦æ·»åŠ æˆåŠŸï¼Œå¦‚æœæ·»åŠ å¤±è´¥ï¼Œè¯´æ˜è¯¥å…ƒç´ å·²ç»åœ¨é›†åˆä¸­ï¼Œå› æ­¤è¯¥å…ƒç´ æ˜¯é‡å¤å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ çš„å€¼èµ‹ç»™ repeatï¼Œå¹¶ç»“æŸéå†è¿”å› repeat</p></blockquote><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findRepeatNumber</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        Set&lt;Integer&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;Integer&gt;();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">repeat</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            <span class="hljs-keyword">if</span> (!set.add(num)) &#123;<br>                repeat = num;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> repeat;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚éå†æ•°ç»„ä¸€éï¼Œä½¿ç”¨å“ˆå¸Œé›†åˆï¼ˆHashSetï¼‰ï¼Œæ·»åŠ å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œæ•…æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚ä¸é‡å¤çš„æ¯ä¸ªå…ƒç´ éƒ½å¯èƒ½å­˜å…¥é›†åˆï¼Œå› æ­¤å ç”¨ O(n) é¢å¤–ç©ºé—´ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œä½¿ç”¨ Set é›†åˆä¸èƒ½æ·»åŠ é‡å¤å…ƒç´ çš„ç‰¹æ€§è¿›è¡Œå¿«é€Ÿæ±‚è§£ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ï¼ˆä¸‰åä¸‰ï¼‰</title>
    <link href="/2022/09/06/A33-%E5%90%88%E5%B9%B6K%E4%B8%AA%E5%8D%87%E5%BA%8F%E9%93%BE%E8%A1%A8%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89/"/>
    <url>/2022/09/06/A33-%E5%90%88%E5%B9%B6K%E4%B8%AA%E5%8D%87%E5%BA%8F%E9%93%BE%E8%A1%A8%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬äºŒåä¸‰é¢˜ï¼š<a href="https://leetcode.cn/problems/merge-k-sorted-lists/">åˆå¹¶Kä¸ªå‡åºé“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>å›°éš¾</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€</p><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œæ¯ä¸ªé“¾è¡¨éƒ½å·²ç»æŒ‰å‡åºæ’åˆ—ã€‚</p><p>è¯·ä½ å°†æ‰€æœ‰é“¾è¡¨åˆå¹¶åˆ°ä¸€ä¸ªå‡åºé“¾è¡¨ä¸­ï¼Œè¿”å›åˆå¹¶åçš„é“¾è¡¨ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šlists = [[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">6</span>]]<br>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]<br>è§£é‡Šï¼šé“¾è¡¨æ•°ç»„å¦‚ä¸‹ï¼š<br>[<br>  <span class="hljs-number">1</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>,<br>  <span class="hljs-number">1</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>,<br>  <span class="hljs-number">2</span>-&gt;<span class="hljs-number">6</span><br>]<br>å°†å®ƒä»¬åˆå¹¶åˆ°ä¸€ä¸ªæœ‰åºé“¾è¡¨ä¸­å¾—åˆ°ã€‚<br><span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;<span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šlists = []<br>è¾“å‡ºï¼š[]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šlists = [[]]<br>è¾“å‡ºï¼š[]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€k &#x3D;&#x3D; lists.length</p><p>2ã€0 &lt;&#x3D; k &lt;&#x3D; 10^4</p><p>3ã€0 &lt;&#x3D; lists[i].length &lt;&#x3D; 500</p><p>4ã€-10^4 &lt;&#x3D; lists[i][j] &lt;&#x3D; 10^4</p><p>5ã€lists[i] æŒ‰ å‡åº æ’åˆ—</p><p>6ã€lists[i].length çš„æ€»å’Œä¸è¶…è¿‡ 10^4</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªæ›´ç®€å•çš„é—®é¢˜ï¼š<strong>å¦‚ä½•åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼Ÿ</strong></p><p>å‡è®¾é“¾è¡¨ a å’Œ b çš„é•¿åº¦éƒ½æ˜¯ nï¼Œå¦‚ä½•åœ¨ O(n) çš„æ—¶é—´ä»£ä»·ä»¥åŠ O(1) çš„ç©ºé—´ä»£ä»·å®Œæˆåˆå¹¶ï¼Ÿ è¿™ä¸ªé—®é¢˜åœ¨é¢è¯•ä¸­ç»å¸¸å‡ºç°ï¼Œä¸ºäº†è¾¾åˆ°ç©ºé—´ä»£ä»·æ˜¯ O(1)ï¼Œæˆ‘ä»¬çš„å®—æ—¨æ˜¯ã€ŒåŸåœ°è°ƒæ•´é“¾è¡¨å…ƒç´ çš„ next æŒ‡é’ˆå®Œæˆåˆå¹¶ã€ã€‚</p><p>å…·ä½“æ­¥éª¤å’Œæ³¨æ„äº‹é¡¹ï¼š</p><p>1ã€é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå˜é‡ head æ¥ä¿å­˜åˆå¹¶ä¹‹åé“¾è¡¨çš„å¤´éƒ¨ï¼Œä½ å¯ä»¥æŠŠ head è®¾ç½®ä¸ºä¸€ä¸ªè™šæ‹Ÿçš„å¤´ï¼ˆä¹Ÿå°±æ˜¯ head çš„ val å±æ€§ä¸ä¿å­˜ä»»ä½•å€¼ï¼‰ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿ä»£ç çš„ä¹¦å†™ï¼Œåœ¨æ•´ä¸ªé“¾è¡¨åˆå¹¶å®Œä¹‹åï¼Œè¿”å›å®ƒçš„ä¸‹ä¸€ä½ç½®å³å¯ã€‚</p><p>2ã€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæŒ‡é’ˆ tail æ¥è®°å½•ä¸‹ä¸€ä¸ªæ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªä½ç½®ï¼Œä»¥åŠä¸¤ä¸ªæŒ‡é’ˆ aPtr å’Œ bPtr æ¥è®°å½• a å’Œ b æœªåˆå¹¶éƒ¨åˆ†çš„ç¬¬ä¸€ä½ã€‚æ³¨æ„è¿™é‡Œçš„æè¿°ï¼Œtail ä¸æ˜¯ä¸‹ä¸€ä¸ªæ’å…¥çš„ä½ç½®ï¼ŒaPtr å’Œ bPtr æ‰€æŒ‡å‘çš„å…ƒç´ å¤„äºã€Œå¾…åˆå¹¶ã€çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬è¿˜æ²¡æœ‰åˆå¹¶å…¥æœ€ç»ˆçš„é“¾è¡¨ã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç»™ä»–ä»¬èµ‹äºˆå…¶ä»–çš„å®šä¹‰ï¼Œä½†æ˜¯å®šä¹‰ä¸åŒå®ç°å°±ä¼šä¸åŒã€‚</p><p>3ã€å½“ aPtr å’Œ bPtr éƒ½ä¸ä¸ºç©ºçš„æ—¶å€™ï¼Œå– val ç†Ÿæ‚‰è¾ƒå°çš„åˆå¹¶ï¼›å¦‚æœ aPtr ä¸ºç©ºï¼Œåˆ™æŠŠæ•´ä¸ª bPtr ä»¥åŠåé¢çš„å…ƒç´ å…¨éƒ¨åˆå¹¶ï¼›bPtr ä¸ºç©ºæ—¶åŒç†ã€‚</p><p>4ã€åœ¨åˆå¹¶çš„æ—¶å€™ï¼Œåº”è¯¥å…ˆè°ƒæ•´ tail çš„ next å±æ€§ï¼Œå†åç§» tail å’Œ *Ptrï¼ˆaPtr æˆ–è€… bPtrï¼‰ã€‚é‚£ä¹ˆè¿™é‡Œ tail å’Œ *Ptr æ˜¯å¦å­˜åœ¨å…ˆåé¡ºåºå‘¢ï¼Ÿå®ƒä»¬è°å…ˆåŠ¨è°ååŠ¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¼šæ”¹å˜ä»»ä½•å…ƒç´ çš„ next æŒ‡é’ˆã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeTwoLists</span><span class="hljs-params">(ListNode a, ListNode b)</span> &#123;<br>    <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">null</span> || b == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> a != <span class="hljs-literal">null</span> ? a : b;<br>    &#125;<br>    <span class="hljs-type">ListNode</span> <span class="hljs-variable">head</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-type">ListNode</span> <span class="hljs-variable">tail</span> <span class="hljs-operator">=</span> head, aPtr = a, bPtr = b;<br>    <span class="hljs-keyword">while</span> (aPtr != <span class="hljs-literal">null</span> &amp;&amp; bPtr != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (aPtr.val &lt; bPtr.val) &#123;<br>            tail.next = aPtr;<br>            aPtr = aPtr.next;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tail.next = bPtr;<br>            bPtr = bPtr.next;<br>        &#125;<br>        tail = tail.next;<br>    &#125;<br>    tail.next = (aPtr != <span class="hljs-literal">null</span> ? aPtr : bPtr);<br>    <span class="hljs-keyword">return</span> head.next;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨å®ç°äº†ä¸¤ä¸ªé“¾è¡¨çš„åˆå¹¶ï¼š<strong>å¦‚æœè¦åˆå¹¶ K ä¸ªå…¶å®å°±ç”¨ for å¾ªç¯ï¼Œç„¶åç”¨ä¸€ä¸ªå˜é‡è®°å½•é“¾è¡¨å³å¯ã€‚</strong></p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeKLists</span><span class="hljs-params">(ListNode[] lists)</span> &#123;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">ans</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; lists.length; ++i) &#123;<br>            ans = mergeTwoLists(ans, lists[i]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeTwoLists</span><span class="hljs-params">(ListNode a, ListNode b)</span> &#123;<br>        <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">null</span> || b == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> a != <span class="hljs-literal">null</span> ? a : b;<br>        &#125;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">head</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">tail</span> <span class="hljs-operator">=</span> head, aPtr = a, bPtr = b;<br>        <span class="hljs-keyword">while</span> (aPtr != <span class="hljs-literal">null</span> &amp;&amp; bPtr != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (aPtr.val &lt; bPtr.val) &#123;<br>                tail.next = aPtr;<br>                aPtr = aPtr.next;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                tail.next = bPtr;<br>                bPtr = bPtr.next;<br>            &#125;<br>            tail = tail.next;<br>        &#125;<br>        tail.next = (aPtr != <span class="hljs-literal">null</span> ? aPtr : bPtr);<br>        <span class="hljs-keyword">return</span> head.next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(k^2n)</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œæ²¡æœ‰ç”¨åˆ°ä¸ k å’Œ n è§„æ¨¡ç›¸å…³çš„è¾…åŠ©ç©ºé—´ï¼Œæ•…æ¸è¿›ç©ºé—´å¤æ‚åº¦ä¸º O(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºå›°éš¾ï¼Œé¦–å…ˆæˆ‘ä»¬åº”è¯¥çŸ¥é“å¦‚ä½•åˆå¹¶ä¸¤ä¸ªå‡åºé“¾è¡¨ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç”¨ for å¾ªç¯ï¼Œç„¶åç”¨ä¸€ä¸ªå˜é‡è®°å½•é“¾è¡¨å³å¯</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutterç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šè¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªFlutteråº”ç”¨</title>
    <link href="/2022/09/05/Flutter%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E8%BF%90%E8%A1%8C%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAFlutter%E5%BA%94%E7%94%A8/"/>
    <url>/2022/09/05/Flutter%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E8%BF%90%E8%A1%8C%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAFlutter%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6e402af2a774dbdbca9fc37e8027cfa~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Flutter æ˜¯ Google æ¨å‡ºå¹¶å¼€æºçš„ç§»åŠ¨ç«¯å¼€å‘æ¡†æ¶ï¼Œä¸»æ‰“è·¨å¹³å°ã€é«˜ä¿çœŸã€é«˜æ€§èƒ½ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ Dart è¯­è¨€å¼€å‘ Appï¼Œä¸€å¥—ä»£ç å¯ä»¥åŒæ—¶è¿è¡Œåœ¨ iOS å’Œ Androidå¹³å°ã€‚</p><p>2018 å¹´ 12 æœˆï¼ŒGoogle å‘å¸ƒ Flutter 1.0ã€‚ä»é‚£æ—¶å€™å¼€å§‹ï¼ŒFlutter ä»¥è¿…é›·ä¸åŠæ©è€³ä¹‹åŠ¿ï¼Œè¿…é€Ÿå´›èµ·ï¼Œå¹¶ç¨³å›ºäº†å…¶åœ¨å¸‚åœºä¸Šçš„åœ°ä½ã€‚</p><p>å¦‚ä»Šï¼ŒFlutter ç›¸å…³èµ„æºå’Œç¤¾åŒºéƒ½å·²æ¸æ¸æˆç†Ÿï¼Œå¾—åˆ°äº†å¾ˆå¤šå¼€å‘è€…å’Œä¼ä¸šçš„ä¿¡ä»»ã€‚å¦å¤–å› ä¸ºå…¬å¸ä¸šåŠ¡æ‰©å¼ ï¼Œå‡†å¤‡å¼•å…¥ Flutter å¼€å‘é¡¹ç›®ï¼Œæ‰€ä»¥å­¦ä¹  Flutter åŠ¿åœ¨å¿…è¡Œï¼Œä¸‹é¢å°±è·Ÿç€æˆ‘çš„è„šæ­¥è¿›è¡Œ Flutter çš„å­¦ä¹ å§</p><h2 id="ä¸€ã€Flutter-å¼€å‘ç¯å¢ƒæ­å»º"><a href="#ä¸€ã€Flutter-å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€ã€Flutter å¼€å‘ç¯å¢ƒæ­å»º"></a>ä¸€ã€Flutter å¼€å‘ç¯å¢ƒæ­å»º</h2><p><strong>æ³¨æ„</strong>ï¼šæœ¬æ–‡ä»¥ macOS ç³»ç»Ÿä¸ºä¾‹</p><h3 id="1ï¼‰ã€ä½¿ç”¨é•œåƒ"><a href="#1ï¼‰ã€ä½¿ç”¨é•œåƒ" class="headerlink" title="1ï¼‰ã€ä½¿ç”¨é•œåƒ"></a>1ï¼‰ã€ä½¿ç”¨é•œåƒ</h3><p>ç”±äºåœ¨å›½å†…è®¿é—® Flutter æœ‰æ—¶å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼Œ Flutter å®˜æ–¹ä¸ºä¸­å›½å¼€å‘è€…æ­å»ºäº†ä¸´æ—¶é•œåƒï¼Œæˆ‘ä»¬åªéœ€å°†å¦‚ä¸‹ç¯å¢ƒå˜é‡é…ç½®åˆ°ç”¨æˆ·ç¯å¢ƒå˜é‡ä¸­å³å¯ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">export</span> PUB_HOSTED_URL=https:<span class="hljs-comment">//pub.flutter-io.cn</span><br><span class="hljs-keyword">export</span> FLUTTER_STORAGE_BASE_URL=https:<span class="hljs-comment">//storage.flutter-io.cn</span><br></code></pre></td></tr></table></figure><h3 id="2ï¼‰ã€ä¸‹è½½-Flutter-SDK"><a href="#2ï¼‰ã€ä¸‹è½½-Flutter-SDK" class="headerlink" title="2ï¼‰ã€ä¸‹è½½ Flutter SDK"></a>2ï¼‰ã€ä¸‹è½½ Flutter SDK</h3><p>æ–¹å¼æœ‰ 2ï¼š</p><h4 id="1ã€ç›´æ¥å»-Flutter-å®˜ç½‘ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…å³å¯"><a href="#1ã€ç›´æ¥å»-Flutter-å®˜ç½‘ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…å³å¯" class="headerlink" title="1ã€ç›´æ¥å» Flutter å®˜ç½‘ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…å³å¯"></a>1ã€ç›´æ¥å» Flutter å®˜ç½‘ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…å³å¯</h4><p>ä¸‹è½½åœ°å€ï¼š<a href="https://docs.flutter.dev/development/tools/sdk/releases?tab=macos#macos">https://docs.flutter.dev/development/tools/sdk/releases?tab=macos#macos</a></p><h4 id="2ã€é€šè¿‡-git-clone-ä¸‹è½½"><a href="#2ã€é€šè¿‡-git-clone-ä¸‹è½½" class="headerlink" title="2ã€é€šè¿‡ git clone ä¸‹è½½"></a>2ã€é€šè¿‡ git clone ä¸‹è½½</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">git clone -b master https:<span class="hljs-comment">//github.com/flutter/flutter.git</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°è¿™å¥å‘½ä»¤ä¼šå°†ä»“åº“å…‹éš†ä¸‹æ¥å¹¶åˆ‡æ¢åˆ° master åˆ†æ”¯</p><p><strong>æ³¨æ„</strong>ï¼šä¸Šè¿°ä¸¤ç§æ–¹å¼ç¬¬ä¸€ç§éœ€è¦è§£å‹ï¼Œç¬¬äºŒç§ä¸éœ€è¦ï¼Œæ€»ä¹‹å°†å®ƒä»¬æ”¾ç½®åˆ°æ‚¨æƒ³æ”¾çš„åœ°æ–¹å³å¯</p><h3 id="3ï¼‰ã€é…ç½®-Flutter-ç¯å¢ƒå˜é‡"><a href="#3ï¼‰ã€é…ç½®-Flutter-ç¯å¢ƒå˜é‡" class="headerlink" title="3ï¼‰ã€é…ç½® Flutter ç¯å¢ƒå˜é‡"></a>3ï¼‰ã€é…ç½® Flutter ç¯å¢ƒå˜é‡</h3><p>å°† Flutter ç¯å¢ƒå˜é‡é…ç½®åˆ°ä½ çš„ç”¨æˆ·ç¯å¢ƒï¼Œä¸‹é¢ä»¥æˆ‘ä¸ªäººçš„ä¸ºä¾‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart"># flutter ç¯å¢ƒå˜é‡<br><span class="hljs-keyword">export</span> FLUTTER_HOME=/Users/zhouying/Library/flutter<br><span class="hljs-keyword">export</span> PATH=$&#123;PATH&#125;:$&#123;FLUTTER_HOME&#125;/bin<br></code></pre></td></tr></table></figure><h3 id="4ï¼‰ã€éªŒè¯-Flutter-æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#4ï¼‰ã€éªŒè¯-Flutter-æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="4ï¼‰ã€éªŒè¯ Flutter æ˜¯å¦å®‰è£…æˆåŠŸ"></a>4ï¼‰ã€éªŒè¯ Flutter æ˜¯å¦å®‰è£…æˆåŠŸ</h3><p>é€šè¿‡<code>flutter doctor</code>æ¥æ£€æŸ¥æ˜¯å¦éœ€è¦å®‰è£…å…¶å®ƒä¾èµ–é¡¹æ¥å®Œæˆå®‰è£…ï¼Œè¿™ä¸ªè¿‡ç¨‹ç¬¬ä¸€æ¬¡å¯èƒ½éœ€è¦è€—è´¹ä¸€æ®µæ—¶é—´ï¼Œä¸‹æ¬¡å°±ä¼šå¿«å¾ˆå¤š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3928cb6c9f4d443fa22245f7ba2a8d58~tplv-k3u1fbpfcp-watermark.image" alt="202201261529488.png"></p><p>ä»ä¸Šé¢è¯Šæ–­ä¿¡æ¯æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p><p>1ã€Flutter ç‰ˆæœ¬å’Œæ¸ é“å· ok</p><p>2ã€Flutterè¿è¡Œæ‰€éœ€çš„ Android å·¥å…·é“¾ ok</p><p>3ã€Flutter æ‰€éœ€çš„ iOS å¼€å‘ç¯å¢ƒä¸ ok</p><p>4ã€Chrome ok</p><p>5ã€AndroidStudio ok</p><p>6ã€è¿æ¥çš„è®¾å¤‡ ok</p><p>7ã€HTTP ä¸»æœºå¯ç”¨æ€§ ok</p><h3 id="5ï¼‰ã€ä¸€äº›é¢å¤–å¸¸ç”¨çš„-Flutter-å‘½ä»¤"><a href="#5ï¼‰ã€ä¸€äº›é¢å¤–å¸¸ç”¨çš„-Flutter-å‘½ä»¤" class="headerlink" title="5ï¼‰ã€ä¸€äº›é¢å¤–å¸¸ç”¨çš„ Flutter å‘½ä»¤"></a>5ï¼‰ã€ä¸€äº›é¢å¤–å¸¸ç”¨çš„ Flutter å‘½ä»¤</h3><p>1ã€é€šè¿‡<code>flutter --help</code>æŸ¥çœ‹æ‰€å®‰è£… Flutter éœ€è¦çš„å¸®åŠ©</p><p>2ã€é€šè¿‡<code>flutter --version</code>æŸ¥çœ‹ Flutter ç‰ˆæœ¬</p><p>3ã€é€šè¿‡<code>flutter devices</code>æŸ¥çœ‹å½“å‰å¯ç”¨çš„è®¾å¤‡</p><p>4ã€é€šè¿‡<code>flutter run</code>è¿è¡Œå¯åŠ¨ä½ çš„åº”ç”¨ç¨‹åº</p><h2 id="äºŒã€å¹³å°è®¾ç½®"><a href="#äºŒã€å¹³å°è®¾ç½®" class="headerlink" title="äºŒã€å¹³å°è®¾ç½®"></a>äºŒã€å¹³å°è®¾ç½®</h2><p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œä¸»è¦è®² Android å¹³å°</p><h3 id="1ï¼‰ã€å®‰è£…å¹¶é…ç½®ä½ çš„-Android-Studio"><a href="#1ï¼‰ã€å®‰è£…å¹¶é…ç½®ä½ çš„-Android-Studio" class="headerlink" title="1ï¼‰ã€å®‰è£…å¹¶é…ç½®ä½ çš„ Android Studio"></a>1ï¼‰ã€å®‰è£…å¹¶é…ç½®ä½ çš„ Android Studio</h3><p>1ã€ä¸‹è½½å¹¶å®‰è£… <a href="https://developer.android.com/studio/index.html">Android Studio</a>.</p><p><strong>æ³¨æ„</strong>ï¼šAndroid Studio éœ€è¦ 3.0 æˆ–æ›´é«˜ç‰ˆæœ¬</p><p>2ã€å¯åŠ¨ Android Studioï¼Œç„¶åæ‰§è¡Œ Android Studio å®‰è£…å‘å¯¼ï¼Œè¿™å°†å®‰è£…æœ€æ–°çš„ Android SDKï¼ŒAndroid SDK å¹³å°å·¥å…·å’Œ Android SDK æ„å»ºå·¥å…·ï¼Œè¿™æ˜¯ Flutter ä¸º Android å¼€å‘æ—¶æ‰€å¿…éœ€çš„</p><h3 id="2ï¼‰ã€è®¾ç½®ä½ çš„-Android-è®¾å¤‡"><a href="#2ï¼‰ã€è®¾ç½®ä½ çš„-Android-è®¾å¤‡" class="headerlink" title="2ï¼‰ã€è®¾ç½®ä½ çš„ Android è®¾å¤‡"></a>2ï¼‰ã€è®¾ç½®ä½ çš„ Android è®¾å¤‡</h3><p><strong>æ³¨æ„</strong>ï¼šAndroid è®¾å¤‡éœ€è¦ Android 4.1ï¼ˆAPI level 16ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬</p><h4 id="1ã€çœŸæœº"><a href="#1ã€çœŸæœº" class="headerlink" title="1ã€çœŸæœº"></a>1ã€çœŸæœº</h4><blockquote><p>1ã€åœ¨æ‚¨çš„è®¾å¤‡ä¸Šå¯ç”¨ <strong>å¼€å‘äººå‘˜é€‰é¡¹</strong> å’Œ <strong>USBè°ƒè¯•</strong></p><p>2ã€ä½¿ç”¨USBå°†æ‰‹æœºæ’å…¥ç”µè„‘ã€‚å¦‚æœæ‚¨çš„è®¾å¤‡å‡ºç°æç¤ºï¼Œè¯·æˆæƒæ‚¨çš„è®¡ç®—æœºè®¿é—®æ‚¨çš„è®¾å¤‡</p><p>3ã€åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œ <code>flutter devices</code> å‘½ä»¤ä»¥éªŒè¯Flutterè¯†åˆ«æ‚¨è¿æ¥çš„Androidè®¾å¤‡</p><p>4ã€è¿è¡Œå¯åŠ¨æ‚¨çš„åº”ç”¨ç¨‹åº <code>flutter run</code></p></blockquote><h4 id="2ã€æ¨¡æ‹Ÿå™¨"><a href="#2ã€æ¨¡æ‹Ÿå™¨" class="headerlink" title="2ã€æ¨¡æ‹Ÿå™¨"></a>2ã€æ¨¡æ‹Ÿå™¨</h4><blockquote><p>1ã€åœ¨æ‚¨çš„æœºå™¨ä¸Šå¯ç”¨ <a href="https://developer.android.com/studio/run/emulator-acceleration.html">VM acceleration</a> </p><p>2ã€å¯åŠ¨ <strong>Android Studio&gt;Tools&gt;Android&gt;AVD Manager</strong> å¹¶é€‰æ‹© <strong>Create Virtual Device</strong></p><p>3ã€é€‰æ‹©ä¸€ä¸ªè®¾å¤‡å¹¶é€‰æ‹© <strong>Next</strong></p><p>4ã€ä¸ºè¦æ¨¡æ‹Ÿçš„ Android ç‰ˆæœ¬é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªç³»ç»Ÿæ˜ åƒï¼Œç„¶åé€‰æ‹© <strong>Next</strong>. å»ºè®®ä½¿ç”¨ <em>x86</em> æˆ– <em>x86_64</em> image </p><p>5ã€åœ¨ Emulated Performanceä¸‹, é€‰æ‹© <strong>Hardware - GLES 2.0</strong> ä»¥å¯ç”¨ <a href="https://developer.android.com/studio/run/emulator-acceleration.html">ç¡¬ä»¶åŠ é€Ÿ</a></p><p>6ã€éªŒè¯AVDé…ç½®æ˜¯å¦æ­£ç¡®ï¼Œç„¶åé€‰æ‹© <strong>Finish</strong></p><p>7ã€åœ¨ Android Virtual Device Manager ä¸­, ç‚¹å‡»å·¥å…·æ çš„ <strong>Run</strong>ã€‚æ¨¡æ‹Ÿå™¨å¯åŠ¨å¹¶æ˜¾ç¤ºæ‰€é€‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬æˆ–è®¾å¤‡çš„å¯åŠ¨ç”»é¢.</p><p>8ã€è¿è¡Œ <code>flutter run</code> å¯åŠ¨æ‚¨çš„è®¾å¤‡. è¿æ¥çš„è®¾å¤‡åæ˜¯ <code>Android SDK built for &lt;platform&gt;</code>ï¼Œå…¶ä¸­ <em>platform</em> æ˜¯èŠ¯ç‰‡ç³»åˆ—ï¼Œå¦‚ x86</p></blockquote><h3 id="3ï¼‰ã€åœ¨-AndroidStudio-ä¸Šå®‰è£…-Flutter-å’Œ-dart-æ’ä»¶"><a href="#3ï¼‰ã€åœ¨-AndroidStudio-ä¸Šå®‰è£…-Flutter-å’Œ-dart-æ’ä»¶" class="headerlink" title="3ï¼‰ã€åœ¨ AndroidStudio ä¸Šå®‰è£… Flutter å’Œ dart æ’ä»¶"></a>3ï¼‰ã€åœ¨ AndroidStudio ä¸Šå®‰è£… Flutter å’Œ dart æ’ä»¶</h3><ul><li><code>Flutter</code>æ’ä»¶ï¼š æ”¯æŒFlutterå¼€å‘å·¥ä½œæµ (è¿è¡Œã€è°ƒè¯•ã€çƒ­é‡è½½ç­‰)</li><li><code>Dart</code>æ’ä»¶ï¼š æä¾›ä»£ç åˆ†æ (è¾“å…¥ä»£ç æ—¶è¿›è¡ŒéªŒè¯ã€ä»£ç è¡¥å…¨ç­‰)</li></ul><p>è¦å®‰è£…è¿™äº›:</p><ol><li>å¯åŠ¨ Android Studio</li><li>æ‰“å¼€æ’ä»¶é¦–é€‰é¡¹ <strong>Preferences &gt; Plugins</strong></li><li>é€‰æ‹© <strong>Browse repositoriesâ€¦</strong>, é€‰æ‹© Flutter æ’ä»¶å¹¶ç‚¹å‡» <code>install</code></li><li>é‡å¯ Android Studio åæ’ä»¶ç”Ÿæ•ˆ</li></ol><p><strong>æ³¨æ„</strong>ï¼šå½“ä½ å®‰è£… Flutter æ’ä»¶åï¼Œä¼šè‡ªåŠ¨å®‰è£… Dart æ’ä»¶</p><h2 id="ä¸‰ã€åˆ›å»ºå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª-Flutter-åº”ç”¨"><a href="#ä¸‰ã€åˆ›å»ºå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª-Flutter-åº”ç”¨" class="headerlink" title="ä¸‰ã€åˆ›å»ºå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter åº”ç”¨"></a>ä¸‰ã€åˆ›å»ºå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter åº”ç”¨</h2><h3 id="1ï¼‰ã€åˆ›å»ºæ–°åº”ç”¨"><a href="#1ï¼‰ã€åˆ›å»ºæ–°åº”ç”¨" class="headerlink" title="1ï¼‰ã€åˆ›å»ºæ–°åº”ç”¨"></a>1ï¼‰ã€åˆ›å»ºæ–°åº”ç”¨</h3><p>1ã€é€‰æ‹© <strong>File &gt; New Flutter Project</strong></p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c6360e622964e47b26eb78d4d6324ae~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220112220116827" style="zoom:50%;" /><p>2ã€é€‰æ‹© <strong>Flutter</strong> ä½œä¸º project ç±»å‹, ç„¶åç‚¹å‡» Next</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9bdad331ea4c45119cdb82840793e3b1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220112220159083" style="zoom:50%;" /><p>3ã€è¾“å…¥é¡¹ç›®åç§° (å¦‚ <code>myapp</code>)ï¼Œç„¶åç‚¹å‡» Next</p><p><strong>æ³¨æ„</strong>ï¼šProject name å­—æ¯å¿…é¡»éƒ½æ˜¯å°å†™ï¼Œå¦åˆ™ä¼šæç¤ºä½ ä¸èƒ½åˆ›å»ºåº”ç”¨</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5de438253adc4fb9ba333b9e0fd2f522~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220112220309504" style="zoom:50%;" /><p>4ã€ç‚¹å‡» <strong>Finish</strong></p><p>5ã€ç­‰å¾… Android Studio å®‰è£… SDK å¹¶åˆ›å»ºé¡¹ç›®</p><h3 id="2ï¼‰ã€Flutter-å·¥ç¨‹ç»“æ„è§£æ"><a href="#2ï¼‰ã€Flutter-å·¥ç¨‹ç»“æ„è§£æ" class="headerlink" title="2ï¼‰ã€Flutter å·¥ç¨‹ç»“æ„è§£æ"></a>2ï¼‰ã€Flutter å·¥ç¨‹ç»“æ„è§£æ</h3><p>å¦‚ä¸‹å›¾å°±æ˜¯æˆ‘ä»¬åˆ›å»ºå¥½çš„ä¸€ä¸ª Flutter é¡¹ç›®å·¥ç¨‹ç»“æ„ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c06e013ea6f54f208fd3e355f98639aa~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220113145050564" style="zoom:50%;" /><p>ç®€å•çš„è§£é‡Šä¸€ä¸‹ï¼š</p><table><thead><tr><th>æ–‡ä»¶</th><th>æè¿°</th></tr></thead><tbody><tr><td>myapp</td><td>é¡¹ç›®å·¥ç¨‹åç§°</td></tr><tr><td>.dart_tool</td><td>Dart å·¥å…·å¼€å‘ç›¸å…³é…ç½®</td></tr><tr><td>.idea</td><td>Flutter å¼€å‘ç¯å¢ƒé…ç½®</td></tr><tr><td>android</td><td>Android å¹³å°ç›¸å…³ä»£ç </td></tr><tr><td>ios</td><td>iOS å¹³å°ç›¸å…³ä»£ç </td></tr><tr><td>lib</td><td>è·¨å¹³å°ä»£ç ï¼Œä¹Ÿæ˜¯ Flutter é¡¹ç›®ä¸»è¦å…³å¿ƒçš„ç›®å½•</td></tr><tr><td>test</td><td>æµ‹è¯•ç›¸å…³ä»£ç </td></tr><tr><td>.gitignore</td><td>git æäº¤ä»“åº“å¿½ç•¥æ–‡ä»¶</td></tr><tr><td>.metadata</td><td>å¯¹å½“å‰å·¥ç¨‹çš„é…ç½®è®°å½•</td></tr><tr><td>.packages</td><td>ä»¥ lib ç»“å°¾çš„æ–‡ä»¶ç»å¯¹è·¯å¾„</td></tr><tr><td>analysis_options.yaml</td><td>é™æ€åˆ†ææ–‡ä»¶</td></tr><tr><td>myapp.iml</td><td>å·¥ç¨‹æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„é…ç½®</td></tr><tr><td>pubspec.lock</td><td>å½“å‰é¡¹ç›®ä¾èµ–æ‰€ç”Ÿæˆçš„æ–‡ä»¶</td></tr><tr><td>pubspec.yaml</td><td>é¡¹ç›®æè¿°æ–‡ä»¶ï¼ŒåŒ…å«äº†é¡¹ç›®çš„æè¿°ä¿¡æ¯ä»¥åŠæ‰€éœ€è¦çš„ä¾èµ–çš„åº“</td></tr><tr><td>README.md</td><td>é¡¹ç›®æè¿°ä¿¡æ¯</td></tr><tr><td>External Libraries</td><td>Android å¼€å‘åŒ…ï¼Œèµ„æºæ–‡ä»¶ã€Dart SDK æ–‡ä»¶ã€å·¥ç¨‹å¼€å‘ä¾èµ–æ’ä»¶ API ç­‰ç­‰</td></tr><tr><td>Scratches and Consoles</td><td>åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶å’Œç¼“å†²åŒºåˆ—è¡¨</td></tr></tbody></table><h3 id="3ï¼‰ã€è¿è¡Œåº”ç”¨"><a href="#3ï¼‰ã€è¿è¡Œåº”ç”¨" class="headerlink" title="3ï¼‰ã€è¿è¡Œåº”ç”¨"></a>3ï¼‰ã€è¿è¡Œåº”ç”¨</h3><p>1ã€å®šä½åˆ° Android Studio å·¥å…·æ ï¼Œé€‰æ‹©è¿è¡Œåº”ç”¨çš„ Android è®¾å¤‡ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯çœŸæœº</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a722418fe13f4df8880c3d82dc8df874~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220112220957667"></p><p>2ã€åœ¨å·¥å…·æ ä¸­ç‚¹å‡» <strong>Run å›¾æ ‡</strong>ï¼Œæˆ–è€…è°ƒç”¨èœå•é¡¹ <strong>Run &gt; Run</strong>ï¼Œæˆ–è€…ä½¿ç”¨<code>flutter run</code> å‘½ä»¤æ¥è¿è¡Œä½ çš„åº”ç”¨</p><p>3ã€å¦‚æœä¸€åˆ‡æ­£å¸¸, ä½ åº”è¯¥åœ¨ä½ çš„è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸Šä¼šçœ‹åˆ°å¯åŠ¨çš„åº”ç”¨ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/baf1a7e5dc404bc3b3835c3025801cf9~tplv-k3u1fbpfcp-watermark.image" alt="202201261600172.png"></p><h3 id="4ï¼‰ã€ä½“éªŒçƒ­é‡è½½"><a href="#4ï¼‰ã€ä½“éªŒçƒ­é‡è½½" class="headerlink" title="4ï¼‰ã€ä½“éªŒçƒ­é‡è½½"></a>4ï¼‰ã€ä½“éªŒçƒ­é‡è½½</h3><blockquote><p>Flutter å¯ä»¥é€šè¿‡ <em>çƒ­é‡è½½ï¼ˆhot reloadï¼‰</em> å®ç°å¿«é€Ÿæ•ˆæœé¢„è§ˆï¼Œçƒ­é‡è½½å°±æ˜¯æ— éœ€é‡å¯åº”ç”¨ç¨‹åºå°±èƒ½å®æ—¶åŠ è½½ä¿®æ”¹åçš„ä»£ç ï¼Œå¹¶ä¸”ä¸ä¼šä¸¢å¤±çŠ¶æ€ï¼ˆè¿™å’Œ webpack çš„çƒ­é‡è½½æ˜¯ä¸€æ ·çš„ï¼‰ã€‚ç®€å•çš„å¯¹ä»£ç è¿›è¡Œæ›´æ”¹ï¼Œç„¶åå‘Šè¯‰ IDE æˆ–å‘½ä»¤è¡Œå·¥å…·ä½ éœ€è¦é‡æ–°åŠ è½½ï¼ˆç‚¹å‡»reloadæŒ‰é’®ï¼‰ï¼Œä½ å°±ä¼šåœ¨ä½ çš„è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸Šçœ‹åˆ°æ›´æ”¹</p></blockquote><p>1ã€å°†å­—ç¬¦ä¸²<code>You have pushed the button this many times:&#39;</code> æ›´æ”¹ä¸º<code>You have clicked the button this many times:&#39;</code></p><p>2ã€ä¸è¦æŒ‰<code>Stop</code>æŒ‰é’®ï¼Œè®©ä½ çš„åº”ç”¨ç»§ç»­è¿è¡Œ</p><p>3ã€è¦æŸ¥çœ‹ä½ çš„æ›´æ”¹, åªéœ€è°ƒç”¨<code>command + s</code>ï¼Œæˆ–ç‚¹å‡» <strong>çƒ­é‡è½½æŒ‰é’®</strong> (å¸¦æœ‰é—ªç”µâš¡ï¸å›¾æ ‡çš„æŒ‰é’®) å³å¯</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c2690d17dd74f8eae0da8e6ff48b409~tplv-k3u1fbpfcp-watermark.image" alt="202201261539133.png"></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« è®²çš„ä¸€äº›é‡ç‚¹å†…å®¹ï¼š</p><p>1ã€Flutter å¼€å‘ç¯å¢ƒæ­å»º</p><p>2ã€Flutter åœ¨ Android å¹³å°ç›¸å…³è®¾ç½®</p><p>3ã€åˆ›å»ºå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flutter é¡¹ç›®ï¼ŒFlutter å·¥ç¨‹ç»“æ„è§£æ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ© ğŸ¤ </p><p><strong>æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>å› ä¸º Flutter æ˜¯åŸºäº Dart è¯­è¨€å¼€å‘çš„ï¼Œæ‰€ä»¥ä¸‹ç¯‡æ–‡ç« æˆ‘ä¼šè®² Dart è¯­è¨€ç›¸å…³çš„å†…å®¹ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜„</p><h3 id="å‚è€ƒå’Œæ¨è"><a href="#å‚è€ƒå’Œæ¨è" class="headerlink" title="å‚è€ƒå’Œæ¨è"></a>å‚è€ƒå’Œæ¨è</h3><p><a href="https://flutterchina.club/setup-macos/">Flutter å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://book.flutterchina.club/chapter1/flutter_intro.html">ã€ŠFlutterå®æˆ˜Â·ç¬¬äºŒç‰ˆã€‹- Preview</a></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç»„åˆæ€»å’Œ IIï¼ˆä¸‰åäºŒï¼‰</title>
    <link href="/2022/09/05/A32-%E7%BB%84%E5%90%88%E6%80%BB%E5%92%8C%20II%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
    <url>/2022/09/05/A32-%E7%BB%84%E5%90%88%E6%80%BB%E5%92%8C%20II%EF%BC%88%E4%B8%89%E5%8D%81%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬å››åé¢˜ï¼š<a href="https://leetcode.cn/problems/combination-sum-ii/description/">ç»„åˆæ€»å’Œ II</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œå›æº¯ã€</p><p>ç»™å®šä¸€ä¸ªå€™é€‰äººç¼–å·çš„é›†åˆ candidates å’Œä¸€ä¸ªç›®æ ‡æ•° target ï¼Œæ‰¾å‡º candidates ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º target çš„ç»„åˆã€‚</p><p>candidates ä¸­çš„æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ ã€‚</p><p>æ³¨æ„ï¼šè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚ </p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: candidates = [<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>], target = <span class="hljs-number">8</span>,<br>è¾“å‡º:<br>[<br>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>],<br>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],<br>[<span class="hljs-number">1</span>,<span class="hljs-number">7</span>],<br>[<span class="hljs-number">2</span>,<span class="hljs-number">6</span>]<br>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: candidates = [<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], target = <span class="hljs-number">5</span>,<br>è¾“å‡º:<br>[<br>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],<br>[<span class="hljs-number">5</span>]<br>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€1 &lt;&#x3D; candidates.length &lt;&#x3D; 100</p><p>2ã€1 &lt;&#x3D; candidates[i] &lt;&#x3D; 50</p><p>3ã€1 &lt;&#x3D; target &lt;&#x3D; 30</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>ç”±äºæˆ‘ä»¬éœ€è¦æ±‚å‡ºæ‰€æœ‰å’Œä¸º target çš„ç»„åˆï¼Œå¹¶ä¸”æ¯ä¸ªæ•°åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€’å½’ + å›æº¯çš„æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><p>æˆ‘ä»¬ç”¨ dfs(pos,rest) è¡¨ç¤ºé€’å½’çš„å‡½æ•°ï¼Œå…¶ä¸­ pos è¡¨ç¤ºæˆ‘ä»¬å½“å‰é€’å½’åˆ°äº†æ•°ç»„ candidates ä¸­çš„ç¬¬ pos ä¸ªæ•°ï¼Œè€Œ rest è¡¨ç¤ºæˆ‘ä»¬è¿˜éœ€è¦é€‰æ‹©å’Œä¸º rest çš„æ•°æ”¾å…¥åˆ—è¡¨ä½œä¸ºä¸€ä¸ªç»„åˆï¼›</p><p>å¯¹äºå½“å‰çš„ç¬¬ pos ä¸ªæ•°ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šé€‰æˆ–è€…ä¸é€‰ã€‚å¦‚æœæˆ‘ä»¬é€‰äº†è¿™ä¸ªæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è°ƒç”¨ dfs(pos+1,restâˆ’candidates[pos]) è¿›è¡Œé€’å½’ï¼Œæ³¨æ„è¿™é‡Œå¿…é¡»æ»¡è¶³ restâ‰¥candidates[pos]ã€‚å¦‚æœæˆ‘ä»¬ä¸é€‰è¿™ä¸ªæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è°ƒç”¨ dfs(pos+1,rest) è¿›è¡Œé€’å½’ï¼›</p><p>åœ¨æŸæ¬¡é€’å½’å¼€å§‹å‰ï¼Œå¦‚æœ rest çš„å€¼ä¸º 0ï¼Œè¯´æ˜æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå’Œä¸º target çš„ç»„åˆï¼Œå°†å…¶æ”¾å…¥ç­”æ¡ˆä¸­ã€‚æ¯æ¬¡è°ƒç”¨é€’å½’å‡½æ•°å‰ï¼Œå¦‚æœæˆ‘ä»¬é€‰äº†é‚£ä¸ªæ•°ï¼Œå°±éœ€è¦å°†å…¶æ”¾å…¥åˆ—è¡¨çš„æœ«å°¾ï¼Œè¯¥åˆ—è¡¨ä¸­å­˜å‚¨äº†æˆ‘ä»¬é€‰çš„æ‰€æœ‰æ•°ã€‚åœ¨å›æº¯æ—¶ï¼Œå¦‚æœæˆ‘ä»¬é€‰äº†é‚£ä¸ªæ•°ï¼Œå°±è¦å°†å…¶ä»åˆ—è¡¨çš„æœ«å°¾åˆ é™¤ã€‚</p><p>ä¸Šè¿°ç®—æ³•å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„é€’å½’ + å›æº¯ç®—æ³•ï¼Œä½†æ˜¯å®ƒå¹¶ä¸é€‚ç”¨äºæœ¬é¢˜ã€‚è¿™æ˜¯å› ä¸ºé¢˜ç›®æè¿°ä¸­è§„å®šäº†è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆï¼Œè€Œä¸Šè¿°çš„ç®—æ³•ä¸­å¹¶æ²¡æœ‰å»é™¤é‡å¤çš„ç»„åˆã€‚</p><p>ä¾‹å¦‚å½“ candidates&#x3D;[2,2]ï¼Œtarget&#x3D;2 æ—¶ï¼Œä¸Šè¿°ç®—æ³•ä¼šå°†åˆ—è¡¨ [2] æ”¾å…¥ç­”æ¡ˆä¸¤æ¬¡ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ”¹è¿›ä¸Šè¿°ç®—æ³•ï¼Œåœ¨æ±‚å‡ºç»„åˆçš„è¿‡ç¨‹ä¸­å°±è¿›è¡Œå»é‡çš„æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†ç›¸åŒçš„æ•°æ”¾åœ¨ä¸€èµ·è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ•° x å‡ºç°äº† y æ¬¡ï¼Œé‚£ä¹ˆåœ¨é€’å½’æ—¶ä¸€æ¬¡æ€§åœ°å¤„ç†å®ƒä»¬ï¼Œå³åˆ†åˆ«è°ƒç”¨é€‰æ‹©0,1,â‹¯,y æ¬¡ x çš„é€’å½’å‡½æ•°ã€‚è¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šå¾—åˆ°é‡å¤çš„ç»„åˆã€‚å…·ä½“åœ°ï¼š</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œæ˜ å°„ï¼ˆHashMapï¼‰ç»Ÿè®¡æ•°ç»„ candidates ä¸­æ¯ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ã€‚åœ¨ç»Ÿè®¡å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°†ç»“æœæ”¾å…¥ä¸€ä¸ªåˆ—è¡¨ freq ä¸­ï¼Œæ–¹ä¾¿åç»­çš„é€’å½’ä½¿ç”¨ã€‚</p><p>åˆ—è¡¨ freq çš„é•¿åº¦å³ä¸ºæ•°ç»„ candidates ä¸­ä¸åŒæ•°çš„ä¸ªæ•°ã€‚å…¶ä¸­çš„æ¯ä¸€é¡¹å¯¹åº”ç€å“ˆå¸Œæ˜ å°„ä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå³æŸä¸ªæ•°ä»¥åŠå®ƒå‡ºç°çš„æ¬¡æ•°ã€‚<br>åœ¨é€’å½’æ—¶ï¼Œå¯¹äºå½“å‰çš„ç¬¬ pos ä¸ªæ•°ï¼Œå®ƒçš„å€¼ä¸º freq[pos][0]ï¼Œå‡ºç°çš„æ¬¡æ•°ä¸º freq[pos][1]ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è°ƒç”¨ dfs(pos+1,restâˆ’iÃ—freq[pos][0])ï¼Œå³æˆ‘ä»¬é€‰æ‹©äº†è¿™ä¸ªæ•° i æ¬¡ã€‚è¿™é‡Œ i ä¸èƒ½å¤§äºè¿™ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶ä¸” iÃ—freq[pos][0] ä¹Ÿä¸èƒ½å¤§äº restã€‚åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°† i ä¸ª freq[pos][0] æ”¾å…¥åˆ—è¡¨ä¸­ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸é‡å¤åœ°æšä¸¾æ‰€æœ‰çš„ç»„åˆäº†ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡Œä»€ä¹ˆä¼˜åŒ–ï¼ˆå‰ªæï¼‰å‘¢ï¼Ÿä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„ä¼˜åŒ–æ–¹æ³•æ˜¯ï¼Œæˆ‘ä»¬å°† freq æ ¹æ®æ•°ä»å°åˆ°å¤§æ’åºï¼Œè¿™æ ·æˆ‘ä»¬åœ¨é€’å½’æ—¶ä¼šå…ˆé€‰æ‹©å°çš„æ•°ï¼Œå†é€‰æ‹©å¤§çš„æ•°ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå½“æˆ‘ä»¬é€’å½’åˆ° dfs(pos,rest) æ—¶ï¼Œå¦‚æœ freq[pos][0] å·²ç»å¤§äº restï¼Œé‚£ä¹ˆåé¢è¿˜æ²¡æœ‰é€’å½’åˆ°çš„æ•°ä¹Ÿéƒ½å¤§äº restï¼Œè¿™å°±è¯´æ˜ä¸å¯èƒ½å†é€‰æ‹©è‹¥å¹²ä¸ªå’Œä¸º rest çš„æ•°æ”¾å…¥åˆ—è¡¨äº†ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å›æº¯ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    List&lt;<span class="hljs-type">int</span>[]&gt; freq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;<span class="hljs-type">int</span>[]&gt;();<br>    List&lt;List&lt;Integer&gt;&gt; ans = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;List&lt;Integer&gt;&gt;();<br>    List&lt;Integer&gt; sequence = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br><br>    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">combinationSum2</span><span class="hljs-params">(<span class="hljs-type">int</span>[] candidates, <span class="hljs-type">int</span> target)</span> &#123;<br>        Arrays.sort(candidates);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : candidates) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> freq.size();<br>            <span class="hljs-keyword">if</span> (freq.isEmpty() || num != freq.get(size - <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]) &#123;<br>                freq.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;num, <span class="hljs-number">1</span>&#125;);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                ++freq.get(size - <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>];<br>            &#125;<br>        &#125;<br>        dfs(<span class="hljs-number">0</span>, target);<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> pos, <span class="hljs-type">int</span> rest)</span> &#123;<br>        <span class="hljs-keyword">if</span> (rest == <span class="hljs-number">0</span>) &#123;<br>            ans.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;(sequence));<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (pos == freq.size() || rest &lt; freq.get(pos)[<span class="hljs-number">0</span>]) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        dfs(pos + <span class="hljs-number">1</span>, rest);<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">most</span> <span class="hljs-operator">=</span> Math.min(rest / freq.get(pos)[<span class="hljs-number">0</span>], freq.get(pos)[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= most; ++i) &#123;<br>            sequence.add(freq.get(pos)[<span class="hljs-number">0</span>]);<br>            dfs(pos + <span class="hljs-number">1</span>, rest - i * freq.get(pos)[<span class="hljs-number">0</span>]);<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= most; ++i) &#123;<br>            sequence.remove(sequence.size() - <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¸Šè¿°è§£æ³•æˆ‘ä»¬è¿˜å¯ä»¥ä¼˜åŒ–å†™çš„æ›´åŠ ç®€æ´ä¸€ç‚¹ï¼Œå¦‚ä¸‹ï¼š</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    List&lt;Integer&gt; path = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">combinationSum2</span><span class="hljs-params">(<span class="hljs-type">int</span>[] candidates, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-comment">// å…ˆè¿›è¡Œæ’åº</span><br>        Arrays.sort(candidates);<br>        backtrack(<span class="hljs-number">0</span>, candidates, target);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrack</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span>[] candidates, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-keyword">if</span> (sum == target) &#123;<br>            res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(path));<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">// å‰ªææ“ä½œ</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; candidates.length &amp;&amp; sum + candidates[i] &lt;= target; ++i) &#123;<br>            <span class="hljs-comment">// å»é‡</span><br>            <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; candidates[i] == candidates[i - <span class="hljs-number">1</span>]) <span class="hljs-keyword">continue</span>;<br>            path.add(candidates[i]);<br>            sum += candidates[i];<br>            backtrack(i + <span class="hljs-number">1</span>, candidates, target);<br>            sum -= candidates[i];<br>            path.remove(path.size() - <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(2^nÃ—n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ candidates çš„é•¿åº¦ã€‚åœ¨å¤§éƒ¨åˆ†é€’å½’ + å›æº¯çš„é¢˜ç›®ä¸­ï¼Œæˆ‘ä»¬æ— æ³•ç»™å‡ºä¸€ä¸ªä¸¥æ ¼çš„æ¸è¿›ç´§ç•Œï¼Œæ•…è¿™é‡Œåªåˆ†æä¸€ä¸ªè¾ƒä¸ºå®½æ¾çš„æ¸è¿›ä¸Šç•Œã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªæ•°éƒ½ä¸ç›¸åŒï¼Œé‚£ä¹ˆåˆ—è¡¨ freq çš„é•¿åº¦åŒæ ·ä¸º nã€‚åœ¨é€’å½’æ—¶ï¼Œæ¯ä¸ªä½ç½®å¯ä»¥é€‰æˆ–ä¸é€‰ï¼Œå¦‚æœæ•°ç»„ä¸­æ‰€æœ‰æ•°çš„å’Œä¸è¶…è¿‡ targetï¼Œé‚£ä¹ˆ 2^n ç§ç»„åˆéƒ½ä¼šè¢«æšä¸¾åˆ°ï¼›åœ¨ target å°äºæ•°ç»„ä¸­æ‰€æœ‰æ•°çš„å’Œæ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½è§£æåœ°ç®—å‡ºæ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç»„åˆçš„æ•°é‡ï¼Œä½†æˆ‘ä»¬çŸ¥é“æ¯å¾—åˆ°ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ç»„åˆï¼Œéœ€è¦ O(n) çš„æ—¶é—´å°†å…¶æ”¾å…¥ç­”æ¡ˆä¸­ï¼Œå› æ­¤æˆ‘ä»¬å°† O(2^n) ä¸ O(n) ç›¸ä¹˜ï¼Œå³å¯ä¼°ç®—å‡ºä¸€ä¸ªå®½æ¾çš„æ—¶é—´å¤æ‚åº¦ä¸Šç•Œã€‚</p><p>ç”±äº O(2^nÃ—n) åœ¨æ¸è¿›æ„ä¹‰ä¸‹å¤§äºæ’åºçš„æ—¶é—´å¤æ‚åº¦ O(nlogn)ï¼Œå› æ­¤åè€…å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é™¤äº†å­˜å‚¨ç­”æ¡ˆçš„æ•°ç»„å¤–ï¼Œæˆ‘ä»¬éœ€è¦ O(n) çš„ç©ºé—´å­˜å‚¨åˆ—è¡¨ freqã€é€’å½’ä¸­å­˜å‚¨å½“å‰é€‰æ‹©çš„æ•°çš„åˆ—è¡¨ã€ä»¥åŠé€’å½’éœ€è¦çš„æ ˆã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œä¸€ä¸ªæ¸…æ™°çš„æ€è·¯ï¼šé€’å½’ + å›æº¯ + å»é‡ã€‚æŒ‰ç…§è¿™ä¸‰ä¸ªç‚¹ç„¶ååœ¨å®ç°çš„è¿‡ç¨‹ä¸­æ³¨æ„ç»†èŠ‚æ–¹èƒ½æ­£ç¡®çš„è§£ç­”å‡ºæ¥</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒåˆ†æŸ¥æ‰¾ï¼ˆä¸‰åä¸€ï¼‰</title>
    <link href="/2022/09/04/A31-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%80%EF%BC%89/"/>
    <url>/2022/09/04/A31-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%EF%BC%88%E4%B8%89%E5%8D%81%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸ƒç™¾é›¶å››é¢˜ï¼š<a href="https://leetcode.cn/problems/binary-search/description/">äºŒåˆ†æŸ¥æ‰¾</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€</p><p>ç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target  ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: nums = [-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>,<span class="hljs-number">12</span>], target = <span class="hljs-number">9</span><br>è¾“å‡º: <span class="hljs-number">4</span><br>è§£é‡Š: <span class="hljs-number">9</span> å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: nums = [-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>,<span class="hljs-number">12</span>], target = <span class="hljs-number">2</span><br>è¾“å‡º: -<span class="hljs-number">1</span><br>è§£é‡Š: <span class="hljs-number">2</span> ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€ä½ å¯ä»¥å‡è®¾ nums ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯ä¸é‡å¤çš„ã€‚</p><p>2ã€n å°†åœ¨ [1, 10000]ä¹‹é—´ã€‚</p><p>3ã€nums çš„æ¯ä¸ªå…ƒç´ éƒ½å°†åœ¨ [-9999, 9999]ä¹‹é—´ã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>åœ¨å‡åºæ•°ç»„ nums ä¸­å¯»æ‰¾ç›®æ ‡å€¼ targetï¼Œå¯¹äºç‰¹å®šä¸‹æ ‡ iï¼Œæ¯”è¾ƒ nums[i] å’Œ target çš„å¤§å°ï¼š</p><blockquote><p>1ã€å¦‚æœ nums[i]&#x3D;targetï¼Œåˆ™ä¸‹æ ‡ i å³ä¸ºè¦å¯»æ‰¾çš„ä¸‹æ ‡ï¼›</p><p>2ã€å¦‚æœ nums[i]&gt;targetï¼Œåˆ™ target åªå¯èƒ½åœ¨ä¸‹æ ‡ i çš„å·¦ä¾§ï¼›</p><p>3ã€å¦‚æœ nums[i]&lt;targetï¼Œåˆ™ target åªå¯èƒ½åœ¨ä¸‹æ ‡ i çš„å³ä¾§ã€‚</p></blockquote><p>åŸºäºä¸Šè¿°äº‹å®ï¼Œå¯ä»¥åœ¨æœ‰åºæ•°ç»„ä¸­ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å¯»æ‰¾ç›®æ ‡å€¼ã€‚</p><p>äºŒåˆ†æŸ¥æ‰¾çš„åšæ³•æ˜¯ï¼Œå®šä¹‰æŸ¥æ‰¾çš„èŒƒå›´ [left,right]ï¼Œåˆå§‹æŸ¥æ‰¾èŒƒå›´æ˜¯æ•´ä¸ªæ•°ç»„ã€‚æ¯æ¬¡å–æŸ¥æ‰¾èŒƒå›´çš„ä¸­ç‚¹ midï¼Œæ¯”è¾ƒ nums[mid] å’Œ target çš„å¤§å°ï¼Œå¦‚æœç›¸ç­‰åˆ™ mid å³ä¸ºè¦å¯»æ‰¾çš„ä¸‹æ ‡ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™æ ¹æ® nums[mid] å’Œ target çš„å¤§å°å…³ç³»å°†æŸ¥æ‰¾èŒƒå›´ç¼©å°ä¸€åŠã€‚</p><p>ç”±äºæ¯æ¬¡æŸ¥æ‰¾éƒ½ä¼šå°†æŸ¥æ‰¾èŒƒå›´ç¼©å°ä¸€åŠï¼Œå› æ­¤äºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(logn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚</p><p>äºŒåˆ†æŸ¥æ‰¾çš„æ¡ä»¶æ˜¯æŸ¥æ‰¾èŒƒå›´ä¸ä¸ºç©ºï¼Œå³ leftâ‰¤rightã€‚å¦‚æœ target åœ¨æ•°ç»„ä¸­ï¼ŒäºŒåˆ†æŸ¥æ‰¾å¯ä»¥ä¿è¯æ‰¾åˆ° targetï¼Œè¿”å› target åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚å¦‚æœ target ä¸åœ¨æ•°ç»„ä¸­ï¼Œåˆ™å½“ left&gt;right æ—¶ç»“æŸæŸ¥æ‰¾ï¼Œè¿”å› âˆ’1ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = nums.length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (left &lt;= right) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (right - left) / <span class="hljs-number">2</span> + left;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> nums[mid];<br>            <span class="hljs-keyword">if</span> (num == target) &#123;<br>                <span class="hljs-keyword">return</span> mid;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num &gt; target) &#123;<br>                right = mid - <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                left = mid + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå…¶ä¸­Â nÂ æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œä»…ä½¿ç”¨å¸¸æ•°ä¸ªé¢å¤–çš„å˜é‡</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼ŒäºŒåˆ†æŸ¥æ‰¾æ˜¯ä¸€ç§é«˜æ•ˆçš„æŸ¥è¯¢æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å¤šçš„å»ä½¿ç”¨å®ƒ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå¹¶äºŒå‰æ ‘ï¼ˆä¸‰åï¼‰</title>
    <link href="/2022/09/03/A30-%E5%90%88%E5%B9%B6%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89/"/>
    <url>/2022/09/03/A30-%E5%90%88%E5%B9%B6%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%B8%89%E5%8D%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬å…­ç™¾ä¸€åä¸ƒé¢˜ï¼š<a href="https://leetcode.cn/problems/merge-two-binary-trees/description/">åˆå¹¶äºŒå‰æ ‘</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€ŒäºŒå‰æ ‘ã€ã€ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€ã€ã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ã€</p><p>ç»™ä½ ä¸¤æ£µäºŒå‰æ ‘ï¼š root1 å’Œ root2 ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ å°†å…¶ä¸­ä¸€æ£µè¦†ç›–åˆ°å¦ä¸€æ£µä¹‹ä¸Šæ—¶ï¼Œä¸¤æ£µæ ‘ä¸Šçš„ä¸€äº›èŠ‚ç‚¹å°†ä¼šé‡å ï¼ˆè€Œå¦ä¸€äº›ä¸ä¼šï¼‰ã€‚ä½ éœ€è¦å°†è¿™ä¸¤æ£µæ ‘åˆå¹¶æˆä¸€æ£µæ–°äºŒå‰æ ‘ã€‚åˆå¹¶çš„è§„åˆ™æ˜¯ï¼šå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹é‡å ï¼Œé‚£ä¹ˆå°†è¿™ä¸¤ä¸ªèŠ‚ç‚¹çš„å€¼ç›¸åŠ ä½œä¸ºåˆå¹¶åèŠ‚ç‚¹çš„æ–°å€¼ï¼›å¦åˆ™ï¼Œä¸ä¸º null çš„èŠ‚ç‚¹å°†ç›´æ¥ä½œä¸ºæ–°äºŒå‰æ ‘çš„èŠ‚ç‚¹ã€‚</p><p>è¿”å›åˆå¹¶åçš„äºŒå‰æ ‘ã€‚</p><p><strong>æ³¨æ„</strong>: åˆå¹¶è¿‡ç¨‹å¿…é¡»ä»ä¸¤ä¸ªæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f50fb4ffabaa444990f862dfa3a4763f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">root1</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>], <span class="hljs-attr">root2</span> = [<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">4</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">7</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">7</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šroot1 = <span class="hljs-comment">[1]</span>, root2 = <span class="hljs-comment">[1,2]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[2,2]</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€ä¸¤æ£µæ ‘ä¸­çš„èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ [0, 2000] å†…</p><p>2ã€-10^4 &lt;&#x3D; Node.val &lt;&#x3D; 10^4</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢"><a href="#æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢"></a>æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢</h3><p>å¯ä»¥ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢åˆå¹¶ä¸¤ä¸ªäºŒå‰æ ‘ã€‚ä»æ ¹èŠ‚ç‚¹å¼€å§‹åŒæ—¶éå†ä¸¤ä¸ªäºŒå‰æ ‘ï¼Œå¹¶å°†å¯¹åº”çš„èŠ‚ç‚¹è¿›è¡Œåˆå¹¶ã€‚</p><p>ä¸¤ä¸ªäºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹å¯èƒ½å­˜åœ¨ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼Œå¯¹äºæ¯ç§æƒ…å†µä½¿ç”¨ä¸åŒçš„åˆå¹¶æ–¹å¼ã€‚</p><blockquote><p>1ã€å¦‚æœä¸¤ä¸ªäºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹éƒ½ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹ä¹Ÿä¸ºç©ºï¼›</p><p>2ã€å¦‚æœä¸¤ä¸ªäºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹ä¸ºå…¶ä¸­çš„éç©ºèŠ‚ç‚¹ï¼›</p><p>3ã€å¦‚æœä¸¤ä¸ªäºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹çš„å€¼ä¸ºä¸¤ä¸ªäºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹çš„å€¼ä¹‹å’Œï¼Œ<br>æ­¤æ—¶éœ€è¦æ˜¾æ€§åˆå¹¶ä¸¤ä¸ªèŠ‚ç‚¹ã€‚</p></blockquote><p>å¯¹ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œåˆå¹¶ä¹‹åï¼Œè¿˜è¦å¯¹è¯¥èŠ‚ç‚¹çš„å·¦å³å­æ ‘åˆ†åˆ«è¿›è¡Œåˆå¹¶ã€‚è¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">mergeTrees</span><span class="hljs-params">(TreeNode root1, TreeNode root2)</span> &#123;<br>        <span class="hljs-keyword">if</span>(root1 == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> root2;<br>        <span class="hljs-keyword">if</span>(root2 == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> root1;<br><br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(root1.val + root2.val);<br>        root.left = mergeTrees(root1.left,root2.left);<br>        root.right = mergeTrees(root1.right,root2.right);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(min(m,n))ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«æ˜¯ä¸¤ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚å¯¹ä¸¤ä¸ªäºŒå‰æ ‘åŒæ—¶è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåªæœ‰å½“ä¸¤ä¸ªäºŒå‰æ ‘ä¸­çš„å¯¹åº”èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºæ—¶æ‰ä¼šå¯¹è¯¥èŠ‚ç‚¹è¿›è¡Œæ˜¾æ€§åˆå¹¶æ“ä½œï¼Œå› æ­¤è¢«è®¿é—®åˆ°çš„èŠ‚ç‚¹æ•°ä¸ä¼šè¶…è¿‡è¾ƒå°çš„äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(min(m,n))ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«æ˜¯ä¸¤ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚ç©ºé—´å¤æ‚åº¦å–å†³äºé€’å½’è°ƒç”¨çš„å±‚æ•°ï¼Œé€’å½’è°ƒç”¨çš„å±‚æ•°ä¸ä¼šè¶…è¿‡è¾ƒå°çš„äºŒå‰æ ‘çš„æœ€å¤§é«˜åº¦ï¼Œæœ€åæƒ…å†µä¸‹ï¼ŒäºŒå‰æ ‘çš„é«˜åº¦ç­‰äºèŠ‚ç‚¹æ•°ã€‚</p><h3 id="æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢"><a href="#æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢"></a>æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢</h3><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢åˆå¹¶ä¸¤ä¸ªäºŒå‰æ ‘ã€‚é¦–å…ˆåˆ¤æ–­ä¸¤ä¸ªäºŒå‰æ ‘æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸¤ä¸ªäºŒå‰æ ‘éƒ½ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘ä¹Ÿä¸ºç©ºï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªäºŒå‰æ ‘ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘ä¸ºå¦ä¸€ä¸ªéç©ºçš„äºŒå‰æ ‘ã€‚</p><p>å¦‚æœä¸¤ä¸ªäºŒå‰æ ‘éƒ½ä¸ä¸ºç©ºï¼Œåˆ™é¦–å…ˆè®¡ç®—åˆå¹¶åçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼Œç„¶åä»åˆå¹¶åçš„äºŒå‰æ ‘ä¸ä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹åŒæ—¶éå†æ¯ä¸ªäºŒå‰æ ‘ï¼Œå¹¶å°†å¯¹åº”çš„èŠ‚ç‚¹è¿›è¡Œåˆå¹¶ã€‚</p><p>ä½¿ç”¨ä¸‰ä¸ªé˜Ÿåˆ—åˆ†åˆ«å­˜å‚¨åˆå¹¶åçš„äºŒå‰æ ‘çš„èŠ‚ç‚¹ä»¥åŠä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„èŠ‚ç‚¹ã€‚åˆå§‹æ—¶å°†æ¯ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹åˆ†åˆ«åŠ å…¥ç›¸åº”çš„é˜Ÿåˆ—ã€‚æ¯æ¬¡ä»æ¯ä¸ªé˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ¤æ–­ä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºã€‚å¦‚æœä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„å½“å‰èŠ‚ç‚¹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å¯¹åº”èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¹Ÿä¸ä¸ºç©ºã€‚å¯¹äºå³å­èŠ‚ç‚¹åŒç†ã€‚</p><p>å¦‚æœåˆå¹¶åçš„äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™éœ€è¦æ ¹æ®ä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹è®¡ç®—åˆå¹¶åçš„äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹ä»¥åŠæ•´ä¸ªå·¦å­æ ‘ã€‚è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><blockquote><p>1ã€å¦‚æœä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹çš„å€¼ä¸ºä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹çš„&gt;å€¼ä¹‹å’Œï¼Œåœ¨åˆ›å»ºåˆå¹¶åçš„äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹ä¹‹åï¼Œå°†æ¯ä¸ªäºŒå‰æ ‘ä¸­çš„å·¦å­èŠ‚ç‚¹éƒ½åŠ å…¥ç›¸åº”çš„é˜Ÿåˆ—ï¼›</p><p>2ã€å¦‚æœä¸¤ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­èŠ‚ç‚¹æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œå³æœ‰ä¸€ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­æ ‘ä¸ºç©ºï¼Œåˆ™åˆå¹¶åçš„äºŒå‰æ ‘çš„å·¦å­æ ‘<br>å³ä¸ºå¦ä¸€ä¸ªåŸå§‹äºŒå‰æ ‘çš„å·¦å­æ ‘ï¼Œæ­¤æ—¶ä¹Ÿä¸éœ€è¦å¯¹éç©ºå·¦å­æ ‘ç»§ç»­éå†ï¼Œå› æ­¤ä¸éœ€è¦å°†å·¦å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—ã€‚</p></blockquote><p>å¯¹äºå³å­èŠ‚ç‚¹å’Œå³å­æ ‘ï¼Œå¤„ç†æ–¹æ³•ä¸å·¦å­èŠ‚ç‚¹å’Œå·¦å­æ ‘ç›¸åŒã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">mergeTrees</span><span class="hljs-params">(TreeNode t1, TreeNode t2)</span> &#123;<br>        <span class="hljs-keyword">if</span> (t1 == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> t2;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (t2 == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> t1;<br>        &#125;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">merged</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(t1.val + t2.val);<br>        Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;TreeNode&gt;();<br>        Queue&lt;TreeNode&gt; queue1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;TreeNode&gt;();<br>        Queue&lt;TreeNode&gt; queue2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;TreeNode&gt;();<br>        queue.offer(merged);<br>        queue1.offer(t1);<br>        queue2.offer(t2);<br>        <span class="hljs-keyword">while</span> (!queue1.isEmpty() &amp;&amp; !queue2.isEmpty()) &#123;<br>            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll(), node1 = queue1.poll(), node2 = queue2.poll();<br>            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left1</span> <span class="hljs-operator">=</span> node1.left, left2 = node2.left, right1 = node1.right, right2 = node2.right;<br>            <span class="hljs-keyword">if</span> (left1 != <span class="hljs-literal">null</span> || left2 != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (left1 != <span class="hljs-literal">null</span> &amp;&amp; left2 != <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(left1.val + left2.val);<br>                    node.left = left;<br>                    queue.offer(left);<br>                    queue1.offer(left1);<br>                    queue2.offer(left2);<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (left1 != <span class="hljs-literal">null</span>) &#123;<br>                    node.left = left1;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (left2 != <span class="hljs-literal">null</span>) &#123;<br>                    node.left = left2;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (right1 != <span class="hljs-literal">null</span> || right2 != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (right1 != <span class="hljs-literal">null</span> &amp;&amp; right2 != <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(right1.val + right2.val);<br>                    node.right = right;<br>                    queue.offer(right);<br>                    queue1.offer(right1);<br>                    queue2.offer(right2);<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (right1 != <span class="hljs-literal">null</span>) &#123;<br>                    node.right = right1;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    node.right = right2;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> merged;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(min(m,n))ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«æ˜¯ä¸¤ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚å¯¹ä¸¤ä¸ªäºŒå‰æ ‘åŒæ—¶è¿›è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œåªæœ‰å½“ä¸¤ä¸ªäºŒå‰æ ‘ä¸­çš„å¯¹åº”èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºæ—¶æ‰ä¼šè®¿é—®åˆ°è¯¥èŠ‚ç‚¹ï¼Œå› æ­¤è¢«è®¿é—®åˆ°çš„èŠ‚ç‚¹æ•°ä¸ä¼šè¶…è¿‡è¾ƒå°çš„äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(min(m,n))ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«æ˜¯ä¸¤ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚ç©ºé—´å¤æ‚åº¦å–å†³äºé˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ä¸ä¼šè¶…è¿‡è¾ƒå°çš„äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œè§£å†³äºŒå‰æ ‘ç›¸å…³çš„é—®é¢˜æ— éå°±é€’å½’å’Œè¿­ä»£ä¸¤ç§æ€æƒ³ï¼Œä¼˜å…ˆä½¿ç”¨é€’å½’ï¼Œå› ä¸ºä»–ä¼šè®©ä½ çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´ï¼Œå¦‚æœé€’å½’æƒ³ä¸å‡ºæ¥ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿­ä»£</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¿»è½¬äºŒå‰æ ‘ï¼ˆäºŒåä¹ï¼‰</title>
    <link href="/2022/09/02/A29-%E7%BF%BB%E8%BD%AC%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89/"/>
    <url>/2022/09/02/A29-%E7%BF%BB%E8%BD%AC%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B9%9D%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬äºŒç™¾äºŒåå…­é¢˜ï¼š<a href="https://leetcode.cn/problems/invert-binary-tree/description/">ç¿»è½¬äºŒå‰æ ‘</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€ŒäºŒå‰æ ‘ã€ã€ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€ã€ã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ã€</p><p>ç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œç¿»è½¬è¿™æ£µäºŒå‰æ ‘ï¼Œå¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f758587cc02148589bfa41c266226ee6~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼š root = <span class="hljs-string">[4,2,7,1,3,6,9]</span><br>è¾“å‡ºï¼š <span class="hljs-string">[4,7,2,9,6,3,1]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a2b879e003874f8788f8a70c570dcc69~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šroot = <span class="hljs-comment">[2,1,3]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[2,3,1]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼š root = <span class="hljs-comment">[]</span><br>è¾“å‡ºï¼š <span class="hljs-comment">[]</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®èŒƒå›´åœ¨Â <code>[0, 100]</code>Â å†…</p><p>2ã€<code>-100 &lt;= Node.val &lt;= 100</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>è¿™æ˜¯ä¸€é“å¾ˆç»å…¸çš„äºŒå‰æ ‘é—®é¢˜ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°å¯¹æ ‘è¿›è¡Œéå†ï¼Œå¹¶ä»å¶å­èŠ‚ç‚¹å…ˆå¼€å§‹ç¿»è½¬ã€‚å¦‚æœå½“å‰éå†åˆ°çš„èŠ‚ç‚¹ root çš„å·¦å³ä¸¤æ£µå­æ ‘éƒ½å·²ç»ç¿»è½¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦äº¤æ¢ä¸¤æ£µå­æ ‘çš„ä½ç½®ï¼Œå³å¯å®Œæˆä»¥ root ä¸ºæ ¹èŠ‚ç‚¹çš„æ•´æ£µå­æ ‘çš„ç¿»è½¬ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">invertTree</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> invertTree(root.left);<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> invertTree(root.right);<br>        root.left = right;<br>        root.right = left;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œå…¶ä¸­ N ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹çš„æ•°ç›®ã€‚æˆ‘ä»¬ä¼šéå†äºŒå‰æ ‘ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹è€Œè¨€ï¼Œæˆ‘ä»¬åœ¨å¸¸æ•°æ—¶é—´å†…äº¤æ¢å…¶ä¸¤æ£µå­æ ‘ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(N)ã€‚ä½¿ç”¨çš„ç©ºé—´ç”±é€’å½’æ ˆçš„æ·±åº¦å†³å®šï¼Œå®ƒç­‰äºå½“å‰èŠ‚ç‚¹åœ¨äºŒå‰æ ‘ä¸­çš„é«˜åº¦ã€‚åœ¨å¹³å‡æƒ…å†µä¸‹ï¼ŒäºŒå‰æ ‘çš„é«˜åº¦ä¸èŠ‚ç‚¹ä¸ªæ•°ä¸ºå¯¹æ•°å…³ç³»ï¼Œå³ O(logN)ã€‚è€Œåœ¨æœ€åæƒ…å†µä¸‹ï¼Œæ ‘å½¢æˆé“¾çŠ¶ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(N)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œä½¿ç”¨é€’å½’æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿçš„è§£å†³é—®é¢˜ã€‚å¦å¤–é€’å½’çš„æ ¸å¿ƒåœ¨äºï¼š</p><blockquote><p>1ã€ä¸€ä¸ªé—®é¢˜å¯ä»¥åˆ†è§£æˆå…·æœ‰ç›¸åŒè§£å†³æ€è·¯çš„å­é—®é¢˜ï¼Œå­å­é—®é¢˜ï¼Œæ¢å¥è¯è¯´è¿™äº›é—®é¢˜éƒ½èƒ½è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°</p><p>2ã€é€’å½’éœ€è¦æœ‰ä¸€ä¸ªç»ˆæ­¢æ¡ä»¶ï¼Œå¦‚æœæ²¡æœ‰çš„è¯,å°±æ— ç©·æ— å°½åœ°åˆ†è§£å­é—®é¢˜äº†ï¼Œé—®é¢˜æ˜¾ç„¶æ˜¯æ— è§£çš„ã€‚</p></blockquote><p>æ‰€ä»¥è§£é€’å½’é¢˜çš„å…³é”®åœ¨äºæˆ‘ä»¬é¦–å…ˆéœ€è¦æ ¹æ®ä»¥ä¸Šé€’å½’çš„ä¸¤ä¸ªç‰¹ç‚¹åˆ¤æ–­é¢˜ç›®æ˜¯å¦å¯ä»¥ç”¨é€’å½’æ¥è§£ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ï¼ˆäºŒåå…«ï¼‰</title>
    <link href="/2022/09/01/A28-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B7%B1%E5%BA%A6%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89/"/>
    <url>/2022/09/01/A28-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B7%B1%E5%BA%A6%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AB%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾é›¶å››é¢˜ï¼š<a href="https://leetcode.cn/problems/maximum-depth-of-binary-tree/">äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€ŒäºŒå‰æ ‘ã€ã€ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€ã€ã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ã€</p><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾å‡ºå…¶æœ€å¤§æ·±åº¦ã€‚</p><p>äºŒå‰æ ‘çš„æ·±åº¦ä¸ºæ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°ã€‚</p><p>è¯´æ˜: å¶å­èŠ‚ç‚¹æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7]ï¼Œ</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript">  <span class="hljs-number">3</span><br> / <span class="hljs-string">\</span><br><span class="hljs-number">9</span>  <span class="hljs-number">20</span><br>  /  <span class="hljs-string">\</span><br> <span class="hljs-number">15</span>   <span class="hljs-number">7</span><br></code></pre></td></tr></table></figure><p>è¿”å›å®ƒçš„æœ€å¤§æ·±åº¦ 3 ã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢"><a href="#æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢"></a>æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢</h3><p>å¦‚æœæˆ‘ä»¬çŸ¥é“äº†å·¦å­æ ‘å’Œå³å­æ ‘çš„æœ€å¤§æ·±åº¦ l å’Œ rï¼Œé‚£ä¹ˆè¯¥äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦å³ä¸ºï¼šmax(l,r)+1ã€‚</p><p>è€Œå·¦å­æ ‘å’Œå³å­æ ‘çš„æœ€å¤§æ·±åº¦åˆå¯ä»¥ä»¥åŒæ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ã€‚</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€çš„æ–¹æ³•æ¥è®¡ç®—äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‚</p><p>å…·ä½“è€Œè¨€ï¼Œåœ¨è®¡ç®—å½“å‰äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦æ—¶ï¼Œå¯ä»¥å…ˆé€’å½’è®¡ç®—å‡ºå…¶å·¦å­æ ‘å’Œå³å­æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œç„¶ååœ¨ O(1) æ—¶é—´å†…è®¡ç®—å‡ºå½“å‰äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‚é€’å½’åœ¨è®¿é—®åˆ°ç©ºèŠ‚ç‚¹æ—¶é€€å‡ºã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxDepth</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">maxL</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">maxR</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">if</span>(root.left != <span class="hljs-literal">null</span>)&#123;<br>            maxL = maxDepth(root.left);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(root.right != <span class="hljs-literal">null</span>)&#123;<br>            maxR = maxDepth(root.right);<br>        &#125;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> maxL &gt; maxR ? maxL + <span class="hljs-number">1</span> : maxR + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span> max;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚æ¯ä¸ªèŠ‚ç‚¹åœ¨é€’å½’ä¸­åªè¢«éå†ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(height)ï¼Œå…¶ä¸­ height è¡¨ç¤ºäºŒå‰æ ‘çš„é«˜åº¦ã€‚é€’å½’å‡½æ•°éœ€è¦æ ˆç©ºé—´ï¼Œè€Œæ ˆç©ºé—´å–å†³äºé€’å½’çš„æ·±åº¦ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ç­‰ä»·äºäºŒå‰æ ‘çš„é«˜åº¦ã€‚</p><h3 id="æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢"><a href="#æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢"></a>æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ã€çš„æ–¹æ³•æ¥è§£å†³è¿™é“é¢˜ç›®ï¼Œä½†æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œæ­¤æ—¶æˆ‘ä»¬å¹¿åº¦ä¼˜å…ˆæœç´¢çš„é˜Ÿåˆ—é‡Œå­˜æ”¾çš„æ˜¯ã€Œå½“å‰å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ã€ã€‚æ¯æ¬¡æ‹“å±•ä¸‹ä¸€å±‚çš„æ—¶å€™ï¼Œä¸åŒäºå¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ¯æ¬¡åªä»é˜Ÿåˆ—é‡Œæ‹¿å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°†é˜Ÿåˆ—é‡Œçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ‹¿å‡ºæ¥è¿›è¡Œæ‹“å±•ï¼Œè¿™æ ·èƒ½ä¿è¯æ¯æ¬¡æ‹“å±•å®Œçš„æ—¶å€™é˜Ÿåˆ—é‡Œå­˜æ”¾çš„æ˜¯å½“å‰å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå³æˆ‘ä»¬æ˜¯ä¸€å±‚ä¸€å±‚åœ°è¿›è¡Œæ‹“å±•ï¼Œæœ€åæˆ‘ä»¬ç”¨ä¸€ä¸ªå˜é‡ ans æ¥ç»´æŠ¤æ‹“å±•çš„æ¬¡æ•°ï¼Œè¯¥äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦å³ä¸º ansã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxDepth</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;TreeNode&gt;();<br>        queue.offer(root);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">ans</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> queue.size();<br>            <span class="hljs-keyword">while</span> (size &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>                <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>) &#123;<br>                    queue.offer(node.left);<br>                &#125;<br>                <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>) &#123;<br>                    queue.offer(node.right);<br>                &#125;<br>                size--;<br>            &#125;<br>            ans++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚ä¸æ–¹æ³•ä¸€åŒæ ·çš„åˆ†æï¼Œæ¯ä¸ªèŠ‚ç‚¹åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šæ­¤æ–¹æ³•ç©ºé—´çš„æ¶ˆè€—å–å†³äºé˜Ÿåˆ—å­˜å‚¨çš„å…ƒç´ æ•°é‡ï¼Œå…¶åœ¨æœ€åæƒ…å†µä¸‹ä¼šè¾¾åˆ° O(n)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼ˆé€’å½’ï¼‰å’Œå¹¿åº¦ä¼˜å…ˆéå†ï¼ˆè¿­ä»£ï¼‰ä¸¤ç§æ–¹å¼è¿›è¡Œäº†æ±‚è§£</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯¹ç§°äºŒå‰æ ‘ï¼ˆäºŒåä¸ƒï¼‰</title>
    <link href="/2022/08/31/A27-%E5%AF%B9%E7%A7%B0%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/"/>
    <url>/2022/08/31/A27-%E5%AF%B9%E7%A7%B0%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%83%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾é›¶ä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/symmetric-tree/">å¯¹ç§°äºŒå‰æ ‘</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€ŒäºŒå‰æ ‘ã€ã€ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€ã€ã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ã€</p><p>ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œ æ£€æŸ¥å®ƒæ˜¯å¦è½´å¯¹ç§°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9cdf3e10b6be49dcae34e384710957aa~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xquery">è¾“å…¥<span class="hljs-built_in">ï¼šroot</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>]<br>è¾“å‡º<span class="hljs-built_in">ï¼štrue</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2adabfa3dee041dd8039a8c115e39c80~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">root</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">3</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">3</span>]<br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ [1, 1000] å†…</p><p>2ã€-100 &lt;&#x3D; Node.val &lt;&#x3D; 100</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šé€’å½’"><a href="#æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ³•ä¸€ï¼šé€’å½’"></a>æ³•ä¸€ï¼šé€’å½’</h3><p>å¦‚æœä¸€ä¸ªæ ‘çš„å·¦å­æ ‘ä¸å³å­æ ‘é•œåƒå¯¹ç§°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ ‘æ˜¯å¯¹ç§°çš„ã€‚</p><p>å› æ­¤ï¼Œè¯¥é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼šä¸¤ä¸ªæ ‘åœ¨ä»€ä¹ˆæƒ…å†µä¸‹äº’ä¸ºé•œåƒï¼Ÿ</p><p>å¦‚æœåŒæ—¶æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶ï¼Œä¸¤ä¸ªæ ‘äº’ä¸ºé•œåƒï¼š</p><p>1ã€å®ƒä»¬çš„ä¸¤ä¸ªæ ¹ç»“ç‚¹å…·æœ‰ç›¸åŒçš„å€¼</p><p>2ã€æ¯ä¸ªæ ‘çš„å³å­æ ‘éƒ½ä¸å¦ä¸€ä¸ªæ ‘çš„å·¦å­æ ‘é•œåƒå¯¹ç§°</p><p>æˆ‘ä»¬å¯ä»¥å®ç°è¿™æ ·ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œé€šè¿‡ã€ŒåŒæ­¥ç§»åŠ¨ã€ä¸¤ä¸ªæŒ‡é’ˆçš„æ–¹æ³•æ¥éå†è¿™æ£µæ ‘ï¼Œp æŒ‡é’ˆå’Œ q æŒ‡é’ˆä¸€å¼€å§‹éƒ½æŒ‡å‘è¿™æ£µæ ‘çš„æ ¹ï¼Œéšå p å³ç§»æ—¶ï¼Œq å·¦ç§»ï¼Œp å·¦ç§»æ—¶ï¼Œq å³ç§»ã€‚æ¯æ¬¡æ£€æŸ¥å½“å‰ p å’Œ q èŠ‚ç‚¹çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰å†åˆ¤æ–­å·¦å³å­æ ‘æ˜¯å¦å¯¹ç§°ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isSymmetric</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">return</span> check(root, root);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check</span><span class="hljs-params">(TreeNode p, TreeNode q)</span> &#123;<br>        <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span> &amp;&amp; q == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span> || q == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> p.val == q.val &amp;&amp; check(p.left, q.right) &amp;&amp; check(p.right, q.left);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>å‡è®¾æ ‘ä¸Šä¸€å…± n ä¸ªèŠ‚ç‚¹ã€‚</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šè¿™é‡Œéå†äº†è¿™æ£µæ ‘ï¼Œæ¸è¿›æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šè¿™é‡Œçš„ç©ºé—´å¤æ‚åº¦å’Œé€’å½’ä½¿ç”¨çš„æ ˆç©ºé—´æœ‰å…³ï¼Œè¿™é‡Œé€’å½’å±‚æ•°ä¸è¶…è¿‡ nï¼Œæ•…æ¸è¿›ç©ºé—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><h3 id="æ³•äºŒï¼šè¿­ä»£"><a href="#æ³•äºŒï¼šè¿­ä»£" class="headerlink" title="æ³•äºŒï¼šè¿­ä»£"></a>æ³•äºŒï¼šè¿­ä»£</h3><p>ã€Œæ³•ä¸€ã€ä¸­æˆ‘ä»¬ç”¨é€’å½’çš„æ–¹æ³•å®ç°äº†å¯¹ç§°æ€§çš„åˆ¤æ–­ï¼Œé‚£ä¹ˆå¦‚ä½•ç”¨è¿­ä»£çš„æ–¹æ³•å®ç°å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™æ˜¯æŠŠé€’å½’ç¨‹åºæ”¹å†™æˆè¿­ä»£ç¨‹åºçš„å¸¸ç”¨æ–¹æ³•ã€‚åˆå§‹åŒ–æ—¶æˆ‘ä»¬æŠŠæ ¹èŠ‚ç‚¹å…¥é˜Ÿä¸¤æ¬¡ã€‚æ¯æ¬¡æå–ä¸¤ä¸ªç»“ç‚¹å¹¶æ¯”è¾ƒå®ƒä»¬çš„å€¼ï¼ˆé˜Ÿåˆ—ä¸­æ¯ä¸¤ä¸ªè¿ç»­çš„ç»“ç‚¹åº”è¯¥æ˜¯ç›¸ç­‰çš„ï¼Œè€Œä¸”å®ƒä»¬çš„å­æ ‘äº’ä¸ºé•œåƒï¼‰ï¼Œç„¶åå°†ä¸¤ä¸ªç»“ç‚¹çš„å·¦å³å­ç»“ç‚¹æŒ‰ç›¸åçš„é¡ºåºæ’å…¥é˜Ÿåˆ—ä¸­ã€‚å½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œæˆ–è€…æˆ‘ä»¬æ£€æµ‹åˆ°æ ‘ä¸å¯¹ç§°ï¼ˆå³ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸¤ä¸ªä¸ç›¸ç­‰çš„è¿ç»­ç»“ç‚¹ï¼‰æ—¶ï¼Œè¯¥ç®—æ³•ç»“æŸã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isSymmetric</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">return</span> check(root, root);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check</span><span class="hljs-params">(TreeNode u, TreeNode v)</span> &#123;<br>        Queue&lt;TreeNode&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;TreeNode&gt;();<br>        q.offer(u);<br>        q.offer(v);<br>        <span class="hljs-keyword">while</span> (!q.isEmpty()) &#123;<br>            u = q.poll();<br>            v = q.poll();<br>            <span class="hljs-keyword">if</span> (u == <span class="hljs-literal">null</span> &amp;&amp; v == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> ((u == <span class="hljs-literal">null</span> || v == <span class="hljs-literal">null</span>) || (u.val != v.val)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            q.offer(u.left);<br>            q.offer(v.right);<br><br>            q.offer(u.right);<br>            q.offer(v.left);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æ</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼ŒåŒã€Œæ³•ä¸€ã€ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šè¿™é‡Œéœ€è¦ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥ç»´æŠ¤èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šè¿›é˜Ÿä¸€æ¬¡ï¼Œå‡ºé˜Ÿä¸€æ¬¡ï¼Œé˜Ÿåˆ—ä¸­æœ€å¤šä¸ä¼šè¶…è¿‡ n ä¸ªç‚¹ï¼Œæ•…æ¸è¿›ç©ºé—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨é€’å½’å’Œè¿­ä»£ä¸¤ç§æ–¹å¼è¿›è¡Œäº†å®ç°</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ï¼ˆäºŒåå…­ï¼‰</title>
    <link href="/2022/08/30/A26-K%20%E4%B8%AA%E4%B8%80%E7%BB%84%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/"/>
    <url>/2022/08/30/A26-K%20%E4%B8%AA%E4%B8%80%E7%BB%84%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8%EF%BC%88%E4%BA%8C%E5%8D%81%E5%85%AD%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬äºŒç™¾ä¸‰åå››é¢˜ï¼š<a href="https://leetcode.cn/problems/reverse-nodes-in-k-group/">K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>å›°éš¾</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€</p><p>ç»™ä½ é“¾è¡¨çš„å¤´èŠ‚ç‚¹ head ï¼Œæ¯ k ä¸ªèŠ‚ç‚¹ä¸€ç»„è¿›è¡Œç¿»è½¬ï¼Œè¯·ä½ è¿”å›ä¿®æ”¹åçš„é“¾è¡¨ã€‚</p><p>k æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå®ƒçš„å€¼å°äºæˆ–ç­‰äºé“¾è¡¨çš„é•¿åº¦ã€‚å¦‚æœèŠ‚ç‚¹æ€»æ•°ä¸æ˜¯ k çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆè¯·å°†æœ€åå‰©ä½™çš„èŠ‚ç‚¹ä¿æŒåŸæœ‰é¡ºåºã€‚</p><p>ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe9ad60be9234ef0b68b3be7a303572a~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šhead = <span class="hljs-string">[1,2,3,4,5]</span>, k = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š<span class="hljs-string">[2,1,4,3,5]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b20b6dbce174f0db7a96bb0e2d14351~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šhead = <span class="hljs-string">[1,2,3,4,5]</span>, k = <span class="hljs-number">3</span><br>è¾“å‡ºï¼š<span class="hljs-string">[3,2,1,4,5]</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ç›®ä¸º n</p><p>2ã€1 &lt;&#x3D; k &lt;&#x3D; n &lt;&#x3D; 5000</p><p>3ã€0 &lt;&#x3D; Node.val &lt;&#x3D; 1000</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ã€é“¾è¡¨åˆ†åŒºä¸ºå·²ç¿»è½¬éƒ¨åˆ†+å¾…ç¿»è½¬éƒ¨åˆ†+æœªç¿»è½¬éƒ¨åˆ†</p><p>2ã€æ¯æ¬¡ç¿»è½¬å‰ï¼Œè¦ç¡®å®šç¿»è½¬é“¾è¡¨çš„èŒƒå›´ï¼Œè¿™ä¸ªå¿…é¡»é€šè¿‡ k æ­¤å¾ªç¯æ¥ç¡®å®š</p><p>3ã€éœ€è®°å½•ç¿»è½¬é“¾è¡¨å‰é©±å’Œåç»§ï¼Œæ–¹ä¾¿ç¿»è½¬å®ŒæˆåæŠŠå·²ç¿»è½¬éƒ¨åˆ†å’Œæœªç¿»è½¬éƒ¨åˆ†è¿æ¥èµ·æ¥</p><p>4ã€åˆå§‹éœ€è¦ä¸¤ä¸ªå˜é‡ pre å’Œ endï¼Œpre ä»£è¡¨å¾…ç¿»è½¬é“¾è¡¨çš„å‰é©±ï¼Œend ä»£è¡¨å¾…ç¿»è½¬é“¾è¡¨çš„æœ«å°¾</p><p>5ã€ç»è¿‡kæ­¤å¾ªç¯ï¼Œend åˆ°è¾¾æœ«å°¾ï¼Œè®°å½•å¾…ç¿»è½¬é“¾è¡¨çš„åç»§ next &#x3D; end.next</p><p>6ã€ç¿»è½¬é“¾è¡¨ï¼Œç„¶åå°†ä¸‰éƒ¨åˆ†é“¾è¡¨è¿æ¥èµ·æ¥ï¼Œç„¶åé‡ç½® pre å’Œ end æŒ‡é’ˆï¼Œç„¶åè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯</p><p>7ã€ç‰¹æ®Šæƒ…å†µï¼Œå½“ç¿»è½¬éƒ¨åˆ†é•¿åº¦ä¸è¶³ k æ—¶ï¼Œåœ¨å®šä½ end å®Œæˆåï¼Œend&#x3D;&#x3D;nullï¼Œå·²ç»åˆ°è¾¾æœ«å°¾ï¼Œè¯´æ˜é¢˜ç›®å·²å®Œæˆï¼Œç›´æ¥è¿”å›å³å¯</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4a32dc5892940eca33f350c83064605~tplv-k3u1fbpfcp-watermark.image?" alt="iShot_2023-02-18_11.51.45.png" width="50%" /><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">reverseKGroup</span><span class="hljs-params">(ListNode head, <span class="hljs-type">int</span> k)</span> &#123;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">hair</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);<br>        hair.next = head;<br><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> hair;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> hair;<br><br>        <span class="hljs-keyword">while</span>(end.next != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; k &amp;&amp; end != <span class="hljs-literal">null</span>; i++)&#123;<br>                end = end.next;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(end == <span class="hljs-literal">null</span>)<span class="hljs-keyword">break</span>;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> pre.next;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> end.next;<br>            end.next = <span class="hljs-literal">null</span>;<br>            pre.next = reverse(start);<br>            start.next = next;<br><br>            pre = start;<br>            end = start;<br>        &#125;<br>        <span class="hljs-keyword">return</span> hair.next;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> ListNode <span class="hljs-title function_">reverse</span><span class="hljs-params">(ListNode node)</span>&#123;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">curr</span> <span class="hljs-operator">=</span> node;<br>        <span class="hljs-keyword">while</span>(curr != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> curr.next;<br>            curr.next = pre;<br>            pre = curr;<br>            curr = next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> pre;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼š O(n^K)ï¼Œæœ€å¥½çš„æƒ…å†µä¸º O(n) æœ€å·®çš„æƒ…å†µæœª O(n^2)</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼š O(1)ï¼Œé™¤äº†å‡ ä¸ªå¿…é¡»çš„èŠ‚ç‚¹æŒ‡é’ˆå¤–ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å ç”¨å…¶ä»–ç©ºé—´</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºå›°éš¾ï¼Œä¸€ä¸ªæ¸…æ™°çš„æ€è·¯å¾ˆé‡è¦ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›æ–‡é“¾è¡¨ï¼ˆäºŒåäº”ï¼‰</title>
    <link href="/2022/08/29/A25-%E5%9B%9E%E6%96%87%E9%93%BE%E8%A1%A8%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/"/>
    <url>/2022/08/29/A25-%E5%9B%9E%E6%96%87%E9%93%BE%E8%A1%A8%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬äºŒç™¾ä¸‰åå››é¢˜ï¼š<a href="https://leetcode.cn/problems/palindrome-linked-list/">å›æ–‡é“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™ä½ ä¸€ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ head ï¼Œè¯·ä½ åˆ¤æ–­è¯¥é“¾è¡¨æ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨ã€‚å¦‚æœæ˜¯ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/100941d55fb54c19a54e83a03e476e3a~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š<span class="hljs-built_in">head</span> = [1,2,2,1]<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4229a9f8aa77453da81a6ec09f4b8a99~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š<span class="hljs-built_in">head</span> = [1,2]<br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€é“¾è¡¨ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´[1, 10^5] å†…</p><p>2ã€0 &lt;&#x3D; Node.val &lt;&#x3D; 9</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æ€è·¯ï¼š</p><p>æˆ‘ä»¬å¯ä»¥å°†é“¾è¡¨çš„ååŠéƒ¨åˆ†åè½¬ï¼ˆä¿®æ”¹é“¾è¡¨ç»“æ„ï¼‰ï¼Œç„¶åå°†å‰åŠéƒ¨åˆ†å’ŒååŠéƒ¨åˆ†è¿›è¡Œæ¯”è¾ƒã€‚æ¯”è¾ƒå®Œæˆåæˆ‘ä»¬åº”è¯¥å°†é“¾è¡¨æ¢å¤åŸæ ·ã€‚è™½ç„¶ä¸éœ€è¦æ¢å¤ä¹Ÿèƒ½é€šè¿‡æµ‹è¯•ç”¨ä¾‹ï¼Œä½†æ˜¯ä½¿ç”¨è¯¥å‡½æ•°çš„äººé€šå¸¸ä¸å¸Œæœ›é“¾è¡¨ç»“æ„è¢«æ›´æ”¹ã€‚</p><p>è¯¥æ–¹æ³•è™½ç„¶å¯ä»¥å°†ç©ºé—´å¤æ‚åº¦é™åˆ° O(1)ï¼Œä½†æ˜¯åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œè¯¥æ–¹æ³•ä¹Ÿæœ‰ç¼ºç‚¹ã€‚åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå‡½æ•°è¿è¡Œæ—¶éœ€è¦é”å®šå…¶ä»–çº¿ç¨‹æˆ–è¿›ç¨‹å¯¹é“¾è¡¨çš„è®¿é—®ï¼Œå› ä¸ºåœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­é“¾è¡¨ä¼šè¢«ä¿®æ”¹ã€‚</p><p>æ•´ä¸ªæµç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹äº”ä¸ªæ­¥éª¤ï¼š</p><blockquote><p>1ã€æ‰¾åˆ°å‰åŠéƒ¨åˆ†é“¾è¡¨çš„å°¾èŠ‚ç‚¹ã€‚</p><p>2ã€åè½¬ååŠéƒ¨åˆ†é“¾è¡¨ã€‚</p><p>3ã€åˆ¤æ–­æ˜¯å¦å›æ–‡ã€‚</p><p>4ã€æ¢å¤é“¾è¡¨ã€‚</p><p>5ã€è¿”å›ç»“æœã€‚</p></blockquote><p>æ‰§è¡Œæ­¥éª¤ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—é“¾è¡¨èŠ‚ç‚¹çš„æ•°é‡ï¼Œç„¶åéå†é“¾è¡¨æ‰¾åˆ°å‰åŠéƒ¨åˆ†çš„å°¾èŠ‚ç‚¹ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆåœ¨ä¸€æ¬¡éå†ä¸­æ‰¾åˆ°ï¼šæ…¢æŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œå¿«æ…¢æŒ‡é’ˆåŒæ—¶å‡ºå‘ã€‚å½“å¿«æŒ‡é’ˆç§»åŠ¨åˆ°é“¾è¡¨çš„æœ«å°¾æ—¶ï¼Œæ…¢æŒ‡é’ˆæ°å¥½åˆ°é“¾è¡¨çš„ä¸­é—´ã€‚é€šè¿‡æ…¢æŒ‡é’ˆå°†é“¾è¡¨åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚</p><p>è‹¥é“¾è¡¨æœ‰å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ä¸­é—´çš„èŠ‚ç‚¹åº”è¯¥çœ‹ä½œæ˜¯å‰åŠéƒ¨åˆ†ã€‚</p><p>æ­¥éª¤äºŒå¯ä»¥ä½¿ç”¨åè½¬é“¾è¡¨æ¥åè½¬é“¾è¡¨çš„ååŠéƒ¨åˆ†ã€‚</p><p>æ­¥éª¤ä¸‰æ¯”è¾ƒä¸¤ä¸ªéƒ¨åˆ†çš„å€¼ï¼Œå½“ååŠéƒ¨åˆ†åˆ°è¾¾æœ«å°¾åˆ™æ¯”è¾ƒå®Œæˆï¼Œå¯ä»¥å¿½ç•¥è®¡æ•°æƒ…å†µä¸­çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p><p>æ­¥éª¤å››ä¸æ­¥éª¤äºŒä½¿ç”¨çš„å‡½æ•°ç›¸åŒï¼Œå†åè½¬ä¸€æ¬¡æ¢å¤é“¾è¡¨æœ¬èº«ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPalindrome</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// æ‰¾åˆ°å‰åŠéƒ¨åˆ†é“¾è¡¨çš„å°¾èŠ‚ç‚¹å¹¶åè½¬ååŠéƒ¨åˆ†é“¾è¡¨</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">firstHalfEnd</span> <span class="hljs-operator">=</span> endOfFirstHalf(head);<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">secondHalfStart</span> <span class="hljs-operator">=</span> reverseList(firstHalfEnd.next);<br><br>        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å›æ–‡</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">p1</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">p2</span> <span class="hljs-operator">=</span> secondHalfStart;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">while</span> (result &amp;&amp; p2 != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (p1.val != p2.val) &#123;<br>                result = <span class="hljs-literal">false</span>;<br>            &#125;<br>            p1 = p1.next;<br>            p2 = p2.next;<br>        &#125;        <br><br>        <span class="hljs-comment">// è¿˜åŸé“¾è¡¨å¹¶è¿”å›ç»“æœ</span><br>        firstHalfEnd.next = reverseList(secondHalfStart);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> ListNode <span class="hljs-title function_">reverseList</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">curr</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">while</span> (curr != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">nextTemp</span> <span class="hljs-operator">=</span> curr.next;<br>            curr.next = prev;<br>            prev = curr;<br>            curr = nextTemp;<br>        &#125;<br>        <span class="hljs-keyword">return</span> prev;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> ListNode <span class="hljs-title function_">endOfFirstHalf</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">fast</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">slow</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">while</span> (fast.next != <span class="hljs-literal">null</span> &amp;&amp; fast.next.next != <span class="hljs-literal">null</span>) &#123;<br>            fast = fast.next.next;<br>            slow = slow.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> slow;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æŒ‡çš„æ˜¯é“¾è¡¨çš„å¤§å°ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚æˆ‘ä»¬åªä¼šä¿®æ”¹åŸæœ¬é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æŒ‡å‘ï¼Œè€Œåœ¨å †æ ˆä¸Šçš„å †æ ˆå¸§ä¸è¶…è¿‡ O(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œå¦‚æœå¯¹é“¾è¡¨ä¸ç†Ÿæ‚‰ï¼Œé‚£å®ç°èµ·æ¥ä¼šç›¸å½“å›°éš¾ï¼Œå› æ­¤æˆ‘ä»¬è¦å…ˆå¯¹é“¾è¡¨æœ‰è¶³å¤Ÿçš„ç†Ÿæ‚‰ï¼ŒæŒæ¡é“¾è¡¨ä¸€äº›å¸¸è§åŸºç¡€çš„ç®—æ³•å¦‚ï¼šåè½¬é“¾è¡¨ï¼Œå¿«æ…¢æŒ‡é’ˆã€‚ç„¶åæ³¨æ„ç»†èŠ‚ï¼Œæ¯ä¸€æ­¥æ€è·¯éƒ½è¦å¾ˆæ¸…æ™°ï¼Œæ–¹èƒ½è§£å†³æ­¤éœ€æ±‚ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”µè¯å·ç çš„å­—æ¯ç»„åˆï¼ˆäºŒåå››ï¼‰</title>
    <link href="/2022/08/28/A24-%E7%94%B5%E8%AF%9D%E5%8F%B7%E7%A0%81%E7%9A%84%E5%AD%97%E6%AF%8D%E7%BB%84%E5%90%88%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89/"/>
    <url>/2022/08/28/A24-%E7%94%B5%E8%AF%9D%E5%8F%B7%E7%A0%81%E7%9A%84%E5%AD%97%E6%AF%8D%E7%BB%84%E5%90%88%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬åä¸ƒé¢˜ï¼š<a href="https://leetcode.cn/problems/letter-combinations-of-a-phone-number/">ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œå­—ç¬¦ä¸²ã€ã€ã€Œå›æº¯ã€</p><p>ç»™å®šä¸€ä¸ªä»…åŒ…å«æ•°å­— 2-9 çš„å­—ç¬¦ä¸²ï¼Œè¿”å›æ‰€æœ‰å®ƒèƒ½è¡¨ç¤ºçš„å­—æ¯ç»„åˆã€‚ç­”æ¡ˆå¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ã€‚</p><p>ç»™å‡ºæ•°å­—åˆ°å­—æ¯çš„æ˜ å°„å¦‚ä¸‹ï¼ˆä¸ç”µè¯æŒ‰é”®ç›¸åŒï¼‰ã€‚æ³¨æ„ 1 ä¸å¯¹åº”ä»»ä½•å­—æ¯ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2eee729a2e9c40988352b1621c80f6cb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">è¾“å…¥ï¼š<span class="hljs-keyword">digits</span> = <span class="hljs-string">&quot;23&quot;</span><br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;ad&quot;</span>,<span class="hljs-string">&quot;ae&quot;</span>,<span class="hljs-string">&quot;af&quot;</span>,<span class="hljs-string">&quot;bd&quot;</span>,<span class="hljs-string">&quot;be&quot;</span>,<span class="hljs-string">&quot;bf&quot;</span>,<span class="hljs-string">&quot;cd&quot;</span>,<span class="hljs-string">&quot;ce&quot;</span>,<span class="hljs-string">&quot;cf&quot;</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šdigits <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><br>è¾“å‡ºï¼š[]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">è¾“å…¥ï¼š<span class="hljs-keyword">digits</span> = <span class="hljs-string">&quot;2&quot;</span><br>è¾“å‡ºï¼š[<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; digits.length &lt;&#x3D; 4</p><p>2ã€digits[i] æ˜¯èŒƒå›´ [â€˜2â€™, â€˜9â€™] çš„ä¸€ä¸ªæ•°å­—ã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>é¦–å…ˆä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨æ¯ä¸ªæ•°å­—å¯¹åº”çš„æ‰€æœ‰å¯èƒ½çš„å­—æ¯ï¼Œç„¶åè¿›è¡Œå›æº¯æ“ä½œã€‚</p><p>å›æº¯è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå·²æœ‰çš„å­—æ¯æ’åˆ—ï¼ˆå¦‚æœæœªéå†å®Œç”µè¯å·ç çš„æ‰€æœ‰æ•°å­—ï¼Œåˆ™å·²æœ‰çš„å­—æ¯æ’åˆ—æ˜¯ä¸å®Œæ•´çš„ï¼‰ã€‚è¯¥å­—ç¬¦ä¸²åˆå§‹ä¸ºç©ºã€‚æ¯æ¬¡å–ç”µè¯å·ç çš„ä¸€ä½æ•°å­—ï¼Œä»å“ˆå¸Œè¡¨ä¸­è·å¾—è¯¥æ•°å­—å¯¹åº”çš„æ‰€æœ‰å¯èƒ½çš„å­—æ¯ï¼Œå¹¶å°†å…¶ä¸­çš„ä¸€ä¸ªå­—æ¯æ’å…¥åˆ°å·²æœ‰çš„å­—æ¯æ’åˆ—åé¢ï¼Œç„¶åç»§ç»­å¤„ç†ç”µè¯å·ç çš„åä¸€ä½æ•°å­—ï¼Œç›´åˆ°å¤„ç†å®Œç”µè¯å·ç ä¸­çš„æ‰€æœ‰æ•°å­—ï¼Œå³å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„å­—æ¯æ’åˆ—ã€‚ç„¶åè¿›è¡Œå›é€€æ“ä½œï¼Œéå†å…¶ä½™çš„å­—æ¯æ’åˆ—ã€‚</p><p>å›æº¯ç®—æ³•ç”¨äºå¯»æ‰¾æ‰€æœ‰çš„å¯è¡Œè§£ï¼Œå¦‚æœå‘ç°ä¸€ä¸ªè§£ä¸å¯è¡Œï¼Œåˆ™ä¼šèˆå¼ƒä¸å¯è¡Œçš„è§£ã€‚åœ¨è¿™é“é¢˜ä¸­ï¼Œç”±äºæ¯ä¸ªæ•°å­—å¯¹åº”çš„æ¯ä¸ªå­—æ¯éƒ½å¯èƒ½è¿›å…¥å­—æ¯ç»„åˆï¼Œå› æ­¤ä¸å­˜åœ¨ä¸å¯è¡Œçš„è§£ï¼Œç›´æ¥ç©·ä¸¾æ‰€æœ‰çš„è§£å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">letterCombinations</span><span class="hljs-params">(String digits)</span> &#123;<br>        List&lt;String&gt; combinations = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>        <span class="hljs-keyword">if</span> (digits.length() == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> combinations;<br>        &#125;<br>        Map&lt;Character, String&gt; phoneMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Character, String&gt;() &#123;&#123;<br>            put(<span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&quot;abc&quot;</span>);<br>            put(<span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&quot;def&quot;</span>);<br>            put(<span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&quot;ghi&quot;</span>);<br>            put(<span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&quot;jkl&quot;</span>);<br>            put(<span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&quot;mno&quot;</span>);<br>            put(<span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&quot;pqrs&quot;</span>);<br>            put(<span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&quot;tuv&quot;</span>);<br>            put(<span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&quot;wxyz&quot;</span>);<br>        &#125;&#125;;<br>        backtrack(combinations, phoneMap, digits, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>());<br>        <span class="hljs-keyword">return</span> combinations;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrack</span><span class="hljs-params">(List&lt;String&gt; combinations, Map&lt;Character, String&gt; phoneMap, String digits, <span class="hljs-type">int</span> index, StringBuffer combination)</span> &#123;<br>        <span class="hljs-keyword">if</span> (index == digits.length()) &#123;<br>            combinations.add(combination.toString());<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">digit</span> <span class="hljs-operator">=</span> digits.charAt(index);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">letters</span> <span class="hljs-operator">=</span> phoneMap.get(digit);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">lettersCount</span> <span class="hljs-operator">=</span> letters.length();<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; lettersCount; i++) &#123;<br>                combination.append(letters.charAt(i));<br>                backtrack(combinations, phoneMap, digits, index + <span class="hljs-number">1</span>, combination);<br>                combination.deleteCharAt(index);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(3^m Ã— 4^n)ï¼Œå…¶ä¸­ m æ˜¯è¾“å…¥ä¸­å¯¹åº” 3 ä¸ªå­—æ¯çš„æ•°å­—ä¸ªæ•°ï¼ˆåŒ…æ‹¬æ•°å­— 2ã€3ã€4ã€5ã€6ã€8ï¼‰ï¼Œn æ˜¯è¾“å…¥ä¸­å¯¹åº” 4 ä¸ªå­—æ¯çš„æ•°å­—ä¸ªæ•°ï¼ˆåŒ…æ‹¬æ•°å­— 7ã€9ï¼‰ï¼Œm+n æ˜¯è¾“å…¥æ•°å­—çš„æ€»ä¸ªæ•°ã€‚å½“è¾“å…¥åŒ…å« m ä¸ªå¯¹åº” 3 ä¸ªå­—æ¯çš„æ•°å­—å’Œ n ä¸ªå¯¹åº” 4 ä¸ªå­—æ¯çš„æ•°å­—æ—¶ï¼Œä¸åŒçš„å­—æ¯ç»„åˆä¸€å…±æœ‰ 3^mÃ—4^n ç§ï¼Œéœ€è¦éå†æ¯ä¸€ç§å­—æ¯ç»„åˆã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(m+n)ï¼Œå…¶ä¸­ m æ˜¯è¾“å…¥ä¸­å¯¹åº” 3 ä¸ªå­—æ¯çš„æ•°å­—ä¸ªæ•°ï¼Œn æ˜¯è¾“å…¥ä¸­å¯¹åº” 4 ä¸ªå­—æ¯çš„æ•°å­—ä¸ªæ•°ï¼Œm+n æ˜¯è¾“å…¥æ•°å­—çš„æ€»ä¸ªæ•°ã€‚é™¤äº†è¿”å›å€¼ä»¥å¤–ï¼Œç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºå“ˆå¸Œè¡¨ä»¥åŠå›æº¯è¿‡ç¨‹ä¸­çš„é€’å½’è°ƒç”¨å±‚æ•°ï¼Œå“ˆå¸Œè¡¨çš„å¤§å°ä¸è¾“å…¥æ— å…³ï¼Œå¯ä»¥çœ‹æˆå¸¸æ•°ï¼Œé€’å½’è°ƒç”¨å±‚æ•°æœ€å¤§ä¸º m+nã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å“ˆå¸Œè¡¨+å›æº¯çš„æ–¹å¼è§£å†³äº†æ­¤éœ€æ±‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‰æ˜è·ç¦»ï¼ˆäºŒåä¸‰ï¼‰</title>
    <link href="/2022/08/27/A23-%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%89%EF%BC%89/"/>
    <url>/2022/08/27/A23-%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ±‰æ˜è·ç¦»å¹¿æ³›åº”ç”¨äºå¤šä¸ªé¢†åŸŸã€‚åœ¨ç¼–ç ç†è®ºä¸­ç”¨äºé”™è¯¯æ£€æµ‹ï¼Œåœ¨ä¿¡æ¯è®ºä¸­é‡åŒ–å­—ç¬¦ä¸²ä¹‹é—´çš„å·®å¼‚ã€‚<br>ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„æ±‰æ˜è·ç¦»æ˜¯å¯¹åº”ä½ç½®ä¸Šæ•°å­—ä¸åŒçš„ä½æ•°ã€‚</p><p>æ ¹æ®ä»¥ä¸Šå®šä¹‰ï¼Œæˆ‘ä»¬ä½¿ç”¨å¼‚æˆ–è¿ç®—ï¼Œè®°ä¸º ^ï¼Œå½“ä¸”ä»…å½“è¾“å…¥ä½ä¸åŒæ—¶è¾“å‡ºä¸º 1</p><p>è®¡ç®— x å’Œ y ä¹‹é—´çš„æ±‰æ˜è·ç¦»ï¼Œå¯ä»¥å…ˆè®¡ç®— x ^ yï¼Œç„¶åç»Ÿè®¡ç»“æœä¸­ç­‰äº 1 çš„ä½æ•°ã€‚</p><h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬å››ç™¾å…­åä¸€é¢˜é¢˜ï¼š<a href="https://leetcode.cn/problems/hamming-distance/">æ±‰æ˜è·ç¦»</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œä½è¿ç®—ã€</p><p>ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„Â <a href="https://baike.baidu.com/item/%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB">æ±‰æ˜è·ç¦»</a>Â æŒ‡çš„æ˜¯è¿™ä¸¤ä¸ªæ•°å­—å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®çš„æ•°ç›®ã€‚</p><p>ç»™ä½ ä¸¤ä¸ªæ•´æ•°Â <code>x</code>Â å’ŒÂ <code>y</code>ï¼Œè®¡ç®—å¹¶è¿”å›å®ƒä»¬ä¹‹é—´çš„æ±‰æ˜è·ç¦»ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šx = <span class="hljs-number">1</span>, y = <span class="hljs-number">4</span><br>è¾“å‡ºï¼š<span class="hljs-number">2</span><br>è§£é‡Šï¼š<br><span class="hljs-number">1</span>   (<span class="hljs-number">0 0 0 1</span>)<br><span class="hljs-number">4</span>   (<span class="hljs-number">0 1 0 0</span>)<br>       â†‘   â†‘<br>ä¸Šé¢çš„ç®­å¤´æŒ‡å‡ºäº†å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fix"><span class="hljs-attr">è¾“å…¥ï¼šx </span>=<span class="hljs-string"> 3, y = 1</span><br><span class="hljs-string">è¾“å‡ºï¼š1</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; x, y &lt;&#x3D; 2^31 - 1</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šå†…ç½®ä½è®¡æ•°åŠŸèƒ½"><a href="#æ³•ä¸€ï¼šå†…ç½®ä½è®¡æ•°åŠŸèƒ½" class="headerlink" title="æ³•ä¸€ï¼šå†…ç½®ä½è®¡æ•°åŠŸèƒ½"></a>æ³•ä¸€ï¼šå†…ç½®ä½è®¡æ•°åŠŸèƒ½</h3><p>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½å†…ç½®äº†è®¡ç®—äºŒè¿›åˆ¶è¡¨è¾¾ä¸­ 111 çš„æ•°é‡çš„å‡½æ•°ã€‚åœ¨å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ç›´æ¥ä½¿ç”¨å†…ç½®å‡½æ•°</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hammingDistance</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> &#123;<br>        <span class="hljs-keyword">return</span> Integer.bitCount(x ^ y);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(1)ã€‚ä¸åŒè¯­è¨€çš„å®ç°æ–¹æ³•ä¸ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥è¿‘ä¼¼è®¤ä¸ºå…¶æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><h3 id="æ³•äºŒï¼šç§»ä½å®ç°ä½è®¡æ•°"><a href="#æ³•äºŒï¼šç§»ä½å®ç°ä½è®¡æ•°" class="headerlink" title="æ³•äºŒï¼šç§»ä½å®ç°ä½è®¡æ•°"></a>æ³•äºŒï¼šç§»ä½å®ç°ä½è®¡æ•°</h3><p>åœ¨é”»ç‚¼ç®—æ³•èƒ½åŠ›æ—¶ï¼Œé‡å¤é€ è½®å­æ˜¯ä¸å¯é¿å…çš„ï¼Œä¹Ÿæ˜¯åº”å½“çš„ã€‚å› æ­¤è¯»è€…ä»¬ä¹Ÿéœ€è¦å°è¯•ä½¿ç”¨å„ç§æ–¹æ³•è‡ªå·±å®ç°å‡ ä¸ªå…·æœ‰ä½è®¡æ•°åŠŸèƒ½çš„å‡½æ•°ã€‚æœ¬æ–¹æ³•å°†ä½¿ç”¨ä½è¿ç®—ä¸­ç§»ä½çš„æ“ä½œå®ç°ä½è®¡æ•°åŠŸèƒ½ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/73396d4f1b154ef4a4c0bacafb0d833d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>å…·ä½“åœ°ï¼Œè®° s&#x3D;x^yï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­åœ°æ£€æŸ¥ s çš„æœ€ä½ä½ï¼Œå¦‚æœæœ€ä½ä½ä¸º 1ï¼Œé‚£ä¹ˆä»¤è®¡æ•°å™¨åŠ ä¸€ï¼Œç„¶åæˆ‘ä»¬ä»¤ s æ•´ä½“å³ç§»ä¸€ä½ï¼Œè¿™æ · s çš„æœ€ä½ä½å°†è¢«èˆå»ï¼ŒåŸæœ¬çš„æ¬¡ä½ä½å°±å˜æˆäº†æ–°çš„æœ€ä½ä½ã€‚æˆ‘ä»¬é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ° s&#x3D;0 ä¸ºæ­¢ã€‚è¿™æ ·è®¡æ•°å™¨ä¸­å°±ç´¯è®¡äº† s çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„æ•°é‡ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hammingDistance</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> x ^ y, ret = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (s != <span class="hljs-number">0</span>) &#123;<br>            ret += s &amp; <span class="hljs-number">1</span>;<br>            s &gt;&gt;= <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(logN)ï¼Œå…¶ä¸­ N æ˜¯å…ƒç´ çš„æ•°æ®èŒƒå›´ï¼Œåœ¨æœ¬é¢˜ä¸­ logN&#x3D;log2^31&#x3D;31ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç³»ç»Ÿå†…ç½®å’Œç§»ä½ä¸¤ç§æ–¹å¼è¿›è¡Œäº†å®ç°</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—ï¼ˆäºŒåäºŒï¼‰</title>
    <link href="/2022/08/26/A22-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E6%95%B0%E7%BB%84%E4%B8%AD%E6%B6%88%E5%A4%B1%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
    <url>/2022/08/26/A22-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E6%95%B0%E7%BB%84%E4%B8%AD%E6%B6%88%E5%A4%B1%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E4%BA%8C%E5%8D%81%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬å››ç™¾å››åå…«é¢˜ï¼š<a href="https://leetcode.cn/problems/find-all-numbers-disappeared-in-an-array/description/">æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œå“ˆå¸Œè¡¨ã€</p><p>ç»™ä½ ä¸€ä¸ªå« n ä¸ªæ•´æ•°çš„æ•°ç»„ nums ï¼Œå…¶ä¸­ nums[i] åœ¨åŒºé—´ [1, n] å†…ã€‚è¯·ä½ æ‰¾å‡ºæ‰€æœ‰åœ¨ [1, n] èŒƒå›´å†…ä½†æ²¡æœ‰å‡ºç°åœ¨ nums ä¸­çš„æ•°å­—ï¼Œå¹¶ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ç»“æœã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šnums = [<span class="hljs-number">4,3,2,7</span>,<span class="hljs-number">8,2,3,1</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šnums = <span class="hljs-comment">[1,1]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[2]</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€n &#x3D;&#x3D; nums.length<br>2ã€1 &lt;&#x3D; n &lt;&#x3D; 10^5<br>3ã€1 &lt;&#x3D; nums[i] &lt;&#x3D; n</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨è®°å½•æ•°ç»„ nums ä¸­çš„æ•°å­—ï¼Œç”±äºæ•°å­—èŒƒå›´å‡åœ¨ [1,n] ä¸­ï¼Œè®°å½•æ•°å­—åæˆ‘ä»¬å†åˆ©ç”¨å“ˆå¸Œè¡¨æ£€æŸ¥ [1,n] ä¸­çš„æ¯ä¸€ä¸ªæ•°æ˜¯å¦å‡ºç°ï¼Œä»è€Œæ‰¾åˆ°ç¼ºå¤±çš„æ•°å­—ã€‚</p><p>ç”±äºæ•°å­—èŒƒå›´å‡åœ¨ [1,n] ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„æ¥ä»£æ›¿å“ˆå¸Œè¡¨ã€‚è¿™ä¸€åšæ³•çš„ç©ºé—´å¤æ‚åº¦æ˜¯ O(n) çš„ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦åˆ° O(1)ã€‚</p><p>æ³¨æ„åˆ° nums çš„é•¿åº¦æ°å¥½ä¹Ÿä¸º nï¼Œèƒ½å¦è®© nums å……å½“å“ˆå¸Œè¡¨å‘¢ï¼Ÿ</p><p>ç”±äº nums çš„æ•°å­—èŒƒå›´å‡åœ¨ [1,n] ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€èŒƒå›´ä¹‹å¤–çš„æ•°å­—ï¼Œæ¥è¡¨è¾¾ã€Œæ˜¯å¦å­˜åœ¨ã€çš„å«ä¹‰ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œéå† numsï¼Œæ¯é‡åˆ°ä¸€ä¸ªæ•° xï¼Œå°±è®© nums[xâˆ’1] å¢åŠ  nã€‚ç”±äº nums ä¸­æ‰€æœ‰æ•°å‡åœ¨ [1,n] ä¸­ï¼Œå¢åŠ ä»¥åï¼Œè¿™äº›æ•°å¿…ç„¶å¤§äº nã€‚æœ€åæˆ‘ä»¬éå† numsï¼Œè‹¥ nums[i] æœªå¤§äº nï¼Œå°±è¯´æ˜æ²¡æœ‰é‡åˆ°è¿‡æ•° i+1ã€‚è¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°äº†ç¼ºå¤±çš„æ•°å­—ã€‚</p><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬éå†åˆ°æŸä¸ªä½ç½®æ—¶ï¼Œå…¶ä¸­çš„æ•°å¯èƒ½å·²ç»è¢«å¢åŠ è¿‡ï¼Œå› æ­¤éœ€è¦å¯¹ n å–æ¨¡æ¥è¿˜åŸå‡ºå®ƒæœ¬æ¥çš„å€¼ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">findDisappearedNumbers</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (num - <span class="hljs-number">1</span>) % n;<br>            nums[x] += n;<br>        &#125;<br>        List&lt;Integer&gt; ret = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-keyword">if</span> (nums[i] &lt;= n) &#123;<br>                ret.add(i + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚å…¶ä¸­ n æ˜¯æ•°ç»„ nums çš„é•¿åº¦ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬å·§å¦™çš„è¿ç”¨åŸåœ°ä¿®æ”¹çš„æ€æƒ³è§£å†³äº†æ­¤éœ€æ±‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¯”ç‰¹ä½è®¡æ•°ï¼ˆäºŒåä¸€ï¼‰</title>
    <link href="/2022/08/25/A21-%E6%AF%94%E7%89%B9%E4%BD%8D%E8%AE%A1%E6%95%B0%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89/"/>
    <url>/2022/08/25/A21-%E6%AF%94%E7%89%B9%E4%BD%8D%E8%AE%A1%E6%95%B0%EF%BC%88%E4%BA%8C%E5%8D%81%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸‰ç™¾ä¸‰åå…«é¢˜ï¼š<a href="https://leetcode.cn/problems/counting-bits/">æ¯”ç‰¹ä½è®¡æ•°</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œä½è¿ç®—ã€</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•° n ï¼Œå¯¹äº 0 &lt;&#x3D; i &lt;&#x3D; n ä¸­çš„æ¯ä¸ª i ï¼Œè®¡ç®—å…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„ä¸ªæ•° ï¼Œè¿”å›ä¸€ä¸ªé•¿åº¦ä¸º n + 1 çš„æ•°ç»„ ans ä½œä¸ºç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ada">è¾“å…¥ï¼šn = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]<br>è§£é‡Šï¼š<br><span class="hljs-number">0</span> <span class="hljs-comment">--&gt; 0</span><br><span class="hljs-number">1</span> <span class="hljs-comment">--&gt; 1</span><br><span class="hljs-number">2</span> <span class="hljs-comment">--&gt; 10</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ada">è¾“å…¥ï¼šn = <span class="hljs-number">5</span><br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]<br>è§£é‡Šï¼š<br><span class="hljs-number">0</span> <span class="hljs-comment">--&gt; 0</span><br><span class="hljs-number">1</span> <span class="hljs-comment">--&gt; 1</span><br><span class="hljs-number">2</span> <span class="hljs-comment">--&gt; 10</span><br><span class="hljs-number">3</span> <span class="hljs-comment">--&gt; 11</span><br><span class="hljs-number">4</span> <span class="hljs-comment">--&gt; 100</span><br><span class="hljs-number">5</span> <span class="hljs-comment">--&gt; 101</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€0 &lt;&#x3D; n &lt;&#x3D; 10^5</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æœ€ç›´è§‚çš„åšæ³•æ˜¯å¯¹ä» 0 åˆ° n çš„æ¯ä¸ªæ•´æ•°ç›´æ¥è®¡ç®—ã€Œä¸€æ¯”ç‰¹æ•°ã€ã€‚æ¯ä¸ª int å‹çš„æ•°éƒ½å¯ä»¥ç”¨ 32 ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤ºï¼Œåªè¦éå†å…¶äºŒè¿›åˆ¶è¡¨ç¤ºçš„æ¯ä¸€ä½å³å¯å¾—åˆ° 1 çš„æ•°ç›®ã€‚</p><p>åˆ©ç”¨ BrianÂ Kernighan ç®—æ³•ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿›ä¸€æ­¥æå‡è®¡ç®—é€Ÿåº¦ã€‚BrianÂ Kernighan ç®—æ³•çš„åŸç†æ˜¯ï¼šå¯¹äºä»»æ„æ•´æ•° xï¼Œä»¤ x&#x3D;xÂ &amp;Â (xâˆ’1)ï¼Œè¯¥è¿ç®—å°† x çš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„æœ€åä¸€ä¸ª 1 å˜æˆ 0ã€‚å› æ­¤ï¼Œå¯¹ x é‡å¤è¯¥æ“ä½œï¼Œç›´åˆ° x å˜æˆ 0ï¼Œåˆ™æ“ä½œæ¬¡æ•°å³ä¸º x çš„ã€Œä¸€æ¯”ç‰¹æ•°ã€ã€‚</p><p>å¯¹äºç»™å®šçš„ nï¼Œè®¡ç®—ä» 0 åˆ° n çš„æ¯ä¸ªæ•´æ•°çš„ã€Œä¸€æ¯”ç‰¹æ•°ã€çš„æ—¶é—´éƒ½ä¸ä¼šè¶…è¿‡ O(logn)ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn)ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] countBits(<span class="hljs-type">int</span> n) &#123;<br>        <span class="hljs-type">int</span>[] bits = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n + <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= n; i++) &#123;<br>            bits[i] = countOnes(i);<br>        &#125;<br>        <span class="hljs-keyword">return</span> bits;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countOnes</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">ones</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (x &gt; <span class="hljs-number">0</span>) &#123;<br>            x &amp;= (x - <span class="hljs-number">1</span>);<br>            ones++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ones;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ã€‚éœ€è¦å¯¹ä» 0 åˆ° n çš„æ¯ä¸ªæ•´æ•°ä½¿ç”¨è®¡ç®—ã€Œä¸€æ¯”ç‰¹æ•°ã€ï¼Œå¯¹äºæ¯ä¸ªæ•´æ•°è®¡ç®—ã€Œä¸€æ¯”ç‰¹æ•°ã€çš„æ—¶é—´éƒ½ä¸ä¼šè¶…è¿‡ O(logn)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚é™¤äº†è¿”å›çš„æ•°ç»„ä»¥å¤–ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºå¸¸æ•°ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† BrianÂ Kernighan ç®—æ³•ï¼ˆx &amp;&#x3D; (x - 1)ï¼‰ï¼Œå®ƒä¼šå°†æˆ‘ä»¬äºŒè¿›åˆ¶çš„æœ€åä¸€ä¸ª 1 å˜æˆ 0ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå˜é‡è®°å½•è¿™ä¸ªæ“ä½œçš„æ¬¡æ•°å³å¯</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤šæ•°å…ƒç´ ï¼ˆäºŒåï¼‰</title>
    <link href="/2022/08/24/A20-%E5%A4%9A%E6%95%B0%E5%85%83%E7%B4%A0%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89/"/>
    <url>/2022/08/24/A20-%E5%A4%9A%E6%95%B0%E5%85%83%E7%B4%A0%EF%BC%88%E4%BA%8C%E5%8D%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾å…­åä¹é¢˜ï¼š<a href="https://leetcode.cn/problems/majority-element/">å¤šæ•°å…ƒç´ </a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œæ•°ç»„ã€ã€ã€Œæ’åºã€</p><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º n çš„æ•°ç»„ nums ï¼Œè¿”å›å…¶ä¸­çš„å¤šæ•°å…ƒç´ ã€‚å¤šæ•°å…ƒç´ æ˜¯æŒ‡åœ¨æ•°ç»„ä¸­å‡ºç°æ¬¡æ•° å¤§äº âŒŠ n&#x2F;2 âŒ‹ çš„å…ƒç´ ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„æ˜¯éç©ºçš„ï¼Œå¹¶ä¸”ç»™å®šçš„æ•°ç»„æ€»æ˜¯å­˜åœ¨å¤šæ•°å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fix"><span class="hljs-attr">è¾“å…¥ï¼šnums </span>=<span class="hljs-string"> [3,2,3]</span><br><span class="hljs-string">è¾“å‡ºï¼š3</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šnums = <span class="hljs-string">[2,2,1,1,1,2,2]</span><br>è¾“å‡ºï¼š<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€n &#x3D;&#x3D; nums.length</p><p>2ã€1 &lt;&#x3D; n &lt;&#x3D; 5 * 10^4</p><p>3ã€-10^9 &lt;&#x3D; nums[i] &lt;&#x3D; 10^9</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"><a href="#æ³•ä¸€ï¼šå“ˆå¸Œè¡¨" class="headerlink" title="æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"></a>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</h3><p>æ€è·¯ï¼š</p><p>æˆ‘ä»¬çŸ¥é“å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ å¤§äº [n&#x2F;2] æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å“ˆå¸Œè¡¨æ¥å¿«é€Ÿç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>ç®—æ³•ï¼š</p><p>æˆ‘ä»¬ä½¿ç”¨å“ˆå¸Œæ˜ å°„ï¼ˆHashMapï¼‰æ¥å­˜å‚¨æ¯ä¸ªå…ƒç´ ä»¥åŠå‡ºç°çš„æ¬¡æ•°ã€‚å¯¹äºå“ˆå¸Œæ˜ å°„ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œé”®è¡¨ç¤ºä¸€ä¸ªå…ƒç´ ï¼Œå€¼è¡¨ç¤ºè¯¥å…ƒç´ å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>æˆ‘ä»¬ç”¨ä¸€ä¸ªå¾ªç¯éå†æ•°ç»„ nums å¹¶å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åŠ å…¥å“ˆå¸Œæ˜ å°„ä¸­ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬éå†å“ˆå¸Œæ˜ å°„ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œè¿”å›å€¼æœ€å¤§çš„é”®ã€‚æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥åœ¨éå†æ•°ç»„ nums æ—¶å€™ä½¿ç”¨æ‰“æ“‚å°çš„æ–¹æ³•ï¼Œç»´æŠ¤æœ€å¤§çš„å€¼ï¼Œè¿™æ ·çœå»äº†æœ€åå¯¹å“ˆå¸Œæ˜ å°„çš„éå†ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">private</span> Map&lt;Integer, Integer&gt; <span class="hljs-title function_">countNums</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        Map&lt;Integer, Integer&gt; counts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Integer, Integer&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            <span class="hljs-keyword">if</span> (!counts.containsKey(num)) &#123;<br>                counts.put(num, <span class="hljs-number">1</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                counts.put(num, counts.get(num) + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> counts;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">majorityElement</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        Map&lt;Integer, Integer&gt; counts = countNums(nums);<br><br>        Map.Entry&lt;Integer, Integer&gt; majorityEntry = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : counts.entrySet()) &#123;<br>            <span class="hljs-keyword">if</span> (majorityEntry == <span class="hljs-literal">null</span> || entry.getValue() &gt; majorityEntry.getValue()) &#123;<br>                majorityEntry = entry;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> majorityEntry.getKey();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚</p><h3 id="æ³•äºŒï¼šæ’åº"><a href="#æ³•äºŒï¼šæ’åº" class="headerlink" title="æ³•äºŒï¼šæ’åº"></a>æ³•äºŒï¼šæ’åº</h3><p>æ€è·¯ï¼š</p><p>å¦‚æœå°†æ•°ç»„ nums ä¸­çš„æ‰€æœ‰å…ƒç´ æŒ‰ç…§å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡çš„é¡ºåºæ’åºï¼Œé‚£ä¹ˆä¸‹æ ‡ä¸º [n&#x2F;2] çš„å…ƒç´ ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ä¸€å®šæ˜¯ä¼—æ•°ã€‚</p><p>ç®—æ³•ï¼š</p><p>å¯¹äºè¿™ç§ç®—æ³•ï¼Œæˆ‘ä»¬å…ˆå°† nums æ•°ç»„æ’åºï¼Œç„¶åè¿”å›ä¸Šæ–‡æ‰€è¯´çš„ä¸‹æ ‡å¯¹åº”çš„å…ƒç´ ã€‚ä¸‹é¢çš„å›¾ä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™ç§ç­–ç•¥æ˜¯æœ‰æ•ˆçš„ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œç¬¬ä¸€ä¸ªä¾‹å­æ˜¯ n ä¸ºå¥‡æ•°çš„æƒ…å†µï¼Œç¬¬äºŒä¸ªä¾‹å­æ˜¯ n ä¸ºå¶æ•°çš„æƒ…å†µã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e9a2ec1b29a4fb692566426505f8f90~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>å¯¹äºæ¯ç§æƒ…å†µï¼Œæ•°ç»„ä¸‹é¢çš„çº¿è¡¨ç¤ºå¦‚æœä¼—æ•°æ˜¯æ•°ç»„ä¸­çš„æœ€å°å€¼æ—¶è¦†ç›–çš„ä¸‹æ ‡ï¼Œæ•°ç»„ä¸‹é¢çš„çº¿è¡¨ç¤ºå¦‚æœä¼—æ•°æ˜¯æ•°ç»„ä¸­çš„æœ€å¤§å€¼æ—¶è¦†ç›–çš„ä¸‹æ ‡ã€‚å¯¹äºå…¶ä»–çš„æƒ…å†µï¼Œè¿™æ¡çº¿ä¼šåœ¨è¿™ä¸¤ç§æç«¯æƒ…å†µçš„ä¸­é—´ã€‚å¯¹äºè¿™ä¸¤ç§æç«¯æƒ…å†µï¼Œå®ƒä»¬ä¼šåœ¨ä¸‹æ ‡ä¸º [n&#x2F;2] çš„åœ°æ–¹æœ‰é‡å ã€‚å› æ­¤ï¼Œæ— è®ºä¼—æ•°æ˜¯å¤šå°‘ï¼Œè¿”å› [n&#x2F;2] ä¸‹æ ‡å¯¹åº”çš„å€¼éƒ½æ˜¯æ­£ç¡®çš„ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">majorityElement</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        Arrays.sort(nums);<br>        <span class="hljs-keyword">return</span> nums[nums.length / <span class="hljs-number">2</span>];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ã€‚å°†æ•°ç»„æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn)ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚å¦‚æœä½¿ç”¨è¯­è¨€è‡ªå¸¦çš„æ’åºç®—æ³•ï¼Œéœ€è¦ä½¿ç”¨ O(logn) çš„æ ˆç©ºé—´ã€‚å¦‚æœè‡ªå·±ç¼–å†™å †æ’åºï¼Œåˆ™åªéœ€è¦ä½¿ç”¨ O(1) çš„é¢å¤–ç©ºé—´ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨å“ˆå¸Œè¡¨å’Œæ’åºä¸¤ç§æ–¹å¼è¿›è¡Œäº†å®ç°</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç›¸äº¤é“¾è¡¨ï¼ˆåä¹ï¼‰</title>
    <link href="/2022/08/23/A19-%E7%9B%B8%E4%BA%A4%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%E4%B9%9D%EF%BC%89/"/>
    <url>/2022/08/23/A19-%E7%9B%B8%E4%BA%A4%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%E4%B9%9D%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾å…­åé¢˜ï¼š<a href="https://leetcode.cn/problems/intersection-of-two-linked-lists/">ç›¸äº¤é“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œé“¾è¡¨ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™ä½ ä¸¤ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ headA å’Œ headB ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹ã€‚å¦‚æœä¸¤ä¸ªé“¾è¡¨ä¸å­˜åœ¨ç›¸äº¤èŠ‚ç‚¹ï¼Œè¿”å› null ã€‚</p><p>å›¾ç¤ºä¸¤ä¸ªé“¾è¡¨åœ¨èŠ‚ç‚¹ c1 å¼€å§‹ç›¸äº¤ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adb6c10dab334692b80892d417335a3c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>é¢˜ç›®æ•°æ®ä¿è¯æ•´ä¸ªé“¾å¼ç»“æ„ä¸­ä¸å­˜åœ¨ç¯ã€‚</p><p>æ³¨æ„ï¼Œå‡½æ•°è¿”å›ç»“æœåï¼Œé“¾è¡¨å¿…é¡» ä¿æŒå…¶åŸå§‹ç»“æ„ ã€‚</p><p>è‡ªå®šä¹‰è¯„æµ‹ï¼š</p><p>è¯„æµ‹ç³»ç»Ÿçš„è¾“å…¥å¦‚ä¸‹ï¼ˆä½ è®¾è®¡çš„ç¨‹åºä¸é€‚ç”¨æ­¤è¾“å…¥ï¼‰ï¼š</p><blockquote><p>intersectVal - ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœä¸å­˜åœ¨ç›¸äº¤èŠ‚ç‚¹ï¼Œè¿™ä¸€å€¼ä¸º 0</p><p>listA - ç¬¬ä¸€ä¸ªé“¾è¡¨</p><p>listB - ç¬¬äºŒä¸ªé“¾è¡¨</p><p>skipA - åœ¨ listA ä¸­ï¼ˆä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼‰è·³åˆ°äº¤å‰èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°</p><p>skipB - åœ¨ listB ä¸­ï¼ˆä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼‰è·³åˆ°äº¤å‰èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°</p><p>è¯„æµ‹ç³»ç»Ÿå°†æ ¹æ®è¿™äº›è¾“å…¥åˆ›å»ºé“¾å¼æ•°æ®ç»“æ„ï¼Œå¹¶å°†ä¸¤ä¸ªå¤´èŠ‚ç‚¹ headA å’Œ headB ä¼ é€’ç»™ä½ çš„ç¨‹åºã€‚å¦‚æœç¨‹åºèƒ½å¤Ÿæ­£ç¡®è¿”å›ç›¸äº¤èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä½ çš„è§£å†³æ–¹æ¡ˆå°†è¢«è§†ä½œæ­£ç¡®ç­”æ¡ˆ </p></blockquote><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/149b4fec36aa4a8194ac6828fd6b47a6~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼šintersectVal = <span class="hljs-number">8</span>, listA = [<span class="hljs-number">4,1,8,4</span>,<span class="hljs-number">5</span>], listB = [<span class="hljs-number">5,6,1,8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], skipA = <span class="hljs-number">2</span>, skipB = <span class="hljs-number">3</span><br>è¾“å‡ºï¼šIntersected at &#x27;<span class="hljs-number">8</span>&#x27;<br>è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º <span class="hljs-number">8</span> ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º <span class="hljs-number">0</span>ï¼‰ã€‚<br>ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <span class="hljs-keyword">A</span> ä¸º [<span class="hljs-number">4,1,8,4</span>,<span class="hljs-number">5</span>]ï¼Œé“¾è¡¨ B ä¸º [<span class="hljs-number">5,6,1,8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]ã€‚<br>åœ¨ <span class="hljs-keyword">A</span> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">2</span> ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">3</span> ä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure><blockquote><p>è¯·æ³¨æ„ç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸ä¸º 1ï¼Œå› ä¸ºåœ¨é“¾è¡¨ A å’Œé“¾è¡¨ B ä¹‹ä¸­å€¼ä¸º 1 çš„èŠ‚ç‚¹(A ä¸­ç¬¬äºŒä¸ªèŠ‚ç‚¹å’Œ B ä¸­ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹) æ˜¯ä¸åŒçš„èŠ‚ç‚¹ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬åœ¨å†…å­˜ä¸­æŒ‡å‘ä¸¤ä¸ªä¸åŒçš„ä½ç½®ï¼Œè€Œé“¾è¡¨ A å’Œé“¾è¡¨ B ä¸­å€¼ä¸º 8 çš„èŠ‚ç‚¹ (A ä¸­ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ï¼ŒB ä¸­ç¬¬å››ä¸ªèŠ‚ç‚¹) åœ¨å†…å­˜ä¸­æŒ‡å‘ç›¸åŒçš„ä½ç½®ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb751fea7211462f91fbfe95115c0d17~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs prolog">è¾“å…¥ï¼šintersectVal = <span class="hljs-number">2</span>, listA = [<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], listB = [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], skipA = <span class="hljs-number">3</span>, skipB = <span class="hljs-number">1</span><br>è¾“å‡ºï¼š<span class="hljs-symbol">Intersected</span> at <span class="hljs-string">&#x27;2&#x27;</span><br>è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º <span class="hljs-number">2</span> ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º <span class="hljs-number">0</span>ï¼‰ã€‚<br>ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <span class="hljs-symbol">A</span> ä¸º [<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>]ï¼Œé“¾è¡¨ <span class="hljs-symbol">B</span> ä¸º [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>]ã€‚<br>åœ¨ <span class="hljs-symbol">A</span> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">3</span> ä¸ªèŠ‚ç‚¹ï¼›åœ¨ <span class="hljs-symbol">B</span> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <span class="hljs-number">1</span> ä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09c601e24eea43bb8db1a670e0086d0f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">è¾“å…¥ï¼š<span class="hljs-built_in">int</span>ersectVal = <span class="hljs-number">0</span>, listA = [<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>], listB = [<span class="hljs-number">1</span>,<span class="hljs-number">5</span>], skipA = <span class="hljs-number">3</span>, skipB = <span class="hljs-number">2</span><br>è¾“å‡ºï¼š<span class="hljs-literal">null</span><br>è§£é‡Šï¼šä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>]ï¼Œé“¾è¡¨ B ä¸º [<span class="hljs-number">1</span>,<span class="hljs-number">5</span>]ã€‚<br>ç”±äºè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œæ‰€ä»¥ <span class="hljs-built_in">int</span>ersectVal å¿…é¡»ä¸º <span class="hljs-number">0</span>ï¼Œè€Œ skipA å’Œ skipB å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚<br>è¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œå› æ­¤è¿”å› <span class="hljs-literal">null</span> ã€‚<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>listA</code>Â ä¸­èŠ‚ç‚¹æ•°ç›®ä¸ºÂ <code>m</code></p><p>2ã€<code>listB</code>Â ä¸­èŠ‚ç‚¹æ•°ç›®ä¸ºÂ <code>n</code></p><p>3ã€<code>1 &lt;= m, n &lt;= 3 * 10^4</code></p><p>4ã€ <code>1 &lt;= Node.val &lt;= 10^5</code></p><p>5ã€<code>0 &lt;= skipA &lt;= m</code></p><p>6ã€<code>0 &lt;= skipB &lt;= n</code></p><p>7ã€å¦‚æœÂ <code>listA</code>Â å’ŒÂ <code>listB</code>Â æ²¡æœ‰äº¤ç‚¹ï¼Œ<code>intersectVal</code>Â ä¸ºÂ <code>0</code></p><p>8ã€å¦‚æœÂ <code>listA</code>Â å’ŒÂ <code>listB</code>Â æœ‰äº¤ç‚¹ï¼Œ<code>intersectVal == listA[skipA] == listB[skipB]</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æœ¬é¢˜ä½¿ç”¨å“ˆå¸Œè¡¨ç©ºé—´å¤æ‚åº¦è¾¾åˆ°äº† O(n)ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ›´ç®€å•çš„åŒæŒ‡é’ˆå»è§£å†³è¯¥é—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä½ O(1)ã€‚</p><p>åŒæŒ‡é’ˆåˆ†æï¼š</p><p>åªæœ‰å½“é“¾è¡¨ headA å’Œ headB éƒ½ä¸ä¸ºç©ºæ—¶ï¼Œä¸¤ä¸ªé“¾è¡¨æ‰å¯èƒ½ç›¸äº¤ã€‚å› æ­¤é¦–å…ˆåˆ¤æ–­é“¾è¡¨ headA å’Œ headB æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœå…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªé“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä¸¤ä¸ªé“¾è¡¨ä¸€å®šä¸ç›¸äº¤ï¼Œè¿”å› nullã€‚</p><p>å½“é“¾è¡¨ headA å’Œ headB éƒ½ä¸ä¸ºç©ºæ—¶ï¼Œåˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆ pA å’Œ pBï¼Œåˆå§‹æ—¶åˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ headA å’Œ headBï¼Œç„¶åå°†ä¸¤ä¸ªæŒ‡é’ˆä¾æ¬¡éå†ä¸¤ä¸ªé“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚å…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p><p>æ¯æ­¥æ“ä½œéœ€è¦åŒæ—¶æ›´æ–°æŒ‡é’ˆ pA å’Œ pBã€‚</p><p>1ã€å¦‚æœæŒ‡é’ˆ pA ä¸ä¸ºç©ºï¼Œåˆ™å°†æŒ‡é’ˆ pA ç§»åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼›pB ä¸ä¸ºç©ºï¼Œåˆ™å°†æŒ‡é’ˆ pB ç§»åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>2ã€å¦‚æœæŒ‡é’ˆ pA ä¸ºç©ºï¼Œåˆ™å°†æŒ‡é’ˆ pA ç§»åˆ°é“¾è¡¨ headB çš„å¤´èŠ‚ç‚¹ï¼›å¦‚æœæŒ‡é’ˆ pB ä¸ºç©ºï¼Œåˆ™å°†æŒ‡é’ˆ pB ç§»åˆ°é“¾è¡¨ headA çš„å¤´èŠ‚ç‚¹ã€‚</p><p>3ã€å½“æŒ‡é’ˆ pA å’Œ pB æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…éƒ½ä¸ºç©ºæ—¶ï¼Œè¿”å›å®ƒä»¬æŒ‡å‘çš„èŠ‚ç‚¹æˆ–è€… nullã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">getIntersectionNode</span><span class="hljs-params">(ListNode headA, ListNode headB)</span> &#123;<br>        <span class="hljs-keyword">if</span> (headA == <span class="hljs-literal">null</span> || headB == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">pA</span> <span class="hljs-operator">=</span> headA, pB = headB;<br>        <span class="hljs-keyword">while</span> (pA != pB) &#123;<br>            pA = pA == <span class="hljs-literal">null</span> ? headB : pA.next;<br>            pB = pB == <span class="hljs-literal">null</span> ? headA : pB.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> pA;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(m+n)ï¼Œå…¶ä¸­ m å’Œ n ä»£è¡¨ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ï¼Œä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶éå†ä¸¤ä¸ªé“¾è¡¨ï¼Œæ¯ä¸ªæŒ‡é’ˆéå†ä¸¤ä¸ªé“¾è¡¨å„ä¸€æ¬¡</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œä½¿ç”¨å“ˆå¸Œè¡¨ç©ºé—´å¤æ‚åº¦é«˜ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒæŒ‡é’ˆå°†ç©ºé—´å¤æ‚åº¦é™åˆ°äº† O(1)</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼ˆåå…«ï¼‰</title>
    <link href="/2022/08/22/A18-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E5%8D%81%E5%85%AB%EF%BC%89/"/>
    <url>/2022/08/22/A18-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%88%E5%8D%81%E5%85%AB%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾ä¸‰åå…­é¢˜ï¼š<a href="https://leetcode.cn/problems/single-number/">åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œä½è¿ç®—ã€ã€ã€Œæ•°ç»„ã€</p><p>ç»™ä½ ä¸€ä¸ªéç©ºæ•´æ•°æ•°ç»„ nums ï¼Œé™¤äº†æŸä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ä»¥å¤–ï¼Œå…¶ä½™æ¯ä¸ªå…ƒç´ å‡å‡ºç°ä¸¤æ¬¡ã€‚æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°äº†ä¸€æ¬¡çš„å…ƒç´ ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡å¹¶å®ç°çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œä¸”è¯¥ç®—æ³•åªä½¿ç”¨å¸¸é‡é¢å¤–ç©ºé—´ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fix"><span class="hljs-attr">è¾“å…¥ï¼š nums </span>=<span class="hljs-string"> [2,2,1]</span><br><span class="hljs-string">è¾“å‡ºï¼š 1</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šnums = <span class="hljs-string">[4,1,2,1,2]</span><br>è¾“å‡ºï¼š<span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šnums <span class="hljs-operator">=</span> [<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>1 &lt;= nums.length &lt;= 3 * 10^4</code></p><p>2ã€<code>-3 * 10^4 &lt;= nums[i] &lt;= 3 * 10^4</code></p><p>3ã€é™¤äº†æŸä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ä»¥å¤–ï¼Œå…¶ä½™æ¯ä¸ªå…ƒç´ å‡å‡ºç°ä¸¤æ¬¡ã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>å¦‚æœä¸è€ƒè™‘æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦çš„é™åˆ¶ï¼Œè¿™é“é¢˜æœ‰å¾ˆå¤šç§è§£æ³•ï¼Œå¯èƒ½çš„è§£æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><p>1ã€ä½¿ç”¨é›†åˆå­˜å‚¨æ•°å­—ã€‚éå†æ•°ç»„ä¸­çš„æ¯ä¸ªæ•°å­—ï¼Œå¦‚æœé›†åˆä¸­æ²¡æœ‰è¯¥æ•°å­—ï¼Œåˆ™å°†è¯¥æ•°å­—åŠ å…¥é›†åˆï¼Œå¦‚æœé›†åˆä¸­å·²ç»æœ‰è¯¥æ•°å­—ï¼Œåˆ™å°†è¯¥æ•°å­—ä»é›†åˆä¸­åˆ é™¤ï¼Œæœ€åå‰©ä¸‹çš„æ•°å­—å°±æ˜¯åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ã€‚</p><p>2ã€ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨æ¯ä¸ªæ•°å­—å’Œè¯¥æ•°å­—å‡ºç°çš„æ¬¡æ•°ã€‚éå†æ•°ç»„å³å¯å¾—åˆ°æ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶æ›´æ–°å“ˆå¸Œè¡¨ï¼Œæœ€åéå†å“ˆå¸Œè¡¨ï¼Œå¾—åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ã€‚</p><p>3ã€ä½¿ç”¨é›†åˆå­˜å‚¨æ•°ç»„ä¸­å‡ºç°çš„æ‰€æœ‰æ•°å­—ï¼Œå¹¶è®¡ç®—æ•°ç»„ä¸­çš„å…ƒç´ ä¹‹å’Œã€‚ç”±äºé›†åˆä¿è¯å…ƒç´ æ— é‡å¤ï¼Œå› æ­¤è®¡ç®—é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œçš„ä¸¤å€ï¼Œå³ä¸ºæ¯ä¸ªå…ƒç´ å‡ºç°ä¸¤æ¬¡çš„æƒ…å†µä¸‹çš„å…ƒç´ ä¹‹å’Œã€‚ç”±äºæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ å‡ºç°ä¸€æ¬¡ï¼Œå…¶ä½™å…ƒç´ éƒ½å‡ºç°ä¸¤æ¬¡ï¼Œå› æ­¤ç”¨é›†åˆä¸­çš„å…ƒç´ ä¹‹å’Œçš„ä¸¤å€å‡å»æ•°ç»„ä¸­çš„å…ƒç´ ä¹‹å’Œï¼Œå‰©ä¸‹çš„æ•°å°±æ˜¯æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ã€‚</p><p>ä¸Šè¿°ä¸‰ç§è§£æ³•éƒ½éœ€è¦é¢å¤–ä½¿ç”¨ O(n) çš„ç©ºé—´ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„é•¿åº¦ã€‚</p><p>å¦‚ä½•æ‰èƒ½åšåˆ°çº¿æ€§æ—¶é—´å¤æ‚åº¦å’Œå¸¸æ•°ç©ºé—´å¤æ‚åº¦å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä½¿ç”¨ä½è¿ç®—ã€‚å¯¹äºè¿™é“é¢˜ï¼Œå¯ä½¿ç”¨å¼‚æˆ–è¿ç®—ã€‚å¼‚æˆ–è¿ç®—æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ€§è´¨ã€‚</p><p>1ã€ä»»ä½•æ•°å’Œ 0 åšå¼‚æˆ–è¿ç®—ï¼Œç»“æœä»ç„¶æ˜¯åŸæ¥çš„æ•°ï¼Œå³ a^0&#x3D;aã€‚</p><p>2ã€ä»»ä½•æ•°å’Œå…¶è‡ªèº«åšå¼‚æˆ–è¿ç®—ï¼Œç»“æœæ˜¯ 0ï¼Œå³ a^a&#x3D;0ã€‚</p><p>3ã€å¼‚æˆ–è¿ç®—æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œå³ a^b^a&#x3D;b^a^a&#x3D;b^(a^a)&#x3D;b^0&#x3D;bã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">singleNumber</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">single</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            single ^= num;<br>        &#125;<br>        <span class="hljs-keyword">return</span> single;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„é•¿åº¦ã€‚åªéœ€è¦å¯¹æ•°ç»„éå†ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œä½¿ç”¨é›†åˆï¼Œå“ˆå¸Œè¡¨éƒ½ä¸èƒ½æ»¡è¶³ç©ºé—´å¤æ‚åº¦ O(1) çš„è¦æ±‚ï¼Œæœ€ç»ˆæˆ‘ä»¬ä½¿ç”¨ä½è¿ç®—è§£å†³äº†æ­¤éœ€æ±‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¯å½¢é“¾è¡¨ï¼ˆåä¸ƒï¼‰</title>
    <link href="/2022/08/21/A17-%E7%8E%AF%E5%BD%A2%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%E4%B8%83%EF%BC%89/"/>
    <url>/2022/08/21/A17-%E7%8E%AF%E5%BD%A2%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%E4%B8%83%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬ä¸€ç™¾å››åä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/linked-list-cycle/">ç¯å½¢é“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œé“¾è¡¨ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª next æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œè¯„æµ‹ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚æ³¨æ„ï¼špos ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ ã€‚ä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ ï¼Œåˆ™è¿”å› true ã€‚ å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bbd04c93f2c04228aed5ae5cfd52c0f1~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š<span class="hljs-built_in">head</span> = [3,2,0,-4], pos = 1<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f1ca5ecd6d944bcf87933d4583c738cb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š<span class="hljs-built_in">head</span> = [1,2], pos = 0<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3347748c8e9d4d82919824984483c20e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¾“å…¥ï¼š <span class="hljs-built_in">head</span> = [1], pos = -1<br>è¾“å‡ºï¼š <span class="hljs-literal">false</span><br>è§£é‡Šï¼š é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ [0, 104]</p><p>2ã€-10^5 &lt;&#x3D; Node.val &lt;&#x3D; 10^5<br>3ã€pos ä¸º -1 æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ª æœ‰æ•ˆç´¢å¼• ã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æœ¬é¢˜æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§è§£æ³•ï¼š</p><p>1ã€å“ˆå¸Œè¡¨</p><p>2ã€å¿«æ…¢æŒ‡é’ˆ</p><h3 id="2-1ã€æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"><a href="#2-1ã€æ³•ä¸€ï¼šå“ˆå¸Œè¡¨" class="headerlink" title="2.1ã€æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"></a>2.1ã€æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</h3><p>æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•æ˜¯éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ¯æ¬¡éå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œåˆ¤æ–­è¯¥èŠ‚ç‚¹æ­¤å‰æ˜¯å¦è¢«è®¿é—®è¿‡ã€‚</p><p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å“ˆå¸Œè¡¨æ¥å­˜å‚¨æ‰€æœ‰å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹ã€‚æ¯æ¬¡æˆ‘ä»¬åˆ°è¾¾ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹å·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œåˆ™è¯´æ˜è¯¥é“¾è¡¨æ˜¯ç¯å½¢é“¾è¡¨ï¼Œå¦åˆ™å°±å°†è¯¥èŠ‚ç‚¹åŠ å…¥å“ˆå¸Œè¡¨ä¸­ã€‚é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°æˆ‘ä»¬éå†å®Œæ•´ä¸ªé“¾è¡¨å³å¯ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasCycle</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        Set&lt;ListNode&gt; seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;ListNode&gt;();<br>        <span class="hljs-keyword">while</span> (head != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (!seen.add(head)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            head = head.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œå…¶ä¸­ N æ˜¯é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ã€‚æœ€åæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦éå†æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(N)ï¼Œå…¶ä¸­ N æ˜¯é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ã€‚ä¸»è¦ä¸ºå“ˆå¸Œè¡¨çš„å¼€é”€ï¼Œæœ€åæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªèŠ‚ç‚¹æ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ä¸€æ¬¡ã€‚</p><h3 id="2-2ã€æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ"><a href="#2-2ã€æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ" class="headerlink" title="2.2ã€æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ"></a>2.2ã€æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ</h3><p>æœ¬æ–¹æ³•éœ€è¦è¯»è€…å¯¹é¾Ÿå…”èµ›è·‘ç®—æ³•æœ‰æ‰€äº†è§£ã€‚</p><p>å‡æƒ³ã€Œä¹Œé¾Ÿã€å’Œã€Œå…”å­ã€åœ¨é“¾è¡¨ä¸Šç§»åŠ¨ï¼Œã€Œå…”å­ã€è·‘å¾—å¿«ï¼Œã€Œä¹Œé¾Ÿã€è·‘å¾—æ…¢ã€‚å½“ã€Œä¹Œé¾Ÿã€å’Œã€Œå…”å­ã€ä»é“¾è¡¨ä¸Šçš„åŒä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ç§»åŠ¨æ—¶ï¼Œå¦‚æœè¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ï¼Œé‚£ä¹ˆã€Œå…”å­ã€å°†ä¸€ç›´å¤„äºã€Œä¹Œé¾Ÿã€çš„å‰æ–¹ï¼›å¦‚æœè¯¥é“¾è¡¨ä¸­æœ‰ç¯ï¼Œé‚£ä¹ˆã€Œå…”å­ã€ä¼šå…ˆäºã€Œä¹Œé¾Ÿã€è¿›å…¥ç¯ï¼Œå¹¶ä¸”ä¸€ç›´åœ¨ç¯å†…ç§»åŠ¨ã€‚ç­‰åˆ°ã€Œä¹Œé¾Ÿã€è¿›å…¥ç¯æ—¶ï¼Œç”±äºã€Œå…”å­ã€çš„é€Ÿåº¦å¿«ï¼Œå®ƒä¸€å®šä¼šåœ¨æŸä¸ªæ—¶åˆ»ä¸ä¹Œé¾Ÿç›¸é‡ï¼Œå³å¥—äº†ã€Œä¹Œé¾Ÿã€è‹¥å¹²åœˆã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šè¿°æ€è·¯æ¥è§£å†³æœ¬é¢˜ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€å¿«ä¸€æ…¢ã€‚æ…¢æŒ‡é’ˆæ¯æ¬¡åªç§»åŠ¨ä¸€æ­¥ï¼Œè€Œå¿«æŒ‡é’ˆæ¯æ¬¡ç§»åŠ¨ä¸¤æ­¥ã€‚åˆå§‹æ—¶ï¼Œæ…¢æŒ‡é’ˆåœ¨ä½ç½® headï¼Œè€Œå¿«æŒ‡é’ˆåœ¨ä½ç½® head.nextã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœåœ¨ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œå¿«æŒ‡é’ˆåè¿‡æ¥è¿½ä¸Šæ…¢æŒ‡é’ˆï¼Œå°±è¯´æ˜è¯¥é“¾è¡¨ä¸ºç¯å½¢é“¾è¡¨ã€‚å¦åˆ™å¿«æŒ‡é’ˆå°†åˆ°è¾¾é“¾è¡¨å°¾éƒ¨ï¼Œè¯¥é“¾è¡¨ä¸ä¸ºç¯å½¢é“¾è¡¨ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasCycle</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span> || head.next == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">slow</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">fast</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">while</span> (slow != fast) &#123;<br>            <span class="hljs-keyword">if</span> (fast == <span class="hljs-literal">null</span> || fast.next == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            slow = slow.next;<br>            fast = fast.next.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œå…¶ä¸­ N æ˜¯é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ã€‚</p><p>å½“é“¾è¡¨ä¸­ä¸å­˜åœ¨ç¯æ—¶ï¼Œå¿«æŒ‡é’ˆå°†å…ˆäºæ…¢æŒ‡é’ˆåˆ°è¾¾é“¾è¡¨å°¾éƒ¨ï¼Œé“¾è¡¨ä¸­æ¯ä¸ªèŠ‚ç‚¹è‡³å¤šè¢«è®¿é—®ä¸¤æ¬¡ã€‚</p><p>å½“é“¾è¡¨ä¸­å­˜åœ¨ç¯æ—¶ï¼Œæ¯ä¸€è½®ç§»åŠ¨åï¼Œå¿«æ…¢æŒ‡é’ˆçš„è·ç¦»å°†å‡å°ä¸€ã€‚è€Œåˆå§‹è·ç¦»ä¸ºç¯çš„é•¿åº¦ï¼Œå› æ­¤è‡³å¤šç§»åŠ¨ N è½®ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚æˆ‘ä»¬åªä½¿ç”¨äº†ä¸¤ä¸ªæŒ‡é’ˆçš„é¢å¤–ç©ºé—´ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å“ˆå¸Œè¡¨å’Œå¿«æ…¢æŒ‡é’ˆä¸¤ç§æ–¹å¼è¿›è¡Œäº†æ±‚è§£</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸‘æ•°IIï¼ˆåå…­ï¼‰</title>
    <link href="/2022/08/20/A16-%E4%B8%91%E6%95%B0II%EF%BC%88%E5%8D%81%E5%85%AD%EF%BC%89/"/>
    <url>/2022/08/20/A16-%E4%B8%91%E6%95%B0II%EF%BC%88%E5%8D%81%E5%85%AD%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬äºŒç™¾å…­åå››é¢˜ï¼š<a href="https://leetcode.cn/problems/ugly-number-ii/">ä¸‘æ•° II</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œå †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰ã€</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°Â <code>n</code>Â ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ç¬¬Â <code>n</code>Â ä¸ªÂ <strong>ä¸‘æ•°</strong>Â ã€‚</p><p><strong>ä¸‘æ•°</strong> å°±æ˜¯åªåŒ…å«è´¨å› æ•°Â <code>2</code>ã€<code>3</code>Â å’Œ&#x2F;æˆ–Â <code>5</code>Â çš„æ­£æ•´æ•°ã€‚</p><p><strong>Tips</strong>ï¼š</p><p>1ã€è´¨æ•°ï¼šé™¤äº† 1 åˆå®ƒæœ¬èº«ï¼Œä¸èƒ½è¢«å…¶ä»–æ•°æ•´é™¤ï¼Œæˆ‘ä»¬ç§°ä¸ºè´¨æ•°ã€‚å¦‚ 2ï¼Œ3ï¼Œ5ç­‰ç­‰</p><p>2ã€è´¨å› æ•°ï¼šå°±æ˜¯ä¸€ä¸ªæ•°çš„çº¦æ•°ï¼Œå¹¶ä¸”æ˜¯è´¨æ•°ã€‚å¦‚ 8 &#x3D; 2 x 2 x 2ï¼Œå› ä¸º 2 ä¹Ÿæ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ 2 æ˜¯ 8 çš„è´¨å› æ•°</p><p>3ã€çº¦æ•°ï¼ša èƒ½è¢« b æ•´é™¤å¹¶ä¸”æ²¡æœ‰ä½™æ•°ï¼Œæˆ‘ä»¬å°±ç§° a æ˜¯ b çš„å€æ•°ï¼Œb æ˜¯ a çš„çº¦æ•°ã€‚å¦‚ 12 &#x3D; 2 x 2 x 3ï¼Œé‚£ä¹ˆ 2ï¼Œ3éƒ½æ˜¯ 12 çš„çº¦æ•°</p><p>4ã€1 é€šå¸¸è¢«è§†ä½œä¸‘æ•°</p><p>5ã€ä¸‘æ•°ï¼šå°±æ˜¯åªåŒ…å«è´¨å› æ•° 2ã€3 å’Œ 5 çš„æ­£æ•´æ•°ã€‚å¦‚ 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ8ç­‰ç­‰</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">è¾“å…¥ï¼šn = <span class="hljs-number">10</span><br>è¾“å‡ºï¼š<span class="hljs-number">12</span><br>è§£é‡Šï¼š<span class="hljs-string">[1, 2, 3, 4, 5, 6, 8, 9, 10, 12]</span> æ˜¯ç”±å‰ <span class="hljs-number">10</span> ä¸ªä¸‘æ•°ç»„æˆçš„åºåˆ—ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šn <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>è¾“å‡ºï¼š<span class="hljs-number">1</span><br>è§£é‡Šï¼š<span class="hljs-number">1</span> é€šå¸¸è¢«è§†ä¸ºä¸‘æ•°ã€‚<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1 &lt;&#x3D; n &lt;&#x3D; 1690</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æœ¬é¢˜ä½¿ç”¨æœ€å°å †çš„æ€æƒ³ï¼Œæœ€å°å †ä¸­çˆ¶èŠ‚ç‚¹çš„å€¼è¦å°äºä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚è¦å¾—åˆ°ä»å°åˆ°å¤§çš„ç¬¬ n ä¸ªä¸‘æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€å°å †å®ç°ã€‚</p><p>åˆå§‹æ—¶å †ä¸ºç©ºã€‚é¦–å…ˆå°†æœ€å°çš„ä¸‘æ•° 1 åŠ å…¥å †ã€‚</p><p>æ¯æ¬¡å–å‡ºå †é¡¶å…ƒç´  xï¼Œåˆ™ x æ˜¯å †ä¸­æœ€å°çš„ä¸‘æ•°ï¼Œç”±äº 2x,3x,5x ä¹Ÿæ˜¯ä¸‘æ•°ï¼Œå› æ­¤å°† 2x,3x,5x åŠ å…¥å †ã€‚</p><p>ä¸Šè¿°åšæ³•ä¼šå¯¼è‡´å †ä¸­å‡ºç°é‡å¤å…ƒç´ çš„æƒ…å†µã€‚ä¸ºäº†é¿å…é‡å¤å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨å“ˆå¸Œé›†åˆå»é‡ï¼Œé¿å…ç›¸åŒå…ƒç´ å¤šæ¬¡åŠ å…¥å †ã€‚</p><p>åœ¨æ’é™¤é‡å¤å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œç¬¬ n æ¬¡ä»æœ€å°å †ä¸­å–å‡ºçš„å…ƒç´ å³ä¸ºç¬¬ n ä¸ªä¸‘æ•°ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nthUglyNumber</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>        <span class="hljs-type">int</span>[] factors = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>&#125;;<br>        Set&lt;Long&gt; seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;Long&gt;();<br>        PriorityQueue&lt;Long&gt; heap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;Long&gt;();<br>        seen.add(<span class="hljs-number">1L</span>);<br>        heap.offer(<span class="hljs-number">1L</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">ugly</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">long</span> <span class="hljs-variable">curr</span> <span class="hljs-operator">=</span> heap.poll();<br>            ugly = (<span class="hljs-type">int</span>) curr;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> factor : factors) &#123;<br>                <span class="hljs-type">long</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> curr * factor;<br>                <span class="hljs-keyword">if</span> (seen.add(next)) &#123;<br>                    heap.offer(next);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ugly;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œä½¿ç”¨æœ€å°å † + å“ˆå¸Œè¡¨çš„æ€æƒ³èƒ½å¿«é€Ÿè§£å†³æ­¤éœ€æ±‚ã€‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç››æœ€å¤šæ°´çš„å®¹å™¨ï¼ˆåäº”ï¼‰</title>
    <link href="/2022/08/19/A15-%E7%9B%9B%E6%9C%80%E5%A4%9A%E6%B0%B4%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89/"/>
    <url>/2022/08/19/A15-%E7%9B%9B%E6%9C%80%E5%A4%9A%E6%B0%B4%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬åä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/container-with-most-water/">ç››æœ€å¤šæ°´çš„å®¹å™¨</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„Â heightÂ ã€‚æœ‰Â nÂ æ¡å‚çº¿ï¼Œç¬¬ i æ¡çº¿çš„ä¸¤ä¸ªç«¯ç‚¹æ˜¯Â (i, 0)Â å’ŒÂ (i, height[i])Â ã€‚</p><p>æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸Â xÂ è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p><p>è¿”å›å®¹å™¨å¯ä»¥å‚¨å­˜çš„æœ€å¤§æ°´é‡ã€‚</p><p><strong>è¯´æ˜</strong>ï¼šä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0541bd4bccad4e36b5a8f8b09663bbeb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns">è¾“å…¥ï¼š[<span class="hljs-number">1,8,6,2</span>,<span class="hljs-number">5,4,8,3</span>,<span class="hljs-number">7</span>]<br>è¾“å‡ºï¼š<span class="hljs-number">49</span> <br>è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [<span class="hljs-number">1,8,6,2</span>,<span class="hljs-number">5,4,8,3</span>,<span class="hljs-number">7</span>]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸ºÂ <span class="hljs-number">49</span>ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">è¾“å…¥ï¼š height = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€n &#x3D;&#x3D; height.length</p><p>2ã€2 &lt;&#x3D; n &lt;&#x3D; 10^5</p><p>3ã€0 &lt;&#x3D; height[i] &lt;&#x3D; 10^4</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æœ¬é“ç®—æ³•é¢˜çš„æœ€ä¼˜åšæ³•æ˜¯é‡‡ç”¨åŒæŒ‡é’ˆã€‚</p><p>æˆ‘ä»¬å…ˆä»é¢˜ç›®ä¸­çš„ç¤ºä¾‹å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥åœ°è§£é‡ŠåŒæŒ‡é’ˆç®—æ³•çš„è¿‡ç¨‹ï¼Œé¢˜ç›®ä¸­çš„ç¤ºä¾‹ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[<span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>]<br> ^                       ^<br></code></pre></td></tr></table></figure><p>åœ¨åˆå§‹æ—¶ï¼Œå·¦å³æŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æ•°ç»„çš„å·¦å³ä¸¤ç«¯ï¼Œå®ƒä»¬å¯ä»¥å®¹çº³çš„æ°´é‡ä¸º min(1,7) * 8 &#x3D; 8ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦ç§»åŠ¨ä¸€ä¸ªæŒ‡é’ˆã€‚ç§»åŠ¨å“ªä¸€ä¸ªå‘¢ï¼Ÿç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œåº”è¯¥ç§»åŠ¨å¯¹åº”æ•°å­—è¾ƒå°çš„é‚£ä¸ªæŒ‡é’ˆï¼ˆå³æ­¤æ—¶çš„å·¦æŒ‡é’ˆï¼‰ã€‚è¿™æ˜¯å› ä¸ºï¼Œç”±äºå®¹çº³çš„æ°´é‡æ˜¯ç”±ï¼š<strong>ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°å­—ä¸­è¾ƒå°å€¼ * æŒ‡é’ˆä¹‹é—´çš„è·ç¦»</strong> å†³å®šçš„ã€‚</p><p>å¦‚æœæˆ‘ä»¬ç§»åŠ¨æ•°å­—è¾ƒå¤§çš„é‚£ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆå‰è€…ã€Œä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°å­—ä¸­è¾ƒå°å€¼ã€ä¸ä¼šå¢åŠ ï¼Œåè€…ã€ŒæŒ‡é’ˆä¹‹é—´çš„è·ç¦»ã€ä¼šå‡å°ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹˜ç§¯ä¼šå‡å°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç§»åŠ¨æ•°å­—è¾ƒå¤§çš„é‚£ä¸ªæŒ‡é’ˆæ˜¯ä¸åˆç†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬<strong>ç§»åŠ¨æ•°å­—è¾ƒå°çš„é‚£ä¸ªæŒ‡é’ˆ</strong>ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°†å·¦æŒ‡é’ˆå‘å³ç§»åŠ¨ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[1, 8, 6, 2, 5, 4, 8, 3, 7]</span><br>    ^                    ^<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å®¹çº³çš„æ°´é‡ä¸º min(8,7) * 7 &#x3D; 49ã€‚ç”±äºå³æŒ‡é’ˆå¯¹åº”çš„æ•°å­—è¾ƒå°ï¼Œæˆ‘ä»¬ç§»åŠ¨å³æŒ‡é’ˆï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[1, 8, 6, 2, 5, 4, 8, 3, 7]</span><br>    ^                 ^<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å®¹çº³çš„æ°´é‡ä¸º min(8,3) * 6 &#x3D; 18ã€‚ç”±äºå³æŒ‡é’ˆå¯¹åº”çš„æ•°å­—è¾ƒå°ï¼Œæˆ‘ä»¬ç§»åŠ¨å³æŒ‡é’ˆï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[1, 8, 6, 2, 5, 4, 8, 3, 7]</span><br>    ^              ^<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å®¹çº³çš„æ°´é‡ä¸º min(8,8) * 5 &#x3D; 40ã€‚ä¸¤æŒ‡é’ˆå¯¹åº”çš„æ•°å­—ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„ç§»åŠ¨ä¸€ä¸ªï¼Œä¾‹å¦‚å·¦æŒ‡é’ˆï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[1, 8, 6, 2, 5, 4, 8, 3, 7]</span><br>       ^           ^<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å®¹çº³çš„æ°´é‡ä¸º min(6,8) * 4 &#x3D; 24ã€‚ç”±äºå·¦æŒ‡é’ˆå¯¹åº”çš„æ•°å­—è¾ƒå°ï¼Œæˆ‘ä»¬ç§»åŠ¨å·¦æŒ‡é’ˆï¼Œå¹¶ä¸”å¯ä»¥å‘ç°ï¼Œåœ¨è¿™ä¹‹åå·¦æŒ‡é’ˆå¯¹åº”çš„æ•°å­—æ€»æ˜¯è¾ƒå°ï¼Œå› æ­¤æˆ‘ä»¬ä¼šä¸€ç›´ç§»åŠ¨å·¦æŒ‡é’ˆï¼Œç›´åˆ°ä¸¤ä¸ªæŒ‡é’ˆé‡åˆã€‚åœ¨è¿™æœŸé—´ï¼Œå¯¹åº”çš„å¯ä»¥å®¹çº³çš„æ°´é‡ä¸ºï¼šmin(2,8) * 3 &#x3D; 6ï¼Œmin(5,8) * 2 &#x3D; 10ï¼Œmin(4,8) * 1 &#x3D; 4ã€‚</p><p>åœ¨æˆ‘ä»¬ç§»åŠ¨æŒ‡é’ˆçš„è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—åˆ°çš„æœ€å¤šå¯ä»¥å®¹çº³çš„æ•°é‡ä¸º 49ï¼Œå³ä¸ºæœ€ç»ˆçš„ç­”æ¡ˆã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxArea</span><span class="hljs-params">(<span class="hljs-type">int</span>[] height)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>,end = height.length - <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(start &lt; end)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">container</span> <span class="hljs-operator">=</span> Math.min(height[start],height[end]) * (end - start);<br>            max = Math.max(max,container);<br>            <span class="hljs-keyword">if</span>(height[start] &lt; height[end])&#123;<br>                start++;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                end--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> max;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼ŒåŒæŒ‡é’ˆæ€»è®¡æœ€å¤šéå†æ•´ä¸ªæ•°ç»„ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œåªéœ€è¦é¢å¤–çš„å¸¸æ•°çº§åˆ«çš„ç©ºé—´ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½èƒ½è£…å¤šå°‘æ°´æ˜¯ç”±æœ€çŸ®çš„é‚£å—çŸ­æ¿è§£å†³çš„ï¼Œé…åˆåŒæŒ‡é’ˆå¹¶èƒ½è½»æ¾çš„è§£å†³æ­¤éœ€æ±‚</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éªŒè¯IPåœ°å€ï¼ˆåå››ï¼‰</title>
    <link href="/2022/08/18/A14-%E9%AA%8C%E8%AF%81IP%E5%9C%B0%E5%9D%80%EF%BC%88%E5%8D%81%E5%9B%9B%EF%BC%89/"/>
    <url>/2022/08/18/A14-%E9%AA%8C%E8%AF%81IP%E5%9C%B0%E5%9D%80%EF%BC%88%E5%8D%81%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ç¬¬å››ç™¾å…­åå…«é¢˜ï¼š<a href="https://leetcode.cn/problems/validate-ip-address/">éªŒè¯IPåœ°å€</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œå­—ç¬¦ä¸²ã€</p><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²Â <code>queryIP</code>ã€‚å¦‚æœæ˜¯æœ‰æ•ˆçš„ IPv4 åœ°å€ï¼Œè¿”å›Â <code>&quot;IPv4&quot;</code>Â ï¼›å¦‚æœæ˜¯æœ‰æ•ˆçš„ IPv6 åœ°å€ï¼Œè¿”å›Â <code>&quot;IPv6&quot;</code>Â ï¼›å¦‚æœä¸æ˜¯ä¸Šè¿°ç±»å‹çš„ IP åœ°å€ï¼Œè¿”å›Â <code>&quot;Neither&quot;</code>Â ã€‚</p><p><strong>æœ‰æ•ˆçš„IPv4åœ°å€</strong>Â æ˜¯Â <code>â€œx1.x2.x3.x4â€</code>Â å½¢å¼çš„IPåœ°å€ã€‚ å…¶ä¸­Â <code>0 &lt;= xiÂ &lt;= 255</code>Â ä¸”Â <code>xi</code>Â <strong>ä¸èƒ½åŒ…å«</strong>Â å‰å¯¼é›¶ã€‚ä¾‹å¦‚:Â <code>â€œ192.168.1.1â€</code>Â ã€Â <code>â€œ192.168.1.0â€</code>Â ä¸ºæœ‰æ•ˆIPv4åœ°å€ï¼ŒÂ <code>â€œ192.168.01.1â€</code>Â ä¸ºæ— æ•ˆIPv4åœ°å€;Â <code>â€œ192.168.1.00â€</code>Â ã€Â <code>â€œ192.168@1.1â€</code>Â ä¸ºæ— æ•ˆIPv4åœ°å€ã€‚</p><p><strong>ä¸€ä¸ªæœ‰æ•ˆçš„IPv6åœ°å€</strong> æ˜¯ä¸€ä¸ªæ ¼å¼ä¸º<code>â€œx1:x2:x3:x4:x5:x6:x7:x8â€</code>Â çš„IPåœ°å€ï¼Œå…¶ä¸­:</p><ul><li><code>1 &lt;= xi.length &lt;= 4</code></li><li><code>xi</code>Â æ˜¯ä¸€ä¸ªÂ <strong>åå…­è¿›åˆ¶å­—ç¬¦ä¸²</strong>Â ï¼Œå¯ä»¥åŒ…å«æ•°å­—ã€å°å†™è‹±æ–‡å­—æ¯(Â <code>&#39;a&#39;</code>Â åˆ°Â <code>&#39;f&#39;</code>Â )å’Œå¤§å†™è‹±æ–‡å­—æ¯(Â <code>&#39;A&#39;</code>Â åˆ°Â <code>&#39;F&#39;</code>Â )ã€‚</li><li>åœ¨Â <code>xi</code>Â ä¸­å…è®¸å‰å¯¼é›¶ã€‚</li></ul><p>å¦‚Â <code>&quot;2001:0db8:85a3:0000:0000:8a2e:0370:7334&quot;</code>Â å’ŒÂ <code>&quot;2001:db8:85a3:0:0:8A2E:0370:7334&quot;</code>Â æ˜¯æœ‰æ•ˆçš„ IPv6 åœ°å€ï¼Œè€ŒÂ <code>&quot;2001:0db8:85a3::8A2E:037j:7334&quot;</code>Â å’ŒÂ <code>&quot;02001:0db8:85a3:0000:0000:8a2e:0370:7334&quot;</code>Â æ˜¯æ— æ•ˆçš„ IPv6 åœ°å€ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼š queryIP <span class="hljs-operator">=</span> <span class="hljs-string">&quot;172.16.254.1&quot;</span><br>è¾“å‡ºï¼š <span class="hljs-string">&quot;IPv4&quot;</span><br>è§£é‡Šï¼š æœ‰æ•ˆçš„ IPv4 åœ°å€ï¼Œè¿”å› <span class="hljs-string">&quot;IPv4&quot;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼š queryIP <span class="hljs-operator">=</span> <span class="hljs-string">&quot;2001:0db8:85a3:0:0:8A2E:0370:7334&quot;</span><br>è¾“å‡ºï¼š <span class="hljs-string">&quot;IPv6&quot;</span><br>è§£é‡Šï¼š æœ‰æ•ˆçš„ IPv6 åœ°å€ï¼Œè¿”å› <span class="hljs-string">&quot;IPv6&quot;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼š queryIP <span class="hljs-operator">=</span> <span class="hljs-string">&quot;256.256.256.256&quot;</span><br>è¾“å‡ºï¼š <span class="hljs-string">&quot;Neither&quot;</span><br>è§£é‡Šï¼š æ—¢ä¸æ˜¯ IPv4 åœ°å€ï¼Œåˆä¸æ˜¯ IPv6 åœ°å€<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p><code>queryIP</code>Â ä»…ç”±è‹±æ–‡å­—æ¯ï¼Œæ•°å­—ï¼Œå­—ç¬¦Â <code>.</code>Â å’ŒÂ <code>:</code>Â ç»„æˆã€‚</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ï¼‰ã€åˆ¤æ–­ queryIP æ˜¯å¦åŒ…å«<code>.</code>ï¼Œå¦‚æœåŒ…å«ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åˆ¤æ–­å…¶æ˜¯å¦ä¸º IPv4 åœ°å€ï¼›å¦‚æœä¸åŒ…å«ï¼Œæˆ‘ä»¬åˆ™åˆ¤æ–­å…¶æ˜¯å¦ä¸º IPv6 åœ°å€</p><p>2ï¼‰ã€å¯¹äº IPv4 åœ°å€è€Œè¨€ï¼Œå®ƒåŒ…å« 4 ä¸ªéƒ¨åˆ†ï¼Œç”¨<code>.</code>éš”å¼€ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å­˜å‚¨ç›¸é‚»ä¸¤ä¸ª<code>.</code>å‡ºç°çš„ä½ç½® last å’Œ curï¼ˆå½“è€ƒè™‘é¦–ä¸ªéƒ¨åˆ†æ—¶ï¼Œlast&#x3D;âˆ’1ï¼›å½“è€ƒè™‘æœ€åä¸€ä¸ªéƒ¨åˆ†æ—¶ï¼Œcur&#x3D;nï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼‰ï¼Œé‚£ä¹ˆå­ä¸² queryIP[last+1..curâˆ’1] å°±å¯¹åº”ç€ä¸€ä¸ªéƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦åˆ¤æ–­ï¼š</p><blockquote><p>1ã€å®ƒçš„é•¿åº¦æ˜¯å¦åœ¨ [1,3] ä¹‹é—´ï¼ˆè™½ç„¶è¿™ä¸€æ­¥æ²¡æœ‰æ˜¾å¼è¦æ±‚ï¼Œä½†æå‰åˆ¤æ–­å¯ä»¥é˜²æ­¢åç»­è®¡ç®—å€¼æ—¶ 32 ä½æ•´æ•°æ— æ³•è¡¨ç¤ºçš„æƒ…å†µï¼‰ï¼›</p><p>2ã€å®ƒæ˜¯å¦åªåŒ…å«æ•°å­—ï¼›</p><p>3ã€å®ƒçš„å€¼æ˜¯å¦åœ¨ [0,255] ä¹‹é—´ï¼›</p><p>4ã€å®ƒæ˜¯å¦ä¸åŒ…å«å‰å¯¼é›¶ã€‚å…·ä½“åœ°ï¼Œå¦‚æœå®ƒçš„å€¼ä¸º 0ï¼Œé‚£ä¹ˆè¯¥éƒ¨åˆ†åªèƒ½åŒ…å«ä¸€ä¸ª 0ï¼Œå³ (curâˆ’1)âˆ’(last+1)+1&#x3D;1ï¼›å¦‚æœå®ƒçš„å€¼ä¸ä¸º 0ï¼Œé‚£ä¹ˆè¯¥éƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªæ•°å­—ä¸èƒ½ä¸º 0ï¼Œå³ queryIP[last+1] ä¸ä¸º 0ã€‚</p></blockquote><p>3ï¼‰ã€å¯¹äº IPv6 åœ°å€è€Œè¨€ï¼Œå®ƒåŒ…å« 8 ä¸ªéƒ¨åˆ†ï¼Œç”¨<code>:</code>éš”å¼€ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å­˜å‚¨ç›¸é‚»ä¸¤ä¸ª<code>:</code>å‡ºç°çš„ä½ç½® last å’Œ curï¼Œé‚£ä¹ˆå­ä¸² queryIP[last+1..curâˆ’1] å°±å¯¹åº”ç€ä¸€ä¸ªéƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦åˆ¤æ–­ï¼š</p><blockquote><p>1ã€å®ƒçš„é•¿åº¦æ˜¯å¦åœ¨ [1,4] ä¹‹é—´ï¼›</p><p>2ã€å®ƒæ˜¯å¦åªåŒ…å«æ•°å­—ï¼Œæˆ–è€… a-fï¼Œæˆ–è€… A-Fï¼›</p></blockquote><p>é™¤äº†ä¸Šè¿°æƒ…å†µä»¥å¤–ï¼Œå¦‚æœæˆ‘ä»¬æ— æ³•æ‰¾åˆ°å¯¹åº”æ•°é‡çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆç»™å®šçš„å­—ç¬¦ä¸²ä¹Ÿä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ IP åœ°å€ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">validIPAddress</span><span class="hljs-params">(String queryIP)</span> &#123;<br>        <span class="hljs-keyword">if</span> (queryIP.indexOf(<span class="hljs-string">&#x27;.&#x27;</span>) &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// IPv4</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">last</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> (i == <span class="hljs-number">3</span> ? queryIP.length() : queryIP.indexOf(<span class="hljs-string">&#x27;.&#x27;</span>, last + <span class="hljs-number">1</span>));<br>                <span class="hljs-keyword">if</span> (cur &lt; <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (cur - last - <span class="hljs-number">1</span> &lt; <span class="hljs-number">1</span> || cur - last - <span class="hljs-number">1</span> &gt; <span class="hljs-number">3</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">addr</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> last + <span class="hljs-number">1</span>; j &lt; cur; ++j) &#123;<br>                    <span class="hljs-keyword">if</span> (!Character.isDigit(queryIP.charAt(j))) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                    &#125;<br>                    addr = addr * <span class="hljs-number">10</span> + (queryIP.charAt(j) - <span class="hljs-string">&#x27;0&#x27;</span>);<br>                &#125;<br>                <span class="hljs-keyword">if</span> (addr &gt; <span class="hljs-number">255</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (addr &gt; <span class="hljs-number">0</span> &amp;&amp; queryIP.charAt(last + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (addr == <span class="hljs-number">0</span> &amp;&amp; cur - last - <span class="hljs-number">1</span> &gt; <span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                last = cur;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;IPv4&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// IPv6</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">last</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; ++i) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> (i == <span class="hljs-number">7</span> ? queryIP.length() : queryIP.indexOf(<span class="hljs-string">&#x27;:&#x27;</span>, last + <span class="hljs-number">1</span>));<br>                <span class="hljs-keyword">if</span> (cur &lt; <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (cur - last - <span class="hljs-number">1</span> &lt; <span class="hljs-number">1</span> || cur - last - <span class="hljs-number">1</span> &gt; <span class="hljs-number">4</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> last + <span class="hljs-number">1</span>; j &lt; cur; ++j) &#123;<br>                    <span class="hljs-keyword">if</span> (!Character.isDigit(queryIP.charAt(j)) &amp;&amp; !(<span class="hljs-string">&#x27;a&#x27;</span> &lt;= Character.toLowerCase(queryIP.charAt(j)) &amp;&amp; Character.toLowerCase(queryIP.charAt(j)) &lt;= <span class="hljs-string">&#x27;f&#x27;</span>)) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Neither&quot;</span>;<br>                    &#125;<br>                &#125;<br>                last = cur;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;IPv6&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² queryIP çš„é•¿åº¦ã€‚æˆ‘ä»¬åªéœ€è¦éå†å­—ç¬¦ä¸²å¸¸æ•°æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œåªä½¿ç”¨åˆ°å¸¸æ•°ä¸ªå˜é‡ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºä¸­ç­‰ï¼Œå…³é”®æ˜¯ä¸€äº›ç»†èŠ‚éœ€è¦è€ƒè™‘åˆ°ä½</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘çš„ä¸­åºéå†ï¼ˆåä¸‰ï¼‰</title>
    <link href="/2022/08/17/A13-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89/"/>
    <url>/2022/08/17/A13-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬ä¹åå››é¢˜ï¼š<a href="https://leetcode.cn/problems/binary-tree-inorder-traversal/?favorite=2cktkvj">äºŒå‰æ ‘çš„ä¸­åºéå†</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ ˆã€ã€ã€Œæ ‘ã€ã€ã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€ã€ã€ŒäºŒå‰æ ‘ã€</p><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹Â <code>root</code>Â ï¼Œè¿”å›å®ƒçš„Â <strong>ä¸­åº</strong>Â éå†Â ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/90000efd3b594d41a429c19327683f63~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" width="50%" /><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼š root = <span class="hljs-comment">[1,null,2,3]</span><br>è¾“å‡ºï¼š <span class="hljs-comment">[1,3,2]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼š root = <span class="hljs-comment">[]</span><br>è¾“å‡ºï¼š <span class="hljs-comment">[]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼š root = <span class="hljs-comment">[1]</span><br>è¾“å‡ºï¼š <span class="hljs-comment">[1]</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´Â <code>[0, 100]</code>Â å†…</p><p>2ã€<code>-100 &lt;= Node.val &lt;= 100</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç™½ä¸­åºéå†çš„ç‰¹ç‚¹ï¼š<strong>å…ˆè®¿é—®å·¦å­æ ‘ï¼Œä¸­é—´è®¿é—®æ ¹èŠ‚ç‚¹ï¼Œæœ€åè®¿é—®å³å­æ ‘</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§æ–¹æ³•è¿›è¡Œæ±‚è§£ï¼š</p><h3 id="2-1ã€æ³•ä¸€ï¼šé€’å½’"><a href="#2-1ã€æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="2.1ã€æ³•ä¸€ï¼šé€’å½’"></a>2.1ã€æ³•ä¸€ï¼šé€’å½’</h3><p>1ï¼‰ã€æŒ‰ç…§è®¿é—®<code>å·¦å­æ ‘â€”â€”æ ¹èŠ‚ç‚¹â€”â€”å³å­æ ‘</code>çš„æ–¹å¼éå†è¿™æ£µæ ‘</p><p>2ï¼‰ã€åœ¨è®¿é—®å·¦å­æ ‘æˆ–å³å­æ ‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŒ‰ç…§åŒæ ·çš„æ–¹å¼éå†ï¼Œç›´åˆ°éå†å®Œæ•´æ£µæ ‘</p><p>3ï¼‰ã€æ•´ä¸ªéå†è¿‡ç¨‹å¤©ç„¶å…·æœ‰é€’å½’çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨é€’å½’å‡½æ•°æ¥æ¨¡æ‹Ÿè¿™ä¸€è¿‡ç¨‹</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * public class TreeNode &#123;</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     TreeNode left;</span><br><span class="hljs-comment"> *     TreeNode right;</span><br><span class="hljs-comment"> *     TreeNode() &#123;&#125;</span><br><span class="hljs-comment"> *     TreeNode(int val) &#123; this.val = val; &#125;</span><br><span class="hljs-comment"> *     TreeNode(int val, TreeNode left, TreeNode right) &#123;</span><br><span class="hljs-comment"> *         this.val = val;</span><br><span class="hljs-comment"> *         this.left = left;</span><br><span class="hljs-comment"> *         this.right = right;</span><br><span class="hljs-comment"> *     &#125;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">inorderTraversal</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        List&lt;Integer&gt; keys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>        middleErgodic(root,keys);<br>        <span class="hljs-keyword">return</span> keys;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">middleErgodic</span><span class="hljs-params">(TreeNode root,List&lt;Integer&gt; keys)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">if</span>(root.left != <span class="hljs-literal">null</span>)&#123;<br>            middleErgodic(root.left,keys);<br>        &#125;<br>        <br>        keys.add(root.val);<br>        <br>        <span class="hljs-keyword">if</span>(root.right != <span class="hljs-literal">null</span>)&#123;<br>            middleErgodic(root.right,keys);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚äºŒå‰æ ‘çš„éå†ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸€æ¬¡ä¸”åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚ç©ºé—´å¤æ‚åº¦å–å†³äºé€’å½’çš„æ ˆæ·±åº¦ï¼Œè€Œæ ˆæ·±åº¦åœ¨äºŒå‰æ ‘ä¸ºä¸€æ¡é“¾çš„æƒ…å†µä¸‹ä¼šè¾¾åˆ° O(n) çš„çº§åˆ«ã€‚</p><h3 id="2-2ã€æ³•äºŒï¼šè¿­ä»£"><a href="#2-2ã€æ³•äºŒï¼šè¿­ä»£" class="headerlink" title="2.2ã€æ³•äºŒï¼šè¿­ä»£"></a>2.2ã€æ³•äºŒï¼šè¿­ä»£</h3><p>æ³•ä¸€çš„é€’å½’æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿­ä»£çš„æ–¹å¼å®ç°ï¼Œä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼ŒåŒºåˆ«åœ¨äºé€’å½’éšå¼åœ°ç»´æŠ¤äº†ä¸€ä¸ªæ ˆï¼Œè€Œæˆ‘ä»¬åœ¨è¿­ä»£çš„æ—¶å€™éœ€è¦æ˜¾å¼åœ°å°†è¿™ä¸ªæ ˆæ¨¡æ‹Ÿå‡ºæ¥ï¼Œå…¶ä»–éƒ½ç›¸åŒã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">inorderTraversal</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        List&lt;Integer&gt; keys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        Deque&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>        <span class="hljs-keyword">while</span>(root != <span class="hljs-literal">null</span> || !stack.isEmpty())&#123;<br>            <span class="hljs-keyword">while</span>(root != <span class="hljs-literal">null</span>)&#123;<br>                stack.push(root);<br>                root = root.left;<br>            &#125;<br><br>            root = stack.pop();<br>            keys.add(root.val);<br>            root = root.right;<br>        &#125;<br>        <span class="hljs-keyword">return</span> keys;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚äºŒå‰æ ‘çš„éå†ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸€æ¬¡ä¸”åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚ç©ºé—´å¤æ‚åº¦å–å†³äºæ ˆæ·±åº¦ï¼Œè€Œæ ˆæ·±åº¦åœ¨äºŒå‰æ ‘ä¸ºä¸€æ¡é“¾çš„æƒ…å†µä¸‹ä¼šè¾¾åˆ° O(n) çš„çº§åˆ«ã€‚</p><p>ä¾è‘«èŠ¦ç”»ç“¢ï¼š<a href="https://leetcode.cn/problems/binary-tree-preorder-traversal/description/">å‰åºéå†</a>ï¼Œ<a href="https://leetcode.cn/problems/binary-tree-postorder-traversal/description/">ååºéå†</a>ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼è¿›è¡Œæ±‚è§£</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>é€’å½’</code>ï¼Œ<code>è¿­ä»£</code>ä¸¤ç§æ–¹æ³•è¿›è¡Œäº†å¿«é€Ÿæ±‚è§£ï¼Œä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼åŒæ ·å¯ä»¥è§£å†³å‰åºéå†å’Œååºéå†çš„é—®é¢˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘ä¸Šç¯‡</title>
    <link href="/2022/08/17/D6-%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%8A%E7%AF%87/"/>
    <url>/2022/08/17/D6-%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%8A%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ç‰¹å¾"><a href="#ä¸€ã€ç‰¹å¾" class="headerlink" title="ä¸€ã€ç‰¹å¾"></a>ä¸€ã€ç‰¹å¾</h2><h3 id="1-1ã€æ ‘çš„åŸºæœ¬å®šä¹‰"><a href="#1-1ã€æ ‘çš„åŸºæœ¬å®šä¹‰" class="headerlink" title="1.1ã€æ ‘çš„åŸºæœ¬å®šä¹‰"></a>1.1ã€æ ‘çš„åŸºæœ¬å®šä¹‰</h3><p>æ ‘æ˜¯æˆ‘ä»¬è®¡ç®—æœºä¸­éå¸¸é‡è¦çš„ä¸€ç§æ•°æ®ç»“æ„ï¼ŒåŒæ—¶ä½¿ç”¨æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥æè¿°ç°å®ç”Ÿæ´»ä¸­çš„å¾ˆå¤šäº‹ç‰©ï¼Œä¾‹å¦‚å®¶è°±ã€å•ä½çš„ç»„ç»‡æ¶<br>æ„ç­‰ç­‰</p><p>æ ‘æ˜¯ç”± nï¼ˆn&gt;&#x3D;1ï¼‰ä¸ªæœ‰é™ç»“ç‚¹ç»„æˆä¸€ä¸ªå…·æœ‰å±‚æ¬¡å…³ç³»çš„é›†åˆã€‚æŠŠå®ƒå«åš<code>æ ‘</code>æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥åƒä¸€æ£µå€’æŒ‚çš„æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯æ ¹æœä¸Šï¼Œè€Œå¶æœä¸‹çš„ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6515e8a2e684ec9aca0e032550dc2eb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>æ ‘å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><p>1ã€æ¯ä¸ªèŠ‚ç‚¹æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå­èŠ‚ç‚¹</p><p>2ã€æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹</p><p>3ã€æ¯ä¸€ä¸ªéæ ¹èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹</p><p>4ã€æ¯ä¸ªèŠ‚ç‚¹åŠå…¶åä»£èŠ‚ç‚¹æ•´ä½“ä¸Šå¯ä»¥çœ‹ä½œæ˜¯ä¸€æ£µæ ‘ï¼Œç§°ä¸ºå½“å‰èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„ä¸€ä¸ªå­æ ‘</p><h3 id="1-2ã€æ ‘çš„ç›¸å…³æœ¯è¯­"><a href="#1-2ã€æ ‘çš„ç›¸å…³æœ¯è¯­" class="headerlink" title="1.2ã€æ ‘çš„ç›¸å…³æœ¯è¯­"></a>1.2ã€æ ‘çš„ç›¸å…³æœ¯è¯­</h3><p><strong>1ã€èŠ‚ç‚¹çš„åº¦</strong></p><p>ä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„å­æ ‘çš„ä¸ªæ•°ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„åº¦</p><p><strong>2ã€å¶å­èŠ‚ç‚¹</strong></p><p>åº¦ä¸º 0 çš„èŠ‚ç‚¹ç§°ä¸ºå¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥å«åšç»ˆç«¯èŠ‚ç‚¹</p><p><strong>3ã€åˆ†æ”¯èŠ‚ç‚¹</strong></p><p>åº¦ä¸ä¸º 0 çš„ç»“ç‚¹ç§°ä¸ºåˆ†æ”¯ç»“ç‚¹ï¼Œä¹Ÿå¯ä»¥å«åšéç»ˆç«¯ç»“ç‚¹</p><p><strong>4ã€èŠ‚ç‚¹çš„å±‚æ¬¡</strong></p><p>ä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œæ ¹ç»“ç‚¹çš„å±‚æ¬¡ä¸º1ï¼Œæ ¹çš„ç›´æ¥åç»§å±‚æ¬¡ä¸º2ï¼Œä»¥æ­¤ç±»æ¨</p><p><strong>5ã€èŠ‚ç‚¹çš„å±‚åºç¼–å·</strong></p><p>å°†æ ‘ä¸­çš„ç»“ç‚¹ï¼ŒæŒ‰ç…§ä»ä¸Šå±‚åˆ°ä¸‹å±‚ï¼ŒåŒå±‚ä»å·¦åˆ°å³çš„æ¬¡åºæ’æˆä¸€ä¸ªçº¿æ€§åºåˆ—ï¼ŒæŠŠä»–ä»¬ç¼–æˆè¿ç»­çš„è‡ªç„¶æ•°ã€‚</p><p><strong>6ã€æ ‘çš„åº¦</strong></p><p>æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹çš„åº¦çš„æœ€å¤§å€¼</p><p><strong>7ã€æ ‘çš„é«˜åº¦ï¼ˆæ·±åº¦ï¼‰</strong></p><p>æ ‘ä¸­ç»“ç‚¹çš„æœ€å¤§å±‚æ¬¡</p><p><strong>8ã€æ£®æ—</strong></p><p>mï¼ˆm&gt;&#x3D;0ï¼‰ä¸ªäº’ä¸ç›¸äº¤çš„æ ‘çš„é›†åˆï¼Œå°†ä¸€æ£µéç©ºæ ‘çš„æ ¹ç»“ç‚¹åˆ å»ï¼Œæ ‘å°±å˜æˆä¸€ä¸ªæ£®æ—ï¼Œç»™æ£®æ—å¢åŠ ä¸€ä¸ªç»Ÿä¸€çš„æ ¹ç»“ç‚¹ï¼Œæ£®æ—å°±å˜æˆä¸€æ£µæ ‘</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/039206b6e5644d92a8082a514a7a353c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" width="50%" /><h2 id="äºŒã€äºŒå‰æ ‘çš„åŸºæœ¬å®šä¹‰"><a href="#äºŒã€äºŒå‰æ ‘çš„åŸºæœ¬å®šä¹‰" class="headerlink" title="äºŒã€äºŒå‰æ ‘çš„åŸºæœ¬å®šä¹‰"></a>äºŒã€äºŒå‰æ ‘çš„åŸºæœ¬å®šä¹‰</h2><p>1ï¼‰ã€äºŒå‰æ ‘å°±æ˜¯åº¦ä¸è¶…è¿‡ 2 çš„æ ‘ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼‰</p><p>2ï¼‰ã€äºŒå‰æ ‘ä¸­è§„å®šçˆ¶èŠ‚ç‚¹çš„å€¼å¤§äºå·¦å­èŠ‚ç‚¹ï¼Œå°äºå³å­èŠ‚ç‚¹</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ff85daa848984cb1bcdb40e776b3f472~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="2-1ã€æ»¡äºŒå‰æ ‘"><a href="#2-1ã€æ»¡äºŒå‰æ ‘" class="headerlink" title="2.1ã€æ»¡äºŒå‰æ ‘"></a>2.1ã€æ»¡äºŒå‰æ ‘</h3><p>1ï¼‰ã€ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå¦‚æœæ¯ä¸€ä¸ªå±‚çš„èŠ‚ç‚¹æ ‘éƒ½è¾¾åˆ°äº†æœ€å¤§å€¼ï¼Œåˆ™æˆ‘ä»¬å°±ç§°è¿™ä¸ªæ ‘ä¸ºæ»¡äºŒå‰æ ‘</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ce82a46126e7426288de58afe156b577~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="2-2ã€å®Œå…¨äºŒå‰æ ‘"><a href="#2-2ã€å®Œå…¨äºŒå‰æ ‘" class="headerlink" title="2.2ã€å®Œå…¨äºŒå‰æ ‘"></a>2.2ã€å®Œå…¨äºŒå‰æ ‘</h3><p>1ï¼‰ã€å¶å­èŠ‚ç‚¹åªèƒ½å‡ºç°åœ¨æœ€ä¸‹å±‚å’Œæ¬¡ä¸‹å±‚ï¼Œå¹¶ä¸”æœ€ä¸‹é¢ä¸€å±‚çš„èŠ‚ç‚¹éƒ½é›†ä¸­åœ¨è¯¥å±‚æœ€å·¦è¾¹çš„è‹¥å¹²ä½ç½®çš„äºŒå‰æ ‘ï¼ˆå³æœ€ä¸‹é¢çš„å¶å­èŠ‚ç‚¹å¿…é¡»æ˜¯ä»å·¦åˆ°å³ä¸€æ¬¡æ’åˆ—ï¼‰</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da1a6fead94c4a2fb3acc1d6d8c1d5ac~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»ï¼š</p><p>1ã€æ ‘çš„åŸºæœ¬å®šä¹‰å’Œç›¸å…³ç‰¹å¾</p><p>2ã€äºŒå‰æ ‘çš„å®šä¹‰å’Œç‰¹å¾</p><p>3ã€æ»¡äºŒå‰æ ‘å’Œå®Œå…¨äºŒå‰æ ‘çš„æ¦‚å¿µ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰æ•ˆçš„æ‹¬å·ï¼ˆåäºŒï¼‰</title>
    <link href="/2022/08/16/A12-%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
    <url>/2022/08/16/A12-%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒåé¢˜ï¼š<a href="https://leetcode.cn/problems/valid-parentheses/?favorite=2cktkvj">æœ‰æ•ˆçš„æ‹¬å·</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ ˆã€ã€ã€Œå­—ç¬¦ä¸²ã€ã€ã€Œå“ˆå¸Œè¡¨ã€</p><p>ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ â€˜(â€˜ï¼Œâ€™)â€™ï¼Œâ€™{â€˜ï¼Œâ€™}â€™ï¼Œâ€™[â€˜ï¼Œâ€™]â€™ çš„å­—ç¬¦ä¸² s ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚</p><p>æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š</p><p>1ã€å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚</p><p>2ã€å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚</p><p>3ã€æ¯ä¸ªå³æ‹¬å·éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç›¸åŒç±»å‹çš„å·¦æ‹¬å·ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;()&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;()[]&#123;&#125;&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;(]&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>1 &lt;= s.length &lt;= 104</code></p><p>2ã€<code>s</code> ä»…ç”±æ‹¬å· <code>&#39;()[]&#123;&#125;&#39;</code> ç»„æˆ</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ï¼‰ã€è¿™é“é¢˜æˆ‘ä»¬ä½¿ç”¨æ ˆ + å“ˆå¸Œè¡¨èƒ½å¤Ÿå¿«é€Ÿçš„è§£å†³é—®é¢˜</p><p>2ï¼‰ã€å¦‚æœ c æ˜¯å·¦æ‹¬å·ï¼Œåˆ™å…¥æ ˆ pushï¼›å¦åˆ™é€šè¿‡å“ˆå¸Œè¡¨åˆ¤æ–­æ‹¬å·å¯¹åº”å…³ç³»ï¼Œè‹¥ stack æ ˆé¡¶å‡ºæ ˆæ‹¬å· stack.pop() ä¸å½“å‰éå†æ‹¬å· c ä¸å¯¹åº”ï¼Œåˆ™æå‰è¿”å› falseã€‚</p><p>3ï¼‰ã€åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæå‰å‘ç°ä¸ç¬¦åˆçš„æ‹¬å·å¹¶ä¸”è¿”å›ï¼Œæå‡ç®—æ³•æ•ˆç‡</p><p>4ï¼‰ã€è§£å†³è¾¹ç•Œé—®é¢˜</p><blockquote><p>1ã€å¦‚æœæ ˆ stack ä¸ºç©ºï¼šæ­¤æ—¶ stack.pop() æ“ä½œä¼šæŠ¥é”™ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªå–å·§æ–¹æ³•ï¼Œç»™ stack èµ‹åˆå€¼ä¸º ï¼Ÿï¼Œå¹¶åœ¨å“ˆå¸Œè¡¨ dic ä¸­å»ºç«‹ keyï¼Œvalue ä¸º ï¼Ÿçš„å¯¹åº”å…³ç³»äºˆä»¥é…åˆã€‚æ­¤æ—¶å½“ stack ä¸ºç©ºä¸” c ä¸ºå³æ‹¬å·æ—¶ï¼Œå¯ä»¥æ­£å¸¸æå‰è¿”å› false</p><p>2ã€å­—ç¬¦ä¸² s ä»¥å·¦æ‹¬å·ç»“å°¾ï¼šæ­¤æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸éå†å®Œæ•´ä¸ª sï¼Œä½† stack ä¸­é—ç•™æœªå‡ºæ ˆçš„å·¦æ‹¬å·ï¼Œå› æ­¤ï¼Œæœ€åéœ€è¿”å› len(stack) &#x3D; 1 ï¼Œä»¥åˆ¤æ–­æ˜¯å¦æ˜¯æœ‰æ•ˆçš„æ‹¬å·ç»„åˆ</p></blockquote><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;Character, Character&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Character, Character&gt;() &#123;&#123;<br>        put(<span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>);<br>        put(<span class="hljs-string">&#x27;[&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>);<br>        put(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>);<br>        put(<span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>);<br>    &#125;&#125;;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-keyword">if</span> (s.length() &gt; <span class="hljs-number">0</span> &amp;&amp; !map.containsKey(s.charAt(<span class="hljs-number">0</span>))) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        LinkedList&lt;Character&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;Character&gt;() &#123;&#123;<br>            add(<span class="hljs-string">&#x27;?&#x27;</span>);<br>        &#125;&#125;;<br>        <span class="hljs-keyword">for</span> (Character c : s.toCharArray()) &#123;<br>            <span class="hljs-keyword">if</span> (map.containsKey(c)) stack.addLast(c);<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (map.get(stack.removeLast()) != c) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> stack.size() == <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œæ­£ç¡®çš„æ‹¬å·ç»„åˆéœ€è¦éå† n éï¼Œn ä¸º s çš„é•¿åº¦ï¼›</p><p>2ã€ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå“ˆå¸Œè¡¨å’Œæ ˆä½¿ç”¨çº¿æ€§çš„ç©ºé—´å¤§å°ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ ˆ + å“ˆå¸Œè¡¨çš„æ–¹æ³•è¿›è¡Œäº†å¿«é€Ÿæ±‚è§£</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç§»åŠ¨é›¶ï¼ˆåä¸€ï¼‰</title>
    <link href="/2022/08/15/A11-%E7%A7%BB%E5%8A%A8%E9%9B%B6%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89/"/>
    <url>/2022/08/15/A11-%E7%A7%BB%E5%8A%A8%E9%9B%B6%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒç™¾å…«åä¸‰é¢˜ï¼š<a href="https://leetcode.cn/problems/move-zeroes/?favorite=2cktkvj">ç§»åŠ¨é›¶</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <code>nums</code>ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ‰€æœ‰ <code>0</code> ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼ŒåŒæ—¶ä¿æŒéé›¶å…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚</p><p><strong>è¯·æ³¨æ„</strong> ï¼Œå¿…é¡»åœ¨ä¸å¤åˆ¶æ•°ç»„çš„æƒ…å†µä¸‹åŸåœ°å¯¹æ•°ç»„è¿›è¡Œæ“ä½œã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: nums = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">12</span>]<br>è¾“å‡º: [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">12</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: nums = [<span class="hljs-number">0</span>]<br>è¾“å‡º: [<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>1 &lt;= nums.length &lt;= 104</code></p><p>2ã€<code>-231 &lt;= nums[i] &lt;= 231 - 1</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="2-1ã€æ³•ä¸€ï¼šä¸¤æ¬¡å¾ªç¯éå†"><a href="#2-1ã€æ³•ä¸€ï¼šä¸¤æ¬¡å¾ªç¯éå†" class="headerlink" title="2.1ã€æ³•ä¸€ï¼šä¸¤æ¬¡å¾ªç¯éå†"></a>2.1ã€æ³•ä¸€ï¼šä¸¤æ¬¡å¾ªç¯éå†</h3><p>1ï¼‰ã€æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆ i å’Œ jï¼Œç¬¬ä¸€æ¬¡éå†çš„æ—¶å€™æŒ‡é’ˆ j ç”¨æ¥è®°å½•å½“å‰æœ‰å¤šå°‘é 0 å…ƒç´ ã€‚å³éå†çš„æ—¶å€™æ¯é‡åˆ°ä¸€ä¸ªé 0 å…ƒç´ å°±å°†å…¶å¾€æ•°ç»„å·¦è¾¹æŒªï¼Œç¬¬ä¸€æ¬¡éå†å®Œåï¼Œj æŒ‡é’ˆçš„ä¸‹æ ‡å°±æŒ‡å‘äº†æœ€åä¸€ä¸ªé 0 å…ƒç´ ä¸‹æ ‡ã€‚</p><p>2ï¼‰ã€ç¬¬äºŒæ¬¡éå†çš„æ—¶å€™ï¼Œèµ·å§‹ä½ç½®å°±ä» j å¼€å§‹åˆ°ç»“æŸï¼Œå°†å‰©ä¸‹çš„è¿™æ®µåŒºåŸŸå†…çš„å…ƒç´ å…¨éƒ¨ç½®ä¸º 0ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">moveZeroes</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br><span class="hljs-keyword">if</span>(nums==<span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-comment">//ç¬¬ä¸€æ¬¡éå†çš„æ—¶å€™ï¼ŒjæŒ‡é’ˆè®°å½•é0çš„ä¸ªæ•°ï¼Œåªè¦æ˜¯é0çš„ç»Ÿç»Ÿéƒ½èµ‹ç»™nums[j]</span><br><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.length;++i) &#123;<br>            <span class="hljs-keyword">if</span>(nums[i]!=<span class="hljs-number">0</span>) &#123;<br>nums[j++] = nums[i];<br>            &#125;<br>&#125;<br><span class="hljs-comment">//é0å…ƒç´ ç»Ÿè®¡å®Œäº†ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯0äº†</span><br><span class="hljs-comment">//æ‰€ä»¥ç¬¬äºŒæ¬¡éå†æŠŠæœ«å°¾çš„å…ƒç´ éƒ½èµ‹ä¸º0å³å¯</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=j;i&lt;nums.length;++i) &#123;<br>            nums[i] = <span class="hljs-number">0</span>;<br>&#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œn ä¸º nums çš„é•¿åº¦ï¼Œä¸¤æ¬¡ for å¾ªç¯åˆ™ä¸º 2n ï¼Œå»é™¤å¸¸æ•°é¡¹ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ä½¿ç”¨åˆ°å¸¸æ•°ä¸ªå˜é‡</p><h3 id="2-2ã€æ³•äºŒï¼šä¸€æ¬¡å¾ªç¯éå†"><a href="#2-2ã€æ³•äºŒï¼šä¸€æ¬¡å¾ªç¯éå†" class="headerlink" title="2.2ã€æ³•äºŒï¼šä¸€æ¬¡å¾ªç¯éå†"></a>2.2ã€æ³•äºŒï¼šä¸€æ¬¡å¾ªç¯éå†</h3><p>1ï¼‰ã€è¿™é‡Œæˆ‘ä»¬å‚è€ƒå¿«é€Ÿæ’åºçš„æ€æƒ³ï¼Œå¿«é€Ÿæ’åºé¦–å…ˆè¦ç¡®å®šä¸€ä¸ªå¾…åˆ†å‰²çš„å…ƒç´ åšä¸­é—´ç‚¹ xï¼Œç„¶åæŠŠæ‰€æœ‰å°äºç­‰äº x çš„å…ƒç´ æ”¾åˆ° x çš„å·¦è¾¹ï¼Œå¤§äº x çš„å…ƒç´ æ”¾åˆ°å…¶å³è¾¹ã€‚</p><p>2ï¼‰ã€è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ 0 å½“åšè¿™ä¸ªä¸­é—´ç‚¹ï¼ŒæŠŠä¸ç­‰äº 0ï¼ˆæ³¨æ„é¢˜ç›®æ²¡è¯´ä¸èƒ½æœ‰è´Ÿæ•°ï¼‰çš„æ”¾åˆ°ä¸­é—´ç‚¹çš„å·¦è¾¹ï¼Œç­‰äº 0 çš„æ”¾åˆ°å…¶å³è¾¹ã€‚</p><p>3ï¼‰ã€è¿™çš„ä¸­é—´ç‚¹å°±æ˜¯ 0 æœ¬èº«ï¼Œæ‰€ä»¥å®ç°èµ·æ¥æ¯”å¿«é€Ÿæ’åºç®€å•å¾ˆå¤šï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆ i å’Œ jï¼Œåªè¦ nums[i] !&#x3D; 0ï¼Œæˆ‘ä»¬å°±äº¤æ¢ nums[i] å’Œnums[j]</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">moveZeroes</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br><span class="hljs-keyword">if</span>(nums==<span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-comment">//ä¸¤ä¸ªæŒ‡é’ˆiå’Œj</span><br><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.length;i++) &#123;<br>            <span class="hljs-comment">//å½“å‰å…ƒç´ !=0ï¼Œå°±æŠŠå…¶äº¤æ¢åˆ°å·¦è¾¹ï¼Œç­‰äº0çš„äº¤æ¢åˆ°å³è¾¹</span><br>            <span class="hljs-keyword">if</span>(nums[i]!=<span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> nums[i];<br>                nums[i] = nums[j];<br>                nums[j++] = tmp;<br>            &#125;<br>&#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦: O(n)ï¼Œn ä¸º nums çš„é•¿åº¦</p><p>ç©ºé—´å¤æ‚åº¦: O(1)ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ä½¿ç”¨åˆ°å¸¸æ•°ä¸ªå˜é‡</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åŒæŒ‡é’ˆ + for å¾ªç¯çš„æ–¹æ³•è¿›è¡Œäº†æ±‚è§£ï¼Œæœ€åé€šè¿‡å¿«é€Ÿæ’åºçš„æ€æƒ³å¯¹ç®—æ³•è¿›è¡Œäº†ä¼˜åŒ–</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åè½¬é“¾è¡¨ï¼ˆåï¼‰</title>
    <link href="/2022/08/14/A10-%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%EF%BC%89/"/>
    <url>/2022/08/14/A10-%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8%EF%BC%88%E5%8D%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒç™¾é›¶å…­é¢˜ï¼š<a href="https://leetcode.cn/problems/reverse-linked-list/?favorite=2cktkvj">åè½¬é“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€ã€ã€ŒåŒæŒ‡é’ˆã€</p><p>ç»™ä½ å•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ï¼Œè¯·ä½ åè½¬é“¾è¡¨ï¼Œå¹¶è¿”å›åè½¬åçš„é“¾è¡¨ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0dccdd06268f4f00b555808c1f4f8fba~tplv-k3u1fbpfcp-watermark.image" alt="image-20221216192215040.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a4bb85dcb8348bb9bcd59c374a325d0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221216192243061.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šhead = []<br>è¾“å‡ºï¼š[]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ <code>[0, 5000]</code></p><p>2ã€<code>-5000 &lt;= Node.val &lt;= 5000</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="2-1ã€æ³•ä¸€"><a href="#2-1ã€æ³•ä¸€" class="headerlink" title="2.1ã€æ³•ä¸€"></a>2.1ã€æ³•ä¸€</h3><p>1ï¼‰ã€æˆ‘ä»¬å¯ä»¥ç”³è¯·ä¸¤ä¸ªæŒ‡é’ˆï¼Œç¬¬ä¸€ä¸ªæŒ‡é’ˆå« preï¼Œæœ€åˆæ˜¯æŒ‡å‘ null çš„ã€‚</p><p>2ï¼‰ã€ç¬¬äºŒä¸ªæŒ‡é’ˆ cur æŒ‡å‘ headï¼Œç„¶åä¸æ–­éå† curã€‚</p><p>3ï¼‰ã€æ¯æ¬¡è¿­ä»£åˆ° curï¼Œéƒ½å°† cur çš„ next æŒ‡å‘ preï¼Œç„¶å pre å’Œ cur å‰è¿›ä¸€ä½ã€‚</p><p>4ï¼‰ã€éƒ½è¿­ä»£å®Œäº†(cur å˜æˆ null äº†)ï¼Œpre å°±æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹äº†ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">reverseList</span><span class="hljs-params">(ListNode head)</span> &#123;<br><span class="hljs-comment">//ç”³è¯·èŠ‚ç‚¹ï¼Œpreå’Œ curï¼ŒpreæŒ‡å‘null</span><br><span class="hljs-type">ListNode</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> head;<br><span class="hljs-type">ListNode</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">while</span>(cur!=<span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-comment">//è®°å½•å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>    tmp = cur.next;<br>    <span class="hljs-comment">//ç„¶åå°†å½“å‰èŠ‚ç‚¹æŒ‡å‘pre</span><br>    cur.next = pre;<br>    <span class="hljs-comment">//preå’ŒcurèŠ‚ç‚¹éƒ½å‰è¿›ä¸€ä½</span><br>    pre = cur;<br>    cur = tmp;<br>&#125;<br><span class="hljs-keyword">return</span> pre;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯é“¾è¡¨çš„é•¿åº¦ã€‚éœ€è¦éå†é“¾è¡¨ä¸€æ¬¡ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</p><h3 id="2-2ã€æ³•äºŒ"><a href="#2-2ã€æ³•äºŒ" class="headerlink" title="2.2ã€æ³•äºŒ"></a>2.2ã€æ³•äºŒ</h3><p>1ï¼‰ã€è¿™é¢˜æœ‰ä¸ªå¾ˆéªšæ°”çš„é€’å½’è§£æ³•ï¼Œé€’å½’è§£æ³•å¾ˆä¸å¥½ç†è§£ï¼Œè¿™é‡Œæœ€å¥½é…åˆä»£ç å’ŒåŠ¨ç”»ä¸€èµ·ç†è§£ã€‚ é€’å½’çš„ä¸¤ä¸ªæ¡ä»¶ï¼š</p><p>2ï¼‰ã€ç»ˆæ­¢æ¡ä»¶æ˜¯å½“å‰èŠ‚ç‚¹æˆ–è€…ä¸‹ä¸€ä¸ªèŠ‚ç‚¹&#x3D;&#x3D;nullï¼Œåœ¨å‡½æ•°å†…éƒ¨ï¼Œæ”¹å˜èŠ‚ç‚¹çš„æŒ‡å‘ï¼Œä¹Ÿå°±æ˜¯ head çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘ head é€’å½’å‡½æ•°é‚£å¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">head.next.next = head<br></code></pre></td></tr></table></figure><p>3ï¼‰ã€å¾ˆä¸å¥½ç†è§£ï¼Œå…¶å®å°±æ˜¯ head çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘headã€‚é€’å½’å‡½æ•°ä¸­æ¯æ¬¡è¿”å›çš„ cur å…¶å®åªæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œåœ¨é€’å½’å‡½æ•°å†…éƒ¨ï¼Œæ”¹å˜çš„æ˜¯å½“å‰èŠ‚ç‚¹çš„æŒ‡å‘ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">reverseList</span><span class="hljs-params">(ListNode head)</span> &#123;<br><span class="hljs-comment">//é€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯å½“å‰ä¸ºç©ºï¼Œæˆ–è€…ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç©º</span><br><span class="hljs-keyword">if</span>(head==<span class="hljs-literal">null</span> || head.next==<span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-keyword">return</span> head;<br>&#125;<br><span class="hljs-comment">//è¿™é‡Œçš„curå°±æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹</span><br><span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> reverseList(head.next);<br><span class="hljs-comment">//è¿™é‡Œè¯·é…åˆåŠ¨ç”»æ¼”ç¤ºç†è§£</span><br><span class="hljs-comment">//å¦‚æœé“¾è¡¨æ˜¯ 1-&gt;2-&gt;3-&gt;4-&gt;5ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„curå°±æ˜¯5</span><br><span class="hljs-comment">//è€Œheadæ˜¯4ï¼Œheadçš„ä¸‹ä¸€ä¸ªæ˜¯5ï¼Œä¸‹ä¸‹ä¸€ä¸ªæ˜¯ç©º</span><br><span class="hljs-comment">//æ‰€ä»¥head.next.next å°±æ˜¯5-&gt;4</span><br>head.next.next = head;<br><span class="hljs-comment">//é˜²æ­¢é“¾è¡¨å¾ªç¯ï¼Œéœ€è¦å°†head.nextè®¾ç½®ä¸ºç©º</span><br>head.next = <span class="hljs-literal">null</span>;<br><span class="hljs-comment">//æ¯å±‚é€’å½’å‡½æ•°éƒ½è¿”å›curï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹</span><br><span class="hljs-keyword">return</span> cur;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åŒæŒ‡é’ˆå’Œé€’å½’ä¸¤ç§è§£æ³•è¿›è¡Œäº†å®ç°</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï¼ˆä¹ï¼‰</title>
    <link href="/2022/08/13/A9-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA%EF%BC%88%E4%B9%9D%EF%BC%89/"/>
    <url>/2022/08/13/A9-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA%EF%BC%88%E4%B9%9D%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒåä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/?favorite=2cktkvj">ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œè´ªå¿ƒç®—æ³•ã€</p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <code>prices</code> ï¼Œå®ƒçš„ç¬¬ <code>i</code> ä¸ªå…ƒç´  <code>prices[i]</code> è¡¨ç¤ºä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ <code>i</code> å¤©çš„ä»·æ ¼ã€‚</p><p>ä½ åªèƒ½é€‰æ‹© <strong>æŸä¸€å¤©</strong> ä¹°å…¥è¿™åªè‚¡ç¥¨ï¼Œå¹¶é€‰æ‹©åœ¨ <strong>æœªæ¥çš„æŸä¸€ä¸ªä¸åŒçš„æ—¥å­</strong> å–å‡ºè¯¥è‚¡ç¥¨ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚</p><p>è¿”å›ä½ å¯ä»¥ä»è¿™ç¬”äº¤æ˜“ä¸­è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚å¦‚æœä½ ä¸èƒ½è·å–ä»»ä½•åˆ©æ¶¦ï¼Œè¿”å› <code>0</code> ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼š [<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>]<br>è¾“å‡ºï¼š <span class="hljs-number">5</span><br>è§£é‡Šï¼š åœ¨ç¬¬ <span class="hljs-number">2</span> å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = <span class="hljs-number">1</span>ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ <span class="hljs-number">5</span> å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = <span class="hljs-number">6</span>ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = <span class="hljs-number">6</span>-<span class="hljs-number">1</span> = <span class="hljs-number">5</span> ã€‚<br>      æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ <span class="hljs-number">7</span>-<span class="hljs-number">1</span> = <span class="hljs-number">6</span>, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ï¼›åŒæ—¶ï¼Œä½ ä¸èƒ½åœ¨ä¹°å…¥å‰å–å‡ºè‚¡ç¥¨ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼š prices = [<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š <span class="hljs-number">0</span><br>è§£é‡Šï¼š åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º <span class="hljs-number">0</span>ã€‚<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>1 &lt;= prices.length &lt;= 105</code></p><p>2ã€<code>0 &lt;= prices[i] &lt;= 104</code></p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ã€è¿™é“é¢˜ä½¿ç”¨è´ªå¿ƒç®—æ³•èƒ½å¤Ÿå¿«é€Ÿçš„è®¡ç®—å‡ºç»“æœ</p><p>2ã€è´ªå¿ƒç®—æ³•æ˜¯æŒ‡ï¼šåœ¨å¯¹é—®é¢˜æ±‚è§£æ—¶ï¼Œæ€»æ˜¯åšå‡ºåœ¨å½“å‰çœ‹æ¥æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä»æ•´ä½“æœ€ä¼˜ä¸ŠåŠ ä»¥è€ƒè™‘ï¼Œç®—æ³•å¾—åˆ°çš„æ˜¯åœ¨æŸç§æ„ä¹‰ä¸Šçš„å±€éƒ¨æœ€ä¼˜è§£ã€‚</p><p>é‚£ä¹ˆè¿™é“é¢˜ä½¿ç”¨è´ªå¿ƒç®—æ³•ï¼šåªè¦æ˜¯ä¸Šæ¶¨çš„æˆ‘ä»¬å°±è¦è®¡ç®—ä»–ä»¬çš„å·®å€¼è¿›è¡Œç´¯åŠ ï¼Œä¸éœ€è¦å†æ‰¾å¼€å§‹ä¸Šæ¶¨çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ä¸ºä»€ä¹ˆèƒ½è¿™æ ·è®¡ç®—ï¼Œæˆ‘ä¸¾ä¸ªä¾‹å­ã€‚</p><p>æ¯”å¦‚ a&lt;b&lt;c&lt;dï¼Œå› ä¸ºä» a åˆ° d ä¸€ç›´æ˜¯ä¸Šæ¶¨çš„ï¼Œé‚£ä¹ˆæœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®å€¼å°±æ˜¯ d-aï¼Œä¹Ÿå¯ä»¥å†™æˆ(b-a)+(c-b)+(d-c)ï¼Œææ‡‚äº†è¿™ä¸ªå…¬å¼æ‰€æœ‰çš„ä¸€åˆ‡éƒ½æ˜ç™½äº†ã€‚å¦‚æœè¿˜ä¸æ˜ç™½ï¼Œå¯ä»¥æƒ³è±¡æˆæ•°ç»„ä¸­å‰ä¸€ä¸ªå€¼å‡å»åä¸€ä¸ªå€¼ï¼Œæ„æˆä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—è¿™ä¸ªæ–°æ•°ç»„ä¸­æ­£æ•°çš„å’Œå³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cdc8d48b597342008d6bd9dab7cf6586~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>è¿™é‡Œåªéœ€è¦è®¡ç®—æ–°æ•°ç»„ä¸­æ­£æ•°çš„å’Œï¼Œä¹Ÿå°±æ˜¯<code>4+3=7</code></p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxProfit</span><span class="hljs-params">(<span class="hljs-type">int</span>[] prices)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prices.length - <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-comment">//åŸæ•°ç»„ä¸­å¦‚æœåä¸€ä¸ªå‡å»å‰ä¸€ä¸ªæ˜¯æ­£æ•°ï¼Œè¯´æ˜æ˜¯ä¸Šæ¶¨çš„ï¼Œ</span><br>        <span class="hljs-comment">//æˆ‘ä»¬å°±è¦ç´¯åŠ ï¼Œå¦åˆ™å°±ä¸ç´¯åŠ </span><br>        total += Math.max(prices[i + <span class="hljs-number">1</span>] - prices[i], <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> total;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œn è¡¨ç¤º prices çš„é•¿åº¦ï¼Œæœ€å¤šæ‰§è¡Œ n-1 æ¬¡ï¼Œå»æ‰å¸¸æ•°é¡¹ï¼Œæœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ä½¿ç”¨åˆ°å¸¸æ•°ä¸ªå˜é‡</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨è´ªå¿ƒç®—æ³•å¿«é€Ÿçš„å¾—åˆ°äº†ç­”æ¡ˆ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼ˆå…«ï¼‰</title>
    <link href="/2022/08/12/A8-%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8%EF%BC%88%E5%85%AB%EF%BC%89/"/>
    <url>/2022/08/12/A8-%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8%EF%BC%88%E5%85%AB%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒåä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/merge-two-sorted-lists/?favorite=2cktkvj">åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€ã€ã€Œé€’å½’ã€</p><p>å°†ä¸¤ä¸ªå‡åºé“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„ <strong>å‡åº</strong> é“¾è¡¨å¹¶è¿”å›ã€‚æ–°é“¾è¡¨æ˜¯é€šè¿‡æ‹¼æ¥ç»™å®šçš„ä¸¤ä¸ªé“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„ã€‚ </p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8fe953f4c2ba4a3ead2c1b000af51bdd~tplv-k3u1fbpfcp-watermark.image" alt="image-20221213202757675.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], l2 = [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [], l2 = []<br>è¾“å‡ºï¼š[]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [], l2 = [<span class="hljs-number">0</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€ä¸¤ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹æ•°ç›®èŒƒå›´æ˜¯ <code>[0, 50]</code></p><p>2ã€<code>-100 &lt;= Node.val &lt;= 100</code></p><p>3ã€<code>l1</code> å’Œ <code>l2</code> å‡æŒ‰ <strong>éé€’å‡é¡ºåº</strong> æ’åˆ—</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ã€è¿™é“é¢˜å¯ä»¥ä½¿ç”¨é€’å½’å®ç°ï¼Œæ–°é“¾è¡¨ä¹Ÿä¸éœ€è¦æ„é€ æ–°èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ä¸‹é¢åˆ—ä¸¾é€’å½’ä¸‰ä¸ªè¦ç´ </p><p>2ã€ç»ˆæ­¢æ¡ä»¶ï¼šä¸¤æ¡é“¾è¡¨åˆ†åˆ«åä¸º <code>l1</code> å’Œ <code>l2</code>ï¼Œå½“ <code>l1</code> ä¸ºç©ºæˆ– <code>l2</code> ä¸ºç©ºæ—¶ç»“æŸ</p><p>3ã€è¿”å›å€¼ï¼šæ¯ä¸€å±‚è°ƒç”¨éƒ½è¿”å›æ’åºå¥½çš„é“¾è¡¨å¤´</p><p>4ã€æœ¬çº§é€’å½’å†…å®¹ï¼šå¦‚æœ <code>l1</code> çš„ <code>val</code> å€¼æ›´å°ï¼Œåˆ™å°† <code>l1.next</code> ä¸æ’åºå¥½çš„é“¾è¡¨å¤´ç›¸æ¥ï¼Œ<code>l2</code> åŒç†</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeTwoLists</span><span class="hljs-params">(ListNode l1, ListNode l2)</span> &#123;<br>        <span class="hljs-keyword">if</span> (l1 == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> l2;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (l2 == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> l1;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (l1.val &lt; l2.val) &#123;<br>            l1.next = mergeTwoLists(l1.next, l2);<br>            <span class="hljs-keyword">return</span> l1;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            l2.next = mergeTwoLists(l1, l2.next);<br>            <span class="hljs-keyword">return</span> l2;<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n) ï¼Œmï¼Œn ä¸º l1 å’Œ l2 çš„å…ƒç´ ä¸ªæ•°ã€‚é€’å½’å‡½æ•°æ¯æ¬¡å»æ‰ä¸€ä¸ªå…ƒç´ ï¼ŒçŸ¥é“ä¸¤ä¸ªé“¾è¡¨éƒ½ä¸ºç©ºï¼Œå› æ­¤éœ€è¦è°ƒç”¨ m + n æ¬¡ã€‚è€Œåœ¨é€’å½’å‡½æ•°ä¸­æˆ‘ä»¬åªè¿›è¡Œäº† next æŒ‡é’ˆçš„èµ‹å€¼æ“ä½œï¼Œå¤æ‚åº¦ä¸º O(1)ï¼Œæ•…é€’å½’çš„æ€»æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO((m + n)*1) å¦ m &#x3D; n ï¼Œæœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå¯¹äºé€’å½’è°ƒç”¨ mergeTwoListsï¼Œå½“å®ƒé‡åˆ°ç»ˆæ­¢æ¡ä»¶å‡†å¤‡å›æº¯æ—¶ï¼Œå·²ç»é€’å½’è°ƒç”¨äº† m + n æ¬¡ï¼Œä½¿ç”¨äº† m + n ä¸ªæ ˆå¸§ï¼Œæ•…æ€»ç©ºé—´å¤æ‚åº¦ä¸º O(m + n)ï¼Œå¦ m &#x3D; nï¼Œæœ€ç»ˆç©ºé—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ç®€å•ï¼Œä¸»è¦è€ƒå¯Ÿäº†æˆ‘ä»¬å¯¹é“¾è¡¨å’Œé€’å½’çš„æŒæ¡ï¼Œå…³äºé€’å½’æˆ‘ä»¬åº”è¯¥åšåˆ°ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><blockquote><p>1ã€é€’å½’å‡½æ•°å¿…é¡»è¦æœ‰<strong>ç»ˆæ­¢æ¡ä»¶</strong>ï¼Œå¦åˆ™ä¼šå‡ºé”™</p><p>2ã€é€’å½’å‡½æ•°å…ˆä¸æ–­è°ƒç”¨è‡ªèº«ï¼Œç›´åˆ°é‡åˆ°ç»ˆæ­¢æ¡ä»¶åè¿›è¡Œå›æº¯ï¼Œæœ€ç»ˆè¿”å›ç­”æ¡ˆ</p></blockquote><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜Ÿåˆ—</title>
    <link href="/2022/08/11/D5-%E9%98%9F%E5%88%97/"/>
    <url>/2022/08/11/D5-%E9%98%9F%E5%88%97/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é˜Ÿåˆ—æ˜¯ä¸€ç§åŸºäº FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„æ•°æ®ç»“æ„ï¼Œæ˜¯ä¸€ç§åªèƒ½åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥ï¼Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ“ä½œçš„ç‰¹æ®Šçº¿æ€§è¡¨ã€‚å®ƒæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„åŸåˆ™å­˜å‚¨æ•°æ®ï¼Œå…ˆè¿›å…¥çš„æ•°æ®ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ä¼šå…ˆè¢«è¯»å‡ºæ¥</p><h2 id="ä¸€ã€é˜Ÿåˆ—"><a href="#ä¸€ã€é˜Ÿåˆ—" class="headerlink" title="ä¸€ã€é˜Ÿåˆ—"></a>ä¸€ã€é˜Ÿåˆ—</h2><p>æˆ‘ä»¬ç§°æ•°æ®è¿›å…¥åˆ°é˜Ÿåˆ—çš„åŠ¨ä½œç§°ä¸º<strong>å…¥é˜Ÿ</strong>ï¼Œæ•°æ®ä»é˜Ÿåˆ—ä¸­å‡ºå»çš„åŠ¨ä½œä¸º<strong>å‡ºé˜Ÿ</strong>ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8881590e62445d2aabf67f3ef2802f7~tplv-k3u1fbpfcp-watermark.image" alt="image-20221212203805902.png"></p><h3 id="1-1ã€-API-è®¾è®¡"><a href="#1-1ã€-API-è®¾è®¡" class="headerlink" title="1.1ã€ API è®¾è®¡"></a>1.1ã€ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>Queue&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Queue() ï¼šåˆ›å»º Queue å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€public boolean isEmpty() ï¼šåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º<br>2ã€public int size() ï¼šè·å–é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°<br>3ã€public T enQueue(T t) ï¼šå…¥é˜Ÿ<br>4ã€public void deQueue() ï¼šå‡ºé˜Ÿ</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private Node head ï¼šè®°å½•å¤´èŠ‚ç‚¹<br>2ã€private int N ï¼šå½“å‰é˜Ÿåˆ—çš„å…ƒç´ ä¸ªæ•°<br>3ã€public Node last ï¼šè®°å½•å°¾èŠ‚ç‚¹<br></td></tr><tr><td>æˆå‘˜å†…éƒ¨ç±»</td><td>private class Node ï¼šèŠ‚ç‚¹ç±»</td></tr></tbody></table><h3 id="1-2ã€é˜Ÿåˆ—ä»£ç å®ç°"><a href="#1-2ã€é˜Ÿåˆ—ä»£ç å®ç°" class="headerlink" title="1.2ã€é˜Ÿåˆ—ä»£ç å®ç°"></a>1.2ã€é˜Ÿåˆ—ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Queue</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-keyword">private</span> Node last;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">public</span> T item;<br>        <span class="hljs-keyword">public</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item, Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Queue</span><span class="hljs-params">()</span>&#123;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enQueue</span><span class="hljs-params">(T item)</span>&#123;<br>        <span class="hljs-comment">//å½“å‰å°¾èŠ‚ç‚¹ä¸ºnull</span><br>        <span class="hljs-keyword">if</span>(last == <span class="hljs-literal">null</span>)&#123;<br>            last = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(item, <span class="hljs-literal">null</span>);<br>            head.next = last;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">oldLast</span> <span class="hljs-operator">=</span> last;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(item, <span class="hljs-literal">null</span>);<br>            oldLast.next = newNode;<br>            last = newNode;<br>        &#125;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">deQueue</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(temp == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        head.next = temp.next;<br>        N--;<br>        <span class="hljs-comment">//å› ä¸ºå‡ºé˜Ÿåˆ—å…¶å®æ˜¯åœ¨åˆ é™¤å…ƒç´ ï¼Œå› æ­¤å¦‚æœåˆ é™¤å®Œäº†ï¼Œéœ€è¦é‡ç½® last ä¸ºnull</span><br>        <span class="hljs-keyword">if</span>(isEmpty())&#123;<br>            last = <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3ã€é˜Ÿåˆ—éå†"><a href="#1-3ã€é˜Ÿåˆ—éå†" class="headerlink" title="1.3ã€é˜Ÿåˆ—éå†"></a>1.3ã€é˜Ÿåˆ—éå†</h3><p>æˆ‘ä»¬ä¹Ÿè®© Queue æ”¯æŒå¢å¼º for å¾ªç¯ï¼š</p><p>1ã€è®© Queue å®ç° Iterable æ¥å£ï¼Œé‡å†™ iterator æ¥å£</p><p>2ã€åœ¨ Queue å†…éƒ¨æä¾›ä¸€ä¸ªå†…éƒ¨ç±» QIteratorï¼Œå®ç° Iterator æ¥å£ï¼Œé‡å†™ hasNext() æ–¹æ³•å’Œ next() æ–¹æ³•</p><p>å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Queue</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-keyword">private</span> Node last;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">public</span> T item;<br>        <span class="hljs-keyword">public</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item, Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Queue</span><span class="hljs-params">()</span>&#123;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enQueue</span><span class="hljs-params">(T item)</span>&#123;<br>        <span class="hljs-comment">//å½“å‰å°¾èŠ‚ç‚¹ä¸ºnull</span><br>        <span class="hljs-keyword">if</span>(last == <span class="hljs-literal">null</span>)&#123;<br>            last = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(item, <span class="hljs-literal">null</span>);<br>            head.next = last;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">oldLast</span> <span class="hljs-operator">=</span> last;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(item, <span class="hljs-literal">null</span>);<br>            oldLast.next = newNode;<br>            last = newNode;<br>        &#125;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">deQueue</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(temp == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        head.next = temp.next;<br>        N--;<br>        <span class="hljs-comment">//å› ä¸ºå‡ºé˜Ÿåˆ—å…¶å®æ˜¯åœ¨åˆ é™¤å…ƒç´ ï¼Œå› æ­¤å¦‚æœåˆ é™¤å®Œäº†ï¼Œéœ€è¦é‡ç½® last ä¸ºnull</span><br>        <span class="hljs-keyword">if</span>(isEmpty())&#123;<br>            last = <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br><br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">QIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> Node temp;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">QIterator</span><span class="hljs-params">()</span> &#123;<br>            temp = head;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> temp.next != <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            temp = temp.next;<br>            <span class="hljs-keyword">return</span> temp.item;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  end =================================</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-4ã€é˜Ÿåˆ—æµ‹è¯•"><a href="#1-4ã€é˜Ÿåˆ—æµ‹è¯•" class="headerlink" title="1.4ã€é˜Ÿåˆ—æµ‹è¯•"></a>1.4ã€é˜Ÿåˆ—æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QueueTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Queue&lt;Integer&gt; integerQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>&lt;&gt;();<br>      <span class="hljs-comment">//ä¸€ã€å…¥é˜Ÿ</span><br>        integerQueue.enQueue(<span class="hljs-number">1</span>);<br>        integerQueue.enQueue(<span class="hljs-number">2</span>);<br>        integerQueue.enQueue(<span class="hljs-number">3</span>);<br>        integerQueue.enQueue(<span class="hljs-number">4</span>);<br><br>      <span class="hljs-comment">//äºŒã€å¢å¼º for å¾ªç¯</span><br>        <span class="hljs-keyword">for</span> (Integer integer : integerQueue) &#123;<br>            System.out.println(integer);<br>            <span class="hljs-comment">//1</span><br>            <span class="hljs-comment">//2</span><br>            <span class="hljs-comment">//3</span><br>            <span class="hljs-comment">//4</span><br>        &#125;<br><br>      <span class="hljs-comment">//ä¸‰ã€å‡ºé˜Ÿ</span><br>        <span class="hljs-type">Integer</span> <span class="hljs-variable">integer</span> <span class="hljs-operator">=</span> integerQueue.deQueue();<br>        System.out.println(integer);<span class="hljs-comment">//1</span><br><br>      <span class="hljs-comment">//å››ã€é˜Ÿåˆ—ä¸­å‰©ä½™çš„å…ƒç´ ä¸ªæ•°</span><br>        System.out.println(integerQueue.size());<span class="hljs-comment">//3</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€æ€»ç»“"><a href="#äºŒã€æ€»ç»“" class="headerlink" title="äºŒã€æ€»ç»“"></a>äºŒã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€é˜Ÿåˆ—ï¼šä¸€ç§å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„</p><p>2ã€é˜Ÿåˆ—çš„ API è®¾è®¡ï¼Œä»£ç å®ç°ï¼Œå¢å¼º for å¾ªç¯ï¼Œæµ‹è¯•</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å †</title>
    <link href="/2022/08/10/D4-%E5%A0%86/"/>
    <url>/2022/08/10/D4-%E5%A0%86/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å †çš„å®šä¹‰"><a href="#ä¸€ã€å †çš„å®šä¹‰" class="headerlink" title="ä¸€ã€å †çš„å®šä¹‰"></a>ä¸€ã€å †çš„å®šä¹‰</h2><p>å †æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­ä¸€ç±»ç‰¹æ®Šçš„æ•°æ®ç»“æ„çš„ç»Ÿç§°ï¼Œå †é€šå¸¸å¯ä»¥è¢«çœ‹åšæ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æ•°ç»„å¯¹è±¡ã€‚</p><p><strong>å †çš„ç‰¹æ€§</strong>: </p><p>1ï¼‰ã€å®ƒæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œé™¤äº†æ ‘çš„æœ€åä¸€å±‚ç»“ç‚¹ä¸éœ€è¦æ˜¯æ»¡çš„ï¼Œå…¶å®ƒçš„æ¯ä¸€å±‚ä»å·¦åˆ°å³éƒ½æ˜¯æ»¡çš„ï¼Œå¦‚æœæœ€åä¸€å±‚ç»“ç‚¹ä¸æ˜¯æ»¡çš„ï¼Œé‚£ä¹ˆè¦æ±‚å·¦æ»¡å³ä¸æ»¡ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/36b6464775d241ee9ec941da68cff75f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>2ï¼‰ã€å®ƒé€šå¸¸ç”¨æ•°ç»„æ¥å®ç°ã€‚</p><p>å…·ä½“æ–¹æ³•å°±æ˜¯å°†äºŒå‰æ ‘çš„ç»“ç‚¹æŒ‰ç…§å±‚çº§é¡ºåºæ”¾å…¥æ•°ç»„ä¸­ï¼Œæ ¹ç»“ç‚¹åœ¨ä½ç½® 1ï¼ˆä¹‹æ‰€ä»¥ä¸ä» 0 å¼€å§‹ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ç´¢å¼•çš„æ“ä½œï¼‰ï¼Œå®ƒçš„å­ç»“ç‚¹åœ¨ä½ç½® 2 å’Œ 3ï¼Œè€Œå­ç»“ç‚¹çš„å­ç»“ç‚¹åˆ™åˆ†åˆ«åœ¨ä½ç½® 4.5.6 å’Œ 7ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4fb11a768ff48f081c647c85b186111~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>å¦‚æœä¸€ä¸ªç»“ç‚¹çš„ä½ç½®ä¸ºkï¼Œåˆ™å®ƒçš„çˆ¶ç»“ç‚¹çš„ä½ç½®ä¸º k&#x2F;2 ï¼Œè€Œå®ƒçš„ä¸¤ä¸ªå­ç»“ç‚¹çš„ä½ç½®åˆ™åˆ†åˆ«ä¸º 2k å’Œ 2k+1 ã€‚è¿™æ ·ï¼Œåœ¨ä¸ä½¿ç”¨æŒ‡é’ˆçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è®¡ç®—æ•°ç»„çš„ç´¢å¼•åœ¨æ ‘ä¸­ä¸Šä¸‹ç§»åŠ¨ï¼šä» a[k] å‘ä¸Šä¸€å±‚ï¼Œå°±ä»¤ k  ç­‰äº k&#x2F;2,å‘ä¸‹ä¸€å±‚å°±ä»¤ k ç­‰äº 2k æˆ– 2k+1ã€‚</p><p>3ï¼‰ã€æ¯ä¸ªç»“ç‚¹éƒ½å¤§äºç­‰äºå®ƒçš„ä¸¤ä¸ªå­ç»“ç‚¹ã€‚è¿™é‡Œè¦æ³¨æ„å †ä¸­ä»…ä»…è§„å®šäº†æ¯ä¸ªç»“ç‚¹å¤§äºç­‰äºå®ƒçš„ä¸¤ä¸ªå­ç»“ç‚¹ï¼Œä½†è¿™ä¸¤ä¸ªå­ç»“ç‚¹çš„é¡ºåºå¹¶æ²¡æœ‰åšè§„å®šï¼Œè·Ÿæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><h2 id="äºŒã€å †çš„-API-è®¾è®¡"><a href="#äºŒã€å †çš„-API-è®¾è®¡" class="headerlink" title="äºŒã€å †çš„ API è®¾è®¡"></a>äºŒã€å †çš„ API è®¾è®¡</h2><table><thead><tr><th>ç±»å</th><th><code>Heap&lt;T extends Comparable&lt;T&gt;&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Heap(int capacity) ï¼šåˆ›å»ºå®¹é‡ä¸º capacity çš„ Heap å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€private boolean less(int i,int j) ï¼šåˆ¤æ–­å †ä¸­ç´¢å¼•å¤„çš„å…ƒç´ æ˜¯å¦å°äºç´¢å¼•å¤„çš„å…ƒç´ <br/>2ã€private void exch(int i,int j) ï¼šäº¤æ¢å †ä¸­ç´¢å¼• i å’Œç´¢å¼• j çš„å€¼<br/>3ã€public T delMax() ï¼šåˆ é™¤å †ä¸­æœ€å¤§çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªæœ€å¤§å…ƒç´ <br/>4ã€public void insert(T t) ï¼šå¾€å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ <br/>5ã€private void swim(int k) ï¼šä½¿ç”¨ä¸Šæµ®ç®—æ³•ï¼Œä½¿ç´¢å¼• k å¤„çš„å…ƒç´ èƒ½åœ¨å †ä¸­å¤„äºä¸€ä¸ªæ­£ç¡®çš„ä½ç½®<br/>6ã€private void sink(int k) ï¼šä½¿ç”¨ä¸‹æ²‰ç®—æ³•ï¼Œä½¿ç´¢å¼• k å¤„çš„å…ƒç´ èƒ½åœ¨å †ä¸­å¤„äºä¸€ä¸ªæ­£ç¡®çš„ä½ç½®</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private T[] items ï¼šç”¨æ¥å­˜å‚¨å…ƒç´ çš„æ•°ç»„<br>2ã€private int N ï¼šè®°å½•å †ä¸­å…ƒç´ çš„ä¸ªæ•°</td></tr></tbody></table><h2 id="ä¸‰ã€å †çš„å®ç°"><a href="#ä¸‰ã€å †çš„å®ç°" class="headerlink" title="ä¸‰ã€å †çš„å®ç°"></a>ä¸‰ã€å †çš„å®ç°</h2><h3 id="3-1ã€ä»£ç å®ç°"><a href="#3-1ã€ä»£ç å®ç°" class="headerlink" title="3.1ã€ä»£ç å®ç°"></a>3.1ã€ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Heap</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Comparable</span>&lt;T&gt;&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> T[] items;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Heap</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span>&#123;<br>        items = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparable</span>[capacity + <span class="hljs-number">1</span>];<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">less</span><span class="hljs-params">(<span class="hljs-type">int</span> i,<span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-keyword">return</span> items[i].compareTo(items[j]) &lt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exch</span><span class="hljs-params">(<span class="hljs-type">int</span> i,<span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">T</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> items[i];<br>        items[i] = items[j];<br>        items[j] = temp;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        items[++N] = t;<br>        swim(N);<br>    &#125;<br><br>    <span class="hljs-comment">//ä½¿ç”¨ä¸Šæµ®ç®—æ³•ï¼Œä½¿ç´¢å¼• k å¤„çš„å…ƒç´ èƒ½åœ¨å †ä¸­å¤„äºä¸€ä¸ªæ­£ç¡®çš„ä½ç½®</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span>&#123;<br>        <span class="hljs-comment">//é€šè¿‡å¾ªç¯ï¼Œä¸æ–­æ¯”è¾ƒå½“å‰èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœçˆ¶èŠ‚ç‚¹æ¯”å½“å‰èŠ‚ç‚¹å°åˆ™äº¤æ¢ä½ç½®</span><br>        <span class="hljs-keyword">while</span> (k &gt; <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-comment">//æ¯”è¾ƒå½“å‰èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span>(less(k/<span class="hljs-number">2</span>,k))&#123;<br>                exch(k/<span class="hljs-number">2</span>,k);<br>            &#125;<br>            k = k / <span class="hljs-number">2</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ é™¤å †ä¸­çš„æœ€å¤§å…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">delMax</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">T</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> items[<span class="hljs-number">1</span>];<br>        <span class="hljs-comment">//äº¤æ¢1å’Œæœ€å¤§ç´¢å¼•å¤„çš„ä½ç½®</span><br>        exch(<span class="hljs-number">1</span>,N);<br>        <span class="hljs-comment">//å°†æœ€å¤§ç´¢å¼•å¤„çš„ä½ç½®ç½®ä¸º null</span><br>        items[N] = <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">//å…ƒç´ ä¸ªæ•°å‡1</span><br>        N--;<br>        <span class="hljs-comment">//è®©å †é‡æ–°æœ‰åºï¼Œé€šè¿‡ä¸‹æ²‰è°ƒæ•´å †</span><br>        sink(<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span> max;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sink</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span>&#123;<br>        <span class="hljs-comment">//å¾ªç¯ï¼Œä¸æ–­å¯¹æ¯”å½“å‰ k å’Œå…¶å­èŠ‚ç‚¹ 2k åŠ 2k+1 ä¸­çš„è¾ƒå¤§è€…çš„å…ƒç´ å¤§å°ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹å°ï¼Œåˆ™äº¤æ¢ä½ç½®</span><br>        <span class="hljs-keyword">while</span> (<span class="hljs-number">2</span>*k &lt;= N)&#123;<br>            <span class="hljs-comment">//è·å–å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„è¾ƒå¤§è€…</span><br>            <span class="hljs-type">int</span> max;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*k + <span class="hljs-number">1</span> &lt; N)&#123;<br>                <span class="hljs-comment">//è¯æ˜æœ‰å³å­èŠ‚ç‚¹</span><br>                <span class="hljs-keyword">if</span>(less(<span class="hljs-number">2</span>*k,<span class="hljs-number">2</span>*k + <span class="hljs-number">1</span>))&#123;<br>                    <span class="hljs-comment">//å·¦å­èŠ‚ç‚¹å°äºå³å­èŠ‚ç‚¹</span><br>                    max = <span class="hljs-number">2</span>*k + <span class="hljs-number">1</span>;<br>                &#125;<span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">//å·¦å­èŠ‚ç‚¹å¤§äºå³å­èŠ‚ç‚¹</span><br>                    max = <span class="hljs-number">2</span>*k;<br>                &#125;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                max = <span class="hljs-number">2</span>*k;<br>            &#125;<br>            <span class="hljs-comment">//æ¯”è¾ƒå½“å‰èŠ‚ç‚¹å’Œè¾ƒå¤§è€…çš„å€¼</span><br>            <span class="hljs-keyword">if</span>(!less(k,max))&#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>            <span class="hljs-comment">//äº¤æ¢ k å’Œ max çš„ä½ç½®</span><br>            exch(k,max);<br><br>            k = max;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-2ã€æµ‹è¯•"><a href="#3-2ã€æµ‹è¯•" class="headerlink" title="3.2ã€æµ‹è¯•"></a>3.2ã€æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeapTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Heap&lt;String&gt; heap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Heap</span>&lt;&gt;(<span class="hljs-number">10</span>);<br>        heap.insert(<span class="hljs-string">&quot;A&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;B&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;C&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;D&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;E&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;F&quot;</span>);<br>        heap.insert(<span class="hljs-string">&quot;G&quot;</span>);<br><br>        String delResult;<br>        <span class="hljs-keyword">while</span> ((delResult = heap.delMax()) != <span class="hljs-literal">null</span>)&#123;<br>            System.out.print(delResult + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>G F E D C B A <br></code></pre></td></tr></table></figure><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€å †çš„ç‰¹æ€§ï¼š</p><blockquote><p>1ã€å®ƒæ˜¯å®Œå…¨äºŒå‰æ ‘</p><p>2ã€å®ƒä¸»è¦ç”¨æ•°ç»„å®ç°ã€‚è®¿é—®å½“å‰ k èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸º k&#x2F;2ï¼Œå·¦å­èŠ‚ç‚¹ä¸º 2kï¼Œå³å­èŠ‚ç‚¹ä¸º 2k + 1</p><p>3ã€æ¯ä¸ªèŠ‚ç‚¹å¤§äºç­‰äºå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚æ³¨æ„å’ŒäºŒå‰æ ‘åŒºåˆ†å¼€æ¥</p></blockquote><p>2ã€å †çš„ API è®¾è®¡ï¼Œä»£ç å®ç°ï¼Œå¹¶è¿›è¡Œäº†æµ‹è¯•ç”¨ä¾‹æµ‹è¯•</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ˆ</title>
    <link href="/2022/08/10/D3-%E6%A0%88/"/>
    <url>/2022/08/10/D3-%E6%A0%88/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ ˆæ˜¯ä¸€ç§åŸºäº FILOï¼ˆå…ˆè¿›åå‡ºï¼‰çš„æ•°æ®ç»“æ„ï¼Œæ˜¯ä¸€ç§åªèƒ½åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„ç‰¹æ®Šçº¿æ€§è¡¨ã€‚å®ƒæŒ‰ç…§å…ˆè¿›åå‡ºçš„åŸåˆ™å­˜å‚¨æ•°æ®ï¼Œå…ˆè¿›å…¥çš„æ•°æ®è¢«å‹å…¥æ ˆåº•ï¼Œæœ€åçš„æ•°æ®åœ¨æ ˆé¡¶ï¼Œéœ€è¦è¯»æ•°æ®çš„æ—¶å€™ä»æ ˆé¡¶å¼€å§‹å¼¹å‡ºæ•°æ®ï¼ˆæœ€åä¸€ä¸ªæ•°æ®è¢«ç¬¬ä¸€ä¸ªè¯»å‡ºæ¥ï¼‰ã€‚</p><h2 id="ä¸€ã€æ ˆ"><a href="#ä¸€ã€æ ˆ" class="headerlink" title="ä¸€ã€æ ˆ"></a>ä¸€ã€æ ˆ</h2><p>æˆ‘ä»¬ç§°æ•°æ®è¿›å…¥åˆ°æ ˆçš„åŠ¨ä½œç§°ä¸º<strong>å‹æ ˆ</strong>ï¼Œæ•°æ®ä»æ ˆä¸­å‡ºå»çš„åŠ¨ä½œä¸º<strong>å¼¹æ ˆ</strong>ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72f5db52e5dc4da8bb859e6049509eb2~tplv-k3u1fbpfcp-watermark.image" alt="image-20221211214804900.png"></p><h3 id="1-1ã€æ ˆ-API-è®¾è®¡"><a href="#1-1ã€æ ˆ-API-è®¾è®¡" class="headerlink" title="1.1ã€æ ˆ API è®¾è®¡"></a>1.1ã€æ ˆ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>Stack&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Stack() ï¼šåˆ›å»º Stack å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€public boolean isEmpty() ï¼šåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º<br>2ã€public int size() ï¼šè·å–æ ˆä¸­å…ƒç´ çš„ä¸ªæ•°<br>3ã€public T pop() ï¼šå¼¹å‡ºæ ˆé¡¶å…ƒç´ <br>4ã€public void push(T t) ï¼šå‘æ ˆä¸­å‹å…¥å…ƒç´  t</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private Node head ï¼šè®°å½•å¤´èŠ‚ç‚¹<br>2ã€private int N ï¼šå½“å‰æ ˆçš„å…ƒç´ ä¸ªæ•°</td></tr><tr><td>æˆå‘˜å†…éƒ¨ç±»</td><td>private class Node ï¼šèŠ‚ç‚¹ç±»</td></tr></tbody></table><h3 id="1-2ã€æ ˆä»£ç å®ç°"><a href="#1-2ã€æ ˆä»£ç å®ç°" class="headerlink" title="1.2ã€æ ˆä»£ç å®ç°"></a>1.2ã€æ ˆä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-comment">//è®°å½•å…ƒç´ ä¸ªæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Stack</span><span class="hljs-params">()</span> &#123;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">public</span> Node next;<br>        <span class="hljs-keyword">public</span> T item;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(Node next, T item)</span> &#123;<br>            <span class="hljs-built_in">this</span>.next = next;<br>            <span class="hljs-built_in">this</span>.item = item;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        head.next = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(T item)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, item);<br>        head.next = newNode;<br>        newNode.next = temp;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">pop</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(temp == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        head.next = temp.next;<br>        N--;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3ã€æ ˆéå†"><a href="#1-3ã€æ ˆéå†" class="headerlink" title="1.3ã€æ ˆéå†"></a>1.3ã€æ ˆéå†</h3><p>æˆ‘ä»¬ä¹Ÿè®© Stack æ”¯æŒå¢å¼º for å¾ªç¯ï¼š</p><p>1ã€è®© Stack å®ç° Iterable æ¥å£ï¼Œé‡å†™ iterator æ¥å£</p><p>2ã€åœ¨ Stack å†…éƒ¨æä¾›ä¸€ä¸ªå†…éƒ¨ç±» SIteratorï¼Œå®ç° Iterator æ¥å£ï¼Œé‡å†™ hasNext() æ–¹æ³•å’Œ next() æ–¹æ³•</p><p>å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-comment">//è®°å½•å…ƒç´ ä¸ªæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Stack</span><span class="hljs-params">()</span> &#123;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">public</span> Node next;<br>        <span class="hljs-keyword">public</span> T item;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(Node next, T item)</span> &#123;<br>            <span class="hljs-built_in">this</span>.next = next;<br>            <span class="hljs-built_in">this</span>.item = item;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        head.next = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(T item)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, item);<br>        head.next = newNode;<br>        newNode.next = temp;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">pop</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(temp == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        head.next = temp.next;<br>        N--;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br><br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> Node temp;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">SIterator</span><span class="hljs-params">()</span> &#123;<br>            temp = head;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> temp.next != <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            temp = temp.next;<br>            <span class="hljs-keyword">return</span> temp.item;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  end =================================</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-4ã€æ ˆæµ‹è¯•"><a href="#1-4ã€æ ˆæµ‹è¯•" class="headerlink" title="1.4ã€æ ˆæµ‹è¯•"></a>1.4ã€æ ˆæµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StackTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Stack&lt;String&gt; integerStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();<br>        <span class="hljs-comment">//å‹æ ˆ</span><br>        integerStack.push(<span class="hljs-string">&quot;a&quot;</span>);<br>        integerStack.push(<span class="hljs-string">&quot;b&quot;</span>);<br>        integerStack.push(<span class="hljs-string">&quot;c&quot;</span>);<br>        integerStack.push(<span class="hljs-string">&quot;d&quot;</span>);<br>        <span class="hljs-comment">//ä¸€ã€å¢å¼º for å¾ªç¯éå†</span><br>        <span class="hljs-keyword">for</span> (String str : integerStack) &#123;<br>            System.out.println(str);<br>            <span class="hljs-comment">//d</span><br>            <span class="hljs-comment">//c</span><br>            <span class="hljs-comment">//b</span><br>            <span class="hljs-comment">//a</span><br>            <br>        &#125;<br><br>        <span class="hljs-comment">//äºŒã€å¼¹æ ˆ</span><br>        System.out.println(integerStack.pop());<span class="hljs-comment">//d</span><br>        System.out.println(integerStack.pop());<span class="hljs-comment">//c</span><br><br>        <span class="hljs-comment">//ä¸‰ã€æ¸…ç©º</span><br>        integerStack.clear();<br>        System.out.println(integerStack.size());<span class="hljs-comment">//0</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€æ€»ç»“"><a href="#äºŒã€æ€»ç»“" class="headerlink" title="äºŒã€æ€»ç»“"></a>äºŒã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€æ ˆï¼šä¸€ç§å…ˆè¿›åå‡ºçš„æ•°æ®ç»“æ„</p><p>2ã€æ ˆçš„ API è®¾è®¡ï¼Œä»£ç å®ç°ï¼Œå¢å¼º for å¾ªç¯ï¼Œæµ‹è¯•</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²ï¼ˆä¸ƒï¼‰</title>
    <link href="/2022/08/09/A7-%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2%EF%BC%88%E4%B8%83%EF%BC%89/"/>
    <url>/2022/08/09/A7-%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2%EF%BC%88%E4%B8%83%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬ä¸‰é¢˜ï¼š<a href="https://leetcode.cn/problems/add-two-numbers/?favorite=2cktkvj">æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œæ•°ç»„ã€ã€ã€Œæ»‘åŠ¨çª—å£ã€</p><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: s = <span class="hljs-string">&quot;abcabcbb&quot;</span><br>è¾“å‡º: <span class="hljs-number">3</span> <br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ <span class="hljs-string">&quot;abc&quot;</span>ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º <span class="hljs-number">3</span>ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: s = <span class="hljs-string">&quot;bbbbb&quot;</span><br>è¾“å‡º: <span class="hljs-number">1</span><br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ <span class="hljs-string">&quot;b&quot;</span>ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º <span class="hljs-number">1</span>ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥: s = <span class="hljs-string">&quot;pwwkew&quot;</span><br>è¾“å‡º: <span class="hljs-number">3</span><br>è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯Â <span class="hljs-string">&quot;wke&quot;</span>ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º <span class="hljs-number">3</span>ã€‚<br>Â     è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ<span class="hljs-string">&quot;pwke&quot;</span>Â æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€<code>0 &lt;= s.length &lt;= 5 * 104</code></p><p>2ã€<code>s</code> ç”±è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œç©ºæ ¼ç»„æˆ</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>æš´åŠ›è§£æ³•æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼Œä¼šè¾¾åˆ° O(n^2)ï¼Œæ•…è€Œé‡‡å–æ»‘åŠ¨çª—å£çš„æ–¹æ³•é™ä½æ—¶é—´å¤æ‚åº¦</p><p>ä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿ</p><p>å…¶å®å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—,æ¯”å¦‚ä¸‹å›¾ä¸­çš„ dvdfï¼Œè¿›å…¥è¿™ä¸ªé˜Ÿåˆ—ï¼ˆçª—å£ï¼‰ä¸º dv æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼Œå½“å†è¿›å…¥ dï¼Œé˜Ÿåˆ—å˜æˆäº† dvdï¼Œè¿™æ—¶å€™ä¸æ»¡è¶³è¦æ±‚ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ç§»åŠ¨è¿™ä¸ªé˜Ÿåˆ—ï¼</p><p>å¦‚ä½•ç§»åŠ¨ï¼Ÿ</p><p>æˆ‘ä»¬åªè¦æŠŠé˜Ÿåˆ—çš„å·¦è¾¹çš„å…ƒç´ ç§»å‡ºå°±è¡Œäº†ï¼Œç›´åˆ°æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼</p><p>ä¸€ç›´ç»´æŒè¿™æ ·çš„é˜Ÿåˆ—ï¼Œæ‰¾å‡ºé˜Ÿåˆ—å‡ºç°æœ€é•¿çš„é•¿åº¦æ—¶å€™ï¼Œæ±‚å‡ºè§£ï¼</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/312210235a104de9ac6697fe0fd332df~tplv-k3u1fbpfcp-watermark.image" alt="image-20221210215201969.png"></p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">lengthOfLongestSubstring</span><span class="hljs-params">(String s)</span> &#123;<br>        <span class="hljs-keyword">if</span> (s.length()==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ª map å­˜å‚¨ï¼Œå…¶ä¸­ key å€¼ä¸ºå­—ç¬¦ï¼Œvalue å€¼ä¸ºå­—ç¬¦ä½ç½® +1ï¼ŒåŠ  1 è¡¨ç¤ºä»å­—ç¬¦ä½ç½®åä¸€ä¸ªæ‰å¼€//å§‹ä¸é‡å¤</span><br>        HashMap&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Character, Integer&gt;();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; right &lt; s.length(); right++)&#123;<br>            <span class="hljs-comment">//å¦‚æœå­˜åœ¨ç›¸åŒçš„ key ï¼Œåˆ™ left å¾€å³ç§»åŠ¨</span><br>            <span class="hljs-keyword">if</span>(map.containsKey(s.charAt(right)))&#123;<br>                left = Math.max(left,map.get(s.charAt(right)) + <span class="hljs-number">1</span>);<br>            &#125;<br>            map.put(s.charAt(right),right);<br>            <span class="hljs-comment">//æ¯æ¬¡æ¯”è¾ƒå¹¶è·å–æœ€å¤§æ— é‡å¤å­—ç¬¦å­ä¸²</span><br>            max = Math.max(max,right-left+<span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> max;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆåˆ†åˆ«ä¼šéå†æ•´ä¸ªå­—ç¬¦ä¸²ä¸€æ¬¡</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(|Î£|)ï¼Œå…¶ä¸­ Î£ è¡¨ç¤ºå­—ç¬¦é›†ï¼ˆå³å­—ç¬¦ä¸²ä¸­å¯ä»¥å‡ºç°çš„å­—ç¬¦ï¼‰ï¼Œ|Î£| è¡¨ç¤ºå­—ç¬¦é›†çš„å¤§å°ã€‚åœ¨æœ¬é¢˜ä¸­æ²¡æœ‰æ˜ç¡®è¯´æ˜å­—ç¬¦é›†ï¼Œå› æ­¤å¯ä»¥é»˜è®¤ä¸ºæ‰€æœ‰ ASCII ç åœ¨ [0, 128) å†…çš„å­—ç¬¦ï¼Œå³ |Î£| &#x3D; 128ã€‚æˆ‘ä»¬éœ€è¦ç”¨åˆ°å“ˆå¸Œé›†åˆæ¥å­˜å‚¨å‡ºç°è¿‡çš„å­—ç¬¦ï¼Œè€Œå­—ç¬¦æœ€å¤šæœ‰ |Î£| ä¸ªï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸º O(|Î£|)ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸­ç­‰ï¼Œä¸»è¦è€ƒå¯Ÿäº†æˆ‘ä»¬å¯¹æ»‘åŠ¨çª—å£çš„æŒæ¡ï¼Œå®šä¹‰å¥½å·¦å³æŒ‡é’ˆï¼Œç»“åˆ map åœ¨åˆé€‚çš„æ—¶å€™ç§»åŠ¨æŒ‡é’ˆï¼Œå¹¶èƒ½è½»æ¾çš„è§£å†³è¯¥é¢˜</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸¤æ•°ç›¸åŠ ï¼ˆå…­ï¼‰</title>
    <link href="/2022/08/08/A6-%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0%EF%BC%88%E5%85%AD%EF%BC%89/"/>
    <url>/2022/08/08/A6-%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0%EF%BC%88%E5%85%AD%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬äºŒé¢˜ï¼š<a href="https://leetcode.cn/problems/add-two-numbers/?favorite=2cktkvj">ä¸¤æ•°ç›¸åŠ </a>ï¼Œéš¾åº¦ä¸º <strong>ä¸­ç­‰</strong>ã€‚</p><p>Tagï¼šã€Œé“¾è¡¨ã€</p><p>ç»™ä½ ä¸¤ä¸ª <strong>éç©º</strong> çš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§ <strong>é€†åº</strong> çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ <strong>ä¸€ä½</strong> æ•°å­—ã€‚</p><p>è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚</p><p>ä½ å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0cc010832f084ed38b490afcce5dec68~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221209150556791.png" width="50%" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>], l2 = [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">8</span>]<br>è§£é‡Šï¼š<span class="hljs-number">342</span> + <span class="hljs-number">465</span> = <span class="hljs-number">807.</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [<span class="hljs-number">0</span>], l2 = [<span class="hljs-number">0</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šl1 = [<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>], l2 = [<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>]<br>è¾“å‡ºï¼š[<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>1ã€æ¯ä¸ªé“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ <code>[1, 100]</code> å†…</p><p>2ã€<code>0 &lt;= Node.val &lt;= 9</code></p><p>3ã€é¢˜ç›®æ•°æ®ä¿è¯åˆ—è¡¨è¡¨ç¤ºçš„æ•°å­—ä¸å«å‰å¯¼é›¶</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ã€å°†ä¸¤ä¸ªé“¾è¡¨çœ‹æˆæ˜¯ç›¸åŒé•¿åº¦çš„è¿›è¡Œéå†ï¼Œå¦‚æœä¸€ä¸ªé“¾è¡¨è¾ƒçŸ­åˆ™åœ¨å‰é¢è¡¥ 000ï¼Œæ¯”å¦‚ <code>987 + 23 = 987 + 023 = 1010</code></p><p>2ã€æ¯ä¸€ä½è®¡ç®—çš„åŒæ—¶éœ€è¦è€ƒè™‘ä¸Šä¸€ä½çš„è¿›ä½é—®é¢˜ï¼Œè€Œå½“å‰ä½è®¡ç®—ç»“æŸååŒæ ·éœ€è¦æ›´æ–°è¿›ä½å€¼</p><p>3ã€å¦‚æœä¸¤ä¸ªé“¾è¡¨å…¨éƒ¨éå†å®Œæ¯•åï¼Œè¿›ä½å€¼ä¸º 1ï¼Œåˆ™åœ¨æ–°é“¾è¡¨æœ€å‰æ–¹æ·»åŠ èŠ‚ç‚¹ 1</p><p><strong>Tipsï¼š</strong> å°æŠ€å·§ï¼šå¯¹äºé“¾è¡¨é—®é¢˜ï¼Œè¿”å›ç»“æœä¸ºå¤´ç»“ç‚¹æ—¶ï¼Œé€šå¸¸éœ€è¦å…ˆåˆå§‹åŒ–ä¸€ä¸ªé¢„å…ˆæŒ‡é’ˆ preï¼Œè¯¥æŒ‡é’ˆçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘çœŸæ­£çš„å¤´ç»“ç‚¹headã€‚<strong>ä½¿ç”¨é¢„å…ˆæŒ‡é’ˆçš„ç›®çš„åœ¨äºé“¾è¡¨åˆå§‹åŒ–æ—¶æ— å¯ç”¨èŠ‚ç‚¹å€¼ï¼Œè€Œä¸”é“¾è¡¨æ„é€ è¿‡ç¨‹éœ€è¦æŒ‡é’ˆç§»åŠ¨ï¼Œè¿›è€Œä¼šå¯¼è‡´å¤´æŒ‡é’ˆä¸¢å¤±ï¼Œæ— æ³•è¿”å›ç»“æœã€‚</strong></p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">addTwoNumbers</span><span class="hljs-params">(ListNode l1, ListNode l2)</span> &#123;<br>      <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªé¢„å…ˆæŒ‡é’ˆèŠ‚ç‚¹</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);<br>      <span class="hljs-comment">//è®©å½“å‰èŠ‚ç‚¹æŒ‡å‘é¢„å…ˆæŒ‡é’ˆèŠ‚ç‚¹</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> pre;<br>      <span class="hljs-comment">//è¿›ä½å€¼</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">carry</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(l1 != <span class="hljs-literal">null</span> || l2 != <span class="hljs-literal">null</span>) &#123;<br>          <span class="hljs-comment">//å–ç¬¬ä¸€ä¸ªé“¾è¡¨ä¸­çš„å…ƒç´ </span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> l1 == <span class="hljs-literal">null</span> ? <span class="hljs-number">0</span> : l1.val;<br>          <span class="hljs-comment">//å–ç¬¬äºŒä¸ªé“¾è¡¨ä¸­çš„å…ƒç´ </span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> l2 == <span class="hljs-literal">null</span> ? <span class="hljs-number">0</span> : l2.val;<br>          <span class="hljs-comment">//ç¬¬ä¸€ä¸ªé“¾è¡¨ä¸­çš„å…ƒç´  + ç¬¬äºŒä¸ªé“¾è¡¨ä¸­çš„å…ƒç´  + è¿›ä½å€¼</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> x + y + carry;<br>            <br>          <span class="hljs-comment">//è·å–è¿›ä½å€¼</span><br>            carry = sum / <span class="hljs-number">10</span>;<br>          <span class="hljs-comment">//sum å–ä½™å¾—åˆ°æ¯æ¬¡ç›¸åŠ åçš„å…ƒç´ </span><br>            sum = sum % <span class="hljs-number">10</span>;<br>          <span class="hljs-comment">//è®©å½“å‰èŠ‚ç‚¹çš„ next æŒ‡å‘ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹å…ƒç´ çš„å€¼ä¸º sum</span><br>            cur.next = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(sum);<br><br>         <span class="hljs-comment">//ç§»åŠ¨å½“å‰æŒ‡é’ˆ</span><br>            cur = cur.next;<br>          <span class="hljs-comment">//ç§»åŠ¨ç¬¬ä¸€ä¸ªé“¾è¡¨</span><br>            <span class="hljs-keyword">if</span>(l1 != <span class="hljs-literal">null</span>)<br>                l1 = l1.next;<br>          <span class="hljs-comment">///ç§»åŠ¨ç¬¬äºŒä¸ªé“¾è¡¨</span><br>            <span class="hljs-keyword">if</span>(l2 != <span class="hljs-literal">null</span>)<br>                l2 = l2.next;<br>        &#125;<br>      <span class="hljs-comment">//å¦‚æœå¾ªç¯ç»“æŸï¼Œè¿›ä½å€¼ä¸ä¸º 0ï¼Œåˆ™éœ€è¦åœ¨æ–°é“¾è¡¨æœ€å‰æ–¹æ·»åŠ èŠ‚ç‚¹ 1</span><br>        <span class="hljs-keyword">if</span>(carry == <span class="hljs-number">1</span>) &#123;<br>            cur.next = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(carry);<br>        &#125;<br>      <span class="hljs-comment">//æœ€ç»ˆå°†é¢„å…ˆæŒ‡é’ˆçš„ next è¿”å›å³å¯å¾—åˆ°æœ€ç»ˆç»“æœ</span><br>        <span class="hljs-keyword">return</span> pre.next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(maxâ¡(m,n))ï¼Œå…¶ä¸­ m å’Œ n åˆ†åˆ«ä¸ºä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ã€‚æˆ‘ä»¬è¦éå†ä¸¤ä¸ªé“¾è¡¨çš„å…¨éƒ¨ä½ç½®ï¼Œè€Œå¤„ç†æ¯ä¸ªä½ç½®åªéœ€è¦ O(1) çš„æ—¶é—´ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚æ³¨æ„è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜éš¾åº¦ä¸­ç­‰ï¼Œä¸»è¦è€ƒå¯Ÿäº†æˆ‘ä»¬å¯¹å•å‘é“¾è¡¨çš„æŒæ¡ï¼Œåœ¨è§£é¢˜è¿‡ç¨‹ä¸­æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªé¢„å…ˆæŒ‡é’ˆï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å¯¹é“¾è¡¨æ“ä½œåèƒ½æ‹¿åˆ°æ­£ç¡®çš„è¿”å›ç»“æœï¼Œé˜²æ­¢å¤´æŒ‡é’ˆä¸¢å¤±</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸¤æ•°ä¹‹å’Œï¼ˆäº”ï¼‰</title>
    <link href="/2022/08/07/A5-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <url>/2022/08/07/A5-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C%EF%BC%88%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode çƒ­é¢˜ HOT 100 ä¸Šç¬¬ä¸€é¢˜ï¼š<a href="https://leetcode.cn/problems/two-sum/?favorite=2cktkvj">ä¸¤æ•°ä¹‹å’Œ</a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œå“ˆå¸Œè¡¨ã€</p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º <strong>å’Œä¸ºç›®æ ‡å€¼</strong> <em><code>target</code></em> çš„é‚£<strong>ä¸¤ä¸ª</strong>æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚</p><p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>], target = <span class="hljs-number">9</span><br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>è§£é‡Šï¼šå› ä¸º nums[<span class="hljs-number">0</span>] + nums[<span class="hljs-number">1</span>] == <span class="hljs-number">9</span> ï¼Œè¿”å› [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>] ã€‚<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], target = <span class="hljs-number">6</span><br>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">3</span>,<span class="hljs-number">3</span>], target = <span class="hljs-number">6</span><br>è¾“å‡ºï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><p>1ã€è¿™é“é¢˜æœ¬èº«å¦‚æœé€šè¿‡æš´åŠ›æ±‚è§£ï¼Œä½¿ç”¨åŒé‡ for å¾ªç¯ä¹Ÿæ˜¯å¾ˆå®¹æ˜“è§£å†³çš„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n^2)</p><p>2ã€ç”±äºå“ˆå¸ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨å“ˆå¸Œå®¹å™¨ HashMap æ¥é™ä½æ—¶é—´å¤æ‚åº¦</p><p>3ã€éå†æ•°ç»„ numsï¼Œi ä¸ºå½“å‰ä¸‹æ ‡ï¼Œæ¯ä¸ªå€¼éƒ½åˆ¤æ–­ HashMap ä¸­æ˜¯å¦å­˜åœ¨ <code>target-nums[i]</code> çš„ key å€¼</p><p>4ã€å¦‚æœå­˜åœ¨åˆ™æ‰¾åˆ°äº†ä¸¤ä¸ªå€¼ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™å°†å½“å‰çš„ <code>(nums[i],i)</code> å­˜å…¥ HashMap ä¸­ï¼Œç»§ç»­éå†ç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢</p><p>5ã€å¦‚æœæœ€ç»ˆéƒ½æ²¡æœ‰ç»“æœåˆ™æŠ›å‡ºå¼‚å¸¸</p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] twoSum(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> target) &#123;<br>        Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i&lt; nums.length; i++) &#123;<br>            <span class="hljs-keyword">if</span>(map.containsKey(target - nums[i])) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[] &#123;map.get(target-nums[i]),i&#125;;<br>            &#125;<br>            map.put(nums[i], i);<br>        &#125;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;No two sum solution&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡ã€‚å¯¹äºæ¯ä¸€ä¸ªå…ƒç´  xï¼Œæˆ‘ä»¬å¯ä»¥ O(1) åœ°å¯»æ‰¾ target - xã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡ã€‚ä¸»è¦ä¸ºå“ˆå¸Œè¡¨çš„å¼€é”€ã€‚</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨å“ˆå¸Œè¡¨èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°ä¸¤æ•°ä¹‹å’Œä¸ºç›®æ ‡å€¼çš„ä¸‹æ ‡ç´¢å¼•</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­˜åœ¨é‡å¤å…ƒç´ ï¼ˆå››ï¼‰</title>
    <link href="/2022/08/06/A4-%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <url>/2022/08/06/A4-%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜ç›®æè¿°"><a href="#ä¸€ã€é¢˜ç›®æè¿°" class="headerlink" title="ä¸€ã€é¢˜ç›®æè¿°"></a>ä¸€ã€é¢˜ç›®æè¿°</h2><p>è¿™æ˜¯ LeetCode ä¸Šçš„ä¸€é“ç®—æ³•é¢˜ï¼š<a href="https://leetcode.cn/leetbook/read/top-interview-questions-easy/x248f5/">å­˜åœ¨é‡å¤å…ƒç´ </a>ï¼Œéš¾åº¦ä¸º <strong>ç®€å•</strong>ã€‚</p><p>Tagï¼šã€Œæ•°ç»„ã€ã€ã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œæ’åºã€</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> ã€‚å¦‚æœä»»ä¸€å€¼åœ¨æ•°ç»„ä¸­å‡ºç° <strong>è‡³å°‘ä¸¤æ¬¡</strong> ï¼Œè¿”å› <code>true</code> ï¼›å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ äº’ä¸ç›¸åŒï¼Œè¿”å› <code>false</code> ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]<br>è¾“å‡ºï¼š<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">è¾“å…¥ï¼šnums = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>]<br>è¾“å‡ºï¼š<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>æç¤ºï¼š</p><p>1 &lt;&#x3D; nums.length &lt;&#x3D; 105</p><p>-109 &lt;&#x3D; nums[i] &lt;&#x3D; 109</p><h2 id="äºŒã€è§£é¢˜æ€è·¯"><a href="#äºŒã€è§£é¢˜æ€è·¯" class="headerlink" title="äºŒã€è§£é¢˜æ€è·¯"></a>äºŒã€è§£é¢˜æ€è·¯</h2><h3 id="2-1ã€æ³•ä¸€"><a href="#2-1ã€æ³•ä¸€" class="headerlink" title="2.1ã€æ³•ä¸€"></a>2.1ã€æ³•ä¸€</h3><p>æš´åŠ›æ±‚è§£ï¼ŒåŒé‡ for å¾ªç¯</p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-comment">//[1,2,3,1]</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsDuplicate</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-keyword">if</span>(nums == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> nums.length;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;length;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i+<span class="hljs-number">1</span>;j&lt;length;j++)&#123;<br>                <span class="hljs-keyword">if</span>(nums[i] == nums[j])&#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)</p><h3 id="2-2ã€æ³•äºŒ"><a href="#2-2ã€æ³•äºŒ" class="headerlink" title="2.2ã€æ³•äºŒ"></a>2.2ã€æ³•äºŒ</h3><p>å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œåœ¨æ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™è¯æ˜æœ‰ç›¸åŒå…ƒç´  return trueï¼Œå¦‚æœå¾ªç¯ç»“æŸäº†æ²¡æœ‰ç›¸åŒå…ƒç´ åˆ™è¿”å› false</p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-comment">//[1,2,3,1]</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsDuplicate</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-keyword">if</span>(nums == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        Arrays.sort(nums);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> nums.length;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;length-<span class="hljs-number">1</span>;i++)&#123;<br>            <span class="hljs-keyword">if</span>(nums[i] == nums[i+<span class="hljs-number">1</span>])&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)</p><h3 id="2-3ã€æ³•ä¸‰"><a href="#2-3ã€æ³•ä¸‰" class="headerlink" title="2.3ã€æ³•ä¸‰"></a>2.3ã€æ³•ä¸‰</h3><p>for å¾ªç¯éå†ï¼Œä½¿ç”¨ HashMap å°†æ•°ç»„çš„å…ƒç´ ä½œä¸º keyï¼Œç´¢å¼•ä½œä¸º value æ·»åŠ ï¼Œæ·»åŠ ä¹‹å‰æ¯æ¬¡åˆ¤æ–­ HashMap æ˜¯å¦å­˜åœ¨äº†ç›¸åŒ keyï¼Œå¦‚æœå­˜åˆ™ return trueï¼Œç»“æŸå¾ªç¯ã€‚å¦‚æœ for å¾ªç¯ç»“æŸäº†ä¹Ÿä¸å­˜åœ¨ç›¸åŒçš„ keyï¼Œåˆ™ return falseï¼›</p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-comment">//[1,2,3,1]</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsDuplicate</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-keyword">if</span>(nums == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        Map&lt;Integer,Integer&gt; integerMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;nums.length;i++)&#123;<br>            <span class="hljs-keyword">if</span>(integerMap.containsKey(nums[i]))&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            integerMap.put(nums[i],i);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)</p><h3 id="2-4ã€æ³•å››"><a href="#2-4ã€æ³•å››" class="headerlink" title="2.4ã€æ³•å››"></a>2.4ã€æ³•å››</h3><p>for å¾ªç¯éå†ï¼Œä½¿ç”¨ HashSet è¿›è¡Œé‡å¤å…ƒç´ çš„è¿‡æ»¤ï¼Œå¦‚æœ HashSet add æ—¶å­˜åœ¨ç›¸åŒçš„å…ƒç´ ï¼Œå…¶ä¼šè¿”å› false</p><p>ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>  <span class="hljs-comment">//[1,2,3,1]</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsDuplicate</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-keyword">if</span>(nums == <span class="hljs-literal">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        Set&lt;Integer&gt; integerSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> nums.length;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> num: nums)&#123;<br>            <span class="hljs-keyword">if</span>(!integerSet.add(num))&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬é“ç®—æ³•é¢˜è€ƒæŸ¥äº†æˆ‘ä»¬å¯¹æ•°ç»„ä¸­é‡å¤å…ƒç´ çš„æ£€æµ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† 4 ä¸­è§£é¢˜æ–¹æ³•ï¼š</p><p>æ³•ä¸€ï¼šåŒé‡ for å¾ªç¯æš´åŠ›æ±‚è§£ï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€ä¸å¯å–çš„ï¼Œæ—¶é—´å¤æ‚åº¦é«˜ï¼Œæ•ˆç‡æœ€ä½</p><p>æ³•äºŒï¼šè¿™ç§æ–¹å¼è°ƒç”¨äº† JDK ç»™æˆ‘ä»¬æä¾›çš„ Arrays è¿›è¡Œæ’åºï¼Œè§‰å¾—ä¸å¯å–ï¼Œæˆ‘ä»¬åº”è¯¥è‡ªå·±å»ç¼–å†™æ’åºç®—æ³•å®ç°</p><p>æ³•ä¸‰ï¼Œæ³•å››ï¼šä¸€ä¸ªä½¿ç”¨ HashMapï¼Œä¸€ä¸ªä½¿ç”¨ HashSetï¼Œåˆ©ç”¨å®ƒä»¬ä¸èƒ½é‡å¤æ·»åŠ å…ƒç´ çš„ç‰¹æ€§è§£å†³é—®é¢˜ï¼Œæ¨èä½¿ç”¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§è¡¨ä¹‹é“¾è¡¨ä¸­ç¯‡</title>
    <link href="/2022/08/05/D2.2-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%AF%87/"/>
    <url>/2022/08/05/D2.2-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€åŒå‘é“¾è¡¨"><a href="#ä¸€ã€åŒå‘é“¾è¡¨" class="headerlink" title="ä¸€ã€åŒå‘é“¾è¡¨"></a>ä¸€ã€åŒå‘é“¾è¡¨</h2><p>åŒå‘é“¾è¡¨ä¹Ÿå«åŒå‘è¡¨ï¼Œæ˜¯é“¾è¡¨çš„ä¸€ç§ï¼Œå®ƒç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ç”±ä¸€ä¸ªæ•°æ®åŸŸå’Œä¸¤ä¸ªæŒ‡é’ˆåŸŸç»„æˆï¼Œæ•°æ®åŸŸç”¨æ¥å­˜å‚¨æ•°æ®ï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‡é’ˆåŸŸç”¨æ¥æŒ‡å‘å…¶åç»§èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆç”¨æ¥æŒ‡å‘å‰é©±èŠ‚ç‚¹ã€‚é“¾è¡¨çš„å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸä¸å­˜å‚¨æ•°æ®ï¼ŒæŒ‡å‘å‰é©±èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå€¼ä¸º null ï¼ŒæŒ‡å‘åç»§èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘ç¬¬ä¸€ä¸ªçœŸæ­£å­˜å‚¨æ•°æ®çš„èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5705b35507cf4c88a3dc1b0a148e9b75~tplv-k3u1fbpfcp-watermark.image" alt="image-20221206213524158.png"></p><h3 id="1-1ã€èŠ‚ç‚¹-API-è®¾è®¡"><a href="#1-1ã€èŠ‚ç‚¹-API-è®¾è®¡" class="headerlink" title="1.1ã€èŠ‚ç‚¹ API è®¾è®¡"></a>1.1ã€èŠ‚ç‚¹ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>Node&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Node(T t,Node next) ï¼šåˆ›å»º Node å¯¹è±¡</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>T item ï¼šå­˜å‚¨æ•°æ®<br>Node next ï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹<br>Node pre ï¼šæŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹</td></tr></tbody></table><h3 id="1-2ã€åŒå‘é“¾è¡¨-API-è®¾è®¡"><a href="#1-2ã€åŒå‘é“¾è¡¨-API-è®¾è®¡" class="headerlink" title="1.2ã€åŒå‘é“¾è¡¨ API è®¾è®¡"></a>1.2ã€åŒå‘é“¾è¡¨ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>TwoWayLinkList&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>TwoWayLinkList() ï¼šåˆ›å»º TwoWayLinkList å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€public void clean() ï¼šæ¸…ç©ºçº¿æ€§è¡¨<br/>2ã€public boolean isEmpty() ï¼šçº¿æ€§è¡¨æ˜¯å¦ä¸ºç©º<br/>3ã€public int length() ï¼šè·å–çº¿æ€§è¡¨å…ƒç´ çš„ä¸ªæ•°<br/>4ã€public T get(int i) ï¼šè·å–çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®å…ƒç´ çš„å€¼<br/>5ã€public void insert(int i,T t) ï¼šåœ¨ç¬¬ i ä¸ªå…ƒç´ ä¹‹å‰æ’å…¥ä¸€ä¸ªå€¼ä¸º t çš„æ•°æ®å…ƒç´ <br/>6ã€public void insert(T t) ï¼šå‘çº¿æ€§è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´  t<br/>7ã€public T remove(int i) ï¼šåˆ é™¤å¹¶è¿”å›çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®çš„æ•°æ®å…ƒç´ <br/>8ã€public int indexOf(T t) ï¼šè¿”å›çº¿æ€§è¡¨ä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šçš„æ•°æ®å…ƒç´ çš„ä½åºå·ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1<br>9ã€public T getFirst() ï¼šè·å–ç¬¬ä¸€ä¸ªå…ƒç´ <br>10ã€public T getLast() ï¼šè·å–æœ€åä¸€ä¸ªå…ƒç´ </td></tr><tr><td>æˆå‘˜å†…éƒ¨ç±»</td><td><code>private class Node&lt;T&gt;</code> ï¼šèŠ‚ç‚¹ç±»</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private Node first ï¼šè®°å½•å¤´èŠ‚ç‚¹<br>2ã€private Node last ï¼šè®°å½•å°¾èŠ‚ç‚¹<br>3ã€private int N ï¼šè®°å½•é“¾è¡¨çš„é•¿åº¦</td></tr></tbody></table><h3 id="1-3ã€åŒå‘é“¾è¡¨ä»£ç å®ç°"><a href="#1-3ã€åŒå‘é“¾è¡¨ä»£ç å®ç°" class="headerlink" title="1.3ã€åŒå‘é“¾è¡¨ä»£ç å®ç°"></a>1.3ã€åŒå‘é“¾è¡¨ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TwoWayLinkList</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//è®°å½•å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node first;<br>    <span class="hljs-comment">//è®°å½•å°¾èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node last;<br>    <span class="hljs-comment">//è®°å½•é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br><span class="hljs-comment">//èŠ‚ç‚¹ç±»</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">private</span> T item;<br>        <span class="hljs-keyword">private</span> Node pre;<br>        <span class="hljs-keyword">private</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item,Node pre,Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.pre = pre;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TwoWayLinkList</span><span class="hljs-params">()</span> &#123;<br>        first = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        first.next = <span class="hljs-literal">null</span>;<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getFirst</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> first.next.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getLast</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty())<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> last.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> first.next;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; i; j++) &#123;<br>            temp = temp.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty())&#123;<br>            <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹</span><br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, first, <span class="hljs-literal">null</span>);<br>            <span class="hljs-comment">//å°†å…¶èµ‹å€¼ç»™ last</span><br>            last = newNode;<br>            <span class="hljs-comment">//å¤´èŠ‚ç‚¹çš„nextæŒ‡å‘å°¾èŠ‚ç‚¹å³å¯</span><br>            first.next = last;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">oldLast</span> <span class="hljs-operator">=</span> last;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, oldLast, <span class="hljs-literal">null</span>);<br>            oldLast.next = newNode;<br>            last = newNode;<br>        &#125;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> index,T t)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &gt;= N)<span class="hljs-keyword">return</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; index; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, pre, current);<br>        pre.next = newNode;<br>        current.pre = newNode;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;temp.next != <span class="hljs-literal">null</span>;i++)&#123;<br>            temp = temp.next;<br>            <span class="hljs-keyword">if</span>(temp.next.item.equals(t))&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &gt;= N) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; index; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">nextNode</span> <span class="hljs-operator">=</span> current.next;<br>        pre.next = nextNode;<br>        nextNode.pre = pre;<br>        N--;<br>        <span class="hljs-keyword">return</span> current.item;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-4ã€åŒå‘é“¾è¡¨éå†"><a href="#1-4ã€åŒå‘é“¾è¡¨éå†" class="headerlink" title="1.4ã€åŒå‘é“¾è¡¨éå†"></a>1.4ã€åŒå‘é“¾è¡¨éå†</h3><p>æˆ‘ä»¬ä¹Ÿè®© TwoWayLinkList æ”¯æŒå¢å¼º for å¾ªç¯ï¼š</p><p>1ã€è®© TwoWayLinkList å®ç° Iterable æ¥å£ï¼Œé‡å†™ iterator æ¥å£</p><p>2ã€åœ¨ TwoWayLinkList å†…éƒ¨æä¾›ä¸€ä¸ªå†…éƒ¨ç±» TIteratorï¼Œå®ç° Iterator æ¥å£ï¼Œé‡å†™ hasNext() æ–¹æ³•å’Œ next() æ–¹æ³•</p><p>å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TwoWayLinkList</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//è®°å½•å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node first;<br>    <span class="hljs-comment">//è®°å½•å°¾èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node last;<br>    <span class="hljs-comment">//è®°å½•é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">private</span> T item;<br>        <span class="hljs-keyword">private</span> Node pre;<br>        <span class="hljs-keyword">private</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item,Node pre,Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.pre = pre;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TwoWayLinkList</span><span class="hljs-params">()</span> &#123;<br>        first = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        first.next = <span class="hljs-literal">null</span>;<br>        last = <span class="hljs-literal">null</span>;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getFirst</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> first.next.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getLast</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty())<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> last.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> first.next;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; i; j++) &#123;<br>            temp = temp.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> temp.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-keyword">if</span>(isEmpty())&#123;<br>            <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹</span><br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, first, <span class="hljs-literal">null</span>);<br>            <span class="hljs-comment">//å°†å…¶èµ‹å€¼ç»™ last</span><br>            last = newNode;<br>            <span class="hljs-comment">//å¤´èŠ‚ç‚¹çš„nextæŒ‡å‘å°¾èŠ‚ç‚¹å³å¯</span><br>            first.next = last;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">oldLast</span> <span class="hljs-operator">=</span> last;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, oldLast, <span class="hljs-literal">null</span>);<br>            oldLast.next = newNode;<br>            last = newNode;<br>        &#125;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> index,T t)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &gt;= N)<span class="hljs-keyword">return</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; index; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, pre, current);<br>        pre.next = newNode;<br>        current.pre = newNode;<br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;temp.next != <span class="hljs-literal">null</span>;i++)&#123;<br>            temp = temp.next;<br>            <span class="hljs-keyword">if</span>(temp.next.item.equals(t))&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &gt;= N) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> first;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; index; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">nextNode</span> <span class="hljs-operator">=</span> current.next;<br>        pre.next = nextNode;<br>        nextNode.pre = pre;<br>        N--;<br>        <span class="hljs-keyword">return</span> current.item;<br>    &#125;<br><br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> Node temp;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">TIterator</span><span class="hljs-params">()</span> &#123;<br>            temp = first;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> temp.next != <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            temp = temp.next;<br>            <span class="hljs-keyword">return</span> temp.item;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  end =================================</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-5ã€åŒå‘é“¾è¡¨æµ‹è¯•"><a href="#1-5ã€åŒå‘é“¾è¡¨æµ‹è¯•" class="headerlink" title="1.5ã€åŒå‘é“¾è¡¨æµ‹è¯•"></a>1.5ã€åŒå‘é“¾è¡¨æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        TwoWayLinkList&lt;String&gt; strList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TwoWayLinkList</span>&lt;&gt;();<br>        <span class="hljs-comment">//1ã€æ’å…¥å…ƒç´ </span><br>        strList.insert(<span class="hljs-string">&quot;å§šæ˜&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;ç§‘æ¯”&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;éº¦è¿ª&quot;</span>);<br>        strList.insert(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;è©¹å§†æ–¯&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String s : strList) &#123;<br>            System.out.println(s);<br>            <span class="hljs-comment">//å§šæ˜</span><br>            <span class="hljs-comment">//è©¹å§†æ–¯</span><br>            <span class="hljs-comment">//ç§‘æ¯”</span><br>            <span class="hljs-comment">//éº¦è¿ª</span><br>        &#125;<br>        <span class="hljs-comment">//2ã€è·å–å¤´èŠ‚ç‚¹å…ƒç´ </span><br>        System.out.println(<span class="hljs-string">&quot;è·å–å¤´èŠ‚ç‚¹å…ƒç´ ï¼š&quot;</span> + strList.getFirst());<span class="hljs-comment">//è·å–å¤´èŠ‚ç‚¹å…ƒç´ ï¼šå§šæ˜</span><br>        <span class="hljs-comment">//3ã€è·å–å°¾èŠ‚ç‚¹å…ƒç´ </span><br>        System.out.println(<span class="hljs-string">&quot;è·å–å°¾èŠ‚ç‚¹å…ƒç´ ï¼š&quot;</span> + strList.getLast());<span class="hljs-comment">//è·å–å°¾èŠ‚ç‚¹å…ƒç´ ï¼šéº¦è¿ª</span><br>        <span class="hljs-comment">//4ã€è·å–å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> strList.get(<span class="hljs-number">1</span>);<br>        System.out.println(result);<span class="hljs-comment">//è©¹å§†æ–¯</span><br>        <span class="hljs-comment">//5ã€åˆ é™¤å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> strList.remove(<span class="hljs-number">0</span>);<br>        System.out.println(removeElement);<span class="hljs-comment">//å§šæ˜</span><br>        <span class="hljs-comment">//6ã€æµ‹è¯•æ¸…ç©º</span><br>        strList.clear();<br>        System.out.println(strList.length());<span class="hljs-comment">//0</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€åŒå‘é“¾è¡¨å¤æ‚åº¦åˆ†æ"><a href="#äºŒã€åŒå‘é“¾è¡¨å¤æ‚åº¦åˆ†æ" class="headerlink" title="äºŒã€åŒå‘é“¾è¡¨å¤æ‚åº¦åˆ†æ"></a>äºŒã€åŒå‘é“¾è¡¨å¤æ‚åº¦åˆ†æ</h2><h3 id="2-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#2-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="2.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>2.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>get(i) æ¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œéƒ½è¦ä»é“¾è¡¨çš„å¤´å¼€å§‹ï¼Œä¾æ¬¡å‘åæŸ¥è¯¢ï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢åŠ ï¼Œæ¯”è¾ƒçš„å…ƒç´ ä¹Ÿè¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="2-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#2-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="2.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>2.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>insert(int i,T t) æ¯ä¸€æ¬¡æ’å…¥ï¼Œéœ€è¦å…ˆæ‰¾åˆ° i ä½ç½®çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå®Œæˆæ’å…¥æ“ä½œï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢å¤šï¼ŒæŸ¥æ‰¾çš„å…ƒç´ è¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="2-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#2-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="2.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>2.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>remove(int i) æ¯ä¸€æ¬¡åˆ é™¤ï¼Œéœ€è¦å…ˆæ‰¾åˆ° i ä½ç½®çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå®Œæˆç§»é™¤æ“ä½œï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢å¤šï¼ŒæŸ¥æ‰¾çš„å…ƒç´ è¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><p><strong>ç»“åˆæˆ‘ä»¬å¯¹å•å‘é“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æï¼Œå¯ä»¥å‘ç°åŒå‘é“¾è¡¨å’Œå•å‘é“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦æ˜¯ä¸€æ ·çš„</strong></p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€å•å‘é“¾è¡¨ API è®¾è®¡ï¼ŒèŠ‚ç‚¹ API è®¾è®¡ï¼Œå…·ä½“å®ç°ï¼Œä»¥åŠæ·»åŠ äº†æ”¯æŒå¢å¼º for å¾ªç¯ï¼Œæœ€åè¿›è¡Œäº†æµ‹è¯•ç”¨ä¾‹æµ‹è¯•</p><p>2ã€åŒå‘é“¾è¡¨æ—¶é—´å¤æ‚åº¦åˆ†æï¼Œç»“åˆå‰é¢è®²çš„å•å‘é“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦ï¼Œå¯å‘ç°ï¼Œå®ƒä»¬ä¸¤æ—¶é—´å¤æ‚åº¦æ˜¯ä¸€æ ·çš„</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§è¡¨ä¹‹é“¾è¡¨ä¸Šç¯‡</title>
    <link href="/2022/08/04/D2.1-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%93%BE%E8%A1%A8%E4%B8%8A%E7%AF%87/"/>
    <url>/2022/08/04/D2.1-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%93%BE%E8%A1%A8%E4%B8%8A%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰æˆ‘ä»¬ä»‹ç»äº†ä½¿ç”¨é¡ºåºå­˜å‚¨ç»“æ„å®ç°é¡ºåºè¡¨ï¼Œæˆ‘ä»¬å‘ç°è™½ç„¶é¡ºåºè¡¨çš„æŸ¥è¯¢å¾ˆå¿«ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œä½†æ˜¯å¢åˆ çš„æ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ï¼Œå› ä¸ºæ¯ä¸€æ¬¡å¢åˆ æ“ä½œéƒ½ä¼´éšç€å¤§é‡çš„æ•°æ®å…ƒç´ ç§»åŠ¨ã€‚è¿™ä¸ªé—®é¢˜æœ‰æ²¡æœ‰è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ</p><p>ç­”ï¼šæœ‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§å­˜å‚¨ç»“æ„å®ç°çº¿æ€§è¡¨ï¼šé“¾å¼å­˜å‚¨ç»“æ„ã€‚</p><h2 id="ä¸€ã€é“¾è¡¨ä»‹ç»"><a href="#ä¸€ã€é“¾è¡¨ä»‹ç»" class="headerlink" title="ä¸€ã€é“¾è¡¨ä»‹ç»"></a>ä¸€ã€é“¾è¡¨ä»‹ç»</h2><p>é“¾è¡¨æ˜¯ä¸€ç§ç‰©ç†å­˜å‚¨å•å…ƒä¸Šéè¿ç»­ï¼Œéé¡ºåºçš„å­˜å‚¨ç»“æ„ï¼Œå…¶ç‰©ç†ç»“æ„ä¸èƒ½ç›´è§‚çš„è¡¨ç¤ºæ•°æ®å…ƒç´ çš„é€»è¾‘é¡ºåºï¼Œæ•°æ®å…ƒç´ çš„é€»è¾‘é¡ºåºæ˜¯é€šè¿‡é“¾è¡¨ä¸­çš„æŒ‡é’ˆé“¾æ¥æ¬¡åºå®ç°çš„ã€‚é“¾è¡¨ç”±ä¸€ç³»åˆ—çš„èŠ‚ç‚¹ï¼ˆé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ç§°ä¸ºèŠ‚ç‚¹ï¼‰ç»„æˆï¼ŒèŠ‚ç‚¹å¯ä»¥è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼Œå¦‚ä¸‹å›¾æ¼”ç¤ºï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/036000ba797c44149f213daf855883b7~tplv-k3u1fbpfcp-watermark.image" alt="image-20221205220501273.png"></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc4dc14667fd4c5896304bfc08b117ed~tplv-k3u1fbpfcp-watermark.image" alt="image-20221205220555432.png"></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/149b087164b146268aa71d19f036a7b2~tplv-k3u1fbpfcp-watermark.image" alt="image-20221205220714410.png"></p><p>é‚£æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨é“¾è¡¨å‘¢ï¼ŸæŒ‰ç…§é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªç±»ï¼Œæ¥æè¿°èŠ‚ç‚¹è¿™ä¸ªäº‹ç‰©ï¼Œç”¨ä¸€ä¸ªå±æ€§æè¿°è¿™ä¸ªèŠ‚ç‚¹å­˜å‚¨çš„å…ƒç´ ï¼Œç”¨å¦å¤–ä¸€ä¸ªå±æ€§æè¿°è¿™ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p><strong>èŠ‚ç‚¹ API è®¾è®¡ï¼š</strong></p><table><thead><tr><th>ç±»å</th><th><code>Node&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Node(T t,Node next) ï¼šåˆ›å»º Node å¯¹è±¡</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>T item ï¼šå­˜å‚¨æ•°æ®<br/>Node next ï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</td></tr></tbody></table><p>å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;T&gt;&#123;<br>  <span class="hljs-comment">//å­˜å‚¨å…ƒç´ </span><br>  <span class="hljs-keyword">public</span> T item;<br>  <span class="hljs-comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>  <span class="hljs-keyword">public</span> Node next;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item,Node next)</span>&#123;<br>    <span class="hljs-built_in">this</span>.item = item;<br>    <span class="hljs-built_in">this</span>.next = next;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•ï¼šç”Ÿæˆé“¾è¡¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//æ„å»ºèŠ‚ç‚¹</span><br>        Node&lt;Integer&gt; first = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(<span class="hljs-number">11</span>, <span class="hljs-literal">null</span>);<br>        Node&lt;Integer&gt; second = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(<span class="hljs-number">13</span>, <span class="hljs-literal">null</span>);<br>        Node&lt;Integer&gt; third = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(<span class="hljs-number">12</span>, <span class="hljs-literal">null</span>);<br>        Node&lt;Integer&gt; four = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(<span class="hljs-number">8</span>, <span class="hljs-literal">null</span>);<br>        Node&lt;Integer&gt; five = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(<span class="hljs-number">9</span>, <span class="hljs-literal">null</span>);<br>        <br>        <span class="hljs-comment">//ç”Ÿæˆé“¾è¡¨</span><br>        first.next = second;<br>        second.next = third;<br>        third.next = four;<br>        four.next = five;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é“¾è¡¨ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p><p>1ã€å•å‘é“¾è¡¨</p><p>2ã€åŒå‘é“¾è¡¨</p><h2 id="äºŒã€å•å‘é“¾è¡¨"><a href="#äºŒã€å•å‘é“¾è¡¨" class="headerlink" title="äºŒã€å•å‘é“¾è¡¨"></a>äºŒã€å•å‘é“¾è¡¨</h2><p>å•å‘é“¾è¡¨æ˜¯é“¾è¡¨çš„ä¸€ç§ï¼Œå®ƒç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ç”±ä¸€ä¸ªæ•°æ®åŸŸå’Œä¸€ä¸ªæŒ‡é’ˆåŸŸç»„æˆï¼Œæ•°æ®åŸŸç”¨æ¥å­˜å‚¨æ•°æ®ï¼ŒæŒ‡é’ˆåŸŸç”¨æ¥æŒ‡å‘å…¶åç»§èŠ‚ç‚¹ã€‚é“¾è¡¨çš„å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸä¸å­˜å‚¨æ•°æ®ï¼ŒæŒ‡é’ˆåŸŸæŒ‡å‘ç¬¬ä¸€ä¸ªçœŸæ­£å­˜å‚¨æ•°æ®çš„èŠ‚ç‚¹ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/196cd5e9b8e742efaccf7c53f3316401~tplv-k3u1fbpfcp-watermark.image" alt="image-20221205215218206.png"></p><h3 id="1-1ã€å•å‘é“¾è¡¨-API-è®¾è®¡"><a href="#1-1ã€å•å‘é“¾è¡¨-API-è®¾è®¡" class="headerlink" title="1.1ã€å•å‘é“¾è¡¨ API è®¾è®¡"></a>1.1ã€å•å‘é“¾è¡¨ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>LinkList&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>LinkList() ï¼šåˆ›å»º LinkList å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€public void clean() ï¼šæ¸…ç©ºçº¿æ€§è¡¨<br/>2ã€public boolean isEmpty() ï¼šçº¿æ€§è¡¨æ˜¯å¦ä¸ºç©º<br/>3ã€public int length() ï¼šè·å–çº¿æ€§è¡¨å…ƒç´ çš„ä¸ªæ•°<br/>4ã€public T get(int i) ï¼šè·å–çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®å…ƒç´ çš„å€¼<br/>5ã€public void insert(int i,T t) ï¼šåœ¨ç¬¬ i ä¸ªå…ƒç´ ä¹‹å‰æ’å…¥ä¸€ä¸ªå€¼ä¸º t çš„æ•°æ®å…ƒç´ <br/>6ã€public void insert(T t) ï¼šå‘çº¿æ€§è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´  t<br/>7ã€public T remove(int i) ï¼šåˆ é™¤å¹¶è¿”å›çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®çš„æ•°æ®å…ƒç´ <br/>8ã€public int indexOf(T t) ï¼šè¿”å›çº¿æ€§è¡¨ä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šçš„æ•°æ®å…ƒç´ çš„ä½åºå·ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1</td></tr><tr><td>æˆå‘˜å†…éƒ¨ç±»</td><td><code>private class Node&lt;T&gt;</code> ï¼šèŠ‚ç‚¹ç±»</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private Node head ï¼šè®°å½•å¤´èŠ‚ç‚¹<br>2ã€private int N ï¼šè®°å½•é“¾è¡¨çš„é•¿åº¦</td></tr></tbody></table><p>å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkList</span>&lt;T&gt; &#123;<br><br>    <span class="hljs-comment">//è®°å½•å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-comment">//è®°å½•é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">private</span> T item;<br>        <span class="hljs-keyword">private</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item, Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LinkList</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//åˆå§‹åŒ–å¤´èŠ‚ç‚¹</span><br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        <span class="hljs-comment">//åˆå§‹åŒ–å…ƒç´ ä¸ªæ•°</span><br>        <span class="hljs-built_in">this</span>.N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//å°†å½“å‰å¤´èŠ‚ç‚¹çš„nextæ–­æ‰ï¼Œé‚£ä¹ˆå°±æ‰¾ä¸åˆ°è¿™æ¡é“¾è¡¨äº†</span><br>        head.next = <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">//å°†é“¾è¡¨çš„é•¿åº¦è®¾ç½®ä¸º0</span><br>        <span class="hljs-built_in">this</span>.N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-comment">//ä»ç¬¬ 0 ä¸ªå…ƒç´ å¼€å§‹æ‰¾ï¼Œæ‰¾ i æ¬¡ï¼Œå°±æ˜¯ç¬¬ i ä¸ªèŠ‚ç‚¹çš„æ•°æ®</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i1 &lt; i; i1++) &#123;<br>            node = node.next;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> node.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">while</span> (node.next != <span class="hljs-literal">null</span>)&#123;<br>            node = node.next;<br>        &#125;<br>        <span class="hljs-comment">//æ‰§è¡Œåˆ°è¿™é‡Œï¼Œè¯´æ˜åˆ°äº†å°¾èŠ‚ç‚¹</span><br>        <span class="hljs-comment">//æ„å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span><br>        Node newNode= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t,<span class="hljs-literal">null</span>);<br>        <span class="hljs-comment">//å°†å°¾å·´èŠ‚ç‚¹çš„ next æŒ‡å‘å®ƒ</span><br>        node.next = newNode;<br>        <span class="hljs-comment">//é“¾è¡¨é•¿åº¦ +1</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> index,T t)</span>&#123;<br>        <span class="hljs-comment">//æ‰¾åˆ° i çš„å‰ä¸€ä¸ªèŠ‚ç‚¹å’Œå½“å‰ i èŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= index - <span class="hljs-number">1</span>; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-comment">//åˆ›å»ºæ–°çš„èŠ‚ç‚¹ï¼Œå°†å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘æ’å…¥çš„èŠ‚ç‚¹ï¼Œå½“å‰æ’å…¥èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, current);<br>        pre.next = newNode;<br>        <span class="hljs-comment">//å…ƒç´ åŠ ä¸€</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>&#123;<br>        <span class="hljs-comment">//æ‰¾åˆ°å½“å‰ i çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= index - <span class="hljs-number">1</span>; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-comment">//æ‰¾åˆ°å½“å‰èŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-comment">//å°†å‰ä¸€ä¸ªèŠ‚ç‚¹çš„ next æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„ next</span><br>        pre.next = current.next;<br>        <span class="hljs-comment">//å…ƒç´ ä¸ªæ•°å‡ä¸€</span><br>        N--;<br>        <span class="hljs-keyword">return</span> current.item;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">while</span> (node != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">if</span>(node.item.equals(t))&#123;<br>                <span class="hljs-keyword">return</span> index;<br>            &#125;<br>            node = node.next;<br>            index++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-2ã€å•å‘é“¾è¡¨éå†"><a href="#1-2ã€å•å‘é“¾è¡¨éå†" class="headerlink" title="1.2ã€å•å‘é“¾è¡¨éå†"></a>1.2ã€å•å‘é“¾è¡¨éå†</h3><p>åœ¨ Java ä¸­ï¼Œéå†é›†åˆçš„æ–¹å¼ä¸€èˆ¬éƒ½æ˜¯ç”¨ foreach å¾ªç¯ï¼Œå¦‚æœæƒ³è®©æˆ‘ä»¬çš„ SequenceList ä¹Ÿèƒ½æ”¯æŒ foreach ï¼Œåˆ™éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼š</p><p>1ã€è®© LinkList å®ç° Iterable æ¥å£ï¼Œé‡å†™ iterator æ¥å£</p><p>2ã€åœ¨ LinkList å†…éƒ¨æä¾›ä¸€ä¸ªå†…éƒ¨ç±» LIteratorï¼Œå®ç° Iterator æ¥å£ï¼Œé‡å†™ hasNext() æ–¹æ³•å’Œ next() æ–¹æ³•</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkList</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//è®°å½•å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> Node head;<br>    <span class="hljs-comment">//è®°å½•é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>        <span class="hljs-keyword">private</span> T item;<br>        <span class="hljs-keyword">private</span> Node next;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(T item, Node next)</span> &#123;<br>            <span class="hljs-built_in">this</span>.item = item;<br>            <span class="hljs-built_in">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LinkList</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//åˆå§‹åŒ–å¤´èŠ‚ç‚¹</span><br>        head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        <span class="hljs-comment">//åˆå§‹åŒ–å…ƒç´ ä¸ªæ•°</span><br>        <span class="hljs-built_in">this</span>.N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//å°†å½“å‰å¤´èŠ‚ç‚¹çš„nextæ–­æ‰ï¼Œé‚£ä¹ˆå°±æ‰¾ä¸åˆ°è¿™æ¡é“¾è¡¨äº†</span><br>        head.next = <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">//å°†é“¾è¡¨çš„é•¿åº¦è®¾ç½®ä¸º0</span><br>        <span class="hljs-built_in">this</span>.N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-comment">//ä»ç¬¬ 0 ä¸ªå…ƒç´ å¼€å§‹æ‰¾ï¼Œæ‰¾ i æ¬¡ï¼Œå°±æ˜¯ç¬¬ i ä¸ªèŠ‚ç‚¹çš„æ•°æ®</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">if</span>(node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i1 &lt; i; i1++) &#123;<br>            node = node.next;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">return</span> node.item;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">while</span> (node.next != <span class="hljs-literal">null</span>)&#123;<br>            node = node.next;<br>        &#125;<br>        <span class="hljs-comment">//æ‰§è¡Œåˆ°è¿™é‡Œï¼Œè¯´æ˜åˆ°äº†å°¾èŠ‚ç‚¹</span><br>        <span class="hljs-comment">//æ„å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span><br>        Node newNode= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t,<span class="hljs-literal">null</span>);<br>        <span class="hljs-comment">//å°†å°¾å·´èŠ‚ç‚¹çš„ next æŒ‡å‘å®ƒ</span><br>        node.next = newNode;<br>        <span class="hljs-comment">//é“¾è¡¨é•¿åº¦ +1</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> index,T t)</span>&#123;<br>        <span class="hljs-comment">//æ‰¾åˆ° i çš„å‰ä¸€ä¸ªèŠ‚ç‚¹å’Œå½“å‰ i èŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= index - <span class="hljs-number">1</span>; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-comment">//åˆ›å»ºæ–°çš„èŠ‚ç‚¹ï¼Œå°†å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘æ’å…¥çš„èŠ‚ç‚¹ï¼Œå½“å‰æ’å…¥èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(t, current);<br>        pre.next = newNode;<br>        <span class="hljs-comment">//å…ƒç´ åŠ ä¸€</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>&#123;<br>        <span class="hljs-comment">//æ‰¾åˆ°å½“å‰ i çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= index - <span class="hljs-number">1</span>; i++) &#123;<br>            pre = pre.next;<br>        &#125;<br>        <span class="hljs-comment">//æ‰¾åˆ°å½“å‰èŠ‚ç‚¹</span><br>        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pre.next;<br>        <span class="hljs-comment">//å°†å‰ä¸€ä¸ªèŠ‚ç‚¹çš„ next æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„ next</span><br>        pre.next = current.next;<br>        <span class="hljs-comment">//å…ƒç´ ä¸ªæ•°å‡ä¸€</span><br>        N--;<br>        <span class="hljs-keyword">return</span> current.item;<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head.next;<br>        <span class="hljs-keyword">while</span> (node != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">if</span>(node.item.equals(t))&#123;<br>                <span class="hljs-keyword">return</span> index;<br>            &#125;<br>            node = node.next;<br>            index++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> Node curr;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">LIterator</span><span class="hljs-params">()</span> &#123;<br>            curr = head;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> curr.next != <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            curr = curr.next;<br>            <span class="hljs-keyword">return</span> curr.item;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  end =================================</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3ã€å•å‘é“¾è¡¨æµ‹è¯•"><a href="#1-3ã€å•å‘é“¾è¡¨æµ‹è¯•" class="headerlink" title="1.3ã€å•å‘é“¾è¡¨æµ‹è¯•"></a>1.3ã€å•å‘é“¾è¡¨æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        LinkList&lt;String&gt; strList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkList</span>&lt;&gt;();<br>        <span class="hljs-comment">//1ã€æ’å…¥å…ƒç´ </span><br>        strList.insert(<span class="hljs-string">&quot;å§šæ˜&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;ç§‘æ¯”&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;éº¦è¿ª&quot;</span>);<br>        strList.insert(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;è©¹å§†æ–¯&quot;</span>);<br>      <span class="hljs-comment">//2ã€éå†</span><br>        <span class="hljs-keyword">for</span> (String s : strList) &#123;<br>            System.out.println(s);<br>            <span class="hljs-comment">//å§šæ˜</span><br>            <span class="hljs-comment">//è©¹å§†æ–¯</span><br>            <span class="hljs-comment">//ç§‘æ¯”</span><br>            <span class="hljs-comment">//éº¦è¿ª</span><br>        &#125;<br>        <span class="hljs-comment">//3ã€è·å–å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> strList.get(<span class="hljs-number">1</span>);<br>        System.out.println(result);<span class="hljs-comment">//è©¹å§†æ–¯</span><br>        <span class="hljs-comment">//4ã€åˆ é™¤å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> strList.remove(<span class="hljs-number">0</span>);<br>        System.out.println(removeElement);<span class="hljs-comment">//å§šæ˜</span><br>        <span class="hljs-comment">//5ã€æµ‹è¯•æ¸…ç©º</span><br>        strList.clear();<br>        System.out.println(strList.length());<span class="hljs-comment">//0</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€å•å‘é“¾è¡¨æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#ä¸‰ã€å•å‘é“¾è¡¨æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="ä¸‰ã€å•å‘é“¾è¡¨æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>ä¸‰ã€å•å‘é“¾è¡¨æ—¶é—´å¤æ‚åº¦åˆ†æ</h2><h3 id="3-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#3-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="3.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>3.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>get(i) æ¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œéƒ½è¦ä»é“¾è¡¨çš„å¤´å¼€å§‹ï¼Œä¾æ¬¡å‘åæŸ¥è¯¢ï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢åŠ ï¼Œæ¯”è¾ƒçš„å…ƒç´ ä¹Ÿè¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="3-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#3-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="3.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>3.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>insert(int i,T t) æ¯ä¸€æ¬¡æ’å…¥ï¼Œéœ€è¦å…ˆæ‰¾åˆ° i ä½ç½®çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå®Œæˆæ’å…¥æ“ä½œï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢å¤šï¼ŒæŸ¥æ‰¾çš„å…ƒç´ è¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="3-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#3-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="3.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>3.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>remove(int i) æ¯ä¸€æ¬¡åˆ é™¤ï¼Œéœ€è¦å…ˆæ‰¾åˆ° i ä½ç½®çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå®Œæˆç§»é™¤æ“ä½œï¼Œéšç€æ•°æ®å…ƒç´  N çš„å¢å¤šï¼ŒæŸ¥æ‰¾çš„å…ƒç´ è¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><p>ç›¸æ¯”è¾ƒé¡ºåºè¡¨ï¼š</p><p>1ã€é“¾è¡¨æ’å…¥å’Œåˆ é™¤æ—¶é—´å¤æ‚åº¦è™½ç„¶ä¸€æ ·ï¼Œä½†ä»ç„¶æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ï¼Œå› ä¸ºé“¾è¡¨çš„ç‰©ç†åœ°å€æ˜¯ä¸è¿ç»­çš„ï¼Œå®ƒä¸éœ€è¦é¢„å…ˆæŒ‡å®šå­˜å‚¨ç©ºé—´å¤§å°ï¼Œæˆ–è€…å­˜å‚¨è¿‡ç¨‹ä¸­æ¶‰åŠæ‰©å®¹ç­‰æ“ä½œï¼ŒåŒæ—¶å®ƒå¹¶æ²¡æœ‰æ¶‰åŠå…ƒç´ çš„äº¤æ¢ã€‚</p><p>2ã€é“¾è¡¨çš„æŸ¥è¯¢æ“ä½œæ€§èƒ½ä¼šæ¯”è¾ƒä½ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬çš„ç¨‹åºä¸­æŸ¥è¯¢æ“ä½œæ¯”è¾ƒå¤šï¼Œå»ºè®®ä½¿ç”¨é¡ºåºè¡¨ï¼Œå¢åˆ æ“ä½œæ¯”è¾ƒå¤šï¼Œå»ºè®®ä½¿ç”¨é“¾è¡¨ã€‚</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€é“¾è¡¨çš„èŠ‚ç‚¹åŠå…·ä½“å®ç°</p><p>2ã€å•å‘é“¾è¡¨çš„ API è®¾è®¡ï¼Œåˆ°å…·ä½“å®ç°ï¼Œåˆ°æ·»åŠ å¢å¼º for å¾ªç¯éå†ï¼Œåˆ°ç”¨ä¾‹æµ‹è¯•</p><p>3ã€å•å‘é“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æï¼š</p><blockquote><p>1ã€get(i) ï¼šO(n)</p><p>2ã€insert(int i,T t) ï¼šO(n)</p><p>3ã€remove(int i) ï¼šO(n)</p></blockquote><p>è™½ç„¶é“¾è¡¨çš„æ’å…¥å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦å’Œé¡ºåºè¡¨ä¸€æ ·ï¼Œä½†æ˜¯å®ƒä¸éœ€è¦é¢„å…ˆæŒ‡å®šå­˜å‚¨ç©ºé—´ä»¥åŠæ‰©å®¹ç­‰æ“ä½œï¼Œæ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œå› æ­¤æ¶‰åŠåˆ°å¢åˆ æ¯”è¾ƒå¤šçš„æƒ…å†µä½¿ç”¨é“¾è¡¨ï¼ŒæŸ¥è¯¢æ¯”è¾ƒå¤šçš„åˆ™ä½¿ç”¨é¡ºåºè¡¨</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§è¡¨ä¹‹é¡ºåºè¡¨</title>
    <link href="/2022/08/03/D1-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%A1%BA%E5%BA%8F%E8%A1%A8/"/>
    <url>/2022/08/03/D1-%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%A1%BA%E5%BA%8F%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>1ï¼‰ã€çº¿æ€§è¡¨æ˜¯æœ€åŸºæœ¬ï¼Œæœ€ç®€å•ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªçº¿æ€§è¡¨æ˜¯ n ä¸ªå…·æœ‰ç›¸åŒç‰¹æ€§çš„æ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ—ã€‚</p><p>2ï¼‰ã€çº¿æ€§è¡¨ä¸­æ•°æ®å­˜å‚¨çš„æ–¹å¼å¯ä»¥æ˜¯é¡ºåºå­˜å‚¨ï¼Œä¹Ÿå¯ä»¥æ˜¯é“¾å¼å­˜å‚¨ï¼ŒæŒ‰ç…§æ•°æ®çš„å­˜å‚¨æ–¹å¼ä¸åŒï¼Œå¯ä»¥æŠŠçº¿æ€§è¡¨åˆ†ä¸ºé¡ºåºè¡¨å’Œé“¾è¡¨ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»é¡ºåºè¡¨ã€‚</p><h2 id="ä¸€ã€é¡ºåºè¡¨çš„å®ç°"><a href="#ä¸€ã€é¡ºåºè¡¨çš„å®ç°" class="headerlink" title="ä¸€ã€é¡ºåºè¡¨çš„å®ç°"></a>ä¸€ã€é¡ºåºè¡¨çš„å®ç°</h2><p>é¡ºåºè¡¨æ˜¯åœ¨è®¡ç®—æœºä¸­ä»¥æ•°ç»„çš„å½¢å¼ä¿å­˜çš„çº¿æ€§è¡¨ï¼Œçº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨æ˜¯æŒ‡ç”¨ä¸€ç»„åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒï¼Œä¾æ¬¡å­˜å‚¨çº¿æ€§è¡¨ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œä½¿å¾—çº¿æ€§è¡¨ä¸­åœ¨é€»è¾‘ç»“æ„ä¸Šç›¸é‚»çš„æ•°æ®å…ƒç´ å­˜å‚¨åœ¨ç›¸é‚»çš„ç‰©ç†å­˜å‚¨å•å…ƒä¸­ï¼Œå³é€šè¿‡æ•°æ®å…ƒç´ ç‰©ç†å­˜å‚¨çš„ç›¸é‚»å…³ç³»æ¥åæ˜ æ•°æ®å…ƒç´ ä¹‹é—´é€»è¾‘ä¸Šçš„ç›¸é‚»å…³ç³»ã€‚</p><p>å¦‚ä¸‹<strong>æ•°ç»„</strong>ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e3fa1d3e425456eadb81ffcf42bf4b0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221204201222941.png"></p><h3 id="1-1ã€é¡ºåºè¡¨-API-è®¾è®¡"><a href="#1-1ã€é¡ºåºè¡¨-API-è®¾è®¡" class="headerlink" title="1.1ã€é¡ºåºè¡¨ API è®¾è®¡"></a>1.1ã€é¡ºåºè¡¨ API è®¾è®¡</h3><table><thead><tr><th>ç±»å</th><th><code>SequenceList&lt;T&gt;</code></th></tr></thead><tbody><tr><td>æ„é€ æ–¹æ³•</td><td>Sequence(int capacity) ï¼šåˆ›å»ºå®¹é‡ä¸º capacity çš„ SequenceList å¯¹è±¡</td></tr><tr><td>æˆå‘˜æ–¹æ³•</td><td>1ã€public void clean() ï¼šæ¸…ç©ºçº¿æ€§è¡¨<br>2ã€public boolean isEmpty() ï¼šçº¿æ€§è¡¨æ˜¯å¦ä¸ºç©º<br>3ã€public int length() ï¼šè·å–çº¿æ€§è¡¨å…ƒç´ çš„ä¸ªæ•°<br>4ã€public T get(int i) ï¼šè·å–çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®å…ƒç´ çš„å€¼<br>5ã€public void insert(int i,T t) ï¼šåœ¨ç¬¬ i ä¸ªå…ƒç´ ä¹‹å‰æ’å…¥ä¸€ä¸ªå€¼ä¸º t çš„æ•°æ®å…ƒç´ <br>6ã€public void insert(T t) ï¼šå‘çº¿æ€§è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´  t<br>7ã€public T remove(int i) ï¼šåˆ é™¤å¹¶è¿”å›çº¿æ€§è¡¨ä¸­ç¬¬ i ä¸ªä½ç½®çš„æ•°æ®å…ƒç´ <br>8ã€public int indexOf(T t) ï¼šè¿”å›çº¿æ€§è¡¨ä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šçš„æ•°æ®å…ƒç´ çš„ä½åºå·ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1</td></tr><tr><td>æˆå‘˜å˜é‡</td><td>1ã€private T[] eles ï¼šå­˜å‚¨å…ƒç´ çš„æ•°ç»„<br>2ã€private int N ï¼šå½“å‰çº¿æ€§è¡¨çš„é•¿åº¦</td></tr></tbody></table><h3 id="1-2ã€é¡ºåºè¡¨å…·ä½“å®ç°"><a href="#1-2ã€é¡ºåºè¡¨å…·ä½“å®ç°" class="headerlink" title="1.2ã€é¡ºåºè¡¨å…·ä½“å®ç°"></a>1.2ã€é¡ºåºè¡¨å…·ä½“å®ç°</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ ¹æ® API è®¾è®¡æ¥ç¼–å†™å…·ä½“çš„å®ç°ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SequenceList</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//å­˜å‚¨å…ƒç´ çš„æ•°ç»„</span><br>    <span class="hljs-keyword">private</span> T[] eles;<br>    <span class="hljs-comment">//è®°å½•å½“å‰é¡ºåºè¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SequenceList</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> &#123;<br>        eles = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<br>    &#125;<br><br>    <span class="hljs-comment">//æ¸…ç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æ˜¯å¦ä¸ºç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//é•¿åº¦</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">return</span> eles[i];<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ ï¼Œå¸¦ä¸‹æ ‡</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> i, T t)</span> &#123;<br>        <span class="hljs-comment">//1ã€å°† i åŠä¹‹åä½ç½®çš„å…ƒç´ å¾€åç§»ä¸€ä½</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> N; index &gt; i; index--) &#123;<br>            eles[index] = eles[index - <span class="hljs-number">1</span>];<br>        &#125;<br>        <span class="hljs-comment">//2ã€åœ¨ i ä½ç½®å¤„æ’å…¥ t</span><br>        eles[i] = t;<br>        <span class="hljs-comment">//3ã€å…ƒç´ ä¸ªæ•°åŠ  1</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        eles[N++] = t;<br>    &#125;<br><br>    <span class="hljs-comment">//ç§»é™¤å¹¶è¿”å›å½“å‰å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">T</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> eles[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> i; index &lt; N - <span class="hljs-number">1</span>; index++)&#123;<br>            eles[index] = eles[index + <span class="hljs-number">1</span>];<br>        &#125;<br>        N--;<br>        <span class="hljs-keyword">return</span> removeElement;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å½“å‰å…ƒç´ çš„ç´¢å¼•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>            <span class="hljs-keyword">if</span>(eles[i].equals(t))&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3ã€é¡ºåºè¡¨æµ‹è¯•"><a href="#1-3ã€é¡ºåºè¡¨æµ‹è¯•" class="headerlink" title="1.3ã€é¡ºåºè¡¨æµ‹è¯•"></a>1.3ã€é¡ºåºè¡¨æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SequenceList&lt;String&gt; strList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SequenceList</span>&lt;&gt;(<span class="hljs-number">10</span>);<br>        <span class="hljs-comment">//1ã€æ’å…¥å…ƒç´ </span><br>        strList.insert(<span class="hljs-string">&quot;å§šæ˜&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;ç§‘æ¯”&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;éº¦è¿ª&quot;</span>);<br>        strList.insert(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;è©¹å§†æ–¯&quot;</span>);<br>        <span class="hljs-comment">//2ã€è·å–å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> strList.get(<span class="hljs-number">1</span>);<br>        System.out.println(result);<span class="hljs-comment">//è©¹å§†æ–¯</span><br>        <span class="hljs-comment">//3ã€åˆ é™¤å…ƒç´ </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> strList.remove(<span class="hljs-number">0</span>);<br>        System.out.println(removeElement);<span class="hljs-comment">//å§šæ˜</span><br>        <span class="hljs-comment">//4ã€æµ‹è¯•æ¸…ç©º</span><br>        strList.clear();<br>        System.out.println(strList.length());<span class="hljs-comment">//0</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒã€é¡ºåºè¡¨çš„éå†"><a href="#äºŒã€é¡ºåºè¡¨çš„éå†" class="headerlink" title="äºŒã€é¡ºåºè¡¨çš„éå†"></a>äºŒã€é¡ºåºè¡¨çš„éå†</h2><p>ä½œä¸ºå­˜å‚¨å®¹å™¨ï¼Œä¸€èˆ¬éœ€è¦å‘å¤–éƒ¨æä¾›éå†çš„æ–¹å¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»™é¡ºåºè¡¨æä¾›éå†æ–¹å¼ã€‚</p><p>åœ¨ Java ä¸­ï¼Œéå†é›†åˆçš„æ–¹å¼ä¸€èˆ¬éƒ½æ˜¯ç”¨ foreach å¾ªç¯ï¼Œå¦‚æœæƒ³è®©æˆ‘ä»¬çš„ SequenceList ä¹Ÿèƒ½æ”¯æŒ foreach ï¼Œåˆ™éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼š</p><p>1ã€è®© SequenceList å®ç° Iterable æ¥å£ï¼Œé‡å†™ iterator æ¥å£</p><p>2ã€åœ¨ SequenceList å†…éƒ¨æä¾›ä¸€ä¸ªå†…éƒ¨ç±» SIteratorï¼Œå®ç° Iterator æ¥å£ï¼Œé‡å†™ hasNext() æ–¹æ³•å’Œ next() æ–¹æ³•</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SequenceList</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//å­˜å‚¨å…ƒç´ çš„æ•°ç»„</span><br>    <span class="hljs-keyword">private</span> T[] eles;<br>    <span class="hljs-comment">//è®°å½•å½“å‰é¡ºåºè¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SequenceList</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> &#123;<br>        eles = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<br>    &#125;<br><br>    <span class="hljs-comment">//æ¸…ç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æ˜¯å¦ä¸ºç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//é•¿åº¦</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">return</span> eles[i];<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ ï¼Œå¸¦ä¸‹æ ‡</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> i, T t)</span> &#123;<br>        <span class="hljs-comment">//1ã€å°† i åŠä¹‹åä½ç½®çš„å…ƒç´ å¾€åç§»ä¸€ä½</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> N; index &gt; i; index--) &#123;<br>            eles[index] = eles[index - <span class="hljs-number">1</span>];<br>        &#125;<br>        <span class="hljs-comment">//2ã€åœ¨ i ä½ç½®å¤„æ’å…¥ t</span><br>        eles[i] = t;<br>        <span class="hljs-comment">//3ã€å…ƒç´ ä¸ªæ•°åŠ  1</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        eles[N++] = t;<br>    &#125;<br><br>    <span class="hljs-comment">//ç§»é™¤å¹¶è¿”å›å½“å‰å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">T</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> eles[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> i; index &lt; N - <span class="hljs-number">1</span>; index++)&#123;<br>            eles[index] = eles[index + <span class="hljs-number">1</span>];<br>        &#125;<br>        N--;<br>        <span class="hljs-keyword">return</span> removeElement;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å½“å‰å…ƒç´ çš„ç´¢å¼•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>            <span class="hljs-keyword">if</span>(eles[i].equals(t))&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> cursor &lt; N;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> eles[cursor++];<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//================================== æ–°å¢éƒ¨åˆ†ä»£ç  start =================================</span><br>&#125;<br><br><span class="hljs-comment">//æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SequenceList&lt;String&gt; strList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SequenceList</span>&lt;&gt;(<span class="hljs-number">10</span>);<br>        <span class="hljs-comment">//1ã€æ’å…¥å…ƒç´ </span><br>        strList.insert(<span class="hljs-string">&quot;å§šæ˜&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;ç§‘æ¯”&quot;</span>);<br>        strList.insert(<span class="hljs-string">&quot;éº¦è¿ª&quot;</span>);<br>        strList.insert(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;è©¹å§†æ–¯&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String s : strList) &#123;<br>            System.out.println(s);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>å§šæ˜<br>è©¹å§†æ–¯<br>ç§‘æ¯”<br>éº¦è¿ª<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€é¡ºåºè¡¨çš„å®¹é‡å¯å˜"><a href="#ä¸‰ã€é¡ºåºè¡¨çš„å®¹é‡å¯å˜" class="headerlink" title="ä¸‰ã€é¡ºåºè¡¨çš„å®¹é‡å¯å˜"></a>ä¸‰ã€é¡ºåºè¡¨çš„å®¹é‡å¯å˜</h2><p>å‰é¢çš„å®ç°ä¸­ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ SequenceList æ—¶ï¼Œå…ˆ new SequenceList(5) åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å°±éœ€è¦æŒ‡å®šå®¹å™¨çš„å¤§å°ï¼Œåˆå§‹åŒ–æŒ‡å®šå¤§å°çš„æ•°ç»„æ¥å­˜å‚¨å…ƒç´ ï¼Œå½“æˆ‘ä»¬æ’å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœå·²ç»æ’å…¥äº† 5 ä¸ªå…ƒç´ ï¼Œè¿˜è¦ç»§ç»­æ’å…¥æ•°æ®ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œå°±ä¸èƒ½æ’å…¥äº†ã€‚è¿™ç§è®¾è®¡ä¸ç¬¦åˆå®¹å™¨çš„è®¾è®¡ç†å¿µï¼Œå› æ­¤æˆ‘ä»¬åœ¨è®¾è®¡é¡ºåºè¡¨æ—¶ï¼Œåº”è¯¥è€ƒè™‘å®ƒçš„ä¼¸ç¼©æ€§ã€‚</p><p>1ã€æ·»åŠ å…ƒç´ æ—¶ï¼š</p><p>æ·»åŠ å…ƒç´ æ—¶ï¼Œåº”è¯¥æ£€æŸ¥å½“å‰æ•°ç»„çš„å¤§å°æ˜¯å¦èƒ½å®¹çº³æ–°çš„å…ƒç´ ï¼Œå¦‚æœä¸èƒ½å®¹çº³ï¼Œåˆ™éœ€è¦åˆ›å»ºæ–°çš„å®¹é‡æ›´å¤§çš„æ•°ç»„ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ›å»ºä¸€ä¸ªæ—¶åŸæ•°ç»„ä¸¤å€å®¹é‡çš„æ–°æ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a5d5c13600614f58866db17157e297ec~tplv-k3u1fbpfcp-watermark.image" alt="image-20221204214439619.png"></p><p>2ã€ç§»é™¤å…ƒç´ æ—¶ï¼š</p><p>ç§»é™¤å…ƒç´ æ—¶ï¼Œåº”è¯¥æ£€æŸ¥å½“å‰æ•°ç»„çš„å¤§å°æ˜¯å¦å¤ªå¤§ï¼Œæ¯”å¦‚æ­£åœ¨ç”¨ 100 ä¸ªå®¹é‡çš„æ•°ç»„å­˜å‚¨ 10 ä¸ªå…ƒç´ ï¼Œè¿™æ ·å°±ä¼šé€ æˆå†…å­˜ç©ºé—´çš„æµªè´¹ï¼Œåº”è¯¥åˆ›å»ºä¸€ä¸ªå®¹é‡æ›´å°çš„æ•°ç»„å­˜å‚¨å…ƒç´ ã€‚å¦‚æœæˆ‘ä»¬å‘ç°æ•°æ®å…ƒç´ çš„æ•°é‡ä¸è¶³æ•°ç»„å®¹é‡çš„1&#x2F;4ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ˜¯åŸæ•°ç»„å®¹é‡çš„ 1&#x2F;2 çš„æ–°æ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b6a0a28f760c4a65a5cf5f4c09b5fe01~tplv-k3u1fbpfcp-watermark.image" alt="image-20221204214808811.png"></p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SequenceList</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt;&#123;<br><br>    <span class="hljs-comment">//å­˜å‚¨å…ƒç´ çš„æ•°ç»„</span><br>    <span class="hljs-keyword">private</span> T[] eles;<br>    <span class="hljs-comment">//è®°å½•å½“å‰é¡ºåºè¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> N;<br><br>    <span class="hljs-comment">//æ„é€ æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SequenceList</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> &#123;<br>        eles = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<br>    &#125;<br><br>    <span class="hljs-comment">//æ¸…ç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>&#123;<br>        N = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æ˜¯å¦ä¸ºç©º</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N == <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//é•¿åº¦</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> N;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">return</span> eles[i];<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ ï¼Œå¸¦ä¸‹æ ‡</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> i, T t)</span> &#123;<br>        <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹</span><br>        <span class="hljs-keyword">if</span>(N == eles.length)&#123;<br>            resize(eles.length * <span class="hljs-number">2</span>);<br>        &#125;<br>        <span class="hljs-comment">//1ã€å°† i åŠä¹‹åä½ç½®çš„å…ƒç´ å¾€åç§»ä¸€ä½</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> N; index &gt; i; index--) &#123;<br>            eles[index] = eles[index - <span class="hljs-number">1</span>];<br>        &#125;<br>        <span class="hljs-comment">//2ã€åœ¨ i ä½ç½®å¤„æ’å…¥ t</span><br>        eles[i] = t;<br>        <span class="hljs-comment">//3ã€å…ƒç´ ä¸ªæ•°åŠ  1</span><br>        N++;<br>    &#125;<br><br>    <span class="hljs-comment">//æ’å…¥å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹</span><br>        <span class="hljs-keyword">if</span>(N == eles.length)&#123;<br>            resize(eles.length * <span class="hljs-number">2</span>);<br>        &#125;<br>        eles[N++] = t;<br>    &#125;<br><br>    <span class="hljs-comment">//ç§»é™¤å¹¶è¿”å›å½“å‰å…ƒç´ </span><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦éœ€è¦ç¼©å®¹</span><br>        <span class="hljs-keyword">if</span>(N &lt; eles.length / <span class="hljs-number">4</span>)&#123;<br>            resize(eles.length / <span class="hljs-number">2</span>);<br>        &#125;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">T</span> <span class="hljs-variable">removeElement</span> <span class="hljs-operator">=</span> eles[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> i; index &lt; N - <span class="hljs-number">1</span>; index++)&#123;<br>            eles[index] = eles[index + <span class="hljs-number">1</span>];<br>        &#125;<br>        N--;<br>        <span class="hljs-keyword">return</span> removeElement;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–å½“å‰å…ƒç´ çš„ç´¢å¼•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T t)</span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>            <span class="hljs-keyword">if</span>(eles[i].equals(t))&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@NonNull</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SIterator</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt;&#123;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> cursor &lt; N;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> eles[cursor++];<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//æ‰©å®¹æˆ–è€…ç¼©å®¹</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">resize</span><span class="hljs-params">(<span class="hljs-type">int</span> newSize)</span>&#123;<br>        <span class="hljs-comment">//1ã€å®šä¹‰ä¸€ä¸ªä¸´æ—¶æ•°ç»„ï¼ŒæŒ‡å‘åŸæ•°ç»„</span><br>        T[] temp = eles;<br>        <span class="hljs-comment">//2ã€åˆ›å»ºæ–°æ•°ç»„</span><br>        eles = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[newSize];<br>        <span class="hljs-comment">//3ã€æŠŠåŸæ•°ç»„çš„æ•°æ®æ‹·è´åˆ°æ–°æ•°ç»„</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>            eles[i] = temp[i];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››ã€é¡ºåºè¡¨çš„æ—¶é—´å¤æ‚åº¦"><a href="#å››ã€é¡ºåºè¡¨çš„æ—¶é—´å¤æ‚åº¦" class="headerlink" title="å››ã€é¡ºåºè¡¨çš„æ—¶é—´å¤æ‚åº¦"></a>å››ã€é¡ºåºè¡¨çš„æ—¶é—´å¤æ‚åº¦</h2><h3 id="4-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#4-1ã€get-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="4.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>4.1ã€get(i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>get(i) ä¸éš¾çœ‹å‡ºï¼Œä¸è®ºæ•°æ®å…ƒç´ é‡ N æœ‰å¤šå¤§ï¼Œåªéœ€è¦ä¸€æ¬¡ eles[i] å°±å¯ä»¥è·å–åˆ°å¯¹åº”çš„å…ƒç´ ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º O(1)</p><h3 id="4-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#4-2ã€insert-int-i-T-t-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="4.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>4.2ã€insert(int i,T t) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>insert(int i,T t) æ¯ä¸€æ¬¡æ’å…¥ï¼Œéƒ½éœ€è¦æŠŠ i åŠ i åé¢ä½ç½®çš„å…ƒç´ å¾€åç§»ä¸€ä½ï¼Œéšç€å…ƒç´ æ•°é‡ N çš„å¢å¤§ï¼Œç§»åŠ¨çš„å…ƒç´ ä¹Ÿè¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h3 id="4-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦"><a href="#4-3ã€remove-int-i-æ–¹æ³•æ—¶é—´å¤æ‚åº¦" class="headerlink" title="4.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦"></a>4.3ã€remove(int i) æ–¹æ³•æ—¶é—´å¤æ‚åº¦</h3><p>remove(int i) æ¯ä¸€æ¬¡åˆ é™¤ï¼Œéƒ½éœ€è¦æŠŠ i åŠ i åé¢ä½ç½®çš„å…ƒç´ å¾€å‰ç§»ä¸€ä½ï¼Œéšç€å…ƒç´ æ•°é‡ N çš„å¢å¤§ï¼Œç§»åŠ¨çš„å…ƒç´ ä¹Ÿè¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p><h2 id="äº”ã€Java-ä¸­-ArrayList-å®ç°"><a href="#äº”ã€Java-ä¸­-ArrayList-å®ç°" class="headerlink" title="äº”ã€Java ä¸­ ArrayList å®ç°"></a>äº”ã€Java ä¸­ ArrayList å®ç°</h2><p>Java ä¸­ ArrayList é›†åˆçš„åº•å±‚å°±æ˜¯ä¸€ç§é¡ºåºè¡¨ï¼Œç±»ä¼¼æˆ‘ä»¬ä¸Šé¢ SequenceListï¼Œä½¿ç”¨æ•°ç»„å®ç°ï¼ŒåŒæ ·æä¾›äº†å¢åˆ æ”¹æŸ¥ï¼Œéå†åŠæ‰©å®¹ç­‰åŠŸèƒ½ã€‚</p><h2 id="å…­ã€æ€»è®¡"><a href="#å…­ã€æ€»è®¡" class="headerlink" title="å…­ã€æ€»è®¡"></a>å…­ã€æ€»è®¡</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€é¡ºåºè¡¨çš„ API è®¾è®¡å¹¶è¿›è¡Œäº†å…·ä½“å®ç°ï¼Œä»¥åŠè¿›è¡Œæµ‹è¯•ç”¨ä¾‹æµ‹è¯•</p><p>2ã€é€šè¿‡å®ç° Iterable æ¥å£è®©æˆ‘ä»¬çš„é¡ºåºè¡¨èƒ½å¤Ÿä½¿ç”¨å¢å¼º for å¾ªç¯æ¥éå†</p><p>3ã€å¯¹é¡ºåºè¡¨è¿›è¡Œæ‰©å®¹å¤„ç†</p><p>4ã€åˆ†æäº†é¡ºåºè¡¨ä¸­æ ¸å¿ƒæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼š</p><blockquote><p>1ã€get(i)ï¼šO(1)</p><p>2ã€set(int i,T t)ï¼šO(n)</p><p>3ã€remove(int i)ï¼šO(n)</p></blockquote><p>5ã€ä»‹ç»äº† Java ä¸­çš„ ArrayListï¼Œå®é™…ä¸Šå®ƒçš„å®ç°å’Œ Sequence ç±»ä¼¼</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€‰æ‹©æ’åºå’Œæ’å…¥æ’åºï¼ˆä¸‰ï¼‰</title>
    <link href="/2022/08/02/A3-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E5%92%8C%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2022/08/02/A3-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E5%92%8C%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€é€‰æ‹©æ’åº"><a href="#ä¸€ã€é€‰æ‹©æ’åº" class="headerlink" title="ä¸€ã€é€‰æ‹©æ’åº"></a>ä¸€ã€é€‰æ‹©æ’åº</h2><p>é€‰æ‹©æ’åºæ˜¯ä¸€ç§æ›´åŠ ç®€å•ç›´è§‚çš„æ’åºæ–¹æ³•</p><p>éœ€æ±‚ï¼š</p><p>æ’åºå‰ï¼š{4,6,8,7,9,2,10,1}</p><p>æ’åºåï¼š{1,2,4,5,7,8,9,10}</p><p><strong>æ’åºåŸç†ï¼š</strong></p><p>1ã€æ¯ä¸€æ¬¡åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œéƒ½å‡å®šç¬¬ä¸€ä¸ªç´¢å¼•å¤„çš„å…ƒç´ æ˜¯æœ€å°å€¼ï¼Œå’Œå…¶ä»–ç´¢å¼•å¤„çš„å€¼ä¾æ¬¡è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå½“å‰ç´¢å¼•å¤„çš„å€¼å¤§äºå…¶ä»–æŸä¸ªç´¢å¼•å¤„çš„å€¼ï¼Œåˆ™å‡å®šå…¶ä»–æŸä¸ªç´¢å¼•å¤„çš„å€¼ä¸ºæœ€å°å€¼ï¼Œæœ€åå¯ä»¥æ‰¾åˆ°æœ€å°å€¼æ‰€åœ¨çš„ç´¢å¼•ã€‚</p><p>2ã€äº¤æ¢ç¬¬ä¸€ä¸ªç´¢å¼•å¤„å’Œæœ€å°å€¼æ‰€åœ¨çš„ç´¢å¼•å¤„çš„å€¼ </p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e88a04b53dac49d2abf44ca108326dc0~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203224040214.png"></p><p>äº†è§£äº†åŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä»£ç å®ç°ä¸€ä¸‹å®ƒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€ç¼–å†™ä¸€ä¸ªé€‰æ‹©æ’åºçš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Selection</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sort</span><span class="hljs-params">(Comparable[] a)</span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> a.length;<br>        <span class="hljs-comment">//å¤–å±‚å¾ªç¯éœ€è¦æ‰§è¡Œ length - 1 æ¬¡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length - <span class="hljs-number">1</span>; i++) &#123;<br>            <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªæœ€å°ç´¢å¼•ï¼Œç”¨äºå’Œ i ä½ç½®å¤„çš„å…ƒç´ è¿›è¡Œäº¤æ¢</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">minIndex</span> <span class="hljs-operator">=</span> i;<br>            <span class="hljs-comment">//å¤–å±‚å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå†…å±‚å¾ªç¯éœ€æ‰§è¡Œ length - i æ¬¡æ¥ç¡®å®šæœ€å°ç´¢å¼•</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; length; j++)&#123;<br>                <span class="hljs-comment">//å¦‚æœå‰ä¸€ä¸ªæ•°å¤§äºåä¸€ä¸ªæ•°ï¼Œåˆ™ä½¿ç”¨ minIndex è®°å½•è¾ƒå°å€¼çš„ç´¢å¼•</span><br>                <span class="hljs-keyword">if</span>(greater(a[minIndex],a[j]))&#123;<br>                    minIndex = j;<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">//äº¤æ¢ minIndex å’Œ i ä½ç½®å…ƒç´ çš„å€¼</span><br>            exchange(a,i,minIndex);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">greater</span><span class="hljs-params">(Comparable c1,Comparable c2)</span>&#123;<br>        <span class="hljs-keyword">return</span> c1.compareTo(c2) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * äº¤æ¢ iï¼Œj ä½ç½®çš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exchange</span><span class="hljs-params">(Comparable[] a,<span class="hljs-type">int</span> i,<span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">Comparable</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[i];<br>        a[i] = a[j];<br>        a[j] = temp;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>       Integer[] intArray = &#123;<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>&#125;;<br>       Selection.sort(intArray);<br>       System.out.println(Arrays.toString(intArray));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]<br></code></pre></td></tr></table></figure><p><strong>é€‰æ‹©æ’åºçš„æ—¶é—´å¤æ‚åº¦åˆ†æï¼š</strong></p><p>é€‰æ‹©æ’åºä½¿ç”¨äº†åŒå±‚ for å¾ªç¯ï¼Œå…¶ä¸­å¤–å±‚å¾ªç¯å®Œæˆäº†æ•°æ®äº¤æ¢ï¼Œå†…å±‚å¾ªç¯å®Œæˆäº†æ•°æ®æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ†åˆ«ç»Ÿè®¡æ•°æ®äº¤æ¢æ¬¡æ•°å’Œæ•°æ®æ¯”è¾ƒæ¬¡æ•°ï¼š</p><p>æ•°æ®æ¯”è¾ƒæ¬¡æ•°ï¼š</p><p>1 + 2 + 3 + 4â€¦ + (N - 2) + (N - 1) &#x3D; N^2&#x2F;2 - N&#x2F;2</p><p>æ•°æ®äº¤æ¢æ¬¡æ•°ï¼š</p><p>N - 1</p><p>æ—¶é—´å¤æ‚åº¦ï¼šN^2&#x2F;2 - N&#x2F;2 + (N - 1) &#x3D; N^2&#x2F;2 + N&#x2F;2 - 1</p><p>æ ¹æ®å¤§ O è¡¨ç¤ºæ³•æ¨å¯¼ï¼Œä¿ç•™æœ€é«˜é˜¶é¡¹ï¼Œå»é™¤å¸¸æ•°å› å­ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(N^2)</p><h2 id="äºŒã€æ’å…¥æ’åº"><a href="#äºŒã€æ’å…¥æ’åº" class="headerlink" title="äºŒã€æ’å…¥æ’åº"></a>äºŒã€æ’å…¥æ’åº</h2><p>æ’å…¥æ’åºï¼ˆInsertion sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚ä¸”ç¨³å®šçš„æ’åºç®—æ³•</p><p>æ’å…¥æ’åºçš„å·¥ä½œæ–¹å¼éå¸¸åƒäººä»¬æ’åºä¸€æ‰‹æ‰‘å…‹ç‰Œä¸€æ ·ï¼Œå¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å·¦æ‰‹ä¸ºç©ºå¹¶ä¸”æ¡Œå­ä¸Šçš„ç‰Œé¢æœä¸‹ã€‚ç„¶åï¼Œæˆ‘ä»¬æ¯æ¬¡ä»æ¡Œå­ä¸Šæ‹¿èµ°ä¸€å¼ ç‰Œå¹¶å°†å®ƒæ’å…¥å·¦æ‰‹ä¸­æ­£ç¡®çš„ä½ç½®ã€‚ä¸ºäº†æ‰¾åˆ°ä¸€å¼ ç‰Œçš„æ­£ç¡®ä½ç½®ï¼Œæˆ‘ä»¬ä»å³åˆ°å·¦å°†å®ƒä¸å·²åœ¨æ‰‹ä¸­çš„æ¯å¼ ç‰Œè¿›è¡Œæ¯”è¾ƒã€‚</p><p><strong>éœ€æ±‚ï¼š</strong></p><p>æ’åºå‰ï¼š{4,3,2,10,12,1,5,6}</p><p>æ’åºåï¼š{1,2,3,4,5,6,10,12}</p><p><strong>æ’åºåŸç†ï¼š</strong></p><p>1ã€æŠŠæ‰€æœ‰çš„å…ƒç´ åˆ†ä¸ºä¸¤ç»„ï¼Œå·²ç»æ’åºçš„å’Œæœªæ’åºçš„ã€‚</p><p>2ã€æ‰¾åˆ°æœªæ’åºç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå‘å·²ç»æ’åºçš„ç»„ä¸­è¿›è¡Œæ’å…¥ã€‚</p><p>3ã€å€’åºéå†å·²ç»æ’åºçš„å…ƒç´ ï¼Œä¾æ¬¡å’Œå¾…æ’å…¥çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ å°äºç­‰äºå¾…æ’å…¥å…ƒç´ ï¼Œé‚£ä¹ˆå°±æŠŠå¾…æ’å…¥å…ƒç´ æ”¾åˆ°è¿™ä¸ªä½ç½®ï¼Œå…¶ä»–çš„å…ƒç´ å‘åç§»åŠ¨ä¸€ä½ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/791f691a1ac24c0c9e5ec089675c46ce~tplv-k3u1fbpfcp-watermark.image" alt="image-20221203230655885.png"></p><p>äº†è§£äº†åŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä»£ç å®ç°ä¸€ä¸‹å®ƒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€ç¼–å†™ä¸€ä¸ªæ’å…¥æ’åºçš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Insertion</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sort</span><span class="hljs-params">(Comparable[] a)</span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> a.length;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; length; i++) &#123;<br>            <span class="hljs-comment">//å½“å‰å…ƒç´  a[i] ï¼Œä¾æ¬¡å’Œ i å‰é¢çš„å…ƒç´ æ¯”è¾ƒï¼Œæ‰¾åˆ°ä¸€ä¸ªå°äºç­‰äº a[i] çš„å…ƒç´ æ—¶ï¼Œè¿›è¡Œäº¤æ¢</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i; j &gt; <span class="hljs-number">0</span>; j--)&#123;<br>                <span class="hljs-keyword">if</span>(greater(a[j-<span class="hljs-number">1</span>],a[j]))&#123;<br>                    <span class="hljs-comment">//äº¤æ¢å…ƒç´ </span><br>                    exchange(a,j-<span class="hljs-number">1</span>,j);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-comment">//æ‰¾åˆ°äº†è¯¥å…ƒç´ ï¼Œç»“æŸå†…å±‚ for å¾ªç¯</span><br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">greater</span><span class="hljs-params">(Comparable c1,Comparable c2)</span>&#123;<br>        <span class="hljs-keyword">return</span> c1.compareTo(c2) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * äº¤æ¢ iï¼Œj ä½ç½®çš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exchange</span><span class="hljs-params">(Comparable[] a,<span class="hljs-type">int</span> i,<span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">Comparable</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[i];<br>        a[i] = a[j];<br>        a[j] = temp;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>       Integer[] intArray = &#123;<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;;<br>       Insertion.sort(intArray);<br>       System.out.println(Arrays.toString(intArray));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">12</span>]<br></code></pre></td></tr></table></figure><p><strong>æ’å…¥æ’åºæ—¶é—´å¤æ‚åº¦åˆ†æï¼š</strong></p><p>æ’å…¥æ’åºä½¿ç”¨äº†åŒå±‚ for å¾ªç¯ï¼Œå…¶ä¸­å†…å±‚å¾ªç¯çš„å¾ªç¯ä½“æ˜¯çœŸæ­£å®Œæˆæ’åºçš„ä»£ç ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ†ææ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œä¸»è¦åˆ†æä¸€ä¸‹å†…å±‚å¾ªç¯ä½“çš„æ‰§è¡Œæ¬¡æ•°å³å¯ã€‚</p><p>æœ€åæƒ…å†µï¼Œä¹Ÿå°±æ˜¯å¾…æ’åºçš„æ•°ç»„å…ƒç´ ä¸º {12,10,6,5,4,3,2,1}ï¼Œé‚£ä¹ˆï¼š</p><p>æ¯”è¾ƒçš„æ¬¡æ•°ä¸ºï¼š</p><p>1 + 2 + 3 + â€¦(N - 2) + (N - 1) &#x3D; N^2 &#x2F; 2 - N &#x2F; 2</p><p>äº¤æ¢çš„æ¬¡æ•°ï¼š</p><p>1 + 2 + 3 + â€¦(N - 2) + (N - 1) &#x3D; N^2 &#x2F; 2 - N &#x2F; 2</p><p>æ€»æ‰§è¡Œæ¬¡æ•°ï¼š</p><p>N^2 &#x2F; 2 - N &#x2F; 2 + N^2 &#x2F; 2 - N &#x2F; 2 &#x3D; N^2 - N</p><p>æ ¹æ®å¤§ O è¡¨ç¤ºæ³•æ¨å¯¼ï¼Œä¿ç•™æœ€é«˜é˜¶é¡¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(N^2)</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€é€‰æ‹©æ’åºåŸç†ï¼Œå®é™…æ¡ˆä¾‹ç¼–å†™ï¼Œä»¥åŠæ—¶é—´å¤æ‚åº¦åˆ†æ</p><p>2ã€æ’å…¥æ’åºåŸç†ï¼Œå®é™…æ¡ˆä¾‹ç¼–å†™ï¼Œä»¥åŠæ—¶é—´å¤æ‚åº¦åˆ†æ</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®€å•æ’åºå’Œå†’æ³¡æ’åºï¼ˆäºŒï¼‰</title>
    <link href="/2022/08/01/A2-%E7%AE%80%E5%8D%95%E6%8E%92%E5%BA%8F%E5%92%8C%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2022/08/01/A2-%E7%AE%80%E5%8D%95%E6%8E%92%E5%BA%8F%E5%92%8C%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ç®€å•æ’åº"><a href="#ä¸€ã€ç®€å•æ’åº" class="headerlink" title="ä¸€ã€ç®€å•æ’åº"></a>ä¸€ã€ç®€å•æ’åº</h2><p>åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ï¼Œæ’åºæ˜¯éå¸¸å¸¸è§çš„ä¸€ç§éœ€æ±‚ï¼Œæä¾›ä¸€äº›æ•°æ®å…ƒç´ ï¼ŒæŠŠè¿™äº›æ•°æ®å…ƒç´ æŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œæ’åºï¼Œæ¯”å¦‚æŸ¥è¯¢ä¸€äº›å•†å“ï¼ŒæŒ‰ç…§å•†å“çš„ä»·æ ¼è¿›è¡Œæ’åºï¼Œå†æ¯”å¦‚æ¯”è¾ƒå­¦ç”Ÿï¼ŒæŒ‰ç…§å­¦ç”Ÿçš„å¹´é¾„è¿›è¡Œæ’åºç­‰ç­‰ã€‚</p><h3 id="1-1ã€Comparable-æ¥å£ä»‹ç»"><a href="#1-1ã€Comparable-æ¥å£ä»‹ç»" class="headerlink" title="1.1ã€Comparable æ¥å£ä»‹ç»"></a>1.1ã€Comparable æ¥å£ä»‹ç»</h3><p>1ï¼‰ã€Comparable æ˜¯ Java ç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªç”¨äºå®šä¹‰æ’åºè§„åˆ™çš„æ¥å£ã€‚</p><p>2ï¼‰ã€Comparableæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼š<code>punblic int comparTo(Object obj)</code> ï¼Œobj ä¸ºè¦æ¯”è¾ƒçš„å¯¹è±¡ã€‚</p><p>3ï¼‰ã€compareTo æ–¹æ³•ä¸­ï¼Œå°†å½“å‰å¯¹è±¡å’Œ obj è¿™ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå¤§äºè¿”å› 1ï¼Œç­‰äºè¿”å› 0ï¼Œå°äºè¿”å› -1ï¼Œ(æ­¤å¤„çš„ 1 ä¹Ÿå¯ä»¥æ˜¯æ­£æ•´æ•°ï¼Œ-1 ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•´æ•°ï¼‰ã€‚</p><h3 id="1-2ã€å®é™…æ¡ˆä¾‹"><a href="#1-2ã€å®é™…æ¡ˆä¾‹" class="headerlink" title="1.2ã€å®é™…æ¡ˆä¾‹"></a>1.2ã€å®é™…æ¡ˆä¾‹</h3><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä»¥æ¡ˆä¾‹çš„å½¢å¼è¿›è¡Œä¸€ä¸ªç®€å•çš„å®è·µï¼š</p><p>1ã€å®šä¹‰ä¸€ä¸ªå­¦ç”Ÿç±» Student ï¼Œä»–æœ‰å¹´é¾„ age å’Œå§“å username ä¸¤ä¸ªå±æ€§ï¼Œå¹¶é€šè¿‡ Comparable æ¥å£æä¾›æ¯”è¾ƒè§„åˆ™ã€‚</p><p>2ã€å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç±» Testï¼Œåœ¨æµ‹è¯•ç±»ä¸­å®šä¹‰æµ‹è¯•æ–¹æ³•<code>Comparable getMax(Comparable c1,Comparable c2)</code>å®Œæˆæµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€å®šä¹‰å­¦ç”Ÿç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Student&gt;&#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span>&#123;<br>        <span class="hljs-built_in">this</span>.username = username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span>&#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student&#123;username=&quot;</span> + username + <span class="hljs-string">&quot;,age=&quot;</span> + age + <span class="hljs-string">&quot;&#125;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Student o)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getAge() - o.getAge();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€å®šä¹‰æµ‹è¯•ç±»å¹¶è¿›è¡Œæµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Comparable <span class="hljs-title function_">getMax</span><span class="hljs-params">(Comparable c1,Comparable c2)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> c1.compareTo(c2);<br>        <span class="hljs-keyword">if</span>(result &gt;= <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span> c1;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> c2;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Student</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();<br>        s1.setUsername(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>        s1.setAge(<span class="hljs-number">18</span>);<br><br>        <span class="hljs-type">Student</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();<br>        s2.setUsername(<span class="hljs-string">&quot;æå››&quot;</span>);<br>        s2.setAge(<span class="hljs-number">20</span>);<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Comparable</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> getMax(s1, s2);<br>        System.out.println(max);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>Student&#123;username=æå››,age=<span class="hljs-number">20</span>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æˆ‘ä»¬ä½¿ç”¨ Comparable æ¥å£å®šä¹‰äº†å­¦ç”Ÿçš„æ¯”è¾ƒè§„åˆ™ï¼Œè·å–å¹´é¾„è¾ƒå¤§çš„å­¦ç”Ÿ</p><h2 id="äºŒã€å†’æ³¡æ’åº"><a href="#äºŒã€å†’æ³¡æ’åº" class="headerlink" title="äºŒã€å†’æ³¡æ’åº"></a>äºŒã€å†’æ³¡æ’åº</h2><p>1ï¼‰ã€å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦é¢†åŸŸä¸€ç§è¾ƒä¸ºç®€å•çš„æ’åºç®—æ³•</p><p>2ï¼‰ã€å†’æ³¡æ’åºçš„åŸç†ï¼š</p><blockquote><p>1ã€æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ï¼Œå¦‚æœå‰ä¸€ä¸ªå…ƒç´ æ¯”åä¸€ä¸ªå…ƒç´ å¤§ï¼Œå°±äº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ã€‚</p><p>2ã€å¯¹æ¯ä¸€ä¸ªç›¸é‚»å…ƒç´ åšåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹å…ƒç´ åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹å…ƒç´ ï¼Œæœ€ç»ˆæœ€åä½ç½®çš„å…ƒç´ å°±æ˜¯æœ€å¤§å€¼ã€‚</p></blockquote><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0dc376a55d324a14a11c559ae259f881~tplv-k3u1fbpfcp-watermark.image" alt="image-20221202230958882.png"></p><p><strong>å®é™…æ¡ˆä¾‹ï¼š</strong></p><p>æ’åºå‰ï¼š{4,5,6,3,2,1}</p><p>æ’åºåï¼š{1,2,3,4,5,6}</p><p>æˆ‘ä»¬ä½¿ç”¨å†’æ³¡æ’åºå®ç°ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1ã€ç¼–å†™ä¸€ä¸ªå†’æ³¡æ’åºçš„ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bubble</span>&#123;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sort</span><span class="hljs-params">(Comparable[] a)</span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> a.length;<br>        <span class="hljs-comment">//å¤–å±‚å¾ªç¯éœ€è¦æ‰§è¡Œ length - 1 æ¬¡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> length - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; i--)&#123;<br>            <span class="hljs-comment">//å¤–å±‚å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå†…å±‚å¾ªç¯éœ€æ‰§è¡Œ i æ¬¡æ¯”è¾ƒæ¥å°†æœ€å¤§æ•°æ”¾åˆ°æœ€åé¢</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; i; j++)&#123;<br>                <span class="hljs-comment">//å¦‚æœå‰ä¸€ä¸ªæ•°å¤§äºåä¸€ä¸ªæ•°ï¼Œåˆ™è¿›è¡Œäº¤æ¢</span><br>                <span class="hljs-keyword">if</span>(greater(a[j],a[j+<span class="hljs-number">1</span>]))&#123;<br>                    exchange(a,j,j+<span class="hljs-number">1</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">greater</span><span class="hljs-params">(Comparable c1,Comparable c2)</span>&#123;<br>        <span class="hljs-keyword">return</span> c1.compareTo(c2) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * äº¤æ¢ iï¼Œj ä½ç½®çš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exchange</span><span class="hljs-params">(Comparable[] a,<span class="hljs-type">int</span> i,<span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">Comparable</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[i];<br>        a[i] = a[j];<br>        a[j] = temp;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//2ã€æµ‹è¯•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>       Integer[] intArray = &#123;<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>&#125;;<br>       Bubble.sort(intArray);<br>       System.out.println(Arrays.toString(intArray));<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br></code></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€Comparable æ¥å£ï¼šä¸»è¦ç”¨äºå®šä¹‰æ’åºçš„è§„åˆ™ã€‚å¹¶ç¼–å†™äº†å®é™…æ¡ˆä¾‹</p><p>2ã€ä»‹ç»äº†å†’æ³¡æ’åºçš„åŸç†ï¼Œå¹¶ä½¿ç”¨å†’æ³¡æ’åºç®—æ³•å¯¹æˆ‘ä»¬çš„æ•°ç»„è¿›è¡Œä»å°åˆ°å¤§çš„å‡åºæ’åº</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•åˆ†æï¼ˆä¸€ï¼‰</title>
    <link href="/2022/07/31/A1-%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2022/07/31/A1-%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#ä¸€ã€ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="ä¸€ã€ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>ä¸€ã€ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æ</h2><h3 id="1-1ã€å¤§Oè¡¨ç¤ºæ³•"><a href="#1-1ã€å¤§Oè¡¨ç¤ºæ³•" class="headerlink" title="1.1ã€å¤§Oè¡¨ç¤ºæ³•"></a>1.1ã€å¤§Oè¡¨ç¤ºæ³•</h3><p>1ï¼‰ã€åœ¨è¿›è¡Œç®—æ³•åˆ†ææ—¶ï¼Œè¯­å¥æ€»çš„æ‰§è¡Œæ¬¡æ•° T(n) æ˜¯å…³äºé—®é¢˜è§„æ¨¡ n çš„å‡½æ•°ï¼Œè¿›è€Œåˆ†æ T(n) éšç€ n çš„å˜åŒ–æƒ…å†µå¹¶ç¡®å®š T(n)çš„é‡çº§</p><p>2ï¼‰ã€ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬è®°ä½œï¼š<code>T(n) = O(f(n))</code> ï¼Œå®ƒè¡¨ç¤ºéšç€é—®é¢˜è§„æ¨¡ n çš„å¢å¤§ï¼Œç®—æ³•æ‰§è¡Œæ—¶é—´çš„å¢é•¿ç‡å’Œ f(n) çš„å¢é•¿ç‡ç›¸åŒï¼Œå…¶ä¸­ f(n) æ˜¯é—®é¢˜è§„æ¨¡ n çš„æŸä¸ªå‡½æ•°ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ä¸ªäº‹æƒ…ï¼š<strong>æ‰§è¡Œæ¬¡æ•° &#x3D; æ‰§è¡Œæ—¶é—´</strong></p><p>3ï¼‰ã€ç”¨å¤§å†™<code> O()</code>æ¥ä½“ç°ç®—æ³•æ—¶é—´å¤æ‚åº¦çš„è®°æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¤§Oè¡¨ç¤ºæ³•ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéšç€è¾“å…¥è§„æ¨¡ n çš„å¢å¤§ï¼ŒT(n) å¢é•¿æœ€æ…¢çš„ç®—æ³•ä¸ºæœ€ä¼˜ç®—æ³•ã€‚</p><p><strong>ç®—æ³•ä¸€ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//æ‰§è¡Œä¸€æ¬¡</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<span class="hljs-comment">//æ‰§è¡Œä¸€æ¬¡</span><br>        sum = (n + <span class="hljs-number">1</span>) * n / <span class="hljs-number">2</span>;<span class="hljs-comment">//æ‰§è¡Œä¸€æ¬¡</span><br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç®—æ³•äºŒï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//æ‰§è¡Œ1æ¬¡</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<span class="hljs-comment">//æ‰§è¡Œ1æ¬¡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            sum += i;<span class="hljs-comment">//æ‰§è¡Œnæ¬¡</span><br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç®—æ³•ä¸‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//æ‰§è¡Œ1æ¬¡</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<span class="hljs-comment">//æ‰§è¡Œ1æ¬¡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;<br>                sum += i;<span class="hljs-comment">//æ‰§è¡Œn^2æ¬¡</span><br>            &#125;<br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœå¿½ç•¥åˆ¤æ–­æ¡ä»¶çš„æ‰§è¡Œæ¬¡æ•°å’Œè¾“å‡ºè¯­å¥çš„æ‰§è¡Œæ¬¡æ•°ï¼Œé‚£ä¹ˆå½“è¾“å…¥è§„æ¨¡ä¸º n æ—¶ï¼Œä»¥ä¸Šç®—æ³•æ‰§è¡Œçš„æ¬¡æ•°åˆ†åˆ«ä¸ºï¼š</p><p>1ã€ç®—æ³•ä¸€ï¼š3 æ¬¡</p><p>2ã€ç®—æ³•äºŒï¼šn + 2 æ¬¡</p><p>3ã€ç®—æ³•ä¸‰ï¼šn^2 + 2 æ¬¡</p><h4 id="1-1-1ã€å¤§Oè¡¨ç¤ºæ³•è§„åˆ™"><a href="#1-1-1ã€å¤§Oè¡¨ç¤ºæ³•è§„åˆ™" class="headerlink" title="1.1.1ã€å¤§Oè¡¨ç¤ºæ³•è§„åˆ™"></a>1.1.1ã€å¤§Oè¡¨ç¤ºæ³•è§„åˆ™</h4><p>å¤§Oè¡¨ç¤ºæ³•æœ‰ä»¥ä¸‹å‡ ä¸ªè§„åˆ™å¯ä»¥ä½¿ç”¨ï¼š</p><p><strong>1ã€ç”¨å¸¸æ•° 1 å–ä»£è¿è¡Œæ—¶é—´ä¸­çš„æ‰€æœ‰åŠ æ³•å¸¸æ•°</strong></p><p><strong>2ã€åœ¨ä¿®æ”¹åçš„è¿è¡Œæ¬¡æ•°ä¸­ï¼Œåªä¿ç•™é«˜é˜¶é¡¹</strong></p><p><strong>3ã€å¦‚æœæœ€é«˜é˜¶é¡¹å­˜åœ¨ï¼Œä¸”å¸¸æ•°å› å­ä¸ä¸º 1ï¼Œåˆ™å»é™¤ä¸è¿™ä¸ªé¡¹ç›¸ä¹˜çš„å¸¸æ•°</strong></p><p>æ ¹æ®è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ¨ç®—ä¸Šè¿°ä¸‰ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼š</p><p>1ã€ç®—æ³•ä¸€ï¼šO(1)</p><p>2ã€ç®—æ³•äºŒï¼šO(n)</p><p>3ã€ç®—æ³•ä¸‰ï¼šO(n^2)</p><h3 id="1-2ã€å¸¸è§çš„å¤§Oé˜¶"><a href="#1-2ã€å¸¸è§çš„å¤§Oé˜¶" class="headerlink" title="1.2ã€å¸¸è§çš„å¤§Oé˜¶"></a>1.2ã€å¸¸è§çš„å¤§Oé˜¶</h3><h4 id="1-2-1ã€çº¿æ€§é˜¶"><a href="#1-2-1ã€çº¿æ€§é˜¶" class="headerlink" title="1.2.1ã€çº¿æ€§é˜¶"></a>1.2.1ã€çº¿æ€§é˜¶</h4><p>ä¸€èˆ¬å«æœ‰éåµŒå¥—å¾ªç¯æ¶‰åŠçº¿æ€§é˜¶ï¼Œçº¿æ€§é˜¶å°±æ˜¯éšç€è¾“å…¥è§„æ¨¡çš„æ‰©å¤§ï¼Œå¯¹åº”è®¡ç®—æ¬¡æ•°å‘ˆç›´çº¿å¢é•¿ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            sum += i;<br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œä»–å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå› ä¸ºå¾ªç¯ä½“ä¸­çš„ä»£ç éœ€è¦æ‰§è¡Œ n æ¬¡</p><h4 id="1-2-2ã€å¹³æ–¹é˜¶"><a href="#1-2-2ã€å¹³æ–¹é˜¶" class="headerlink" title="1.2.2ã€å¹³æ–¹é˜¶"></a>1.2.2ã€å¹³æ–¹é˜¶</h4><p>ä¸€èˆ¬åµŒå¥—å¾ªç¯å±äºè¿™ç§æ—¶é—´å¤æ‚åº¦ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;<br>                sum += i;<br>            &#125;<br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œn &#x3D; 100ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤–å±‚å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå†…å±‚å¾ªç¯æ‰§è¡Œ 100 æ¬¡ï¼Œé‚£æ€»å…±ç¨‹åºæƒ³è¦ä»ä¸¤ä¸ªå¾ªç¯ä¸­å‡ºæ¥ï¼Œå°±éœ€è¦æ‰§è¡Œ 100*100 æ¬¡ï¼Œä¹Ÿå°±æ˜¯ n çš„å¹³æ–¹æ¬¡ï¼Œæ‰€ä»¥è¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2)</p><h4 id="1-2-3ã€ç«‹æ–¹é˜¶"><a href="#1-2-3ã€ç«‹æ–¹é˜¶" class="headerlink" title="1.2.3ã€ç«‹æ–¹é˜¶"></a>1.2.3ã€ç«‹æ–¹é˜¶</h4><p>ä¸€èˆ¬ä¸‰å±‚åµŒå¥—å¾ªç¯å±äºè¿™ç§æ—¶é—´å¤æ‚åº¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; k &lt;= n; k++)&#123;<br>                    sum += i;<br>                &#125;<br>            &#125;<br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œn &#x3D; 100ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤–å±‚å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œä¸­é—´å¾ªç¯å°±æ‰§è¡Œ 100 æ¬¡ï¼Œä¸­é—´å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå†…å±‚å¾ªç¯å°±éœ€è¦æ‰§è¡Œ 100 æ¬¡ï¼Œé‚£æ€»å…±ç¨‹åºæƒ³è¦ä»ä¸‰ä¸ªå¾ªç¯ä¸­å‡ºæ¥ï¼Œå°±éœ€è¦æ‰§è¡Œ<code>100*100*100</code>æ¬¡ï¼Œä¹Ÿå°±æ˜¯ n çš„ç«‹æ–¹æ¬¡ï¼Œæ‰€ä»¥è¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^3)</p><h4 id="1-2-4ã€å¯¹æ•°é˜¶"><a href="#1-2-4ã€å¯¹æ•°é˜¶" class="headerlink" title="1.2.4ã€å¯¹æ•°é˜¶"></a>1.2.4ã€å¯¹æ•°é˜¶</h4><p>å¯¹æ•°ï¼Œå±äºé«˜ä¸­æ•°å­¦çš„å†…å®¹ï¼Œæˆ‘ä»¬ä»¥åˆ†æç¨‹åºä¸ºä¸»ï¼Œæ•°å­¦ä¸ºè¾…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">while</span>(i &lt; n)&#123;<br>            i = i * <span class="hljs-number">2</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºæ¯æ¬¡ i * 2 ä¹‹åï¼Œå°±è·ç¦» n æ›´è¿‘ä¸€æ­¥ï¼Œå‡è®¾æœ‰ x ä¸ª 2 ç›¸ä¹˜åå¤§äº nï¼Œåˆ™ä¼šæ¨å‡ºå¾ªç¯ï¼Œç”±äºæ˜¯ 2^x&#x3D;nï¼Œå¾—åˆ° x &#x3D; log(2)nï¼Œæ‰€ä»¥è¿™ä¸ªå¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)</p><h4 id="1-2-5ã€å¸¸æ•°é˜¶"><a href="#1-2-5ã€å¸¸æ•°é˜¶" class="headerlink" title="1.2.5ã€å¸¸æ•°é˜¶"></a>1.2.5ã€å¸¸æ•°é˜¶</h4><p>ä¸€èˆ¬ä¸æ¶‰åŠå¾ªç¯çš„æ“ä½œéƒ½æ˜¯å¸¸æ•°é˜¶ï¼Œä»–ä¸ä¼šéšç€ n çš„å¢é•¿è€Œå¢åŠ æ“ä½œæ¬¡æ•°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n + <span class="hljs-number">2</span>;<br>        System.out.println(i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œä¸ç®¡è¾“å…¥è§„æ¨¡ n æ˜¯å¤šå°‘ï¼Œéƒ½åªæ‰§è¡Œ 2 æ¬¡ï¼Œæ ¹æ®å¤§Oè¡¨ç¤ºæ³•è§„åˆ™ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)</p><h3 id="1-3ã€å‡½æ•°è°ƒç”¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#1-3ã€å‡½æ•°è°ƒç”¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="1.3ã€å‡½æ•°è°ƒç”¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>1.3ã€å‡½æ•°è°ƒç”¨çš„æ—¶é—´å¤æ‚åº¦åˆ†æ</h3><p>ä¹‹å‰ï¼Œæˆ‘ä»¬åˆ†æçš„éƒ½æ˜¯å•ä¸ªå‡½æ•°å†…ï¼Œç®—æ³•ä»£ç çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„æ—¶é—´å¤æ‚åº¦</p><p><strong>æ¡ˆä¾‹ä¸€ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            show(i);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        System.out.println(i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ main æ–¹æ³•ä¸­ï¼Œæœ‰ä¸€ä¸ª for å¾ªç¯ï¼Œå¾ªç¯ä½“è°ƒç”¨äº† show æ–¹æ³•ï¼Œç”±äº show æ–¹æ³•å†…éƒ¨åªæ‰§è¡Œäº†ä¸€è¡Œä»£ç ï¼Œæ‰€ä»¥ show æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1) ï¼Œé‚£ main æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n)</p><p><strong>æ¡ˆä¾‹äºŒï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            show(i);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; i; j++) &#123;<br>            System.out.println(i);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ main æ–¹æ³•ä¸­ï¼Œæœ‰ä¸€ä¸ª for å¾ªç¯ï¼Œå¾ªç¯ä½“è°ƒç”¨äº† show æ–¹æ³•ï¼Œç”±äº show æ–¹æ³•å†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ª for å¾ªç¯ï¼Œæ‰€ä»¥ show æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n) ï¼Œé‚£ main æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å°±ä¸º O(n^2)</p><h2 id="äºŒã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦åˆ†æ"><a href="#äºŒã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="äºŒã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦åˆ†æ"></a>äºŒã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦åˆ†æ</h2><h3 id="2-1ã€Java-ä¸­å¸¸è§å†…å­˜å ç”¨"><a href="#2-1ã€Java-ä¸­å¸¸è§å†…å­˜å ç”¨" class="headerlink" title="2.1ã€Java ä¸­å¸¸è§å†…å­˜å ç”¨"></a>2.1ã€Java ä¸­å¸¸è§å†…å­˜å ç”¨</h3><p>1ã€åŸºæœ¬æ•°æ®ç±»å‹å†…å­˜å ç”¨æƒ…å†µï¼š</p><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>å†…å­˜å ç”¨å­—èŠ‚æ•°</th></tr></thead><tbody><tr><td>byte</td><td>1</td></tr><tr><td>short</td><td>2</td></tr><tr><td>int</td><td>4</td></tr><tr><td>long</td><td>8</td></tr><tr><td>float</td><td>4</td></tr><tr><td>double</td><td>8</td></tr><tr><td>char</td><td>2</td></tr><tr><td>boolean</td><td>1</td></tr></tbody></table><p>2ã€ä¸€ä¸ªå­—èŠ‚å  8 ä½ï¼ˆbitï¼‰</p><p>3ã€ä¸€ä¸ªå¼•ç”¨éœ€è¦ 8 ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//date è¿™ä¸ªå˜é‡éœ€è¦å ç”¨ 8 ä¸ªå­—èŠ‚æ¥è¡¨ç¤º</span><br><span class="hljs-type">Date</span> <span class="hljs-variable">date</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br></code></pre></td></tr></table></figure><p>4ã€åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚ï¼šnew Date() ï¼Œé™¤äº† Date å¯¹è±¡å†…éƒ¨å­˜å‚¨çš„æ•°æ®ï¼ˆå¹´æœˆæ—¥ï¼‰å ç”¨çš„å†…å­˜ï¼Œè¯¥å¯¹è±¡æœ¬èº«ä¹Ÿæœ‰å†…å­˜å¼€é”€ï¼Œæ¯ä¸ªå¯¹è±¡æœ¬èº«å¼€é”€æ˜¯ 16 ä¸ªå­—èŠ‚ï¼Œç”¨æ¥ä¿å­˜å¯¹è±¡çš„å¤´ä¿¡æ¯</p><p>5ã€ä¸€èˆ¬å†…å­˜çš„ä½¿ç”¨ï¼Œå¦‚æœä¸å¤Ÿ 8 ä¸ªå­—èŠ‚ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨å¡«å……ä½ 8 å­—èŠ‚ï¼Œå¦‚ä¸‹ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-comment">//é€šè¿‡ new A() åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„å†…å­˜ï¼š</span><br><span class="hljs-comment">//1ã€æ•´å‹æˆå‘˜å˜é‡ a å ç”¨ 4 ä¸ªå­—èŠ‚</span><br><span class="hljs-comment">//2ã€å¯¹è±¡æœ¬èº«å ç”¨ 16 ä¸ªå­—èŠ‚</span><br><span class="hljs-comment">//é‚£ä¹ˆåˆ›å»ºè¯¥å¯¹è±¡æ€»å…±éœ€è¦ 20 ä¸ªå­—èŠ‚ï¼Œä½†ç”±äºä¸æ˜¯ 8 çš„å€æ•°ï¼Œä¼šè‡ªåŠ¨å¡«å……å˜ä¸º 24 ä¸ªå­—èŠ‚</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">A</span>();<br></code></pre></td></tr></table></figure><p>6ã€Java ä¸­æ•°ç»„è¢«é™å®šä½å¯¹è±¡ï¼Œä»–ä»¬ä¸€èˆ¬éƒ½ä¼šå› ä¸ºè®°å½•é•¿åº¦è€Œéœ€è¦é¢å¤–çš„å†…å­˜ï¼Œä¸€ä¸ªåŸå§‹æ•°æ®ç±»å‹çš„æ•°ç»„ä¸€èˆ¬éœ€è¦ 24 å­—èŠ‚çš„å¤´ä¿¡æ¯ï¼ˆ16 ä¸ªè‡ªå·±çš„å¯¹è±¡å¼€é”€ï¼Œ4 å­—èŠ‚ç”¨äºä¿å­˜é•¿åº¦ä»¥åŠ4ä¸ªå¡«å……å­—èŠ‚ï¼‰ï¼Œåœ¨åŠ ä¸Šä¿å­˜å€¼æ‰€éœ€çš„å†…å­˜ã€‚</p><h3 id="2-2ã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦"><a href="#2-2ã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦" class="headerlink" title="2.2ã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦"></a>2.2ã€ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦</h3><p>äº†è§£äº† Java å†…å­˜æœ€åŸºæœ¬çš„æœºåˆ¶ï¼Œå°±èƒ½å¤Ÿæœ‰æ•ˆå¸®åŠ©æˆ‘ä»¬ä¼°è®¡æœ€å¤§é‡ç¨‹åºçš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p><p>ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦å…¬å¼è®°ä¸ºï¼šS(n)&#x3D;O(f(n)) ï¼Œå…¶ä¸­ n ä¸ºè¾“å…¥è§„æ¨¡ï¼Œf(n) ä¸ºè¯­å¥å…³äº n æ‰€å å­˜å‚¨ç©ºé—´çš„å‡½æ•°</p><p><strong>æ¡ˆä¾‹ï¼šå¯¹æŒ‡å®šæ•°ç»„å…ƒç´ è¿›è¡Œåè½¬ï¼Œè¢«è¿”å›åè½¬çš„å†…å®¹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] reverse(<span class="hljs-type">int</span>[] arr)&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> arr.length;<span class="hljs-comment">//ç”³è¯· 4 ä¸ªå­—èŠ‚</span><br>        <span class="hljs-type">int</span> temp;<span class="hljs-comment">////ç”³è¯· 4 ä¸ªå­—èŠ‚</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>,end = n - <span class="hljs-number">1</span>; start &lt;= end; start++,end--)&#123;<br>            temp = arr[start];<br>            arr[start] = arr[end];<br>            arr[end] = temp;<br>        &#125;<br>        <span class="hljs-keyword">return</span> arr;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¿½ç•¥åˆ¤æ–­æ¡ä»¶å ç”¨å†…å­˜ï¼Œæˆ‘ä»¬å¾—å‡ºçš„å†…å­˜å ç”¨æƒ…å†µå¦‚ä¸‹ï¼š</p><p>ä¸ç®¡ä¼ å…¥çš„æ•°ç»„å¤§å°ä¸ºå¤šå°‘ï¼Œå§‹ç»ˆé¢å¤–ç”³è¯· 4 + 4 &#x3D; 8 ä¸ªå­—èŠ‚ï¼›</p><p>æ ¹æ®å¤§Oè¡¨ç¤ºæ³•ï¼Œè¯¥ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸º O(1)</p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è®¡ç®—ï¼Œé‡‡ç”¨å¤§ O è¡¨ç¤ºæ³•</p><p>2ã€å¤§ O è¡¨ç¤ºæ³•ä½¿ç”¨è§„åˆ™ä»‹ç»</p><p>3ã€å¸¸è§çš„å¤§ O é˜¶</p><p>4ã€Java å†…å­˜æœ€åŸºæœ¬çš„æœºåˆ¶</p><p>5ã€ç¼–å†™äº†ä¸€äº›å®é™…çš„ä¾‹å­å¹¶è®¡ç®—æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦</p><p>å¥½äº†ï¼Œæœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„å’Œç®—æ³•æ¦‚è¿°</title>
    <link href="/2022/07/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95%E6%A6%82%E8%BF%B0/"/>
    <url>/2022/07/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95%E6%A6%82%E8%BF%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€æ•°æ®ç»“æ„"><a href="#ä¸€ã€æ•°æ®ç»“æ„" class="headerlink" title="ä¸€ã€æ•°æ®ç»“æ„"></a>ä¸€ã€æ•°æ®ç»“æ„</h2><h3 id="1-1ã€ä»€ä¹ˆæ˜¯æ•°æ®ç»“æ„ï¼Ÿ"><a href="#1-1ã€ä»€ä¹ˆæ˜¯æ•°æ®ç»“æ„ï¼Ÿ" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯æ•°æ®ç»“æ„ï¼Ÿ"></a>1.1ã€ä»€ä¹ˆæ˜¯æ•°æ®ç»“æ„ï¼Ÿ</h3><p>ç®€å•ç†è§£ï¼šæ•°æ®ç»“æ„å°±æ˜¯æŠŠæ•°æ®å…ƒç´ æŒ‰ç…§ä¸€å®šçš„å…³ç³»ç»„ç»‡èµ·æ¥çš„é›†åˆï¼Œç”¨æ¥ç»„ç»‡å’Œå­˜å‚¨å…ƒç´ </p><h3 id="1-2ã€æ•°æ®ç»“æ„åˆ†ç±»ï¼Ÿ"><a href="#1-2ã€æ•°æ®ç»“æ„åˆ†ç±»ï¼Ÿ" class="headerlink" title="1.2ã€æ•°æ®ç»“æ„åˆ†ç±»ï¼Ÿ"></a>1.2ã€æ•°æ®ç»“æ„åˆ†ç±»ï¼Ÿ</h3><p>ä¼ ç»Ÿæ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°ç»„ç»“æ„åˆ†ä¸ºï¼š</p><p>1ã€é€»è¾‘ç»“æ„</p><p>2ã€ç‰©ç†ç»“æ„</p><p>ä¸¤å¤§ç±»ã€‚</p><h4 id="1-2-1ã€é€»è¾‘ç»“æ„"><a href="#1-2-1ã€é€»è¾‘ç»“æ„" class="headerlink" title="1.2.1ã€é€»è¾‘ç»“æ„"></a>1.2.1ã€é€»è¾‘ç»“æ„</h4><p>é€»è¾‘ç»“æ„æ˜¯ä»å…·ä½“é—®é¢˜ä¸­æŠ½è±¡å‡ºæ¥çš„æ¨¡å‹ï¼Œæ˜¯æŠ½è±¡æ„ä¹‰ä¸Šçš„ç»“æ„ï¼ŒæŒ‰ç…§å¯¹è±¡ä¸­æ•°æ®å…ƒç´ ä¹‹é—´çš„ç›¸äº’å…³ç³»åˆ†ç±»ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åé¢è¯¾é¢˜ä¸­éœ€è¦å…³æ³¨å’Œè®¨è®ºçš„é—®é¢˜</p><p>é€»è¾‘ç»“æ„ä¸»è¦åˆ†ä¸º 4 ç±»ï¼š</p><p>1ã€é›†åˆç»“æ„</p><p>2ã€çº¿æ€§ç»“æ„</p><p>3ã€æ ‘å½¢ç»“æ„</p><p>4ã€å›¾å½¢ç»“æ„</p><h5 id="1-2-1-1ã€é›†åˆç»“æ„"><a href="#1-2-1-1ã€é›†åˆç»“æ„" class="headerlink" title="1.2.1.1ã€é›†åˆç»“æ„"></a>1.2.1.1ã€é›†åˆç»“æ„</h5><p>1ï¼‰ã€é›†åˆç»“æ„ä¸­æ•°æ®å…ƒç´ é™¤äº†å±äºåŒä¸€ä¸ªé›†åˆå¤–ï¼Œä»–ä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•å…¶ä»–çš„å…³ç³»ï¼Œå¦‚å›¾ 1-1ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4b265f8ec5645b693b75c55a55167eb~tplv-k3u1fbpfcp-zoom-1.image" alt="img" width="50%" /><h5 id="1-2-1-2ã€çº¿æ€§ç»“æ„"><a href="#1-2-1-2ã€çº¿æ€§ç»“æ„" class="headerlink" title="1.2.1.2ã€çº¿æ€§ç»“æ„"></a>1.2.1.2ã€çº¿æ€§ç»“æ„</h5><p>1ï¼‰ã€çº¿æ€§ç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œå¦‚å›¾ 1-2ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/386218d5dc3b4112878a98b9e62d169f~tplv-k3u1fbpfcp-zoom-1.image" alt="img" width="50%" /><h5 id="1-2-1-3ã€æ ‘å½¢ç»“æ„"><a href="#1-2-1-3ã€æ ‘å½¢ç»“æ„" class="headerlink" title="1.2.1.3ã€æ ‘å½¢ç»“æ„"></a>1.2.1.3ã€æ ‘å½¢ç»“æ„</h5><p>1ï¼‰ã€æ ‘å½¢ç»“æ„ä¸­çš„æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€å¯¹å¤šçš„å±‚æ¬¡å…³ç³»ï¼Œå¦‚å›¾ 1-3ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a722a53e6bd4101acaa6422c312ec90~tplv-k3u1fbpfcp-zoom-1.image" alt="img" width="50%" /><h5 id="1-2-1-4ã€å›¾å½¢ç»“æ„"><a href="#1-2-1-4ã€å›¾å½¢ç»“æ„" class="headerlink" title="1.2.1.4ã€å›¾å½¢ç»“æ„"></a>1.2.1.4ã€å›¾å½¢ç»“æ„</h5><p>1ï¼‰ã€å›¾å½¢ç»“æ„çš„æ•°æ®å…ƒç´ æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå¦‚å›¾ 1-4ï¼š</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5837b908d40c48c28dc60e1ca1eba9bf~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221130111522689.png" width="50%" /><h4 id="1-2-2ã€ç‰©ç†ç»“æ„"><a href="#1-2-2ã€ç‰©ç†ç»“æ„" class="headerlink" title="1.2.2ã€ç‰©ç†ç»“æ„"></a>1.2.2ã€ç‰©ç†ç»“æ„</h4><p>é€»è¾‘ç»“æ„åœ¨è®¡ç®—æœºä¸­çœŸæ­£çš„è¡¨ç¤ºæ–¹å¼ç§°ä¸ºç‰©ç†ç»“æ„ï¼Œå¸¸ç”¨çš„ç‰©ç†ç»“æ„æœ‰ï¼š</p><p>1ã€é¡ºåºå­˜å‚¨ç»“æ„</p><p>2ã€é“¾å¼å­˜å‚¨ç»“æ„</p><h5 id="1-2-2-1ã€é¡ºåºå­˜å‚¨ç»“æ„"><a href="#1-2-2-1ã€é¡ºåºå­˜å‚¨ç»“æ„" class="headerlink" title="1.2.2.1ã€é¡ºåºå­˜å‚¨ç»“æ„"></a>1.2.2.1ã€é¡ºåºå­˜å‚¨ç»“æ„</h5><p>å¦‚å›¾ 1-5ï¼š</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89600981f67d46a0b712248498e32483~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221130112553076.png" width="100%" /><p>1ï¼‰ã€æŠŠæ•°æ®å…ƒç´ æ”¾åˆ°è¿ç»­çš„å­˜å‚¨å•å…ƒé‡Œé¢ï¼Œå…¶æ•°æ®é—´çš„é€»è¾‘å…³ç³»å’Œç‰©ç†å…³ç³»æ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„æ•°ç»„å°±æ˜¯é¡ºåºå­˜å‚¨ç»“æ„ã€‚</p><p>2ï¼‰ã€é¡ºåºå­˜å‚¨ç»“æ„å­˜åœ¨ä¸€å®šçš„å¼Šç«¯ï¼Œå°±åƒç”Ÿæ´»ä¸­æ’é˜Ÿæ—¶ä¹Ÿä¼šæœ‰äººæ’é˜Ÿï¼Œä¹Ÿæœ‰å¯èƒ½æœ‰äººçªç„¶ç¦»å¼€ï¼Œè¿™ä¸ªæ—¶å€™æ•´ä¸ªç»“æ„éƒ½å¤„äºå˜åŒ–ä¸­ï¼Œæ­¤æ—¶å°±éœ€è¦é“¾å¼å­˜å‚¨ç»“æ„ã€‚</p><h5 id="1-2-2-2ã€é“¾å¼å­˜å‚¨ç»“æ„"><a href="#1-2-2-2ã€é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="1.2.2.2ã€é“¾å¼å­˜å‚¨ç»“æ„"></a>1.2.2.2ã€é“¾å¼å­˜å‚¨ç»“æ„</h5><p>å¦‚å›¾ 1-6ï¼š</p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f5d9073ffd7a41dba5ba3ed9a7d5b43f~tplv-k3u1fbpfcp-watermark.image?" alt="image-20221130112723346.png" width="100%" /><p>1ï¼‰ã€æŠŠæ•°æ®å…ƒç´ æ”¾åœ¨ä»»æ„çš„å­˜å‚¨å•å…ƒé‡Œé¢ï¼Œè¿™ç»„å­˜å‚¨å•å…ƒå¯ä»¥æ˜¯è¿ç»­çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸è¿ç»­çš„ã€‚æ­¤æ—¶ï¼Œæ•°æ®å…ƒç´ ä¹‹é—´å¹¶ä¸èƒ½åæ˜ å…ƒç´ é—´çš„é€»è¾‘å…³ç³»ã€‚</p><p>2ï¼‰ã€å› æ­¤åœ¨é“¾å¼å­˜å‚¨ç»“æ„ä¸­å¼•è¿›äº†ä¸€ä¸ªæŒ‡é’ˆå­˜æ”¾æ•°æ®å…ƒç´ çš„åœ°å€ï¼Œè¿™æ ·é€šè¿‡åœ°å€å°±å¯ä»¥æ‰¾åˆ°ç›¸å…³è”æ•°æ®å…ƒç´ çš„ä½ç½®</p><h2 id="äºŒã€ç®—æ³•"><a href="#äºŒã€ç®—æ³•" class="headerlink" title="äºŒã€ç®—æ³•"></a>äºŒã€ç®—æ³•</h2><h3 id="1-1ã€ä»€ä¹ˆæ˜¯ç®—æ³•ï¼Ÿ"><a href="#1-1ã€ä»€ä¹ˆæ˜¯ç®—æ³•ï¼Ÿ" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯ç®—æ³•ï¼Ÿ"></a>1.1ã€ä»€ä¹ˆæ˜¯ç®—æ³•ï¼Ÿ</h3><p>ç®€å•ç†è§£ï¼šæ ¹æ®ä¸€å®šçš„æ¡ä»¶ï¼Œå¯¹ä¸€äº›æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°éœ€è¦çš„ç»“æœ</p><h3 id="1-2ã€ç®—æ³•åˆä½“éªŒ"><a href="#1-2ã€ç®—æ³•åˆä½“éªŒ" class="headerlink" title="1.2ã€ç®—æ³•åˆä½“éªŒ"></a>1.2ã€ç®—æ³•åˆä½“éªŒ</h3><p>ä¸€ä¸ªä¼˜ç§€çš„ç®—æ³•è¿½æ±‚ä¸¤ä¸ªç›®æ ‡ï¼š</p><p>1ã€èŠ±æœ€å°‘çš„æ—¶é—´å®Œæˆéœ€æ±‚ï¼ˆæ—¶é—´å¤æ‚åº¦æœ€å°ï¼‰</p><p>2ã€èŠ±æœ€å°çš„å†…å­˜ç©ºé—´å®Œæˆéœ€æ±‚ï¼ˆç©ºé—´å¤æ‚åº¦æœ€å°ï¼‰</p><h4 id="1-2-1ã€è®¡ç®—-1-åˆ°-100-çš„å’Œ"><a href="#1-2-1ã€è®¡ç®—-1-åˆ°-100-çš„å’Œ" class="headerlink" title="1.2.1ã€è®¡ç®— 1 åˆ° 100 çš„å’Œ"></a>1.2.1ã€è®¡ç®— 1 åˆ° 100 çš„å’Œ</h4><p><strong>è§£æ³•ä¸€ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sum</span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;<br>      sum += i;<br>    &#125;<br>    System.out.println(sum);<br>  &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€å®šä¹‰äº†ä¸¤ä¸ªæ•´å‹å˜é‡</p><p>2ã€for å¾ªç¯ 100 æ¬¡åŠ æ³•è¿ç®—</p><p>3ã€æ‰“å°ç»“æœåˆ°æ§åˆ¶å°</p><p><strong>è§£æ³•äºŒï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sum</span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>    sum = (n + <span class="hljs-number">1</span>)*n / <span class="hljs-number">2</span>;<br>    System.out.println(sum);<br>  &#125;<br>&#125;<br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>1ã€å®šä¹‰äº†ä¸¤ä¸ªæ•´å‹å˜é‡</p><p>2ã€æ‰§è¡Œä¸€æ¬¡åŠ æ³•è¿ç®—ï¼Œä¸€æ¬¡ä¹˜æ³•è¿ç®—ï¼Œä¸€æ¬¡é™¤æ³•è¿ç®—ï¼Œæ€»å…± 3 æ¬¡è¿ç®—</p><p>3ã€æ‰“å°ç»“æœåˆ°æ§åˆ¶å°</p><p><strong>è§£æ³•ä¸€å’Œè§£æ³•äºŒå¯¹æ¯”ï¼šå¾ˆæ˜æ˜¾è§£æ³•äºŒèŠ±è´¹çš„æ—¶é—´æ›´å°‘</strong></p><h4 id="1-2-2ã€è®¡ç®—-10-çš„é˜¶ä¹˜"><a href="#1-2-2ã€è®¡ç®—-10-çš„é˜¶ä¹˜" class="headerlink" title="1.2.2ã€è®¡ç®— 10 çš„é˜¶ä¹˜"></a>1.2.2ã€è®¡ç®— 10 çš„é˜¶ä¹˜</h4><p><strong>è§£æ³•ä¸€ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Factorial</span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> func1(<span class="hljs-number">10</span>);<br>    System.out.println(result);<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">func1</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span>&#123;<br>    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">1</span>)&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> n*func1(n-<span class="hljs-number">1</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">3628800</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>ä½¿ç”¨é€’å½’å®Œæˆéœ€æ±‚ï¼Œfunc1 æ–¹æ³•ä¼šæ‰§è¡Œ 10 æ¬¡ï¼Œå¹¶ä¸”ç¬¬ä¸€æ¬¡æœªæ‰§è¡Œå®Œæ¯•ï¼Œåˆä¼šè°ƒç”¨ç¬¬äºŒæ¬¡ï¼Œç¬¬äºŒæ¬¡æœªæ‰§è¡Œå®Œæ¯•ï¼Œåˆä¼šè°ƒç”¨ç¬¬ä¸‰æ¬¡â€¦æœ€ç»ˆæœ€å¤šçš„æ—¶å€™ï¼Œéœ€è¦åœ¨åŒæ—¶å¼€è¾Ÿ 10 å—å†…å­˜åˆ†åˆ«å»æ‰§è¡Œ 10 ä¸ª func1 æ–¹æ³•</p><p><strong>è§£æ³•äºŒï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Factorial</span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> func2(<span class="hljs-number">10</span>);<br>    System.out.println(result);<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">func2</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;<br>      result *= i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//æ‰“å°ç»“æœ</span><br><span class="hljs-number">3628800</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼š</p><p>ä½¿ç”¨ for å¾ªç¯å®Œæˆéœ€æ±‚ï¼Œfunc2 æ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæœ€ç»ˆï¼Œåªéœ€è¦å¼€è¾Ÿä¸€å—å†…å­˜æ‰§è¡Œ func2 æ–¹æ³•å³å¯</p><p><strong>è§£æ³•ä¸€å’Œè§£æ³•äºŒå¯¹æ¯”ï¼šå¾ˆæ˜æ˜¾è§£æ³•äºŒå ç”¨çš„å†…å­˜ç©ºé—´æ›´å°</strong></p><h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†ï¼š</p><p>1ã€æ•°æ®ç»“æ„</p><blockquote><p>æ•°æ®ç»“æ„å°±æ˜¯æŠŠå…ƒç´ æŒ‰ç…§ä¸€å®šçš„å…³ç³»ç»„ç»‡èµ·æ¥çš„é›†åˆï¼Œç”¨äºç»„ç»‡å’Œå­˜å‚¨æ•°æ®</p></blockquote><p>2ã€æ•°æ®ç»“æ„åˆ†ç±»</p><blockquote><p>1ã€é€»è¾‘ç»“æ„ï¼š</p><blockquote><p>1ã€é›†åˆç»“æ„</p><p>2ã€çº¿æ€§ç»“æ„</p><p>3ã€æ ‘å½¢ç»“æ„</p><p>4ã€å›¾å½¢ç»“æ„</p></blockquote><p>2ã€ç‰©ç†ç»“æ„</p><blockquote><p>1ã€é¡ºåºå­˜å‚¨ç»“æ„</p><p>2ã€é“¾å¼å­˜å‚¨ç»“æ„</p></blockquote></blockquote><p>3ã€ç®—æ³•</p><blockquote><p>æ ¹æ®ä¸€å®šçš„æ¡ä»¶ï¼Œå¯¹ä¸€äº›æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°éœ€è¦çš„ç»“æœ</p></blockquote><p>4ã€ä¸¾äº†ç®—æ³•çš„ä¸¤ä¸ªä¾‹å­</p><blockquote><p>1ã€è®¡ç®— 1 åˆ° 100 çš„å’Œï¼Œå¯¹æ¯”æ—¶é—´å¤æ‚åº¦</p><p>2ã€è®¡ç®— 10 çš„é˜¶ä¹˜ï¼Œå¯¹æ¯”ç©ºé—´å¤æ‚åº¦</p></blockquote><p>æœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ğŸ¤</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹´åº¦å›é¡¾ï¼šä¸ºè¿‡å»çš„å‡ å¹´å–å½©</title>
    <link href="/2021/12/30/2021final/"/>
    <url>/2021/12/30/2021final/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3de6ebafe6d4655b5e1ace56fe2e387~tplv-k3u1fbpfcp-watermark.image"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆé«˜å…´é‡è§ä½ ~</p><p>é©¬ä¸Šå…ƒæ—¦äº†ï¼Œè¿™ä¸€å¹´åˆè¦è¿‡å»äº†ï¼Œæ—¶é—´è¿‡å¾—å¥½å¿«å•Šã€‚å‡ºæ¥å·¥ä½œå‡ å¹´äº†ï¼Œå›å¿†è¿‡å»çš„å‡ å¹´æ€ä¹ˆæ€ä¹ˆæ ·ï¼Ÿçªç„¶æƒ³èµ·æ¥ï¼Œè¯¥å†™ç‚¹ä»€ä¹ˆæ¥å›å¿†ä¸€ä¸‹è¿‡å»ï¼Œä¸ºè¿‡å»è¿™å‡ å¹´é¼“ä¸ªæŒã€‚</p><p>è¿‡å»çš„è¿™å‡ å¹´ï¼Œæœ‰è¿‡å¾ˆå¤šçš„æ¬¢ä¹ï¼Œå¾ˆå¤šéš¾ä»¥å¿˜æ€€çš„æ—¶åˆ»ï¼Œä¹Ÿå‘ç”Ÿäº†å¾ˆå¤šäººç”Ÿçš„å¤§äº‹ä»¶ï¼Œä»¤äººæ¬£å–œä»¤äººå¿§ï¼Œå½“ç„¶è¿™å‡ å¹´æˆ‘ä¹Ÿåœ¨æ¥å—å„ç§æŒ‘æˆ˜ï¼Œæ‘¸çˆ¬æ»šæ‰“ï¼Œä¸€è·¯èµ°æ¥ä¸å®¹æ˜“ã€‚</p><h2 id="ä¸€ã€ä¸€äº›é—æ†¾çš„æ—¶åˆ»"><a href="#ä¸€ã€ä¸€äº›é—æ†¾çš„æ—¶åˆ»" class="headerlink" title="ä¸€ã€ä¸€äº›é—æ†¾çš„æ—¶åˆ»"></a>ä¸€ã€ä¸€äº›é—æ†¾çš„æ—¶åˆ»</h2><p>1ã€æƒ³å­˜æ¬¾100Wï¼Œå‘ç°å·®äº†98Wï¼Œè™½ç„¶è¿™æ˜¯å¥ç©ç¬‘è¯ï¼Œä½†æ˜¯ä»ä¸€ä¸ªäººçš„å¼€æ”¯åˆ°ä¸€å®¶äººçš„å¼€æ”¯ï¼Œè¿™ä¸ªè½¬å˜å¸¦æ¥çš„ç»“æœå°±æ˜¯é’±åŒ…ç¡®å®ç˜ªäº†ï¼Œå“ˆå“ˆå“ˆå“ˆï¼Œæ‰€ä»¥æˆ‘çš„98ä¸‡ä½ å»äº†å“ªğŸ˜‚</p><p>2ã€å‡è‚¥è¾“çš„ä¸€è´¥æ¶‚åœ°ï¼Œå¥¶èŒ¶çƒ§çƒ¤é…ç«é”…ï¼Œä»–å®åœ¨å¤ªé¦™äº†å¥½å—ï¼Ÿä»Šå¹´å·¥ä½œæ»¡æ»¡å½“å½“ï¼Œä¸‹ç­æ™šäº†é¥¿äº†å¥–åŠ±è‡ªå·±ä¸€é¡¿å®µå¤œï¼Œå‘¨æœ«æ”¹å–„æ”¹å–„ç”Ÿæ´»åˆæ˜¯ä¸€é¡¿ï¼Œæœ‹å‹èšé¤é‚£ä¸ªç¾å‘³ä¸èƒ½é”™è¿‡å§ã€‚ç°åœ¨å›å¤´çœ‹çœ‹æˆ‘ä»¥å‰çš„ç…§ç‰‡ï¼Œä¸å ªå›é¦–å•Šï¼Œå²æœˆè¿™æŠŠæ€çŒªåˆ€ï¼Œå¯¹æˆ‘æ¯«ä¸ç•™æƒ…ã€‚</p><p>æ‰€æœ‰ç•™åœ¨å¿ƒé‡Œçš„é—æ†¾ï¼Œéƒ½åœ¨äºæ²¡æœ‰åšæŒè€Œå·²ï¼Œæˆ‘éº»äº†ã€‚ä»è¿™ç§é—æ†¾é‡Œå›æ¥ï¼Œæˆ‘æ¥å›å¿†å›å¿†è¿™å‡ å¹´æˆ‘çš„ä¸€äº›éš¾å¿˜çš„äº‹æƒ…å§ã€‚</p><h2 id="äºŒã€é‚£ä¸€å¹´è€å¸æœºç»ˆäºæœ‰è½¦äº†"><a href="#äºŒã€é‚£ä¸€å¹´è€å¸æœºç»ˆäºæœ‰è½¦äº†" class="headerlink" title="äºŒã€é‚£ä¸€å¹´è€å¸æœºç»ˆäºæœ‰è½¦äº†"></a>äºŒã€é‚£ä¸€å¹´è€å¸æœºç»ˆäºæœ‰è½¦äº†</h2><p>å’Œå¾ˆå¤šæ¥å¤§åŸå¸‚æ‰“æ‹¼çš„äººä¸ä¸€æ ·ï¼Œæˆ‘å¹¶æ²¡æœ‰é‚£ä¹ˆç†æ™ºã€‚è™½ç„¶å¤§é“ç†å‘Šè¯‰æˆ‘ï¼Œå…ˆä¹°æˆ¿åä¹°è½¦ï¼Œåœ¨å¤§åŸå¸‚è½¦å¸¦æ¥çš„é™„å¸¦å¼€é”€çœŸçš„å¾ˆå¤§ï¼Œè€Œä¸”å¤§åŸå¸‚çš„äº¤é€šå¾ˆä¾¿åˆ©ï¼Œç”¨ä¸ä¸Šè½¦çš„ã€‚æˆ‘è¿˜æ˜¯æ¯…ç„¶å†³ç„¶ä¹°äº†è½¦ï¼Œè¿™ç¡®å®æ˜¯æˆ‘çš„å›ºæ‰§æ‰€åœ¨ã€‚</p><p>æˆ‘å–œæ¬¢è½¦ï¼Œæºäºå®¶é‡Œæœ‰ä¸ªé€è´§çš„è½¦ï¼Œå¹³æ—¶æœ‰äº‹æ²¡äº‹è·Ÿç€å¤§äººåé¢æ‘¸ä¸¤æŠŠï¼Œçœ‹ç€å¤§äººæ‰“æ–¹å‘ç›˜çš„é‚£ä¸ªæºœï¼Œåœ¨æˆ‘çœ¼é‡Œé‚£æ˜¯ä¸–ç•Œä¸Šæœ€é…·çš„äº‹æƒ…äº†å§ã€‚å› æ­¤æˆ‘å°±ä¸€ç›´æ¢¦æƒ³æœ‰ä¸€è¾†å±äºè‡ªå·±çš„è½¦ï¼Œå¯¹å¼€è½¦æœ‰ä¸€ç§å¼ºçƒˆçš„æ¬²æœ›ã€‚æ‰€ä»¥æˆ‘æ‰“å·¥ä»¥æ¥æœ€æƒ³åšçš„ç¬¬ä¸€ä»¶å¤§äº‹å°±æ˜¯ä¹°è½¦ã€‚äºæ˜¯ç»è¿‡è‡ªå·±çš„æ‘¸çˆ¬æ»šæ‰“ï¼Œç»ˆäºå‡‘é½äº†é¦–ä»˜ï¼Œè´·æ¬¾ä¹°äº†ä¸€è¾†ä»£æ­¥è½¦ï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df6119ec86c64d14ba4e501a9f5fb650~tplv-k3u1fbpfcp-watermark.image" alt="202112311224295.png"></p><p>ä¹°äº†æ–°è½¦ä»¥åï¼Œç¡®å®ç»™æˆ‘å¸¦æ¥äº†ä¸€äº›çƒ¦æ¼ï¼Œè¿åœï¼Œæ‰¾è½¦ä½ï¼Œåœåœ¨åŸä¸­æ‘è¢«äººåˆ’äº†æ¼†ï¼Œä»¥åŠè¿˜å®Œè½¦è´·å°±ç©ºç©ºçš„å£è¢‹ã€‚ä½†æ˜¯å¼€å¿ƒå¤§è¿‡äºçƒ¦æ¼å§ï¼Œæˆ‘å–œæ¬¢æœ‰è½¦çš„æ„Ÿè§‰ï¼Œå–œæ¬¢å®ƒçš„é™ªä¼´ï¼Œä¹Ÿè®¸å¤§å¤šæ•°ç”·å­©å­éƒ½ä¼šæœ‰æˆ‘è¿™ç§æƒ³æ³•å§ã€‚</p><p>å¹³æ—¶å‘¨æœ«ï¼Œå¼€ç€è½¦ï¼Œå¸¦ç€æˆ‘çš„ä¸‰äº”å¥½å‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4b5c4ebc88a4c06a2d3fffd64e965e7~tplv-k3u1fbpfcp-watermark.image" alt="202112311234697.jpeg"></p><p>ä¸€èµ·å»å—å±±æ‘˜è”æï¼Œä¸€èµ·å»ä¸œæºªæ¶Œç©¿è¶Šï¼Œä¸€èµ·å»æ¸…è¿œæ¼‚æµï¼Œä¸€èµ·å»çˆ¬æ¢§æ¡å±±ï¼Œä¸€èµ·å˜²ç¬‘è·¯ä¸Šçš„å‚»é€¼å¸æœºå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œé‚£æ—¶å€™å¾ˆæ¬¢ä¹ï¼Œæ—¥å­è¿‡å¾—å¾ˆå¿«ã€‚</p><h2 id="ä¸‰ã€é‚£ä¸€å¹´æˆ‘è°ˆäº†å¥³æœ‹å‹"><a href="#ä¸‰ã€é‚£ä¸€å¹´æˆ‘è°ˆäº†å¥³æœ‹å‹" class="headerlink" title="ä¸‰ã€é‚£ä¸€å¹´æˆ‘è°ˆäº†å¥³æœ‹å‹"></a>ä¸‰ã€é‚£ä¸€å¹´æˆ‘è°ˆäº†å¥³æœ‹å‹</h2><p>æ‰€æœ‰çš„ç›¸é‡ï¼Œéƒ½æ˜¯ä¸å¯å¤åˆ¶çš„ç¼˜åˆ†å§ï¼Œæˆ‘ä»¬ä¹Ÿä¸€æ ·ã€‚æˆ‘ä»¬çš„ç›¸é‡è®©æˆ‘ç›¸ä¿¡äº†ç¼˜åˆ†è¿™å›äº‹ã€‚æˆ‘ä»¬å·®ä¸å¤šåŒæ—¶æœŸå…¥èŒæ–°å…¬å¸ï¼Œæˆ‘å…ˆå…¥èŒï¼Œå¥¹åœ¨æˆ‘åé¢æ‰è¿›æ¥å…¬å¸ã€‚å‡†ç¡®æ¥è¯´åœ¨å¥¹æ¥ä¹‹å‰ï¼Œæˆ‘å¬è¯´è¿‡å¥¹ï¼ŒåŠå…¬å®¤çš„äººæœ‰åœ¨è®¨è®ºï¼Œå…¬å¸æŒ–æ¥äº†ä¸€ä¸ªå¾ˆä¼˜ç§€çš„å¥³ç”Ÿï¼Œæ‰€ä»¥ä»ä¸€å¼€å§‹æœŸå¾…å€¼å°±æ‹‰æ»¡ã€‚</p><p>ç»ˆäºæ¥ä¸Šç­äº†ï¼Œæˆ‘ä»¬éš”å¾—è¿˜æŒºè¿œçš„ï¼Œä½†æ˜¯å‡ºä¹æ„æ–™çš„å¥¹æ¥äº†ç¬¬äºŒå¤©å°±æ¢åŠå…¬å®¤äº†ï¼Œäºæ˜¯æˆ‘ä»¬ç¦»å¾—åˆå¾ˆè¿‘äº†ã€‚é‚£æ—¶å€™æˆ‘è´Ÿè´£ç‚¹æˆ‘ä»¬ç»„çš„ç¦åˆ©æ™šé¤ã€‚æ°å¥½ï¼Œå¥¹è¿™ä¸ªäººå¾ˆå¥‡æ€ªï¼Œæ¯æ¬¡éƒ½ä¸ç‚¹ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½åŠ ç­å¾ˆæ™šï¼ŒåŸæ¥æ˜¯ä¸ªä½œæ¯å¾ˆä¸è§„å¾‹çš„å¥³å­©å­ã€‚åæ¥æˆ‘å°±ä¸»åŠ¨é—®ä»–ä¸ºå•¥ä¸ç‚¹é¤ï¼Œå¥¹è¯´äº†å•¥æˆ‘å¿˜äº†ï¼Œä½†æ˜¯æˆ‘çŸ¥é“ä»–å’Œæˆ‘æ˜¯è€ä¹¡ï¼Œä»–å“¥å“¥è¿˜å’Œæˆ‘æ˜¯ä¸€ä¸ªå­¦æ ¡çš„ï¼Œåˆ«é—®æˆ‘æ€ä¹ˆåšåˆ°çš„ï¼Œæˆ‘å°±æ˜¯é—®åˆ°äº†ã€‚åé¢é€šè¿‡å¥¹ç©çš„å¥½çš„åŒäº‹ï¼ŒåŠ ä¸Šäº†å¥¹çš„å¾®ä¿¡ã€‚å†ç„¶åæœ‰ä¸€ä½æˆ‘ä»¬å…±åŒçš„åŒäº‹å…¼å¥½å‹ç¦»èŒäº†ï¼Œæˆ‘å“¥ä»¬åŒæ—¶çº¦äº†æˆ‘å’Œå¥¹ï¼Œä¸€æ¥äºŒå»ï¼Œæˆ‘çœ‹æœºä¼šæ¥äº†å•ŠğŸ˜„ã€‚</p><p>é‚£æ®µæ—¶é—´å…¬å¸é™„è¿‘æœ‰ä¸€æ®µè·¯åœ¨ä¿®å»ºï¼Œå¥¹ä¸‹ç­æ¯”è¾ƒæ™šï¼Œæˆ‘éª‘ç€å•è½¦ç»•äº†ä¸€åœˆï¼Œè¿œè¿œåœ°è§‚å¯Ÿç€ï¼Œæƒ³ç€å¦‚æœæœ‰å•¥å±é™©è¿˜å¯ä»¥è‹±é›„æ•‘ç¾ğŸ˜‚ã€‚å¥¹è¿˜ä¼šä¸‹ç­åå’Œå¥¹å¦ˆå¦ˆé€šç”µè¯ï¼Œå‘ç°å¥¹ä¸ä»…å·¥ä½œè®¤çœŸè´Ÿè´£ï¼Œå¯¹å®¶äººä¹Ÿå¾ˆå¥½ã€‚</p><p>å¥¹ä½çš„é‚£è¾¹æœ‰å¾ˆå¤šå¥½åƒçš„ç¾é£Ÿï¼Œåæ¥å°±å’Œå¥¹çº¦ä¸‹ç­ä¸€èµ·å»åƒæ™šé¤ã€‚ç„¶åæ—©ä¸Šä¸Šç­æˆ‘ä¿©å·®ä¸å¤šéƒ½è¸©ç‚¹æ‰“å¡ï¼Œæˆ‘å‘ç°å¥¹ä¹Ÿæ²¡å¸¦æ—©é¤å•¥çš„ï¼Œäºæ˜¯åé¢å°±å¾ˆé«˜è°ƒçš„ä¹°äº†ä¸¤ä»½æ—©é¤ï¼Œè¶ç€åŒäº‹ä»¬æ³¨æ„çš„æ—¶å€™ï¼Œæ”¾å¥¹æ¡Œä¸Šï¼Œç„¶åçœ‹åŒäº‹ä»¬èµ·å“„ï¼Œæˆ‘å¾ˆå¼€å¿ƒå•Šã€‚ä¹Ÿå¾ˆå¼€å¿ƒå¥¹åæ¥æŠŠæˆ‘çš„æ—©é¤è¿˜æ˜¯åƒå®Œäº†çš„ã€‚æˆ‘çš„åšæŒæ²¡æœ‰ç™½è´¹ï¼Œçœ‹åˆ°å¥¹æ¯å¤©åƒæ—©é¤æ™šé¤ï¼Œç”Ÿæ´»è§„å¾‹æˆ‘ä¹Ÿå¾ˆå¼€å¿ƒã€‚</p><p>ä½†æ˜¯è¯´å®è¯æˆ‘è¿˜æ˜¯æ²¡æœ‰å‹‡æ°”è¡¨ç™½ï¼Œçœ‹ç€å¥¹æ¯å‘¨æœ«å¥½åƒéƒ½æœ‰æœ‹å‹çº¦å‡ºå»ç©ï¼Œæˆ‘æ‹…å¿ƒè¢«åˆ«äººæ·è¶³å…ˆç™»ã€‚åœ¨å¥¹å»ä¿åˆ©å‰§é™¢çœ‹è°¢æ˜¥èŠ±æ¼”å”±ä¼šçš„æ—¶å€™ï¼Œå› ä¸ºå¥¹æå‰å…³æœºäº†ï¼Œè”ç³»ä¸åˆ°ï¼Œé‚£å¤©è¿˜ä¸‹ç€é›¨ï¼Œæˆ‘åœ¨å‰§é™¢å¤–é¢ç­‰äº†2ä¸ªå¤šå°æ—¶ã€‚æœ€åæ‹®æ®çš„æˆ‘è¯·å¥¹åƒäº†ä¸€é¡¿æ±‰å ¡ã€‚æœ‹å‹é—®æˆ‘è¿›å±•çš„æ—¶å€™ï¼Œæˆ‘è¯´è¯·åƒæ±‰å ¡ï¼Œç©¿ç€æ‹–é‹ï¼Œåœ¨é›¨é‡Œç­‰äº†2å°æ—¶ï¼Œæœ‹å‹éƒ½è§‰å¾—æˆ‘è¦å‡‰å‡‰ã€‚å“ï¼Œå¿ƒæƒ³ç®¡ä»–å‘¢ï¼Œç¬¬äºŒå¤©çœ‹åˆ°å¥¹è¿˜æ˜¯åƒäº†æˆ‘é€çš„æ—©é¤ï¼Œæˆ‘å¾ˆå¼€å¿ƒå•Šï¼Œå¿ƒé‡Œæƒ³ç€ï¼šå—¯ï¼Œè¿˜æœ‰å¸Œæœ›ã€‚</p><p>æ¥ä¸‹æ¥åˆ°ä¸ƒå¤•äº†ï¼Œé‡ç‚¹ç­¹å¤‡æˆ‘çš„è¡¨ç™½ç°åœºå•¦ã€‚æœ€åå½“ç„¶æ˜¯è¡¨ç™½æˆåŠŸäº†ã€‚äº‹åæˆ‘é—®å¥¹æœ€åœ¨æ„æˆ‘çš„ä»€ä¹ˆï¼Ÿ å¥¹è¯´æˆ‘å¾ˆçœŸå®ï¼Œæˆ‘å‘ˆç°çš„çŠ¶æ€å¾ˆé˜³å…‰ï¼Œçˆ±ç¬‘ï¼Œç§¯æä¹è§‚ã€‚ä»ä¸å¥¹æ‹çˆ±å¼€å§‹ï¼Œæˆ‘å°±è®¤å®šï¼Œå¦‚æœæ²¡æœ‰åŸåˆ™æ€§çš„é—®é¢˜ï¼Œæˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥é•¿é•¿ä¹…ä¹…ã€‚é‚£æ®µæ—¶é—´æ¯å¤©éƒ½ç‰¹åˆ«æ¬£å–œï¼Œæ—¥å­è¿‡å¾—é£å¿«ï¼Œæˆ‘ä»¬éƒ½å¾ˆçæƒœå½¼æ­¤åœ¨ä¸€èµ·çš„æ—¶å…‰ã€‚</p><h2 id="å››ã€æˆ‘ä»¬ç»“å©šäº†"><a href="#å››ã€æˆ‘ä»¬ç»“å©šäº†" class="headerlink" title="å››ã€æˆ‘ä»¬ç»“å©šäº†"></a>å››ã€æˆ‘ä»¬ç»“å©šäº†</h2><p>å¥½åƒå‰é¢ä¸€éƒ¨åˆ†è®²çš„æœ‰ç‚¹é•¿ï¼Œä½†ä»ç„¶æ„çŠ¹æœªå°½ã€‚æˆ‘ä»¬æ‹çˆ±çš„æ—¶é—´æ²¡æœ‰10å¹´ï¼Œæ²¡æœ‰5å¹´ï¼Œä¹Ÿæ²¡æœ‰3å¹´ã€‚æ‹çˆ±1å¹´åŠï¼Œæˆ‘ä»¬å°±è§äº†å®¶é•¿ï¼Œå®¶é•¿å¯¹æˆ‘ä»¬çš„æœŸè®¸å¾ˆé«˜ï¼Œä¹Ÿç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„ç²¾ç¥å’Œç‰©è´¨æ”¯æŒã€‚å¸¦ç€å®¶äººäº²å‹çš„ç¥ç¦ï¼Œæˆ‘ä»¬é¢†è¯äº†ã€‚</p><p>ä¸æ‡‚å¾—ç»“å©šç™»è®°ç…§å¯ä»¥ç©é‚£ä¹ˆå¤šèŠ±æ ·ï¼Œæˆ‘åªè®°å¾—å’”åš“å‡ ç§’ï¼Œ60å¤§æ´‹æ²¡äº†ï¼Œæ²¡ç»™æˆ‘ä»¬Pä¸€ä¸ä¸€æ¯«ï¼Œè™½ç„¶å¾ˆçº¯å¤©ç„¶æ— å…¬å®³ï¼Œä½†è¿˜æ˜¯æ©ç›–ä¸ä½æˆ‘ä»¬çš„å¹¸ç¦è‚¥ã€‚ç°åœ¨å›çœ‹è¿‡å»çš„é‚£äº›ç…§ç‰‡ï¼Œç›¸æ¯”è¾ƒä¿®é¥°è¿‡çš„ç»“å©šç…§ï¼Œå¥½åƒè¿™å¼ ç»“å©šç™»è®°ç…§ç¡®å®å¾ˆå€¼å¾—å›å‘³ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05791db441e54f91a038d6553f0ba590~tplv-k3u1fbpfcp-watermark.image" alt="202112311235960 (1).jpeg"></p><p>ä»¥ä¸ºé©¬ä¸Šå°±å¯ä»¥æŠŠå©šç¤¼æä¸Šæ—¥ç¨‹ï¼Œä½†è¿˜æ˜¯ç”±äºç–«æƒ…åŸå› ï¼Œæˆ‘ä»¬å»¶ç¼“äº†ä¸€å¹´æ‰ä¸¾åŠå©šç¤¼ã€‚å©šç¤¼ä¸Šï¼Œå¥¹çˆ¸ç‰µç€å¥¹çš„æ‰‹ç¼“ç¼“å‘æˆ‘èµ°æ¥ï¼Œé¡¿æ—¶çƒ­æ³ªç›ˆçœ¶ã€‚å¥¹çˆ¸æŠŠæˆ‘ä»¬æ‰‹æ”¾åœ¨ä¸€èµ·ï¼Œäº¤ä»£æˆ‘è¦å¯¹ä»–å¥³å„¿å¥½ï¼Œä¸¤ä¸ªäººç›¸äº’ç…§é¡¾çš„æ—¶å€™ï¼Œæˆ‘ä¸å…å¸¦å…¥äº†ä¸ªäººæƒ…ç»ªï¼Œæƒ³åˆ°ä»¥åçš„å“ªä¸€å¤©ï¼Œæˆ‘å¦¹å¦¹ä¹Ÿä¼šç»å†åŒæ ·çš„åœºæ™¯ï¼Œé‚£ç§ä¸èˆæˆ‘å¾ˆèƒ½ä½“ä¼šã€‚</p><p>å©šç¤¼ä¸Šæˆ‘å¾ˆè£å¹¸é‚€è¯·åˆ°äº†æˆ‘çš„é«˜ä¸­ç­ä¸»ä»»å’ŒåŒå­¦ä»¬ï¼Œé‚€è¯·åˆ°äº†æˆ‘çš„å¥½å“¥ä»¬ï¼Œä½†åŒæ—¶æˆ‘å¿ƒé‡Œè¿˜æ˜¯æ€€æœ‰æ­‰æ„çš„ï¼Œæˆ‘æ€ æ…¢äº†å…„å¼Ÿä»¬å’Œæˆ‘çš„è€å¸ˆã€‚å› ä¸ºè€å®¶åŠå©šç¤¼ï¼Œè®²ç©¶çš„ç¤¼æ•°å’Œç¤¼ä»ªæ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å¿™ç¢Œç€ï¼Œæ²¡æœ‰ç…§é¡¾åˆ°ä½ï¼Œæˆ‘çš„é”™ã€‚æ­£å¦‚å¤§å®¶çš„ç¥ç¦ä¸€æ ·ï¼Œæˆ‘ä»¬ç»“å©šè¿‡ç¨‹ä¸­å¾ˆéš¾å¿˜ï¼Œå¾ˆå¼€å¿ƒã€‚</p><p>ç°åœ¨å†æƒ³æƒ³ï¼Œæˆ‘ä»¬èƒ†å­è¿˜æ˜¯æŒºå¤§çš„ï¼Œå…¨ç¨‹è¿œç¨‹æŒ‡æŒ¥ï¼Œæ²¡æœ‰å»å®åœ°è€ƒå¯Ÿï¼Œæˆ‘ä»¬éƒ½æ˜¯è‡ªå·±åœ¨ç½‘ä¸Šè”ç³»æ²Ÿé€šï¼Œè”ç³»é…’åº—é¤å…ï¼Œè”ç³»å©šåº†ç¤¼æœã€‚èµ¶åœ¨å›½åº†èŠ‚å‡‘ä¸ªçƒ­é—¹ï¼Œä¹Ÿæ˜¯å¸Œæœ›å¤§å®¶èƒ½å°½é‡æ¥åšæˆ‘ä»¬çš„è§è¯ã€‚ç†æƒ³å¾ˆä¸°æ»¡ï¼Œä½†ç°å®è¿˜æ˜¯æŒºéª¨æ„Ÿçš„ï¼Œè¿™ä¸ªæ—¶æœŸå·¨å¿™ï¼Œå·¨ä¹±ï¼Œä¸”å·¨æ…Œå¼ ã€‚ä¸ºæˆ‘å‡ºäººå‡ºè½¦å‡ºåŠ›çš„ä¼™ä¼´ä»¬ï¼Œå¤ªæ„Ÿè°¢ä½ ä»¬ï¼Œæ„Ÿæ©ï¼æœ€åçš„ä¸€å¼ å¤§åˆç…§ç»™è¿™æ¬¡å©šç¤¼ç”»ä¸Šä¸€ä¸ªåœ†æ»¡çš„å¥å·ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/35768d00b5d9405f9b7a92cd14197a36~tplv-k3u1fbpfcp-watermark.image" alt="1E8A9316.jpg"></p><p>å›åˆ°å®¶æ‹†çº¢åŒ…è¿˜æ˜¯å¾ˆå…´å¥‹çš„ï¼Œå¤§å®¶ä»½å­é’±å‡†å¤‡çš„è®©æˆ‘æ„Ÿæ¿€æ¶•é›¶å•Šã€‚æ€»çš„æ¥è¯´ï¼Œå©šç¤¼è¿™ä¸ªä»ªå¼æ„Ÿè¿˜æ˜¯å¾ˆåˆ°ä½çš„ï¼Œå½¢å¼ä¸Šæˆ‘ä»¬ä¸æ˜¯æœ€å¥½çš„ï¼Œä½†æ„Ÿå—ä¸Šåˆ°ä½äº†ï¼Œä¸€è¾ˆå­çš„å›å¿†ï¼Œä¸€è¾ˆå­çš„éš¾å¿˜æ—¶åˆ»ã€‚æé†’å³å°†ç»“å©šçš„æœ‹å‹ä»¬ï¼ŒçœŸçš„è¦ææ—©1å¹´è®¡åˆ’ç»“å©šçš„äº‹å®œï¼Œä¸€å®šè¦å®åœ°è€ƒå¯Ÿé…’åº—å’Œé¤å…ï¼Œæ—©ç‚¹é¢„å®šé…’åº—ï¼Œä¼šå®¢å…ä¸è¦è¿‡äºç´§å‡‘ï¼Œæˆ‘ä»¬æ˜¯å‡‘åœ¨å›½åº†è¿™ä¸ªæ¡£æœŸï¼Œé¢„å®šæ™šäº†ï¼Œä¼šå®¢å…è¿‡äºç´§å‡‘äº†ï¼Œæ•ˆæœæ²¡æœ‰å±•ç¤ºçš„é‚£ä¹ˆå®Œç¾ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªå°å°çš„å¤±è¯¯å§ã€‚</p><h2 id="äº”ã€æˆ‘ä»¬ä¹°æˆ¿äº†"><a href="#äº”ã€æˆ‘ä»¬ä¹°æˆ¿äº†" class="headerlink" title="äº”ã€æˆ‘ä»¬ä¹°æˆ¿äº†"></a>äº”ã€æˆ‘ä»¬ä¹°æˆ¿äº†</h2><p>æˆ‘ä»¬ç›®æ ‡è¿˜æ˜¯æ¯”è¾ƒæ˜ç¡®çš„ï¼Œå› ä¸ºè€å®¶çš„æˆ¿å­ç©ºé—´è¿˜å¯ä»¥ï¼Œå› æ­¤æ²¡æœ‰è€ƒè™‘åœ¨è€å®¶ä¹°æˆ¿ï¼Œå†åŠ ä¸Šé•¿æœŸå—é¼»ç‚çš„è‚†è™ï¼Œå¹¿ä¸œè¿™è¾¹çš„æ°”å€™æ¯”è¾ƒåˆé€‚æˆ‘ã€‚ä½†æ˜¯å¹¿ä¸œä¸€çº¿çš„å¤§åŸå¸‚å¯¹æˆ‘ä»¬è¿™äº›æ‰“å·¥ä»”æ¥è¯´ï¼Œå¹¶ä¸æ˜¯é‚£ä¹ˆå‹å¥½ï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€çº¿çš„æˆ¿å­å°±ç®—æ‹¼æ‹¼å‡‘å‡‘å‡‘é½äº†é¦–ä»˜ï¼Œè´·æ¬¾å‹åŠ›å¤§ï¼Œä¹Ÿä¼šä¸¥é‡å½±å“åˆ°æˆ‘ä»¬çš„ç”Ÿæ´»è´¨é‡ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å‘¨è¾¹åŸå¸‚ä¹°ä¸‹äº†ä¸€ä¸ªä¸‰å±…å®¤ï¼Œæ‰“ç®—åœ¨æ¸©æš–çš„å—æ–¹å®‰å®¶äº†ï¼Œä¹ŸæŒºå¥½ã€‚</p><p>ä¹°æˆ¿çš„ä¸»æ„æ˜¯æˆ‘å…ˆå®šçš„ï¼Œæˆ‘æƒ³åœ¨æ‰“å·¥ç´¯äº†çš„æ—¶å€™ï¼Œçœ‹çœ‹å®¶äººå°±åœ¨èº«è¾¹ï¼Œè¿™æ ·å°±ä¼šåŠ¨åŠ›æ»¡æ»¡ã€‚èº«è¾¹å¾ˆå¤šçš„æœ‹å‹ä¹Ÿåœ¨é‚£è¾¹ä¹°æˆ¿å®‰å®¶ï¼Œæˆ‘æ›´åŠ æ¬£å–œäº†ï¼Œä»¥åå¯ä»¥å¸¸èµ°åŠ¨äº†ã€‚æˆ‘ä»¬å¸Œæœ›æŠŠå®¶é‡Œè€äººæ¥ä¸Šæ¥ï¼Œå‘¨æœ«å¯ä»¥å¸¦ä»–ä»¬å‡ºå»æ‰“å¡æ¸¸ç©ã€‚å› ä¸ºçœ‹åˆ°çˆ·çˆ·å¥¶å¥¶çš„å­¤å•ï¼Œæ‰ä¼šæƒ³ä»¥åæˆ‘è¦æ€ä¹ˆåšæ‰ä¼šè®©å®¶äººä»¬ä¸å­¤å•ï¼Œçˆ·çˆ·å¥¶å¥¶çš„äº‹ï¼Œæˆ‘èƒ½åšçš„åŠªåŠ›å¾ˆå°‘ï¼Œä½†æ˜¯çˆ¶æ¯è¾ˆçš„æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥äº‰å–ä¸€ä¸‹çš„ã€‚å› ä¸ºæˆ‘å’Œåª³å¦‡çš„å·¥ä½œæ€§è´¨éƒ½æ¯”è¾ƒå¿™ï¼Œæˆ‘ä»¬é€‰äº†ç²¾è£…çš„ç±»å‹ï¼Œä½†å…¶å®è¦ä½çš„èˆ’æœï¼Œåˆç†å¸ƒå±€ï¼Œå“ªé‡Œæ¯”å¾—ä¸Šè‡ªå·±è¯·äººè§„åˆ’å¸ƒå±€å•Šã€‚æœ‰æ—¶é—´æˆ–è€…å®¶é‡Œäººæ‡‚è¿™è¡Œçš„ï¼Œè‚¯å®šé€‰æ¯›å¯å¥½ï¼Œç²¾è£…çš„é¸¡è‚‹ä½ æ‡‚çš„ã€‚</p><p>ä¹°æˆ¿åæ‚”å—ï¼Ÿä¸åæ‚”ï¼Œè™½ç„¶æˆ‘ä»¬ç¡®ç¡®å®å®ä¹°åœ¨æˆ¿ä»·é«˜ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬åŸºäºè‡ªèº«çš„éœ€æ±‚ï¼Œä¸æŠ•èµ„å…¶å®æ— æ‰€è°“æˆ¿ä»·æ¶¨æˆ–è€…è·Œï¼Œèƒ½æŠŠå®¶é‡Œå¼„èˆ’å¦äº†ï¼Œå®¶äººä¹°ä¸œè¥¿ä¾¿åˆ©ï¼Œå‘¨è¾¹è®¾æ–½æœåŠ¡å®Œå–„äº†ï¼Œè¿™å°±æ˜¯è›®èˆ’å¿ƒçš„äº‹æƒ…äº†ã€‚ä¸‡å®¶ç¯ç«æœ‰ä¸ªç¯ä¸ºæˆ‘è€Œäº®ï¼Œæ˜¯å…‰ä¹Ÿæ˜¯æ¸©æš–ã€‚å¸Œæœ›å¤§å®¶ä¸ç®¡ç§Ÿæˆ¿è¿˜æ˜¯ä¹°æˆ¿ï¼Œä¸ç®¡åœ¨å“ªä¹°æˆ¿ï¼Œéƒ½èƒ½åˆå®¶æ¬¢ä¹ï¼Œå¼€å¼€å¿ƒå¿ƒçš„ã€‚</p><h2 id="å…­ã€2021ç°åœ¨çš„æˆ‘"><a href="#å…­ã€2021ç°åœ¨çš„æˆ‘" class="headerlink" title="å…­ã€2021ç°åœ¨çš„æˆ‘"></a>å…­ã€2021ç°åœ¨çš„æˆ‘</h2><p>2021 æ˜¯æˆ‘äººç”Ÿä¸­æœ€æœ€éš¾å¿˜çš„ä¸€å¹´ï¼Œæˆ‘æ€è€ƒäº†å¾ˆå¤šï¼Œå½“ç„¶å…ä¸äº†ç‰ºç‰²äº†å‡ æ’®å¤´å‘ã€‚æˆ‘çœŸçœŸåˆ‡åˆ‡åœ°æ„Ÿå—åˆ°è‡ªå·±èº«ä»½è§’è‰²è¢«èµ‹äºˆçš„æ„ä¹‰ã€‚</p><p>å¯¹çˆ¶æ¯è€Œè¨€ï¼Œæˆ‘æ˜¯ä»–çš„å„¿å­ï¼Œä½œä¸ºå„¿å­ï¼Œæˆ‘æœ€æ‹…å¿ƒçš„æ˜¯å¥¹çš„èº«ä½“çŠ¶å†µï¼Œè™½ç„¶æœ‰ä¿æŒæ¯å‘¨çš„è”ç³»ï¼Œä½†æˆ‘çœŸçš„ä¸èƒ½ç¡®ä¿ä»–ä»¬å’Œæˆ‘è¯´çš„å¥½çš„ï¼Œåˆ«æ‹…å¿ƒâ€¦æ˜¯ä¸æ˜¯çœŸçš„ã€‚æˆ‘å¸Œæœ›æˆ‘ä»¬å›å®¶äº†èƒ½å¤šé™ªé™ªä»–ä»¬ï¼Œå¸¦ä»–ä»¬å®šæœŸåšä½“æ£€ã€‚</p><p>å¯¹åª³å¦‡è€Œè¨€ï¼Œæ¯”èµ·ä¹‹å‰ï¼Œæˆ‘æ›´èƒ½ç†è§£å¥¹ä¸ºæˆ‘ä»˜å‡ºçš„è‰°è¾›ã€‚æˆ‘ä¼šåœ¨å¥¹è¾›è‹¦çš„æ—¶å€™ï¼Œåšä¸€åˆ‡å¥¹ä¸ºæˆ‘åšçš„äº‹æƒ…ã€‚æˆ‘å¸Œæœ›æˆ‘èƒ½æœ€æ‡‚å¥¹çš„æŸ”å¼±ï¼Œç…§é¡¾å¥¹ï¼Œä¿æŠ¤å¥¹ã€‚</p><p>å¯¹å­©å­è€Œè¨€ï¼Œæˆ‘åšçš„æ˜¯æœ€ä¸åˆ°ä½çš„ï¼Œæ¯”èµ·å­©å­å¦ˆå¦ˆï¼Œæˆ‘çš„æ¬ ç¼ºå®åœ¨å¤ªå¤šã€‚æ¯”èµ·ç…§é¡¾å­©å­çš„è€äººå®¶ï¼Œæˆ‘äºæ¬ çš„å¤ªå¤šå¤ªå¤šã€‚ä½†æ˜¯æœ€è®©æˆ‘åŠ¨å®¹çš„æ˜¯å­©å­çš„ç¬‘ï¼Œçˆ¸çˆ¸æ²¡æœ‰æ—¶æ—¶åˆ»åˆ»å‡ºç°åœ¨ä»–ç”Ÿæ´»é‡Œï¼Œä½†æ˜¯åªè¦çœ‹åˆ°çˆ¸çˆ¸å¦ˆå¦ˆï¼Œä»–éƒ½å¾ˆå¼€å¿ƒï¼Œç¬‘çš„å¾ˆç”œå¾ˆç”œï¼Œæœ‰æ·±æ·±çš„é…’çªï¼Œå¾ˆæ²»æ„ˆï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0efb9f1442444f198834b88d2b15b1c0~tplv-k3u1fbpfcp-watermark.image" alt="202112311239118.jpeg"></p><p>å…»ä¸æ•™ï¼Œçˆ¶ä¹‹è¿‡ï¼ç­‰æ˜å¹´éº»çƒ¦çš„äº‹éƒ½å®‰ç½®å¦¥å½“äº†ï¼Œå°±æ¥ä»–åˆ°èº«è¾¹æ¥ï¼Œçˆ¸çˆ¸åœ¨å­©å­æˆé•¿ä¸­çš„è§’è‰²è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚å¸Œæœ›ä»–å¼€å¿ƒå¿«ä¹æˆé•¿ã€‚</p><p>ç°åœ¨è‡ªå·±èº«ä¸Šæ›´å¤šçš„æ˜¯ä¸€ç§è´£ä»»æ„Ÿï¼Œæ¯å¤©éƒ½åœ¨æƒ³ç€å¦‚ä½•æé’±ï¼Œæå‡å®¶äººçš„ç”Ÿæ´»å“è´¨å’Œå¹¸ç¦æ„Ÿï¼Œè®©ä»–ä»¬ç”Ÿæ´»æ— å¿§æ— è™‘ã€‚å¯¹äºå·¥ä½œè€Œè¨€ï¼Œ è¿™ä¸€å¹´æˆ‘é…å¾—ä¸Šæ‰“å·¥äººçš„ç§°å·ï¼Œå®å®åœ¨åœ¨æ‰“å·¥äººã€‚å¯¹äºæˆ‘ä»¬å¼€å‘äººå‘˜æ¥è¯´ï¼Œè¦æƒ³ææ›´å¤šçš„é’±ï¼Œå°±å¾—åŠªåŠ›æå‡è‡ªå·±çš„æŠ€æœ¯ã€‚åªè¦ä½ æŠ€æœ¯å¤Ÿç¡¬ï¼Œå°±ä¸æ€•æä¸åˆ°é’±ã€‚å› æ­¤è¿™ä¸€å¹´ï¼Œæˆ‘çš„é‡å¿ƒå°±æ˜¯ä¸“æ³¨æŠ€æœ¯æå‡ã€‚</p><p>åœ¨è¿™ä¸€å¹´é‡Œ</p><p>1ã€æˆ‘å‚ä¸äº†æŠ€æœ¯æ–‡ç« åˆ›ä½œï¼Œä»ä¸€ä¸ªæ—è§‚è€…ï¼Œå˜æˆäº†å®è·µè€…ï¼š</p><blockquote><p>æˆ‘åœ¨æ˜é‡‘åˆ›ä½œäº† 20 ç¯‡åŸåˆ›æ–‡ç« ï¼Œè·å¾—äº† 1839 ä¸ªèµï¼Œæ”¶è·äº† 719 ä¸ªæ”¶è—ï¼Œå¸®åŠ©äº† 5.4 w ä¸ªå¼€å‘è€…</p></blockquote><p>åŒæ—¶ä¹Ÿæ”¶åˆ°äº†æ˜é‡‘ç»™æˆ‘å¯„é€çš„ç²¾ç¾å°ç¤¼ç‰©ï¼Œè°¢è°¢ğŸ˜œï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61c8acfb8b2c45b4807ac2ee4c2df18a~tplv-k3u1fbpfcp-watermark.image" alt="202112311239698.jpeg"></p><p>2ã€å·¥ä½œä¸­ï¼Œæˆ‘ä¸æ–­çš„æ¥å—æ–°æŒ‘æˆ˜ï¼Œæ¥å—è‰°éš¾çš„ä»»åŠ¡ï¼Œè®©è‡ªå·±å¿«é€Ÿæˆé•¿</p><p>å¦‚æœåªæ˜¯æ»¡è¶³ç°æœ‰ä¸šåŠ¡çš„å¼€å‘ï¼Œå¯¹äºè‡ªæˆ‘çš„æˆé•¿æ˜¯éå¸¸ç¼“æ…¢çš„ã€‚åœ¨å·¥ä½œä¸­æœ‰ä»€ä¹ˆæ–°çš„éœ€æ±‚ï¼Œæˆ‘éƒ½ä¼šä»”ç»†ç ”ç©¶ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä»½å·¥ä½œçš„éœ€è¦ï¼Œæ›´æœ‰æå‡è‡ªæˆ‘æ ¸å¿ƒä»·å€¼çš„å¿…è¦å§ï¼Œåˆæˆ–è€…è¯´æ˜¯å±æœºæ„è¯†ä¿ƒæˆçš„ï¼Œæ€»ä¹‹æˆ‘ä¼šä¿æŒä¸æ–­åœ°è¾“å…¥å’Œè¾“å‡ºï¼Œè¿™æ˜¯æˆ‘å·¥ä½œä¸Šæœ€æœ‰æˆå°±æ„Ÿçš„åœ°æ–¹ã€‚</p><p>æ­£å¦‚<a href="https://juejin.cn/post/7045977921365737502">ä¸Šç¯‡æ–‡ç« </a>æ‰€è¯´ï¼šä¸‹åŠå¹´ï¼Œæˆ‘æ¥äº†ä¸€ä½åŒäº‹è´Ÿè´£çš„æ‰€æœ‰ä¸šåŠ¡ï¼Œé€šè¿‡è‡ªå·±çš„åŠªåŠ›ï¼Œè¾ƒå¥½çš„æ”¯æŒäº†å…¬å¸çš„ä¸šåŠ¡æ‰©å±•ã€‚åŒæ—¶ï¼Œåšçš„äº‹æƒ…å¾—åˆ°äº†å¤§å®¶çš„è®¤å¯ï¼Œå¾ˆå¼€å¿ƒè¢«è¯„ä¸ºå­£åº¦ä¹‹æ˜Ÿï¼Œä¹Ÿæ„Ÿè°¢å¤§å®¶å¯¹æˆ‘çš„æ”¯æŒå’Œé¼“åŠ±ã€‚</p><p>3ã€ä¸‹åŠå¹´ï¼Œé€šè¿‡è‡ªå·±çš„åŠªåŠ›ï¼Œå®Œæˆäº†èŒçº§æ™‹å‡</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½æ˜¯ç›¸è¾…ç›¸æˆçš„ã€‚èƒ½é€šè¿‡è¿™æ¬¡æ™‹å‡ï¼Œä¸€æ–¹é¢åœ¨äºè‡ªå·±åšäº†å……åˆ†çš„å‡†å¤‡ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¾—ç›Šäºè‡ªå·±åšæŠ€æœ¯æ–‡ç« åˆ›ä½œå§ã€‚å¹³æ—¶æˆ‘ä¼šæŠŠè‡ªå·±åˆ›ä½œçš„æ–‡ç« åœ¨å›¢é˜Ÿå†…éƒ¨åˆ†äº«ï¼Œæå‡ä¸ªäººå½±å“åŠ›ã€‚åšæŒåŠ¨æ‰‹ç ä¸€ä¸‹å­¦ä¹ å¿ƒå¾—ï¼Œæ€ç»´å’ŒæŠ€æœ¯èƒ½åŠ›å¾—åˆ°äº†ä¸€å®šçš„é”»ç‚¼ï¼Œæ„Ÿè§‰æŒºå……å®æŒºå¥½çš„ã€‚å¸Œæœ›å¤§å®¶ä¸€èµ·æ¥åˆ†äº«å¤§å®¶çš„æ‰€å­¦æ‰€æƒ³ã€‚</p><h2 id="ä¸ƒã€å†™ç»™æ­¤æ—¶æ­¤åˆ»"><a href="#ä¸ƒã€å†™ç»™æ­¤æ—¶æ­¤åˆ»" class="headerlink" title="ä¸ƒã€å†™ç»™æ­¤æ—¶æ­¤åˆ»"></a>ä¸ƒã€å†™ç»™æ­¤æ—¶æ­¤åˆ»</h2><p>é©¬ä¸Šè¦å’Œ 2021 è¯´å†è§äº†ï¼Œ2022 äººç”Ÿå°†è¦ç¿»å¼€å´­æ–°çš„ä¸€é¡µï¼Œæ–°çš„ä¸€å¹´ï¼Œæ–°çš„ä¸€å²ï¼Œæ„¿æˆ‘ä»¬éƒ½ä¸å°†å°±ï¼Œä¸è¾œè´Ÿï¼Œæ´»å‡ºè‡ªå·±çš„ç²¾å½©</p><h2 id="å…«ã€å±•æœ›æˆ‘çš„-2022"><a href="#å…«ã€å±•æœ›æˆ‘çš„-2022" class="headerlink" title="å…«ã€å±•æœ›æˆ‘çš„ 2022"></a>å…«ã€å±•æœ›æˆ‘çš„ 2022</h2><p>æ–°çš„ä¸€å¹´ï¼Œç”Ÿæ´»ä¼šæœ‰å¾ˆå¤šæ–°çš„æ”¹å˜ï¼Œæœ€å¼€å¿ƒçš„äº‹æƒ…è«è¿‡äºå¤§äººå­©å­åœ¨ä¸€èµ·ç”Ÿæ´»ã€‚2021å¹´çš„å‘¨æœ«åˆ©ç”¨ç‡ä¸æ˜¯é‚£ä¹ˆé«˜ï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´ï¼Œèƒ½ç©ºå‡ºæ—¶é—´ï¼ŒåŠ¨æ‰‹åšé¥­èœï¼ŒåŠ¨æ‰‹ä¸€èµ·æ•´ç†å®¶åŠ¡ï¼Œåˆ›é€ ä¸€ä¸ªå¹²å‡€æ•´æ´èˆ’æœçš„ç¯å¢ƒã€‚å‘¨æœ«è¦è®¡åˆ’å¥½å¸¦å®¶äººå‡ºè¡Œï¼Œå¶å°”ä¸€èµ·çˆ¬çˆ¬å±±ï¼Œè¿åŠ¨èˆ’å±•ä¸€ä¸‹</p><p>æ–°çš„ä¸€å¹´ï¼Œå·¥ä½œä¹Ÿä¼šæœ‰å¾ˆå¤šçš„å˜åŒ–ï¼Œæœ€å¼€å¿ƒçš„è«è¿‡äºå’Œå¤§å®¶ä¸€èµ·ï¼Œå¼€å¿ƒä¸Šä¸‹ç­ï¼Œä¸€èµ·åˆ†äº«æ²Ÿé€šäº¤æµã€‚æˆ‘ä¼šç»§ç»­ä¿æŒæŠ€æœ¯æ–‡ç« åˆ›ä½œï¼Œå»å­¦ä¹ ç ”ç©¶æ–°æŠ€æœ¯ï¼Œæ–°æ¡†æ¶ï¼Œåœ¨æå‡ä¸ªäººçš„åŒæ—¶ï¼Œå¸®åŠ©å¤§å®¶ä¸€èµ·æˆé•¿ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99bc1d2cd0f94d83b84c584e91af0e38~tplv-k3u1fbpfcp-watermark.image" alt="2022è®¡åˆ’ æ¨¡æ¿.png"></p><p><strong>æ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡æ–‡ç« </strong></p><blockquote><p><strong>ä½ çš„ç‚¹èµï¼Œè¯„è®ºï¼Œæ˜¯å¯¹æˆ‘å·¨å¤§çš„é¼“åŠ±ï¼</strong></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<strong>å…¬ä¼—å·ï¼š</strong>  <a href="http://m6z.cn/6jwi7b"><strong>sweetying</strong></a> ï¼Œæ–‡ç« æ›´æ–°å¯ç¬¬ä¸€æ—¶é—´æ”¶åˆ°</p><p>å¦‚æœ<strong>æœ‰é—®é¢˜</strong>ï¼Œå…¬ä¼—å·å†…æœ‰åŠ æˆ‘å¾®ä¿¡çš„å…¥å£ï¼Œåœ¨æŠ€æœ¯å­¦ä¹ ã€ä¸ªäººæˆé•¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·å‰è¿›ï¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸåˆ›</tag>
      
      <tag>å¹´ç»ˆæ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
